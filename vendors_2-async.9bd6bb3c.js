(("undefined"!=typeof globalThis?globalThis:self)["makoChunk_@ant-design/x"]=("undefined"!=typeof globalThis?globalThis:self)["makoChunk_@ant-design/x"]||[]).push([["vendors_2"],{"0640ea58":function(t,e,n){"use strict";n.d(e,"__esModule",{value:!0}),n.d(e,"AbstractRendererPlugin",{enumerable:!0,get:function(){return K;}});var r,i,a,o,s,l,u,c,h,d,f,v,p,g,y,m,k,E,x,T,N,b,S,w,P,M=n("777fffbe"),A=M._(n("ab297151")),C=M._(n("b1a4abb6")),R=M._(n("72ce8fb5")),O=M._(n("d60881d0")),L=M._(n("0b95a4d2")),I=M._(n("0afdccfb")),D=M._(n("7465ab36")),_=M._(n("32f41e1c")),G=n("597fa39f");n("f90e84e3");var F=n("abe9d8d6"),B=M._(n("3214ccb5")),U=M._(n("51ffafbb")),V=M._(n("3c7f532e")),z=n("b1a96927"),H=M._(n("2fabd5d4")),Y=M._(n("cb203630")),W=M._(n("1982f763")),q=M._(n("01aac514"));let X=n("1714eebe");var j=((r={}).GROUP="g",r.FRAGMENT="fragment",r.CIRCLE="circle",r.ELLIPSE="ellipse",r.IMAGE="image",r.RECT="rect",r.LINE="line",r.POLYLINE="polyline",r.POLYGON="polygon",r.TEXT="text",r.PATH="path",r.HTML="html",r.MESH="mesh",r),$=((i={})[i.ZERO=0]="ZERO",i[i.NEGATIVE_ONE=1]="NEGATIVE_ONE",i),K=(0,R.default)(function t(){(0,C.default)(this,t),this.plugins=[];},[{key:"addRenderingPlugin",value:function(t){this.plugins.push(t),this.context.renderingPlugins.push(t);}},{key:"removeAllRenderingPlugins",value:function(){var t=this;this.plugins.forEach(function(e){var n=t.context.renderingPlugins.indexOf(e);n>=0&&t.context.renderingPlugins.splice(n,1);});}}]),Z=G.vec3.add,Q=G.vec3.copy,J=G.vec3.max,tt=G.vec3.min,te=G.vec3.scale,tn=G.vec3.sub,tr=function(){function t(){(0,C.default)(this,t),this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0];}return(0,R.default)(t,[{key:"update",value:function(t,e){Q(this.center,t),Q(this.halfExtents,e),tn(this.min,this.center,this.halfExtents),Z(this.max,this.center,this.halfExtents);}},{key:"setMinMax",value:function(t,e){Z(this.center,e,t),te(this.center,this.center,.5),tn(this.halfExtents,e,t),te(this.halfExtents,this.halfExtents,.5),Q(this.min,t),Q(this.max,e);}},{key:"getMin",value:function(){return this.min;}},{key:"getMax",value:function(){return this.max;}},{key:"add",value:function(e){if(!t.isEmpty(e)){if(t.isEmpty(this)){this.setMinMax(e.getMin(),e.getMax());return;}var n=this.center,r=n[0],i=n[1],a=n[2],o=this.halfExtents,s=o[0],l=o[1],u=o[2],c=r-s,h=r+s,d=i-l,f=i+l,v=a-u,p=a+u,g=e.center,y=g[0],m=g[1],k=g[2],E=e.halfExtents,x=E[0],T=E[1],N=E[2],b=y-x,S=y+x,w=m-T,P=m+T,M=k-N,A=k+N;b<c&&(c=b),S>h&&(h=S),w<d&&(d=w),P>f&&(f=P),M<v&&(v=M),A>p&&(p=A),n[0]=(c+h)*.5,n[1]=(d+f)*.5,n[2]=(v+p)*.5,o[0]=(h-c)*.5,o[1]=(f-d)*.5,o[2]=(p-v)*.5,this.min[0]=c,this.min[1]=d,this.min[2]=v,this.max[0]=h,this.max[1]=f,this.max[2]=p;}}},{key:"setFromTransformedAABB",value:function(t,e){var n=this.center,r=this.halfExtents,i=t.center,a=t.halfExtents,o=e[0],s=e[4],l=e[8],u=e[1],c=e[5],h=e[9],d=e[2],f=e[6],v=e[10],p=Math.abs(o),g=Math.abs(s),y=Math.abs(l),m=Math.abs(u),k=Math.abs(c),E=Math.abs(h),x=Math.abs(d),T=Math.abs(f),N=Math.abs(v);n[0]=e[12]+o*i[0]+s*i[1]+l*i[2],n[1]=e[13]+u*i[0]+c*i[1]+h*i[2],n[2]=e[14]+d*i[0]+f*i[1]+v*i[2],r[0]=p*a[0]+g*a[1]+y*a[2],r[1]=m*a[0]+k*a[1]+E*a[2],r[2]=x*a[0]+T*a[1]+N*a[2],tn(this.min,n,r),Z(this.max,n,r);}},{key:"intersects",value:function(t){var e=this.getMax(),n=this.getMin(),r=t.getMax(),i=t.getMin();return n[0]<=r[0]&&e[0]>=i[0]&&n[1]<=r[1]&&e[1]>=i[1]&&n[2]<=r[2]&&e[2]>=i[2];}},{key:"intersection",value:function(e){if(!this.intersects(e))return null;var n=new t,r=J([0,0,0],this.getMin(),e.getMin()),i=tt([0,0,0],this.getMax(),e.getMax());return n.setMinMax(r,i),n;}},{key:"getNegativeFarPoint",value:function(t){return 273===t.pnVertexFlag?Q([0,0,0],this.min):272===t.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:257===t.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:256===t.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:17===t.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:16===t.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:1===t.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]];}},{key:"getPositiveFarPoint",value:function(t){return 273===t.pnVertexFlag?Q([0,0,0],this.max):272===t.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:257===t.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:256===t.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:17===t.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:16===t.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:1===t.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]];}}],[{key:"isEmpty",value:function(t){return!t||0===t.halfExtents[0]&&0===t.halfExtents[1]&&0===t.halfExtents[2];}}]);}(),ti=(0,R.default)(function t(e,n){(0,C.default)(this,t),this.distance=e||0,this.normal=n||G.vec3.fromValues(0,1,0),this.updatePNVertexFlag();},[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(Number(this.normal[0]>=0)<<8)+(Number(this.normal[1]>=0)<<4)+Number(this.normal[2]>=0);}},{key:"distanceToPoint",value:function(t){return G.vec3.dot(t,this.normal)-this.distance;}},{key:"normalize",value:function(){var t=1/G.vec3.len(this.normal);G.vec3.scale(this.normal,this.normal,t),this.distance*=t;}},{key:"intersectsLine",value:function(t,e,n){var r=this.distanceToPoint(t),i=r/(r-this.distanceToPoint(e)),a=i>=0&&i<=1;return a&&n&&G.vec3.lerp(n,t,e,i),a;}}]),ta=((a={})[a.OUTSIDE=4294967295]="OUTSIDE",a[a.INSIDE=0]="INSIDE",a[a.INDETERMINATE=2147483647]="INDETERMINATE",a),to=(0,R.default)(function t(e){if((0,C.default)(this,t),this.planes=[],e)this.planes=e;else for(var n=0;n<6;n++)this.planes.push(new ti);},[{key:"extractFromVPMatrix",value:function(t){var e=(0,D.default)(t,16),n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],v=e[12],p=e[13],g=e[14],y=e[15];G.vec3.set(this.planes[0].normal,a-n,u-o,f-c),this.planes[0].distance=y-v,G.vec3.set(this.planes[1].normal,a+n,u+o,f+c),this.planes[1].distance=y+v,G.vec3.set(this.planes[2].normal,a+r,u+s,f+h),this.planes[2].distance=y+p,G.vec3.set(this.planes[3].normal,a-r,u-s,f-h),this.planes[3].distance=y-p,G.vec3.set(this.planes[4].normal,a-i,u-l,f-d),this.planes[4].distance=y-g,G.vec3.set(this.planes[5].normal,a+i,u+l,f+d),this.planes[5].distance=y+g,this.planes.forEach(function(t){t.normalize(),t.updatePNVertexFlag();});}}]),ts=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,C.default)(this,t),this.x=0,this.y=0,this.x=e,this.y=n;}return(0,R.default)(t,[{key:"clone",value:function(){return new t(this.x,this.y);}},{key:"copyFrom",value:function(t){this.x=t.x,this.y=t.y;}}]);}(),tl=function(){function t(e,n,r,i){(0,C.default)(this,t),this.x=e,this.y=n,this.width=r,this.height=i,this.left=e,this.right=e+r,this.top=n,this.bottom=n+i;}return(0,R.default)(t,[{key:"toJSON",value:function(){}}],[{key:"fromRect",value:function(e){return new t(e.x,e.y,e.width,e.height);}},{key:"applyTransform",value:function(e,n){var r=G.vec4.fromValues(e.x,e.y,0,1),i=G.vec4.fromValues(e.x+e.width,e.y,0,1),a=G.vec4.fromValues(e.x,e.y+e.height,0,1),o=G.vec4.fromValues(e.x+e.width,e.y+e.height,0,1),s=G.vec4.create(),l=G.vec4.create(),u=G.vec4.create(),c=G.vec4.create();G.vec4.transformMat4(s,r,n),G.vec4.transformMat4(l,i,n),G.vec4.transformMat4(u,a,n),G.vec4.transformMat4(c,o,n);var h=Math.min(s[0],l[0],u[0],c[0]),d=Math.min(s[1],l[1],u[1],c[1]),f=Math.max(s[0],l[0],u[0],c[0]),v=Math.max(s[1],l[1],u[1],c[1]);return t.fromRect({x:h,y:d,width:f-h,height:v-d});}}]);}(),tu="Method not implemented.";function tc(t){return void 0===t?0:t>360||t<-360?t%360:t;}var th=G.vec3.create();function td(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];return Array.isArray(t)&&3===t.length?r?G.vec3.clone(t):G.vec3.copy(th,t):(0,F.isNumber)(t)?r?G.vec3.fromValues(t,e,n):G.vec3.set(th,t,e,n):r?G.vec3.fromValues(t[0],t[1]||e,t[2]||n):G.vec3.set(th,t[0],t[1]||e,t[2]||n);}var tf=Math.PI/180,tv=180/Math.PI,tp=Math.PI/2;function tg(t,e){var n,r,i,a,o,s,l,u,c,h,d,f,v,p,g,y,m;return 16===e.length?(i=G.mat4.getScaling(G.vec3.create(),e),o=(a=(0,D.default)(i,3))[0],s=a[1],l=a[2],(u=Math.asin(-e[2]/o))<tp?u>-tp?(n=Math.atan2(e[6]/s,e[10]/l),r=Math.atan2(e[1]/o,e[0]/o)):(r=0,n=-Math.atan2(e[4]/s,e[5]/s)):(r=0,n=Math.atan2(e[4]/s,e[5]/s)),t[0]=n,t[1]=u,t[2]=r):(c=e[0],h=e[1],d=e[2],f=e[3],y=c*c+(v=h*h)+(p=d*d)+(g=f*f),(m=c*f-h*d)>.499995*y?(t[0]=tp,t[1]=2*Math.atan2(h,c),t[2]=0):m<-.499995*y?(t[0]=-tp,t[1]=2*Math.atan2(h,c),t[2]=0):(t[0]=Math.asin(2*(c*d-f*h)),t[1]=Math.atan2(2*(c*f+h*d),1-2*(p+g)),t[2]=Math.atan2(2*(c*h+d*f),1-2*(v+p)))),t;}function ty(t){var e=t[0],n=t[1],r=t[3],i=t[4],a=Math.sqrt(e*e+n*n),o=Math.sqrt(r*r+i*i);if(e*i-n*r<0&&(e<i?a=-a:o=-o),a){var s=1/a;e*=s,n*=s;}if(o){var l=1/o;r*=l,i*=l;}var u=Math.atan2(n,e)*tv;return[t[6],t[7],a,o,u];}var tm=G.mat4.create(),tk=G.mat4.create(),tE=G.vec4.create(),tx=[G.vec3.create(),G.vec3.create(),G.vec3.create()],tT=G.vec3.create();function tN(t,e,n,r,i){t[0]=e[0]*r+n[0]*i,t[1]=e[1]*r+n[1]*i,t[2]=e[2]*r+n[2]*i;}var tb=((o={})[o.ORBITING=0]="ORBITING",o[o.EXPLORING=1]="EXPLORING",o[o.TRACKING=2]="TRACKING",o),tS=((s={})[s.DEFAULT=0]="DEFAULT",s[s.ROTATIONAL=1]="ROTATIONAL",s[s.TRANSLATIONAL=2]="TRANSLATIONAL",s[s.CINEMATIC=3]="CINEMATIC",s),tw=((l={})[l.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",l[l.PERSPECTIVE=1]="PERSPECTIVE",l),tP={UPDATED:"updated"},tM=(0,R.default)(function t(){(0,C.default)(this,t),this.clipSpaceNearZ=$.NEGATIVE_ONE,this.eventEmitter=new _.default,this.matrix=G.mat4.create(),this.right=G.vec3.fromValues(1,0,0),this.up=G.vec3.fromValues(0,1,0),this.forward=G.vec3.fromValues(0,0,1),this.position=G.vec3.fromValues(0,0,1),this.focalPoint=G.vec3.fromValues(0,0,0),this.distanceVector=G.vec3.fromValues(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=G.mat4.create(),this.projectionMatrixInverse=G.mat4.create(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=tb.EXPLORING,this.trackingMode=tS.DEFAULT,this.projectionMode=tw.PERSPECTIVE,this.frustum=new to,this.orthoMatrix=G.mat4.create();},[{key:"isOrtho",value:function(){return this.projectionMode===tw.ORTHOGRAPHIC;}},{key:"getProjectionMode",value:function(){return this.projectionMode;}},{key:"getPerspective",value:function(){return this.jitteredProjectionMatrix||this.projectionMatrix;}},{key:"getPerspectiveInverse",value:function(){return this.projectionMatrixInverse;}},{key:"getFrustum",value:function(){return this.frustum;}},{key:"getPosition",value:function(){return this.position;}},{key:"getFocalPoint",value:function(){return this.focalPoint;}},{key:"getDollyingStep",value:function(){return this.dollyingStep;}},{key:"getNear",value:function(){return this.near;}},{key:"getFar",value:function(){return this.far;}},{key:"getZoom",value:function(){return this.zoom;}},{key:"getOrthoMatrix",value:function(){return this.orthoMatrix;}},{key:"getView",value:function(){return this.view;}},{key:"setEnableUpdate",value:function(t){this.enableUpdate=t;}},{key:"setType",value:function(t,e){return this.type=t,this.type===tb.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===tb.TRACKING&&void 0!==e&&this.setTrackingMode(e),this;}},{key:"setProjectionMode",value:function(t){return this.projectionMode=t,this;}},{key:"setTrackingMode",value:function(t){if(this.type!==tb.TRACKING)throw Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=t,this;}},{key:"setWorldRotation",value:function(t){return this.rotateWorld=t,this._getAngles(),this;}},{key:"getViewTransform",value:function(){return G.mat4.invert(G.mat4.create(),this.matrix);}},{key:"getWorldTransform",value:function(){return this.matrix;}},{key:"jitterProjectionMatrix",value:function(t,e){var n=G.mat4.fromTranslation(G.mat4.create(),[t,e,0]);this.jitteredProjectionMatrix=G.mat4.multiply(G.mat4.create(),n,this.projectionMatrix);}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0;}},{key:"setMatrix",value:function(t){return this.matrix=t,this._update(),this;}},{key:"setProjectionMatrix",value:function(t){this.projectionMatrix=t;}},{key:"setFov",value:function(t){return this.setPerspective(this.near,this.far,t,this.aspect),this;}},{key:"setAspect",value:function(t){return this.setPerspective(this.near,this.far,this.fov,t),this;}},{key:"setNear",value:function(t){return this.projectionMode===tw.PERSPECTIVE?this.setPerspective(t,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,t,this.far),this;}},{key:"setFar",value:function(t){return this.projectionMode===tw.PERSPECTIVE?this.setPerspective(this.near,t,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,t),this;}},{key:"setViewOffset",value:function(t,e,n,r,i,a){return this.aspect=t/e,void 0===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.projectionMode===tw.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this;}},{key:"clearViewOffset",value:function(){return void 0!==this.view&&(this.view.enabled=!1),this.projectionMode===tw.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this;}},{key:"setZoom",value:function(t){return this.zoom=t,this.projectionMode===tw.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===tw.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this;}},{key:"setZoomByViewportPoint",value:function(t,e){var n=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),r=n.x,i=n.y,a=this.roll;this.rotate(0,0,-a),this.setPosition(r,i),this.setFocalPoint(r,i),this.setZoom(t),this.rotate(0,0,a);var o=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),s=o.x,l=o.y,u=G.vec3.fromValues(s-r,l-i,0),c=G.vec3.dot(u,this.right)/G.vec3.length(this.right),h=G.vec3.dot(u,this.up)/G.vec3.length(this.up),d=this.getPosition(),f=(0,D.default)(d,2),v=f[0],p=f[1],g=this.getFocalPoint(),y=(0,D.default)(g,2),m=y[0],k=y[1];return this.setPosition(v-c,p-h),this.setFocalPoint(m-c,k-h),this;}},{key:"setPerspective",value:function(t,e,n,r){this.projectionMode=tw.PERSPECTIVE,this.fov=n,this.near=t,this.far=e,this.aspect=r;var i,a=this.near*Math.tan(.5*this.fov*tf)/this.zoom,o=2*a,s=this.aspect*o,l=-.5*s;if(null!==(i=this.view)&&void 0!==i&&i.enabled){var u=this.view.fullWidth,c=this.view.fullHeight;l+=this.view.offsetX*s/u,a-=this.view.offsetY*o/c,s*=this.view.width/u,o*=this.view.height/c;}return!function(t,e,n,r,i,a,o){var s,l,u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=2*a,h=n-e,d=r-i,f=o-a,v=o*a;u?(s=-o/f,l=-v/f):(s=-(o+a)/f,l=-2*v/f),t[0]=c/h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c/d,t[6]=0,t[7]=0,t[8]=(n+e)/h,t[9]=(r+i)/d,t[10]=s,t[11]=-1,t[12]=0,t[13]=0,t[14]=l,t[15]=0;}(this.projectionMatrix,l,l+s,a-o,a,t,this.far,this.clipSpaceNearZ===$.ZERO),G.mat4.invert(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this;}},{key:"setOrthographic",value:function(t,e,n,r,i,a){this.projectionMode=tw.ORTHOGRAPHIC,this.rright=e,this.left=t,this.top=n,this.bottom=r,this.near=i,this.far=a;var o,s=(this.rright-this.left)/(2*this.zoom),l=(this.top-this.bottom)/(2*this.zoom),u=(this.rright+this.left)/2,c=(this.top+this.bottom)/2,h=u-s,d=u+s,f=c+l,v=c-l;if(null!==(o=this.view)&&void 0!==o&&o.enabled){var p=(this.rright-this.left)/this.view.fullWidth/this.zoom,g=(this.top-this.bottom)/this.view.fullHeight/this.zoom;h+=p*this.view.offsetX,d=h+p*this.view.width,f-=g*this.view.offsetY,v=f-g*this.view.height;}return this.clipSpaceNearZ===$.NEGATIVE_ONE?G.mat4.ortho(this.projectionMatrix,h,d,f,v,i,a):G.mat4.orthoZO(this.projectionMatrix,h,d,f,v,i,a),G.mat4.invert(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this;}},{key:"setPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.position[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.position[2],r=td(t,e,n);return this._setPosition(r),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this;}},{key:"setFocalPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.focalPoint[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.focalPoint[2],r=G.vec3.fromValues(0,1,0);if(this.focalPoint=td(t,e,n),this.trackingMode===tS.CINEMATIC){var i=G.vec3.subtract(G.vec3.create(),this.focalPoint,this.position);t=i[0],e=i[1],n=i[2];var a=Math.asin(e/G.vec3.length(i))*tv,o=90+Math.atan2(n,t)*tv,s=G.mat4.create();G.mat4.rotateY(s,s,o*tf),G.mat4.rotateX(s,s,a*tf),r=G.vec3.transformMat4(G.vec3.create(),[0,1,0],s);}return G.mat4.invert(this.matrix,G.mat4.lookAt(G.mat4.create(),this.position,this.focalPoint,r)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this;}},{key:"getDistance",value:function(){return this.distance;}},{key:"getDistanceVector",value:function(){return this.distanceVector;}},{key:"setDistance",value:function(t){if(this.distance===t||t<0)return this;this.distance=t,this.distance<2e-4&&(this.distance=2e-4),this.dollyingStep=this.distance/100;var e=G.vec3.create();t=this.distance;var n=this.forward,r=this.focalPoint;return e[0]=t*n[0]+r[0],e[1]=t*n[1]+r[1],e[2]=t*n[2]+r[2],this._setPosition(e),this.triggerUpdate(),this;}},{key:"setMaxDistance",value:function(t){return this.maxDistance=t,this;}},{key:"setMinDistance",value:function(t){return this.minDistance=t,this;}},{key:"setAzimuth",value:function(t){return this.azimuth=tc(t),this.computeMatrix(),this._getAxes(),this.type===tb.ORBITING||this.type===tb.EXPLORING?this._getPosition():this.type===tb.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getAzimuth",value:function(){return this.azimuth;}},{key:"setElevation",value:function(t){return this.elevation=tc(t),this.computeMatrix(),this._getAxes(),this.type===tb.ORBITING||this.type===tb.EXPLORING?this._getPosition():this.type===tb.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getElevation",value:function(){return this.elevation;}},{key:"setRoll",value:function(t){return this.roll=tc(t),this.computeMatrix(),this._getAxes(),this.type===tb.ORBITING||this.type===tb.EXPLORING?this._getPosition():this.type===tb.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getRoll",value:function(){return this.roll;}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate();}},{key:"computeMatrix",value:function(){var t=G.quat.setAxisAngle(G.quat.create(),[0,0,1],this.roll*tf);G.mat4.identity(this.matrix);var e=G.quat.setAxisAngle(G.quat.create(),[1,0,0],(this.rotateWorld&&this.type!==tb.TRACKING||this.type===tb.TRACKING?1:-1)*this.elevation*tf),n=G.quat.setAxisAngle(G.quat.create(),[0,1,0],(this.rotateWorld&&this.type!==tb.TRACKING||this.type===tb.TRACKING?1:-1)*this.azimuth*tf),r=G.quat.multiply(G.quat.create(),n,e);r=G.quat.multiply(G.quat.create(),r,t);var i=G.mat4.fromQuat(G.mat4.create(),r);this.type===tb.ORBITING||this.type===tb.EXPLORING?(G.mat4.translate(this.matrix,this.matrix,this.focalPoint),G.mat4.multiply(this.matrix,this.matrix,i),G.mat4.translate(this.matrix,this.matrix,[0,0,this.distance])):this.type===tb.TRACKING&&(G.mat4.translate(this.matrix,this.matrix,this.position),G.mat4.multiply(this.matrix,this.matrix,i));}},{key:"_setPosition",value:function(t,e,n){this.position=td(t,e,n);var r=this.matrix;r[12]=this.position[0],r[13]=this.position[1],r[14]=this.position[2],r[15]=1,this._getOrthoMatrix();}},{key:"_getAxes",value:function(){G.vec3.copy(this.right,td(G.vec4.transformMat4(G.vec4.create(),[1,0,0,0],this.matrix))),G.vec3.copy(this.up,td(G.vec4.transformMat4(G.vec4.create(),[0,1,0,0],this.matrix))),G.vec3.copy(this.forward,td(G.vec4.transformMat4(G.vec4.create(),[0,0,1,0],this.matrix))),G.vec3.normalize(this.right,this.right),G.vec3.normalize(this.up,this.up),G.vec3.normalize(this.forward,this.forward);}},{key:"_getAngles",value:function(){var t=this.distanceVector[0],e=this.distanceVector[1],n=this.distanceVector[2],r=G.vec3.length(this.distanceVector);if(0===r){this.elevation=0,this.azimuth=0;return;}this.type===tb.TRACKING?(this.elevation=Math.asin(e/r)*tv,this.azimuth=Math.atan2(-t,-n)*tv):this.rotateWorld?(this.elevation=Math.asin(e/r)*tv,this.azimuth=Math.atan2(-t,-n)*tv):(this.elevation=-(Math.asin(e/r)*tv),this.azimuth=-(Math.atan2(-t,-n)*tv));}},{key:"_getPosition",value:function(){G.vec3.copy(this.position,td(G.vec4.transformMat4(G.vec4.create(),[0,0,0,1],this.matrix))),this._getDistance();}},{key:"_getFocalPoint",value:function(){G.vec3.transformMat3(this.distanceVector,[0,0,-this.distance],G.mat3.fromMat4(G.mat3.create(),this.matrix)),G.vec3.add(this.focalPoint,this.position,this.distanceVector),this._getDistance();}},{key:"_getDistance",value:function(){this.distanceVector=G.vec3.subtract(G.vec3.create(),this.focalPoint,this.position),this.distance=G.vec3.length(this.distanceVector),this.dollyingStep=this.distance/100;}},{key:"_getOrthoMatrix",value:function(){if(this.projectionMode===tw.ORTHOGRAPHIC){var t=this.position,e=G.quat.setAxisAngle(G.quat.create(),[0,0,1],-this.roll*Math.PI/180);G.mat4.fromRotationTranslationScaleOrigin(this.orthoMatrix,e,G.vec3.fromValues((this.rright-this.left)/2-t[0],(this.top-this.bottom)/2-t[1],0),G.vec3.fromValues(this.zoom,this.zoom,1),t);}}},{key:"triggerUpdate",value:function(){if(this.enableUpdate){var t=this.getViewTransform(),e=G.mat4.multiply(G.mat4.create(),this.getPerspective(),t);this.getFrustum().extractFromVPMatrix(e),this.eventEmitter.emit(tP.UPDATED);}}},{key:"rotate",value:function(t,e,n){throw Error(tu);}},{key:"pan",value:function(t,e){throw Error(tu);}},{key:"dolly",value:function(t){throw Error(tu);}},{key:"createLandmark",value:function(t,e){throw Error(tu);}},{key:"gotoLandmark",value:function(t,e){throw Error(tu);}},{key:"cancelLandmarkAnimation",value:function(){throw Error(tu);}}]),tA=((u={})[u.Standard=0]="Standard",u),tC=((c={})[c.ADDED=0]="ADDED",c[c.REMOVED=1]="REMOVED",c[c.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED",c),tR=G.vec3.create(),tO=G.mat4.create(),tL=G.quat.create();function tI(t){if(t.localDirtyFlag){if(0!==t.localSkew[0]||0!==t.localSkew[1]){G.mat4.fromRotationTranslationScaleOrigin(t.localTransform,t.localRotation,t.localPosition,G.vec3.fromValues(1,1,1),t.origin),(0!==t.localSkew[0]||0!==t.localSkew[1])&&(G.mat4.identity(tO),tO[4]=Math.tan(t.localSkew[0]),tO[1]=Math.tan(t.localSkew[1]),G.mat4.multiply(t.localTransform,t.localTransform,tO));var e=G.mat4.fromRotationTranslationScaleOrigin(tO,G.quat.set(tL,0,0,0,1),G.vec3.set(tR,1,1,1),t.localScale,t.origin);G.mat4.multiply(t.localTransform,t.localTransform,e);}else{var n=t.localTransform,r=t.localPosition,i=t.localRotation,a=t.localScale,o=t.origin,s=0!==r[0]||0!==r[1]||0!==r[2],l=1!==i[3]||0!==i[0]||0!==i[1]||0!==i[2],u=1!==a[0]||1!==a[1]||1!==a[2],c=0!==o[0]||0!==o[1]||0!==o[2];l||u||c?G.mat4.fromRotationTranslationScaleOrigin(n,i,r,a,o):s?G.mat4.fromTranslation(n,r):G.mat4.identity(n);}t.localDirtyFlag=!1;}}var tD={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new tl(0,0,0,0)},t_=((h={}).COORDINATE="<coordinate>",h.COLOR="<color>",h.PAINT="<paint>",h.NUMBER="<number>",h.ANGLE="<angle>",h.OPACITY_VALUE="<opacity-value>",h.SHADOW_BLUR="<shadow-blur>",h.LENGTH="<length>",h.PERCENTAGE="<percentage>",h.LENGTH_PERCENTAGE="<length> | <percentage>",h.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",h.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",h.LIST_OF_POINTS="<list-of-points>",h.PATH="<path>",h.FILTER="<filter>",h.Z_INDEX="<z-index>",h.OFFSET_DISTANCE="<offset-distance>",h.DEFINED_PATH="<defined-path>",h.MARKER="<marker>",h.TRANSFORM="<transform>",h.TRANSFORM_ORIGIN="<transform-origin>",h.TEXT="<text>",h.TEXT_TRANSFORM="<text-transform>",h);function tG(t,e,n){t.prototype=e.prototype=n,n.constructor=t;}function tF(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n;}function tB(){}var tU="\\s*([+-]?\\d+)\\s*",tV="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",tz="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",tH=/^#([0-9a-f]{3,8})$/,tY=RegExp(`^rgb\\(${tU},${tU},${tU}\\)$`),tW=RegExp(`^rgb\\(${tz},${tz},${tz}\\)$`),tq=RegExp(`^rgba\\(${tU},${tU},${tU},${tV}\\)$`),tX=RegExp(`^rgba\\(${tz},${tz},${tz},${tV}\\)$`),tj=RegExp(`^hsl\\(${tV},${tz},${tz}\\)$`),t$=RegExp(`^hsla\\(${tV},${tz},${tz},${tV}\\)$`),tK={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function tZ(){return this.rgb().formatHex();}function tQ(){return this.rgb().formatRgb();}function tJ(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=tH.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?t0(e):3===n?new t2(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?t1(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?t1(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=tY.exec(t))?new t2(e[1],e[2],e[3],1):(e=tW.exec(t))?new t2(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=tq.exec(t))?t1(e[1],e[2],e[3],e[4]):(e=tX.exec(t))?t1(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=tj.exec(t))?t9(e[1],e[2]/100,e[3]/100,1):(e=t$.exec(t))?t9(e[1],e[2]/100,e[3]/100,e[4]):tK.hasOwnProperty(t)?t0(tK[t]):"transparent"===t?new t2(NaN,NaN,NaN,0):null;}function t0(t){return new t2(t>>16&255,t>>8&255,255&t,1);}function t1(t,e,n,r){return r<=0&&(t=e=n=NaN),new t2(t,e,n,r);}function t2(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r;}function t3(){return`#${t7(this.r)}${t7(this.g)}${t7(this.b)}`;}function t4(){let t=t5(this.opacity);return`${1===t?"rgb(":"rgba("}${t6(this.r)}, ${t6(this.g)}, ${t6(this.b)}${1===t?")":`, ${t})`}`;}function t5(t){return isNaN(t)?1:Math.max(0,Math.min(1,t));}function t6(t){return Math.max(0,Math.min(255,Math.round(t)||0));}function t7(t){return((t=t6(t))<16?"0":"")+t.toString(16);}function t9(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new et(t,e,n,r);}function t8(t){if(t instanceof et)return new et(t.h,t.s,t.l,t.opacity);if(t instanceof tB||(t=tJ(t)),!t)return new et;if(t instanceof et)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,l=(a+i)/2;return s?(o=e===a?(n-r)/s+(n<r)*6:n===a?(r-e)/s+2:(e-n)/s+4,s/=l<.5?a+i:2-a-i,o*=60):s=l>0&&l<1?0:o,new et(o,s,l,t.opacity);}function et(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r;}function ee(t){return(t=(t||0)%360)<0?t+360:t;}function en(t){return Math.max(0,Math.min(1,t||0));}function er(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255;}function ei(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw TypeError("Expected a function");var n=function(){for(var r=arguments.length,i=Array(r),a=0;a<r;a++)i[a]=arguments[a];var o=e?e.apply(this,i):i[0],s=n.cache;if(s.has(o))return s.get(o);var l=t.apply(this,i);return n.cache=s.set(o,l)||s,l;};return n.cache=new(ei.Cache||Map),ei.cacheList.push(n.cache),n;}tG(tB,tJ,{copy(t){return Object.assign(new this.constructor,this,t);},displayable(){return this.rgb().displayable();},hex:tZ,formatHex:tZ,formatHex8:function(){return this.rgb().formatHex8();},formatHsl:function(){return t8(this).formatHsl();},formatRgb:tQ,toString:tQ}),tG(t2,function(t,e,n,r){var i;return 1==arguments.length?((i=t)instanceof tB||(i=tJ(i)),i)?new t2((i=i.rgb()).r,i.g,i.b,i.opacity):new t2:new t2(t,e,n,null==r?1:r);},tF(tB,{brighter(t){return t=null==t?1.4285714285714286:Math.pow(1.4285714285714286,t),new t2(this.r*t,this.g*t,this.b*t,this.opacity);},darker(t){return t=null==t?.7:Math.pow(.7,t),new t2(this.r*t,this.g*t,this.b*t,this.opacity);},rgb(){return this;},clamp(){return new t2(t6(this.r),t6(this.g),t6(this.b),t5(this.opacity));},displayable(){return -.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1;},hex:t3,formatHex:t3,formatHex8:function(){return`#${t7(this.r)}${t7(this.g)}${t7(this.b)}${t7((isNaN(this.opacity)?1:this.opacity)*255)}`;},formatRgb:t4,toString:t4})),tG(et,function(t,e,n,r){return 1==arguments.length?t8(t):new et(t,e,n,null==r?1:r);},tF(tB,{brighter(t){return t=null==t?1.4285714285714286:Math.pow(1.4285714285714286,t),new et(this.h,this.s,this.l*t,this.opacity);},darker(t){return t=null==t?.7:Math.pow(.7,t),new et(this.h,this.s,this.l*t,this.opacity);},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new t2(er(t>=240?t-240:t+120,i,r),er(t,i,r),er(t<120?t+240:t-120,i,r),this.opacity);},clamp(){return new et(ee(this.h),en(this.s),en(this.l),t5(this.opacity));},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1;},formatHsl(){let t=t5(this.opacity);return`${1===t?"hsl(":"hsla("}${ee(this.h)}, ${100*en(this.s)}%, ${100*en(this.l)}%${1===t?")":`, ${t})`}`;}})),ei.Cache=Map,ei.cacheList=[],ei.clearCache=function(){ei.cacheList.forEach(function(t){return t.clear();});};var ea=((d={})[d.kUnknown=0]="kUnknown",d[d.kNumber=1]="kNumber",d[d.kPercentage=2]="kPercentage",d[d.kEms=3]="kEms",d[d.kPixels=4]="kPixels",d[d.kRems=5]="kRems",d[d.kDegrees=6]="kDegrees",d[d.kRadians=7]="kRadians",d[d.kGradians=8]="kGradians",d[d.kTurns=9]="kTurns",d[d.kMilliseconds=10]="kMilliseconds",d[d.kSeconds=11]="kSeconds",d[d.kInteger=12]="kInteger",d),eo=((f={})[f.kUNumber=0]="kUNumber",f[f.kUPercent=1]="kUPercent",f[f.kULength=2]="kULength",f[f.kUAngle=3]="kUAngle",f[f.kUTime=4]="kUTime",f[f.kUOther=5]="kUOther",f),es=((v={})[v.kYes=0]="kYes",v[v.kNo=1]="kNo",v),el=((p={})[p.kYes=0]="kYes",p[p.kNo=1]="kNo",p),eu=[{name:"em",unit_type:ea.kEms},{name:"px",unit_type:ea.kPixels},{name:"deg",unit_type:ea.kDegrees},{name:"rad",unit_type:ea.kRadians},{name:"grad",unit_type:ea.kGradians},{name:"ms",unit_type:ea.kMilliseconds},{name:"s",unit_type:ea.kSeconds},{name:"rem",unit_type:ea.kRems},{name:"turn",unit_type:ea.kTurns}],ec=((g={})[g.kUnknownType=0]="kUnknownType",g[g.kUnparsedType=1]="kUnparsedType",g[g.kKeywordType=2]="kKeywordType",g[g.kUnitType=3]="kUnitType",g[g.kSumType=4]="kSumType",g[g.kProductType=5]="kProductType",g[g.kNegateType=6]="kNegateType",g[g.kInvertType=7]="kInvertType",g[g.kMinType=8]="kMinType",g[g.kMaxType=9]="kMaxType",g[g.kClampType=10]="kClampType",g[g.kTransformType=11]="kTransformType",g[g.kPositionType=12]="kPositionType",g[g.kURLImageType=13]="kURLImageType",g[g.kColorType=14]="kColorType",g[g.kUnsupportedColorType=15]="kUnsupportedColorType",g),eh=function(t){switch(t){case ea.kNumber:case ea.kInteger:return eo.kUNumber;case ea.kPercentage:return eo.kUPercent;case ea.kPixels:return eo.kULength;case ea.kMilliseconds:case ea.kSeconds:return eo.kUTime;case ea.kDegrees:case ea.kRadians:case ea.kGradians:case ea.kTurns:return eo.kUAngle;default:return eo.kUOther;}},ed=function(t){switch(t){case eo.kUNumber:return ea.kNumber;case eo.kULength:return ea.kPixels;case eo.kUPercent:return ea.kPercentage;case eo.kUTime:return ea.kSeconds;case eo.kUAngle:return ea.kDegrees;default:return ea.kUnknown;}},ef=function(t){var e=1;switch(t){case ea.kPixels:case ea.kDegrees:case ea.kSeconds:break;case ea.kMilliseconds:e=.001;break;case ea.kRadians:e=180/Math.PI;break;case ea.kGradians:e=.9;break;case ea.kTurns:e=360;}return e;},ev=function(t){switch(t){case ea.kNumber:case ea.kInteger:break;case ea.kPercentage:return"%";case ea.kEms:return"em";case ea.kRems:return"rem";case ea.kPixels:return"px";case ea.kDegrees:return"deg";case ea.kRadians:return"rad";case ea.kGradians:return"grad";case ea.kMilliseconds:return"ms";case ea.kSeconds:return"s";case ea.kTurns:return"turn";}return"";},ep=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"toString",value:function(){return this.buildCSSText(es.kNo,el.kNo,"");}},{key:"isNumericValue",value:function(){return this.getType()>=ec.kUnitType&&this.getType()<=ec.kClampType;}}],[{key:"isAngle",value:function(t){return t===ea.kDegrees||t===ea.kRadians||t===ea.kGradians||t===ea.kTurns;}},{key:"isLength",value:function(t){return t>=ea.kEms&&t<ea.kDegrees;}},{key:"isRelativeUnit",value:function(t){return t===ea.kPercentage||t===ea.kEms||t===ea.kRems;}},{key:"isTime",value:function(t){return t===ea.kSeconds||t===ea.kMilliseconds;}}]),eg=function(t){function e(t){var n;return(0,C.default)(this,e),(n=(0,L.default)(this,e)).colorSpace=t,n;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getType",value:function(){return ec.kColorType;}},{key:"to",value:function(t){return this;}}]);}(ep),ey=((y={})[y.Constant=0]="Constant",y[y.LinearGradient=1]="LinearGradient",y[y.RadialGradient=2]="RadialGradient",y),em=function(t){function e(t,n){var r;return(0,C.default)(this,e),(r=(0,L.default)(this,e)).type=t,r.value=n,r;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return new e(this.type,this.value);}},{key:"buildCSSText",value:function(t,e,n){return n;}},{key:"getType",value:function(){return ec.kColorType;}}]);}(ep),ek=function(t){function e(t){var n;return(0,C.default)(this,e),(n=(0,L.default)(this,e)).value=t,n;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return new e(this.value);}},{key:"getType",value:function(){return ec.kKeywordType;}},{key:"buildCSSText",value:function(t,e,n){return n+this.value;}}]);}(ep),eE=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(Number.isFinite(t)?"NaN":t>0?"infinity":"-infinity")+e;},ex=function(t){return ed(eh(t));},eT=function(t){function e(t){var n,r,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ea.kNumber;return(0,C.default)(this,e),r=(0,L.default)(this,e),i="string"==typeof a?(n=a)?"number"===n?ea.kNumber:"percent"===n||"%"===n?ea.kPercentage:eu.find(function(t){return t.name===n;}).unit_type:ea.kUnknown:a,r.unit=i,r.value=t,r;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return new e(this.value,this.unit);}},{key:"equals",value:function(t){return this.value===t.value&&this.unit===t.unit;}},{key:"getType",value:function(){return ec.kUnitType;}},{key:"convertTo",value:function(t){if(this.unit===t)return new e(this.value,this.unit);var n=ex(this.unit);if(n!==ex(t)||n===ea.kUnknown)return null;var r=ef(this.unit)/ef(t);return new e(this.value*r,t);}},{key:"buildCSSText",value:function(t,e,n){var r;switch(this.unit){case ea.kUnknown:break;case ea.kInteger:r=Number(this.value).toFixed(0);break;case ea.kNumber:case ea.kPercentage:case ea.kEms:case ea.kRems:case ea.kPixels:case ea.kDegrees:case ea.kRadians:case ea.kGradians:case ea.kMilliseconds:case ea.kSeconds:case ea.kTurns:var i=this.value,a=ev(this.unit);if(i<-999999||i>999999){var o=ev(this.unit);r=!Number.isFinite(i)||Number.isNaN(i)?eE(i,o):i+(o||"");}else r="".concat(i).concat(a);}return n+r;}}]);}(ep),eN=new eT(0,"px");new eT(1,"px");var eb=new eT(0,"deg"),eS=function(t){function e(t,n,r){var i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return(0,C.default)(this,e),(i=(0,L.default)(this,e,["rgb"])).r=t,i.g=n,i.b=r,i.alpha=a,i.isNone=o,i;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return new e(this.r,this.g,this.b,this.alpha);}},{key:"buildCSSText",value:function(t,e,n){return"".concat(n,"rgba(").concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")");}}]);}(eg),ew=new ek("unset"),eP={"":ew,unset:ew,initial:new ek("initial"),inherit:new ek("inherit")},eM=new eS(0,0,0,0,!0),eA=new eS(0,0,0,0),eC=ei(function(t,e,n,r){return new eS(t,e,n,r);},function(t,e,n,r){return"rgba(".concat(t,",").concat(e,",").concat(n,",").concat(r,")");}),eR=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ea.kNumber;return new eT(t,e);};new eT(50,"%");var eO=function(){var t={linearGradient:/^(linear\-gradient)/i,repeatingLinearGradient:/^(repeating\-linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,repeatingRadialGradient:/^(repeating\-radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},e="";function n(t){throw Error("".concat(e,": ").concat(t));}function r(){return i("linear-gradient",t.linearGradient,o)||i("repeating-linear-gradient",t.repeatingLinearGradient,o)||i("radial-gradient",t.radialGradient,s)||i("repeating-radial-gradient",t.repeatingRadialGradient,s)||i("conic-gradient",t.conicGradient,s);}function i(e,r,i){return a(r,function(r){var a=i();return a&&!m(t.comma)&&n("Missing comma before color stops"),{type:e,orientation:a,colorStops:d(f)};});}function a(e,r){var i=m(e);if(i){m(t.startCall)||n("Missing (");var a=r(i);return m(t.endCall)||n("Missing )"),a;}}function o(){return y("directional",t.sideOrCorner,1)||y("angular",t.angleValue,1);}function s(){var n,r,i=l();return i&&((n=[]).push(i),r=e,m(t.comma)&&((i=l())?n.push(i):e=r)),n;}function l(){var t,e,n=((t=y("shape",/^(circle)/i,0))&&(t.style=g()||u()),t||((e=y("shape",/^(ellipse)/i,0))&&(e.style=p()||u()),e));if(n)n.at=c();else{var r=u();if(r){n=r;var i=c();i&&(n.at=i);}else{var a=h();a&&(n={type:"default-radial",at:a});}}return n;}function u(){return y("extent-keyword",t.extentKeywords,1);}function c(){if(y("position",/^at/,0)){var t=h();return t||n("Missing positioning value"),t;}}function h(){var t={x:p(),y:p()};if(t.x||t.y)return{type:"position",value:t};}function d(e){var r=e(),i=[];if(r)for(i.push(r);m(t.comma);)(r=e())?i.push(r):n("One extra comma");return i;}function f(){var e=y("hex",t.hexColor,1)||a(t.rgbaColor,function(){return{type:"rgba",value:d(v)};})||a(t.rgbColor,function(){return{type:"rgb",value:d(v)};})||y("literal",t.literalColor,0);return e||n("Expected color definition"),e.length=p(),e;}function v(){return m(t.number)[1];}function p(){return y("%",t.percentageValue,1)||y("position-keyword",t.positionKeywords,1)||g();}function g(){return y("px",t.pixelValue,1)||y("em",t.emValue,1);}function y(t,e,n){var r=m(e);if(r)return{type:t,value:r[n]};}function m(t){var n=/^[\n\r\t\s]+/.exec(e);n&&k(n[0].length);var r=t.exec(e);return r&&k(r[0].length),r;}function k(t){e=e.substring(t);}return function(t){var i;return e=t,i=d(r),e.length>0&&n("Invalid input not EOF"),i;};}(),eL=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,eI=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,eD=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,e_=/[\d.]+:(#[^\s]+|[^\)]+\))/gi,eG={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},eF=ei(function(t){return eR("angular"===t.type?Number(t.value):eG[t.value]||0,"deg");}),eB=ei(function(t){var e=50,n=50,r="%",i="%";if((null==t?void 0:t.type)==="position"){var a=t.value,o=a.x,s=a.y;(null==o?void 0:o.type)==="position-keyword"&&("left"===o.value?e=0:"center"===o.value?e=50:"right"===o.value?e=100:"top"===o.value?n=0:"bottom"===o.value&&(n=100)),(null==s?void 0:s.type)==="position-keyword"&&("left"===s.value?e=0:"center"===s.value?n=50:"right"===s.value?e=100:"top"===s.value?n=0:"bottom"===s.value&&(n=100)),((null==o?void 0:o.type)==="px"||(null==o?void 0:o.type)==="%"||(null==o?void 0:o.type)==="em")&&(r=null==o?void 0:o.type,e=Number(o.value)),((null==s?void 0:s.type)==="px"||(null==s?void 0:s.type)==="%"||(null==s?void 0:s.type)==="em")&&(i=null==s?void 0:s.type,n=Number(s.value));}return{cx:eR(e,r),cy:eR(n,i)};}),eU=ei(function(t){if(t.indexOf("linear")>-1||t.indexOf("radial")>-1)return eO(t).map(function(t){var e=t.type,n=t.orientation,r=t.colorStops;!function(t){var e=t.length;t[e-1].length=null!==(a=t[e-1].length)&&void 0!==a?a:{type:"%",value:"100"},e>1&&(t[0].length=null!==(o=t[0].length)&&void 0!==o?o:{type:"%",value:"0"});for(var n=0,r=Number(t[0].length.value),i=1;i<e;i++){var a,o,s,l=null===(s=t[i].length)||void 0===s?void 0:s.value;if(!(0,F.isNil)(l)&&!(0,F.isNil)(r)){for(var u=1;u<i-n;u++)t[n+u].length={type:"%",value:"".concat(r+(Number(l)-r)*u/(i-n))};n=i,r=Number(l);}}}(r);var i=r.map(function(t){var e,n;return{offset:eR(Number(t.length.value),"%"),color:(e=t.type,n=t.value,"hex"===e?"#".concat(n):"literal"===e?n:"rgb"===e?"rgb(".concat(n.join(","),")"):"rgba(".concat(n.join(","),")"))};});if("linear-gradient"===e)return new em(ey.LinearGradient,{angle:n?eF(n):eb,steps:i});if("radial-gradient"===e&&(n||(n=[{type:"shape",value:"circle"}]),"shape"===n[0].type&&"circle"===n[0].value)){var a,o=eB(n[0].at),s=o.cx,l=o.cy;if(n[0].style){var u=n[0].style,c=u.type,h=u.value;"extent-keyword"===c?(eP[h]||(eP[h]=new ek(h)),a=eP[h]):a=eR(h,c);}return new em(ey.RadialGradient,{cx:s,cy:l,size:a,steps:i});}});var e=t[0];if("("===t[1]||"("===t[2]){if("l"===e){var n=eL.exec(t);if(n){var r,i=(null===(r=n[2].match(e_))||void 0===r?void 0:r.map(function(t){return t.split(":");}))||[];return[new em(ey.LinearGradient,{angle:eR(parseFloat(n[1]),"deg"),steps:i.map(function(t){var e=(0,D.default)(t,2),n=e[0],r=e[1];return{offset:eR(100*Number(n),"%"),color:r};})})];}}else if("r"===e){var a=function(t){var e=eI.exec(t);if(e){var n,r=(null===(n=e[4].match(e_))||void 0===n?void 0:n.map(function(t){return t.split(":");}))||[];return{cx:eR(50,"%"),cy:eR(50,"%"),steps:r.map(function(t){var e=(0,D.default)(t,2),n=e[0],r=e[1];return{offset:eR(100*Number(n),"%"),color:r};})};}return null;}(t);if(a){if(!(0,F.isString)(a))return[new em(ey.RadialGradient,a)];t=a;}}else if("p"===e)return function(t){var e=eD.exec(t);if(e){var n=e[1],r=e[2];switch(n){case"a":n="repeat";break;case"x":n="repeat-x";break;case"y":n="repeat-y";break;default:n="no-repeat";}return{image:r,repetition:n};}return null;}(t);}});function eV(t){return t&&!(0,F.isNil)(t.r)&&!(0,F.isNil)(t.g)&&!(0,F.isNil)(t.b);}var ez=ei(function(t){if((e=t)&&e.image)return(0,A.default)({repetition:"repeat"},t);if((0,F.isNil)(t)&&(t=""),"transparent"===t)return eA;if("currentColor"===t)t="black";else if("none"===t)return eM;var e,n=eU(t);if(n)return n;var r=tJ(t),i=[0,0,0,0];return null!==r&&(i[0]=r.r||0,i[1]=r.g||0,i[2]=r.b||0,i[3]=r.opacity),eC.apply(void 0,i);});function eH(t,e){if(eV(t)&&eV(e))return[[Number(t.r),Number(t.g),Number(t.b),Number(t.alpha)],[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],function(t){var e=t.slice();if(e[3])for(var n=0;n<3;n++)e[n]=Math.round((0,F.clamp)(e[n],0,255));return e[3]=(0,F.clamp)(e[3],0,1),"rgba(".concat(e.join(","),")");}];}function eY(t,e){if((0,F.isNil)(e))return eR(0,"px");if(isFinite(Number(e="".concat(e).trim().toLowerCase()))){if("px".search(t)>=0)return eR(Number(e),"px");if("deg".search(t)>=0)return eR(Number(e),"deg");}var n=[];e=e.replace(t,function(t){return n.push(t),"U".concat(t);});var r="U(".concat(t.source,")");return n.map(function(t){return eR(Number(e.replace(RegExp("U".concat(t),"g"),"").replace(RegExp(r,"g"),"*0")),t);})[0];}var eW=function(t){return eY(/px/g,t);},eq=ei(eW);ei(function(t){return eY(RegExp("%","g"),t);});var eX=function(t){return(0,F.isNumber)(t)||isFinite(Number(t))?eR(Number(t)||0,"px"):eY(RegExp("px|%|em|rem","g"),t);},ej=ei(eX),e$=function(t){return eY(RegExp("deg|rad|grad|turn","g"),t);},eK=ei(e$);function eZ(t){var e=0;return t.unit===ea.kDegrees?e=t.value:t.unit===ea.kRadians?e=Number(t.value)*tv:t.unit===ea.kTurns?e=360*Number(t.value):t.value&&(e=t.value),e;}function eQ(t,e){var n;return(Array.isArray(t)?n=t.map(function(t){return Number(t);}):(0,F.isString)(t)?n=t.split(" ").map(function(t){return Number(t);}):(0,F.isNumber)(t)&&(n=[t]),2===e)?1===n.length?[n[0],n[0]]:[n[0],n[1]]:4===e?1===n.length?[n[0],n[0],n[0],n[0]]:2===n.length?[n[0],n[1],n[0],n[1]]:3===n.length?[n[0],n[1],n[2],n[1]]:[n[0],n[1],n[2],n[3]]:"even"===e&&n.length%2==1?[].concat((0,O.default)(n),(0,O.default)(n)):n;}function eJ(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t.unit===ea.kPixels)return Number(t.value);if(t.unit===ea.kPercentage&&n){var i=n.nodeName===j.GROUP?n.getLocalBounds():n.getGeometryBounds();return(r?i.min[e]:0)+t.value/100*i.halfExtents[e]*2;}return 0;}var e0=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function e1(t){return t.toString();}var e2=function(t){return"number"==typeof t?eR(t):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(t)?eR(Number(t)):eR(0);},e3=ei(e2);function e4(t,e){return[t,e,e1];}function e5(t,e){return function(n,r){return[n,r,function(n){return e1((0,F.clamp)(n,t,e));}];};}function e6(t,e){if(t.length===e.length)return[t,e,function(t){return t;}];}function e7(t){return 0===t.parsedStyle.d.totalLength&&(t.parsedStyle.d.totalLength=(0,F.getTotalLength)(t.parsedStyle.d.absolutePath)),t.parsedStyle.d.totalLength;}function e9(t,e){return t[0]===e[0]&&t[1]===e[1];}function e8(t,e){var n=t.prePoint,r=t.currentPoint,i=t.nextPoint,a=Math.pow(r[0]-n[0],2)+Math.pow(r[1]-n[1],2),o=Math.pow(r[0]-i[0],2)+Math.pow(r[1]-i[1],2),s=Math.acos((a+o-(Math.pow(n[0]-i[0],2)+Math.pow(n[1]-i[1],2)))/(2*Math.sqrt(a)*Math.sqrt(o)));if(!s||0===Math.sin(s)||(0,F.isNumberEqual)(s,0))return{xExtra:0,yExtra:0};var l=Math.abs(Math.atan2(i[1]-r[1],i[0]-r[0])),u=Math.abs(Math.atan2(i[0]-r[0],i[1]-r[1]));return{xExtra:e/2*(1/Math.sin(s/2))*Math.cos(s/2-(l=l>Math.PI/2?Math.PI-l:l))-e/2||0,yExtra:e/2*(1/Math.sin(s/2))*Math.cos((u=u>Math.PI/2?Math.PI-u:u)-s/2)-e/2||0};}function nt(t,e){return[e[0]+(e[0]-t[0]),e[1]+(e[1]-t[1])];}ei(function(t){return(0,F.isString)(t)?t.split(" ").map(e3):t.map(e3);});var ne=function(t,e){var n=t.x*e.x+t.y*e.y,r=Math.sqrt((Math.pow(t.x,2)+Math.pow(t.y,2))*(Math.pow(e.x,2)+Math.pow(e.y,2)));return(t.x*e.y-t.y*e.x<0?-1:1)*Math.acos(n/r);},nn=function(t,e,n,r,i,a,o,s){e=Math.abs(e),n=Math.abs(n);var l=(r=(0,F.mod)(r,360))*tf;if(t.x===o.x&&t.y===o.y)return{x:t.x,y:t.y,ellipticalArcAngle:0};if(0===e||0===n)return{x:0,y:0,ellipticalArcAngle:0};var u=(t.x-o.x)/2,c=(t.y-o.y)/2,h={x:Math.cos(l)*u+Math.sin(l)*c,y:-Math.sin(l)*u+Math.cos(l)*c},d=Math.pow(h.x,2)/Math.pow(e,2)+Math.pow(h.y,2)/Math.pow(n,2);d>1&&(e*=Math.sqrt(d),n*=Math.sqrt(d));var f=(Math.pow(e,2)*Math.pow(n,2)-Math.pow(e,2)*Math.pow(h.y,2)-Math.pow(n,2)*Math.pow(h.x,2))/(Math.pow(e,2)*Math.pow(h.y,2)+Math.pow(n,2)*Math.pow(h.x,2)),v=(i!==a?1:-1)*Math.sqrt(f=f<0?0:f),p={x:v*(e*h.y/n),y:v*(-(n*h.x)/e)},g={x:Math.cos(l)*p.x-Math.sin(l)*p.y+(t.x+o.x)/2,y:Math.sin(l)*p.x+Math.cos(l)*p.y+(t.y+o.y)/2},y={x:(h.x-p.x)/e,y:(h.y-p.y)/n},m=ne({x:1,y:0},y),k=ne(y,{x:(-h.x-p.x)/e,y:(-h.y-p.y)/n});!a&&k>0?k-=2*Math.PI:a&&k<0&&(k+=2*Math.PI);var E=m+(k%=2*Math.PI)*s,x=e*Math.cos(E),T=n*Math.sin(E);return{x:Math.cos(l)*x-Math.sin(l)*T+g.x,y:Math.sin(l)*x+Math.cos(l)*T+g.y,ellipticalArcStartAngle:m,ellipticalArcEndAngle:m+k,ellipticalArcAngle:E,ellipticalArcCenter:g,resultantRx:e,resultantRy:n};};function nr(t,e){var n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=t.arcParams,i=r.rx,a=void 0===i?0:i,o=r.ry,s=void 0===o?0:o,l=r.xRotation,u=r.arcFlag,c=r.sweepFlag,h=nn({x:t.prePoint[0],y:t.prePoint[1]},a,s,l,!!u,!!c,{x:t.currentPoint[0],y:t.currentPoint[1]},e),d=nn({x:t.prePoint[0],y:t.prePoint[1]},a,s,l,!!u,!!c,{x:t.currentPoint[0],y:t.currentPoint[1]},n?e+.005:e-.005),f=d.x-h.x,v=d.y-h.y,p=Math.sqrt(f*f+v*v);return{x:-f/p,y:-v/p};}function ni(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1]);}function na(t,e){return ni(t)*ni(e)?(t[0]*e[0]+t[1]*e[1])/(ni(t)*ni(e)):1;}function no(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(na(t,e));}var ns=function(t){if(""===t||Array.isArray(t)&&0===t.length)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};try{e=(0,F.normalizePath)(t);}catch(n){e=(0,F.normalizePath)(""),console.error("[g]: Invalid SVG Path definition: ".concat(t));}!function(t){for(var e=0;e<t.length;e++){var n=t[e-1],r=t[e];if("M"===r[0]&&n){var i=n[0],a=[r[1],r[2]],o=void 0;"L"===i||"M"===i?o=[n[1],n[2]]:("C"===i||"A"===i||"Q"===i)&&(o=[n[n.length-2],n[n.length-1]]),o&&e9(a,o)&&(t.splice(e,1),e--);}}}(e);var e,n=function(t){for(var e=!1,n=t.length,r=0;r<n;r++){var i=t[r][0];if("C"===i||"A"===i||"Q"===i){e=!0;break;}}return e;}(e),r=function(t){for(var e=[],n=[],r=[],i=0;i<t.length;i++){var a=t[i],o=a[0];"M"===o?(r.length&&(n.push(r),r=[]),r.push([a[1],a[2]])):"Z"===o?r.length&&(e.push(r),r=[]):r.push([a[1],a[2]]);}return r.length>0&&n.push(r),{polygons:e,polylines:n};}(e),i=r.polygons,a=r.polylines,o=function(t){for(var e=[],n=null,r=null,i=null,a=0,o=t.length,s=0;s<o;s++){var l=t[s];r=t[s+1];var u=l[0],c={command:u,prePoint:n,params:l,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(u){case"M":i=[l[1],l[2]],a=s;break;case"A":var h=function(t,e){var n=e[1],r=e[2],i=(0,F.mod)(e[3]*tf,2*Math.PI),a=e[4],o=e[5],s=t[0],l=t[1],u=e[6],c=e[7],h=Math.cos(i)*(s-u)/2+Math.sin(i)*(l-c)/2,d=-1*Math.sin(i)*(s-u)/2+Math.cos(i)*(l-c)/2,f=h*h/(n*n)+d*d/(r*r);f>1&&(n*=Math.sqrt(f),r*=Math.sqrt(f));var v=n*n*(d*d)+r*r*(h*h),p=v?Math.sqrt((n*n*(r*r)-v)/v):1;a===o&&(p*=-1),isNaN(p)&&(p=0);var g=r?p*n*d/r:0,y=n?-(p*r)*h/n:0,m=(s+u)/2+Math.cos(i)*g-Math.sin(i)*y,k=(l+c)/2+Math.sin(i)*g+Math.cos(i)*y,E=[(h-g)/n,(d-y)/r],x=[(-1*h-g)/n,(-1*d-y)/r],T=no([1,0],E),N=no(E,x);return -1>=na(E,x)&&(N=Math.PI),na(E,x)>=1&&(N=0),0===o&&N>0&&(N-=2*Math.PI),1===o&&N<0&&(N+=2*Math.PI),{cx:m,cy:k,rx:e9(t,[u,c])?0:n,ry:e9(t,[u,c])?0:r,startAngle:T,endAngle:T+N,xRotation:i,arcFlag:a,sweepFlag:o};}(n,l);c.arcParams=h;}if("Z"===u)n=i,r=t[a+1];else{var d=l.length;n=[l[d-2],l[d-1]];}r&&"Z"===r[0]&&(r=t[a],e[a]&&(e[a].prePoint=n)),c.currentPoint=n,e[a]&&e9(n,e[a].currentPoint)&&(e[a].prePoint=c.prePoint);var f=r?[r[r.length-2],r[r.length-1]]:null;c.nextPoint=f;var v=c.prePoint;if(["L","H","V"].includes(u))c.startTangent=[v[0]-n[0],v[1]-n[1]],c.endTangent=[n[0]-v[0],n[1]-v[1]];else if("Q"===u){var p=[l[1],l[2]];c.startTangent=[v[0]-p[0],v[1]-p[1]],c.endTangent=[n[0]-p[0],n[1]-p[1]];}else if("T"===u){var g=e[s-1],y=nt(g.currentPoint,v);"Q"===g.command?(c.command="Q",c.startTangent=[v[0]-y[0],v[1]-y[1]],c.endTangent=[n[0]-y[0],n[1]-y[1]]):(c.command="TL",c.startTangent=[v[0]-n[0],v[1]-n[1]],c.endTangent=[n[0]-v[0],n[1]-v[1]]);}else if("C"===u){var m=[l[1],l[2]],k=[l[3],l[4]];c.startTangent=[v[0]-m[0],v[1]-m[1]],c.endTangent=[n[0]-k[0],n[1]-k[1]],0===c.startTangent[0]&&0===c.startTangent[1]&&(c.startTangent=[m[0]-k[0],m[1]-k[1]]),0===c.endTangent[0]&&0===c.endTangent[1]&&(c.endTangent=[k[0]-m[0],k[1]-m[1]]);}else if("S"===u){var E=e[s-1],x=nt(E.currentPoint,v),T=[l[1],l[2]];"C"===E.command?(c.command="C",c.startTangent=[v[0]-x[0],v[1]-x[1]]):(c.command="SQ",c.startTangent=[v[0]-T[0],v[1]-T[1]]),c.endTangent=[n[0]-T[0],n[1]-T[1]];}else if("A"===u){var N=nr(c,0),b=N.x,S=N.y,w=nr(c,1,!1),P=w.x,M=w.y;c.startTangent=[b,S],c.endTangent=[P,M];}e.push(c);}return e;}(e),s=function(t,e){for(var n=[],r=[],i=[],a=0;a<t.length;a++){var o=t[a],s=o.currentPoint,l=o.params,u=o.prePoint,c=void 0;switch(o.command){case"Q":c=(0,z.quadBox)(u[0],u[1],l[1],l[2],l[3],l[4]);break;case"C":c=(0,z.cubicBox)(u[0],u[1],l[1],l[2],l[3],l[4],l[5],l[6]);break;case"A":var h=o.arcParams;c=(0,z.arcBox)(h.cx,h.cy,h.rx,h.ry,h.xRotation,h.startAngle,h.endAngle);break;default:n.push(s[0]),r.push(s[1]);}c&&(o.box=c,n.push(c.x,c.x+c.width),r.push(c.y,c.y+c.height));}n=n.filter(function(t){return!Number.isNaN(t)&&t!==1/0&&t!==-1/0;}),r=r.filter(function(t){return!Number.isNaN(t)&&t!==1/0&&t!==-1/0;});var d=(0,F.min)(n),f=(0,F.min)(r),v=(0,F.max)(n),p=(0,F.max)(r);if(0===i.length)return{x:d,y:f,width:v-d,height:p-f};for(var g=0;g<i.length;g++){var y=i[g],m=y.currentPoint;m[0]===d?d-=e8(y,0).xExtra:m[0]===v&&(v+=e8(y,0).xExtra),m[1]===f?f-=e8(y,e).yExtra:m[1]===p&&(p+=e8(y,e).yExtra);}return{x:d,y:f,width:v-d,height:p-f};}(o,0),l=s.x,u=s.y,c=s.width,h=s.height;return{absolutePath:e,hasArc:n,segments:o,polygons:i,polylines:a,totalLength:0,rect:{x:Number.isFinite(l)?l:0,y:Number.isFinite(u)?u:0,width:Number.isFinite(c)?c:0,height:Number.isFinite(h)?h:0}};},nl=ei(ns);function nu(t){return(0,F.isString)(t)?nl(t):ns(t);}function nc(t,e,n){var r=t.curve,i=e.curve;r&&0!==r.length||(r=(0,F.path2Curve)(t.absolutePath,!1),t.curve=r),i&&0!==i.length||(i=(0,F.path2Curve)(e.absolutePath,!1),e.curve=i);var a=[r,i];r.length!==i.length&&(a=(0,F.equalizeSegments)(r,i));var o=(0,F.getDrawDirection)(a[0])!==(0,F.getDrawDirection)(a[1])?(0,F.reverseCurve)(a[0]):(0,F.clonePath)(a[0]);return[o,(0,F.getRotatedCurve)(a[1],o),function(t){return t;}];}function nh(t,e){return[t.points,e.points,function(t){return t;}];}var nd=/\s*(\w+)\(([^)]*)\)/g;function nf(t){return function(e){var n=0;return t.map(function(t){return null===t?e[n++]:t;});};}function nv(t){return t;}var np={matrix:["NNNNNN",[null,null,0,0,null,null,0,0,0,0,1,0,null,null,0,1],nv],matrix3d:["NNNNNNNNNNNNNNNN",nv],rotate:["A"],rotateX:["A"],rotateY:["A"],rotateZ:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",nf([null,null,new eT(1)]),nv],scaleX:["N",nf([null,new eT(1),new eT(1)]),nf([null,new eT(1)])],scaleY:["N",nf([new eT(1),null,new eT(1)]),nf([new eT(1),null])],scaleZ:["N",nf([new eT(1),new eT(1),null])],scale3d:["NNN",nv],skew:["Aa",null,nv],skewX:["A",null,nf([null,eb])],skewY:["A",null,nf([eb,null])],translate:["Tt",nf([null,null,eN]),nv],translateX:["T",nf([null,eN,eN]),nf([null,eN])],translateY:["T",nf([eN,null,eN]),nf([eN,null])],translateZ:["L",nf([eN,eN,null])],translate3d:["TTL",nv]};function ng(t){for(var e=[],n=t.length,r=0;r<n;r++){var i=t[r],a=i[0],o=i.slice(1);if("translate"===a||"skew"===a?1===o.length&&o.push(0):"scale"===a&&1===o.length&&o.push(o[0]),!np[a])return[];var s=o.map(function(t){return eR(t);});e.push({t:a,d:s});}return e;}function ny(t){if(Array.isArray(t))return ng(t);if("none"===(t=(t||"none").trim()))return[];var e,n=[],r=0;for(nd.lastIndex=0;(e=nd.exec(t))&&e.index===r;){r=e.index+e[0].length;var i=e[1],a=np[i];if(!a)break;var o=e[2].split(","),s=a[0];if(s.length<o.length)break;for(var l=[],u=0;u<s.length;u++){var c=o[u],h=s[u],d=void 0;if(void 0===(d=c?({A:function(t){return"0"===t.trim()?eb:e$(t);},N:e2,T:eX,L:eW})[h.toUpperCase()](c):({a:eb,n:l[0],t:eN})[h]))return[];l.push(d);}if(n.push({t:i,d:l}),nd.lastIndex===t.length)return n;}return[];}function nm(t){switch(t.t){case"rotateX":return[1,0,0,0,0,Math.cos(i=eZ(t.d[0])*tf),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1];case"rotateY":return[Math.cos(i=eZ(t.d[0])*tf),0,-Math.sin(i),0,0,1,0,0,Math.sin(i),0,Math.cos(i),0,0,0,0,1];case"rotate":case"rotateZ":return[Math.cos(i=eZ(t.d[0])*tf),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1,0,0,0,0,1];case"rotate3d":e=t.d[0].value,n=t.d[1].value,r=t.d[2].value,i=eZ(t.d[3])*tf;var e,n,r,i,a=e*e+n*n+r*r;if(0===a)e=1,n=0,r=0;else if(1!==a){var o=Math.sqrt(a);e/=o,n/=o,r/=o;}var s=Math.sin(i/2),l=s*Math.cos(i/2),u=s*s;return[1-2*(n*n+r*r)*u,2*(e*n*u+r*l),2*(e*r*u-n*l),0,2*(e*n*u-r*l),1-2*(e*e+r*r)*u,2*(n*r*u+e*l),0,2*(e*r*u+n*l),2*(n*r*u-e*l),1-2*(e*e+n*n)*u,0,0,0,0,1];case"scale":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scaleX":return[t.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaleY":return[1,0,0,0,0,t.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scaleZ":return[1,0,0,0,0,1,0,0,0,0,t.d[0].value,0,0,0,0,1];case"scale3d":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,t.d[2].value,0,0,0,0,1];case"skew":var c=eZ(t.d[0])*tf;return[1,Math.tan(eZ(t.d[1])*tf),0,0,Math.tan(c),1,0,0,0,0,1,0,0,0,0,1];case"skewX":return[1,0,0,0,Math.tan(i=eZ(t.d[0])*tf),1,0,0,0,0,1,0,0,0,0,1];case"skewY":return[1,Math.tan(i=eZ(t.d[0])*tf),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return[1,0,0,0,0,1,0,0,0,0,1,0,e=eJ(t.d[0],0,null)||0,n=eJ(t.d[1],0,null)||0,0,1];case"translateX":return[1,0,0,0,0,1,0,0,0,0,1,0,e=eJ(t.d[0],0,null)||0,0,0,1];case"translateY":return[1,0,0,0,0,1,0,0,0,0,1,0,0,n=eJ(t.d[0],0,null)||0,0,1];case"translateZ":return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,r=eJ(t.d[0],0,null)||0,1];case"translate3d":return[1,0,0,0,0,1,0,0,0,0,1,0,e=eJ(t.d[0],0,null)||0,n=eJ(t.d[1],0,null)||0,r=eJ(t.d[2],0,null)||0,1];case"perspective":var h=eJ(t.d[0],0,null)||0;return[1,0,0,0,0,1,0,0,0,0,1,h?-1/h:0,0,0,0,1];case"matrix":return[t.d[0].value,t.d[1].value,0,0,t.d[2].value,t.d[3].value,0,0,0,0,1,0,t.d[4].value,t.d[5].value,0,1];case"matrix3d":return t.d.map(function(t){return t.value;});}}function nk(t,e){return[t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12]*e[3],t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13]*e[3],t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]*e[3],t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15]*e[3],t[0]*e[4]+t[4]*e[5]+t[8]*e[6]+t[12]*e[7],t[1]*e[4]+t[5]*e[5]+t[9]*e[6]+t[13]*e[7],t[2]*e[4]+t[6]*e[5]+t[10]*e[6]+t[14]*e[7],t[3]*e[4]+t[7]*e[5]+t[11]*e[6]+t[15]*e[7],t[0]*e[8]+t[4]*e[9]+t[8]*e[10]+t[12]*e[11],t[1]*e[8]+t[5]*e[9]+t[9]*e[10]+t[13]*e[11],t[2]*e[8]+t[6]*e[9]+t[10]*e[10]+t[14]*e[11],t[3]*e[8]+t[7]*e[9]+t[11]*e[10]+t[15]*e[11],t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12]*e[15],t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13]*e[15],t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14]*e[15],t[3]*e[12]+t[7]*e[13]+t[11]*e[14]+t[15]*e[15]];}function nE(t){var e=[0,0,0],n=[1,1,1],r=[0,0,0],i=[0,0,0,1],a=[0,0,0,1];return!function(t,e,n,r,i,a){if(!(!function(t,e){var n=e[15];if(0===n)return!1;for(var r=1/n,i=0;i<16;i++)t[i]=e[i]*r;return!0;}(tm,t)||(G.mat4.copy(tk,tm),tk[3]=0,tk[7]=0,tk[11]=0,tk[15]=1,1e-8>Math.abs(G.mat4.determinant(tk))))){var o=tm[3],s=tm[7],l=tm[11],u=tm[12],c=tm[13],h=tm[14],d=tm[15];if(0!==o||0!==s||0!==l){if(tE[0]=o,tE[1]=s,tE[2]=l,tE[3]=d,!G.mat4.invert(tk,tk))return;G.mat4.transpose(tk,tk),G.vec4.transformMat4(i,tE,tk);}else i[0]=i[1]=i[2]=0,i[3]=1;if(e[0]=u,e[1]=c,e[2]=h,tx[0][0]=tm[0],tx[0][1]=tm[1],tx[0][2]=tm[2],tx[1][0]=tm[4],tx[1][1]=tm[5],tx[1][2]=tm[6],tx[2][0]=tm[8],tx[2][1]=tm[9],tx[2][2]=tm[10],n[0]=G.vec3.length(tx[0]),G.vec3.normalize(tx[0],tx[0]),r[0]=G.vec3.dot(tx[0],tx[1]),tN(tx[1],tx[1],tx[0],1,-r[0]),n[1]=G.vec3.length(tx[1]),G.vec3.normalize(tx[1],tx[1]),r[0]/=n[1],r[1]=G.vec3.dot(tx[0],tx[2]),tN(tx[2],tx[2],tx[0],1,-r[1]),r[2]=G.vec3.dot(tx[1],tx[2]),tN(tx[2],tx[2],tx[1],1,-r[2]),n[2]=G.vec3.length(tx[2]),G.vec3.normalize(tx[2],tx[2]),r[1]/=n[2],r[2]/=n[2],G.vec3.cross(tT,tx[1],tx[2]),0>G.vec3.dot(tx[0],tT))for(var f=0;f<3;f++)n[f]*=-1,tx[f][0]*=-1,tx[f][1]*=-1,tx[f][2]*=-1;a[0]=.5*Math.sqrt(Math.max(1+tx[0][0]-tx[1][1]-tx[2][2],0)),a[1]=.5*Math.sqrt(Math.max(1-tx[0][0]+tx[1][1]-tx[2][2],0)),a[2]=.5*Math.sqrt(Math.max(1-tx[0][0]-tx[1][1]+tx[2][2],0)),a[3]=.5*Math.sqrt(Math.max(1+tx[0][0]+tx[1][1]+tx[2][2],0)),tx[2][1]>tx[1][2]&&(a[0]=-a[0]),tx[0][2]>tx[2][0]&&(a[1]=-a[1]),tx[1][0]>tx[0][1]&&(a[2]=-a[2]);}}(0===t.length?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:t.map(nm).reduce(nk),e,n,r,i,a),[[e,n,r,a,i]];}var nx=function(){function t(t,e){for(var n=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],r=0;r<4;r++)for(var i=0;i<4;i++)for(var a=0;a<4;a++)n[r][i]+=e[r][a]*t[a][i];return n;}return function(e,n,r,i,a){for(var o,s=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],l=0;l<4;l++)s[l][3]=a[l];for(var u=0;u<3;u++)for(var c=0;c<3;c++)s[3][u]+=e[c]*s[c][u];var h=i[0],d=i[1],f=i[2],v=i[3],p=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];p[0][0]=1-2*(d*d+f*f),p[0][1]=2*(h*d-f*v),p[0][2]=2*(h*f+d*v),p[1][0]=2*(h*d+f*v),p[1][1]=1-2*(h*h+f*f),p[1][2]=2*(d*f-h*v),p[2][0]=2*(h*f-d*v),p[2][1]=2*(d*f+h*v),p[2][2]=1-2*(h*h+d*d),s=t(s,p);var g=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];r[2]&&(g[2][1]=r[2],s=t(s,g)),r[1]&&(g[2][1]=0,g[2][0]=r[0],s=t(s,g)),r[0]&&(g[2][0]=0,g[1][0]=r[0],s=t(s,g));for(var y=0;y<3;y++)for(var m=0;m<3;m++)s[y][m]*=n[y];return 0===(o=s)[0][2]&&0===o[0][3]&&0===o[1][2]&&0===o[1][3]&&0===o[2][0]&&0===o[2][1]&&1===o[2][2]&&0===o[2][3]&&0===o[3][2]&&1===o[3][3]?[s[0][0],s[0][1],s[1][0],s[1][1],s[3][0],s[3][1]]:s[0].concat(s[1],s[2],s[3]);};}();function nT(t){return t.toFixed(6).replace(".000000","");}function nN(t,e){var n,r;return(t.decompositionPair!==e&&(t.decompositionPair=e,n=nE(t)),e.decompositionPair!==t&&(e.decompositionPair=t,r=nE(e)),null===n[0]||null===r[0])?[[!1],[!0],function(n){return n?e[0].d:t[0].d;}]:(n[0].push(0),r[0].push(1),[n,r,function(t){var e=function(t,e,n){var r=function(t,e){for(var n=0,r=0;r<t.length;r++)n+=t[r]*e[r];return n;}(t,e);r=(0,F.clamp)(r,-1,1);var i=[];if(1===r)i=t;else for(var a=Math.acos(r),o=1*Math.sin(n*a)/Math.sqrt(1-r*r),s=0;s<4;s++)i.push(t[s]*(Math.cos(n*a)-r*o)+e[s]*o);return i;}(n[0][3],r[0][3],t[5]);return nx(t[0],t[1],t[2],e,t[4]).map(nT).join(",");}]);}function nb(t){return t.replace(/[XY]/,"");}function nS(t){return t.replace(/(X|Y|Z|3d)?$/,"3d");}function nw(t,e,n){var r=!1;if(!t.length||!e.length){t.length||(r=!0,t=e,e=[]);for(var i=0;i<t.length;i++)!function(){var n=t[i],r=n.t,a=n.d,o="scale"===r.substring(0,5)?1:0;e.push({t:r,d:a.map(function(t){return"number"==typeof t?eR(o):eR(o,t.unit);})});}();}var a=[],o=[],s=[];if(t.length!==e.length){var l=nN(t,e);a=[l[0]],o=[l[1]],s=[["matrix",[l[2]]]];}else for(var u=0;u<t.length;u++){var c=t[u].t,h=e[u].t,d=t[u].d,f=e[u].d,v=np[c],p=np[h],g=void 0;if("perspective"===c&&"perspective"===h||("matrix"===c||"matrix3d"===c)&&("matrix"===h||"matrix3d"===h)){var y=nN([t[u]],[e[u]]);a.push(y[0]),o.push(y[1]),s.push(["matrix",[y[2]]]);continue;}if(c===h)g=c;else if(v[2]&&p[2]&&nb(c)===nb(h))g=nb(c),d=v[2](d),f=p[2](f);else if(v[1]&&p[1]&&nS(c)===nS(h))g=nS(c),d=v[1](d),f=p[1](f);else{var m=nN(t,e);a=[m[0]],o=[m[1]],s=[["matrix",[m[2]]]];break;}for(var k=[],E=[],x=[],T=0;T<d.length;T++){var N=function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a="",o=t.value||0,s=e.value||0,l=ex(t.unit),u=t.convertTo(l),c=e.convertTo(l);return u&&c?(o=u.value,s=c.value,a=ev(t.unit)):(eT.isLength(t.unit)||eT.isLength(e.unit))&&(o=eJ(t,i,n),s=eJ(e,i,n),a="px"),[o,s,function(t){return r&&(t=Math.max(t,0)),t+a;}];}(d[T],f[T],n,!1,T);k[T]=N[0],E[T]=N[1],x.push(N[2]);}a.push(k),o.push(E),s.push([g,x]);}if(r){var b=a;a=o,o=b;}return[a,o,function(t){return t.map(function(t,e){var n=t.map(function(t,n){return s[e][1][n](t);}).join(",");return"matrix"===s[e][0]&&16===n.split(",").length&&(s[e][0]="matrix3d"),"matrix3d"===s[e][0]&&6===n.split(",").length&&(s[e][0]="matrix"),"".concat(s[e][0],"(").concat(n,")");}).join(" ");}];}var nP=ei(function(t){if((0,F.isString)(t)){if("text-anchor"===t)return[eR(0,"px"),eR(0,"px")];var e=t.split(" ");return(1===e.length&&("top"===e[0]||"bottom"===e[0]?(e[1]=e[0],e[0]="center"):e[1]="center"),2!==e.length)?null:[ej(nM(e[0])),ej(nM(e[1]))];}return[eR(t[0]||0,"px"),eR(t[1]||0,"px")];});function nM(t){return"center"===t?"50%":"left"===t||"top"===t?"0%":"right"===t||"bottom"===t?"100%":t;}var nA=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:t_.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:t_.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:t_.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:t_.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:t_.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:t_.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:t_.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:t_.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:t_.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:t_.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:t_.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:t_.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:t_.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:t_.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:t_.FILTER},{n:"clipPath",syntax:t_.DEFINED_PATH},{n:"textPath",syntax:t_.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:t_.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:t_.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:t_.COORDINATE},{n:"y1",int:!0,l:!0,syntax:t_.COORDINATE},{n:"z1",int:!0,l:!0,syntax:t_.COORDINATE},{n:"x2",int:!0,l:!0,syntax:t_.COORDINATE},{n:"y2",int:!0,l:!0,syntax:t_.COORDINATE},{n:"z2",int:!0,l:!0,syntax:t_.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:t_.PATH,p:50},{n:"points",int:!0,l:!0,syntax:t_.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:t_.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:t_.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:t_.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:t_.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:t_.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:t_.NUMBER,d:function(t){return t===j.PATH||t===j.POLYGON||t===j.POLYLINE?"4":"10";}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:t_.MARKER},{n:"markerEnd",syntax:t_.MARKER},{n:"markerMid",syntax:t_.MARKER},{n:"markerStartOffset",syntax:t_.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:t_.LENGTH,l:!0,int:!0,d:"0"}],nC=new Set(nA.filter(function(t){return!!t.l;}).map(function(t){return t.n;})),nR={},nO=(0,R.default)(function t(e){var n=this;(0,C.default)(this,t),this.runtime=e,nA.forEach(function(t){n.registerMetadata(t);});},[{key:"registerMetadata",value:function(t){[t.n].concat((0,O.default)(t.a||[])).forEach(function(e){nR[e]=t;});}},{key:"getPropertySyntax",value:function(t){return this.runtime.CSSPropertySyntaxFactory[t];}},{key:"processProperties",value:function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[],memoize:!0};Object.assign(t.attributes,e);var i=t.parsedStyle.clipPath,a=t.parsedStyle.offsetPath;!function(t,e){var n=nL(t);for(var r in e)n.has(r)&&(t.parsedStyle[r]=e[r]);}(t,e);var o=!!r.forceUpdateGeometry;if(!o){for(var s in e)if(nC.has(s)){o=!0;break;}}var l=nL(t);l.has("fill")&&e.fill&&(t.parsedStyle.fill=ez(e.fill)),l.has("stroke")&&e.stroke&&(t.parsedStyle.stroke=ez(e.stroke)),l.has("shadowColor")&&e.shadowColor&&(t.parsedStyle.shadowColor=ez(e.shadowColor)),l.has("filter")&&e.filter&&(t.parsedStyle.filter=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if("none"===(e=e.toLowerCase().trim()))return[];for(var n=/\s*([\w-]+)\(([^)]*)\)/g,r=[],i=0;(t=n.exec(e))&&t.index===i;)if(i=t.index+t[0].length,e0.indexOf(t[1])>-1&&r.push({name:t[1],params:t[2].split(" ").map(function(t){return eY(/deg|rad|grad|turn|px|%/g,t)||ez(t);})}),n.lastIndex===e.length)return r;return[];}(e.filter)),l.has("radius")&&!(0,F.isNil)(e.radius)&&(t.parsedStyle.radius=eQ(e.radius,4)),l.has("lineDash")&&!(0,F.isNil)(e.lineDash)&&(t.parsedStyle.lineDash=eQ(e.lineDash,"even")),l.has("points")&&e.points&&(t.parsedStyle.points=(n=e.points,{points:(0,F.isString)(n)?n.split(" ").map(function(t){var e=t.split(","),n=(0,D.default)(e,2),r=n[0],i=n[1];return[Number(r),Number(i)];}):n,totalLength:0,segments:[]})),l.has("d")&&""===e.d&&(t.parsedStyle.d=(0,A.default)({},tD)),l.has("d")&&e.d&&(t.parsedStyle.d=nu(e.d)),l.has("textTransform")&&e.textTransform&&this.runtime.CSSPropertySyntaxFactory[t_.TEXT_TRANSFORM].calculator(null,null,{value:e.textTransform},t,null),l.has("clipPath")&&!(0,F.isUndefined)(e.clipPath)&&this.runtime.CSSPropertySyntaxFactory[t_.DEFINED_PATH].calculator("clipPath",i,e.clipPath,t,this.runtime),l.has("offsetPath")&&e.offsetPath&&this.runtime.CSSPropertySyntaxFactory[t_.DEFINED_PATH].calculator("offsetPath",a,e.offsetPath,t,this.runtime),l.has("transform")&&e.transform&&(t.parsedStyle.transform=function(t){if(Array.isArray(t))return ng(t);if("none"===(t=(t||"none").trim()))return[];var e,n=[],r=0;for(nd.lastIndex=0;(e=nd.exec(t))&&e.index===r;){r=e.index+e[0].length;var i=e[1],a=np[i];if(!a)break;var o=e[2].split(","),s=a[0];if(s.length<o.length)break;for(var l=[],u=0;u<s.length;u++){var c=o[u],h=s[u],d=void 0;if(void 0===(d=c?({A:function(t){return"0"===t.trim()?eb:eK(t);},N:e3,T:ej,L:eq})[h.toUpperCase()](c):({a:eb,n:l[0],t:eN})[h]))return[];l.push(d);}if(n.push({t:i,d:l}),nd.lastIndex===t.length)return n;}return[];}(e.transform)),l.has("transformOrigin")&&e.transformOrigin&&(t.parsedStyle.transformOrigin=nP(e.transformOrigin)),l.has("markerStart")&&e.markerStart&&(t.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory[t_.MARKER].calculator(null,e.markerStart,e.markerStart,null,null)),l.has("markerEnd")&&e.markerEnd&&(t.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory[t_.MARKER].calculator(null,e.markerEnd,e.markerEnd,null,null)),l.has("markerMid")&&e.markerMid&&(t.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory[t_.MARKER].calculator("",e.markerMid,e.markerMid,null,null)),l.has("zIndex")&&!(0,F.isNil)(e.zIndex)&&this.runtime.CSSPropertySyntaxFactory[t_.Z_INDEX].postProcessor(t),l.has("offsetDistance")&&!(0,F.isNil)(e.offsetDistance)&&this.runtime.CSSPropertySyntaxFactory[t_.OFFSET_DISTANCE].postProcessor(t),l.has("transform")&&e.transform&&this.runtime.CSSPropertySyntaxFactory[t_.TRANSFORM].postProcessor(t),l.has("transformOrigin")&&e.transformOrigin&&this.runtime.CSSPropertySyntaxFactory[t_.TRANSFORM_ORIGIN].postProcessor(t),o&&(t.dirty(!0,!0),r.forceUpdateGeometry||this.runtime.sceneGraphService.dirtyToRoot(t));}},{key:"updateGeometry",value:function(t){var e=t.nodeName,n=this.runtime.geometryUpdaterFactory[e];if(n){var r=t.geometry;r.contentBounds||(r.contentBounds=new tr),r.renderBounds||(r.renderBounds=new tr);var i=t.parsedStyle,a=n.update(i,t),o=a.cx,s=a.cy,l=a.cz,u=a.hwidth,c=void 0===u?0:u,h=a.hheight,d=void 0===h?0:h,f=a.hdepth,v=[Math.abs(c),Math.abs(d),void 0===f?0:f],p=i.stroke,g=i.lineWidth,y=i.increasedLineWidthForHitTesting,m=i.shadowType,k=void 0===m?"outer":m,E=i.shadowColor,x=i.filter,T=i.transformOrigin,N=[void 0===o?0:o,void 0===s?0:s,void 0===l?0:l];r.contentBounds.update(N,v);var b=e===j.POLYLINE||e===j.POLYGON||e===j.PATH?Math.SQRT2:.5;if(p&&!p.isNone){var S=(((void 0===g?1:g)||0)+((void 0===y?0:y)||0))*b;v[0]+=S,v[1]+=S;}if(r.renderBounds.update(N,v),E&&k&&"inner"!==k){var w=r.renderBounds,P=w.min,M=w.max,A=i.shadowBlur,C=i.shadowOffsetX,R=i.shadowOffsetY,O=A||0,L=C||0,I=R||0,D=P[0]-O+L,_=M[0]+O+L,F=P[1]-O+I,B=M[1]+O+I;P[0]=Math.min(P[0],D),M[0]=Math.max(M[0],_),P[1]=Math.min(P[1],F),M[1]=Math.max(M[1],B),r.renderBounds.setMinMax(P,M);}(void 0===x?[]:x).forEach(function(t){var e=t.name,n=t.params;if("blur"===e){var i=n[0].value;r.renderBounds.update(r.renderBounds.center,G.vec3.add(r.renderBounds.halfExtents,r.renderBounds.halfExtents,[i,i,0]));}else if("drop-shadow"===e){var a=n[0].value,o=n[1].value,s=n[2].value,l=r.renderBounds,u=l.min,c=l.max,h=u[0]-s+a,d=c[0]+s+a,f=u[1]-s+o,v=c[1]+s+o;u[0]=Math.min(u[0],h),c[0]=Math.max(c[0],d),u[1]=Math.min(u[1],f),c[1]=Math.max(c[1],v),r.renderBounds.setMinMax(u,c);}}),t.geometry.dirty=!1;var U=d<0,V=(c<0?-1:1)*(T?eJ(T[0],0,t,!0):0),z=(U?-1:1)*(T?eJ(T[1],1,t,!0):0);(V||z)&&t.setOrigin(V,z);}}},{key:"updateSizeAttenuation",value:function(t,e){t.style.isSizeAttenuation?(t.style.rawLineWidth||(t.style.rawLineWidth=t.style.lineWidth),t.style.lineWidth=(t.style.rawLineWidth||1)/e,t.nodeName===j.CIRCLE&&(t.style.rawR||(t.style.rawR=t.style.r),t.style.r=(t.style.rawR||1)/e)):(t.style.rawLineWidth&&(t.style.lineWidth=t.style.rawLineWidth,delete t.style.rawLineWidth),t.nodeName===j.CIRCLE&&t.style.rawR&&(t.style.r=t.style.rawR,delete t.style.rawR));}}]);function nL(t){return t.constructor.PARSED_STYLE_LIST;}var nI=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e4;},[{key:"calculator",value:function(t,e,n,r){return eZ(n);}}]),nD=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r,i){return n instanceof ek&&(n=null),i.sceneGraphService.updateDisplayObjectDependency(t,e,n,r),"clipPath"===t&&r.forEach(function(t){0===t.childNodes.length&&i.sceneGraphService.dirtyToRoot(t);}),n;}}]),n_=(0,R.default)(function t(){(0,C.default)(this,t),this.parser=ez,this.mixer=eH;},[{key:"calculator",value:function(t,e,n,r){return n instanceof ek?"none"===n.value?eM:eA:n;}}]),nG=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n){return n instanceof ek?[]:n;}}]);function nF(t){var e=t.parsedStyle.fontSize;return(0,F.isNil)(e)?null:e;}var nB=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e4;},[{key:"calculator",value:function(t,e,n,r,i){if((0,F.isNumber)(n))return n;if(!eT.isRelativeUnit(n.unit))return n.value;if(n.unit===ea.kPercentage)return 0;if(n.unit===ea.kEms){if(r.parentNode){var a,o=nF(r.parentNode);if(o)return o*n.value;}return 0;}if(n.unit===ea.kRems){if(null!=r&&null!==(a=r.ownerDocument)&&void 0!==a&&a.documentElement){var s=nF(r.ownerDocument.documentElement);if(s)return s*n.value;}return 0;}}}]),nU=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e6;},[{key:"calculator",value:function(t,e,n){return n.map(function(t){return t.value;});}}]),nV=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e6;},[{key:"calculator",value:function(t,e,n){return n.map(function(t){return t.value;});}}]),nz=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){n instanceof ek&&(n=null);var i,a=null===(i=n)||void 0===i?void 0:i.cloneNode(!0);return a&&(a.style.isMarker=!0),a;}}]),nH=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e4;},[{key:"calculator",value:function(t,e,n){return n.value;}}]),nY=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e5(0,1);},[{key:"calculator",value:function(t,e,n){return n.value;}},{key:"postProcessor",value:function(t){var e=t.parsedStyle,n=e.offsetPath,r=e.offsetDistance;if(n){var i=n.nodeName;if(i===j.LINE||i===j.PATH||i===j.POLYLINE){var a=n.getPoint(r);a&&t.setLocalPosition(a.x,a.y);}}}}]),nW=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e5(0,1);},[{key:"calculator",value:function(t,e,n){return n.value;}}]),nq=(0,R.default)(function t(){(0,C.default)(this,t),this.parser=nu,this.mixer=nc;},[{key:"calculator",value:function(t,e,n){return n instanceof ek&&"unset"===n.value?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new tl(0,0,0,0)}:n;}}]),nX=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=nh;}),nj=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).mixer=e5(0,1/0),t;}return(0,I.default)(e,t),(0,R.default)(e);}(nB),n$=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){return n instanceof ek?"unset"===n.value?"":n.value:"".concat(n);}},{key:"postProcessor",value:function(t){t.nodeValue="".concat(t.parsedStyle.text)||"";}}]),nK=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){var i=r.getAttribute("text");if(i){var a=i;"capitalize"===n.value?a=i.charAt(0).toUpperCase()+i.slice(1):"lowercase"===n.value?a=i.toLowerCase():"uppercase"===n.value&&(a=i.toUpperCase()),r.parsedStyle.text=a;}return n.value;}}]);function nZ(t,e){var n=Number(t.parsedStyle.zIndex||0),r=Number(e.parsedStyle.zIndex||0);if(n===r){var i=t.parentNode;if(i){var a=i.childNodes||[];return a.indexOf(t)-a.indexOf(e);}}return n-r;}new WeakMap,"undefined"!=typeof window&&window.document;var nQ={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},nJ="object"==typeof performance&&performance.now?performance:Date;function n0(t){return t.nodeName===j.FRAGMENT||t.getRootNode().nodeName===j.FRAGMENT;}var n1=1,n2="object"==typeof self&&self.self===self?self:"object"==typeof X&&X.global===X?X:{},n3=Date.now(),n4={},n5=Date.now(),n6=function(t){if("function"!=typeof t)throw TypeError("".concat(t," is not a function"));var e=Date.now(),n=e-n5,r=n1++;return n4[r]=t,Object.keys(n4).length>1||setTimeout(function(){n5=e;var t=n4;n4={},Object.keys(t).forEach(function(e){return t[e](n2.performance&&"function"==typeof n2.performance.now?n2.performance.now():Date.now()-n3);});},n>16?0:16-n),r;},n7=function(t){return"string"!=typeof t?n6:""===t?n2.requestAnimationFrame:n2["".concat(t,"RequestAnimationFrame")];},n9=function(t,e){for(var n=0;void 0!==t[n];){if(e(t[n]))return t[n];n+=1;}}(["","webkit","moz","ms","o"],function(t){return!!n7(t);}),n8=n7(n9),rt="string"!=typeof n9?function(t){delete n4[t];}:""===n9?n2.cancelAnimationFrame:n2["".concat(n9,"CancelAnimationFrame")]||n2["".concat(n9,"CancelRequestAnimationFrame")];n2.requestAnimationFrame=n8,n2.cancelAnimationFrame=rt;var re=(0,R.default)(function t(){(0,C.default)(this,t),this.callbacks=[];},[{key:"getCallbacksNum",value:function(){return this.callbacks.length;}},{key:"tapPromise",value:function(t,e){this.callbacks.push(e);}},{key:"promise",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return Promise.all(this.callbacks.map(function(t){return t.apply(void 0,e);}));}}]),rn=(0,R.default)(function t(){(0,C.default)(this,t),this.callbacks=[];},[{key:"tapPromise",value:function(t,e){this.callbacks.push(e);}},{key:"promise",value:(m=(0,Y.default)((0,H.default)().mark(function t(){var e,n,r,i,a=arguments;return(0,H.default)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.callbacks.length){t.next=6;break;}return t.next=1,(e=this.callbacks)[0].apply(e,a);case 1:n=t.sent,r=1;case 2:if(!(r<this.callbacks.length)){t.next=5;break;}return i=this.callbacks[r],t.next=3,i(n);case 3:n=t.sent;case 4:r++,t.next=2;break;case 5:return t.abrupt("return",n);case 6:return t.abrupt("return",null);case 7:case"end":return t.stop();}},t,this);})),function(){return m.apply(this,arguments);})}]),rr=(0,R.default)(function t(){(0,C.default)(this,t),this.callbacks=[];},[{key:"tap",value:function(t,e){this.callbacks.push(e);}},{key:"call",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=arguments;this.callbacks.forEach(function(t){t.apply(void 0,r);});}}]),ri=(0,R.default)(function t(){(0,C.default)(this,t),this.callbacks=[];},[{key:"tap",value:function(t,e){this.callbacks.push(e);}},{key:"call",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];if(this.callbacks.length){for(var r=arguments,i=this.callbacks[0].apply(void 0,r),a=1;a<this.callbacks.length;a++)i=(0,this.callbacks[a])(i);return i;}return null;}}]),ra=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],ro=/([\"\'])[^\'\"]+\1/;function rs(t){var e=t.fontSize,n=t.fontFamily,r=t.fontStyle,i=t.fontVariant,a=t.fontWeight;return{fontSize:void 0===e?16:e,fontFamily:void 0===n?"sans-serif":n,fontStyle:void 0===r?"normal":r,fontVariant:void 0===i?"normal":i,fontWeight:void 0===a?"normal":a};}var rl=ei(function(t){for(var e=rs(t),n=e.fontSize,r=e.fontFamily,i=e.fontStyle,a=e.fontVariant,o=e.fontWeight,s=(0,F.isNumber)(n)&&"".concat(n,"px")||"16px",l=r.split(","),u=l.length-1;u>=0;u--){var c=l[u].trim();!ro.test(c)&&0>ra.indexOf(c)&&(c='"'.concat(c,'"')),l[u]=c;}return"".concat(i," ").concat(a," ").concat(o," ").concat(s," ").concat(l.join(","));},function(t){var e=rs(t),n=e.fontSize,r=e.fontFamily,i=e.fontStyle,a=e.fontVariant,o=e.fontWeight;return"".concat(i,"_").concat(a,"_").concat(o,"_").concat(n,"_").concat(r);}),ru=function(t){return Math.max(t,1e-6);};function rc(t,e,n){return G.mat4.identity(t),t[4]=Math.tan(e),t[1]=Math.tan(n),t;}var rh=G.mat4.create(),rd=G.mat4.create(),rf={scale:function(t){G.mat4.fromScaling(rh,[t[0].value,t[1].value,1].map(function(t){return ru(t);}));},scaleX:function(t){G.mat4.fromScaling(rh,[t[0].value,1,1].map(function(t){return ru(t);}));},scaleY:function(t){G.mat4.fromScaling(rh,[1,t[0].value,1].map(function(t){return ru(t);}));},scaleZ:function(t){G.mat4.fromScaling(rh,[1,1,t[0].value].map(function(t){return ru(t);}));},scale3d:function(t){G.mat4.fromScaling(rh,[t[0].value,t[1].value,t[2].value].map(function(t){return ru(t);}));},translate:function(t){G.mat4.fromTranslation(rh,[t[0].value,t[1].value,0]);},translateX:function(t){G.mat4.fromTranslation(rh,[t[0].value,0,0]);},translateY:function(t){G.mat4.fromTranslation(rh,[0,t[0].value,0]);},translateZ:function(t){G.mat4.fromTranslation(rh,[0,0,t[0].value]);},translate3d:function(t){G.mat4.fromTranslation(rh,[t[0].value,t[1].value,t[2].value]);},rotate:function(t){G.mat4.fromZRotation(rh,eZ(t[0])*tf);},rotateX:function(t){G.mat4.fromXRotation(rh,eZ(t[0])*tf);},rotateY:function(t){G.mat4.fromYRotation(rh,eZ(t[0])*tf);},rotateZ:function(t){G.mat4.fromZRotation(rh,eZ(t[0])*tf);},rotate3d:function(t){G.mat4.fromRotation(rh,eZ(t[3])*tf,[t[0].value,t[1].value,t[2].value]);},skew:function(t){rc(rh,t[0].value*tf,t[1].value*tf);},skewX:function(t){rc(rh,t[0].value*tf,0);},skewY:function(t){rc(rh,0,t[0].value*tf);},matrix:function(t){G.mat4.set(rh,t[0].value,t[1].value,0,0,t[2].value,t[3].value,0,0,0,0,1,0,t[4].value,t[5].value,0,1);},matrix3d:function(t){G.mat4.set.apply(G.mat4,[rh].concat((0,O.default)(t.map(function(t){return t.value;}))));}},rv=G.vec3.fromValues(1,1,1),rp=G.vec3.create(),rg={translate:function(t,e){ir.sceneGraphService.setLocalScale(t,rv,!1),ir.sceneGraphService.setLocalEulerAngles(t,rp,void 0,void 0,!1),ir.sceneGraphService.setLocalPosition(t,[e[0].value,e[1].value,0],!1),ir.sceneGraphService.dirtyLocalTransform(t,t.transformable);}},ry=(0,R.default)(function t(){(0,C.default)(this,t),this.parser=ny,this.mixer=nw;},[{key:"calculator",value:function(t,e,n,r){return n instanceof ek?[]:n;}},{key:"postProcessor",value:function(t){!function(t,e){if(t.length){if(1===t.length&&rg[t[0].t]){rg[t[0].t](e,t[0].d);return;}for(var n=G.mat4.identity(rd),r=0;r<t.length;r++){var i=t[r],a=i.t,o=i.d,s=rf[a];s&&(s(o),G.mat4.mul(n,n,rh));}e.setLocalTransform(n);}else e.resetLocalTransform();e.getLocalTransform();}(t.parsedStyle.transform,t);}}]),rm=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"postProcessor",value:function(t){var e=t.parsedStyle.transformOrigin;e[0].unit===ea.kPixels&&e[1].unit===ea.kPixels?t.setOrigin(e[0].value,e[1].value):t.getGeometryBounds();}}]),rk=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){return n.value;}},{key:"postProcessor",value:function(t){if(t.parentNode){var e=t.parentNode,n=e.renderable,r=e.sortable;n&&e.dirty(),r&&(r.dirty=!0,r.dirtyReason=tC.Z_INDEX_CHANGED);}}}]),rE=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){var n=t.cx,r=t.cy,i=t.r,a=void 0===i?0:i;return{cx:void 0===n?0:n,cy:void 0===r?0:r,hwidth:a,hheight:a};}}]),rx=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){var n=t.cx,r=t.cy,i=t.rx,a=t.ry;return{cx:void 0===n?0:n,cy:void 0===r?0:r,hwidth:void 0===i?0:i,hheight:void 0===a?0:a};}}]),rT=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t){var e=t.x1,n=t.y1,r=t.x2,i=t.y2,a=Math.min(e,r),o=Math.min(n,i),s=(Math.max(e,r)-a)/2,l=(Math.max(n,i)-o)/2;return{cx:a+s,cy:o+l,hwidth:s,hheight:l};}}]),rN=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t){var e=t.d.rect,n=e.x,r=e.y,i=e.width,a=e.height,o=i/2,s=a/2;return{cx:n+o,cy:r+s,hwidth:o,hheight:s};}}]),rb=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t){if(t.points&&(0,F.isArray)(t.points.points)){var e=t.points.points,n=Math.min.apply(Math,(0,O.default)(e.map(function(t){return t[0];}))),r=Math.max.apply(Math,(0,O.default)(e.map(function(t){return t[0];}))),i=Math.min.apply(Math,(0,O.default)(e.map(function(t){return t[1];}))),a=Math.max.apply(Math,(0,O.default)(e.map(function(t){return t[1];}))),o=(r-n)/2,s=(a-i)/2;return{cx:n+o,cy:i+s,hwidth:o,hheight:s};}return{cx:0,cy:0,hwidth:0,hheight:0};}}]),rS=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){var n=t.x,r=t.y,i=t.src,a=t.width,o=t.height,s=void 0===a?0:a,l=void 0===o?0:o;return!i||(0,F.isString)(i)||(s||(s=i.width,t.width=s),l||(l=i.height,t.height=l)),{cx:(void 0===n?0:n)+s/2,cy:(void 0===r?0:r)+l/2,hwidth:s/2,hheight:l/2};}}]),rw=(0,R.default)(function t(e){(0,C.default)(this,t),this.globalRuntime=e;},[{key:"isReadyToMeasure",value:function(t,e){return t.text;}},{key:"update",value:function(t,e){var n,r=t.text,i=t.textAlign,a=void 0===i?"start":i,o=t.lineWidth,s=void 0===o?1:o,l=t.textBaseline,u=void 0===l?"alphabetic":l,c=t.dx,h=void 0===c?0:c,d=t.dy,f=void 0===d?0:d,v=t.x,p=t.y;if(!this.isReadyToMeasure(t,e))return t.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var g=((null==e||null===(n=e.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n?void 0:n.getConfig())||{}).offscreenCanvas,y=this.globalRuntime.textService.measureText(r,t,g);t.metrics=y;var m=y.width,k=y.height,E=m/2,x=k/2,T=(void 0===v?0:v)+E;"center"===a||"middle"===a?T+=s/2-E:("right"===a||"end"===a)&&(T+=s-2*E);var N=(void 0===p?0:p)-x;return"middle"===u?N+=x:"top"===u||"hanging"===u?N+=2*x:"alphabetic"===u||("bottom"===u||"ideographic"===u)&&(N+=0),h&&(T+=h),f&&(N+=f),{cx:T,cy:N,hwidth:E,hheight:x};}}]),rP=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){return{cx:0,cy:0,hwidth:0,hheight:0};}}]),rM=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){var n=t.x,r=t.y,i=t.width,a=void 0===i?0:i,o=t.height,s=void 0===o?0:o;return{cx:(void 0===n?0:n)+a/2,cy:(void 0===r?0:r)+s/2,hwidth:a/2,hheight:s/2};}}]),rA=(0,R.default)(function t(e){(0,C.default)(this,t),this.eventPhase=t.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new ts,this.page=new ts,this.canvas=new ts,this.viewport=new ts,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e;},[{key:"name",get:function(){return this.type;}},{key:"layerX",get:function(){return this.layer.x;}},{key:"layerY",get:function(){return this.layer.y;}},{key:"pageX",get:function(){return this.page.x;}},{key:"pageY",get:function(){return this.page.y;}},{key:"x",get:function(){return this.canvas.x;}},{key:"y",get:function(){return this.canvas.y;}},{key:"canvasX",get:function(){return this.canvas.x;}},{key:"canvasY",get:function(){return this.canvas.y;}},{key:"viewportX",get:function(){return this.viewport.x;}},{key:"viewportY",get:function(){return this.viewport.y;}},{key:"composedPath",value:function(){return this.manager&&(!this.path||this.path[0]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path;}},{key:"propagationPath",get:function(){return this.composedPath();}},{key:"preventDefault",value:function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0;}},{key:"stopImmediatePropagation",value:function(){this.propagationImmediatelyStopped=!0;}},{key:"stopPropagation",value:function(){this.propagationStopped=!0;}},{key:"initEvent",value:function(){}},{key:"initUIEvent",value:function(){}},{key:"clone",value:function(){throw Error(tu);}}]),rC=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).client=new ts,t.movement=new ts,t.offset=new ts,t.global=new ts,t.screen=new ts,t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clientX",get:function(){return this.client.x;}},{key:"clientY",get:function(){return this.client.y;}},{key:"movementX",get:function(){return this.movement.x;}},{key:"movementY",get:function(){return this.movement.y;}},{key:"offsetX",get:function(){return this.offset.x;}},{key:"offsetY",get:function(){return this.offset.y;}},{key:"globalX",get:function(){return this.global.x;}},{key:"globalY",get:function(){return this.global.y;}},{key:"screenX",get:function(){return this.screen.x;}},{key:"screenY",get:function(){return this.screen.y;}},{key:"getModifierState",value:function(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t);}},{key:"initMouseEvent",value:function(){throw Error(tu);}}]);}(rA),rR=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).width=0,t.height=0,t.isPrimary=!1,t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getCoalescedEvents",value:function(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[];}},{key:"getPredictedEvents",value:function(){throw Error("getPredictedEvents is not supported!");}},{key:"clone",value:function(){return this.manager.clonePointerEvent(this);}}]);}(rC),rO=function(t){function e(){return(0,C.default)(this,e),(0,L.default)(this,e,arguments);}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return this.manager.cloneWheelEvent(this);}}]);}(rC),rL=function(t){function e(t,n){var r;return(0,C.default)(this,e),(r=(0,L.default)(this,e,[null])).type=t,r.detail=null==n?void 0:n.detail,!n||"detail"in n||(r.detail=n),Object.assign(r,n),r;}return(0,I.default)(e,t),(0,R.default)(e);}(rA),rI=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).shadow=!1,t.ownerDocument=null,t.isConnected=!1,t.baseURI="",t.childNodes=[],t.nodeType=0,t.nodeName="",t.nodeValue=null,t.mutations=void 0,t.parentNode=null,t.destroyed=!1,t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"textContent",get:function(){var t="";this.nodeName===j.TEXT&&(t+=this.style.text);var e,n=(0,W.default)(this.childNodes);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.nodeName===j.TEXT?t+=r.nodeValue:t+=r.textContent;}}catch(t){n.e(t);}finally{n.f();}return t;},set:function(t){var e=this;this.childNodes.slice().forEach(function(t){e.removeChild(t);}),this.nodeName===j.TEXT&&(this.style.text="".concat(t));}},{key:"getRootNode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.parentNode?this.parentNode.getRootNode(t):t.composed&&this.host?this.host.getRootNode(t):this;}},{key:"hasChildNodes",value:function(){return this.childNodes.length>0;}},{key:"isDefaultNamespace",value:function(t){throw Error(tu);}},{key:"lookupNamespaceURI",value:function(t){throw Error(tu);}},{key:"lookupPrefix",value:function(t){throw Error(tu);}},{key:"normalize",value:function(){throw Error(tu);}},{key:"isEqualNode",value:function(t){return this===t;}},{key:"isSameNode",value:function(t){return this.isEqualNode(t);}},{key:"parent",get:function(){return this.parentNode;}},{key:"parentElement",get:function(){return null;}},{key:"nextSibling",get:function(){return null;}},{key:"previousSibling",get:function(){return null;}},{key:"firstChild",get:function(){return this.childNodes.length>0?this.childNodes[0]:null;}},{key:"lastChild",get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null;}},{key:"compareDocumentPosition",value:function(t){if(t===this)return 0;for(var n,r=t,i=this,a=[r],o=[i];null!==(n=r.parentNode)&&void 0!==n?n:i.parentNode;)r=r.parentNode?(a.push(r.parentNode),r.parentNode):r,i=i.parentNode?(o.push(i.parentNode),i.parentNode):i;if(r!==i)return e.DOCUMENT_POSITION_DISCONNECTED|e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|e.DOCUMENT_POSITION_PRECEDING;var s=a.length>o.length?a:o,l=s===a?o:a;if(s[s.length-l.length]===l[0])return s===a?e.DOCUMENT_POSITION_CONTAINED_BY|e.DOCUMENT_POSITION_FOLLOWING:e.DOCUMENT_POSITION_CONTAINS|e.DOCUMENT_POSITION_PRECEDING;for(var u=s.length-l.length,c=l.length-1;c>=0;c--){var h=l[c],d=s[u+c];if(d!==h){var f=h.parentNode.childNodes;if(f.indexOf(h)<f.indexOf(d)){if(l===a)return e.DOCUMENT_POSITION_PRECEDING;return e.DOCUMENT_POSITION_FOLLOWING;}if(s===a)return e.DOCUMENT_POSITION_PRECEDING;break;}}return e.DOCUMENT_POSITION_FOLLOWING;}},{key:"contain",value:function(t){return this.contains(t);}},{key:"contains",value:function(t){for(var e=t;e&&this!==e;)e=e.parentNode;return!!e;}},{key:"getAncestor",value:function(t){for(var e=this;t>0&&e;)e=e.parentNode,t--;return e;}},{key:"forEach",value:function(t){for(var e=[this];e.length>0;){var n=e.pop();if(!1===t(n))break;for(var r=n.childNodes.length-1;r>=0;r--)e.push(n.childNodes[r]);}}}],[{key:"isNode",value:function(t){return!!t.childNodes;}}]);}((0,R.default)(function t(){(0,C.default)(this,t),this.emitter=new _.default;},[{key:"on",value:function(t,e,n){return this.addEventListener(t,e,n),this;}},{key:"addEventListener",value:function(t,e,n){var r=!1,i=!1;if((0,F.isBoolean)(n))r=n;else if(n){var a=n.capture;r=void 0!==a&&a;var o=n.once;i=void 0!==o&&o;}r&&(t+="capture"),e=(0,F.isFunction)(e)?e:e.handleEvent;var s=(0,F.isFunction)(e)?void 0:e;return i?this.emitter.once(t,e,s):this.emitter.on(t,e,s),this;}},{key:"off",value:function(t,e,n){return t?this.removeEventListener(t,e,n):this.removeAllEventListeners(),this;}},{key:"removeAllEventListeners",value:function(){var t;null===(t=this.emitter)||void 0===t||t.removeAllListeners();}},{key:"removeEventListener",value:function(t,e,n){if(!this.emitter)return this;((0,F.isBoolean)(n)?n:null==n?void 0:n.capture)&&(t+="capture"),e=(0,F.isFunction)(e)?e:null===(r=e)||void 0===r?void 0:r.handleEvent;var r,i=(0,F.isFunction)(e)?void 0:e;return this.emitter.off(t,e,i),this;}},{key:"emit",value:function(t,e){this.dispatchEvent(new rL(t,e));}},{key:"dispatchEventToSelf",value:function(t){t.target||(t.target=this),t.currentTarget=this,this.emitter.emit(t.type,t);}},{key:"dispatchEvent",value:function(t){var e,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0;if(i)return this.dispatchEventToSelf(t),!0;if(e=this.document?this:this.defaultView?this.defaultView:null===(n=this.ownerDocument)||void 0===n?void 0:n.defaultView){if(t.manager=e.getEventService(),!t.manager)return!1;t.defaultPrevented=!1,t.path?t.path.length=0:t.page=[],r||(t.target=this),t.manager.dispatchEvent(t,t.type,r);}else this.dispatchEventToSelf(t);return!t.defaultPrevented;}}]));rI.DOCUMENT_POSITION_DISCONNECTED=1,rI.DOCUMENT_POSITION_PRECEDING=2,rI.DOCUMENT_POSITION_FOLLOWING=4,rI.DOCUMENT_POSITION_CONTAINS=8,rI.DOCUMENT_POSITION_CONTAINED_BY=16,rI.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32,(0,R.default)(function t(e,n){var r=this;(0,C.default)(this,t),this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=G.mat4.create(),this.tmpVec3=G.vec3.create(),this.onPointerDown=function(t){var e=r.createPointerEvent(t);if(r.dispatchEvent(e,"pointerdown"),"touch"===e.pointerType)r.dispatchEvent(e,"touchstart");else if("mouse"===e.pointerType||"pen"===e.pointerType){var n=2===e.button;r.dispatchEvent(e,n?"rightdown":"mousedown");}r.trackingData(t.pointerId).pressTargetsByButton[t.button]=e.composedPath(),r.freeEvent(e);},this.onPointerUp=function(t){var e=nJ.now(),n=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);if(r.dispatchEvent(n,"pointerup"),"touch"===n.pointerType)r.dispatchEvent(n,"touchend");else if("mouse"===n.pointerType||"pen"===n.pointerType){var i=2===n.button;r.dispatchEvent(n,i?"rightup":"mouseup");}var a=r.trackingData(t.pointerId),o=r.findMountedTarget(a.pressTargetsByButton[t.button]),s=o;if(o&&!n.composedPath().includes(o)){for(var l=o;l&&!n.composedPath().includes(l);){if(n.currentTarget=l,r.notifyTarget(n,"pointerupoutside"),"touch"===n.pointerType)r.notifyTarget(n,"touchendoutside");else if("mouse"===n.pointerType||"pen"===n.pointerType){var u=2===n.button;r.notifyTarget(n,u?"rightupoutside":"mouseupoutside");}rI.isNode(l)&&(l=l.parentNode);}delete a.pressTargetsByButton[t.button],s=l;}if(s){var c,h=r.clonePointerEvent(n,"click");h.target=s,h.path=[],a.clicksByButton[t.button]||(a.clicksByButton[t.button]={clickCount:0,target:h.target,timeStamp:e});var d=r.context.renderingContext.root.ownerDocument.defaultView,f=a.clicksByButton[t.button];f.target===h.target&&e-f.timeStamp<d.getConfig().dblClickSpeed?++f.clickCount:f.clickCount=1,f.target=h.target,f.timeStamp=e,h.detail=f.clickCount,null!==(c=n.detail)&&void 0!==c&&c.preventClick||(r.context.config.useNativeClickEvent||"mouse"!==h.pointerType&&"touch"!==h.pointerType||r.dispatchEvent(h,"click"),r.dispatchEvent(h,"pointertap")),r.freeEvent(h);}r.freeEvent(n);},this.onPointerMove=function(t){var e=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0),n="mouse"===e.pointerType||"pen"===e.pointerType,i=r.trackingData(t.pointerId),a=r.findMountedTarget(i.overTargets);if(i.overTargets&&a!==e.target){var o="mousemove"===t.type?"mouseout":"pointerout",s=r.createPointerEvent(t,o,a||void 0);if(r.dispatchEvent(s,"pointerout"),n&&r.dispatchEvent(s,"mouseout"),!e.composedPath().includes(a)){var l=r.createPointerEvent(t,"pointerleave",a||void 0);for(l.eventPhase=l.AT_TARGET;l.target&&!e.composedPath().includes(l.target);)l.currentTarget=l.target,r.notifyTarget(l),n&&r.notifyTarget(l,"mouseleave"),rI.isNode(l.target)&&(l.target=l.target.parentNode);r.freeEvent(l);}r.freeEvent(s);}if(a!==e.target){var u="mousemove"===t.type?"mouseover":"pointerover",c=r.clonePointerEvent(e,u);r.dispatchEvent(c,"pointerover"),n&&r.dispatchEvent(c,"mouseover");for(var h=a&&rI.isNode(a)&&a.parentNode;h&&h!==(rI.isNode(r.rootTarget)&&r.rootTarget.parentNode)&&h!==e.target;)h=h.parentNode;if(!h||h===(rI.isNode(r.rootTarget)&&r.rootTarget.parentNode)){var d=r.clonePointerEvent(e,"pointerenter");for(d.eventPhase=d.AT_TARGET;d.target&&d.target!==a&&d.target!==(rI.isNode(r.rootTarget)&&r.rootTarget.parentNode);)d.currentTarget=d.target,r.notifyTarget(d),n&&r.notifyTarget(d,"mouseenter"),rI.isNode(d.target)&&(d.target=d.target.parentNode);r.freeEvent(d);}r.freeEvent(c);}r.dispatchEvent(e,"pointermove"),"touch"===e.pointerType&&r.dispatchEvent(e,"touchmove"),n&&(r.dispatchEvent(e,"mousemove"),r.cursor=r.getCursor(e.target)),i.overTargets=e.composedPath(),r.freeEvent(e);},this.onPointerOut=function(t){var e=r.trackingData(t.pointerId);if(e.overTargets){var n="mouse"===t.pointerType||"pen"===t.pointerType,i=r.findMountedTarget(e.overTargets),a=r.createPointerEvent(t,"pointerout",i||void 0);r.dispatchEvent(a),n&&r.dispatchEvent(a,"mouseout");var o=r.createPointerEvent(t,"pointerleave",i||void 0);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==(rI.isNode(r.rootTarget)&&r.rootTarget.parentNode);)o.currentTarget=o.target,r.notifyTarget(o),n&&r.notifyTarget(o,"mouseleave"),rI.isNode(o.target)&&(o.target=o.target.parentNode);e.overTargets=null,r.freeEvent(a),r.freeEvent(o);}r.cursor=null;},this.onPointerOver=function(t){var e=r.trackingData(t.pointerId),n=r.createPointerEvent(t),i="mouse"===n.pointerType||"pen"===n.pointerType;r.dispatchEvent(n,"pointerover"),i&&r.dispatchEvent(n,"mouseover"),"mouse"===n.pointerType&&(r.cursor=r.getCursor(n.target));var a=r.clonePointerEvent(n,"pointerenter");for(a.eventPhase=a.AT_TARGET;a.target&&a.target!==(rI.isNode(r.rootTarget)&&r.rootTarget.parentNode);)a.currentTarget=a.target,r.notifyTarget(a),i&&r.notifyTarget(a,"mouseenter"),rI.isNode(a.target)&&(a.target=a.target.parentNode);e.overTargets=n.composedPath(),r.freeEvent(n),r.freeEvent(a);},this.onPointerUpOutside=function(t){var e=r.trackingData(t.pointerId),n=r.findMountedTarget(e.pressTargetsByButton[t.button]),i=r.createPointerEvent(t);if(n){for(var a=n;a;)i.currentTarget=a,r.notifyTarget(i,"pointerupoutside"),"touch"===i.pointerType||("mouse"===i.pointerType||"pen"===i.pointerType)&&r.notifyTarget(i,2===i.button?"rightupoutside":"mouseupoutside"),rI.isNode(a)&&(a=a.parentNode);delete e.pressTargetsByButton[t.button];}r.freeEvent(i);},this.onWheel=function(t){var e=r.createWheelEvent(t);r.dispatchEvent(e),r.freeEvent(e);},this.onClick=function(t){if(r.context.config.useNativeClickEvent){var e=r.createPointerEvent(t);r.dispatchEvent(e),r.freeEvent(e);}},this.onPointerCancel=function(t){var e=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);r.dispatchEvent(e),r.freeEvent(e);},this.globalRuntime=e,this.context=n;},[{key:"init",value:function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick);}},{key:"destroy",value:function(){this.mappingTable={},this.mappingState={},this.eventPool.clear();}},{key:"getScale",value:function(){var t=this.context.contextService.getBoundingClientRect(),e=1,n=1,r=this.context.contextService.getDomElement();if(r&&t){var i=r.offsetWidth,a=r.offsetHeight;i&&a&&(e=t.width/i,n=t.height/a);}return{scaleX:e,scaleY:n,bbox:t};}},{key:"client2Viewport",value:function(t){var e=this.getScale(),n=e.scaleX,r=e.scaleY,i=e.bbox;return new ts((t.x-((null==i?void 0:i.left)||0))/n,(t.y-((null==i?void 0:i.top)||0))/r);}},{key:"viewport2Client",value:function(t){var e=this.getScale(),n=e.scaleX,r=e.scaleY,i=e.bbox;return new ts((t.x+((null==i?void 0:i.left)||0))*n,(t.y+((null==i?void 0:i.top)||0))*r);}},{key:"viewport2Canvas",value:function(t){var e=t.x,n=t.y,r=this.rootTarget.defaultView.getCamera(),i=this.context.config,a=i.width,o=i.height,s=r.getPerspectiveInverse(),l=r.getWorldTransform(),u=G.mat4.multiply(this.tmpMatrix,l,s),c=G.vec3.set(this.tmpVec3,e/a*2-1,(1-n/o)*2-1,0);return G.vec3.transformMat4(c,c,u),new ts(c[0],c[1]);}},{key:"canvas2Viewport",value:function(t){var e=this.rootTarget.defaultView.getCamera(),n=e.getPerspective(),r=e.getViewTransform(),i=G.mat4.multiply(this.tmpMatrix,n,r),a=G.vec3.set(this.tmpVec3,t.x,t.y,0);G.vec3.transformMat4(this.tmpVec3,this.tmpVec3,i);var o=this.context.config,s=o.width,l=o.height;return new ts((a[0]+1)/2*s,(1-(a[1]+1)/2)*l);}},{key:"setPickHandler",value:function(t){this.pickHandler=t;}},{key:"addEventMapping",value:function(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort(function(t,e){return t.priority-e.priority;});}},{key:"mapEvent",value:function(t){if(this.rootTarget){var e=this.mappingTable[t.type];if(e)for(var n=0,r=e.length;n<r;n++)e[n].fn(t);else console.warn("[EventService]: Event mapping not defined for ".concat(t.type));}}},{key:"dispatchEvent",value:function(t,e,n){if(n){t.eventPhase=t.AT_TARGET;var r=this.rootTarget.defaultView||null;t.currentTarget=r,this.notifyListeners(t,e);}else t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e);}},{key:"propagate",value:function(t,e){if(t.target){var n=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(var r=n.length-1;r>=1;r--)if(t.currentTarget=n[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!t.propagationStopped&&!t.propagationImmediatelyStopped){var i=n.indexOf(t.currentTarget);t.eventPhase=t.BUBBLING_PHASE;for(var a=i+1;a<n.length;a++)if(t.currentTarget=n[a],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;}}}},{key:"propagationPath",value:function(t){var e=[t],n=this.rootTarget.defaultView||null;if(n&&n===t)return e.unshift(n.document),e;for(var r=0;r<2048&&t!==this.rootTarget;r++)rI.isNode(t)&&t.parentNode&&(e.push(t.parentNode),t=t.parentNode);return n&&e.push(n),e;}},{key:"hitTest",value:function(t){var e=t.viewportX,n=t.viewportY,r=this.context.config,i=r.width,a=r.height,o=r.disableHitTesting;return e<0||n<0||e>i||n>a?null:!o&&this.pickHandler(t)||this.rootTarget||null;}},{key:"isNativeEventFromCanvas",value:function(t,e){var n,r=null==e?void 0:e.target;if(null!==(n=r)&&void 0!==n&&n.shadowRoot&&(r=e.composedPath()[0]),r){if(r===t)return!0;if(t&&t.contains)return t.contains(r);}return null!=e&&!!e.composedPath&&e.composedPath().indexOf(t)>-1;}},{key:"getExistedHTML",value:function(t){if(t.nativeEvent.composedPath)for(var e=0,n=t.nativeEvent.composedPath();e<n.length;e++){var r=n[e],i=this.nativeHTMLMap.get(r);if(i)return i;}return null;}},{key:"pickTarget",value:function(t){return this.hitTest({clientX:t.clientX,clientY:t.clientY,viewportX:t.viewportX,viewportY:t.viewportY,x:t.canvasX,y:t.canvasY});}},{key:"createPointerEvent",value:function(t,e,n,r){var i=this.allocateEvent(rR);this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.nativeEvent=t.nativeEvent,i.originalEvent=t;var a=this.getExistedHTML(i),o=this.context.contextService.getDomElement();return i.target=null!=n?n:a||this.isNativeEventFromCanvas(o,i.nativeEvent)&&this.pickTarget(i)||r,"string"==typeof e&&(i.type=e),i;}},{key:"createWheelEvent",value:function(t){var e=this.allocateEvent(rO);this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t;var n=this.getExistedHTML(e),r=this.context.contextService.getDomElement();return e.target=n||this.isNativeEventFromCanvas(r,e.nativeEvent)&&this.pickTarget(e),e;}},{key:"trackingData",value:function(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t];}},{key:"cloneWheelEvent",value:function(t){var e=this.allocateEvent(rO);return e.nativeEvent=t.nativeEvent,e.originalEvent=t.originalEvent,this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.target=t.target,e.path=t.composedPath().slice(),e.type=t.type,e;}},{key:"clonePointerEvent",value:function(t,e){var n=this.allocateEvent(rR);return n.nativeEvent=t.nativeEvent,n.originalEvent=t.originalEvent,this.copyPointerData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.target=t.target,n.path=t.composedPath().slice(),n.type=null!=e?e:n.type,n;}},{key:"copyPointerData",value:function(t,e){e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist;}},{key:"copyMouseData",value:function(t,e){e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey,e.client.copyFrom(t.client),e.movement.copyFrom(t.movement),e.canvas.copyFrom(t.canvas),e.screen.copyFrom(t.screen),e.global.copyFrom(t.global),e.offset.copyFrom(t.offset);}},{key:"copyWheelData",value:function(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;}},{key:"copyData",value:function(t,e){e.isTrusted=t.isTrusted,e.timeStamp=nJ.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.page.copyFrom(t.page),e.viewport.copyFrom(t.viewport);}},{key:"allocateEvent",value:function(t){this.eventPool.has(t)||this.eventPool.set(t,[]);var e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=[],e.target=null,e;}},{key:"freeEvent",value:function(t){if(t.manager!==this)throw Error("It is illegal to free an event not managed by this EventBoundary!");var e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t);}},{key:"notifyTarget",value:function(t,e){e=null!=e?e:t.type;var n=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?"".concat(e,"capture"):e;this.notifyListeners(t,n),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e);}},{key:"notifyListeners",value:function(t,e){var n=t.currentTarget.emitter,r=n._events[e];if(r){if("fn"in r)r.once&&n.removeListener(e,r.fn,void 0,!0),r.fn.call(t.currentTarget||r.context,t);else for(var i=0;i<r.length&&!t.propagationImmediatelyStopped;i++)r[i].once&&n.removeListener(e,r[i].fn,void 0,!0),r[i].fn.call(t.currentTarget||r[i].context,t);}}},{key:"findMountedTarget",value:function(t){if(!t)return null;for(var e=t[t.length-1],n=t.length-2;n>=0;n--){var r=t[n];if(r===this.rootTarget||rI.isNode(r)&&r.parentNode===e)e=t[n];else break;}return e;}},{key:"getCursor",value:function(t){for(var e=t;e;){var n=!!e.getAttribute&&e.getAttribute("cursor");if(n)return n;e=rI.isNode(e)&&e.parentNode;}}}]);var rD=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"getOrCreateCanvas",value:function(t,e){if(this.canvas)return this.canvas;if(t||ir.offscreenCanvas)this.canvas=t||ir.offscreenCanvas,this.context=this.canvas.getContext("2d",(0,A.default)({willReadFrequently:!0},e));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",(0,A.default)({willReadFrequently:!0},e)),this.context&&this.context.measureText||(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"));}catch(t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",(0,A.default)({willReadFrequently:!0},e));}return this.canvas.width=10,this.canvas.height=10,this.canvas;}},{key:"getOrCreateContext",value:function(t,e){return this.context||this.getOrCreateCanvas(t,e),this.context;}}],[{key:"createCanvas",value:function(){try{return new window.OffscreenCanvas(0,0);}catch(t){}try{return document.createElement("canvas");}catch(t){}return null;}}]),r_=((k={})[k.CAMERA_CHANGED=0]="CAMERA_CHANGED",k[k.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",k[k.NONE=2]="NONE",k);(0,R.default)(function t(e,n){(0,C.default)(this,t),this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new rr,initAsync:new re,dirtycheck:new ri,cull:new ri,beginFrame:new rr,beforeRender:new rr,render:new rr,afterRender:new rr,endFrame:new rr,destroy:new rr,pick:new rn,pickSync:new ri,pointerDown:new rr,pointerUp:new rr,pointerMove:new rr,pointerOut:new rr,pointerOver:new rr,pointerWheel:new rr,pointerCancel:new rr,click:new rr},this.globalRuntime=e,this.context=n;},[{key:"init",value:function(t){var e=this,n=(0,A.default)((0,A.default)({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach(function(t){t.apply(n,e.globalRuntime);}),this.hooks.init.call(),0===this.hooks.initAsync.getCallbacksNum()?(this.inited=!0,t()):this.hooks.initAsync.promise().then(function(){e.inited=!0,t();}).catch(function(t){});}},{key:"getStats",value:function(){return this.stats;}},{key:"disableDirtyRectangleRendering",value:function(){return!this.context.config.renderer.getConfig().enableDirtyRectangleRendering||this.context.renderingContext.renderReasons.has(r_.CAMERA_CHANGED);}},{key:"render",value:function(t,e,n){var r=this,i=t.getConfig(),a=this.context.renderingContext;if(this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0,this.globalRuntime.sceneGraphService.syncHierarchy(a.root),this.globalRuntime.sceneGraphService.notifyMutationObservers(t),a.renderReasons.size&&this.inited){a.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var o=1===a.renderReasons.size&&a.renderReasons.has(r_.CAMERA_CHANGED),s=!i.disableRenderHooks||!o;s&&this.renderDisplayObject(a.root,i,a),this.hooks.beginFrame.call(e),s&&a.renderListCurrentFrame.forEach(function(t){r.hooks.beforeRender.call(t),r.hooks.render.call(t),r.hooks.afterRender.call(t);}),this.hooks.endFrame.call(e),a.renderListCurrentFrame=[],a.renderReasons.clear(),n();}}},{key:"renderDisplayObject",value:function(t,e,n){for(var r=this,i=e.renderer.getConfig(),a=i.enableDirtyCheck,o=i.enableCulling,s=[t];s.length>0;){var l,u=s.pop();!function(t){var e=t.renderable,i=t.sortable,s=a?e.dirty||n.dirtyRectangleRenderingDisabled?t:null:t,l=null;s&&(l=o?r.hooks.cull.call(s,r.context.camera):s)&&(r.stats.rendered+=1,n.renderListCurrentFrame.push(l)),t.dirty(!1),i.renderOrder=r.zIndexCounter,r.zIndexCounter+=1,r.stats.total+=1,i.dirty&&(r.sort(t,i),i.dirty=!1,i.dirtyChildren=[],i.dirtyReason=void 0);}(u);for(var c=(null===(l=u.sortable)||void 0===l||null===(l=l.sorted)||void 0===l?void 0:l.length)>0?u.sortable.sorted:u.childNodes,h=c.length-1;h>=0;h--)s.push(c[h]);}}},{key:"sort",value:function(t,e){var n,r;(null==e||null===(n=e.sorted)||void 0===n?void 0:n.length)>0&&e.dirtyReason!==tC.Z_INDEX_CHANGED?e.dirtyChildren.forEach(function(n){var r=e.sorted.indexOf(n);if(r>-1&&e.sorted.splice(r,1),t.childNodes.indexOf(n)>-1){if(0===e.sorted.length)e.sorted.push(n);else{var i=function(t,e){for(var n=0,r=t.length;n<r;){var i=n+r>>>1;0>nZ(t[i],e)?n=i+1:r=i;}return n;}(e.sorted,n);e.sorted.splice(i,0,n);}}}):e.sorted=t.childNodes.slice().sort(nZ),(null===(r=e.sorted)||void 0===r?void 0:r.length)>0&&0===t.childNodes.filter(function(t){return t.parsedStyle.zIndex;}).length&&(e.sorted=[]);}},{key:"destroy",value:function(){this.inited=!1,this.hooks.destroy.call();}},{key:"dirty",value:function(){this.context.renderingContext.renderReasons.add(r_.DISPLAY_OBJECT_CHANGED);}}]);var rG=/\[\s*(.*)=(.*)\s*\]/,rF=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"selectOne",value:function(t,e){var n=this;if(t.startsWith("."))return e.find(function(e){return((null==e?void 0:e.classList)||[]).indexOf(n.getIdOrClassname(t))>-1;});if(t.startsWith("#"))return e.find(function(e){return e.id===n.getIdOrClassname(t);});if(t.startsWith("[")){var r=this.getAttribute(t),i=r.name,a=r.value;return i?e.find(function(t){return e!==t&&("name"===i?t.name===a:n.attributeToString(t,i)===a);}):null;}return e.find(function(n){return e!==n&&n.nodeName===t;});}},{key:"selectAll",value:function(t,e){var n=this;if(t.startsWith("."))return e.findAll(function(r){return e!==r&&((null==r?void 0:r.classList)||[]).indexOf(n.getIdOrClassname(t))>-1;});if(t.startsWith("#"))return e.findAll(function(r){return e!==r&&r.id===n.getIdOrClassname(t);});if(t.startsWith("[")){var r=this.getAttribute(t),i=r.name,a=r.value;return i?e.findAll(function(t){return e!==t&&("name"===i?t.name===a:n.attributeToString(t,i)===a);}):[];}return e.findAll(function(n){return e!==n&&n.nodeName===t;});}},{key:"is",value:function(t,e){if(t.startsWith("."))return e.className===this.getIdOrClassname(t);if(t.startsWith("#"))return e.id===this.getIdOrClassname(t);if(t.startsWith("[")){var n=this.getAttribute(t),r=n.name,i=n.value;return"name"===r?e.name===i:this.attributeToString(e,r)===i;}return e.nodeName===t;}},{key:"getIdOrClassname",value:function(t){return t.substring(1);}},{key:"getAttribute",value:function(t){var e=t.match(rG),n="",r="";return e&&e.length>2&&(n=e[1].replace(/"/g,""),r=e[2].replace(/"/g,"")),{name:n,value:r};}},{key:"attributeToString",value:function(t,e){if(!t.getAttribute)return"";var n=t.getAttribute(e);return(0,F.isNil)(n)?"":n.toString?n.toString():"";}}]),rB=((E={}).ATTR_MODIFIED="DOMAttrModified",E.INSERTED="DOMNodeInserted",E.MOUNTED="DOMNodeInsertedIntoDocument",E.REMOVED="removed",E.UNMOUNTED="DOMNodeRemovedFromDocument",E.REPARENT="reparent",E.DESTROY="destroy",E.BOUNDS_CHANGED="bounds-changed",E.CULLED="culled",E),rU=function(t){function e(t,n,r,i,a,o,s,l){var u;return(0,C.default)(this,e),(u=(0,L.default)(this,e,[null])).relatedNode=n,u.prevValue=r,u.newValue=i,u.attrName=a,u.attrChange=o,u.prevParsedValue=s,u.newParsedValue=l,u.type=t,u;}return(0,I.default)(e,t),(0,R.default)(e);}(rA);rU.ADDITION=2,rU.MODIFICATION=1,rU.REMOVAL=3;var rV=new rU(rB.REPARENT,null,"","","",0,"",""),rz=G.vec2.create(),rH=G.vec3.create(),rY=G.vec3.fromValues(1,1,1),rW=G.mat4.create(),rq=G.vec2.create(),rX=G.vec3.create(),rj=G.mat4.create(),r$=G.quat.create(),rK=G.vec3.create(),rZ=G.quat.create(),rQ=G.vec3.create(),rJ=G.vec3.create(),r0=G.vec3.create(),r1=G.mat4.create(),r2=G.quat.create(),r3=G.quat.create(),r4=G.quat.create(),r5=(0,R.default)(function t(e){(0,C.default)(this,t),this.displayObjectDependencyMap=new WeakMap,this.runtime=e;},[{key:"matches",value:function(t,e){return this.runtime.sceneGraphSelector.is(t,e);}},{key:"querySelector",value:function(t,e){return this.runtime.sceneGraphSelector.selectOne(t,e);}},{key:"querySelectorAll",value:function(t,e){return this.runtime.sceneGraphSelector.selectAll(t,e);}},{key:"attach",value:function(t,e,n){var r=!1;t.parentNode&&(r=t.parentNode!==e,this.detach(t));var i=t.nodeName===j.FRAGMENT,a=n0(e);t.parentNode=e;var o=i?t.childNodes:[t];(0,F.isNumber)(n)?o.forEach(function(t){e.childNodes.splice(n,0,t),t.parentNode=e;}):o.forEach(function(t){e.childNodes.push(t),t.parentNode=e;});var s=e.sortable;if((null!=s&&null!==(u=s.sorted)&&void 0!==u&&u.length||s.dirty||t.parsedStyle.zIndex)&&(-1===s.dirtyChildren.indexOf(t)&&s.dirtyChildren.push(t),s.dirty=!0,s.dirtyReason=tC.ADDED),!a){if(i)this.dirtyFragment(t);else{var l=t.transformable;l&&this.dirtyWorldTransform(t,l);}if(r){var u,c,h=(null===(c=e.ownerDocument)||void 0===c||null===(c=c.defaultView)||void 0===c||null===(c=c.getConfig())||void 0===c||null===(c=c.future)||void 0===c?void 0:c.experimentalCancelEventPropagation)===!0;t.dispatchEvent(rV,h,h);}}}},{key:"detach",value:function(t){if(t.parentNode){var e,n,r=t.transformable,i=t.parentNode.sortable;(null!=i&&null!==(e=i.sorted)&&void 0!==e&&e.length||null!==(n=t.style)&&void 0!==n&&n.zIndex)&&(-1===i.dirtyChildren.indexOf(t)&&i.dirtyChildren.push(t),i.dirty=!0,i.dirtyReason=tC.REMOVED);var a=t.parentNode.childNodes.indexOf(t);a>-1&&t.parentNode.childNodes.splice(a,1),r&&this.dirtyWorldTransform(t,r),t.parentNode=null;}}},{key:"getLocalPosition",value:function(t){return t.transformable.localPosition;}},{key:"getLocalRotation",value:function(t){return t.transformable.localRotation;}},{key:"getLocalScale",value:function(t){return t.transformable.localScale;}},{key:"getLocalSkew",value:function(t){return t.transformable.localSkew;}},{key:"getLocalTransform",value:function(t){var e=t.transformable;return tI(e),e.localTransform;}},{key:"setLocalPosition",value:function(t,e){var n,r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=t.transformable;rJ[0]=e[0],rJ[1]=e[1],rJ[2]=null!==(n=e[2])&&void 0!==n?n:0,!G.vec3.equals(i.localPosition,rJ)&&(G.vec3.copy(i.localPosition,rJ),r&&this.dirtyLocalTransform(t,i));}},{key:"translateLocal",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var i=t.transformable;G.vec3.equals(e,rH)||(G.vec3.transformQuat(e,e,i.localRotation),G.vec3.add(i.localPosition,i.localPosition,e),this.dirtyLocalTransform(t,i));}},{key:"setLocalRotation",value:function(t,e,n,r,i){var a=!(arguments.length>5)||void 0===arguments[5]||arguments[5];"number"==typeof e&&(e=G.quat.set(r$,e,n,r,i));var o=t.transformable;G.quat.copy(o.localRotation,e),a&&this.dirtyLocalTransform(t,o);}},{key:"rotateLocal",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var i=t.transformable;G.quat.fromEuler(r3,e[0],e[1],e[2]),G.quat.mul(i.localRotation,i.localRotation,r3),this.dirtyLocalTransform(t,i);}},{key:"setLocalScale",value:function(t,e){var n,r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=t.transformable;G.vec3.set(rX,e[0],e[1],null!==(n=e[2])&&void 0!==n?n:i.localScale[2]),!G.vec3.equals(rX,i.localScale)&&(G.vec3.copy(i.localScale,rX),r&&this.dirtyLocalTransform(t,i));}},{key:"scaleLocal",value:function(t,e){var n,r=t.transformable;G.vec3.multiply(r.localScale,r.localScale,G.vec3.set(rX,e[0],e[1],null!==(n=e[2])&&void 0!==n?n:1)),this.dirtyLocalTransform(t,r);}},{key:"setLocalSkew",value:function(t,e,n){var r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];"number"==typeof e&&(e=G.vec2.set(rq,e,n));var i=t.transformable;G.vec2.copy(i.localSkew,e),r&&this.dirtyLocalTransform(t,i);}},{key:"setLocalEulerAngles",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=!(arguments.length>4)||void 0===arguments[4]||arguments[4];"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var a=t.transformable;G.quat.fromEuler(a.localRotation,e[0],e[1],e[2]),i&&this.dirtyLocalTransform(t,a);}},{key:"setLocalTransform",value:function(t,e){var n=G.mat4.getTranslation(rK,e),r=G.mat4.getRotation(rZ,e),i=G.mat4.getScaling(rQ,e);this.setLocalScale(t,i,!1),this.setLocalPosition(t,n,!1),this.setLocalRotation(t,r,void 0,void 0,void 0,!1),this.dirtyLocalTransform(t,t.transformable);}},{key:"resetLocalTransform",value:function(t){this.setLocalScale(t,rY,!1),this.setLocalPosition(t,rH,!1),this.setLocalEulerAngles(t,rH,void 0,void 0,!1),this.setLocalSkew(t,rz,void 0,!1),this.dirtyLocalTransform(t,t.transformable);}},{key:"getPosition",value:function(t){var e=t.transformable;return G.mat4.getTranslation(e.position,this.getWorldTransform(t,e));}},{key:"getRotation",value:function(t){var e=t.transformable;return G.mat4.getRotation(e.rotation,this.getWorldTransform(t,e));}},{key:"getScale",value:function(t){var e=t.transformable;return G.mat4.getScaling(e.scaling,this.getWorldTransform(t,e));}},{key:"getOrigin",value:function(t){return t.getGeometryBounds(),t.transformable.origin;}},{key:"getWorldTransform",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.transformable;return(e.localDirtyFlag||e.dirtyFlag)&&(t.parentNode&&t.parentNode.transformable&&this.getWorldTransform(t.parentNode),this.internalUpdateTransform(t)),e.worldTransform;}},{key:"setPosition",value:function(t,e){var n,r=t.transformable;if(r0[0]=e[0],r0[1]=e[1],r0[2]=null!==(n=e[2])&&void 0!==n?n:0,!G.vec3.equals(this.getPosition(t),r0)){if(G.vec3.copy(r.position,r0),null!==t.parentNode&&t.parentNode.transformable){var i=t.parentNode.transformable;G.mat4.copy(r1,i.worldTransform),G.mat4.invert(r1,r1),G.vec3.transformMat4(r.localPosition,r0,r1);}else G.vec3.copy(r.localPosition,r0);this.dirtyLocalTransform(t,r);}}},{key:"translate",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.set(rX,e,n,r)),G.vec3.equals(e,rH)||(G.vec3.add(rX,this.getPosition(t),e),this.setPosition(t,rX));}},{key:"setRotation",value:function(t,e,n,r,i){var a=t.transformable;if("number"==typeof e&&(e=G.quat.fromValues(e,n,r,i)),null!==t.parentNode&&t.parentNode.transformable){var o=this.getRotation(t.parentNode);G.quat.copy(r$,o),G.quat.invert(r$,r$),G.quat.multiply(a.localRotation,r$,e),G.quat.normalize(a.localRotation,a.localRotation),this.dirtyLocalTransform(t,a);}else this.setLocalRotation(t,e);}},{key:"rotate",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var i=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){G.quat.fromEuler(r$,e[0],e[1],e[2]);var a=this.getRotation(t),o=this.getRotation(t.parentNode);G.quat.copy(r4,o),G.quat.invert(r4,r4),G.quat.multiply(r$,r4,r$),G.quat.multiply(i.localRotation,r$,a),G.quat.normalize(i.localRotation,i.localRotation),this.dirtyLocalTransform(t,i);}else this.rotateLocal(t,e);}},{key:"setOrigin",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=[e,n,r]);var i=t.transformable;if(e[0]!==i.origin[0]||e[1]!==i.origin[1]||e[2]!==i.origin[2]){var a=i.origin;a[0]=e[0],a[1]=e[1],a[2]=e[2]||0,this.dirtyLocalTransform(t,i);}}},{key:"setEulerAngles",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var i=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){G.quat.fromEuler(i.localRotation,e[0],e[1],e[2]);var a=this.getRotation(t.parentNode);G.quat.copy(r2,G.quat.invert(r$,a)),G.quat.mul(i.localRotation,i.localRotation,r2),this.dirtyLocalTransform(t,i);}else this.setLocalEulerAngles(t,e);}},{key:"getGeometryBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.geometry;return n.dirty&&ir.styleValueRegistry.updateGeometry(t),(e?n.renderBounds:n.contentBounds||null)||new tr;}},{key:"getTransformedGeometryBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this.getGeometryBounds(t,e);if(!tr.isEmpty(r)){var i=n||new tr;return i.setFromTransformedAABB(r,this.getWorldTransform(t)),i;}return null;}},{key:"getBounds",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t.renderable;if(!r.boundsDirty&&!n&&r.bounds)return r.bounds;if(!r.renderBoundsDirty&&n&&r.renderBounds)return r.renderBounds;var i=n?r.renderBounds:r.bounds,a=this.getTransformedGeometryBounds(t,n,i);if(t.childNodes.forEach(function(t){var r=e.getBounds(t,n);r&&(a?a.add(r):(a=i||new tr).update(r.center,r.halfExtents));}),a||(a=new tr),n){var o=function(t){var e,n=t;do{if(null===(e=n.parsedStyle)||void 0===e?void 0:e.clipPath)return n;n=n.parentElement;}while(null!==n)return null;}(t);if(o){var s=o.parsedStyle.clipPath.getBounds(n);a?s&&(a=s.intersection(a)):a.update(s.center,s.halfExtents);}}return n?(r.renderBounds=a,r.renderBoundsDirty=!1):(r.bounds=a,r.boundsDirty=!1),a;}},{key:"getLocalBounds",value:function(t){if(t.parentNode){var e=rW;t.parentNode.transformable&&(e=G.mat4.invert(rj,this.getWorldTransform(t.parentNode)));var n=this.getBounds(t);if(!tr.isEmpty(n)){var r=new tr;return r.setFromTransformedAABB(n,e),r;}}return this.getBounds(t);}},{key:"getBoundingClientRect",value:function(t){var e,n,r=this.getGeometryBounds(t);tr.isEmpty(r)||(n=new tr).setFromTransformedAABB(r,this.getWorldTransform(t));var i=null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e?void 0:e.getContextService().getBoundingClientRect();if(n){var a=n.getMin(),o=(0,D.default)(a,2),s=o[0],l=o[1],u=n.getMax(),c=(0,D.default)(u,2),h=c[0],d=c[1];return new tl(s+((null==i?void 0:i.left)||0),l+((null==i?void 0:i.top)||0),h-s,d-l);}return new tl((null==i?void 0:i.left)||0,(null==i?void 0:i.top)||0,0,0);}},{key:"internalUpdateTransform",value:function(t){var e,n,r=null===(n=t.parentNode)||void 0===n?void 0:n.transformable;tI(t.transformable),(e=t.transformable).dirtyFlag&&(r?G.mat4.multiply(e.worldTransform,r.worldTransform,e.localTransform):G.mat4.copy(e.worldTransform,e.localTransform),e.dirtyFlag=!1);}},{key:"internalUpdateElement",value:function(t,e){var n=(null===(s=t.ownerDocument)||void 0===s||null===(s=s.defaultView)||void 0===s||null===(s=s.getConfig())||void 0===s||null===(s=s.future)||void 0===s?void 0:s.experimentalAttributeUpdateOptimization)===!0,r=e[e.length-1],i=(null==r?void 0:r.transformDirty)||(null===(l=t.transformable)||void 0===l?void 0:l.localDirtyFlag);t.transformable&&((h=t.transformable).dirtyFlag||(h.dirtyFlag=i)),this.internalUpdateTransform(t),i&&(null===(d=t.dirty)||void 0===d||d.call(t,!0,!0));var a=(null===(u=t.renderable)||void 0===u?void 0:u.boundsDirty)||(null===(c=t.renderable)||void 0===c?void 0:c.renderBoundsDirty);if((i||a)&&(null==r?void 0:r.shapeUpdated)===!1&&n)for(var o=e.length-1;o>=0;){var s,l,u,c,h,d,f,v,p=e[o];if(p.shapeUpdated)break;null===(f=(v=p.node).dirty)||void 0===f||f.call(v,!0,!0),p.shapeUpdated=!0,o-=1;}return i;}},{key:"syncHierarchy",value:function(t){for(var e,n,r=[t],i=t.parentNode?[{node:t.parentNode,transformDirty:(null===(e=t.parentNode.transformable)||void 0===e?void 0:e.localDirtyFlag)||(null===(n=t.parentNode.transformable)||void 0===n?void 0:n.dirtyFlag),shapeUpdated:!1}]:[];r.length>0;){for(var a=r.pop(),o=i[i.length-1];i.length>0&&a.parentNode!==o.node;)o=i.pop();var s=this.internalUpdateElement(a,i);if(a.childNodes.length>0){for(var l=a.childNodes.length-1;l>=0;l--)r.push(a.childNodes[l]);i.push({node:a,transformDirty:s,shapeUpdated:!1});}}}},{key:"dirtyLocalTransform",value:function(t,e){n0(t)||e.localDirtyFlag||(e.localDirtyFlag=!0,e.dirtyFlag||this.dirtyWorldTransform(t,e));}},{key:"dirtyWorldTransform",value:function(t,e){this.dirtyWorldInternal(t,e),this.dirtyToRoot(t,!0);}},{key:"dirtyWorldInternal",value:function(t,e){var n,r=this,i=(null===(n=t.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n||null===(n=n.getConfig())||void 0===n||null===(n=n.future)||void 0===n?void 0:n.experimentalAttributeUpdateOptimization)===!0;e.dirtyFlag||(e.dirtyFlag=!0,t.dirty(!0,!0),i||t.childNodes.forEach(function(t){var e=t.transformable;r.dirtyWorldInternal(t,e);}));}},{key:"dirtyToRoot",value:function(t){for(var e,n,r,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=t,o=(null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig())||void 0===e||null===(e=e.future)||void 0===e?void 0:e.experimentalAttributeUpdateOptimization)===!0;a&&(null===(n=(r=a).dirty)||void 0===n||n.call(r,!0,!0),!o);)a=a.parentNode;i&&t.forEach(function(t){var e;null===(e=t.dirty)||void 0===e||e.call(t,!0,!0);}),this.informDependentDisplayObjects(t);var s=t.mutations||[],l=s.find(function(t){return"attributes"===t.type&&t._boundsChangeData;});l?l._boundsChangeData={affectChildren:l._boundsChangeData.affectChildren||i}:(l={type:"attributes",target:t,_boundsChangeData:{affectChildren:i}},s.push(l)),t.mutations=s;}},{key:"dirtyFragment",value:function(t){var e,n=t.transformable;n&&(n.dirtyFlag=!0,n.localDirtyFlag=!0),null===(e=t.dirty)||void 0===e||e.call(t,!0,!0);for(var r=t.childNodes.length,i=0;i<r;i++)this.dirtyFragment(t.childNodes[i]);}},{key:"notifyMutationObservers",value:function(t){var e=new Set;if(t.getRoot().forEach(function(t){(t.mutations||[]).forEach(function(n){"attributes"===n.type&&n._boundsChangeData&&(n._boundsChangeData.affectChildren?t.forEach(function(t){var r=(0,A.default)({},n);r.target=t,e.add(r);}):e.add(n));}),t.mutations=void 0;}),e.size>0){var n=new rL(rB.BOUNDS_CHANGED,{detail:Array.from(e)});t.dispatchEvent(n,!0,!0);}}},{key:"updateDisplayObjectDependency",value:function(t,e,n,r){if(e&&e!==n){var i=this.displayObjectDependencyMap.get(e);if(i&&i[t]){var a=i[t].indexOf(r);i[t].splice(a,1);}}if(n){var o=this.displayObjectDependencyMap.get(n);o||(this.displayObjectDependencyMap.set(n,{}),o=this.displayObjectDependencyMap.get(n)),o[t]||(o[t]=[]),o[t].push(r);}}},{key:"informDependentDisplayObjects",value:function(t){var e,n=this,r=this.displayObjectDependencyMap.get(t);if(r){var i=null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig())||void 0===e||null===(e=e.future)||void 0===e?void 0:e.experimentalCancelEventPropagation;Object.keys(r).forEach(function(t){r[t].forEach(function(e){n.dirtyToRoot(e,!0),e.dispatchEvent(new rU(rB.ATTR_MODIFIED,e,n,n,t,rU.MODIFICATION,n,n),i,i),e.isCustomElement&&e.isConnected&&e.attributeChangedCallback&&e.attributeChangedCallback(t,n,n);});});}}}]),r6=(0,R.default)(function t(e){if((0,C.default)(this,t),e<=0)throw Error("LRU capacity must be a positive number.");this.capacity=e,this.cache=new Map;},[{key:"get",value:function(t){if(this.cache.has(t)){var e=this.cache.get(t);return this.cache.delete(t),this.cache.set(t,e),e;}}},{key:"put",value:function(t,e){if(this.cache.has(t)&&this.cache.delete(t),this.cache.set(t,e),this.cache.size>this.capacity){var n=this.cache.keys().next().value;this.cache.delete(n);}}},{key:"len",value:function(){return this.cache.size;}},{key:"clear",value:function(){this.cache.clear();}}]),r7={MetricsString:"|\xc9q\xc5",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},r9=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,r8=new RegExp("".concat(/[!%),.:;?\]}'""]/.source,"|").concat(/[!),.:;?\]}'""]/.source,"|").concat(/[)\]'"?!:;,.]/.source,"|").concat(/[!%),.:;?\]}'"]/.source)),it=new RegExp("".concat(/[$('"]/.source,"|").concat(/[([{'"]/.source,"|").concat(/[(['"...]/.source,"|").concat(/[$([{'"#]/.source)),ie=(0,R.default)(function t(e){var n=this;(0,C.default)(this,t),this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(t,e){return!n.isBreakingSpace(e)&&!!(t&&(it.exec(e)||r8.exec(t)));},this.trimByKinsokuShorui=function(t){var e=(0,O.default)(t),n=e[e.length-2];if(!n)return t;var r=n[n.length-1];return e[e.length-2]=n.slice(0,-1),e[e.length-1]=r+e[e.length-1],e;},this.runtime=e,this.charWidthCache=new r6(100);},[{key:"measureFont",value:function(t,e){if(this.fontMetricsCache[t])return this.fontMetricsCache[t];var n={ascent:0,descent:0,fontSize:0},r=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(e),i=this.runtime.offscreenCanvasCreator.getOrCreateContext(e,{willReadFrequently:!0});i.font=t;var a=r7.MetricsString+r7.BaselineSymbol,o=Math.ceil(i.measureText(a).width),s=Math.ceil(i.measureText(r7.BaselineSymbol).width),l=r7.HeightMultiplier*s;s=s*r7.BaselineMultiplier|0,r.width=o,r.height=l,i.fillStyle="#f00",i.fillRect(0,0,o,l),i.font=t,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(a,0,s);var u=i.getImageData(0,0,o||1,l||1).data,c=u.length,h=4*o,d=0,f=0,v=!1;for(d=0;d<s;++d){for(var p=0;p<h;p+=4)if(255!==u[f+p]){v=!0;break;}if(v)break;f+=h;}for(n.ascent=s-d,f=c-h,v=!1,d=l;d>s;--d){for(var g=0;g<h;g+=4)if(255!==u[f+g]){v=!0;break;}if(v)break;f-=h;}return n.descent=d-s,n.fontSize=n.ascent+n.descent,this.fontMetricsCache[t]=n,n;}},{key:"measureText",value:function(t,e,n){var r=e.fontSize,i=void 0===r?16:r,a=e.wordWrap,o=e.lineHeight,s=e.lineWidth,l=void 0===s?1:s,u=e.textBaseline,c=void 0===u?"alphabetic":u,h=e.textAlign,d=void 0===h?"start":h,f=e.letterSpacing,v=void 0===f?0:f,p=e.textPath;e.textPathSide,e.textPathStartOffset;var g=e.leading,y=void 0===g?0:g,m=rl(e),k=this.measureFont(m,n);0===k.fontSize&&(k.fontSize=i,k.ascent=i);var E=this.runtime.offscreenCanvasCreator.getOrCreateContext(n);E.font=m,e.isOverflowing=!1;var x=(void 0!==a&&a?this.wordWrap(t,e,n):t).split(/(?:\r\n|\r|\n)/),T=Array(x.length),N=0;if(p){p.getTotalLength();for(var b=0;b<x.length;b++)E.measureText(x[b]).width,x[b].length;}else{for(var S=0;S<x.length;S++){var w=E.measureText(x[S]).width+(x[S].length-1)*v;T[S]=w,N=Math.max(N,w);}var P=N+l,M=o||k.fontSize+l,A=Math.max(M,k.fontSize+l)+(x.length-1)*(M+y);M+=y;var C=0;return"middle"===c?C=-A/2:"bottom"===c||"alphabetic"===c||"ideographic"===c?C=-A:("top"===c||"hanging"===c)&&(C=0),{font:m,width:P,height:A,lines:x,lineWidths:T,lineHeight:M,maxLineWidth:N,fontProperties:k,lineMetrics:T.map(function(t,e){var n=0;return"center"===d||"middle"===d?n-=t/2:("right"===d||"end"===d)&&(n-=t),new tl(n-l/2,C+e*M,t+l,M);})};}}},{key:"wordWrap",value:function(t,e,n){var r=this,i=Array.from(t);if(0===i.length)return"";var a=this,o=e.wordWrapWidth,s=e.letterSpacing,l=void 0===s?0:s,u=e.maxLines,c=void 0===u?1/0:u,h=e.textOverflow,d=this.runtime.offscreenCanvasCreator.getOrCreateContext(n),f=(void 0===o?0:o)+l,v="";"ellipsis"===h?v="...":h&&"clip"!==h&&(v=h);var p=[""],g=0,y=0,m=-1,k=rl(e),E=this.charWidthCache.get(k);E||(E=new r6(500),this.charWidthCache.put(k,E));var x=function(t){return r.getFromCache(t,l,E,d);},T=x(v);function N(t,e,n,r){for(;x(t)<r&&e<i.length-1&&!a.isNewline(i[e+1]);)e+=1,t+=i[e];for(;x(t)>r&&e>=n;)e-=1,t=t.slice(0,-1);return{lineTxt:t,txtLastCharIndex:e};}function b(t,e){if(!(T<=0)&&!(T>f)){if(!p[t]){p[t]=v;return;}var n=N(p[t],e,m+1,f-T);p[t]=n.lineTxt+v;}}for(var S=0;S<i.length;S++){var w=i[S],P=i[S-1],M=i[S+1],A=x(w);if(this.isNewline(w)){if(g+1>=c){S<i.length-1&&b(g,S-1),e.isOverflowing=!0;break;}m=S-1,y=0,p[g+=1]="";continue;}if(A>f){b(g,S-1),e.isOverflowing=!0;break;}if(y>0&&y+A>f){var C=N(p[g],S-1,m+1,f);if(C.txtLastCharIndex!==S-1){if(p[g]=C.lineTxt,C.txtLastCharIndex===i.length-1)break;w=i[S=C.txtLastCharIndex+1],P=i[S-1],M=i[S+1],A=x(w);}if(g+1>=c){b(g,S-1),e.isOverflowing=!0;break;}if(m=S-1,y=0,p[g+=1]="",this.isBreakingSpace(w))continue;this.canBreakInLastChar(w)||(p=this.trimToBreakable(p),y=this.sumTextWidthByCache(p[g]||"",x)),this.shouldBreakByKinsokuShorui(w,M)&&(p=this.trimByKinsokuShorui(p),y+=x(P||""));}y+=A,p[g]+=w;}return p.join("\n");}},{key:"isBreakingSpace",value:function(t){return"string"==typeof t&&r7.BreakingSpaces.indexOf(t.charCodeAt(0))>=0;}},{key:"isNewline",value:function(t){return"string"==typeof t&&r7.Newlines.indexOf(t.charCodeAt(0))>=0;}},{key:"trimToBreakable",value:function(t){var e=(0,O.default)(t),n=e[e.length-2],r=this.findBreakableIndex(n);if(-1===r||!n)return e;var i=n.slice(r,r+1),a=this.isBreakingSpace(i);return e[e.length-1]+=n.slice(r+1,n.length),e[e.length-2]=n.slice(0,r+(a?0:1)),e;}},{key:"canBreakInLastChar",value:function(t){return!(t&&r9.test(t));}},{key:"sumTextWidthByCache",value:function(t,e){return t.split("").reduce(function(t,n){return t+e(n);},0);}},{key:"findBreakableIndex",value:function(t){for(var e=t.length-1;e>=0;e--)if(!r9.test(t[e]))return e;return -1;}},{key:"getFromCache",value:function(t,e,n,r){var i=n.get(t);if("number"!=typeof i){var a=t.length*e;i=r.measureText(t).width+a,n.put(t,i);}return i;}},{key:"clearCache",value:function(){this.fontMetricsCache={},this.charWidthCache.clear();}}]),ir={},ii=(T=new rS,N=new rb,x={},(0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)(x,j.FRAGMENT,null),j.CIRCLE,new rE),j.ELLIPSE,new rx),j.RECT,T),j.IMAGE,T),j.GROUP,new rP),j.LINE,new rT),j.TEXT,new rw(ir)),j.POLYLINE,N),j.POLYGON,N),(0,B.default)((0,B.default)((0,B.default)(x,j.PATH,new rN),j.HTML,new rM),j.MESH,null)),ia=(S=new n_,w=new nB,b={},(0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)(b,t_.PERCENTAGE,null),t_.NUMBER,new nH),t_.ANGLE,new nI),t_.DEFINED_PATH,new nD),t_.PAINT,S),t_.COLOR,S),t_.FILTER,new nG),t_.LENGTH,w),t_.LENGTH_PERCENTAGE,w),t_.LENGTH_PERCENTAGE_12,new nU),(0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)(b,t_.LENGTH_PERCENTAGE_14,new nV),t_.COORDINATE,new nB),t_.OFFSET_DISTANCE,new nY),t_.OPACITY_VALUE,new nW),t_.PATH,new nq),t_.LIST_OF_POINTS,new nX),t_.SHADOW_BLUR,new nj),t_.TEXT,new n$),t_.TEXT_TRANSFORM,new nK),t_.TRANSFORM,new ry),(0,B.default)((0,B.default)((0,B.default)(b,t_.TRANSFORM_ORIGIN,new rm),t_.Z_INDEX,new rk),t_.MARKER,new nz));ir.CameraContribution=tM,ir.AnimationTimeline=null,ir.EasingFunction=null,ir.offscreenCanvasCreator=new rD,ir.sceneGraphSelector=new rF,ir.sceneGraphService=new r5(ir),ir.textService=new ie(ir),ir.geometryUpdaterFactory=ii,ir.CSSPropertySyntaxFactory=ia,ir.styleValueRegistry=new nO(ir),ir.layoutRegistry=null,ir.globalThis="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==X?X:{},ir.enableStyleSyntax=!0,ir.enableSizeAttenuation=!1;var io=0,is=new rU(rB.INSERTED,null,"","","",0,"",""),il=new rU(rB.REMOVED,null,"","","",0,"",""),iu=new rL(rB.DESTROY),ic=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).entity=io++,t.transformable={dirtyFlag:!1,localDirtyFlag:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},t.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},t.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},t.cullable={strategy:tA.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},t.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},t.rBushNode={aabb:void 0},t.namespaceURI="g",t.scrollLeft=0,t.scrollTop=0,t.clientTop=0,t.clientLeft=0,t.style={},t.computedStyle={},t.parsedStyle={},t.attributes={},t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"dirty",value:function(){var t=!(arguments.length>0)||void 0===arguments[0]||arguments[0],e=arguments.length>1?arguments[1]:void 0;this.renderable.dirty=t,void 0!==e&&(this.renderable.boundsDirty=e,this.renderable.renderBoundsDirty=e,this.geometry.dirty=e);}},{key:"className",get:function(){return this.getAttribute("class")||"";},set:function(t){this.setAttribute("class",t);}},{key:"classList",get:function(){return this.className.split(" ").filter(function(t){return""!==t;});}},{key:"tagName",get:function(){return this.nodeName;}},{key:"children",get:function(){return this.childNodes;}},{key:"childElementCount",get:function(){return this.childNodes.length;}},{key:"firstElementChild",get:function(){return this.firstChild;}},{key:"lastElementChild",get:function(){return this.lastChild;}},{key:"parentElement",get:function(){return this.parentNode;}},{key:"nextSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t+1]||null;}return null;}},{key:"previousSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t-1]||null;}return null;}},{key:"cloneNode",value:function(t){throw Error(tu);}},{key:"appendChild",value:function(t,e){var n;if(t.destroyed)throw Error("Cannot append a destroyed element.");return ir.sceneGraphService.attach(t,this,e),null!==(n=this.ownerDocument)&&void 0!==n&&n.defaultView&&(n0(this)||t.nodeName!==j.FRAGMENT?this.ownerDocument.defaultView.mountChildren(t):this.ownerDocument.defaultView.mountFragment(t)),this.isMutationObserved&&(is.relatedNode=this,t.dispatchEvent(is)),t;}},{key:"insertBefore",value:function(t,e){if(e){t.parentElement&&t.parentElement.removeChild(t);var n=this.childNodes.indexOf(e);-1===n?this.appendChild(t):this.appendChild(t,n);}else this.appendChild(t);return t;}},{key:"replaceChild",value:function(t,e){var n=this.childNodes.indexOf(e);return this.removeChild(e),this.appendChild(t,n),e;}},{key:"removeChild",value:function(t){var e,n,r=(null===(e=this.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig().future)||void 0===e?void 0:e.experimentalCancelEventPropagation)===!0;return il.relatedNode=this,t.dispatchEvent(il,r,r),null!==(n=t.ownerDocument)&&void 0!==n&&n.defaultView&&t.ownerDocument.defaultView.unmountChildren(t),ir.sceneGraphService.detach(t),t;}},{key:"removeChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var e=this.childNodes[t];this.removeChild(e);}}},{key:"destroyChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var e=this.childNodes[t];e.childNodes.length>0&&e.destroyChildren(),e.destroy();}}},{key:"matches",value:function(t){return ir.sceneGraphService.matches(t,this);}},{key:"getElementById",value:function(t){return ir.sceneGraphService.querySelector("#".concat(t),this);}},{key:"getElementsByName",value:function(t){return ir.sceneGraphService.querySelectorAll('[name="'.concat(t,'"]'),this);}},{key:"getElementsByClassName",value:function(t){return ir.sceneGraphService.querySelectorAll(".".concat(t),this);}},{key:"getElementsByTagName",value:function(t){return ir.sceneGraphService.querySelectorAll(t,this);}},{key:"querySelector",value:function(t){return ir.sceneGraphService.querySelector(t,this);}},{key:"querySelectorAll",value:function(t){return ir.sceneGraphService.querySelectorAll(t,this);}},{key:"closest",value:function(t){var e=this;do{if(ir.sceneGraphService.matches(t,e))return e;e=e.parentElement;}while(null!==e)return null;}},{key:"find",value:function(t){var e=this,n=null;return this.forEach(function(r){return!(r!==e&&t(r))||(n=r,!1);}),n;}},{key:"findAll",value:function(t){var e=this,n=[];return this.forEach(function(r){r!==e&&t(r)&&n.push(r);}),n;}},{key:"after",value:function(){var t=this;if(this.parentNode){for(var e=this.parentNode.childNodes.indexOf(this),n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];r.forEach(function(n,r){var i;return null===(i=t.parentNode)||void 0===i?void 0:i.appendChild(n,e+r+1);});}}},{key:"before",value:function(){if(this.parentNode){for(var t=this.parentNode.childNodes.indexOf(this),e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n[0],a=(0,V.default)(n).slice(1);this.parentNode.appendChild(i,t),i.after.apply(i,(0,O.default)(a));}}},{key:"replaceWith",value:function(){this.after.apply(this,arguments),this.remove();}},{key:"append",value:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(function(e){return t.appendChild(e);});}},{key:"prepend",value:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(function(e,n){return t.appendChild(e,n);});}},{key:"replaceChildren",value:function(){for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,arguments);}},{key:"remove",value:function(){return this.parentNode?this.parentNode.removeChild(this):this;}},{key:"destroy",value:function(){var t,e=(null===(t=this.ownerDocument)||void 0===t||null===(t=t.defaultView)||void 0===t||null===(t=t.getConfig().future)||void 0===t?void 0:t.experimentalCancelEventPropagation)===!0;this.destroyChildren(),this.dispatchEvent(iu,e,e),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0;}},{key:"getGeometryBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return ir.sceneGraphService.getGeometryBounds(this,t);}},{key:"getTransformedGeometryBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return ir.sceneGraphService.getTransformedGeometryBounds(this,t);}},{key:"getBounds",value:function(){return ir.sceneGraphService.getBounds(this);}},{key:"getRenderBounds",value:function(){return ir.sceneGraphService.getBounds(this,!0);}},{key:"getLocalBounds",value:function(){return ir.sceneGraphService.getLocalBounds(this);}},{key:"getBoundingClientRect",value:function(){return ir.sceneGraphService.getBoundingClientRect(this);}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()];}},{key:"computedStyleMap",value:function(){return new Map(Object.entries(this.computedStyle));}},{key:"getAttributeNames",value:function(){return Object.keys(this.attributes);}},{key:"getAttribute",value:function(t){if("symbol"!=typeof t)return this.attributes[t];}},{key:"hasAttribute",value:function(t){return this.getAttributeNames().includes(t);}},{key:"hasAttributes",value:function(){return!!this.getAttributeNames().length;}},{key:"removeAttribute",value:function(t){this.setAttribute(t,null),delete this.attributes[t];}},{key:"setAttribute",value:function(t,e){this.attributes[t]=e;}},{key:"getAttributeNS",value:function(t,e){throw Error(tu);}},{key:"getAttributeNode",value:function(t){throw Error(tu);}},{key:"getAttributeNodeNS",value:function(t,e){throw Error(tu);}},{key:"hasAttributeNS",value:function(t,e){throw Error(tu);}},{key:"removeAttributeNS",value:function(t,e){throw Error(tu);}},{key:"removeAttributeNode",value:function(t){throw Error(tu);}},{key:"setAttributeNS",value:function(t,e,n){throw Error(tu);}},{key:"setAttributeNode",value:function(t){throw Error(tu);}},{key:"setAttributeNodeNS",value:function(t){throw Error(tu);}},{key:"toggleAttribute",value:function(t,e){throw Error(tu);}}]);}(rI);function ih(t){return!!(null!=t&&t.nodeName);}var id=ir.globalThis.Proxy?ir.globalThis.Proxy:function(){},iv=new rU(rB.ATTR_MODIFIED,null,null,null,null,rU.MODIFICATION,null,null),ip=G.vec3.create(),ig=G.quat.create(),iy=function(t){function e(t){var n;return(0,C.default)(this,e),(n=(0,L.default)(this,e)).isCustomElement=!1,n.isMutationObserved=!1,n.activeAnimations=[],n.config=t,n.id=t.id||"",n.name=t.name||"",(t.className||t.class)&&(n.className=t.className||t.class),n.nodeName=t.type||j.GROUP,t.initialParsedStyle&&Object.assign(n.parsedStyle,t.initialParsedStyle),n.initAttributes(t.style),ir.enableStyleSyntax&&(n.style=new id({setProperty:function(t,e){n.setAttribute(t,e);},getPropertyValue:function(t){return n.getAttribute(t);},removeProperty:function(t){n.removeAttribute(t);},item:function(){return"";}},{get:function(t,e){return void 0!==t[e]?t[e]:n.getAttribute(e);},set:function(t,e,r){return n.setAttribute(e,r),!0;}})),n;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"destroy",value:function(){(0,U.default)(e,"destroy",this,3)([]),this.getAnimations().forEach(function(t){t.cancel();});}},{key:"cloneNode",value:function(t,e){var n=(0,A.default)({},this.attributes);for(var r in n){var i=n[r];ih(i)&&"clipPath"!==r&&"offsetPath"!==r&&"textPath"!==r&&(n[r]=i.cloneNode(t)),e&&(n[r]=e(r,i));}var a=new this.constructor((0,A.default)((0,A.default)({},this.config),{},{style:n}));return a.setLocalTransform(this.getLocalTransform()),t&&this.children.forEach(function(e){if(!e.style.isMarker){var n=e.cloneNode(t);a.appendChild(n);}}),a;}},{key:"initAttributes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ir.styleValueRegistry.processProperties(this,t,{forceUpdateGeometry:!0}),this.dirty();}},{key:"setAttribute",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!(arguments.length>3)||void 0===arguments[3]||arguments[3];!(0,F.isUndefined)(n)&&(r||n!==this.attributes[t])&&(this.internalSetAttribute(t,n,{memoize:i}),(0,U.default)(e,"setAttribute",this,3)([t,n]));}},{key:"internalSetAttribute",value:function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.attributes[t],a=this.parsedStyle[t];ir.styleValueRegistry.processProperties(this,(0,B.default)({},t,e),r),this.dirty();var o=this.parsedStyle[t];if(this.isConnected){if(iv.relatedNode=this,iv.prevValue=i,iv.newValue=e,iv.attrName=t,iv.prevParsedValue=a,iv.newParsedValue=o,this.isMutationObserved)this.dispatchEvent(iv);else{var s,l=(null===(s=this.ownerDocument.defaultView.getConfig().future)||void 0===s?void 0:s.experimentalCancelEventPropagation)===!0;iv.target=this,this.ownerDocument.defaultView.dispatchEvent(iv,!0,l);}}(this.isCustomElement&&this.isConnected||!this.isCustomElement)&&(null===(n=this.attributeChangedCallback)||void 0===n||n.call(this,t,i,e,a,o));}},{key:"getBBox",value:function(){var t=this.getBounds(),e=t.getMin(),n=(0,D.default)(e,2),r=n[0],i=n[1],a=t.getMax(),o=(0,D.default)(a,2);return new tl(r,i,o[0]-r,o[1]-i);}},{key:"setOrigin",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ir.sceneGraphService.setOrigin(this,td(t,e,n,!1)),this;}},{key:"getOrigin",value:function(){return ir.sceneGraphService.getOrigin(this);}},{key:"setPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ir.sceneGraphService.setPosition(this,td(t,e,n,!1)),this;}},{key:"setLocalPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ir.sceneGraphService.setLocalPosition(this,td(t,e,n,!1)),this;}},{key:"translate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ir.sceneGraphService.translate(this,td(t,e,n,!1)),this;}},{key:"translateLocal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ir.sceneGraphService.translateLocal(this,td(t,e,n,!1)),this;}},{key:"getPosition",value:function(){return ir.sceneGraphService.getPosition(this);}},{key:"getLocalPosition",value:function(){return ir.sceneGraphService.getLocalPosition(this);}},{key:"scale",value:function(t,e,n){return this.scaleLocal(t,e,n);}},{key:"scaleLocal",value:function(t,e,n){return"number"==typeof t&&(e=e||t,n=n||t,t=td(t,e,n,!1)),ir.sceneGraphService.scaleLocal(this,t),this;}},{key:"setLocalScale",value:function(t,e,n){return"number"==typeof t&&(e=e||t,n=n||t,t=td(t,e,n,!1)),ir.sceneGraphService.setLocalScale(this,t),this;}},{key:"getLocalScale",value:function(){return ir.sceneGraphService.getLocalScale(this);}},{key:"getScale",value:function(){return ir.sceneGraphService.getScale(this);}},{key:"getEulerAngles",value:function(){var t=tg(ip,ir.sceneGraphService.getWorldTransform(this));return(0,D.default)(t,3)[2]*tv;}},{key:"getLocalEulerAngles",value:function(){var t=tg(ip,ir.sceneGraphService.getLocalRotation(this));return(0,D.default)(t,3)[2]*tv;}},{key:"setEulerAngles",value:function(t){return ir.sceneGraphService.setEulerAngles(this,0,0,t),this;}},{key:"setLocalEulerAngles",value:function(t){return ir.sceneGraphService.setLocalEulerAngles(this,0,0,t),this;}},{key:"rotateLocal",value:function(t,e,n){return(0,F.isNil)(e)&&(0,F.isNil)(n)?ir.sceneGraphService.rotateLocal(this,0,0,t):ir.sceneGraphService.rotateLocal(this,t,e,n),this;}},{key:"rotate",value:function(t,e,n){return(0,F.isNil)(e)&&(0,F.isNil)(n)?ir.sceneGraphService.rotate(this,0,0,t):ir.sceneGraphService.rotate(this,t,e,n),this;}},{key:"setRotation",value:function(t,e,n,r){return ir.sceneGraphService.setRotation(this,t,e,n,r),this;}},{key:"setLocalRotation",value:function(t,e,n,r){return ir.sceneGraphService.setLocalRotation(this,t,e,n,r),this;}},{key:"setLocalSkew",value:function(t,e){return ir.sceneGraphService.setLocalSkew(this,t,e),this;}},{key:"getRotation",value:function(){return ir.sceneGraphService.getRotation(this);}},{key:"getLocalRotation",value:function(){return ir.sceneGraphService.getLocalRotation(this);}},{key:"getLocalSkew",value:function(){return ir.sceneGraphService.getLocalSkew(this);}},{key:"getLocalTransform",value:function(){return ir.sceneGraphService.getLocalTransform(this);}},{key:"getWorldTransform",value:function(){return ir.sceneGraphService.getWorldTransform(this);}},{key:"setLocalTransform",value:function(t){return ir.sceneGraphService.setLocalTransform(this,t),this;}},{key:"resetLocalTransform",value:function(){ir.sceneGraphService.resetLocalTransform(this);}},{key:"getAnimations",value:function(){return this.activeAnimations;}},{key:"animate",value:function(t,e){var n,r=null===(n=this.ownerDocument)||void 0===n?void 0:n.timeline;return r?r.play(this,t,e):null;}},{key:"isVisible",value:function(){var t;return(null===(t=this.parsedStyle)||void 0===t?void 0:t.visibility)!=="hidden";}},{key:"interactive",get:function(){return this.isInteractive();},set:function(t){this.style.pointerEvents=t?"auto":"none";}},{key:"isInteractive",value:function(){var t;return(null===(t=this.parsedStyle)||void 0===t?void 0:t.pointerEvents)!=="none";}},{key:"isCulled",value:function(){return!!(this.cullable&&this.cullable.enable&&!this.cullable.visible);}},{key:"toFront",value:function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,(0,O.default)(this.parentNode.children.map(function(t){return Number(t.style.zIndex);})))+1),this;}},{key:"toBack",value:function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,(0,O.default)(this.parentNode.children.map(function(t){return Number(t.style.zIndex);})))-1),this;}},{key:"getConfig",value:function(){return this.config;}},{key:"attr",value:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n[0],a=n[1];return i?(0,F.isObject)(i)?(Object.keys(i).forEach(function(e){t.setAttribute(e,i[e]);}),this):2===n.length?(this.setAttribute(i,a),this):this.attributes[i]:this.attributes;}},{key:"getMatrix",value:function(t){var e,n,r,i=t||this.getWorldTransform(),a=G.mat4.getTranslation(ip,i),o=(0,D.default)(a,2),s=o[0],l=o[1],u=G.mat4.getScaling(ip,i),c=(0,D.default)(u,2),h=c[0],d=c[1],f=tg(ip,G.mat4.getRotation(ig,i)),v=(0,D.default)(f,3),p=v[0],g=v[2];return n=Math.cos(e=p||g),r=Math.sin(e),G.mat3.fromValues(h*n,d*r,0,-h*r,d*n,0,s,l,1);}},{key:"getLocalMatrix",value:function(){return this.getMatrix(this.getLocalTransform());}},{key:"setMatrix",value:function(t){var e=ty(t),n=(0,D.default)(e,5),r=n[0],i=n[1],a=n[2],o=n[3],s=n[4];this.setEulerAngles(s).setPosition(r,i).setLocalScale(a,o);}},{key:"setLocalMatrix",value:function(t){var e=ty(t),n=(0,D.default)(e,5),r=n[0],i=n[1],a=n[2],o=n[3],s=n[4];this.setLocalEulerAngles(s).setLocalPosition(r,i).setLocalScale(a,o);}},{key:"show",value:function(){this.forEach(function(t){t.style.visibility="visible";});}},{key:"hide",value:function(){this.forEach(function(t){t.style.visibility="hidden";});}},{key:"getCount",value:function(){return this.childElementCount;}},{key:"getParent",value:function(){return this.parentElement;}},{key:"getChildren",value:function(){return this.children;}},{key:"getFirst",value:function(){return this.firstElementChild;}},{key:"getLast",value:function(){return this.lastElementChild;}},{key:"getChildByIndex",value:function(t){return this.children[t]||null;}},{key:"add",value:function(t,e){return this.appendChild(t,e);}},{key:"set",value:function(t,e){this.config[t]=e;}},{key:"get",value:function(t){return this.config[t];}},{key:"moveTo",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(t,e,n),this;}},{key:"move",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(t,e,n),this;}},{key:"setZIndex",value:function(t){return this.style.zIndex=t,this;}}]);}(ic);iy.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","display","draggable","droppable","fill","fillOpacity","fillRule","filter","increasedLineWidthForHitTesting","lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit","hitArea","offsetDistance","offsetPath","offsetX","offsetY","opacity","pointerEvents","shadowColor","shadowType","shadowBlur","shadowOffsetX","shadowOffsetY","stroke","strokeOpacity","strokeWidth","strokeLinecap","strokeLineJoin","strokeDasharray","strokeDashoffset","transform","transformOrigin","textTransform","visibility","zIndex"]);var im=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.CIRCLE},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(iy);im.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iy.PARSED_STYLE_LIST),["cx","cy","cz","r","isBillboard","isSizeAttenuation"]));var ik=["style"];(function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,ik);return(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({style:r},i)])).isCustomElement=!0,t;}return(0,I.default)(e,t),(0,R.default)(e);})(iy).PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var iE=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.ELLIPSE},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(iy);iE.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iy.PARSED_STYLE_LIST),["cx","cy","cz","rx","ry","isBillboard","isSizeAttenuation"])),function(t){function e(){return(0,C.default)(this,e),(0,L.default)(this,e,[{type:j.FRAGMENT}]);}return(0,I.default)(e,t),(0,R.default)(e);}(iy).PARSED_STYLE_LIST=new Set(["class","className"]);var ix=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.GROUP},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(iy);ix.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var iT=["style"],iN=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iT);return(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({type:j.HTML,style:r},i)])).cullable.enable=!1,t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getDomElement",value:function(){return this.parsedStyle.$el;}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()];}},{key:"getLocalBounds",value:function(){if(this.parentNode){var t=G.mat4.invert(G.mat4.create(),this.parentNode.getWorldTransform()),e=this.getBounds();if(!tr.isEmpty(e)){var n=new tr;return n.setFromTransformedAABB(e,t),n;}}return this.getBounds();}}]);}(iy);iN.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iy.PARSED_STYLE_LIST),["x","y","$el","innerHTML","width","height"]));var ib=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.IMAGE},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(iy);ib.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iy.PARSED_STYLE_LIST),["x","y","z","src","width","height","isBillboard","billboardRotation","isSizeAttenuation","keepAspectRatio"]));var iS=["style"],iw=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iS);(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({type:j.LINE,style:(0,A.default)({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},r)},i)])).markerStartAngle=0,t.markerEndAngle=0;var a=t.parsedStyle,o=a.markerStart,s=a.markerEnd;return o&&ih(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),s&&ih(s)&&(t.markerEndAngle=s.getLocalEulerAngles(),t.appendChild(s)),t.transformMarker(!0),t.transformMarker(!1),t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"x1"===t||"y1"===t||"x2"===t||"y2"===t||"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&ih(r)&&(this.markerStartAngle=0,r.remove()),i&&ih(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t&&(r&&ih(r)&&(this.markerEndAngle=0,r.remove()),i&&ih(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1)));}},{key:"transformMarker",value:function(t){var e,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,h=s.markerEndOffset,d=s.x1,f=s.x2,v=s.y1,p=s.y2,g=t?l:u;if(g&&ih(g)){var y=0;t?(r=d,i=v,e=f-d,n=p-v,a=c||0,o=this.markerStartAngle):(r=f,i=p,e=d-f,n=v-p,a=h||0,o=this.markerEndAngle),y=Math.atan2(n,e),g.setLocalEulerAngles(180*y/Math.PI+o),g.setLocalPosition(r+Math.cos(y)*a,i+Math.sin(y)*a);}}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle,r=n.x1,i=n.y1,a=n.x2,o=n.y2,s=(0,z.linePointAt)(r,i,a,o,t),l=s.x,u=s.y,c=G.vec3.transformMat4(G.vec3.create(),G.vec3.fromValues(l,u,0),e?this.getWorldTransform():this.getLocalTransform());return new ts(c[0],c[1]);}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(t/this.getTotalLength(),e);}},{key:"getTotalLength",value:function(){var t=this.parsedStyle,e=t.x1,n=t.y1,r=t.x2,i=t.y2;return(0,z.lineLength)(e,n,r,i);}}]);}(iy);iw.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iy.PARSED_STYLE_LIST),["x1","y1","x2","y2","z1","z2","isBillboard","isSizeAttenuation","markerStart","markerEnd","markerStartOffset","markerEndOffset"]));var iP=["style"],iM=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iP);(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({type:j.PATH,style:r,initialParsedStyle:{miterLimit:4,d:(0,A.default)({},tD)}},i)])).markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var a=t.parsedStyle,o=a.markerStart,s=a.markerEnd,l=a.markerMid;return o&&ih(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),l&&ih(l)&&t.placeMarkerMid(l),s&&ih(s)&&(t.markerEndAngle=s.getLocalEulerAngles(),t.appendChild(s)),t.transformMarker(!0),t.transformMarker(!1),t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"d"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&ih(r)&&(this.markerStartAngle=0,r.remove()),i&&ih(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t?(r&&ih(r)&&(this.markerEndAngle=0,r.remove()),i&&ih(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(i);}},{key:"transformMarker",value:function(t){var e,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,h=s.markerEndOffset,d=t?l:u;if(d&&ih(d)){var f=0;if(t){var v=this.getStartTangent(),p=(0,D.default)(v,2),g=p[0],y=p[1];r=y[0],i=y[1],e=g[0]-y[0],n=g[1]-y[1],a=c||0,o=this.markerStartAngle;}else{var m=this.getEndTangent(),k=(0,D.default)(m,2),E=k[0],x=k[1];r=x[0],i=x[1],e=E[0]-x[0],n=E[1]-x[1],a=h||0,o=this.markerEndAngle;}f=Math.atan2(n,e),d.setLocalEulerAngles(180*f/Math.PI+o),d.setLocalPosition(r+Math.cos(f)*a,i+Math.sin(f)*a);}}},{key:"placeMarkerMid",value:function(t){var e=this.parsedStyle.d.segments;if(this.markerMidList.forEach(function(t){t.remove();}),t&&ih(t))for(var n=1;n<e.length-1;n++){var r=(0,D.default)(e[n].currentPoint,2),i=r[0],a=r[1],o=1===n?t:t.cloneNode(!0);this.markerMidList.push(o),this.appendChild(o),o.setLocalPosition(i,a);}}},{key:"getTotalLength",value:function(){return e7(this);}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle.d.absolutePath,r=(0,F.getPointAtLength)(n,t),i=r.x,a=r.y,o=G.vec3.transformMat4(G.vec3.create(),G.vec3.fromValues(i,a,0),e?this.getWorldTransform():this.getLocalTransform());return new ts(o[0],o[1]);}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPointAtLength(t*e7(this),e);}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.d.segments,e=[];if(t.length>1){var n=t[0].currentPoint,r=t[1].currentPoint,i=t[1].startTangent;e=[],i?e.push([n[0]-i[0],n[1]-i[1]]):e.push([r[0],r[1]]),e.push([n[0],n[1]]);}return e;}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.d.segments,e=t.length,n=[];if(e>1){var r=t[e-2].currentPoint,i=t[e-1].currentPoint,a=t[e-1].endTangent;n=[],a?n.push([i[0]-a[0],i[1]-a[1]]):n.push([r[0],r[1]]),n.push([i[0],i[1]]);}return n;}}]);}(iy);iM.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iy.PARSED_STYLE_LIST),["d","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard","isSizeAttenuation"]));var iA=["style"],iC=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iA);(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({type:j.POLYGON,style:r,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},i)])).markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var a=t.parsedStyle,o=a.markerStart,s=a.markerEnd,l=a.markerMid;return o&&ih(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),l&&ih(l)&&t.placeMarkerMid(l),s&&ih(s)&&(t.markerEndAngle=s.getLocalEulerAngles(),t.appendChild(s)),t.transformMarker(!0),t.transformMarker(!1),t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"points"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&ih(r)&&(this.markerStartAngle=0,r.remove()),i&&ih(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t?(r&&ih(r)&&(this.markerEndAngle=0,r.remove()),i&&ih(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(i);}},{key:"transformMarker",value:function(t){var e,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,h=s.markerEndOffset,d=(s.points||{}).points,f=t?l:u;if(f&&ih(f)&&d){var v=0;if(r=d[0][0],i=d[0][1],t)e=d[1][0]-d[0][0],n=d[1][1]-d[0][1],a=c||0,o=this.markerStartAngle;else{var p=d.length;this.parsedStyle.isClosed?(e=d[p-1][0]-d[0][0],n=d[p-1][1]-d[0][1]):(r=d[p-1][0],i=d[p-1][1],e=d[p-2][0]-d[p-1][0],n=d[p-2][1]-d[p-1][1]),a=h||0,o=this.markerEndAngle;}v=Math.atan2(n,e),f.setLocalEulerAngles(180*v/Math.PI+o),f.setLocalPosition(r+Math.cos(v)*a,i+Math.sin(v)*a);}}},{key:"placeMarkerMid",value:function(t){var e=(this.parsedStyle.points||{}).points;if(this.markerMidList.forEach(function(t){t.remove();}),this.markerMidList=[],t&&ih(t)&&e)for(var n=1;n<(this.parsedStyle.isClosed?e.length:e.length-1);n++){var r=e[n][0],i=e[n][1],a=1===n?t:t.cloneNode(!0);this.markerMidList.push(a),this.appendChild(a),a.setLocalPosition(r,i);}}}]);}(iy);iC.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iy.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isClosed","isBillboard","isSizeAttenuation"]));var iR=["style"],iO=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.style,r=(0,q.default)(t,iR);return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.POLYLINE,style:n,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},r)]);}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getTotalLength",value:function(){return 0===this.parsedStyle.points.totalLength&&(this.parsedStyle.points.totalLength=(0,z.polylineLength)(this.parsedStyle.points.points)),this.parsedStyle.points.totalLength;}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(t/this.getTotalLength(),e);}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle.points.points;if(0===this.parsedStyle.points.segments.length){var r,i,a=[],o=0,s=this.getTotalLength();n.forEach(function(t,e){n[e+1]&&((r=[0,0])[0]=o/s,i=(0,z.lineLength)(t[0],t[1],n[e+1][0],n[e+1][1]),o+=i,r[1]=o/s,a.push(r));}),this.parsedStyle.points.segments=a;}var l=0,u=0;this.parsedStyle.points.segments.forEach(function(e,n){t>=e[0]&&t<=e[1]&&(l=(t-e[0])/(e[1]-e[0]),u=n);});var c=(0,z.linePointAt)(n[u][0],n[u][1],n[u+1][0],n[u+1][1],l),h=c.x,d=c.y,f=G.vec3.transformMat4(G.vec3.create(),G.vec3.fromValues(h,d,0),e?this.getWorldTransform():this.getLocalTransform());return new ts(f[0],f[1]);}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.points.points,e=[];return e.push([t[1][0],t[1][1]]),e.push([t[0][0],t[0][1]]),e;}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.points.points,e=t.length-1,n=[];return n.push([t[e-1][0],t[e-1][1]]),n.push([t[e][0],t[e][1]]),n;}}]);}(iC);iO.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iC.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard"]));var iL=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.RECT},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(iy);iL.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iy.PARSED_STYLE_LIST),["x","y","z","width","height","isBillboard","isSizeAttenuation","radius"]));var iI=["style"],iD=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.style,r=(0,q.default)(t,iI);return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.TEXT,style:(0,A.default)({fill:"black"},n)},r)]);}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getComputedTextLength",value:function(){var t;return this.getGeometryBounds(),(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.maxLineWidth)||0;}},{key:"getLineBoundingRects",value:function(){var t;return this.getGeometryBounds(),(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.lineMetrics)||[];}},{key:"isOverflowing",value:function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing;}}]);}(iy);iD.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iy.PARSED_STYLE_LIST),["x","y","z","isBillboard","billboardRotation","isSizeAttenuation","text","textAlign","textBaseline","fontStyle","fontSize","fontFamily","fontWeight","fontVariant","lineHeight","letterSpacing","leading","wordWrap","wordWrapWidth","maxLines","textOverflow","isOverflowing","textPath","textDecorationLine","textDecorationColor","textDecorationStyle","textDecorationThickness","textPathSide","textPathStartOffset","metrics","dx","dy"])),(0,R.default)(function t(){(0,C.default)(this,t),this.registry={},this.define(j.CIRCLE,im),this.define(j.ELLIPSE,iE),this.define(j.RECT,iL),this.define(j.IMAGE,ib),this.define(j.LINE,iw),this.define(j.GROUP,ix),this.define(j.PATH,iM),this.define(j.POLYGON,iC),this.define(j.POLYLINE,iO),this.define(j.TEXT,iD),this.define(j.HTML,iN);},[{key:"define",value:function(t,e){this.registry[t]=e;}},{key:"get",value:function(t){return this.registry[t];}}]),function(){function t(e){(0,C.default)(this,t),this.strategies=e;}return(0,R.default)(t,[{key:"apply",value:function(e){var n=e.config,r=e.camera,i=e.renderingService,a=e.renderingContext,o=this.strategies;i.hooks.cull.tap(t.tag,function(t){if(t){var e,i=t.cullable;if(0===o.length?i.visible=a.unculledEntities.indexOf(t.entity)>-1:i.visible=o.every(function(e){return e.isVisible(r,t);}),!t.isCulled()&&t.isVisible())return t;var s=(null===(e=n.future)||void 0===e?void 0:e.experimentalCancelEventPropagation)===!0;return t.dispatchEvent(new rL(rB.CULLED),s,s),null;}return t;}),i.hooks.afterRender.tap(t.tag,function(t){t.cullable.visibilityPlaneMask=-1;});}}]);}().tag="Culling",function(){function t(){var e=this;(0,C.default)(this,t),this.autoPreventDefault=!1,this.rootPointerEvent=new rR(null),this.rootWheelEvent=new rO(null),this.onPointerMove=function(t){var n=null===(r=e.context.renderingContext.root)||void 0===r||null===(r=r.ownerDocument)||void 0===r?void 0:r.defaultView;if(!n.supportsTouchEvents||"touch"!==t.pointerType){var r,i,a=e.normalizeToPointerEvent(t,n),o=(0,W.default)(a);try{for(o.s();!(i=o.n()).done;){var s=i.value,l=e.bootstrapEvent(e.rootPointerEvent,s,n,t);e.context.eventService.mapEvent(l);}}catch(t){o.e(t);}finally{o.f();}e.setCursor(e.context.eventService.cursor);}},this.onClick=function(t){var n,r,i=null===(n=e.context.renderingContext.root)||void 0===n||null===(n=n.ownerDocument)||void 0===n?void 0:n.defaultView,a=e.normalizeToPointerEvent(t,i),o=(0,W.default)(a);try{for(o.s();!(r=o.n()).done;){var s=r.value,l=e.bootstrapEvent(e.rootPointerEvent,s,i,t);e.context.eventService.mapEvent(l);}}catch(t){o.e(t);}finally{o.f();}e.setCursor(e.context.eventService.cursor);};}return(0,R.default)(t,[{key:"apply",value:function(e){var n=this;this.context=e;var r=e.renderingService,i=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler(function(t){return n.context.renderingService.hooks.pickSync.call({position:t,picked:[],topmost:!0}).picked[0]||null;}),r.hooks.pointerWheel.tap(t.tag,function(t){var e=n.normalizeWheelEvent(t);n.context.eventService.mapEvent(e);}),r.hooks.pointerDown.tap(t.tag,function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){var e=n.normalizeToPointerEvent(t,i);n.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();var r,a=(0,W.default)(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=n.bootstrapEvent(n.rootPointerEvent,o,i,t);n.context.eventService.mapEvent(s);}}catch(t){a.e(t);}finally{a.f();}n.setCursor(n.context.eventService.cursor);}}),r.hooks.pointerUp.tap(t.tag,function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){var e,r=n.context.contextService.getDomElement(),a=n.context.eventService.isNativeEventFromCanvas(r,t)?"":"outside",o=n.normalizeToPointerEvent(t,i),s=(0,W.default)(o);try{for(s.s();!(e=s.n()).done;){var l=e.value,u=n.bootstrapEvent(n.rootPointerEvent,l,i,t);u.type+=a,n.context.eventService.mapEvent(u);}}catch(t){s.e(t);}finally{s.f();}n.setCursor(n.context.eventService.cursor);}}),r.hooks.pointerMove.tap(t.tag,this.onPointerMove),r.hooks.pointerOver.tap(t.tag,this.onPointerMove),r.hooks.pointerOut.tap(t.tag,this.onPointerMove),r.hooks.click.tap(t.tag,this.onClick),r.hooks.pointerCancel.tap(t.tag,function(t){var e,r=n.normalizeToPointerEvent(t,i),a=(0,W.default)(r);try{for(a.s();!(e=a.n()).done;){var o=e.value,s=n.bootstrapEvent(n.rootPointerEvent,o,i,t);n.context.eventService.mapEvent(s);}}catch(t){a.e(t);}finally{a.f();}n.setCursor(n.context.eventService.cursor);});}},{key:"bootstrapEvent",value:function(t,e,n,r){t.view=n,t.originalEvent=null,t.nativeEvent=r,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);var i=this.context.eventService.client2Viewport({x:e.clientX,y:e.clientY}),a=i.x,o=i.y;t.viewport.x=a,t.viewport.y=o;var s=this.context.eventService.viewport2Canvas(t.viewport),l=s.x,u=s.y;return t.canvas.x=l,t.canvas.y=u,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=r.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=nQ[t.type]||t.type),t;}},{key:"normalizeWheelEvent",value:function(t){var e=this.rootWheelEvent;this.transferMouseData(e,t),e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;var n=this.context.eventService.client2Viewport({x:t.clientX,y:t.clientY}),r=n.x,i=n.y;e.viewport.x=r,e.viewport.y=i;var a=this.context.eventService.viewport2Canvas(e.viewport),o=a.x,s=a.y;return e.canvas.x=o,e.canvas.y=s,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.nativeEvent=t,e.type=t.type,e;}},{key:"transferMouseData",value:function(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=nJ.now(),t.type=e.type,t.altKey=e.altKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.ctrlKey=e.ctrlKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.screen.x=e.screenX,t.screen.y=e.screenY,t.relatedTarget=null;}},{key:"setCursor",value:function(t){this.context.contextService.applyCursorStyle(t||this.context.config.cursor||"default");}},{key:"normalizeToPointerEvent",value:function(t,e){var n=[];if(e.isTouchEvent(t))for(var r=0;r<t.changedTouches.length;r++){var i=t.changedTouches[r];(0,F.isUndefined)(i.button)&&(i.button=0),(0,F.isUndefined)(i.buttons)&&(i.buttons=1),(0,F.isUndefined)(i.isPrimary)&&(i.isPrimary=1===t.touches.length&&"touchstart"===t.type),(0,F.isUndefined)(i.width)&&(i.width=i.radiusX||1),(0,F.isUndefined)(i.height)&&(i.height=i.radiusY||1),(0,F.isUndefined)(i.tiltX)&&(i.tiltX=0),(0,F.isUndefined)(i.tiltY)&&(i.tiltY=0),(0,F.isUndefined)(i.pointerType)&&(i.pointerType="touch"),(0,F.isUndefined)(i.pointerId)&&(i.pointerId=i.identifier||0),(0,F.isUndefined)(i.pressure)&&(i.pressure=i.force||.5),(0,F.isUndefined)(i.twist)&&(i.twist=0),(0,F.isUndefined)(i.tangentialPressure)&&(i.tangentialPressure=0),i.isNormalized=!0,i.type=t.type,n.push(i);}else e.isMouseEvent(t)&&((0,F.isUndefined)(t.isPrimary)&&(t.isPrimary=!0),(0,F.isUndefined)(t.width)&&(t.width=1),(0,F.isUndefined)(t.height)&&(t.height=1),(0,F.isUndefined)(t.tiltX)&&(t.tiltX=0),(0,F.isUndefined)(t.tiltY)&&(t.tiltY=0),(0,F.isUndefined)(t.pointerType)&&(t.pointerType="mouse"),(0,F.isUndefined)(t.pointerId)&&(t.pointerId=1),(0,F.isUndefined)(t.pressure)&&(t.pressure=.5),(0,F.isUndefined)(t.twist)&&(t.twist=0),(0,F.isUndefined)(t.tangentialPressure)&&(t.tangentialPressure=0),t.isNormalized=!0),n.push(t);return n;}}]);}().tag="Event";var i_=[j.CIRCLE,j.ELLIPSE,j.IMAGE,j.RECT,j.LINE,j.POLYLINE,j.POLYGON,j.TEXT,j.PATH,j.HTML];(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"isVisible",value:function(t,e){var n,r=e.cullable;if(!r.enable)return!0;var i=e.getRenderBounds();if(tr.isEmpty(i))return!1;var a=t.getFrustum(),o=null===(n=e.parentNode)||void 0===n||null===(n=n.cullable)||void 0===n?void 0:n.visibilityPlaneMask;return r.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(e,i,o||ta.INDETERMINATE,a.planes),r.visible=r.visibilityPlaneMask!==ta.OUTSIDE,r.visible;}},{key:"computeVisibilityWithPlaneMask",value:function(t,e,n,r){if(n===ta.OUTSIDE||n===ta.INSIDE)return n;for(var i=ta.INSIDE,a=i_.indexOf(t.nodeName)>-1,o=0,s=r.length;o<s;++o){var l=1<<o;if((n&l)!=0&&(!a||4!==o&&5!==o)){var u=r[o],c=u.normal,h=u.distance;if(G.vec3.dot(c,e.getPositiveFarPoint(r[o]))+h<0)return ta.OUTSIDE;G.vec3.dot(c,e.getNegativeFarPoint(r[o]))+h<0&&(i|=l);}}return i;}}]),function(){function t(){(0,C.default)(this,t),this.mutationRecords=[],this.isFirstTimeRendering=!0,this.isFirstTimeRenderingFinished=!1;}return(0,R.default)(t,[{key:"apply",value:function(e){var n,r=this,i=e.renderingService,a=e.renderingContext.root.ownerDocument.defaultView,o=function(t){i.dirty();},s=function(t){var e,n=t.detail;(e=r.mutationRecords).push.apply(e,(0,O.default)(n)),i.dirty();},l=function(t){var e=t.target;ir.enableSizeAttenuation&&ir.styleValueRegistry.updateSizeAttenuation(e,a.getCamera().getZoom());},u=function(t){var e=t.target;ir.sceneGraphService.dirtyToRoot(e),i.dirty();};i.hooks.init.tap(t.tag,function(){a.addEventListener(rB.MOUNTED,l),a.addEventListener(rB.UNMOUNTED,u),a.addEventListener(rB.ATTR_MODIFIED,o),a.addEventListener(rB.BOUNDS_CHANGED,s);}),i.hooks.destroy.tap(t.tag,function(){a.removeEventListener(rB.MOUNTED,l),a.removeEventListener(rB.UNMOUNTED,u),a.removeEventListener(rB.ATTR_MODIFIED,o),a.removeEventListener(rB.BOUNDS_CHANGED,s),r.mutationRecords=[];});var c=null!==(n=ir.globalThis.requestIdleCallback)&&void 0!==n?n:n8.bind(ir.globalThis);i.hooks.endFrame.tap(t.tag,function(){r.isFirstTimeRendering&&(r.isFirstTimeRendering=!1,c(function(){r.isFirstTimeRenderingFinished=!0;})),r.mutationRecords=[];});}}]);}().tag="Prepare";var iG=((P={}).READY="ready",P.BEFORE_RENDER="beforerender",P.RERENDER="rerender",P.AFTER_RENDER="afterrender",P.BEFORE_DESTROY="beforedestroy",P.AFTER_DESTROY="afterdestroy",P.RESIZE="resize",P.DIRTY_RECTANGLE="dirtyrectangle",P.RENDERER_CHANGED="rendererchanged",P);new rL(rB.MOUNTED),new rL(rB.UNMOUNTED),new rL(iG.BEFORE_RENDER),new rL(iG.RERENDER),new rL(iG.AFTER_RENDER);},"1156cd44":function(t,e,n){"use strict";n.d(e,"__esModule",{value:!0}),n.e(e,{AbstractRenderer:function(){return Z;},AbstractRendererPlugin:function(){return K;},RenderReason:function(){return rB;},setDOMSize:function(){return n0;}});var r,i,a,o,s,l,u,c,h,d,f,v,p,g,y,m,k,E,x,T,N,b,S,w,P,M=n("777fffbe"),A=M._(n("ab297151")),C=M._(n("b1a4abb6")),R=M._(n("72ce8fb5")),O=M._(n("d60881d0")),L=M._(n("0b95a4d2")),I=M._(n("0afdccfb")),D=M._(n("7465ab36")),_=M._(n("32f41e1c")),G=n("597fa39f");n("f90e84e3");var F=n("abe9d8d6"),B=M._(n("3214ccb5")),U=M._(n("51ffafbb")),V=M._(n("3c7f532e")),z=n("b1a96927"),H=M._(n("2fabd5d4")),Y=M._(n("cb203630")),W=M._(n("1982f763")),q=M._(n("01aac514"));let X=n("1714eebe");var j=((r={}).GROUP="g",r.FRAGMENT="fragment",r.CIRCLE="circle",r.ELLIPSE="ellipse",r.IMAGE="image",r.RECT="rect",r.LINE="line",r.POLYLINE="polyline",r.POLYGON="polygon",r.TEXT="text",r.PATH="path",r.HTML="html",r.MESH="mesh",r),$=((i={})[i.ZERO=0]="ZERO",i[i.NEGATIVE_ONE=1]="NEGATIVE_ONE",i),K=(0,R.default)(function t(){(0,C.default)(this,t),this.plugins=[];},[{key:"addRenderingPlugin",value:function(t){this.plugins.push(t),this.context.renderingPlugins.push(t);}},{key:"removeAllRenderingPlugins",value:function(){var t=this;this.plugins.forEach(function(e){var n=t.context.renderingPlugins.indexOf(e);n>=0&&t.context.renderingPlugins.splice(n,1);});}}]),Z=(0,R.default)(function t(e){(0,C.default)(this,t),this.clipSpaceNearZ=$.NEGATIVE_ONE,this.plugins=[],this.config=(0,A.default)({enableDirtyCheck:!0,enableCulling:!1,enableAutoRendering:!0,enableDirtyRectangleRendering:!0,enableDirtyRectangleRenderingDebug:!1,enableSizeAttenuation:!0,enableRenderingOptimization:!1},e);},[{key:"registerPlugin",value:function(t){-1===this.plugins.findIndex(function(e){return e===t;})&&this.plugins.push(t);}},{key:"unregisterPlugin",value:function(t){var e=this.plugins.findIndex(function(e){return e===t;});e>-1&&this.plugins.splice(e,1);}},{key:"getPlugins",value:function(){return this.plugins;}},{key:"getPlugin",value:function(t){return this.plugins.find(function(e){return e.name===t;});}},{key:"getConfig",value:function(){return this.config;}},{key:"setConfig",value:function(t){Object.assign(this.config,t);}}]),Q=G.vec3.add,J=G.vec3.copy,tt=G.vec3.max,te=G.vec3.min,tn=G.vec3.scale,tr=G.vec3.sub,ti=function(){function t(){(0,C.default)(this,t),this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0];}return(0,R.default)(t,[{key:"update",value:function(t,e){J(this.center,t),J(this.halfExtents,e),tr(this.min,this.center,this.halfExtents),Q(this.max,this.center,this.halfExtents);}},{key:"setMinMax",value:function(t,e){Q(this.center,e,t),tn(this.center,this.center,.5),tr(this.halfExtents,e,t),tn(this.halfExtents,this.halfExtents,.5),J(this.min,t),J(this.max,e);}},{key:"getMin",value:function(){return this.min;}},{key:"getMax",value:function(){return this.max;}},{key:"add",value:function(e){if(!t.isEmpty(e)){if(t.isEmpty(this)){this.setMinMax(e.getMin(),e.getMax());return;}var n=this.center,r=n[0],i=n[1],a=n[2],o=this.halfExtents,s=o[0],l=o[1],u=o[2],c=r-s,h=r+s,d=i-l,f=i+l,v=a-u,p=a+u,g=e.center,y=g[0],m=g[1],k=g[2],E=e.halfExtents,x=E[0],T=E[1],N=E[2],b=y-x,S=y+x,w=m-T,P=m+T,M=k-N,A=k+N;b<c&&(c=b),S>h&&(h=S),w<d&&(d=w),P>f&&(f=P),M<v&&(v=M),A>p&&(p=A),n[0]=(c+h)*.5,n[1]=(d+f)*.5,n[2]=(v+p)*.5,o[0]=(h-c)*.5,o[1]=(f-d)*.5,o[2]=(p-v)*.5,this.min[0]=c,this.min[1]=d,this.min[2]=v,this.max[0]=h,this.max[1]=f,this.max[2]=p;}}},{key:"setFromTransformedAABB",value:function(t,e){var n=this.center,r=this.halfExtents,i=t.center,a=t.halfExtents,o=e[0],s=e[4],l=e[8],u=e[1],c=e[5],h=e[9],d=e[2],f=e[6],v=e[10],p=Math.abs(o),g=Math.abs(s),y=Math.abs(l),m=Math.abs(u),k=Math.abs(c),E=Math.abs(h),x=Math.abs(d),T=Math.abs(f),N=Math.abs(v);n[0]=e[12]+o*i[0]+s*i[1]+l*i[2],n[1]=e[13]+u*i[0]+c*i[1]+h*i[2],n[2]=e[14]+d*i[0]+f*i[1]+v*i[2],r[0]=p*a[0]+g*a[1]+y*a[2],r[1]=m*a[0]+k*a[1]+E*a[2],r[2]=x*a[0]+T*a[1]+N*a[2],tr(this.min,n,r),Q(this.max,n,r);}},{key:"intersects",value:function(t){var e=this.getMax(),n=this.getMin(),r=t.getMax(),i=t.getMin();return n[0]<=r[0]&&e[0]>=i[0]&&n[1]<=r[1]&&e[1]>=i[1]&&n[2]<=r[2]&&e[2]>=i[2];}},{key:"intersection",value:function(e){if(!this.intersects(e))return null;var n=new t,r=tt([0,0,0],this.getMin(),e.getMin()),i=te([0,0,0],this.getMax(),e.getMax());return n.setMinMax(r,i),n;}},{key:"getNegativeFarPoint",value:function(t){return 273===t.pnVertexFlag?J([0,0,0],this.min):272===t.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:257===t.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:256===t.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:17===t.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:16===t.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:1===t.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]];}},{key:"getPositiveFarPoint",value:function(t){return 273===t.pnVertexFlag?J([0,0,0],this.max):272===t.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:257===t.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:256===t.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:17===t.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:16===t.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:1===t.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]];}}],[{key:"isEmpty",value:function(t){return!t||0===t.halfExtents[0]&&0===t.halfExtents[1]&&0===t.halfExtents[2];}}]);}(),ta=(0,R.default)(function t(e,n){(0,C.default)(this,t),this.distance=e||0,this.normal=n||G.vec3.fromValues(0,1,0),this.updatePNVertexFlag();},[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(Number(this.normal[0]>=0)<<8)+(Number(this.normal[1]>=0)<<4)+Number(this.normal[2]>=0);}},{key:"distanceToPoint",value:function(t){return G.vec3.dot(t,this.normal)-this.distance;}},{key:"normalize",value:function(){var t=1/G.vec3.len(this.normal);G.vec3.scale(this.normal,this.normal,t),this.distance*=t;}},{key:"intersectsLine",value:function(t,e,n){var r=this.distanceToPoint(t),i=r/(r-this.distanceToPoint(e)),a=i>=0&&i<=1;return a&&n&&G.vec3.lerp(n,t,e,i),a;}}]),to=((a={})[a.OUTSIDE=4294967295]="OUTSIDE",a[a.INSIDE=0]="INSIDE",a[a.INDETERMINATE=2147483647]="INDETERMINATE",a),ts=(0,R.default)(function t(e){if((0,C.default)(this,t),this.planes=[],e)this.planes=e;else for(var n=0;n<6;n++)this.planes.push(new ta);},[{key:"extractFromVPMatrix",value:function(t){var e=(0,D.default)(t,16),n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],v=e[12],p=e[13],g=e[14],y=e[15];G.vec3.set(this.planes[0].normal,a-n,u-o,f-c),this.planes[0].distance=y-v,G.vec3.set(this.planes[1].normal,a+n,u+o,f+c),this.planes[1].distance=y+v,G.vec3.set(this.planes[2].normal,a+r,u+s,f+h),this.planes[2].distance=y+p,G.vec3.set(this.planes[3].normal,a-r,u-s,f-h),this.planes[3].distance=y-p,G.vec3.set(this.planes[4].normal,a-i,u-l,f-d),this.planes[4].distance=y-g,G.vec3.set(this.planes[5].normal,a+i,u+l,f+d),this.planes[5].distance=y+g,this.planes.forEach(function(t){t.normalize(),t.updatePNVertexFlag();});}}]),tl=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,C.default)(this,t),this.x=0,this.y=0,this.x=e,this.y=n;}return(0,R.default)(t,[{key:"clone",value:function(){return new t(this.x,this.y);}},{key:"copyFrom",value:function(t){this.x=t.x,this.y=t.y;}}]);}(),tu=function(){function t(e,n,r,i){(0,C.default)(this,t),this.x=e,this.y=n,this.width=r,this.height=i,this.left=e,this.right=e+r,this.top=n,this.bottom=n+i;}return(0,R.default)(t,[{key:"toJSON",value:function(){}}],[{key:"fromRect",value:function(e){return new t(e.x,e.y,e.width,e.height);}},{key:"applyTransform",value:function(e,n){var r=G.vec4.fromValues(e.x,e.y,0,1),i=G.vec4.fromValues(e.x+e.width,e.y,0,1),a=G.vec4.fromValues(e.x,e.y+e.height,0,1),o=G.vec4.fromValues(e.x+e.width,e.y+e.height,0,1),s=G.vec4.create(),l=G.vec4.create(),u=G.vec4.create(),c=G.vec4.create();G.vec4.transformMat4(s,r,n),G.vec4.transformMat4(l,i,n),G.vec4.transformMat4(u,a,n),G.vec4.transformMat4(c,o,n);var h=Math.min(s[0],l[0],u[0],c[0]),d=Math.min(s[1],l[1],u[1],c[1]),f=Math.max(s[0],l[0],u[0],c[0]),v=Math.max(s[1],l[1],u[1],c[1]);return t.fromRect({x:h,y:d,width:f-h,height:v-d});}}]);}(),tc="Method not implemented.";function th(t){return void 0===t?0:t>360||t<-360?t%360:t;}var td=G.vec3.create();function tf(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];return Array.isArray(t)&&3===t.length?r?G.vec3.clone(t):G.vec3.copy(td,t):(0,F.isNumber)(t)?r?G.vec3.fromValues(t,e,n):G.vec3.set(td,t,e,n):r?G.vec3.fromValues(t[0],t[1]||e,t[2]||n):G.vec3.set(td,t[0],t[1]||e,t[2]||n);}var tv=Math.PI/180,tp=180/Math.PI,tg=Math.PI/2;function ty(t,e){var n,r,i,a,o,s,l,u,c,h,d,f,v,p,g,y,m;return 16===e.length?(i=G.mat4.getScaling(G.vec3.create(),e),o=(a=(0,D.default)(i,3))[0],s=a[1],l=a[2],(u=Math.asin(-e[2]/o))<tg?u>-tg?(n=Math.atan2(e[6]/s,e[10]/l),r=Math.atan2(e[1]/o,e[0]/o)):(r=0,n=-Math.atan2(e[4]/s,e[5]/s)):(r=0,n=Math.atan2(e[4]/s,e[5]/s)),t[0]=n,t[1]=u,t[2]=r):(c=e[0],h=e[1],d=e[2],f=e[3],y=c*c+(v=h*h)+(p=d*d)+(g=f*f),(m=c*f-h*d)>.499995*y?(t[0]=tg,t[1]=2*Math.atan2(h,c),t[2]=0):m<-.499995*y?(t[0]=-tg,t[1]=2*Math.atan2(h,c),t[2]=0):(t[0]=Math.asin(2*(c*d-f*h)),t[1]=Math.atan2(2*(c*f+h*d),1-2*(p+g)),t[2]=Math.atan2(2*(c*h+d*f),1-2*(v+p)))),t;}function tm(t){var e=t[0],n=t[1],r=t[3],i=t[4],a=Math.sqrt(e*e+n*n),o=Math.sqrt(r*r+i*i);if(e*i-n*r<0&&(e<i?a=-a:o=-o),a){var s=1/a;e*=s,n*=s;}if(o){var l=1/o;r*=l,i*=l;}var u=Math.atan2(n,e)*tp;return[t[6],t[7],a,o,u];}var tk=G.mat4.create(),tE=G.mat4.create(),tx=G.vec4.create(),tT=[G.vec3.create(),G.vec3.create(),G.vec3.create()],tN=G.vec3.create();function tb(t,e,n,r,i){t[0]=e[0]*r+n[0]*i,t[1]=e[1]*r+n[1]*i,t[2]=e[2]*r+n[2]*i;}var tS=((o={})[o.ORBITING=0]="ORBITING",o[o.EXPLORING=1]="EXPLORING",o[o.TRACKING=2]="TRACKING",o),tw=((s={})[s.DEFAULT=0]="DEFAULT",s[s.ROTATIONAL=1]="ROTATIONAL",s[s.TRANSLATIONAL=2]="TRANSLATIONAL",s[s.CINEMATIC=3]="CINEMATIC",s),tP=((l={})[l.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",l[l.PERSPECTIVE=1]="PERSPECTIVE",l),tM={UPDATED:"updated"},tA=(0,R.default)(function t(){(0,C.default)(this,t),this.clipSpaceNearZ=$.NEGATIVE_ONE,this.eventEmitter=new _.default,this.matrix=G.mat4.create(),this.right=G.vec3.fromValues(1,0,0),this.up=G.vec3.fromValues(0,1,0),this.forward=G.vec3.fromValues(0,0,1),this.position=G.vec3.fromValues(0,0,1),this.focalPoint=G.vec3.fromValues(0,0,0),this.distanceVector=G.vec3.fromValues(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=G.mat4.create(),this.projectionMatrixInverse=G.mat4.create(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=tS.EXPLORING,this.trackingMode=tw.DEFAULT,this.projectionMode=tP.PERSPECTIVE,this.frustum=new ts,this.orthoMatrix=G.mat4.create();},[{key:"isOrtho",value:function(){return this.projectionMode===tP.ORTHOGRAPHIC;}},{key:"getProjectionMode",value:function(){return this.projectionMode;}},{key:"getPerspective",value:function(){return this.jitteredProjectionMatrix||this.projectionMatrix;}},{key:"getPerspectiveInverse",value:function(){return this.projectionMatrixInverse;}},{key:"getFrustum",value:function(){return this.frustum;}},{key:"getPosition",value:function(){return this.position;}},{key:"getFocalPoint",value:function(){return this.focalPoint;}},{key:"getDollyingStep",value:function(){return this.dollyingStep;}},{key:"getNear",value:function(){return this.near;}},{key:"getFar",value:function(){return this.far;}},{key:"getZoom",value:function(){return this.zoom;}},{key:"getOrthoMatrix",value:function(){return this.orthoMatrix;}},{key:"getView",value:function(){return this.view;}},{key:"setEnableUpdate",value:function(t){this.enableUpdate=t;}},{key:"setType",value:function(t,e){return this.type=t,this.type===tS.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===tS.TRACKING&&void 0!==e&&this.setTrackingMode(e),this;}},{key:"setProjectionMode",value:function(t){return this.projectionMode=t,this;}},{key:"setTrackingMode",value:function(t){if(this.type!==tS.TRACKING)throw Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=t,this;}},{key:"setWorldRotation",value:function(t){return this.rotateWorld=t,this._getAngles(),this;}},{key:"getViewTransform",value:function(){return G.mat4.invert(G.mat4.create(),this.matrix);}},{key:"getWorldTransform",value:function(){return this.matrix;}},{key:"jitterProjectionMatrix",value:function(t,e){var n=G.mat4.fromTranslation(G.mat4.create(),[t,e,0]);this.jitteredProjectionMatrix=G.mat4.multiply(G.mat4.create(),n,this.projectionMatrix);}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0;}},{key:"setMatrix",value:function(t){return this.matrix=t,this._update(),this;}},{key:"setProjectionMatrix",value:function(t){this.projectionMatrix=t;}},{key:"setFov",value:function(t){return this.setPerspective(this.near,this.far,t,this.aspect),this;}},{key:"setAspect",value:function(t){return this.setPerspective(this.near,this.far,this.fov,t),this;}},{key:"setNear",value:function(t){return this.projectionMode===tP.PERSPECTIVE?this.setPerspective(t,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,t,this.far),this;}},{key:"setFar",value:function(t){return this.projectionMode===tP.PERSPECTIVE?this.setPerspective(this.near,t,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,t),this;}},{key:"setViewOffset",value:function(t,e,n,r,i,a){return this.aspect=t/e,void 0===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.projectionMode===tP.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this;}},{key:"clearViewOffset",value:function(){return void 0!==this.view&&(this.view.enabled=!1),this.projectionMode===tP.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this;}},{key:"setZoom",value:function(t){return this.zoom=t,this.projectionMode===tP.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===tP.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this;}},{key:"setZoomByViewportPoint",value:function(t,e){var n=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),r=n.x,i=n.y,a=this.roll;this.rotate(0,0,-a),this.setPosition(r,i),this.setFocalPoint(r,i),this.setZoom(t),this.rotate(0,0,a);var o=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),s=o.x,l=o.y,u=G.vec3.fromValues(s-r,l-i,0),c=G.vec3.dot(u,this.right)/G.vec3.length(this.right),h=G.vec3.dot(u,this.up)/G.vec3.length(this.up),d=this.getPosition(),f=(0,D.default)(d,2),v=f[0],p=f[1],g=this.getFocalPoint(),y=(0,D.default)(g,2),m=y[0],k=y[1];return this.setPosition(v-c,p-h),this.setFocalPoint(m-c,k-h),this;}},{key:"setPerspective",value:function(t,e,n,r){this.projectionMode=tP.PERSPECTIVE,this.fov=n,this.near=t,this.far=e,this.aspect=r;var i,a=this.near*Math.tan(.5*this.fov*tv)/this.zoom,o=2*a,s=this.aspect*o,l=-.5*s;if(null!==(i=this.view)&&void 0!==i&&i.enabled){var u=this.view.fullWidth,c=this.view.fullHeight;l+=this.view.offsetX*s/u,a-=this.view.offsetY*o/c,s*=this.view.width/u,o*=this.view.height/c;}return!function(t,e,n,r,i,a,o){var s,l,u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=2*a,h=n-e,d=r-i,f=o-a,v=o*a;u?(s=-o/f,l=-v/f):(s=-(o+a)/f,l=-2*v/f),t[0]=c/h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c/d,t[6]=0,t[7]=0,t[8]=(n+e)/h,t[9]=(r+i)/d,t[10]=s,t[11]=-1,t[12]=0,t[13]=0,t[14]=l,t[15]=0;}(this.projectionMatrix,l,l+s,a-o,a,t,this.far,this.clipSpaceNearZ===$.ZERO),G.mat4.invert(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this;}},{key:"setOrthographic",value:function(t,e,n,r,i,a){this.projectionMode=tP.ORTHOGRAPHIC,this.rright=e,this.left=t,this.top=n,this.bottom=r,this.near=i,this.far=a;var o,s=(this.rright-this.left)/(2*this.zoom),l=(this.top-this.bottom)/(2*this.zoom),u=(this.rright+this.left)/2,c=(this.top+this.bottom)/2,h=u-s,d=u+s,f=c+l,v=c-l;if(null!==(o=this.view)&&void 0!==o&&o.enabled){var p=(this.rright-this.left)/this.view.fullWidth/this.zoom,g=(this.top-this.bottom)/this.view.fullHeight/this.zoom;h+=p*this.view.offsetX,d=h+p*this.view.width,f-=g*this.view.offsetY,v=f-g*this.view.height;}return this.clipSpaceNearZ===$.NEGATIVE_ONE?G.mat4.ortho(this.projectionMatrix,h,d,f,v,i,a):G.mat4.orthoZO(this.projectionMatrix,h,d,f,v,i,a),G.mat4.invert(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this;}},{key:"setPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.position[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.position[2],r=tf(t,e,n);return this._setPosition(r),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this;}},{key:"setFocalPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.focalPoint[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.focalPoint[2],r=G.vec3.fromValues(0,1,0);if(this.focalPoint=tf(t,e,n),this.trackingMode===tw.CINEMATIC){var i=G.vec3.subtract(G.vec3.create(),this.focalPoint,this.position);t=i[0],e=i[1],n=i[2];var a=Math.asin(e/G.vec3.length(i))*tp,o=90+Math.atan2(n,t)*tp,s=G.mat4.create();G.mat4.rotateY(s,s,o*tv),G.mat4.rotateX(s,s,a*tv),r=G.vec3.transformMat4(G.vec3.create(),[0,1,0],s);}return G.mat4.invert(this.matrix,G.mat4.lookAt(G.mat4.create(),this.position,this.focalPoint,r)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this;}},{key:"getDistance",value:function(){return this.distance;}},{key:"getDistanceVector",value:function(){return this.distanceVector;}},{key:"setDistance",value:function(t){if(this.distance===t||t<0)return this;this.distance=t,this.distance<2e-4&&(this.distance=2e-4),this.dollyingStep=this.distance/100;var e=G.vec3.create();t=this.distance;var n=this.forward,r=this.focalPoint;return e[0]=t*n[0]+r[0],e[1]=t*n[1]+r[1],e[2]=t*n[2]+r[2],this._setPosition(e),this.triggerUpdate(),this;}},{key:"setMaxDistance",value:function(t){return this.maxDistance=t,this;}},{key:"setMinDistance",value:function(t){return this.minDistance=t,this;}},{key:"setAzimuth",value:function(t){return this.azimuth=th(t),this.computeMatrix(),this._getAxes(),this.type===tS.ORBITING||this.type===tS.EXPLORING?this._getPosition():this.type===tS.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getAzimuth",value:function(){return this.azimuth;}},{key:"setElevation",value:function(t){return this.elevation=th(t),this.computeMatrix(),this._getAxes(),this.type===tS.ORBITING||this.type===tS.EXPLORING?this._getPosition():this.type===tS.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getElevation",value:function(){return this.elevation;}},{key:"setRoll",value:function(t){return this.roll=th(t),this.computeMatrix(),this._getAxes(),this.type===tS.ORBITING||this.type===tS.EXPLORING?this._getPosition():this.type===tS.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getRoll",value:function(){return this.roll;}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate();}},{key:"computeMatrix",value:function(){var t=G.quat.setAxisAngle(G.quat.create(),[0,0,1],this.roll*tv);G.mat4.identity(this.matrix);var e=G.quat.setAxisAngle(G.quat.create(),[1,0,0],(this.rotateWorld&&this.type!==tS.TRACKING||this.type===tS.TRACKING?1:-1)*this.elevation*tv),n=G.quat.setAxisAngle(G.quat.create(),[0,1,0],(this.rotateWorld&&this.type!==tS.TRACKING||this.type===tS.TRACKING?1:-1)*this.azimuth*tv),r=G.quat.multiply(G.quat.create(),n,e);r=G.quat.multiply(G.quat.create(),r,t);var i=G.mat4.fromQuat(G.mat4.create(),r);this.type===tS.ORBITING||this.type===tS.EXPLORING?(G.mat4.translate(this.matrix,this.matrix,this.focalPoint),G.mat4.multiply(this.matrix,this.matrix,i),G.mat4.translate(this.matrix,this.matrix,[0,0,this.distance])):this.type===tS.TRACKING&&(G.mat4.translate(this.matrix,this.matrix,this.position),G.mat4.multiply(this.matrix,this.matrix,i));}},{key:"_setPosition",value:function(t,e,n){this.position=tf(t,e,n);var r=this.matrix;r[12]=this.position[0],r[13]=this.position[1],r[14]=this.position[2],r[15]=1,this._getOrthoMatrix();}},{key:"_getAxes",value:function(){G.vec3.copy(this.right,tf(G.vec4.transformMat4(G.vec4.create(),[1,0,0,0],this.matrix))),G.vec3.copy(this.up,tf(G.vec4.transformMat4(G.vec4.create(),[0,1,0,0],this.matrix))),G.vec3.copy(this.forward,tf(G.vec4.transformMat4(G.vec4.create(),[0,0,1,0],this.matrix))),G.vec3.normalize(this.right,this.right),G.vec3.normalize(this.up,this.up),G.vec3.normalize(this.forward,this.forward);}},{key:"_getAngles",value:function(){var t=this.distanceVector[0],e=this.distanceVector[1],n=this.distanceVector[2],r=G.vec3.length(this.distanceVector);if(0===r){this.elevation=0,this.azimuth=0;return;}this.type===tS.TRACKING?(this.elevation=Math.asin(e/r)*tp,this.azimuth=Math.atan2(-t,-n)*tp):this.rotateWorld?(this.elevation=Math.asin(e/r)*tp,this.azimuth=Math.atan2(-t,-n)*tp):(this.elevation=-(Math.asin(e/r)*tp),this.azimuth=-(Math.atan2(-t,-n)*tp));}},{key:"_getPosition",value:function(){G.vec3.copy(this.position,tf(G.vec4.transformMat4(G.vec4.create(),[0,0,0,1],this.matrix))),this._getDistance();}},{key:"_getFocalPoint",value:function(){G.vec3.transformMat3(this.distanceVector,[0,0,-this.distance],G.mat3.fromMat4(G.mat3.create(),this.matrix)),G.vec3.add(this.focalPoint,this.position,this.distanceVector),this._getDistance();}},{key:"_getDistance",value:function(){this.distanceVector=G.vec3.subtract(G.vec3.create(),this.focalPoint,this.position),this.distance=G.vec3.length(this.distanceVector),this.dollyingStep=this.distance/100;}},{key:"_getOrthoMatrix",value:function(){if(this.projectionMode===tP.ORTHOGRAPHIC){var t=this.position,e=G.quat.setAxisAngle(G.quat.create(),[0,0,1],-this.roll*Math.PI/180);G.mat4.fromRotationTranslationScaleOrigin(this.orthoMatrix,e,G.vec3.fromValues((this.rright-this.left)/2-t[0],(this.top-this.bottom)/2-t[1],0),G.vec3.fromValues(this.zoom,this.zoom,1),t);}}},{key:"triggerUpdate",value:function(){if(this.enableUpdate){var t=this.getViewTransform(),e=G.mat4.multiply(G.mat4.create(),this.getPerspective(),t);this.getFrustum().extractFromVPMatrix(e),this.eventEmitter.emit(tM.UPDATED);}}},{key:"rotate",value:function(t,e,n){throw Error(tc);}},{key:"pan",value:function(t,e){throw Error(tc);}},{key:"dolly",value:function(t){throw Error(tc);}},{key:"createLandmark",value:function(t,e){throw Error(tc);}},{key:"gotoLandmark",value:function(t,e){throw Error(tc);}},{key:"cancelLandmarkAnimation",value:function(){throw Error(tc);}}]),tC=((u={})[u.Standard=0]="Standard",u),tR=((c={})[c.ADDED=0]="ADDED",c[c.REMOVED=1]="REMOVED",c[c.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED",c),tO=G.vec3.create(),tL=G.mat4.create(),tI=G.quat.create();function tD(t){if(t.localDirtyFlag){if(0!==t.localSkew[0]||0!==t.localSkew[1]){G.mat4.fromRotationTranslationScaleOrigin(t.localTransform,t.localRotation,t.localPosition,G.vec3.fromValues(1,1,1),t.origin),(0!==t.localSkew[0]||0!==t.localSkew[1])&&(G.mat4.identity(tL),tL[4]=Math.tan(t.localSkew[0]),tL[1]=Math.tan(t.localSkew[1]),G.mat4.multiply(t.localTransform,t.localTransform,tL));var e=G.mat4.fromRotationTranslationScaleOrigin(tL,G.quat.set(tI,0,0,0,1),G.vec3.set(tO,1,1,1),t.localScale,t.origin);G.mat4.multiply(t.localTransform,t.localTransform,e);}else{var n=t.localTransform,r=t.localPosition,i=t.localRotation,a=t.localScale,o=t.origin,s=0!==r[0]||0!==r[1]||0!==r[2],l=1!==i[3]||0!==i[0]||0!==i[1]||0!==i[2],u=1!==a[0]||1!==a[1]||1!==a[2],c=0!==o[0]||0!==o[1]||0!==o[2];l||u||c?G.mat4.fromRotationTranslationScaleOrigin(n,i,r,a,o):s?G.mat4.fromTranslation(n,r):G.mat4.identity(n);}t.localDirtyFlag=!1;}}var t_={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new tu(0,0,0,0)},tG=((h={}).COORDINATE="<coordinate>",h.COLOR="<color>",h.PAINT="<paint>",h.NUMBER="<number>",h.ANGLE="<angle>",h.OPACITY_VALUE="<opacity-value>",h.SHADOW_BLUR="<shadow-blur>",h.LENGTH="<length>",h.PERCENTAGE="<percentage>",h.LENGTH_PERCENTAGE="<length> | <percentage>",h.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",h.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",h.LIST_OF_POINTS="<list-of-points>",h.PATH="<path>",h.FILTER="<filter>",h.Z_INDEX="<z-index>",h.OFFSET_DISTANCE="<offset-distance>",h.DEFINED_PATH="<defined-path>",h.MARKER="<marker>",h.TRANSFORM="<transform>",h.TRANSFORM_ORIGIN="<transform-origin>",h.TEXT="<text>",h.TEXT_TRANSFORM="<text-transform>",h);function tF(t,e,n){t.prototype=e.prototype=n,n.constructor=t;}function tB(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n;}function tU(){}var tV="\\s*([+-]?\\d+)\\s*",tz="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",tH="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",tY=/^#([0-9a-f]{3,8})$/,tW=RegExp(`^rgb\\(${tV},${tV},${tV}\\)$`),tq=RegExp(`^rgb\\(${tH},${tH},${tH}\\)$`),tX=RegExp(`^rgba\\(${tV},${tV},${tV},${tz}\\)$`),tj=RegExp(`^rgba\\(${tH},${tH},${tH},${tz}\\)$`),t$=RegExp(`^hsl\\(${tz},${tH},${tH}\\)$`),tK=RegExp(`^hsla\\(${tz},${tH},${tH},${tz}\\)$`),tZ={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function tQ(){return this.rgb().formatHex();}function tJ(){return this.rgb().formatRgb();}function t0(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=tY.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?t1(e):3===n?new t3(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?t2(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?t2(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=tW.exec(t))?new t3(e[1],e[2],e[3],1):(e=tq.exec(t))?new t3(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=tX.exec(t))?t2(e[1],e[2],e[3],e[4]):(e=tj.exec(t))?t2(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=t$.exec(t))?t8(e[1],e[2]/100,e[3]/100,1):(e=tK.exec(t))?t8(e[1],e[2]/100,e[3]/100,e[4]):tZ.hasOwnProperty(t)?t1(tZ[t]):"transparent"===t?new t3(NaN,NaN,NaN,0):null;}function t1(t){return new t3(t>>16&255,t>>8&255,255&t,1);}function t2(t,e,n,r){return r<=0&&(t=e=n=NaN),new t3(t,e,n,r);}function t3(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r;}function t4(){return`#${t9(this.r)}${t9(this.g)}${t9(this.b)}`;}function t5(){let t=t6(this.opacity);return`${1===t?"rgb(":"rgba("}${t7(this.r)}, ${t7(this.g)}, ${t7(this.b)}${1===t?")":`, ${t})`}`;}function t6(t){return isNaN(t)?1:Math.max(0,Math.min(1,t));}function t7(t){return Math.max(0,Math.min(255,Math.round(t)||0));}function t9(t){return((t=t7(t))<16?"0":"")+t.toString(16);}function t8(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new ee(t,e,n,r);}function et(t){if(t instanceof ee)return new ee(t.h,t.s,t.l,t.opacity);if(t instanceof tU||(t=t0(t)),!t)return new ee;if(t instanceof ee)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,l=(a+i)/2;return s?(o=e===a?(n-r)/s+(n<r)*6:n===a?(r-e)/s+2:(e-n)/s+4,s/=l<.5?a+i:2-a-i,o*=60):s=l>0&&l<1?0:o,new ee(o,s,l,t.opacity);}function ee(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r;}function en(t){return(t=(t||0)%360)<0?t+360:t;}function er(t){return Math.max(0,Math.min(1,t||0));}function ei(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255;}function ea(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw TypeError("Expected a function");var n=function(){for(var r=arguments.length,i=Array(r),a=0;a<r;a++)i[a]=arguments[a];var o=e?e.apply(this,i):i[0],s=n.cache;if(s.has(o))return s.get(o);var l=t.apply(this,i);return n.cache=s.set(o,l)||s,l;};return n.cache=new(ea.Cache||Map),ea.cacheList.push(n.cache),n;}tF(tU,t0,{copy(t){return Object.assign(new this.constructor,this,t);},displayable(){return this.rgb().displayable();},hex:tQ,formatHex:tQ,formatHex8:function(){return this.rgb().formatHex8();},formatHsl:function(){return et(this).formatHsl();},formatRgb:tJ,toString:tJ}),tF(t3,function(t,e,n,r){var i;return 1==arguments.length?((i=t)instanceof tU||(i=t0(i)),i)?new t3((i=i.rgb()).r,i.g,i.b,i.opacity):new t3:new t3(t,e,n,null==r?1:r);},tB(tU,{brighter(t){return t=null==t?1.4285714285714286:Math.pow(1.4285714285714286,t),new t3(this.r*t,this.g*t,this.b*t,this.opacity);},darker(t){return t=null==t?.7:Math.pow(.7,t),new t3(this.r*t,this.g*t,this.b*t,this.opacity);},rgb(){return this;},clamp(){return new t3(t7(this.r),t7(this.g),t7(this.b),t6(this.opacity));},displayable(){return -.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1;},hex:t4,formatHex:t4,formatHex8:function(){return`#${t9(this.r)}${t9(this.g)}${t9(this.b)}${t9((isNaN(this.opacity)?1:this.opacity)*255)}`;},formatRgb:t5,toString:t5})),tF(ee,function(t,e,n,r){return 1==arguments.length?et(t):new ee(t,e,n,null==r?1:r);},tB(tU,{brighter(t){return t=null==t?1.4285714285714286:Math.pow(1.4285714285714286,t),new ee(this.h,this.s,this.l*t,this.opacity);},darker(t){return t=null==t?.7:Math.pow(.7,t),new ee(this.h,this.s,this.l*t,this.opacity);},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new t3(ei(t>=240?t-240:t+120,i,r),ei(t,i,r),ei(t<120?t+240:t-120,i,r),this.opacity);},clamp(){return new ee(en(this.h),er(this.s),er(this.l),t6(this.opacity));},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1;},formatHsl(){let t=t6(this.opacity);return`${1===t?"hsl(":"hsla("}${en(this.h)}, ${100*er(this.s)}%, ${100*er(this.l)}%${1===t?")":`, ${t})`}`;}})),ea.Cache=Map,ea.cacheList=[],ea.clearCache=function(){ea.cacheList.forEach(function(t){return t.clear();});};var eo=((d={})[d.kUnknown=0]="kUnknown",d[d.kNumber=1]="kNumber",d[d.kPercentage=2]="kPercentage",d[d.kEms=3]="kEms",d[d.kPixels=4]="kPixels",d[d.kRems=5]="kRems",d[d.kDegrees=6]="kDegrees",d[d.kRadians=7]="kRadians",d[d.kGradians=8]="kGradians",d[d.kTurns=9]="kTurns",d[d.kMilliseconds=10]="kMilliseconds",d[d.kSeconds=11]="kSeconds",d[d.kInteger=12]="kInteger",d),es=((f={})[f.kUNumber=0]="kUNumber",f[f.kUPercent=1]="kUPercent",f[f.kULength=2]="kULength",f[f.kUAngle=3]="kUAngle",f[f.kUTime=4]="kUTime",f[f.kUOther=5]="kUOther",f),el=((v={})[v.kYes=0]="kYes",v[v.kNo=1]="kNo",v),eu=((p={})[p.kYes=0]="kYes",p[p.kNo=1]="kNo",p),ec=[{name:"em",unit_type:eo.kEms},{name:"px",unit_type:eo.kPixels},{name:"deg",unit_type:eo.kDegrees},{name:"rad",unit_type:eo.kRadians},{name:"grad",unit_type:eo.kGradians},{name:"ms",unit_type:eo.kMilliseconds},{name:"s",unit_type:eo.kSeconds},{name:"rem",unit_type:eo.kRems},{name:"turn",unit_type:eo.kTurns}],eh=((g={})[g.kUnknownType=0]="kUnknownType",g[g.kUnparsedType=1]="kUnparsedType",g[g.kKeywordType=2]="kKeywordType",g[g.kUnitType=3]="kUnitType",g[g.kSumType=4]="kSumType",g[g.kProductType=5]="kProductType",g[g.kNegateType=6]="kNegateType",g[g.kInvertType=7]="kInvertType",g[g.kMinType=8]="kMinType",g[g.kMaxType=9]="kMaxType",g[g.kClampType=10]="kClampType",g[g.kTransformType=11]="kTransformType",g[g.kPositionType=12]="kPositionType",g[g.kURLImageType=13]="kURLImageType",g[g.kColorType=14]="kColorType",g[g.kUnsupportedColorType=15]="kUnsupportedColorType",g),ed=function(t){switch(t){case eo.kNumber:case eo.kInteger:return es.kUNumber;case eo.kPercentage:return es.kUPercent;case eo.kPixels:return es.kULength;case eo.kMilliseconds:case eo.kSeconds:return es.kUTime;case eo.kDegrees:case eo.kRadians:case eo.kGradians:case eo.kTurns:return es.kUAngle;default:return es.kUOther;}},ef=function(t){switch(t){case es.kUNumber:return eo.kNumber;case es.kULength:return eo.kPixels;case es.kUPercent:return eo.kPercentage;case es.kUTime:return eo.kSeconds;case es.kUAngle:return eo.kDegrees;default:return eo.kUnknown;}},ev=function(t){var e=1;switch(t){case eo.kPixels:case eo.kDegrees:case eo.kSeconds:break;case eo.kMilliseconds:e=.001;break;case eo.kRadians:e=180/Math.PI;break;case eo.kGradians:e=.9;break;case eo.kTurns:e=360;}return e;},ep=function(t){switch(t){case eo.kNumber:case eo.kInteger:break;case eo.kPercentage:return"%";case eo.kEms:return"em";case eo.kRems:return"rem";case eo.kPixels:return"px";case eo.kDegrees:return"deg";case eo.kRadians:return"rad";case eo.kGradians:return"grad";case eo.kMilliseconds:return"ms";case eo.kSeconds:return"s";case eo.kTurns:return"turn";}return"";},eg=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"toString",value:function(){return this.buildCSSText(el.kNo,eu.kNo,"");}},{key:"isNumericValue",value:function(){return this.getType()>=eh.kUnitType&&this.getType()<=eh.kClampType;}}],[{key:"isAngle",value:function(t){return t===eo.kDegrees||t===eo.kRadians||t===eo.kGradians||t===eo.kTurns;}},{key:"isLength",value:function(t){return t>=eo.kEms&&t<eo.kDegrees;}},{key:"isRelativeUnit",value:function(t){return t===eo.kPercentage||t===eo.kEms||t===eo.kRems;}},{key:"isTime",value:function(t){return t===eo.kSeconds||t===eo.kMilliseconds;}}]),ey=function(t){function e(t){var n;return(0,C.default)(this,e),(n=(0,L.default)(this,e)).colorSpace=t,n;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getType",value:function(){return eh.kColorType;}},{key:"to",value:function(t){return this;}}]);}(eg),em=((y={})[y.Constant=0]="Constant",y[y.LinearGradient=1]="LinearGradient",y[y.RadialGradient=2]="RadialGradient",y),ek=function(t){function e(t,n){var r;return(0,C.default)(this,e),(r=(0,L.default)(this,e)).type=t,r.value=n,r;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return new e(this.type,this.value);}},{key:"buildCSSText",value:function(t,e,n){return n;}},{key:"getType",value:function(){return eh.kColorType;}}]);}(eg),eE=function(t){function e(t){var n;return(0,C.default)(this,e),(n=(0,L.default)(this,e)).value=t,n;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return new e(this.value);}},{key:"getType",value:function(){return eh.kKeywordType;}},{key:"buildCSSText",value:function(t,e,n){return n+this.value;}}]);}(eg),ex=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(Number.isFinite(t)?"NaN":t>0?"infinity":"-infinity")+e;},eT=function(t){return ef(ed(t));},eN=function(t){function e(t){var n,r,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:eo.kNumber;return(0,C.default)(this,e),r=(0,L.default)(this,e),i="string"==typeof a?(n=a)?"number"===n?eo.kNumber:"percent"===n||"%"===n?eo.kPercentage:ec.find(function(t){return t.name===n;}).unit_type:eo.kUnknown:a,r.unit=i,r.value=t,r;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return new e(this.value,this.unit);}},{key:"equals",value:function(t){return this.value===t.value&&this.unit===t.unit;}},{key:"getType",value:function(){return eh.kUnitType;}},{key:"convertTo",value:function(t){if(this.unit===t)return new e(this.value,this.unit);var n=eT(this.unit);if(n!==eT(t)||n===eo.kUnknown)return null;var r=ev(this.unit)/ev(t);return new e(this.value*r,t);}},{key:"buildCSSText",value:function(t,e,n){var r;switch(this.unit){case eo.kUnknown:break;case eo.kInteger:r=Number(this.value).toFixed(0);break;case eo.kNumber:case eo.kPercentage:case eo.kEms:case eo.kRems:case eo.kPixels:case eo.kDegrees:case eo.kRadians:case eo.kGradians:case eo.kMilliseconds:case eo.kSeconds:case eo.kTurns:var i=this.value,a=ep(this.unit);if(i<-999999||i>999999){var o=ep(this.unit);r=!Number.isFinite(i)||Number.isNaN(i)?ex(i,o):i+(o||"");}else r="".concat(i).concat(a);}return n+r;}}]);}(eg),eb=new eN(0,"px");new eN(1,"px");var eS=new eN(0,"deg"),ew=function(t){function e(t,n,r){var i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return(0,C.default)(this,e),(i=(0,L.default)(this,e,["rgb"])).r=t,i.g=n,i.b=r,i.alpha=a,i.isNone=o,i;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return new e(this.r,this.g,this.b,this.alpha);}},{key:"buildCSSText",value:function(t,e,n){return"".concat(n,"rgba(").concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")");}}]);}(ey),eP=new eE("unset"),eM={"":eP,unset:eP,initial:new eE("initial"),inherit:new eE("inherit")},eA=new ew(0,0,0,0,!0),eC=new ew(0,0,0,0),eR=ea(function(t,e,n,r){return new ew(t,e,n,r);},function(t,e,n,r){return"rgba(".concat(t,",").concat(e,",").concat(n,",").concat(r,")");}),eO=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:eo.kNumber;return new eN(t,e);};new eN(50,"%");var eL=function(){var t={linearGradient:/^(linear\-gradient)/i,repeatingLinearGradient:/^(repeating\-linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,repeatingRadialGradient:/^(repeating\-radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},e="";function n(t){throw Error("".concat(e,": ").concat(t));}function r(){return i("linear-gradient",t.linearGradient,o)||i("repeating-linear-gradient",t.repeatingLinearGradient,o)||i("radial-gradient",t.radialGradient,s)||i("repeating-radial-gradient",t.repeatingRadialGradient,s)||i("conic-gradient",t.conicGradient,s);}function i(e,r,i){return a(r,function(r){var a=i();return a&&!m(t.comma)&&n("Missing comma before color stops"),{type:e,orientation:a,colorStops:d(f)};});}function a(e,r){var i=m(e);if(i){m(t.startCall)||n("Missing (");var a=r(i);return m(t.endCall)||n("Missing )"),a;}}function o(){return y("directional",t.sideOrCorner,1)||y("angular",t.angleValue,1);}function s(){var n,r,i=l();return i&&((n=[]).push(i),r=e,m(t.comma)&&((i=l())?n.push(i):e=r)),n;}function l(){var t,e,n=((t=y("shape",/^(circle)/i,0))&&(t.style=g()||u()),t||((e=y("shape",/^(ellipse)/i,0))&&(e.style=p()||u()),e));if(n)n.at=c();else{var r=u();if(r){n=r;var i=c();i&&(n.at=i);}else{var a=h();a&&(n={type:"default-radial",at:a});}}return n;}function u(){return y("extent-keyword",t.extentKeywords,1);}function c(){if(y("position",/^at/,0)){var t=h();return t||n("Missing positioning value"),t;}}function h(){var t={x:p(),y:p()};if(t.x||t.y)return{type:"position",value:t};}function d(e){var r=e(),i=[];if(r)for(i.push(r);m(t.comma);)(r=e())?i.push(r):n("One extra comma");return i;}function f(){var e=y("hex",t.hexColor,1)||a(t.rgbaColor,function(){return{type:"rgba",value:d(v)};})||a(t.rgbColor,function(){return{type:"rgb",value:d(v)};})||y("literal",t.literalColor,0);return e||n("Expected color definition"),e.length=p(),e;}function v(){return m(t.number)[1];}function p(){return y("%",t.percentageValue,1)||y("position-keyword",t.positionKeywords,1)||g();}function g(){return y("px",t.pixelValue,1)||y("em",t.emValue,1);}function y(t,e,n){var r=m(e);if(r)return{type:t,value:r[n]};}function m(t){var n=/^[\n\r\t\s]+/.exec(e);n&&k(n[0].length);var r=t.exec(e);return r&&k(r[0].length),r;}function k(t){e=e.substring(t);}return function(t){var i;return e=t,i=d(r),e.length>0&&n("Invalid input not EOF"),i;};}(),eI=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,eD=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,e_=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,eG=/[\d.]+:(#[^\s]+|[^\)]+\))/gi,eF={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},eB=ea(function(t){return eO("angular"===t.type?Number(t.value):eF[t.value]||0,"deg");}),eU=ea(function(t){var e=50,n=50,r="%",i="%";if((null==t?void 0:t.type)==="position"){var a=t.value,o=a.x,s=a.y;(null==o?void 0:o.type)==="position-keyword"&&("left"===o.value?e=0:"center"===o.value?e=50:"right"===o.value?e=100:"top"===o.value?n=0:"bottom"===o.value&&(n=100)),(null==s?void 0:s.type)==="position-keyword"&&("left"===s.value?e=0:"center"===s.value?n=50:"right"===s.value?e=100:"top"===s.value?n=0:"bottom"===s.value&&(n=100)),((null==o?void 0:o.type)==="px"||(null==o?void 0:o.type)==="%"||(null==o?void 0:o.type)==="em")&&(r=null==o?void 0:o.type,e=Number(o.value)),((null==s?void 0:s.type)==="px"||(null==s?void 0:s.type)==="%"||(null==s?void 0:s.type)==="em")&&(i=null==s?void 0:s.type,n=Number(s.value));}return{cx:eO(e,r),cy:eO(n,i)};}),eV=ea(function(t){if(t.indexOf("linear")>-1||t.indexOf("radial")>-1)return eL(t).map(function(t){var e=t.type,n=t.orientation,r=t.colorStops;!function(t){var e=t.length;t[e-1].length=null!==(a=t[e-1].length)&&void 0!==a?a:{type:"%",value:"100"},e>1&&(t[0].length=null!==(o=t[0].length)&&void 0!==o?o:{type:"%",value:"0"});for(var n=0,r=Number(t[0].length.value),i=1;i<e;i++){var a,o,s,l=null===(s=t[i].length)||void 0===s?void 0:s.value;if(!(0,F.isNil)(l)&&!(0,F.isNil)(r)){for(var u=1;u<i-n;u++)t[n+u].length={type:"%",value:"".concat(r+(Number(l)-r)*u/(i-n))};n=i,r=Number(l);}}}(r);var i=r.map(function(t){var e,n;return{offset:eO(Number(t.length.value),"%"),color:(e=t.type,n=t.value,"hex"===e?"#".concat(n):"literal"===e?n:"rgb"===e?"rgb(".concat(n.join(","),")"):"rgba(".concat(n.join(","),")"))};});if("linear-gradient"===e)return new ek(em.LinearGradient,{angle:n?eB(n):eS,steps:i});if("radial-gradient"===e&&(n||(n=[{type:"shape",value:"circle"}]),"shape"===n[0].type&&"circle"===n[0].value)){var a,o=eU(n[0].at),s=o.cx,l=o.cy;if(n[0].style){var u=n[0].style,c=u.type,h=u.value;"extent-keyword"===c?(eM[h]||(eM[h]=new eE(h)),a=eM[h]):a=eO(h,c);}return new ek(em.RadialGradient,{cx:s,cy:l,size:a,steps:i});}});var e=t[0];if("("===t[1]||"("===t[2]){if("l"===e){var n=eI.exec(t);if(n){var r,i=(null===(r=n[2].match(eG))||void 0===r?void 0:r.map(function(t){return t.split(":");}))||[];return[new ek(em.LinearGradient,{angle:eO(parseFloat(n[1]),"deg"),steps:i.map(function(t){var e=(0,D.default)(t,2),n=e[0],r=e[1];return{offset:eO(100*Number(n),"%"),color:r};})})];}}else if("r"===e){var a=function(t){var e=eD.exec(t);if(e){var n,r=(null===(n=e[4].match(eG))||void 0===n?void 0:n.map(function(t){return t.split(":");}))||[];return{cx:eO(50,"%"),cy:eO(50,"%"),steps:r.map(function(t){var e=(0,D.default)(t,2),n=e[0],r=e[1];return{offset:eO(100*Number(n),"%"),color:r};})};}return null;}(t);if(a){if(!(0,F.isString)(a))return[new ek(em.RadialGradient,a)];t=a;}}else if("p"===e)return function(t){var e=e_.exec(t);if(e){var n=e[1],r=e[2];switch(n){case"a":n="repeat";break;case"x":n="repeat-x";break;case"y":n="repeat-y";break;default:n="no-repeat";}return{image:r,repetition:n};}return null;}(t);}});function ez(t){return t&&!(0,F.isNil)(t.r)&&!(0,F.isNil)(t.g)&&!(0,F.isNil)(t.b);}var eH=ea(function(t){if((e=t)&&e.image)return(0,A.default)({repetition:"repeat"},t);if((0,F.isNil)(t)&&(t=""),"transparent"===t)return eC;if("currentColor"===t)t="black";else if("none"===t)return eA;var e,n=eV(t);if(n)return n;var r=t0(t),i=[0,0,0,0];return null!==r&&(i[0]=r.r||0,i[1]=r.g||0,i[2]=r.b||0,i[3]=r.opacity),eR.apply(void 0,i);});function eY(t,e){if(ez(t)&&ez(e))return[[Number(t.r),Number(t.g),Number(t.b),Number(t.alpha)],[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],function(t){var e=t.slice();if(e[3])for(var n=0;n<3;n++)e[n]=Math.round((0,F.clamp)(e[n],0,255));return e[3]=(0,F.clamp)(e[3],0,1),"rgba(".concat(e.join(","),")");}];}function eW(t,e){if((0,F.isNil)(e))return eO(0,"px");if(isFinite(Number(e="".concat(e).trim().toLowerCase()))){if("px".search(t)>=0)return eO(Number(e),"px");if("deg".search(t)>=0)return eO(Number(e),"deg");}var n=[];e=e.replace(t,function(t){return n.push(t),"U".concat(t);});var r="U(".concat(t.source,")");return n.map(function(t){return eO(Number(e.replace(RegExp("U".concat(t),"g"),"").replace(RegExp(r,"g"),"*0")),t);})[0];}var eq=function(t){return eW(/px/g,t);},eX=ea(eq);ea(function(t){return eW(RegExp("%","g"),t);});var ej=function(t){return(0,F.isNumber)(t)||isFinite(Number(t))?eO(Number(t)||0,"px"):eW(RegExp("px|%|em|rem","g"),t);},e$=ea(ej),eK=function(t){return eW(RegExp("deg|rad|grad|turn","g"),t);},eZ=ea(eK);function eQ(t){var e=0;return t.unit===eo.kDegrees?e=t.value:t.unit===eo.kRadians?e=Number(t.value)*tp:t.unit===eo.kTurns?e=360*Number(t.value):t.value&&(e=t.value),e;}function eJ(t,e){var n;return(Array.isArray(t)?n=t.map(function(t){return Number(t);}):(0,F.isString)(t)?n=t.split(" ").map(function(t){return Number(t);}):(0,F.isNumber)(t)&&(n=[t]),2===e)?1===n.length?[n[0],n[0]]:[n[0],n[1]]:4===e?1===n.length?[n[0],n[0],n[0],n[0]]:2===n.length?[n[0],n[1],n[0],n[1]]:3===n.length?[n[0],n[1],n[2],n[1]]:[n[0],n[1],n[2],n[3]]:"even"===e&&n.length%2==1?[].concat((0,O.default)(n),(0,O.default)(n)):n;}function e0(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t.unit===eo.kPixels)return Number(t.value);if(t.unit===eo.kPercentage&&n){var i=n.nodeName===j.GROUP?n.getLocalBounds():n.getGeometryBounds();return(r?i.min[e]:0)+t.value/100*i.halfExtents[e]*2;}return 0;}var e1=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function e2(t){return t.toString();}var e3=function(t){return"number"==typeof t?eO(t):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(t)?eO(Number(t)):eO(0);},e4=ea(e3);function e5(t,e){return[t,e,e2];}function e6(t,e){return function(n,r){return[n,r,function(n){return e2((0,F.clamp)(n,t,e));}];};}function e7(t,e){if(t.length===e.length)return[t,e,function(t){return t;}];}function e9(t){return 0===t.parsedStyle.d.totalLength&&(t.parsedStyle.d.totalLength=(0,F.getTotalLength)(t.parsedStyle.d.absolutePath)),t.parsedStyle.d.totalLength;}function e8(t,e){return t[0]===e[0]&&t[1]===e[1];}function nt(t,e){var n=t.prePoint,r=t.currentPoint,i=t.nextPoint,a=Math.pow(r[0]-n[0],2)+Math.pow(r[1]-n[1],2),o=Math.pow(r[0]-i[0],2)+Math.pow(r[1]-i[1],2),s=Math.acos((a+o-(Math.pow(n[0]-i[0],2)+Math.pow(n[1]-i[1],2)))/(2*Math.sqrt(a)*Math.sqrt(o)));if(!s||0===Math.sin(s)||(0,F.isNumberEqual)(s,0))return{xExtra:0,yExtra:0};var l=Math.abs(Math.atan2(i[1]-r[1],i[0]-r[0])),u=Math.abs(Math.atan2(i[0]-r[0],i[1]-r[1]));return{xExtra:e/2*(1/Math.sin(s/2))*Math.cos(s/2-(l=l>Math.PI/2?Math.PI-l:l))-e/2||0,yExtra:e/2*(1/Math.sin(s/2))*Math.cos((u=u>Math.PI/2?Math.PI-u:u)-s/2)-e/2||0};}function ne(t,e){return[e[0]+(e[0]-t[0]),e[1]+(e[1]-t[1])];}ea(function(t){return(0,F.isString)(t)?t.split(" ").map(e4):t.map(e4);});var nn=function(t,e){var n=t.x*e.x+t.y*e.y,r=Math.sqrt((Math.pow(t.x,2)+Math.pow(t.y,2))*(Math.pow(e.x,2)+Math.pow(e.y,2)));return(t.x*e.y-t.y*e.x<0?-1:1)*Math.acos(n/r);},nr=function(t,e,n,r,i,a,o,s){e=Math.abs(e),n=Math.abs(n);var l=(r=(0,F.mod)(r,360))*tv;if(t.x===o.x&&t.y===o.y)return{x:t.x,y:t.y,ellipticalArcAngle:0};if(0===e||0===n)return{x:0,y:0,ellipticalArcAngle:0};var u=(t.x-o.x)/2,c=(t.y-o.y)/2,h={x:Math.cos(l)*u+Math.sin(l)*c,y:-Math.sin(l)*u+Math.cos(l)*c},d=Math.pow(h.x,2)/Math.pow(e,2)+Math.pow(h.y,2)/Math.pow(n,2);d>1&&(e*=Math.sqrt(d),n*=Math.sqrt(d));var f=(Math.pow(e,2)*Math.pow(n,2)-Math.pow(e,2)*Math.pow(h.y,2)-Math.pow(n,2)*Math.pow(h.x,2))/(Math.pow(e,2)*Math.pow(h.y,2)+Math.pow(n,2)*Math.pow(h.x,2)),v=(i!==a?1:-1)*Math.sqrt(f=f<0?0:f),p={x:v*(e*h.y/n),y:v*(-(n*h.x)/e)},g={x:Math.cos(l)*p.x-Math.sin(l)*p.y+(t.x+o.x)/2,y:Math.sin(l)*p.x+Math.cos(l)*p.y+(t.y+o.y)/2},y={x:(h.x-p.x)/e,y:(h.y-p.y)/n},m=nn({x:1,y:0},y),k=nn(y,{x:(-h.x-p.x)/e,y:(-h.y-p.y)/n});!a&&k>0?k-=2*Math.PI:a&&k<0&&(k+=2*Math.PI);var E=m+(k%=2*Math.PI)*s,x=e*Math.cos(E),T=n*Math.sin(E);return{x:Math.cos(l)*x-Math.sin(l)*T+g.x,y:Math.sin(l)*x+Math.cos(l)*T+g.y,ellipticalArcStartAngle:m,ellipticalArcEndAngle:m+k,ellipticalArcAngle:E,ellipticalArcCenter:g,resultantRx:e,resultantRy:n};};function ni(t,e){var n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=t.arcParams,i=r.rx,a=void 0===i?0:i,o=r.ry,s=void 0===o?0:o,l=r.xRotation,u=r.arcFlag,c=r.sweepFlag,h=nr({x:t.prePoint[0],y:t.prePoint[1]},a,s,l,!!u,!!c,{x:t.currentPoint[0],y:t.currentPoint[1]},e),d=nr({x:t.prePoint[0],y:t.prePoint[1]},a,s,l,!!u,!!c,{x:t.currentPoint[0],y:t.currentPoint[1]},n?e+.005:e-.005),f=d.x-h.x,v=d.y-h.y,p=Math.sqrt(f*f+v*v);return{x:-f/p,y:-v/p};}function na(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1]);}function no(t,e){return na(t)*na(e)?(t[0]*e[0]+t[1]*e[1])/(na(t)*na(e)):1;}function ns(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(no(t,e));}var nl=function(t){if(""===t||Array.isArray(t)&&0===t.length)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};try{e=(0,F.normalizePath)(t);}catch(n){e=(0,F.normalizePath)(""),console.error("[g]: Invalid SVG Path definition: ".concat(t));}!function(t){for(var e=0;e<t.length;e++){var n=t[e-1],r=t[e];if("M"===r[0]&&n){var i=n[0],a=[r[1],r[2]],o=void 0;"L"===i||"M"===i?o=[n[1],n[2]]:("C"===i||"A"===i||"Q"===i)&&(o=[n[n.length-2],n[n.length-1]]),o&&e8(a,o)&&(t.splice(e,1),e--);}}}(e);var e,n=function(t){for(var e=!1,n=t.length,r=0;r<n;r++){var i=t[r][0];if("C"===i||"A"===i||"Q"===i){e=!0;break;}}return e;}(e),r=function(t){for(var e=[],n=[],r=[],i=0;i<t.length;i++){var a=t[i],o=a[0];"M"===o?(r.length&&(n.push(r),r=[]),r.push([a[1],a[2]])):"Z"===o?r.length&&(e.push(r),r=[]):r.push([a[1],a[2]]);}return r.length>0&&n.push(r),{polygons:e,polylines:n};}(e),i=r.polygons,a=r.polylines,o=function(t){for(var e=[],n=null,r=null,i=null,a=0,o=t.length,s=0;s<o;s++){var l=t[s];r=t[s+1];var u=l[0],c={command:u,prePoint:n,params:l,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(u){case"M":i=[l[1],l[2]],a=s;break;case"A":var h=function(t,e){var n=e[1],r=e[2],i=(0,F.mod)(e[3]*tv,2*Math.PI),a=e[4],o=e[5],s=t[0],l=t[1],u=e[6],c=e[7],h=Math.cos(i)*(s-u)/2+Math.sin(i)*(l-c)/2,d=-1*Math.sin(i)*(s-u)/2+Math.cos(i)*(l-c)/2,f=h*h/(n*n)+d*d/(r*r);f>1&&(n*=Math.sqrt(f),r*=Math.sqrt(f));var v=n*n*(d*d)+r*r*(h*h),p=v?Math.sqrt((n*n*(r*r)-v)/v):1;a===o&&(p*=-1),isNaN(p)&&(p=0);var g=r?p*n*d/r:0,y=n?-(p*r)*h/n:0,m=(s+u)/2+Math.cos(i)*g-Math.sin(i)*y,k=(l+c)/2+Math.sin(i)*g+Math.cos(i)*y,E=[(h-g)/n,(d-y)/r],x=[(-1*h-g)/n,(-1*d-y)/r],T=ns([1,0],E),N=ns(E,x);return -1>=no(E,x)&&(N=Math.PI),no(E,x)>=1&&(N=0),0===o&&N>0&&(N-=2*Math.PI),1===o&&N<0&&(N+=2*Math.PI),{cx:m,cy:k,rx:e8(t,[u,c])?0:n,ry:e8(t,[u,c])?0:r,startAngle:T,endAngle:T+N,xRotation:i,arcFlag:a,sweepFlag:o};}(n,l);c.arcParams=h;}if("Z"===u)n=i,r=t[a+1];else{var d=l.length;n=[l[d-2],l[d-1]];}r&&"Z"===r[0]&&(r=t[a],e[a]&&(e[a].prePoint=n)),c.currentPoint=n,e[a]&&e8(n,e[a].currentPoint)&&(e[a].prePoint=c.prePoint);var f=r?[r[r.length-2],r[r.length-1]]:null;c.nextPoint=f;var v=c.prePoint;if(["L","H","V"].includes(u))c.startTangent=[v[0]-n[0],v[1]-n[1]],c.endTangent=[n[0]-v[0],n[1]-v[1]];else if("Q"===u){var p=[l[1],l[2]];c.startTangent=[v[0]-p[0],v[1]-p[1]],c.endTangent=[n[0]-p[0],n[1]-p[1]];}else if("T"===u){var g=e[s-1],y=ne(g.currentPoint,v);"Q"===g.command?(c.command="Q",c.startTangent=[v[0]-y[0],v[1]-y[1]],c.endTangent=[n[0]-y[0],n[1]-y[1]]):(c.command="TL",c.startTangent=[v[0]-n[0],v[1]-n[1]],c.endTangent=[n[0]-v[0],n[1]-v[1]]);}else if("C"===u){var m=[l[1],l[2]],k=[l[3],l[4]];c.startTangent=[v[0]-m[0],v[1]-m[1]],c.endTangent=[n[0]-k[0],n[1]-k[1]],0===c.startTangent[0]&&0===c.startTangent[1]&&(c.startTangent=[m[0]-k[0],m[1]-k[1]]),0===c.endTangent[0]&&0===c.endTangent[1]&&(c.endTangent=[k[0]-m[0],k[1]-m[1]]);}else if("S"===u){var E=e[s-1],x=ne(E.currentPoint,v),T=[l[1],l[2]];"C"===E.command?(c.command="C",c.startTangent=[v[0]-x[0],v[1]-x[1]]):(c.command="SQ",c.startTangent=[v[0]-T[0],v[1]-T[1]]),c.endTangent=[n[0]-T[0],n[1]-T[1]];}else if("A"===u){var N=ni(c,0),b=N.x,S=N.y,w=ni(c,1,!1),P=w.x,M=w.y;c.startTangent=[b,S],c.endTangent=[P,M];}e.push(c);}return e;}(e),s=function(t,e){for(var n=[],r=[],i=[],a=0;a<t.length;a++){var o=t[a],s=o.currentPoint,l=o.params,u=o.prePoint,c=void 0;switch(o.command){case"Q":c=(0,z.quadBox)(u[0],u[1],l[1],l[2],l[3],l[4]);break;case"C":c=(0,z.cubicBox)(u[0],u[1],l[1],l[2],l[3],l[4],l[5],l[6]);break;case"A":var h=o.arcParams;c=(0,z.arcBox)(h.cx,h.cy,h.rx,h.ry,h.xRotation,h.startAngle,h.endAngle);break;default:n.push(s[0]),r.push(s[1]);}c&&(o.box=c,n.push(c.x,c.x+c.width),r.push(c.y,c.y+c.height));}n=n.filter(function(t){return!Number.isNaN(t)&&t!==1/0&&t!==-1/0;}),r=r.filter(function(t){return!Number.isNaN(t)&&t!==1/0&&t!==-1/0;});var d=(0,F.min)(n),f=(0,F.min)(r),v=(0,F.max)(n),p=(0,F.max)(r);if(0===i.length)return{x:d,y:f,width:v-d,height:p-f};for(var g=0;g<i.length;g++){var y=i[g],m=y.currentPoint;m[0]===d?d-=nt(y,0).xExtra:m[0]===v&&(v+=nt(y,0).xExtra),m[1]===f?f-=nt(y,e).yExtra:m[1]===p&&(p+=nt(y,e).yExtra);}return{x:d,y:f,width:v-d,height:p-f};}(o,0),l=s.x,u=s.y,c=s.width,h=s.height;return{absolutePath:e,hasArc:n,segments:o,polygons:i,polylines:a,totalLength:0,rect:{x:Number.isFinite(l)?l:0,y:Number.isFinite(u)?u:0,width:Number.isFinite(c)?c:0,height:Number.isFinite(h)?h:0}};},nu=ea(nl);function nc(t){return(0,F.isString)(t)?nu(t):nl(t);}function nh(t,e,n){var r=t.curve,i=e.curve;r&&0!==r.length||(r=(0,F.path2Curve)(t.absolutePath,!1),t.curve=r),i&&0!==i.length||(i=(0,F.path2Curve)(e.absolutePath,!1),e.curve=i);var a=[r,i];r.length!==i.length&&(a=(0,F.equalizeSegments)(r,i));var o=(0,F.getDrawDirection)(a[0])!==(0,F.getDrawDirection)(a[1])?(0,F.reverseCurve)(a[0]):(0,F.clonePath)(a[0]);return[o,(0,F.getRotatedCurve)(a[1],o),function(t){return t;}];}function nd(t,e){return[t.points,e.points,function(t){return t;}];}var nf=/\s*(\w+)\(([^)]*)\)/g;function nv(t){return function(e){var n=0;return t.map(function(t){return null===t?e[n++]:t;});};}function np(t){return t;}var ng={matrix:["NNNNNN",[null,null,0,0,null,null,0,0,0,0,1,0,null,null,0,1],np],matrix3d:["NNNNNNNNNNNNNNNN",np],rotate:["A"],rotateX:["A"],rotateY:["A"],rotateZ:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",nv([null,null,new eN(1)]),np],scaleX:["N",nv([null,new eN(1),new eN(1)]),nv([null,new eN(1)])],scaleY:["N",nv([new eN(1),null,new eN(1)]),nv([new eN(1),null])],scaleZ:["N",nv([new eN(1),new eN(1),null])],scale3d:["NNN",np],skew:["Aa",null,np],skewX:["A",null,nv([null,eS])],skewY:["A",null,nv([eS,null])],translate:["Tt",nv([null,null,eb]),np],translateX:["T",nv([null,eb,eb]),nv([null,eb])],translateY:["T",nv([eb,null,eb]),nv([eb,null])],translateZ:["L",nv([eb,eb,null])],translate3d:["TTL",np]};function ny(t){for(var e=[],n=t.length,r=0;r<n;r++){var i=t[r],a=i[0],o=i.slice(1);if("translate"===a||"skew"===a?1===o.length&&o.push(0):"scale"===a&&1===o.length&&o.push(o[0]),!ng[a])return[];var s=o.map(function(t){return eO(t);});e.push({t:a,d:s});}return e;}function nm(t){if(Array.isArray(t))return ny(t);if("none"===(t=(t||"none").trim()))return[];var e,n=[],r=0;for(nf.lastIndex=0;(e=nf.exec(t))&&e.index===r;){r=e.index+e[0].length;var i=e[1],a=ng[i];if(!a)break;var o=e[2].split(","),s=a[0];if(s.length<o.length)break;for(var l=[],u=0;u<s.length;u++){var c=o[u],h=s[u],d=void 0;if(void 0===(d=c?({A:function(t){return"0"===t.trim()?eS:eK(t);},N:e3,T:ej,L:eq})[h.toUpperCase()](c):({a:eS,n:l[0],t:eb})[h]))return[];l.push(d);}if(n.push({t:i,d:l}),nf.lastIndex===t.length)return n;}return[];}function nk(t){switch(t.t){case"rotateX":return[1,0,0,0,0,Math.cos(i=eQ(t.d[0])*tv),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1];case"rotateY":return[Math.cos(i=eQ(t.d[0])*tv),0,-Math.sin(i),0,0,1,0,0,Math.sin(i),0,Math.cos(i),0,0,0,0,1];case"rotate":case"rotateZ":return[Math.cos(i=eQ(t.d[0])*tv),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1,0,0,0,0,1];case"rotate3d":e=t.d[0].value,n=t.d[1].value,r=t.d[2].value,i=eQ(t.d[3])*tv;var e,n,r,i,a=e*e+n*n+r*r;if(0===a)e=1,n=0,r=0;else if(1!==a){var o=Math.sqrt(a);e/=o,n/=o,r/=o;}var s=Math.sin(i/2),l=s*Math.cos(i/2),u=s*s;return[1-2*(n*n+r*r)*u,2*(e*n*u+r*l),2*(e*r*u-n*l),0,2*(e*n*u-r*l),1-2*(e*e+r*r)*u,2*(n*r*u+e*l),0,2*(e*r*u+n*l),2*(n*r*u-e*l),1-2*(e*e+n*n)*u,0,0,0,0,1];case"scale":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scaleX":return[t.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaleY":return[1,0,0,0,0,t.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scaleZ":return[1,0,0,0,0,1,0,0,0,0,t.d[0].value,0,0,0,0,1];case"scale3d":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,t.d[2].value,0,0,0,0,1];case"skew":var c=eQ(t.d[0])*tv;return[1,Math.tan(eQ(t.d[1])*tv),0,0,Math.tan(c),1,0,0,0,0,1,0,0,0,0,1];case"skewX":return[1,0,0,0,Math.tan(i=eQ(t.d[0])*tv),1,0,0,0,0,1,0,0,0,0,1];case"skewY":return[1,Math.tan(i=eQ(t.d[0])*tv),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return[1,0,0,0,0,1,0,0,0,0,1,0,e=e0(t.d[0],0,null)||0,n=e0(t.d[1],0,null)||0,0,1];case"translateX":return[1,0,0,0,0,1,0,0,0,0,1,0,e=e0(t.d[0],0,null)||0,0,0,1];case"translateY":return[1,0,0,0,0,1,0,0,0,0,1,0,0,n=e0(t.d[0],0,null)||0,0,1];case"translateZ":return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,r=e0(t.d[0],0,null)||0,1];case"translate3d":return[1,0,0,0,0,1,0,0,0,0,1,0,e=e0(t.d[0],0,null)||0,n=e0(t.d[1],0,null)||0,r=e0(t.d[2],0,null)||0,1];case"perspective":var h=e0(t.d[0],0,null)||0;return[1,0,0,0,0,1,0,0,0,0,1,h?-1/h:0,0,0,0,1];case"matrix":return[t.d[0].value,t.d[1].value,0,0,t.d[2].value,t.d[3].value,0,0,0,0,1,0,t.d[4].value,t.d[5].value,0,1];case"matrix3d":return t.d.map(function(t){return t.value;});}}function nE(t,e){return[t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12]*e[3],t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13]*e[3],t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]*e[3],t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15]*e[3],t[0]*e[4]+t[4]*e[5]+t[8]*e[6]+t[12]*e[7],t[1]*e[4]+t[5]*e[5]+t[9]*e[6]+t[13]*e[7],t[2]*e[4]+t[6]*e[5]+t[10]*e[6]+t[14]*e[7],t[3]*e[4]+t[7]*e[5]+t[11]*e[6]+t[15]*e[7],t[0]*e[8]+t[4]*e[9]+t[8]*e[10]+t[12]*e[11],t[1]*e[8]+t[5]*e[9]+t[9]*e[10]+t[13]*e[11],t[2]*e[8]+t[6]*e[9]+t[10]*e[10]+t[14]*e[11],t[3]*e[8]+t[7]*e[9]+t[11]*e[10]+t[15]*e[11],t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12]*e[15],t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13]*e[15],t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14]*e[15],t[3]*e[12]+t[7]*e[13]+t[11]*e[14]+t[15]*e[15]];}function nx(t){var e=[0,0,0],n=[1,1,1],r=[0,0,0],i=[0,0,0,1],a=[0,0,0,1];return!function(t,e,n,r,i,a){if(!(!function(t,e){var n=e[15];if(0===n)return!1;for(var r=1/n,i=0;i<16;i++)t[i]=e[i]*r;return!0;}(tk,t)||(G.mat4.copy(tE,tk),tE[3]=0,tE[7]=0,tE[11]=0,tE[15]=1,1e-8>Math.abs(G.mat4.determinant(tE))))){var o=tk[3],s=tk[7],l=tk[11],u=tk[12],c=tk[13],h=tk[14],d=tk[15];if(0!==o||0!==s||0!==l){if(tx[0]=o,tx[1]=s,tx[2]=l,tx[3]=d,!G.mat4.invert(tE,tE))return;G.mat4.transpose(tE,tE),G.vec4.transformMat4(i,tx,tE);}else i[0]=i[1]=i[2]=0,i[3]=1;if(e[0]=u,e[1]=c,e[2]=h,tT[0][0]=tk[0],tT[0][1]=tk[1],tT[0][2]=tk[2],tT[1][0]=tk[4],tT[1][1]=tk[5],tT[1][2]=tk[6],tT[2][0]=tk[8],tT[2][1]=tk[9],tT[2][2]=tk[10],n[0]=G.vec3.length(tT[0]),G.vec3.normalize(tT[0],tT[0]),r[0]=G.vec3.dot(tT[0],tT[1]),tb(tT[1],tT[1],tT[0],1,-r[0]),n[1]=G.vec3.length(tT[1]),G.vec3.normalize(tT[1],tT[1]),r[0]/=n[1],r[1]=G.vec3.dot(tT[0],tT[2]),tb(tT[2],tT[2],tT[0],1,-r[1]),r[2]=G.vec3.dot(tT[1],tT[2]),tb(tT[2],tT[2],tT[1],1,-r[2]),n[2]=G.vec3.length(tT[2]),G.vec3.normalize(tT[2],tT[2]),r[1]/=n[2],r[2]/=n[2],G.vec3.cross(tN,tT[1],tT[2]),0>G.vec3.dot(tT[0],tN))for(var f=0;f<3;f++)n[f]*=-1,tT[f][0]*=-1,tT[f][1]*=-1,tT[f][2]*=-1;a[0]=.5*Math.sqrt(Math.max(1+tT[0][0]-tT[1][1]-tT[2][2],0)),a[1]=.5*Math.sqrt(Math.max(1-tT[0][0]+tT[1][1]-tT[2][2],0)),a[2]=.5*Math.sqrt(Math.max(1-tT[0][0]-tT[1][1]+tT[2][2],0)),a[3]=.5*Math.sqrt(Math.max(1+tT[0][0]+tT[1][1]+tT[2][2],0)),tT[2][1]>tT[1][2]&&(a[0]=-a[0]),tT[0][2]>tT[2][0]&&(a[1]=-a[1]),tT[1][0]>tT[0][1]&&(a[2]=-a[2]);}}(0===t.length?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:t.map(nk).reduce(nE),e,n,r,i,a),[[e,n,r,a,i]];}var nT=function(){function t(t,e){for(var n=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],r=0;r<4;r++)for(var i=0;i<4;i++)for(var a=0;a<4;a++)n[r][i]+=e[r][a]*t[a][i];return n;}return function(e,n,r,i,a){for(var o,s=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],l=0;l<4;l++)s[l][3]=a[l];for(var u=0;u<3;u++)for(var c=0;c<3;c++)s[3][u]+=e[c]*s[c][u];var h=i[0],d=i[1],f=i[2],v=i[3],p=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];p[0][0]=1-2*(d*d+f*f),p[0][1]=2*(h*d-f*v),p[0][2]=2*(h*f+d*v),p[1][0]=2*(h*d+f*v),p[1][1]=1-2*(h*h+f*f),p[1][2]=2*(d*f-h*v),p[2][0]=2*(h*f-d*v),p[2][1]=2*(d*f+h*v),p[2][2]=1-2*(h*h+d*d),s=t(s,p);var g=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];r[2]&&(g[2][1]=r[2],s=t(s,g)),r[1]&&(g[2][1]=0,g[2][0]=r[0],s=t(s,g)),r[0]&&(g[2][0]=0,g[1][0]=r[0],s=t(s,g));for(var y=0;y<3;y++)for(var m=0;m<3;m++)s[y][m]*=n[y];return 0===(o=s)[0][2]&&0===o[0][3]&&0===o[1][2]&&0===o[1][3]&&0===o[2][0]&&0===o[2][1]&&1===o[2][2]&&0===o[2][3]&&0===o[3][2]&&1===o[3][3]?[s[0][0],s[0][1],s[1][0],s[1][1],s[3][0],s[3][1]]:s[0].concat(s[1],s[2],s[3]);};}();function nN(t){return t.toFixed(6).replace(".000000","");}function nb(t,e){var n,r;return(t.decompositionPair!==e&&(t.decompositionPair=e,n=nx(t)),e.decompositionPair!==t&&(e.decompositionPair=t,r=nx(e)),null===n[0]||null===r[0])?[[!1],[!0],function(n){return n?e[0].d:t[0].d;}]:(n[0].push(0),r[0].push(1),[n,r,function(t){var e=function(t,e,n){var r=function(t,e){for(var n=0,r=0;r<t.length;r++)n+=t[r]*e[r];return n;}(t,e);r=(0,F.clamp)(r,-1,1);var i=[];if(1===r)i=t;else for(var a=Math.acos(r),o=1*Math.sin(n*a)/Math.sqrt(1-r*r),s=0;s<4;s++)i.push(t[s]*(Math.cos(n*a)-r*o)+e[s]*o);return i;}(n[0][3],r[0][3],t[5]);return nT(t[0],t[1],t[2],e,t[4]).map(nN).join(",");}]);}function nS(t){return t.replace(/[XY]/,"");}function nw(t){return t.replace(/(X|Y|Z|3d)?$/,"3d");}function nP(t,e,n){var r=!1;if(!t.length||!e.length){t.length||(r=!0,t=e,e=[]);for(var i=0;i<t.length;i++)!function(){var n=t[i],r=n.t,a=n.d,o="scale"===r.substring(0,5)?1:0;e.push({t:r,d:a.map(function(t){return"number"==typeof t?eO(o):eO(o,t.unit);})});}();}var a=[],o=[],s=[];if(t.length!==e.length){var l=nb(t,e);a=[l[0]],o=[l[1]],s=[["matrix",[l[2]]]];}else for(var u=0;u<t.length;u++){var c=t[u].t,h=e[u].t,d=t[u].d,f=e[u].d,v=ng[c],p=ng[h],g=void 0;if("perspective"===c&&"perspective"===h||("matrix"===c||"matrix3d"===c)&&("matrix"===h||"matrix3d"===h)){var y=nb([t[u]],[e[u]]);a.push(y[0]),o.push(y[1]),s.push(["matrix",[y[2]]]);continue;}if(c===h)g=c;else if(v[2]&&p[2]&&nS(c)===nS(h))g=nS(c),d=v[2](d),f=p[2](f);else if(v[1]&&p[1]&&nw(c)===nw(h))g=nw(c),d=v[1](d),f=p[1](f);else{var m=nb(t,e);a=[m[0]],o=[m[1]],s=[["matrix",[m[2]]]];break;}for(var k=[],E=[],x=[],T=0;T<d.length;T++){var N=function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a="",o=t.value||0,s=e.value||0,l=eT(t.unit),u=t.convertTo(l),c=e.convertTo(l);return u&&c?(o=u.value,s=c.value,a=ep(t.unit)):(eN.isLength(t.unit)||eN.isLength(e.unit))&&(o=e0(t,i,n),s=e0(e,i,n),a="px"),[o,s,function(t){return r&&(t=Math.max(t,0)),t+a;}];}(d[T],f[T],n,!1,T);k[T]=N[0],E[T]=N[1],x.push(N[2]);}a.push(k),o.push(E),s.push([g,x]);}if(r){var b=a;a=o,o=b;}return[a,o,function(t){return t.map(function(t,e){var n=t.map(function(t,n){return s[e][1][n](t);}).join(",");return"matrix"===s[e][0]&&16===n.split(",").length&&(s[e][0]="matrix3d"),"matrix3d"===s[e][0]&&6===n.split(",").length&&(s[e][0]="matrix"),"".concat(s[e][0],"(").concat(n,")");}).join(" ");}];}var nM=ea(function(t){if((0,F.isString)(t)){if("text-anchor"===t)return[eO(0,"px"),eO(0,"px")];var e=t.split(" ");return(1===e.length&&("top"===e[0]||"bottom"===e[0]?(e[1]=e[0],e[0]="center"):e[1]="center"),2!==e.length)?null:[e$(nA(e[0])),e$(nA(e[1]))];}return[eO(t[0]||0,"px"),eO(t[1]||0,"px")];});function nA(t){return"center"===t?"50%":"left"===t||"top"===t?"0%":"right"===t||"bottom"===t?"100%":t;}var nC=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:tG.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:tG.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:tG.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:tG.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:tG.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:tG.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:tG.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:tG.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:tG.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:tG.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:tG.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:tG.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:tG.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:tG.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:tG.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:tG.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:tG.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:tG.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:tG.FILTER},{n:"clipPath",syntax:tG.DEFINED_PATH},{n:"textPath",syntax:tG.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:tG.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:tG.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:tG.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:tG.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:tG.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:tG.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:tG.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:tG.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:tG.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:tG.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:tG.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:tG.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:tG.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:tG.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:tG.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:tG.COORDINATE},{n:"y1",int:!0,l:!0,syntax:tG.COORDINATE},{n:"z1",int:!0,l:!0,syntax:tG.COORDINATE},{n:"x2",int:!0,l:!0,syntax:tG.COORDINATE},{n:"y2",int:!0,l:!0,syntax:tG.COORDINATE},{n:"z2",int:!0,l:!0,syntax:tG.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:tG.PATH,p:50},{n:"points",int:!0,l:!0,syntax:tG.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:tG.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:tG.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:tG.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:tG.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:tG.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:tG.NUMBER,d:function(t){return t===j.PATH||t===j.POLYGON||t===j.POLYLINE?"4":"10";}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:tG.MARKER},{n:"markerEnd",syntax:tG.MARKER},{n:"markerMid",syntax:tG.MARKER},{n:"markerStartOffset",syntax:tG.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:tG.LENGTH,l:!0,int:!0,d:"0"}],nR=new Set(nC.filter(function(t){return!!t.l;}).map(function(t){return t.n;})),nO={},nL=(0,R.default)(function t(e){var n=this;(0,C.default)(this,t),this.runtime=e,nC.forEach(function(t){n.registerMetadata(t);});},[{key:"registerMetadata",value:function(t){[t.n].concat((0,O.default)(t.a||[])).forEach(function(e){nO[e]=t;});}},{key:"getPropertySyntax",value:function(t){return this.runtime.CSSPropertySyntaxFactory[t];}},{key:"processProperties",value:function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[],memoize:!0};Object.assign(t.attributes,e);var i=t.parsedStyle.clipPath,a=t.parsedStyle.offsetPath;!function(t,e){var n=nI(t);for(var r in e)n.has(r)&&(t.parsedStyle[r]=e[r]);}(t,e);var o=!!r.forceUpdateGeometry;if(!o){for(var s in e)if(nR.has(s)){o=!0;break;}}var l=nI(t);l.has("fill")&&e.fill&&(t.parsedStyle.fill=eH(e.fill)),l.has("stroke")&&e.stroke&&(t.parsedStyle.stroke=eH(e.stroke)),l.has("shadowColor")&&e.shadowColor&&(t.parsedStyle.shadowColor=eH(e.shadowColor)),l.has("filter")&&e.filter&&(t.parsedStyle.filter=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if("none"===(e=e.toLowerCase().trim()))return[];for(var n=/\s*([\w-]+)\(([^)]*)\)/g,r=[],i=0;(t=n.exec(e))&&t.index===i;)if(i=t.index+t[0].length,e1.indexOf(t[1])>-1&&r.push({name:t[1],params:t[2].split(" ").map(function(t){return eW(/deg|rad|grad|turn|px|%/g,t)||eH(t);})}),n.lastIndex===e.length)return r;return[];}(e.filter)),l.has("radius")&&!(0,F.isNil)(e.radius)&&(t.parsedStyle.radius=eJ(e.radius,4)),l.has("lineDash")&&!(0,F.isNil)(e.lineDash)&&(t.parsedStyle.lineDash=eJ(e.lineDash,"even")),l.has("points")&&e.points&&(t.parsedStyle.points=(n=e.points,{points:(0,F.isString)(n)?n.split(" ").map(function(t){var e=t.split(","),n=(0,D.default)(e,2),r=n[0],i=n[1];return[Number(r),Number(i)];}):n,totalLength:0,segments:[]})),l.has("d")&&""===e.d&&(t.parsedStyle.d=(0,A.default)({},t_)),l.has("d")&&e.d&&(t.parsedStyle.d=nc(e.d)),l.has("textTransform")&&e.textTransform&&this.runtime.CSSPropertySyntaxFactory[tG.TEXT_TRANSFORM].calculator(null,null,{value:e.textTransform},t,null),l.has("clipPath")&&!(0,F.isUndefined)(e.clipPath)&&this.runtime.CSSPropertySyntaxFactory[tG.DEFINED_PATH].calculator("clipPath",i,e.clipPath,t,this.runtime),l.has("offsetPath")&&e.offsetPath&&this.runtime.CSSPropertySyntaxFactory[tG.DEFINED_PATH].calculator("offsetPath",a,e.offsetPath,t,this.runtime),l.has("transform")&&e.transform&&(t.parsedStyle.transform=function(t){if(Array.isArray(t))return ny(t);if("none"===(t=(t||"none").trim()))return[];var e,n=[],r=0;for(nf.lastIndex=0;(e=nf.exec(t))&&e.index===r;){r=e.index+e[0].length;var i=e[1],a=ng[i];if(!a)break;var o=e[2].split(","),s=a[0];if(s.length<o.length)break;for(var l=[],u=0;u<s.length;u++){var c=o[u],h=s[u],d=void 0;if(void 0===(d=c?({A:function(t){return"0"===t.trim()?eS:eZ(t);},N:e4,T:e$,L:eX})[h.toUpperCase()](c):({a:eS,n:l[0],t:eb})[h]))return[];l.push(d);}if(n.push({t:i,d:l}),nf.lastIndex===t.length)return n;}return[];}(e.transform)),l.has("transformOrigin")&&e.transformOrigin&&(t.parsedStyle.transformOrigin=nM(e.transformOrigin)),l.has("markerStart")&&e.markerStart&&(t.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory[tG.MARKER].calculator(null,e.markerStart,e.markerStart,null,null)),l.has("markerEnd")&&e.markerEnd&&(t.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory[tG.MARKER].calculator(null,e.markerEnd,e.markerEnd,null,null)),l.has("markerMid")&&e.markerMid&&(t.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory[tG.MARKER].calculator("",e.markerMid,e.markerMid,null,null)),l.has("zIndex")&&!(0,F.isNil)(e.zIndex)&&this.runtime.CSSPropertySyntaxFactory[tG.Z_INDEX].postProcessor(t),l.has("offsetDistance")&&!(0,F.isNil)(e.offsetDistance)&&this.runtime.CSSPropertySyntaxFactory[tG.OFFSET_DISTANCE].postProcessor(t),l.has("transform")&&e.transform&&this.runtime.CSSPropertySyntaxFactory[tG.TRANSFORM].postProcessor(t),l.has("transformOrigin")&&e.transformOrigin&&this.runtime.CSSPropertySyntaxFactory[tG.TRANSFORM_ORIGIN].postProcessor(t),o&&(t.dirty(!0,!0),r.forceUpdateGeometry||this.runtime.sceneGraphService.dirtyToRoot(t));}},{key:"updateGeometry",value:function(t){var e=t.nodeName,n=this.runtime.geometryUpdaterFactory[e];if(n){var r=t.geometry;r.contentBounds||(r.contentBounds=new ti),r.renderBounds||(r.renderBounds=new ti);var i=t.parsedStyle,a=n.update(i,t),o=a.cx,s=a.cy,l=a.cz,u=a.hwidth,c=void 0===u?0:u,h=a.hheight,d=void 0===h?0:h,f=a.hdepth,v=[Math.abs(c),Math.abs(d),void 0===f?0:f],p=i.stroke,g=i.lineWidth,y=i.increasedLineWidthForHitTesting,m=i.shadowType,k=void 0===m?"outer":m,E=i.shadowColor,x=i.filter,T=i.transformOrigin,N=[void 0===o?0:o,void 0===s?0:s,void 0===l?0:l];r.contentBounds.update(N,v);var b=e===j.POLYLINE||e===j.POLYGON||e===j.PATH?Math.SQRT2:.5;if(p&&!p.isNone){var S=(((void 0===g?1:g)||0)+((void 0===y?0:y)||0))*b;v[0]+=S,v[1]+=S;}if(r.renderBounds.update(N,v),E&&k&&"inner"!==k){var w=r.renderBounds,P=w.min,M=w.max,A=i.shadowBlur,C=i.shadowOffsetX,R=i.shadowOffsetY,O=A||0,L=C||0,I=R||0,D=P[0]-O+L,_=M[0]+O+L,F=P[1]-O+I,B=M[1]+O+I;P[0]=Math.min(P[0],D),M[0]=Math.max(M[0],_),P[1]=Math.min(P[1],F),M[1]=Math.max(M[1],B),r.renderBounds.setMinMax(P,M);}(void 0===x?[]:x).forEach(function(t){var e=t.name,n=t.params;if("blur"===e){var i=n[0].value;r.renderBounds.update(r.renderBounds.center,G.vec3.add(r.renderBounds.halfExtents,r.renderBounds.halfExtents,[i,i,0]));}else if("drop-shadow"===e){var a=n[0].value,o=n[1].value,s=n[2].value,l=r.renderBounds,u=l.min,c=l.max,h=u[0]-s+a,d=c[0]+s+a,f=u[1]-s+o,v=c[1]+s+o;u[0]=Math.min(u[0],h),c[0]=Math.max(c[0],d),u[1]=Math.min(u[1],f),c[1]=Math.max(c[1],v),r.renderBounds.setMinMax(u,c);}}),t.geometry.dirty=!1;var U=d<0,V=(c<0?-1:1)*(T?e0(T[0],0,t,!0):0),z=(U?-1:1)*(T?e0(T[1],1,t,!0):0);(V||z)&&t.setOrigin(V,z);}}},{key:"updateSizeAttenuation",value:function(t,e){t.style.isSizeAttenuation?(t.style.rawLineWidth||(t.style.rawLineWidth=t.style.lineWidth),t.style.lineWidth=(t.style.rawLineWidth||1)/e,t.nodeName===j.CIRCLE&&(t.style.rawR||(t.style.rawR=t.style.r),t.style.r=(t.style.rawR||1)/e)):(t.style.rawLineWidth&&(t.style.lineWidth=t.style.rawLineWidth,delete t.style.rawLineWidth),t.nodeName===j.CIRCLE&&t.style.rawR&&(t.style.r=t.style.rawR,delete t.style.rawR));}}]);function nI(t){return t.constructor.PARSED_STYLE_LIST;}var nD=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e5;},[{key:"calculator",value:function(t,e,n,r){return eQ(n);}}]),n_=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r,i){return n instanceof eE&&(n=null),i.sceneGraphService.updateDisplayObjectDependency(t,e,n,r),"clipPath"===t&&r.forEach(function(t){0===t.childNodes.length&&i.sceneGraphService.dirtyToRoot(t);}),n;}}]),nG=(0,R.default)(function t(){(0,C.default)(this,t),this.parser=eH,this.mixer=eY;},[{key:"calculator",value:function(t,e,n,r){return n instanceof eE?"none"===n.value?eA:eC:n;}}]),nF=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n){return n instanceof eE?[]:n;}}]);function nB(t){var e=t.parsedStyle.fontSize;return(0,F.isNil)(e)?null:e;}var nU=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e5;},[{key:"calculator",value:function(t,e,n,r,i){if((0,F.isNumber)(n))return n;if(!eN.isRelativeUnit(n.unit))return n.value;if(n.unit===eo.kPercentage)return 0;if(n.unit===eo.kEms){if(r.parentNode){var a,o=nB(r.parentNode);if(o)return o*n.value;}return 0;}if(n.unit===eo.kRems){if(null!=r&&null!==(a=r.ownerDocument)&&void 0!==a&&a.documentElement){var s=nB(r.ownerDocument.documentElement);if(s)return s*n.value;}return 0;}}}]),nV=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e7;},[{key:"calculator",value:function(t,e,n){return n.map(function(t){return t.value;});}}]),nz=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e7;},[{key:"calculator",value:function(t,e,n){return n.map(function(t){return t.value;});}}]),nH=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){n instanceof eE&&(n=null);var i,a=null===(i=n)||void 0===i?void 0:i.cloneNode(!0);return a&&(a.style.isMarker=!0),a;}}]),nY=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e5;},[{key:"calculator",value:function(t,e,n){return n.value;}}]),nW=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e6(0,1);},[{key:"calculator",value:function(t,e,n){return n.value;}},{key:"postProcessor",value:function(t){var e=t.parsedStyle,n=e.offsetPath,r=e.offsetDistance;if(n){var i=n.nodeName;if(i===j.LINE||i===j.PATH||i===j.POLYLINE){var a=n.getPoint(r);a&&t.setLocalPosition(a.x,a.y);}}}}]),nq=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e6(0,1);},[{key:"calculator",value:function(t,e,n){return n.value;}}]),nX=(0,R.default)(function t(){(0,C.default)(this,t),this.parser=nc,this.mixer=nh;},[{key:"calculator",value:function(t,e,n){return n instanceof eE&&"unset"===n.value?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new tu(0,0,0,0)}:n;}}]),nj=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=nd;}),n$=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).mixer=e6(0,1/0),t;}return(0,I.default)(e,t),(0,R.default)(e);}(nU),nK=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){return n instanceof eE?"unset"===n.value?"":n.value:"".concat(n);}},{key:"postProcessor",value:function(t){t.nodeValue="".concat(t.parsedStyle.text)||"";}}]),nZ=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){var i=r.getAttribute("text");if(i){var a=i;"capitalize"===n.value?a=i.charAt(0).toUpperCase()+i.slice(1):"lowercase"===n.value?a=i.toLowerCase():"uppercase"===n.value&&(a=i.toUpperCase()),r.parsedStyle.text=a;}return n.value;}}]),nQ=(new WeakMap,"undefined"!=typeof window&&void 0!==window.document);function nJ(t,e){var n=Number(t.parsedStyle.zIndex||0),r=Number(e.parsedStyle.zIndex||0);if(n===r){var i=t.parentNode;if(i){var a=i.childNodes||[];return a.indexOf(t)-a.indexOf(e);}}return n-r;}function n0(t,e,n){nQ&&t.style&&(t.style.width=e+"px",t.style.height=n+"px");}var n1={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},n2="object"==typeof performance&&performance.now?performance:Date;function n3(t){return t.nodeName===j.FRAGMENT||t.getRootNode().nodeName===j.FRAGMENT;}var n4=1,n5="object"==typeof self&&self.self===self?self:"object"==typeof X&&X.global===X?X:{},n6=Date.now(),n7={},n9=Date.now(),n8=function(t){if("function"!=typeof t)throw TypeError("".concat(t," is not a function"));var e=Date.now(),n=e-n9,r=n4++;return n7[r]=t,Object.keys(n7).length>1||setTimeout(function(){n9=e;var t=n7;n7={},Object.keys(t).forEach(function(e){return t[e](n5.performance&&"function"==typeof n5.performance.now?n5.performance.now():Date.now()-n6);});},n>16?0:16-n),r;},rt=function(t){return"string"!=typeof t?n8:""===t?n5.requestAnimationFrame:n5["".concat(t,"RequestAnimationFrame")];},re=function(t,e){for(var n=0;void 0!==t[n];){if(e(t[n]))return t[n];n+=1;}}(["","webkit","moz","ms","o"],function(t){return!!rt(t);}),rn=rt(re),rr="string"!=typeof re?function(t){delete n7[t];}:""===re?n5.cancelAnimationFrame:n5["".concat(re,"CancelAnimationFrame")]||n5["".concat(re,"CancelRequestAnimationFrame")];n5.requestAnimationFrame=rn,n5.cancelAnimationFrame=rr;var ri=(0,R.default)(function t(){(0,C.default)(this,t),this.callbacks=[];},[{key:"getCallbacksNum",value:function(){return this.callbacks.length;}},{key:"tapPromise",value:function(t,e){this.callbacks.push(e);}},{key:"promise",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return Promise.all(this.callbacks.map(function(t){return t.apply(void 0,e);}));}}]),ra=(0,R.default)(function t(){(0,C.default)(this,t),this.callbacks=[];},[{key:"tapPromise",value:function(t,e){this.callbacks.push(e);}},{key:"promise",value:(m=(0,Y.default)((0,H.default)().mark(function t(){var e,n,r,i,a=arguments;return(0,H.default)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.callbacks.length){t.next=6;break;}return t.next=1,(e=this.callbacks)[0].apply(e,a);case 1:n=t.sent,r=1;case 2:if(!(r<this.callbacks.length)){t.next=5;break;}return i=this.callbacks[r],t.next=3,i(n);case 3:n=t.sent;case 4:r++,t.next=2;break;case 5:return t.abrupt("return",n);case 6:return t.abrupt("return",null);case 7:case"end":return t.stop();}},t,this);})),function(){return m.apply(this,arguments);})}]),ro=(0,R.default)(function t(){(0,C.default)(this,t),this.callbacks=[];},[{key:"tap",value:function(t,e){this.callbacks.push(e);}},{key:"call",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=arguments;this.callbacks.forEach(function(t){t.apply(void 0,r);});}}]),rs=(0,R.default)(function t(){(0,C.default)(this,t),this.callbacks=[];},[{key:"tap",value:function(t,e){this.callbacks.push(e);}},{key:"call",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];if(this.callbacks.length){for(var r=arguments,i=this.callbacks[0].apply(void 0,r),a=1;a<this.callbacks.length;a++)i=(0,this.callbacks[a])(i);return i;}return null;}}]),rl=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],ru=/([\"\'])[^\'\"]+\1/;function rc(t){var e=t.fontSize,n=t.fontFamily,r=t.fontStyle,i=t.fontVariant,a=t.fontWeight;return{fontSize:void 0===e?16:e,fontFamily:void 0===n?"sans-serif":n,fontStyle:void 0===r?"normal":r,fontVariant:void 0===i?"normal":i,fontWeight:void 0===a?"normal":a};}var rh=ea(function(t){for(var e=rc(t),n=e.fontSize,r=e.fontFamily,i=e.fontStyle,a=e.fontVariant,o=e.fontWeight,s=(0,F.isNumber)(n)&&"".concat(n,"px")||"16px",l=r.split(","),u=l.length-1;u>=0;u--){var c=l[u].trim();!ru.test(c)&&0>rl.indexOf(c)&&(c='"'.concat(c,'"')),l[u]=c;}return"".concat(i," ").concat(a," ").concat(o," ").concat(s," ").concat(l.join(","));},function(t){var e=rc(t),n=e.fontSize,r=e.fontFamily,i=e.fontStyle,a=e.fontVariant,o=e.fontWeight;return"".concat(i,"_").concat(a,"_").concat(o,"_").concat(n,"_").concat(r);}),rd=function(t){return Math.max(t,1e-6);};function rf(t,e,n){return G.mat4.identity(t),t[4]=Math.tan(e),t[1]=Math.tan(n),t;}var rv=G.mat4.create(),rp=G.mat4.create(),rg={scale:function(t){G.mat4.fromScaling(rv,[t[0].value,t[1].value,1].map(function(t){return rd(t);}));},scaleX:function(t){G.mat4.fromScaling(rv,[t[0].value,1,1].map(function(t){return rd(t);}));},scaleY:function(t){G.mat4.fromScaling(rv,[1,t[0].value,1].map(function(t){return rd(t);}));},scaleZ:function(t){G.mat4.fromScaling(rv,[1,1,t[0].value].map(function(t){return rd(t);}));},scale3d:function(t){G.mat4.fromScaling(rv,[t[0].value,t[1].value,t[2].value].map(function(t){return rd(t);}));},translate:function(t){G.mat4.fromTranslation(rv,[t[0].value,t[1].value,0]);},translateX:function(t){G.mat4.fromTranslation(rv,[t[0].value,0,0]);},translateY:function(t){G.mat4.fromTranslation(rv,[0,t[0].value,0]);},translateZ:function(t){G.mat4.fromTranslation(rv,[0,0,t[0].value]);},translate3d:function(t){G.mat4.fromTranslation(rv,[t[0].value,t[1].value,t[2].value]);},rotate:function(t){G.mat4.fromZRotation(rv,eQ(t[0])*tv);},rotateX:function(t){G.mat4.fromXRotation(rv,eQ(t[0])*tv);},rotateY:function(t){G.mat4.fromYRotation(rv,eQ(t[0])*tv);},rotateZ:function(t){G.mat4.fromZRotation(rv,eQ(t[0])*tv);},rotate3d:function(t){G.mat4.fromRotation(rv,eQ(t[3])*tv,[t[0].value,t[1].value,t[2].value]);},skew:function(t){rf(rv,t[0].value*tv,t[1].value*tv);},skewX:function(t){rf(rv,t[0].value*tv,0);},skewY:function(t){rf(rv,0,t[0].value*tv);},matrix:function(t){G.mat4.set(rv,t[0].value,t[1].value,0,0,t[2].value,t[3].value,0,0,0,0,1,0,t[4].value,t[5].value,0,1);},matrix3d:function(t){G.mat4.set.apply(G.mat4,[rv].concat((0,O.default)(t.map(function(t){return t.value;}))));}},ry=G.vec3.fromValues(1,1,1),rm=G.vec3.create(),rk={translate:function(t,e){io.sceneGraphService.setLocalScale(t,ry,!1),io.sceneGraphService.setLocalEulerAngles(t,rm,void 0,void 0,!1),io.sceneGraphService.setLocalPosition(t,[e[0].value,e[1].value,0],!1),io.sceneGraphService.dirtyLocalTransform(t,t.transformable);}},rE=(0,R.default)(function t(){(0,C.default)(this,t),this.parser=nm,this.mixer=nP;},[{key:"calculator",value:function(t,e,n,r){return n instanceof eE?[]:n;}},{key:"postProcessor",value:function(t){!function(t,e){if(t.length){if(1===t.length&&rk[t[0].t]){rk[t[0].t](e,t[0].d);return;}for(var n=G.mat4.identity(rp),r=0;r<t.length;r++){var i=t[r],a=i.t,o=i.d,s=rg[a];s&&(s(o),G.mat4.mul(n,n,rv));}e.setLocalTransform(n);}else e.resetLocalTransform();e.getLocalTransform();}(t.parsedStyle.transform,t);}}]),rx=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"postProcessor",value:function(t){var e=t.parsedStyle.transformOrigin;e[0].unit===eo.kPixels&&e[1].unit===eo.kPixels?t.setOrigin(e[0].value,e[1].value):t.getGeometryBounds();}}]),rT=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){return n.value;}},{key:"postProcessor",value:function(t){if(t.parentNode){var e=t.parentNode,n=e.renderable,r=e.sortable;n&&e.dirty(),r&&(r.dirty=!0,r.dirtyReason=tR.Z_INDEX_CHANGED);}}}]),rN=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){var n=t.cx,r=t.cy,i=t.r,a=void 0===i?0:i;return{cx:void 0===n?0:n,cy:void 0===r?0:r,hwidth:a,hheight:a};}}]),rb=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){var n=t.cx,r=t.cy,i=t.rx,a=t.ry;return{cx:void 0===n?0:n,cy:void 0===r?0:r,hwidth:void 0===i?0:i,hheight:void 0===a?0:a};}}]),rS=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t){var e=t.x1,n=t.y1,r=t.x2,i=t.y2,a=Math.min(e,r),o=Math.min(n,i),s=(Math.max(e,r)-a)/2,l=(Math.max(n,i)-o)/2;return{cx:a+s,cy:o+l,hwidth:s,hheight:l};}}]),rw=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t){var e=t.d.rect,n=e.x,r=e.y,i=e.width,a=e.height,o=i/2,s=a/2;return{cx:n+o,cy:r+s,hwidth:o,hheight:s};}}]),rP=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t){if(t.points&&(0,F.isArray)(t.points.points)){var e=t.points.points,n=Math.min.apply(Math,(0,O.default)(e.map(function(t){return t[0];}))),r=Math.max.apply(Math,(0,O.default)(e.map(function(t){return t[0];}))),i=Math.min.apply(Math,(0,O.default)(e.map(function(t){return t[1];}))),a=Math.max.apply(Math,(0,O.default)(e.map(function(t){return t[1];}))),o=(r-n)/2,s=(a-i)/2;return{cx:n+o,cy:i+s,hwidth:o,hheight:s};}return{cx:0,cy:0,hwidth:0,hheight:0};}}]),rM=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){var n=t.x,r=t.y,i=t.src,a=t.width,o=t.height,s=void 0===a?0:a,l=void 0===o?0:o;return!i||(0,F.isString)(i)||(s||(s=i.width,t.width=s),l||(l=i.height,t.height=l)),{cx:(void 0===n?0:n)+s/2,cy:(void 0===r?0:r)+l/2,hwidth:s/2,hheight:l/2};}}]),rA=(0,R.default)(function t(e){(0,C.default)(this,t),this.globalRuntime=e;},[{key:"isReadyToMeasure",value:function(t,e){return t.text;}},{key:"update",value:function(t,e){var n,r=t.text,i=t.textAlign,a=void 0===i?"start":i,o=t.lineWidth,s=void 0===o?1:o,l=t.textBaseline,u=void 0===l?"alphabetic":l,c=t.dx,h=void 0===c?0:c,d=t.dy,f=void 0===d?0:d,v=t.x,p=t.y;if(!this.isReadyToMeasure(t,e))return t.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var g=((null==e||null===(n=e.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n?void 0:n.getConfig())||{}).offscreenCanvas,y=this.globalRuntime.textService.measureText(r,t,g);t.metrics=y;var m=y.width,k=y.height,E=m/2,x=k/2,T=(void 0===v?0:v)+E;"center"===a||"middle"===a?T+=s/2-E:("right"===a||"end"===a)&&(T+=s-2*E);var N=(void 0===p?0:p)-x;return"middle"===u?N+=x:"top"===u||"hanging"===u?N+=2*x:"alphabetic"===u||("bottom"===u||"ideographic"===u)&&(N+=0),h&&(T+=h),f&&(N+=f),{cx:T,cy:N,hwidth:E,hheight:x};}}]),rC=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){return{cx:0,cy:0,hwidth:0,hheight:0};}}]),rR=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){var n=t.x,r=t.y,i=t.width,a=void 0===i?0:i,o=t.height,s=void 0===o?0:o;return{cx:(void 0===n?0:n)+a/2,cy:(void 0===r?0:r)+s/2,hwidth:a/2,hheight:s/2};}}]),rO=(0,R.default)(function t(e){(0,C.default)(this,t),this.eventPhase=t.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new tl,this.page=new tl,this.canvas=new tl,this.viewport=new tl,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e;},[{key:"name",get:function(){return this.type;}},{key:"layerX",get:function(){return this.layer.x;}},{key:"layerY",get:function(){return this.layer.y;}},{key:"pageX",get:function(){return this.page.x;}},{key:"pageY",get:function(){return this.page.y;}},{key:"x",get:function(){return this.canvas.x;}},{key:"y",get:function(){return this.canvas.y;}},{key:"canvasX",get:function(){return this.canvas.x;}},{key:"canvasY",get:function(){return this.canvas.y;}},{key:"viewportX",get:function(){return this.viewport.x;}},{key:"viewportY",get:function(){return this.viewport.y;}},{key:"composedPath",value:function(){return this.manager&&(!this.path||this.path[0]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path;}},{key:"propagationPath",get:function(){return this.composedPath();}},{key:"preventDefault",value:function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0;}},{key:"stopImmediatePropagation",value:function(){this.propagationImmediatelyStopped=!0;}},{key:"stopPropagation",value:function(){this.propagationStopped=!0;}},{key:"initEvent",value:function(){}},{key:"initUIEvent",value:function(){}},{key:"clone",value:function(){throw Error(tc);}}]),rL=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).client=new tl,t.movement=new tl,t.offset=new tl,t.global=new tl,t.screen=new tl,t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clientX",get:function(){return this.client.x;}},{key:"clientY",get:function(){return this.client.y;}},{key:"movementX",get:function(){return this.movement.x;}},{key:"movementY",get:function(){return this.movement.y;}},{key:"offsetX",get:function(){return this.offset.x;}},{key:"offsetY",get:function(){return this.offset.y;}},{key:"globalX",get:function(){return this.global.x;}},{key:"globalY",get:function(){return this.global.y;}},{key:"screenX",get:function(){return this.screen.x;}},{key:"screenY",get:function(){return this.screen.y;}},{key:"getModifierState",value:function(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t);}},{key:"initMouseEvent",value:function(){throw Error(tc);}}]);}(rO),rI=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).width=0,t.height=0,t.isPrimary=!1,t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getCoalescedEvents",value:function(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[];}},{key:"getPredictedEvents",value:function(){throw Error("getPredictedEvents is not supported!");}},{key:"clone",value:function(){return this.manager.clonePointerEvent(this);}}]);}(rL),rD=function(t){function e(){return(0,C.default)(this,e),(0,L.default)(this,e,arguments);}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return this.manager.cloneWheelEvent(this);}}]);}(rL),r_=function(t){function e(t,n){var r;return(0,C.default)(this,e),(r=(0,L.default)(this,e,[null])).type=t,r.detail=null==n?void 0:n.detail,!n||"detail"in n||(r.detail=n),Object.assign(r,n),r;}return(0,I.default)(e,t),(0,R.default)(e);}(rO),rG=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).shadow=!1,t.ownerDocument=null,t.isConnected=!1,t.baseURI="",t.childNodes=[],t.nodeType=0,t.nodeName="",t.nodeValue=null,t.mutations=void 0,t.parentNode=null,t.destroyed=!1,t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"textContent",get:function(){var t="";this.nodeName===j.TEXT&&(t+=this.style.text);var e,n=(0,W.default)(this.childNodes);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.nodeName===j.TEXT?t+=r.nodeValue:t+=r.textContent;}}catch(t){n.e(t);}finally{n.f();}return t;},set:function(t){var e=this;this.childNodes.slice().forEach(function(t){e.removeChild(t);}),this.nodeName===j.TEXT&&(this.style.text="".concat(t));}},{key:"getRootNode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.parentNode?this.parentNode.getRootNode(t):t.composed&&this.host?this.host.getRootNode(t):this;}},{key:"hasChildNodes",value:function(){return this.childNodes.length>0;}},{key:"isDefaultNamespace",value:function(t){throw Error(tc);}},{key:"lookupNamespaceURI",value:function(t){throw Error(tc);}},{key:"lookupPrefix",value:function(t){throw Error(tc);}},{key:"normalize",value:function(){throw Error(tc);}},{key:"isEqualNode",value:function(t){return this===t;}},{key:"isSameNode",value:function(t){return this.isEqualNode(t);}},{key:"parent",get:function(){return this.parentNode;}},{key:"parentElement",get:function(){return null;}},{key:"nextSibling",get:function(){return null;}},{key:"previousSibling",get:function(){return null;}},{key:"firstChild",get:function(){return this.childNodes.length>0?this.childNodes[0]:null;}},{key:"lastChild",get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null;}},{key:"compareDocumentPosition",value:function(t){if(t===this)return 0;for(var n,r=t,i=this,a=[r],o=[i];null!==(n=r.parentNode)&&void 0!==n?n:i.parentNode;)r=r.parentNode?(a.push(r.parentNode),r.parentNode):r,i=i.parentNode?(o.push(i.parentNode),i.parentNode):i;if(r!==i)return e.DOCUMENT_POSITION_DISCONNECTED|e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|e.DOCUMENT_POSITION_PRECEDING;var s=a.length>o.length?a:o,l=s===a?o:a;if(s[s.length-l.length]===l[0])return s===a?e.DOCUMENT_POSITION_CONTAINED_BY|e.DOCUMENT_POSITION_FOLLOWING:e.DOCUMENT_POSITION_CONTAINS|e.DOCUMENT_POSITION_PRECEDING;for(var u=s.length-l.length,c=l.length-1;c>=0;c--){var h=l[c],d=s[u+c];if(d!==h){var f=h.parentNode.childNodes;if(f.indexOf(h)<f.indexOf(d)){if(l===a)return e.DOCUMENT_POSITION_PRECEDING;return e.DOCUMENT_POSITION_FOLLOWING;}if(s===a)return e.DOCUMENT_POSITION_PRECEDING;break;}}return e.DOCUMENT_POSITION_FOLLOWING;}},{key:"contain",value:function(t){return this.contains(t);}},{key:"contains",value:function(t){for(var e=t;e&&this!==e;)e=e.parentNode;return!!e;}},{key:"getAncestor",value:function(t){for(var e=this;t>0&&e;)e=e.parentNode,t--;return e;}},{key:"forEach",value:function(t){for(var e=[this];e.length>0;){var n=e.pop();if(!1===t(n))break;for(var r=n.childNodes.length-1;r>=0;r--)e.push(n.childNodes[r]);}}}],[{key:"isNode",value:function(t){return!!t.childNodes;}}]);}((0,R.default)(function t(){(0,C.default)(this,t),this.emitter=new _.default;},[{key:"on",value:function(t,e,n){return this.addEventListener(t,e,n),this;}},{key:"addEventListener",value:function(t,e,n){var r=!1,i=!1;if((0,F.isBoolean)(n))r=n;else if(n){var a=n.capture;r=void 0!==a&&a;var o=n.once;i=void 0!==o&&o;}r&&(t+="capture"),e=(0,F.isFunction)(e)?e:e.handleEvent;var s=(0,F.isFunction)(e)?void 0:e;return i?this.emitter.once(t,e,s):this.emitter.on(t,e,s),this;}},{key:"off",value:function(t,e,n){return t?this.removeEventListener(t,e,n):this.removeAllEventListeners(),this;}},{key:"removeAllEventListeners",value:function(){var t;null===(t=this.emitter)||void 0===t||t.removeAllListeners();}},{key:"removeEventListener",value:function(t,e,n){if(!this.emitter)return this;((0,F.isBoolean)(n)?n:null==n?void 0:n.capture)&&(t+="capture"),e=(0,F.isFunction)(e)?e:null===(r=e)||void 0===r?void 0:r.handleEvent;var r,i=(0,F.isFunction)(e)?void 0:e;return this.emitter.off(t,e,i),this;}},{key:"emit",value:function(t,e){this.dispatchEvent(new r_(t,e));}},{key:"dispatchEventToSelf",value:function(t){t.target||(t.target=this),t.currentTarget=this,this.emitter.emit(t.type,t);}},{key:"dispatchEvent",value:function(t){var e,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0;if(i)return this.dispatchEventToSelf(t),!0;if(e=this.document?this:this.defaultView?this.defaultView:null===(n=this.ownerDocument)||void 0===n?void 0:n.defaultView){if(t.manager=e.getEventService(),!t.manager)return!1;t.defaultPrevented=!1,t.path?t.path.length=0:t.page=[],r||(t.target=this),t.manager.dispatchEvent(t,t.type,r);}else this.dispatchEventToSelf(t);return!t.defaultPrevented;}}]));rG.DOCUMENT_POSITION_DISCONNECTED=1,rG.DOCUMENT_POSITION_PRECEDING=2,rG.DOCUMENT_POSITION_FOLLOWING=4,rG.DOCUMENT_POSITION_CONTAINS=8,rG.DOCUMENT_POSITION_CONTAINED_BY=16,rG.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32,(0,R.default)(function t(e,n){var r=this;(0,C.default)(this,t),this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=G.mat4.create(),this.tmpVec3=G.vec3.create(),this.onPointerDown=function(t){var e=r.createPointerEvent(t);if(r.dispatchEvent(e,"pointerdown"),"touch"===e.pointerType)r.dispatchEvent(e,"touchstart");else if("mouse"===e.pointerType||"pen"===e.pointerType){var n=2===e.button;r.dispatchEvent(e,n?"rightdown":"mousedown");}r.trackingData(t.pointerId).pressTargetsByButton[t.button]=e.composedPath(),r.freeEvent(e);},this.onPointerUp=function(t){var e=n2.now(),n=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);if(r.dispatchEvent(n,"pointerup"),"touch"===n.pointerType)r.dispatchEvent(n,"touchend");else if("mouse"===n.pointerType||"pen"===n.pointerType){var i=2===n.button;r.dispatchEvent(n,i?"rightup":"mouseup");}var a=r.trackingData(t.pointerId),o=r.findMountedTarget(a.pressTargetsByButton[t.button]),s=o;if(o&&!n.composedPath().includes(o)){for(var l=o;l&&!n.composedPath().includes(l);){if(n.currentTarget=l,r.notifyTarget(n,"pointerupoutside"),"touch"===n.pointerType)r.notifyTarget(n,"touchendoutside");else if("mouse"===n.pointerType||"pen"===n.pointerType){var u=2===n.button;r.notifyTarget(n,u?"rightupoutside":"mouseupoutside");}rG.isNode(l)&&(l=l.parentNode);}delete a.pressTargetsByButton[t.button],s=l;}if(s){var c,h=r.clonePointerEvent(n,"click");h.target=s,h.path=[],a.clicksByButton[t.button]||(a.clicksByButton[t.button]={clickCount:0,target:h.target,timeStamp:e});var d=r.context.renderingContext.root.ownerDocument.defaultView,f=a.clicksByButton[t.button];f.target===h.target&&e-f.timeStamp<d.getConfig().dblClickSpeed?++f.clickCount:f.clickCount=1,f.target=h.target,f.timeStamp=e,h.detail=f.clickCount,null!==(c=n.detail)&&void 0!==c&&c.preventClick||(r.context.config.useNativeClickEvent||"mouse"!==h.pointerType&&"touch"!==h.pointerType||r.dispatchEvent(h,"click"),r.dispatchEvent(h,"pointertap")),r.freeEvent(h);}r.freeEvent(n);},this.onPointerMove=function(t){var e=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0),n="mouse"===e.pointerType||"pen"===e.pointerType,i=r.trackingData(t.pointerId),a=r.findMountedTarget(i.overTargets);if(i.overTargets&&a!==e.target){var o="mousemove"===t.type?"mouseout":"pointerout",s=r.createPointerEvent(t,o,a||void 0);if(r.dispatchEvent(s,"pointerout"),n&&r.dispatchEvent(s,"mouseout"),!e.composedPath().includes(a)){var l=r.createPointerEvent(t,"pointerleave",a||void 0);for(l.eventPhase=l.AT_TARGET;l.target&&!e.composedPath().includes(l.target);)l.currentTarget=l.target,r.notifyTarget(l),n&&r.notifyTarget(l,"mouseleave"),rG.isNode(l.target)&&(l.target=l.target.parentNode);r.freeEvent(l);}r.freeEvent(s);}if(a!==e.target){var u="mousemove"===t.type?"mouseover":"pointerover",c=r.clonePointerEvent(e,u);r.dispatchEvent(c,"pointerover"),n&&r.dispatchEvent(c,"mouseover");for(var h=a&&rG.isNode(a)&&a.parentNode;h&&h!==(rG.isNode(r.rootTarget)&&r.rootTarget.parentNode)&&h!==e.target;)h=h.parentNode;if(!h||h===(rG.isNode(r.rootTarget)&&r.rootTarget.parentNode)){var d=r.clonePointerEvent(e,"pointerenter");for(d.eventPhase=d.AT_TARGET;d.target&&d.target!==a&&d.target!==(rG.isNode(r.rootTarget)&&r.rootTarget.parentNode);)d.currentTarget=d.target,r.notifyTarget(d),n&&r.notifyTarget(d,"mouseenter"),rG.isNode(d.target)&&(d.target=d.target.parentNode);r.freeEvent(d);}r.freeEvent(c);}r.dispatchEvent(e,"pointermove"),"touch"===e.pointerType&&r.dispatchEvent(e,"touchmove"),n&&(r.dispatchEvent(e,"mousemove"),r.cursor=r.getCursor(e.target)),i.overTargets=e.composedPath(),r.freeEvent(e);},this.onPointerOut=function(t){var e=r.trackingData(t.pointerId);if(e.overTargets){var n="mouse"===t.pointerType||"pen"===t.pointerType,i=r.findMountedTarget(e.overTargets),a=r.createPointerEvent(t,"pointerout",i||void 0);r.dispatchEvent(a),n&&r.dispatchEvent(a,"mouseout");var o=r.createPointerEvent(t,"pointerleave",i||void 0);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==(rG.isNode(r.rootTarget)&&r.rootTarget.parentNode);)o.currentTarget=o.target,r.notifyTarget(o),n&&r.notifyTarget(o,"mouseleave"),rG.isNode(o.target)&&(o.target=o.target.parentNode);e.overTargets=null,r.freeEvent(a),r.freeEvent(o);}r.cursor=null;},this.onPointerOver=function(t){var e=r.trackingData(t.pointerId),n=r.createPointerEvent(t),i="mouse"===n.pointerType||"pen"===n.pointerType;r.dispatchEvent(n,"pointerover"),i&&r.dispatchEvent(n,"mouseover"),"mouse"===n.pointerType&&(r.cursor=r.getCursor(n.target));var a=r.clonePointerEvent(n,"pointerenter");for(a.eventPhase=a.AT_TARGET;a.target&&a.target!==(rG.isNode(r.rootTarget)&&r.rootTarget.parentNode);)a.currentTarget=a.target,r.notifyTarget(a),i&&r.notifyTarget(a,"mouseenter"),rG.isNode(a.target)&&(a.target=a.target.parentNode);e.overTargets=n.composedPath(),r.freeEvent(n),r.freeEvent(a);},this.onPointerUpOutside=function(t){var e=r.trackingData(t.pointerId),n=r.findMountedTarget(e.pressTargetsByButton[t.button]),i=r.createPointerEvent(t);if(n){for(var a=n;a;)i.currentTarget=a,r.notifyTarget(i,"pointerupoutside"),"touch"===i.pointerType||("mouse"===i.pointerType||"pen"===i.pointerType)&&r.notifyTarget(i,2===i.button?"rightupoutside":"mouseupoutside"),rG.isNode(a)&&(a=a.parentNode);delete e.pressTargetsByButton[t.button];}r.freeEvent(i);},this.onWheel=function(t){var e=r.createWheelEvent(t);r.dispatchEvent(e),r.freeEvent(e);},this.onClick=function(t){if(r.context.config.useNativeClickEvent){var e=r.createPointerEvent(t);r.dispatchEvent(e),r.freeEvent(e);}},this.onPointerCancel=function(t){var e=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);r.dispatchEvent(e),r.freeEvent(e);},this.globalRuntime=e,this.context=n;},[{key:"init",value:function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick);}},{key:"destroy",value:function(){this.mappingTable={},this.mappingState={},this.eventPool.clear();}},{key:"getScale",value:function(){var t=this.context.contextService.getBoundingClientRect(),e=1,n=1,r=this.context.contextService.getDomElement();if(r&&t){var i=r.offsetWidth,a=r.offsetHeight;i&&a&&(e=t.width/i,n=t.height/a);}return{scaleX:e,scaleY:n,bbox:t};}},{key:"client2Viewport",value:function(t){var e=this.getScale(),n=e.scaleX,r=e.scaleY,i=e.bbox;return new tl((t.x-((null==i?void 0:i.left)||0))/n,(t.y-((null==i?void 0:i.top)||0))/r);}},{key:"viewport2Client",value:function(t){var e=this.getScale(),n=e.scaleX,r=e.scaleY,i=e.bbox;return new tl((t.x+((null==i?void 0:i.left)||0))*n,(t.y+((null==i?void 0:i.top)||0))*r);}},{key:"viewport2Canvas",value:function(t){var e=t.x,n=t.y,r=this.rootTarget.defaultView.getCamera(),i=this.context.config,a=i.width,o=i.height,s=r.getPerspectiveInverse(),l=r.getWorldTransform(),u=G.mat4.multiply(this.tmpMatrix,l,s),c=G.vec3.set(this.tmpVec3,e/a*2-1,(1-n/o)*2-1,0);return G.vec3.transformMat4(c,c,u),new tl(c[0],c[1]);}},{key:"canvas2Viewport",value:function(t){var e=this.rootTarget.defaultView.getCamera(),n=e.getPerspective(),r=e.getViewTransform(),i=G.mat4.multiply(this.tmpMatrix,n,r),a=G.vec3.set(this.tmpVec3,t.x,t.y,0);G.vec3.transformMat4(this.tmpVec3,this.tmpVec3,i);var o=this.context.config,s=o.width,l=o.height;return new tl((a[0]+1)/2*s,(1-(a[1]+1)/2)*l);}},{key:"setPickHandler",value:function(t){this.pickHandler=t;}},{key:"addEventMapping",value:function(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort(function(t,e){return t.priority-e.priority;});}},{key:"mapEvent",value:function(t){if(this.rootTarget){var e=this.mappingTable[t.type];if(e)for(var n=0,r=e.length;n<r;n++)e[n].fn(t);else console.warn("[EventService]: Event mapping not defined for ".concat(t.type));}}},{key:"dispatchEvent",value:function(t,e,n){if(n){t.eventPhase=t.AT_TARGET;var r=this.rootTarget.defaultView||null;t.currentTarget=r,this.notifyListeners(t,e);}else t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e);}},{key:"propagate",value:function(t,e){if(t.target){var n=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(var r=n.length-1;r>=1;r--)if(t.currentTarget=n[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!t.propagationStopped&&!t.propagationImmediatelyStopped){var i=n.indexOf(t.currentTarget);t.eventPhase=t.BUBBLING_PHASE;for(var a=i+1;a<n.length;a++)if(t.currentTarget=n[a],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;}}}},{key:"propagationPath",value:function(t){var e=[t],n=this.rootTarget.defaultView||null;if(n&&n===t)return e.unshift(n.document),e;for(var r=0;r<2048&&t!==this.rootTarget;r++)rG.isNode(t)&&t.parentNode&&(e.push(t.parentNode),t=t.parentNode);return n&&e.push(n),e;}},{key:"hitTest",value:function(t){var e=t.viewportX,n=t.viewportY,r=this.context.config,i=r.width,a=r.height,o=r.disableHitTesting;return e<0||n<0||e>i||n>a?null:!o&&this.pickHandler(t)||this.rootTarget||null;}},{key:"isNativeEventFromCanvas",value:function(t,e){var n,r=null==e?void 0:e.target;if(null!==(n=r)&&void 0!==n&&n.shadowRoot&&(r=e.composedPath()[0]),r){if(r===t)return!0;if(t&&t.contains)return t.contains(r);}return null!=e&&!!e.composedPath&&e.composedPath().indexOf(t)>-1;}},{key:"getExistedHTML",value:function(t){if(t.nativeEvent.composedPath)for(var e=0,n=t.nativeEvent.composedPath();e<n.length;e++){var r=n[e],i=this.nativeHTMLMap.get(r);if(i)return i;}return null;}},{key:"pickTarget",value:function(t){return this.hitTest({clientX:t.clientX,clientY:t.clientY,viewportX:t.viewportX,viewportY:t.viewportY,x:t.canvasX,y:t.canvasY});}},{key:"createPointerEvent",value:function(t,e,n,r){var i=this.allocateEvent(rI);this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.nativeEvent=t.nativeEvent,i.originalEvent=t;var a=this.getExistedHTML(i),o=this.context.contextService.getDomElement();return i.target=null!=n?n:a||this.isNativeEventFromCanvas(o,i.nativeEvent)&&this.pickTarget(i)||r,"string"==typeof e&&(i.type=e),i;}},{key:"createWheelEvent",value:function(t){var e=this.allocateEvent(rD);this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t;var n=this.getExistedHTML(e),r=this.context.contextService.getDomElement();return e.target=n||this.isNativeEventFromCanvas(r,e.nativeEvent)&&this.pickTarget(e),e;}},{key:"trackingData",value:function(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t];}},{key:"cloneWheelEvent",value:function(t){var e=this.allocateEvent(rD);return e.nativeEvent=t.nativeEvent,e.originalEvent=t.originalEvent,this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.target=t.target,e.path=t.composedPath().slice(),e.type=t.type,e;}},{key:"clonePointerEvent",value:function(t,e){var n=this.allocateEvent(rI);return n.nativeEvent=t.nativeEvent,n.originalEvent=t.originalEvent,this.copyPointerData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.target=t.target,n.path=t.composedPath().slice(),n.type=null!=e?e:n.type,n;}},{key:"copyPointerData",value:function(t,e){e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist;}},{key:"copyMouseData",value:function(t,e){e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey,e.client.copyFrom(t.client),e.movement.copyFrom(t.movement),e.canvas.copyFrom(t.canvas),e.screen.copyFrom(t.screen),e.global.copyFrom(t.global),e.offset.copyFrom(t.offset);}},{key:"copyWheelData",value:function(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;}},{key:"copyData",value:function(t,e){e.isTrusted=t.isTrusted,e.timeStamp=n2.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.page.copyFrom(t.page),e.viewport.copyFrom(t.viewport);}},{key:"allocateEvent",value:function(t){this.eventPool.has(t)||this.eventPool.set(t,[]);var e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=[],e.target=null,e;}},{key:"freeEvent",value:function(t){if(t.manager!==this)throw Error("It is illegal to free an event not managed by this EventBoundary!");var e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t);}},{key:"notifyTarget",value:function(t,e){e=null!=e?e:t.type;var n=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?"".concat(e,"capture"):e;this.notifyListeners(t,n),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e);}},{key:"notifyListeners",value:function(t,e){var n=t.currentTarget.emitter,r=n._events[e];if(r){if("fn"in r)r.once&&n.removeListener(e,r.fn,void 0,!0),r.fn.call(t.currentTarget||r.context,t);else for(var i=0;i<r.length&&!t.propagationImmediatelyStopped;i++)r[i].once&&n.removeListener(e,r[i].fn,void 0,!0),r[i].fn.call(t.currentTarget||r[i].context,t);}}},{key:"findMountedTarget",value:function(t){if(!t)return null;for(var e=t[t.length-1],n=t.length-2;n>=0;n--){var r=t[n];if(r===this.rootTarget||rG.isNode(r)&&r.parentNode===e)e=t[n];else break;}return e;}},{key:"getCursor",value:function(t){for(var e=t;e;){var n=!!e.getAttribute&&e.getAttribute("cursor");if(n)return n;e=rG.isNode(e)&&e.parentNode;}}}]);var rF=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"getOrCreateCanvas",value:function(t,e){if(this.canvas)return this.canvas;if(t||io.offscreenCanvas)this.canvas=t||io.offscreenCanvas,this.context=this.canvas.getContext("2d",(0,A.default)({willReadFrequently:!0},e));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",(0,A.default)({willReadFrequently:!0},e)),this.context&&this.context.measureText||(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"));}catch(t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",(0,A.default)({willReadFrequently:!0},e));}return this.canvas.width=10,this.canvas.height=10,this.canvas;}},{key:"getOrCreateContext",value:function(t,e){return this.context||this.getOrCreateCanvas(t,e),this.context;}}],[{key:"createCanvas",value:function(){try{return new window.OffscreenCanvas(0,0);}catch(t){}try{return document.createElement("canvas");}catch(t){}return null;}}]),rB=((k={})[k.CAMERA_CHANGED=0]="CAMERA_CHANGED",k[k.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",k[k.NONE=2]="NONE",k);(0,R.default)(function t(e,n){(0,C.default)(this,t),this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new ro,initAsync:new ri,dirtycheck:new rs,cull:new rs,beginFrame:new ro,beforeRender:new ro,render:new ro,afterRender:new ro,endFrame:new ro,destroy:new ro,pick:new ra,pickSync:new rs,pointerDown:new ro,pointerUp:new ro,pointerMove:new ro,pointerOut:new ro,pointerOver:new ro,pointerWheel:new ro,pointerCancel:new ro,click:new ro},this.globalRuntime=e,this.context=n;},[{key:"init",value:function(t){var e=this,n=(0,A.default)((0,A.default)({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach(function(t){t.apply(n,e.globalRuntime);}),this.hooks.init.call(),0===this.hooks.initAsync.getCallbacksNum()?(this.inited=!0,t()):this.hooks.initAsync.promise().then(function(){e.inited=!0,t();}).catch(function(t){});}},{key:"getStats",value:function(){return this.stats;}},{key:"disableDirtyRectangleRendering",value:function(){return!this.context.config.renderer.getConfig().enableDirtyRectangleRendering||this.context.renderingContext.renderReasons.has(rB.CAMERA_CHANGED);}},{key:"render",value:function(t,e,n){var r=this,i=t.getConfig(),a=this.context.renderingContext;if(this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0,this.globalRuntime.sceneGraphService.syncHierarchy(a.root),this.globalRuntime.sceneGraphService.notifyMutationObservers(t),a.renderReasons.size&&this.inited){a.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var o=1===a.renderReasons.size&&a.renderReasons.has(rB.CAMERA_CHANGED),s=!i.disableRenderHooks||!o;s&&this.renderDisplayObject(a.root,i,a),this.hooks.beginFrame.call(e),s&&a.renderListCurrentFrame.forEach(function(t){r.hooks.beforeRender.call(t),r.hooks.render.call(t),r.hooks.afterRender.call(t);}),this.hooks.endFrame.call(e),a.renderListCurrentFrame=[],a.renderReasons.clear(),n();}}},{key:"renderDisplayObject",value:function(t,e,n){for(var r=this,i=e.renderer.getConfig(),a=i.enableDirtyCheck,o=i.enableCulling,s=[t];s.length>0;){var l,u=s.pop();!function(t){var e=t.renderable,i=t.sortable,s=a?e.dirty||n.dirtyRectangleRenderingDisabled?t:null:t,l=null;s&&(l=o?r.hooks.cull.call(s,r.context.camera):s)&&(r.stats.rendered+=1,n.renderListCurrentFrame.push(l)),t.dirty(!1),i.renderOrder=r.zIndexCounter,r.zIndexCounter+=1,r.stats.total+=1,i.dirty&&(r.sort(t,i),i.dirty=!1,i.dirtyChildren=[],i.dirtyReason=void 0);}(u);for(var c=(null===(l=u.sortable)||void 0===l||null===(l=l.sorted)||void 0===l?void 0:l.length)>0?u.sortable.sorted:u.childNodes,h=c.length-1;h>=0;h--)s.push(c[h]);}}},{key:"sort",value:function(t,e){var n,r;(null==e||null===(n=e.sorted)||void 0===n?void 0:n.length)>0&&e.dirtyReason!==tR.Z_INDEX_CHANGED?e.dirtyChildren.forEach(function(n){var r=e.sorted.indexOf(n);if(r>-1&&e.sorted.splice(r,1),t.childNodes.indexOf(n)>-1){if(0===e.sorted.length)e.sorted.push(n);else{var i=function(t,e){for(var n=0,r=t.length;n<r;){var i=n+r>>>1;0>nJ(t[i],e)?n=i+1:r=i;}return n;}(e.sorted,n);e.sorted.splice(i,0,n);}}}):e.sorted=t.childNodes.slice().sort(nJ),(null===(r=e.sorted)||void 0===r?void 0:r.length)>0&&0===t.childNodes.filter(function(t){return t.parsedStyle.zIndex;}).length&&(e.sorted=[]);}},{key:"destroy",value:function(){this.inited=!1,this.hooks.destroy.call();}},{key:"dirty",value:function(){this.context.renderingContext.renderReasons.add(rB.DISPLAY_OBJECT_CHANGED);}}]);var rU=/\[\s*(.*)=(.*)\s*\]/,rV=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"selectOne",value:function(t,e){var n=this;if(t.startsWith("."))return e.find(function(e){return((null==e?void 0:e.classList)||[]).indexOf(n.getIdOrClassname(t))>-1;});if(t.startsWith("#"))return e.find(function(e){return e.id===n.getIdOrClassname(t);});if(t.startsWith("[")){var r=this.getAttribute(t),i=r.name,a=r.value;return i?e.find(function(t){return e!==t&&("name"===i?t.name===a:n.attributeToString(t,i)===a);}):null;}return e.find(function(n){return e!==n&&n.nodeName===t;});}},{key:"selectAll",value:function(t,e){var n=this;if(t.startsWith("."))return e.findAll(function(r){return e!==r&&((null==r?void 0:r.classList)||[]).indexOf(n.getIdOrClassname(t))>-1;});if(t.startsWith("#"))return e.findAll(function(r){return e!==r&&r.id===n.getIdOrClassname(t);});if(t.startsWith("[")){var r=this.getAttribute(t),i=r.name,a=r.value;return i?e.findAll(function(t){return e!==t&&("name"===i?t.name===a:n.attributeToString(t,i)===a);}):[];}return e.findAll(function(n){return e!==n&&n.nodeName===t;});}},{key:"is",value:function(t,e){if(t.startsWith("."))return e.className===this.getIdOrClassname(t);if(t.startsWith("#"))return e.id===this.getIdOrClassname(t);if(t.startsWith("[")){var n=this.getAttribute(t),r=n.name,i=n.value;return"name"===r?e.name===i:this.attributeToString(e,r)===i;}return e.nodeName===t;}},{key:"getIdOrClassname",value:function(t){return t.substring(1);}},{key:"getAttribute",value:function(t){var e=t.match(rU),n="",r="";return e&&e.length>2&&(n=e[1].replace(/"/g,""),r=e[2].replace(/"/g,"")),{name:n,value:r};}},{key:"attributeToString",value:function(t,e){if(!t.getAttribute)return"";var n=t.getAttribute(e);return(0,F.isNil)(n)?"":n.toString?n.toString():"";}}]),rz=((E={}).ATTR_MODIFIED="DOMAttrModified",E.INSERTED="DOMNodeInserted",E.MOUNTED="DOMNodeInsertedIntoDocument",E.REMOVED="removed",E.UNMOUNTED="DOMNodeRemovedFromDocument",E.REPARENT="reparent",E.DESTROY="destroy",E.BOUNDS_CHANGED="bounds-changed",E.CULLED="culled",E),rH=function(t){function e(t,n,r,i,a,o,s,l){var u;return(0,C.default)(this,e),(u=(0,L.default)(this,e,[null])).relatedNode=n,u.prevValue=r,u.newValue=i,u.attrName=a,u.attrChange=o,u.prevParsedValue=s,u.newParsedValue=l,u.type=t,u;}return(0,I.default)(e,t),(0,R.default)(e);}(rO);rH.ADDITION=2,rH.MODIFICATION=1,rH.REMOVAL=3;var rY=new rH(rz.REPARENT,null,"","","",0,"",""),rW=G.vec2.create(),rq=G.vec3.create(),rX=G.vec3.fromValues(1,1,1),rj=G.mat4.create(),r$=G.vec2.create(),rK=G.vec3.create(),rZ=G.mat4.create(),rQ=G.quat.create(),rJ=G.vec3.create(),r0=G.quat.create(),r1=G.vec3.create(),r2=G.vec3.create(),r3=G.vec3.create(),r4=G.mat4.create(),r5=G.quat.create(),r6=G.quat.create(),r7=G.quat.create(),r9=(0,R.default)(function t(e){(0,C.default)(this,t),this.displayObjectDependencyMap=new WeakMap,this.runtime=e;},[{key:"matches",value:function(t,e){return this.runtime.sceneGraphSelector.is(t,e);}},{key:"querySelector",value:function(t,e){return this.runtime.sceneGraphSelector.selectOne(t,e);}},{key:"querySelectorAll",value:function(t,e){return this.runtime.sceneGraphSelector.selectAll(t,e);}},{key:"attach",value:function(t,e,n){var r=!1;t.parentNode&&(r=t.parentNode!==e,this.detach(t));var i=t.nodeName===j.FRAGMENT,a=n3(e);t.parentNode=e;var o=i?t.childNodes:[t];(0,F.isNumber)(n)?o.forEach(function(t){e.childNodes.splice(n,0,t),t.parentNode=e;}):o.forEach(function(t){e.childNodes.push(t),t.parentNode=e;});var s=e.sortable;if((null!=s&&null!==(u=s.sorted)&&void 0!==u&&u.length||s.dirty||t.parsedStyle.zIndex)&&(-1===s.dirtyChildren.indexOf(t)&&s.dirtyChildren.push(t),s.dirty=!0,s.dirtyReason=tR.ADDED),!a){if(i)this.dirtyFragment(t);else{var l=t.transformable;l&&this.dirtyWorldTransform(t,l);}if(r){var u,c,h=(null===(c=e.ownerDocument)||void 0===c||null===(c=c.defaultView)||void 0===c||null===(c=c.getConfig())||void 0===c||null===(c=c.future)||void 0===c?void 0:c.experimentalCancelEventPropagation)===!0;t.dispatchEvent(rY,h,h);}}}},{key:"detach",value:function(t){if(t.parentNode){var e,n,r=t.transformable,i=t.parentNode.sortable;(null!=i&&null!==(e=i.sorted)&&void 0!==e&&e.length||null!==(n=t.style)&&void 0!==n&&n.zIndex)&&(-1===i.dirtyChildren.indexOf(t)&&i.dirtyChildren.push(t),i.dirty=!0,i.dirtyReason=tR.REMOVED);var a=t.parentNode.childNodes.indexOf(t);a>-1&&t.parentNode.childNodes.splice(a,1),r&&this.dirtyWorldTransform(t,r),t.parentNode=null;}}},{key:"getLocalPosition",value:function(t){return t.transformable.localPosition;}},{key:"getLocalRotation",value:function(t){return t.transformable.localRotation;}},{key:"getLocalScale",value:function(t){return t.transformable.localScale;}},{key:"getLocalSkew",value:function(t){return t.transformable.localSkew;}},{key:"getLocalTransform",value:function(t){var e=t.transformable;return tD(e),e.localTransform;}},{key:"setLocalPosition",value:function(t,e){var n,r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=t.transformable;r2[0]=e[0],r2[1]=e[1],r2[2]=null!==(n=e[2])&&void 0!==n?n:0,!G.vec3.equals(i.localPosition,r2)&&(G.vec3.copy(i.localPosition,r2),r&&this.dirtyLocalTransform(t,i));}},{key:"translateLocal",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var i=t.transformable;G.vec3.equals(e,rq)||(G.vec3.transformQuat(e,e,i.localRotation),G.vec3.add(i.localPosition,i.localPosition,e),this.dirtyLocalTransform(t,i));}},{key:"setLocalRotation",value:function(t,e,n,r,i){var a=!(arguments.length>5)||void 0===arguments[5]||arguments[5];"number"==typeof e&&(e=G.quat.set(rQ,e,n,r,i));var o=t.transformable;G.quat.copy(o.localRotation,e),a&&this.dirtyLocalTransform(t,o);}},{key:"rotateLocal",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var i=t.transformable;G.quat.fromEuler(r6,e[0],e[1],e[2]),G.quat.mul(i.localRotation,i.localRotation,r6),this.dirtyLocalTransform(t,i);}},{key:"setLocalScale",value:function(t,e){var n,r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=t.transformable;G.vec3.set(rK,e[0],e[1],null!==(n=e[2])&&void 0!==n?n:i.localScale[2]),!G.vec3.equals(rK,i.localScale)&&(G.vec3.copy(i.localScale,rK),r&&this.dirtyLocalTransform(t,i));}},{key:"scaleLocal",value:function(t,e){var n,r=t.transformable;G.vec3.multiply(r.localScale,r.localScale,G.vec3.set(rK,e[0],e[1],null!==(n=e[2])&&void 0!==n?n:1)),this.dirtyLocalTransform(t,r);}},{key:"setLocalSkew",value:function(t,e,n){var r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];"number"==typeof e&&(e=G.vec2.set(r$,e,n));var i=t.transformable;G.vec2.copy(i.localSkew,e),r&&this.dirtyLocalTransform(t,i);}},{key:"setLocalEulerAngles",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=!(arguments.length>4)||void 0===arguments[4]||arguments[4];"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var a=t.transformable;G.quat.fromEuler(a.localRotation,e[0],e[1],e[2]),i&&this.dirtyLocalTransform(t,a);}},{key:"setLocalTransform",value:function(t,e){var n=G.mat4.getTranslation(rJ,e),r=G.mat4.getRotation(r0,e),i=G.mat4.getScaling(r1,e);this.setLocalScale(t,i,!1),this.setLocalPosition(t,n,!1),this.setLocalRotation(t,r,void 0,void 0,void 0,!1),this.dirtyLocalTransform(t,t.transformable);}},{key:"resetLocalTransform",value:function(t){this.setLocalScale(t,rX,!1),this.setLocalPosition(t,rq,!1),this.setLocalEulerAngles(t,rq,void 0,void 0,!1),this.setLocalSkew(t,rW,void 0,!1),this.dirtyLocalTransform(t,t.transformable);}},{key:"getPosition",value:function(t){var e=t.transformable;return G.mat4.getTranslation(e.position,this.getWorldTransform(t,e));}},{key:"getRotation",value:function(t){var e=t.transformable;return G.mat4.getRotation(e.rotation,this.getWorldTransform(t,e));}},{key:"getScale",value:function(t){var e=t.transformable;return G.mat4.getScaling(e.scaling,this.getWorldTransform(t,e));}},{key:"getOrigin",value:function(t){return t.getGeometryBounds(),t.transformable.origin;}},{key:"getWorldTransform",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.transformable;return(e.localDirtyFlag||e.dirtyFlag)&&(t.parentNode&&t.parentNode.transformable&&this.getWorldTransform(t.parentNode),this.internalUpdateTransform(t)),e.worldTransform;}},{key:"setPosition",value:function(t,e){var n,r=t.transformable;if(r3[0]=e[0],r3[1]=e[1],r3[2]=null!==(n=e[2])&&void 0!==n?n:0,!G.vec3.equals(this.getPosition(t),r3)){if(G.vec3.copy(r.position,r3),null!==t.parentNode&&t.parentNode.transformable){var i=t.parentNode.transformable;G.mat4.copy(r4,i.worldTransform),G.mat4.invert(r4,r4),G.vec3.transformMat4(r.localPosition,r3,r4);}else G.vec3.copy(r.localPosition,r3);this.dirtyLocalTransform(t,r);}}},{key:"translate",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.set(rK,e,n,r)),G.vec3.equals(e,rq)||(G.vec3.add(rK,this.getPosition(t),e),this.setPosition(t,rK));}},{key:"setRotation",value:function(t,e,n,r,i){var a=t.transformable;if("number"==typeof e&&(e=G.quat.fromValues(e,n,r,i)),null!==t.parentNode&&t.parentNode.transformable){var o=this.getRotation(t.parentNode);G.quat.copy(rQ,o),G.quat.invert(rQ,rQ),G.quat.multiply(a.localRotation,rQ,e),G.quat.normalize(a.localRotation,a.localRotation),this.dirtyLocalTransform(t,a);}else this.setLocalRotation(t,e);}},{key:"rotate",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var i=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){G.quat.fromEuler(rQ,e[0],e[1],e[2]);var a=this.getRotation(t),o=this.getRotation(t.parentNode);G.quat.copy(r7,o),G.quat.invert(r7,r7),G.quat.multiply(rQ,r7,rQ),G.quat.multiply(i.localRotation,rQ,a),G.quat.normalize(i.localRotation,i.localRotation),this.dirtyLocalTransform(t,i);}else this.rotateLocal(t,e);}},{key:"setOrigin",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=[e,n,r]);var i=t.transformable;if(e[0]!==i.origin[0]||e[1]!==i.origin[1]||e[2]!==i.origin[2]){var a=i.origin;a[0]=e[0],a[1]=e[1],a[2]=e[2]||0,this.dirtyLocalTransform(t,i);}}},{key:"setEulerAngles",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var i=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){G.quat.fromEuler(i.localRotation,e[0],e[1],e[2]);var a=this.getRotation(t.parentNode);G.quat.copy(r5,G.quat.invert(rQ,a)),G.quat.mul(i.localRotation,i.localRotation,r5),this.dirtyLocalTransform(t,i);}else this.setLocalEulerAngles(t,e);}},{key:"getGeometryBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.geometry;return n.dirty&&io.styleValueRegistry.updateGeometry(t),(e?n.renderBounds:n.contentBounds||null)||new ti;}},{key:"getTransformedGeometryBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this.getGeometryBounds(t,e);if(!ti.isEmpty(r)){var i=n||new ti;return i.setFromTransformedAABB(r,this.getWorldTransform(t)),i;}return null;}},{key:"getBounds",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t.renderable;if(!r.boundsDirty&&!n&&r.bounds)return r.bounds;if(!r.renderBoundsDirty&&n&&r.renderBounds)return r.renderBounds;var i=n?r.renderBounds:r.bounds,a=this.getTransformedGeometryBounds(t,n,i);if(t.childNodes.forEach(function(t){var r=e.getBounds(t,n);r&&(a?a.add(r):(a=i||new ti).update(r.center,r.halfExtents));}),a||(a=new ti),n){var o=function(t){var e,n=t;do{if(null===(e=n.parsedStyle)||void 0===e?void 0:e.clipPath)return n;n=n.parentElement;}while(null!==n)return null;}(t);if(o){var s=o.parsedStyle.clipPath.getBounds(n);a?s&&(a=s.intersection(a)):a.update(s.center,s.halfExtents);}}return n?(r.renderBounds=a,r.renderBoundsDirty=!1):(r.bounds=a,r.boundsDirty=!1),a;}},{key:"getLocalBounds",value:function(t){if(t.parentNode){var e=rj;t.parentNode.transformable&&(e=G.mat4.invert(rZ,this.getWorldTransform(t.parentNode)));var n=this.getBounds(t);if(!ti.isEmpty(n)){var r=new ti;return r.setFromTransformedAABB(n,e),r;}}return this.getBounds(t);}},{key:"getBoundingClientRect",value:function(t){var e,n,r=this.getGeometryBounds(t);ti.isEmpty(r)||(n=new ti).setFromTransformedAABB(r,this.getWorldTransform(t));var i=null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e?void 0:e.getContextService().getBoundingClientRect();if(n){var a=n.getMin(),o=(0,D.default)(a,2),s=o[0],l=o[1],u=n.getMax(),c=(0,D.default)(u,2),h=c[0],d=c[1];return new tu(s+((null==i?void 0:i.left)||0),l+((null==i?void 0:i.top)||0),h-s,d-l);}return new tu((null==i?void 0:i.left)||0,(null==i?void 0:i.top)||0,0,0);}},{key:"internalUpdateTransform",value:function(t){var e,n,r=null===(n=t.parentNode)||void 0===n?void 0:n.transformable;tD(t.transformable),(e=t.transformable).dirtyFlag&&(r?G.mat4.multiply(e.worldTransform,r.worldTransform,e.localTransform):G.mat4.copy(e.worldTransform,e.localTransform),e.dirtyFlag=!1);}},{key:"internalUpdateElement",value:function(t,e){var n=(null===(s=t.ownerDocument)||void 0===s||null===(s=s.defaultView)||void 0===s||null===(s=s.getConfig())||void 0===s||null===(s=s.future)||void 0===s?void 0:s.experimentalAttributeUpdateOptimization)===!0,r=e[e.length-1],i=(null==r?void 0:r.transformDirty)||(null===(l=t.transformable)||void 0===l?void 0:l.localDirtyFlag);t.transformable&&((h=t.transformable).dirtyFlag||(h.dirtyFlag=i)),this.internalUpdateTransform(t),i&&(null===(d=t.dirty)||void 0===d||d.call(t,!0,!0));var a=(null===(u=t.renderable)||void 0===u?void 0:u.boundsDirty)||(null===(c=t.renderable)||void 0===c?void 0:c.renderBoundsDirty);if((i||a)&&(null==r?void 0:r.shapeUpdated)===!1&&n)for(var o=e.length-1;o>=0;){var s,l,u,c,h,d,f,v,p=e[o];if(p.shapeUpdated)break;null===(f=(v=p.node).dirty)||void 0===f||f.call(v,!0,!0),p.shapeUpdated=!0,o-=1;}return i;}},{key:"syncHierarchy",value:function(t){for(var e,n,r=[t],i=t.parentNode?[{node:t.parentNode,transformDirty:(null===(e=t.parentNode.transformable)||void 0===e?void 0:e.localDirtyFlag)||(null===(n=t.parentNode.transformable)||void 0===n?void 0:n.dirtyFlag),shapeUpdated:!1}]:[];r.length>0;){for(var a=r.pop(),o=i[i.length-1];i.length>0&&a.parentNode!==o.node;)o=i.pop();var s=this.internalUpdateElement(a,i);if(a.childNodes.length>0){for(var l=a.childNodes.length-1;l>=0;l--)r.push(a.childNodes[l]);i.push({node:a,transformDirty:s,shapeUpdated:!1});}}}},{key:"dirtyLocalTransform",value:function(t,e){n3(t)||e.localDirtyFlag||(e.localDirtyFlag=!0,e.dirtyFlag||this.dirtyWorldTransform(t,e));}},{key:"dirtyWorldTransform",value:function(t,e){this.dirtyWorldInternal(t,e),this.dirtyToRoot(t,!0);}},{key:"dirtyWorldInternal",value:function(t,e){var n,r=this,i=(null===(n=t.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n||null===(n=n.getConfig())||void 0===n||null===(n=n.future)||void 0===n?void 0:n.experimentalAttributeUpdateOptimization)===!0;e.dirtyFlag||(e.dirtyFlag=!0,t.dirty(!0,!0),i||t.childNodes.forEach(function(t){var e=t.transformable;r.dirtyWorldInternal(t,e);}));}},{key:"dirtyToRoot",value:function(t){for(var e,n,r,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=t,o=(null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig())||void 0===e||null===(e=e.future)||void 0===e?void 0:e.experimentalAttributeUpdateOptimization)===!0;a&&(null===(n=(r=a).dirty)||void 0===n||n.call(r,!0,!0),!o);)a=a.parentNode;i&&t.forEach(function(t){var e;null===(e=t.dirty)||void 0===e||e.call(t,!0,!0);}),this.informDependentDisplayObjects(t);var s=t.mutations||[],l=s.find(function(t){return"attributes"===t.type&&t._boundsChangeData;});l?l._boundsChangeData={affectChildren:l._boundsChangeData.affectChildren||i}:(l={type:"attributes",target:t,_boundsChangeData:{affectChildren:i}},s.push(l)),t.mutations=s;}},{key:"dirtyFragment",value:function(t){var e,n=t.transformable;n&&(n.dirtyFlag=!0,n.localDirtyFlag=!0),null===(e=t.dirty)||void 0===e||e.call(t,!0,!0);for(var r=t.childNodes.length,i=0;i<r;i++)this.dirtyFragment(t.childNodes[i]);}},{key:"notifyMutationObservers",value:function(t){var e=new Set;if(t.getRoot().forEach(function(t){(t.mutations||[]).forEach(function(n){"attributes"===n.type&&n._boundsChangeData&&(n._boundsChangeData.affectChildren?t.forEach(function(t){var r=(0,A.default)({},n);r.target=t,e.add(r);}):e.add(n));}),t.mutations=void 0;}),e.size>0){var n=new r_(rz.BOUNDS_CHANGED,{detail:Array.from(e)});t.dispatchEvent(n,!0,!0);}}},{key:"updateDisplayObjectDependency",value:function(t,e,n,r){if(e&&e!==n){var i=this.displayObjectDependencyMap.get(e);if(i&&i[t]){var a=i[t].indexOf(r);i[t].splice(a,1);}}if(n){var o=this.displayObjectDependencyMap.get(n);o||(this.displayObjectDependencyMap.set(n,{}),o=this.displayObjectDependencyMap.get(n)),o[t]||(o[t]=[]),o[t].push(r);}}},{key:"informDependentDisplayObjects",value:function(t){var e,n=this,r=this.displayObjectDependencyMap.get(t);if(r){var i=null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig())||void 0===e||null===(e=e.future)||void 0===e?void 0:e.experimentalCancelEventPropagation;Object.keys(r).forEach(function(t){r[t].forEach(function(e){n.dirtyToRoot(e,!0),e.dispatchEvent(new rH(rz.ATTR_MODIFIED,e,n,n,t,rH.MODIFICATION,n,n),i,i),e.isCustomElement&&e.isConnected&&e.attributeChangedCallback&&e.attributeChangedCallback(t,n,n);});});}}}]),r8=(0,R.default)(function t(e){if((0,C.default)(this,t),e<=0)throw Error("LRU capacity must be a positive number.");this.capacity=e,this.cache=new Map;},[{key:"get",value:function(t){if(this.cache.has(t)){var e=this.cache.get(t);return this.cache.delete(t),this.cache.set(t,e),e;}}},{key:"put",value:function(t,e){if(this.cache.has(t)&&this.cache.delete(t),this.cache.set(t,e),this.cache.size>this.capacity){var n=this.cache.keys().next().value;this.cache.delete(n);}}},{key:"len",value:function(){return this.cache.size;}},{key:"clear",value:function(){this.cache.clear();}}]),it={MetricsString:"|\xc9q\xc5",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},ie=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,ir=new RegExp("".concat(/[!%),.:;?\]}'""]/.source,"|").concat(/[!),.:;?\]}'""]/.source,"|").concat(/[)\]'"?!:;,.]/.source,"|").concat(/[!%),.:;?\]}'"]/.source)),ii=new RegExp("".concat(/[$('"]/.source,"|").concat(/[([{'"]/.source,"|").concat(/[(['"...]/.source,"|").concat(/[$([{'"#]/.source)),ia=(0,R.default)(function t(e){var n=this;(0,C.default)(this,t),this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(t,e){return!n.isBreakingSpace(e)&&!!(t&&(ii.exec(e)||ir.exec(t)));},this.trimByKinsokuShorui=function(t){var e=(0,O.default)(t),n=e[e.length-2];if(!n)return t;var r=n[n.length-1];return e[e.length-2]=n.slice(0,-1),e[e.length-1]=r+e[e.length-1],e;},this.runtime=e,this.charWidthCache=new r8(100);},[{key:"measureFont",value:function(t,e){if(this.fontMetricsCache[t])return this.fontMetricsCache[t];var n={ascent:0,descent:0,fontSize:0},r=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(e),i=this.runtime.offscreenCanvasCreator.getOrCreateContext(e,{willReadFrequently:!0});i.font=t;var a=it.MetricsString+it.BaselineSymbol,o=Math.ceil(i.measureText(a).width),s=Math.ceil(i.measureText(it.BaselineSymbol).width),l=it.HeightMultiplier*s;s=s*it.BaselineMultiplier|0,r.width=o,r.height=l,i.fillStyle="#f00",i.fillRect(0,0,o,l),i.font=t,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(a,0,s);var u=i.getImageData(0,0,o||1,l||1).data,c=u.length,h=4*o,d=0,f=0,v=!1;for(d=0;d<s;++d){for(var p=0;p<h;p+=4)if(255!==u[f+p]){v=!0;break;}if(v)break;f+=h;}for(n.ascent=s-d,f=c-h,v=!1,d=l;d>s;--d){for(var g=0;g<h;g+=4)if(255!==u[f+g]){v=!0;break;}if(v)break;f-=h;}return n.descent=d-s,n.fontSize=n.ascent+n.descent,this.fontMetricsCache[t]=n,n;}},{key:"measureText",value:function(t,e,n){var r=e.fontSize,i=void 0===r?16:r,a=e.wordWrap,o=e.lineHeight,s=e.lineWidth,l=void 0===s?1:s,u=e.textBaseline,c=void 0===u?"alphabetic":u,h=e.textAlign,d=void 0===h?"start":h,f=e.letterSpacing,v=void 0===f?0:f,p=e.textPath;e.textPathSide,e.textPathStartOffset;var g=e.leading,y=void 0===g?0:g,m=rh(e),k=this.measureFont(m,n);0===k.fontSize&&(k.fontSize=i,k.ascent=i);var E=this.runtime.offscreenCanvasCreator.getOrCreateContext(n);E.font=m,e.isOverflowing=!1;var x=(void 0!==a&&a?this.wordWrap(t,e,n):t).split(/(?:\r\n|\r|\n)/),T=Array(x.length),N=0;if(p){p.getTotalLength();for(var b=0;b<x.length;b++)E.measureText(x[b]).width,x[b].length;}else{for(var S=0;S<x.length;S++){var w=E.measureText(x[S]).width+(x[S].length-1)*v;T[S]=w,N=Math.max(N,w);}var P=N+l,M=o||k.fontSize+l,A=Math.max(M,k.fontSize+l)+(x.length-1)*(M+y);M+=y;var C=0;return"middle"===c?C=-A/2:"bottom"===c||"alphabetic"===c||"ideographic"===c?C=-A:("top"===c||"hanging"===c)&&(C=0),{font:m,width:P,height:A,lines:x,lineWidths:T,lineHeight:M,maxLineWidth:N,fontProperties:k,lineMetrics:T.map(function(t,e){var n=0;return"center"===d||"middle"===d?n-=t/2:("right"===d||"end"===d)&&(n-=t),new tu(n-l/2,C+e*M,t+l,M);})};}}},{key:"wordWrap",value:function(t,e,n){var r=this,i=Array.from(t);if(0===i.length)return"";var a=this,o=e.wordWrapWidth,s=e.letterSpacing,l=void 0===s?0:s,u=e.maxLines,c=void 0===u?1/0:u,h=e.textOverflow,d=this.runtime.offscreenCanvasCreator.getOrCreateContext(n),f=(void 0===o?0:o)+l,v="";"ellipsis"===h?v="...":h&&"clip"!==h&&(v=h);var p=[""],g=0,y=0,m=-1,k=rh(e),E=this.charWidthCache.get(k);E||(E=new r8(500),this.charWidthCache.put(k,E));var x=function(t){return r.getFromCache(t,l,E,d);},T=x(v);function N(t,e,n,r){for(;x(t)<r&&e<i.length-1&&!a.isNewline(i[e+1]);)e+=1,t+=i[e];for(;x(t)>r&&e>=n;)e-=1,t=t.slice(0,-1);return{lineTxt:t,txtLastCharIndex:e};}function b(t,e){if(!(T<=0)&&!(T>f)){if(!p[t]){p[t]=v;return;}var n=N(p[t],e,m+1,f-T);p[t]=n.lineTxt+v;}}for(var S=0;S<i.length;S++){var w=i[S],P=i[S-1],M=i[S+1],A=x(w);if(this.isNewline(w)){if(g+1>=c){S<i.length-1&&b(g,S-1),e.isOverflowing=!0;break;}m=S-1,y=0,p[g+=1]="";continue;}if(A>f){b(g,S-1),e.isOverflowing=!0;break;}if(y>0&&y+A>f){var C=N(p[g],S-1,m+1,f);if(C.txtLastCharIndex!==S-1){if(p[g]=C.lineTxt,C.txtLastCharIndex===i.length-1)break;w=i[S=C.txtLastCharIndex+1],P=i[S-1],M=i[S+1],A=x(w);}if(g+1>=c){b(g,S-1),e.isOverflowing=!0;break;}if(m=S-1,y=0,p[g+=1]="",this.isBreakingSpace(w))continue;this.canBreakInLastChar(w)||(p=this.trimToBreakable(p),y=this.sumTextWidthByCache(p[g]||"",x)),this.shouldBreakByKinsokuShorui(w,M)&&(p=this.trimByKinsokuShorui(p),y+=x(P||""));}y+=A,p[g]+=w;}return p.join("\n");}},{key:"isBreakingSpace",value:function(t){return"string"==typeof t&&it.BreakingSpaces.indexOf(t.charCodeAt(0))>=0;}},{key:"isNewline",value:function(t){return"string"==typeof t&&it.Newlines.indexOf(t.charCodeAt(0))>=0;}},{key:"trimToBreakable",value:function(t){var e=(0,O.default)(t),n=e[e.length-2],r=this.findBreakableIndex(n);if(-1===r||!n)return e;var i=n.slice(r,r+1),a=this.isBreakingSpace(i);return e[e.length-1]+=n.slice(r+1,n.length),e[e.length-2]=n.slice(0,r+(a?0:1)),e;}},{key:"canBreakInLastChar",value:function(t){return!(t&&ie.test(t));}},{key:"sumTextWidthByCache",value:function(t,e){return t.split("").reduce(function(t,n){return t+e(n);},0);}},{key:"findBreakableIndex",value:function(t){for(var e=t.length-1;e>=0;e--)if(!ie.test(t[e]))return e;return -1;}},{key:"getFromCache",value:function(t,e,n,r){var i=n.get(t);if("number"!=typeof i){var a=t.length*e;i=r.measureText(t).width+a,n.put(t,i);}return i;}},{key:"clearCache",value:function(){this.fontMetricsCache={},this.charWidthCache.clear();}}]),io={},is=(T=new rM,N=new rP,x={},(0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)(x,j.FRAGMENT,null),j.CIRCLE,new rN),j.ELLIPSE,new rb),j.RECT,T),j.IMAGE,T),j.GROUP,new rC),j.LINE,new rS),j.TEXT,new rA(io)),j.POLYLINE,N),j.POLYGON,N),(0,B.default)((0,B.default)((0,B.default)(x,j.PATH,new rw),j.HTML,new rR),j.MESH,null)),il=(S=new nG,w=new nU,b={},(0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)(b,tG.PERCENTAGE,null),tG.NUMBER,new nY),tG.ANGLE,new nD),tG.DEFINED_PATH,new n_),tG.PAINT,S),tG.COLOR,S),tG.FILTER,new nF),tG.LENGTH,w),tG.LENGTH_PERCENTAGE,w),tG.LENGTH_PERCENTAGE_12,new nV),(0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)(b,tG.LENGTH_PERCENTAGE_14,new nz),tG.COORDINATE,new nU),tG.OFFSET_DISTANCE,new nW),tG.OPACITY_VALUE,new nq),tG.PATH,new nX),tG.LIST_OF_POINTS,new nj),tG.SHADOW_BLUR,new n$),tG.TEXT,new nK),tG.TEXT_TRANSFORM,new nZ),tG.TRANSFORM,new rE),(0,B.default)((0,B.default)((0,B.default)(b,tG.TRANSFORM_ORIGIN,new rx),tG.Z_INDEX,new rT),tG.MARKER,new nH));io.CameraContribution=tA,io.AnimationTimeline=null,io.EasingFunction=null,io.offscreenCanvasCreator=new rF,io.sceneGraphSelector=new rV,io.sceneGraphService=new r9(io),io.textService=new ia(io),io.geometryUpdaterFactory=is,io.CSSPropertySyntaxFactory=il,io.styleValueRegistry=new nL(io),io.layoutRegistry=null,io.globalThis="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==X?X:{},io.enableStyleSyntax=!0,io.enableSizeAttenuation=!1;var iu=0,ic=new rH(rz.INSERTED,null,"","","",0,"",""),ih=new rH(rz.REMOVED,null,"","","",0,"",""),id=new r_(rz.DESTROY),iv=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).entity=iu++,t.transformable={dirtyFlag:!1,localDirtyFlag:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},t.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},t.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},t.cullable={strategy:tC.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},t.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},t.rBushNode={aabb:void 0},t.namespaceURI="g",t.scrollLeft=0,t.scrollTop=0,t.clientTop=0,t.clientLeft=0,t.style={},t.computedStyle={},t.parsedStyle={},t.attributes={},t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"dirty",value:function(){var t=!(arguments.length>0)||void 0===arguments[0]||arguments[0],e=arguments.length>1?arguments[1]:void 0;this.renderable.dirty=t,void 0!==e&&(this.renderable.boundsDirty=e,this.renderable.renderBoundsDirty=e,this.geometry.dirty=e);}},{key:"className",get:function(){return this.getAttribute("class")||"";},set:function(t){this.setAttribute("class",t);}},{key:"classList",get:function(){return this.className.split(" ").filter(function(t){return""!==t;});}},{key:"tagName",get:function(){return this.nodeName;}},{key:"children",get:function(){return this.childNodes;}},{key:"childElementCount",get:function(){return this.childNodes.length;}},{key:"firstElementChild",get:function(){return this.firstChild;}},{key:"lastElementChild",get:function(){return this.lastChild;}},{key:"parentElement",get:function(){return this.parentNode;}},{key:"nextSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t+1]||null;}return null;}},{key:"previousSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t-1]||null;}return null;}},{key:"cloneNode",value:function(t){throw Error(tc);}},{key:"appendChild",value:function(t,e){var n;if(t.destroyed)throw Error("Cannot append a destroyed element.");return io.sceneGraphService.attach(t,this,e),null!==(n=this.ownerDocument)&&void 0!==n&&n.defaultView&&(n3(this)||t.nodeName!==j.FRAGMENT?this.ownerDocument.defaultView.mountChildren(t):this.ownerDocument.defaultView.mountFragment(t)),this.isMutationObserved&&(ic.relatedNode=this,t.dispatchEvent(ic)),t;}},{key:"insertBefore",value:function(t,e){if(e){t.parentElement&&t.parentElement.removeChild(t);var n=this.childNodes.indexOf(e);-1===n?this.appendChild(t):this.appendChild(t,n);}else this.appendChild(t);return t;}},{key:"replaceChild",value:function(t,e){var n=this.childNodes.indexOf(e);return this.removeChild(e),this.appendChild(t,n),e;}},{key:"removeChild",value:function(t){var e,n,r=(null===(e=this.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig().future)||void 0===e?void 0:e.experimentalCancelEventPropagation)===!0;return ih.relatedNode=this,t.dispatchEvent(ih,r,r),null!==(n=t.ownerDocument)&&void 0!==n&&n.defaultView&&t.ownerDocument.defaultView.unmountChildren(t),io.sceneGraphService.detach(t),t;}},{key:"removeChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var e=this.childNodes[t];this.removeChild(e);}}},{key:"destroyChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var e=this.childNodes[t];e.childNodes.length>0&&e.destroyChildren(),e.destroy();}}},{key:"matches",value:function(t){return io.sceneGraphService.matches(t,this);}},{key:"getElementById",value:function(t){return io.sceneGraphService.querySelector("#".concat(t),this);}},{key:"getElementsByName",value:function(t){return io.sceneGraphService.querySelectorAll('[name="'.concat(t,'"]'),this);}},{key:"getElementsByClassName",value:function(t){return io.sceneGraphService.querySelectorAll(".".concat(t),this);}},{key:"getElementsByTagName",value:function(t){return io.sceneGraphService.querySelectorAll(t,this);}},{key:"querySelector",value:function(t){return io.sceneGraphService.querySelector(t,this);}},{key:"querySelectorAll",value:function(t){return io.sceneGraphService.querySelectorAll(t,this);}},{key:"closest",value:function(t){var e=this;do{if(io.sceneGraphService.matches(t,e))return e;e=e.parentElement;}while(null!==e)return null;}},{key:"find",value:function(t){var e=this,n=null;return this.forEach(function(r){return!(r!==e&&t(r))||(n=r,!1);}),n;}},{key:"findAll",value:function(t){var e=this,n=[];return this.forEach(function(r){r!==e&&t(r)&&n.push(r);}),n;}},{key:"after",value:function(){var t=this;if(this.parentNode){for(var e=this.parentNode.childNodes.indexOf(this),n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];r.forEach(function(n,r){var i;return null===(i=t.parentNode)||void 0===i?void 0:i.appendChild(n,e+r+1);});}}},{key:"before",value:function(){if(this.parentNode){for(var t=this.parentNode.childNodes.indexOf(this),e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n[0],a=(0,V.default)(n).slice(1);this.parentNode.appendChild(i,t),i.after.apply(i,(0,O.default)(a));}}},{key:"replaceWith",value:function(){this.after.apply(this,arguments),this.remove();}},{key:"append",value:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(function(e){return t.appendChild(e);});}},{key:"prepend",value:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(function(e,n){return t.appendChild(e,n);});}},{key:"replaceChildren",value:function(){for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,arguments);}},{key:"remove",value:function(){return this.parentNode?this.parentNode.removeChild(this):this;}},{key:"destroy",value:function(){var t,e=(null===(t=this.ownerDocument)||void 0===t||null===(t=t.defaultView)||void 0===t||null===(t=t.getConfig().future)||void 0===t?void 0:t.experimentalCancelEventPropagation)===!0;this.destroyChildren(),this.dispatchEvent(id,e,e),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0;}},{key:"getGeometryBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return io.sceneGraphService.getGeometryBounds(this,t);}},{key:"getTransformedGeometryBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return io.sceneGraphService.getTransformedGeometryBounds(this,t);}},{key:"getBounds",value:function(){return io.sceneGraphService.getBounds(this);}},{key:"getRenderBounds",value:function(){return io.sceneGraphService.getBounds(this,!0);}},{key:"getLocalBounds",value:function(){return io.sceneGraphService.getLocalBounds(this);}},{key:"getBoundingClientRect",value:function(){return io.sceneGraphService.getBoundingClientRect(this);}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()];}},{key:"computedStyleMap",value:function(){return new Map(Object.entries(this.computedStyle));}},{key:"getAttributeNames",value:function(){return Object.keys(this.attributes);}},{key:"getAttribute",value:function(t){if("symbol"!=typeof t)return this.attributes[t];}},{key:"hasAttribute",value:function(t){return this.getAttributeNames().includes(t);}},{key:"hasAttributes",value:function(){return!!this.getAttributeNames().length;}},{key:"removeAttribute",value:function(t){this.setAttribute(t,null),delete this.attributes[t];}},{key:"setAttribute",value:function(t,e){this.attributes[t]=e;}},{key:"getAttributeNS",value:function(t,e){throw Error(tc);}},{key:"getAttributeNode",value:function(t){throw Error(tc);}},{key:"getAttributeNodeNS",value:function(t,e){throw Error(tc);}},{key:"hasAttributeNS",value:function(t,e){throw Error(tc);}},{key:"removeAttributeNS",value:function(t,e){throw Error(tc);}},{key:"removeAttributeNode",value:function(t){throw Error(tc);}},{key:"setAttributeNS",value:function(t,e,n){throw Error(tc);}},{key:"setAttributeNode",value:function(t){throw Error(tc);}},{key:"setAttributeNodeNS",value:function(t){throw Error(tc);}},{key:"toggleAttribute",value:function(t,e){throw Error(tc);}}]);}(rG);function ip(t){return!!(null!=t&&t.nodeName);}var ig=io.globalThis.Proxy?io.globalThis.Proxy:function(){},iy=new rH(rz.ATTR_MODIFIED,null,null,null,null,rH.MODIFICATION,null,null),im=G.vec3.create(),ik=G.quat.create(),iE=function(t){function e(t){var n;return(0,C.default)(this,e),(n=(0,L.default)(this,e)).isCustomElement=!1,n.isMutationObserved=!1,n.activeAnimations=[],n.config=t,n.id=t.id||"",n.name=t.name||"",(t.className||t.class)&&(n.className=t.className||t.class),n.nodeName=t.type||j.GROUP,t.initialParsedStyle&&Object.assign(n.parsedStyle,t.initialParsedStyle),n.initAttributes(t.style),io.enableStyleSyntax&&(n.style=new ig({setProperty:function(t,e){n.setAttribute(t,e);},getPropertyValue:function(t){return n.getAttribute(t);},removeProperty:function(t){n.removeAttribute(t);},item:function(){return"";}},{get:function(t,e){return void 0!==t[e]?t[e]:n.getAttribute(e);},set:function(t,e,r){return n.setAttribute(e,r),!0;}})),n;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"destroy",value:function(){(0,U.default)(e,"destroy",this,3)([]),this.getAnimations().forEach(function(t){t.cancel();});}},{key:"cloneNode",value:function(t,e){var n=(0,A.default)({},this.attributes);for(var r in n){var i=n[r];ip(i)&&"clipPath"!==r&&"offsetPath"!==r&&"textPath"!==r&&(n[r]=i.cloneNode(t)),e&&(n[r]=e(r,i));}var a=new this.constructor((0,A.default)((0,A.default)({},this.config),{},{style:n}));return a.setLocalTransform(this.getLocalTransform()),t&&this.children.forEach(function(e){if(!e.style.isMarker){var n=e.cloneNode(t);a.appendChild(n);}}),a;}},{key:"initAttributes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};io.styleValueRegistry.processProperties(this,t,{forceUpdateGeometry:!0}),this.dirty();}},{key:"setAttribute",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!(arguments.length>3)||void 0===arguments[3]||arguments[3];!(0,F.isUndefined)(n)&&(r||n!==this.attributes[t])&&(this.internalSetAttribute(t,n,{memoize:i}),(0,U.default)(e,"setAttribute",this,3)([t,n]));}},{key:"internalSetAttribute",value:function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.attributes[t],a=this.parsedStyle[t];io.styleValueRegistry.processProperties(this,(0,B.default)({},t,e),r),this.dirty();var o=this.parsedStyle[t];if(this.isConnected){if(iy.relatedNode=this,iy.prevValue=i,iy.newValue=e,iy.attrName=t,iy.prevParsedValue=a,iy.newParsedValue=o,this.isMutationObserved)this.dispatchEvent(iy);else{var s,l=(null===(s=this.ownerDocument.defaultView.getConfig().future)||void 0===s?void 0:s.experimentalCancelEventPropagation)===!0;iy.target=this,this.ownerDocument.defaultView.dispatchEvent(iy,!0,l);}}(this.isCustomElement&&this.isConnected||!this.isCustomElement)&&(null===(n=this.attributeChangedCallback)||void 0===n||n.call(this,t,i,e,a,o));}},{key:"getBBox",value:function(){var t=this.getBounds(),e=t.getMin(),n=(0,D.default)(e,2),r=n[0],i=n[1],a=t.getMax(),o=(0,D.default)(a,2);return new tu(r,i,o[0]-r,o[1]-i);}},{key:"setOrigin",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return io.sceneGraphService.setOrigin(this,tf(t,e,n,!1)),this;}},{key:"getOrigin",value:function(){return io.sceneGraphService.getOrigin(this);}},{key:"setPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return io.sceneGraphService.setPosition(this,tf(t,e,n,!1)),this;}},{key:"setLocalPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return io.sceneGraphService.setLocalPosition(this,tf(t,e,n,!1)),this;}},{key:"translate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return io.sceneGraphService.translate(this,tf(t,e,n,!1)),this;}},{key:"translateLocal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return io.sceneGraphService.translateLocal(this,tf(t,e,n,!1)),this;}},{key:"getPosition",value:function(){return io.sceneGraphService.getPosition(this);}},{key:"getLocalPosition",value:function(){return io.sceneGraphService.getLocalPosition(this);}},{key:"scale",value:function(t,e,n){return this.scaleLocal(t,e,n);}},{key:"scaleLocal",value:function(t,e,n){return"number"==typeof t&&(e=e||t,n=n||t,t=tf(t,e,n,!1)),io.sceneGraphService.scaleLocal(this,t),this;}},{key:"setLocalScale",value:function(t,e,n){return"number"==typeof t&&(e=e||t,n=n||t,t=tf(t,e,n,!1)),io.sceneGraphService.setLocalScale(this,t),this;}},{key:"getLocalScale",value:function(){return io.sceneGraphService.getLocalScale(this);}},{key:"getScale",value:function(){return io.sceneGraphService.getScale(this);}},{key:"getEulerAngles",value:function(){var t=ty(im,io.sceneGraphService.getWorldTransform(this));return(0,D.default)(t,3)[2]*tp;}},{key:"getLocalEulerAngles",value:function(){var t=ty(im,io.sceneGraphService.getLocalRotation(this));return(0,D.default)(t,3)[2]*tp;}},{key:"setEulerAngles",value:function(t){return io.sceneGraphService.setEulerAngles(this,0,0,t),this;}},{key:"setLocalEulerAngles",value:function(t){return io.sceneGraphService.setLocalEulerAngles(this,0,0,t),this;}},{key:"rotateLocal",value:function(t,e,n){return(0,F.isNil)(e)&&(0,F.isNil)(n)?io.sceneGraphService.rotateLocal(this,0,0,t):io.sceneGraphService.rotateLocal(this,t,e,n),this;}},{key:"rotate",value:function(t,e,n){return(0,F.isNil)(e)&&(0,F.isNil)(n)?io.sceneGraphService.rotate(this,0,0,t):io.sceneGraphService.rotate(this,t,e,n),this;}},{key:"setRotation",value:function(t,e,n,r){return io.sceneGraphService.setRotation(this,t,e,n,r),this;}},{key:"setLocalRotation",value:function(t,e,n,r){return io.sceneGraphService.setLocalRotation(this,t,e,n,r),this;}},{key:"setLocalSkew",value:function(t,e){return io.sceneGraphService.setLocalSkew(this,t,e),this;}},{key:"getRotation",value:function(){return io.sceneGraphService.getRotation(this);}},{key:"getLocalRotation",value:function(){return io.sceneGraphService.getLocalRotation(this);}},{key:"getLocalSkew",value:function(){return io.sceneGraphService.getLocalSkew(this);}},{key:"getLocalTransform",value:function(){return io.sceneGraphService.getLocalTransform(this);}},{key:"getWorldTransform",value:function(){return io.sceneGraphService.getWorldTransform(this);}},{key:"setLocalTransform",value:function(t){return io.sceneGraphService.setLocalTransform(this,t),this;}},{key:"resetLocalTransform",value:function(){io.sceneGraphService.resetLocalTransform(this);}},{key:"getAnimations",value:function(){return this.activeAnimations;}},{key:"animate",value:function(t,e){var n,r=null===(n=this.ownerDocument)||void 0===n?void 0:n.timeline;return r?r.play(this,t,e):null;}},{key:"isVisible",value:function(){var t;return(null===(t=this.parsedStyle)||void 0===t?void 0:t.visibility)!=="hidden";}},{key:"interactive",get:function(){return this.isInteractive();},set:function(t){this.style.pointerEvents=t?"auto":"none";}},{key:"isInteractive",value:function(){var t;return(null===(t=this.parsedStyle)||void 0===t?void 0:t.pointerEvents)!=="none";}},{key:"isCulled",value:function(){return!!(this.cullable&&this.cullable.enable&&!this.cullable.visible);}},{key:"toFront",value:function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,(0,O.default)(this.parentNode.children.map(function(t){return Number(t.style.zIndex);})))+1),this;}},{key:"toBack",value:function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,(0,O.default)(this.parentNode.children.map(function(t){return Number(t.style.zIndex);})))-1),this;}},{key:"getConfig",value:function(){return this.config;}},{key:"attr",value:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n[0],a=n[1];return i?(0,F.isObject)(i)?(Object.keys(i).forEach(function(e){t.setAttribute(e,i[e]);}),this):2===n.length?(this.setAttribute(i,a),this):this.attributes[i]:this.attributes;}},{key:"getMatrix",value:function(t){var e,n,r,i=t||this.getWorldTransform(),a=G.mat4.getTranslation(im,i),o=(0,D.default)(a,2),s=o[0],l=o[1],u=G.mat4.getScaling(im,i),c=(0,D.default)(u,2),h=c[0],d=c[1],f=ty(im,G.mat4.getRotation(ik,i)),v=(0,D.default)(f,3),p=v[0],g=v[2];return n=Math.cos(e=p||g),r=Math.sin(e),G.mat3.fromValues(h*n,d*r,0,-h*r,d*n,0,s,l,1);}},{key:"getLocalMatrix",value:function(){return this.getMatrix(this.getLocalTransform());}},{key:"setMatrix",value:function(t){var e=tm(t),n=(0,D.default)(e,5),r=n[0],i=n[1],a=n[2],o=n[3],s=n[4];this.setEulerAngles(s).setPosition(r,i).setLocalScale(a,o);}},{key:"setLocalMatrix",value:function(t){var e=tm(t),n=(0,D.default)(e,5),r=n[0],i=n[1],a=n[2],o=n[3],s=n[4];this.setLocalEulerAngles(s).setLocalPosition(r,i).setLocalScale(a,o);}},{key:"show",value:function(){this.forEach(function(t){t.style.visibility="visible";});}},{key:"hide",value:function(){this.forEach(function(t){t.style.visibility="hidden";});}},{key:"getCount",value:function(){return this.childElementCount;}},{key:"getParent",value:function(){return this.parentElement;}},{key:"getChildren",value:function(){return this.children;}},{key:"getFirst",value:function(){return this.firstElementChild;}},{key:"getLast",value:function(){return this.lastElementChild;}},{key:"getChildByIndex",value:function(t){return this.children[t]||null;}},{key:"add",value:function(t,e){return this.appendChild(t,e);}},{key:"set",value:function(t,e){this.config[t]=e;}},{key:"get",value:function(t){return this.config[t];}},{key:"moveTo",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(t,e,n),this;}},{key:"move",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(t,e,n),this;}},{key:"setZIndex",value:function(t){return this.style.zIndex=t,this;}}]);}(iv);iE.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","display","draggable","droppable","fill","fillOpacity","fillRule","filter","increasedLineWidthForHitTesting","lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit","hitArea","offsetDistance","offsetPath","offsetX","offsetY","opacity","pointerEvents","shadowColor","shadowType","shadowBlur","shadowOffsetX","shadowOffsetY","stroke","strokeOpacity","strokeWidth","strokeLinecap","strokeLineJoin","strokeDasharray","strokeDashoffset","transform","transformOrigin","textTransform","visibility","zIndex"]);var ix=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.CIRCLE},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(iE);ix.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iE.PARSED_STYLE_LIST),["cx","cy","cz","r","isBillboard","isSizeAttenuation"]));var iT=["style"];(function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iT);return(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({style:r},i)])).isCustomElement=!0,t;}return(0,I.default)(e,t),(0,R.default)(e);})(iE).PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var iN=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.ELLIPSE},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(iE);iN.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iE.PARSED_STYLE_LIST),["cx","cy","cz","rx","ry","isBillboard","isSizeAttenuation"])),function(t){function e(){return(0,C.default)(this,e),(0,L.default)(this,e,[{type:j.FRAGMENT}]);}return(0,I.default)(e,t),(0,R.default)(e);}(iE).PARSED_STYLE_LIST=new Set(["class","className"]);var ib=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.GROUP},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(iE);ib.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var iS=["style"],iw=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iS);return(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({type:j.HTML,style:r},i)])).cullable.enable=!1,t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getDomElement",value:function(){return this.parsedStyle.$el;}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()];}},{key:"getLocalBounds",value:function(){if(this.parentNode){var t=G.mat4.invert(G.mat4.create(),this.parentNode.getWorldTransform()),e=this.getBounds();if(!ti.isEmpty(e)){var n=new ti;return n.setFromTransformedAABB(e,t),n;}}return this.getBounds();}}]);}(iE);iw.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iE.PARSED_STYLE_LIST),["x","y","$el","innerHTML","width","height"]));var iP=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.IMAGE},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(iE);iP.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iE.PARSED_STYLE_LIST),["x","y","z","src","width","height","isBillboard","billboardRotation","isSizeAttenuation","keepAspectRatio"]));var iM=["style"],iA=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iM);(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({type:j.LINE,style:(0,A.default)({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},r)},i)])).markerStartAngle=0,t.markerEndAngle=0;var a=t.parsedStyle,o=a.markerStart,s=a.markerEnd;return o&&ip(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),s&&ip(s)&&(t.markerEndAngle=s.getLocalEulerAngles(),t.appendChild(s)),t.transformMarker(!0),t.transformMarker(!1),t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"x1"===t||"y1"===t||"x2"===t||"y2"===t||"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&ip(r)&&(this.markerStartAngle=0,r.remove()),i&&ip(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t&&(r&&ip(r)&&(this.markerEndAngle=0,r.remove()),i&&ip(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1)));}},{key:"transformMarker",value:function(t){var e,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,h=s.markerEndOffset,d=s.x1,f=s.x2,v=s.y1,p=s.y2,g=t?l:u;if(g&&ip(g)){var y=0;t?(r=d,i=v,e=f-d,n=p-v,a=c||0,o=this.markerStartAngle):(r=f,i=p,e=d-f,n=v-p,a=h||0,o=this.markerEndAngle),y=Math.atan2(n,e),g.setLocalEulerAngles(180*y/Math.PI+o),g.setLocalPosition(r+Math.cos(y)*a,i+Math.sin(y)*a);}}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle,r=n.x1,i=n.y1,a=n.x2,o=n.y2,s=(0,z.linePointAt)(r,i,a,o,t),l=s.x,u=s.y,c=G.vec3.transformMat4(G.vec3.create(),G.vec3.fromValues(l,u,0),e?this.getWorldTransform():this.getLocalTransform());return new tl(c[0],c[1]);}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(t/this.getTotalLength(),e);}},{key:"getTotalLength",value:function(){var t=this.parsedStyle,e=t.x1,n=t.y1,r=t.x2,i=t.y2;return(0,z.lineLength)(e,n,r,i);}}]);}(iE);iA.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iE.PARSED_STYLE_LIST),["x1","y1","x2","y2","z1","z2","isBillboard","isSizeAttenuation","markerStart","markerEnd","markerStartOffset","markerEndOffset"]));var iC=["style"],iR=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iC);(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({type:j.PATH,style:r,initialParsedStyle:{miterLimit:4,d:(0,A.default)({},t_)}},i)])).markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var a=t.parsedStyle,o=a.markerStart,s=a.markerEnd,l=a.markerMid;return o&&ip(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),l&&ip(l)&&t.placeMarkerMid(l),s&&ip(s)&&(t.markerEndAngle=s.getLocalEulerAngles(),t.appendChild(s)),t.transformMarker(!0),t.transformMarker(!1),t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"d"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&ip(r)&&(this.markerStartAngle=0,r.remove()),i&&ip(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t?(r&&ip(r)&&(this.markerEndAngle=0,r.remove()),i&&ip(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(i);}},{key:"transformMarker",value:function(t){var e,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,h=s.markerEndOffset,d=t?l:u;if(d&&ip(d)){var f=0;if(t){var v=this.getStartTangent(),p=(0,D.default)(v,2),g=p[0],y=p[1];r=y[0],i=y[1],e=g[0]-y[0],n=g[1]-y[1],a=c||0,o=this.markerStartAngle;}else{var m=this.getEndTangent(),k=(0,D.default)(m,2),E=k[0],x=k[1];r=x[0],i=x[1],e=E[0]-x[0],n=E[1]-x[1],a=h||0,o=this.markerEndAngle;}f=Math.atan2(n,e),d.setLocalEulerAngles(180*f/Math.PI+o),d.setLocalPosition(r+Math.cos(f)*a,i+Math.sin(f)*a);}}},{key:"placeMarkerMid",value:function(t){var e=this.parsedStyle.d.segments;if(this.markerMidList.forEach(function(t){t.remove();}),t&&ip(t))for(var n=1;n<e.length-1;n++){var r=(0,D.default)(e[n].currentPoint,2),i=r[0],a=r[1],o=1===n?t:t.cloneNode(!0);this.markerMidList.push(o),this.appendChild(o),o.setLocalPosition(i,a);}}},{key:"getTotalLength",value:function(){return e9(this);}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle.d.absolutePath,r=(0,F.getPointAtLength)(n,t),i=r.x,a=r.y,o=G.vec3.transformMat4(G.vec3.create(),G.vec3.fromValues(i,a,0),e?this.getWorldTransform():this.getLocalTransform());return new tl(o[0],o[1]);}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPointAtLength(t*e9(this),e);}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.d.segments,e=[];if(t.length>1){var n=t[0].currentPoint,r=t[1].currentPoint,i=t[1].startTangent;e=[],i?e.push([n[0]-i[0],n[1]-i[1]]):e.push([r[0],r[1]]),e.push([n[0],n[1]]);}return e;}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.d.segments,e=t.length,n=[];if(e>1){var r=t[e-2].currentPoint,i=t[e-1].currentPoint,a=t[e-1].endTangent;n=[],a?n.push([i[0]-a[0],i[1]-a[1]]):n.push([r[0],r[1]]),n.push([i[0],i[1]]);}return n;}}]);}(iE);iR.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iE.PARSED_STYLE_LIST),["d","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard","isSizeAttenuation"]));var iO=["style"],iL=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iO);(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({type:j.POLYGON,style:r,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},i)])).markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var a=t.parsedStyle,o=a.markerStart,s=a.markerEnd,l=a.markerMid;return o&&ip(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),l&&ip(l)&&t.placeMarkerMid(l),s&&ip(s)&&(t.markerEndAngle=s.getLocalEulerAngles(),t.appendChild(s)),t.transformMarker(!0),t.transformMarker(!1),t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"points"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&ip(r)&&(this.markerStartAngle=0,r.remove()),i&&ip(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t?(r&&ip(r)&&(this.markerEndAngle=0,r.remove()),i&&ip(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(i);}},{key:"transformMarker",value:function(t){var e,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,h=s.markerEndOffset,d=(s.points||{}).points,f=t?l:u;if(f&&ip(f)&&d){var v=0;if(r=d[0][0],i=d[0][1],t)e=d[1][0]-d[0][0],n=d[1][1]-d[0][1],a=c||0,o=this.markerStartAngle;else{var p=d.length;this.parsedStyle.isClosed?(e=d[p-1][0]-d[0][0],n=d[p-1][1]-d[0][1]):(r=d[p-1][0],i=d[p-1][1],e=d[p-2][0]-d[p-1][0],n=d[p-2][1]-d[p-1][1]),a=h||0,o=this.markerEndAngle;}v=Math.atan2(n,e),f.setLocalEulerAngles(180*v/Math.PI+o),f.setLocalPosition(r+Math.cos(v)*a,i+Math.sin(v)*a);}}},{key:"placeMarkerMid",value:function(t){var e=(this.parsedStyle.points||{}).points;if(this.markerMidList.forEach(function(t){t.remove();}),this.markerMidList=[],t&&ip(t)&&e)for(var n=1;n<(this.parsedStyle.isClosed?e.length:e.length-1);n++){var r=e[n][0],i=e[n][1],a=1===n?t:t.cloneNode(!0);this.markerMidList.push(a),this.appendChild(a),a.setLocalPosition(r,i);}}}]);}(iE);iL.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iE.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isClosed","isBillboard","isSizeAttenuation"]));var iI=["style"],iD=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.style,r=(0,q.default)(t,iI);return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.POLYLINE,style:n,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},r)]);}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getTotalLength",value:function(){return 0===this.parsedStyle.points.totalLength&&(this.parsedStyle.points.totalLength=(0,z.polylineLength)(this.parsedStyle.points.points)),this.parsedStyle.points.totalLength;}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(t/this.getTotalLength(),e);}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle.points.points;if(0===this.parsedStyle.points.segments.length){var r,i,a=[],o=0,s=this.getTotalLength();n.forEach(function(t,e){n[e+1]&&((r=[0,0])[0]=o/s,i=(0,z.lineLength)(t[0],t[1],n[e+1][0],n[e+1][1]),o+=i,r[1]=o/s,a.push(r));}),this.parsedStyle.points.segments=a;}var l=0,u=0;this.parsedStyle.points.segments.forEach(function(e,n){t>=e[0]&&t<=e[1]&&(l=(t-e[0])/(e[1]-e[0]),u=n);});var c=(0,z.linePointAt)(n[u][0],n[u][1],n[u+1][0],n[u+1][1],l),h=c.x,d=c.y,f=G.vec3.transformMat4(G.vec3.create(),G.vec3.fromValues(h,d,0),e?this.getWorldTransform():this.getLocalTransform());return new tl(f[0],f[1]);}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.points.points,e=[];return e.push([t[1][0],t[1][1]]),e.push([t[0][0],t[0][1]]),e;}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.points.points,e=t.length-1,n=[];return n.push([t[e-1][0],t[e-1][1]]),n.push([t[e][0],t[e][1]]),n;}}]);}(iL);iD.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iL.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard"]));var i_=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.RECT},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(iE);i_.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iE.PARSED_STYLE_LIST),["x","y","z","width","height","isBillboard","isSizeAttenuation","radius"]));var iG=["style"],iF=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.style,r=(0,q.default)(t,iG);return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.TEXT,style:(0,A.default)({fill:"black"},n)},r)]);}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getComputedTextLength",value:function(){var t;return this.getGeometryBounds(),(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.maxLineWidth)||0;}},{key:"getLineBoundingRects",value:function(){var t;return this.getGeometryBounds(),(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.lineMetrics)||[];}},{key:"isOverflowing",value:function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing;}}]);}(iE);iF.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iE.PARSED_STYLE_LIST),["x","y","z","isBillboard","billboardRotation","isSizeAttenuation","text","textAlign","textBaseline","fontStyle","fontSize","fontFamily","fontWeight","fontVariant","lineHeight","letterSpacing","leading","wordWrap","wordWrapWidth","maxLines","textOverflow","isOverflowing","textPath","textDecorationLine","textDecorationColor","textDecorationStyle","textDecorationThickness","textPathSide","textPathStartOffset","metrics","dx","dy"])),(0,R.default)(function t(){(0,C.default)(this,t),this.registry={},this.define(j.CIRCLE,ix),this.define(j.ELLIPSE,iN),this.define(j.RECT,i_),this.define(j.IMAGE,iP),this.define(j.LINE,iA),this.define(j.GROUP,ib),this.define(j.PATH,iR),this.define(j.POLYGON,iL),this.define(j.POLYLINE,iD),this.define(j.TEXT,iF),this.define(j.HTML,iw);},[{key:"define",value:function(t,e){this.registry[t]=e;}},{key:"get",value:function(t){return this.registry[t];}}]),function(){function t(e){(0,C.default)(this,t),this.strategies=e;}return(0,R.default)(t,[{key:"apply",value:function(e){var n=e.config,r=e.camera,i=e.renderingService,a=e.renderingContext,o=this.strategies;i.hooks.cull.tap(t.tag,function(t){if(t){var e,i=t.cullable;if(0===o.length?i.visible=a.unculledEntities.indexOf(t.entity)>-1:i.visible=o.every(function(e){return e.isVisible(r,t);}),!t.isCulled()&&t.isVisible())return t;var s=(null===(e=n.future)||void 0===e?void 0:e.experimentalCancelEventPropagation)===!0;return t.dispatchEvent(new r_(rz.CULLED),s,s),null;}return t;}),i.hooks.afterRender.tap(t.tag,function(t){t.cullable.visibilityPlaneMask=-1;});}}]);}().tag="Culling",function(){function t(){var e=this;(0,C.default)(this,t),this.autoPreventDefault=!1,this.rootPointerEvent=new rI(null),this.rootWheelEvent=new rD(null),this.onPointerMove=function(t){var n=null===(r=e.context.renderingContext.root)||void 0===r||null===(r=r.ownerDocument)||void 0===r?void 0:r.defaultView;if(!n.supportsTouchEvents||"touch"!==t.pointerType){var r,i,a=e.normalizeToPointerEvent(t,n),o=(0,W.default)(a);try{for(o.s();!(i=o.n()).done;){var s=i.value,l=e.bootstrapEvent(e.rootPointerEvent,s,n,t);e.context.eventService.mapEvent(l);}}catch(t){o.e(t);}finally{o.f();}e.setCursor(e.context.eventService.cursor);}},this.onClick=function(t){var n,r,i=null===(n=e.context.renderingContext.root)||void 0===n||null===(n=n.ownerDocument)||void 0===n?void 0:n.defaultView,a=e.normalizeToPointerEvent(t,i),o=(0,W.default)(a);try{for(o.s();!(r=o.n()).done;){var s=r.value,l=e.bootstrapEvent(e.rootPointerEvent,s,i,t);e.context.eventService.mapEvent(l);}}catch(t){o.e(t);}finally{o.f();}e.setCursor(e.context.eventService.cursor);};}return(0,R.default)(t,[{key:"apply",value:function(e){var n=this;this.context=e;var r=e.renderingService,i=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler(function(t){return n.context.renderingService.hooks.pickSync.call({position:t,picked:[],topmost:!0}).picked[0]||null;}),r.hooks.pointerWheel.tap(t.tag,function(t){var e=n.normalizeWheelEvent(t);n.context.eventService.mapEvent(e);}),r.hooks.pointerDown.tap(t.tag,function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){var e=n.normalizeToPointerEvent(t,i);n.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();var r,a=(0,W.default)(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=n.bootstrapEvent(n.rootPointerEvent,o,i,t);n.context.eventService.mapEvent(s);}}catch(t){a.e(t);}finally{a.f();}n.setCursor(n.context.eventService.cursor);}}),r.hooks.pointerUp.tap(t.tag,function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){var e,r=n.context.contextService.getDomElement(),a=n.context.eventService.isNativeEventFromCanvas(r,t)?"":"outside",o=n.normalizeToPointerEvent(t,i),s=(0,W.default)(o);try{for(s.s();!(e=s.n()).done;){var l=e.value,u=n.bootstrapEvent(n.rootPointerEvent,l,i,t);u.type+=a,n.context.eventService.mapEvent(u);}}catch(t){s.e(t);}finally{s.f();}n.setCursor(n.context.eventService.cursor);}}),r.hooks.pointerMove.tap(t.tag,this.onPointerMove),r.hooks.pointerOver.tap(t.tag,this.onPointerMove),r.hooks.pointerOut.tap(t.tag,this.onPointerMove),r.hooks.click.tap(t.tag,this.onClick),r.hooks.pointerCancel.tap(t.tag,function(t){var e,r=n.normalizeToPointerEvent(t,i),a=(0,W.default)(r);try{for(a.s();!(e=a.n()).done;){var o=e.value,s=n.bootstrapEvent(n.rootPointerEvent,o,i,t);n.context.eventService.mapEvent(s);}}catch(t){a.e(t);}finally{a.f();}n.setCursor(n.context.eventService.cursor);});}},{key:"bootstrapEvent",value:function(t,e,n,r){t.view=n,t.originalEvent=null,t.nativeEvent=r,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);var i=this.context.eventService.client2Viewport({x:e.clientX,y:e.clientY}),a=i.x,o=i.y;t.viewport.x=a,t.viewport.y=o;var s=this.context.eventService.viewport2Canvas(t.viewport),l=s.x,u=s.y;return t.canvas.x=l,t.canvas.y=u,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=r.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=n1[t.type]||t.type),t;}},{key:"normalizeWheelEvent",value:function(t){var e=this.rootWheelEvent;this.transferMouseData(e,t),e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;var n=this.context.eventService.client2Viewport({x:t.clientX,y:t.clientY}),r=n.x,i=n.y;e.viewport.x=r,e.viewport.y=i;var a=this.context.eventService.viewport2Canvas(e.viewport),o=a.x,s=a.y;return e.canvas.x=o,e.canvas.y=s,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.nativeEvent=t,e.type=t.type,e;}},{key:"transferMouseData",value:function(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=n2.now(),t.type=e.type,t.altKey=e.altKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.ctrlKey=e.ctrlKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.screen.x=e.screenX,t.screen.y=e.screenY,t.relatedTarget=null;}},{key:"setCursor",value:function(t){this.context.contextService.applyCursorStyle(t||this.context.config.cursor||"default");}},{key:"normalizeToPointerEvent",value:function(t,e){var n=[];if(e.isTouchEvent(t))for(var r=0;r<t.changedTouches.length;r++){var i=t.changedTouches[r];(0,F.isUndefined)(i.button)&&(i.button=0),(0,F.isUndefined)(i.buttons)&&(i.buttons=1),(0,F.isUndefined)(i.isPrimary)&&(i.isPrimary=1===t.touches.length&&"touchstart"===t.type),(0,F.isUndefined)(i.width)&&(i.width=i.radiusX||1),(0,F.isUndefined)(i.height)&&(i.height=i.radiusY||1),(0,F.isUndefined)(i.tiltX)&&(i.tiltX=0),(0,F.isUndefined)(i.tiltY)&&(i.tiltY=0),(0,F.isUndefined)(i.pointerType)&&(i.pointerType="touch"),(0,F.isUndefined)(i.pointerId)&&(i.pointerId=i.identifier||0),(0,F.isUndefined)(i.pressure)&&(i.pressure=i.force||.5),(0,F.isUndefined)(i.twist)&&(i.twist=0),(0,F.isUndefined)(i.tangentialPressure)&&(i.tangentialPressure=0),i.isNormalized=!0,i.type=t.type,n.push(i);}else e.isMouseEvent(t)&&((0,F.isUndefined)(t.isPrimary)&&(t.isPrimary=!0),(0,F.isUndefined)(t.width)&&(t.width=1),(0,F.isUndefined)(t.height)&&(t.height=1),(0,F.isUndefined)(t.tiltX)&&(t.tiltX=0),(0,F.isUndefined)(t.tiltY)&&(t.tiltY=0),(0,F.isUndefined)(t.pointerType)&&(t.pointerType="mouse"),(0,F.isUndefined)(t.pointerId)&&(t.pointerId=1),(0,F.isUndefined)(t.pressure)&&(t.pressure=.5),(0,F.isUndefined)(t.twist)&&(t.twist=0),(0,F.isUndefined)(t.tangentialPressure)&&(t.tangentialPressure=0),t.isNormalized=!0),n.push(t);return n;}}]);}().tag="Event";var iB=[j.CIRCLE,j.ELLIPSE,j.IMAGE,j.RECT,j.LINE,j.POLYLINE,j.POLYGON,j.TEXT,j.PATH,j.HTML];(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"isVisible",value:function(t,e){var n,r=e.cullable;if(!r.enable)return!0;var i=e.getRenderBounds();if(ti.isEmpty(i))return!1;var a=t.getFrustum(),o=null===(n=e.parentNode)||void 0===n||null===(n=n.cullable)||void 0===n?void 0:n.visibilityPlaneMask;return r.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(e,i,o||to.INDETERMINATE,a.planes),r.visible=r.visibilityPlaneMask!==to.OUTSIDE,r.visible;}},{key:"computeVisibilityWithPlaneMask",value:function(t,e,n,r){if(n===to.OUTSIDE||n===to.INSIDE)return n;for(var i=to.INSIDE,a=iB.indexOf(t.nodeName)>-1,o=0,s=r.length;o<s;++o){var l=1<<o;if((n&l)!=0&&(!a||4!==o&&5!==o)){var u=r[o],c=u.normal,h=u.distance;if(G.vec3.dot(c,e.getPositiveFarPoint(r[o]))+h<0)return to.OUTSIDE;G.vec3.dot(c,e.getNegativeFarPoint(r[o]))+h<0&&(i|=l);}}return i;}}]),function(){function t(){(0,C.default)(this,t),this.mutationRecords=[],this.isFirstTimeRendering=!0,this.isFirstTimeRenderingFinished=!1;}return(0,R.default)(t,[{key:"apply",value:function(e){var n,r=this,i=e.renderingService,a=e.renderingContext.root.ownerDocument.defaultView,o=function(t){i.dirty();},s=function(t){var e,n=t.detail;(e=r.mutationRecords).push.apply(e,(0,O.default)(n)),i.dirty();},l=function(t){var e=t.target;io.enableSizeAttenuation&&io.styleValueRegistry.updateSizeAttenuation(e,a.getCamera().getZoom());},u=function(t){var e=t.target;io.sceneGraphService.dirtyToRoot(e),i.dirty();};i.hooks.init.tap(t.tag,function(){a.addEventListener(rz.MOUNTED,l),a.addEventListener(rz.UNMOUNTED,u),a.addEventListener(rz.ATTR_MODIFIED,o),a.addEventListener(rz.BOUNDS_CHANGED,s);}),i.hooks.destroy.tap(t.tag,function(){a.removeEventListener(rz.MOUNTED,l),a.removeEventListener(rz.UNMOUNTED,u),a.removeEventListener(rz.ATTR_MODIFIED,o),a.removeEventListener(rz.BOUNDS_CHANGED,s),r.mutationRecords=[];});var c=null!==(n=io.globalThis.requestIdleCallback)&&void 0!==n?n:rn.bind(io.globalThis);i.hooks.endFrame.tap(t.tag,function(){r.isFirstTimeRendering&&(r.isFirstTimeRendering=!1,c(function(){r.isFirstTimeRenderingFinished=!0;})),r.mutationRecords=[];});}}]);}().tag="Prepare";var iU=((P={}).READY="ready",P.BEFORE_RENDER="beforerender",P.RERENDER="rerender",P.AFTER_RENDER="afterrender",P.BEFORE_DESTROY="beforedestroy",P.AFTER_DESTROY="afterdestroy",P.RESIZE="resize",P.DIRTY_RECTANGLE="dirtyrectangle",P.RENDERER_CHANGED="rendererchanged",P);new r_(rz.MOUNTED),new r_(rz.UNMOUNTED),new r_(iU.BEFORE_RENDER),new r_(iU.RERENDER),new r_(iU.AFTER_RENDER);},"1fb40f37":function(t,e,n){"use strict";n.d(e,"__esModule",{value:!0}),n.e(e,{AbstractRendererPlugin:function(){return K;},CanvasEvent:function(){return iF;},ElementEvent:function(){return rU;},RenderReason:function(){return rG;},Shape:function(){return j;},isCSSRGB:function(){return ez;},isPattern:function(){return eV;}});var r,i,a,o,s,l,u,c,h,d,f,v,p,g,y,m,k,E,x,T,N,b,S,w,P,M=n("777fffbe"),A=M._(n("ab297151")),C=M._(n("b1a4abb6")),R=M._(n("72ce8fb5")),O=M._(n("d60881d0")),L=M._(n("0b95a4d2")),I=M._(n("0afdccfb")),D=M._(n("7465ab36")),_=M._(n("32f41e1c")),G=n("597fa39f");n("f90e84e3");var F=n("abe9d8d6"),B=M._(n("3214ccb5")),U=M._(n("51ffafbb")),V=M._(n("3c7f532e")),z=n("b1a96927"),H=M._(n("2fabd5d4")),Y=M._(n("cb203630")),W=M._(n("1982f763")),q=M._(n("01aac514"));let X=n("1714eebe");var j=((r={}).GROUP="g",r.FRAGMENT="fragment",r.CIRCLE="circle",r.ELLIPSE="ellipse",r.IMAGE="image",r.RECT="rect",r.LINE="line",r.POLYLINE="polyline",r.POLYGON="polygon",r.TEXT="text",r.PATH="path",r.HTML="html",r.MESH="mesh",r),$=((i={})[i.ZERO=0]="ZERO",i[i.NEGATIVE_ONE=1]="NEGATIVE_ONE",i),K=(0,R.default)(function t(){(0,C.default)(this,t),this.plugins=[];},[{key:"addRenderingPlugin",value:function(t){this.plugins.push(t),this.context.renderingPlugins.push(t);}},{key:"removeAllRenderingPlugins",value:function(){var t=this;this.plugins.forEach(function(e){var n=t.context.renderingPlugins.indexOf(e);n>=0&&t.context.renderingPlugins.splice(n,1);});}}]),Z=G.vec3.add,Q=G.vec3.copy,J=G.vec3.max,tt=G.vec3.min,te=G.vec3.scale,tn=G.vec3.sub,tr=function(){function t(){(0,C.default)(this,t),this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0];}return(0,R.default)(t,[{key:"update",value:function(t,e){Q(this.center,t),Q(this.halfExtents,e),tn(this.min,this.center,this.halfExtents),Z(this.max,this.center,this.halfExtents);}},{key:"setMinMax",value:function(t,e){Z(this.center,e,t),te(this.center,this.center,.5),tn(this.halfExtents,e,t),te(this.halfExtents,this.halfExtents,.5),Q(this.min,t),Q(this.max,e);}},{key:"getMin",value:function(){return this.min;}},{key:"getMax",value:function(){return this.max;}},{key:"add",value:function(e){if(!t.isEmpty(e)){if(t.isEmpty(this)){this.setMinMax(e.getMin(),e.getMax());return;}var n=this.center,r=n[0],i=n[1],a=n[2],o=this.halfExtents,s=o[0],l=o[1],u=o[2],c=r-s,h=r+s,d=i-l,f=i+l,v=a-u,p=a+u,g=e.center,y=g[0],m=g[1],k=g[2],E=e.halfExtents,x=E[0],T=E[1],N=E[2],b=y-x,S=y+x,w=m-T,P=m+T,M=k-N,A=k+N;b<c&&(c=b),S>h&&(h=S),w<d&&(d=w),P>f&&(f=P),M<v&&(v=M),A>p&&(p=A),n[0]=(c+h)*.5,n[1]=(d+f)*.5,n[2]=(v+p)*.5,o[0]=(h-c)*.5,o[1]=(f-d)*.5,o[2]=(p-v)*.5,this.min[0]=c,this.min[1]=d,this.min[2]=v,this.max[0]=h,this.max[1]=f,this.max[2]=p;}}},{key:"setFromTransformedAABB",value:function(t,e){var n=this.center,r=this.halfExtents,i=t.center,a=t.halfExtents,o=e[0],s=e[4],l=e[8],u=e[1],c=e[5],h=e[9],d=e[2],f=e[6],v=e[10],p=Math.abs(o),g=Math.abs(s),y=Math.abs(l),m=Math.abs(u),k=Math.abs(c),E=Math.abs(h),x=Math.abs(d),T=Math.abs(f),N=Math.abs(v);n[0]=e[12]+o*i[0]+s*i[1]+l*i[2],n[1]=e[13]+u*i[0]+c*i[1]+h*i[2],n[2]=e[14]+d*i[0]+f*i[1]+v*i[2],r[0]=p*a[0]+g*a[1]+y*a[2],r[1]=m*a[0]+k*a[1]+E*a[2],r[2]=x*a[0]+T*a[1]+N*a[2],tn(this.min,n,r),Z(this.max,n,r);}},{key:"intersects",value:function(t){var e=this.getMax(),n=this.getMin(),r=t.getMax(),i=t.getMin();return n[0]<=r[0]&&e[0]>=i[0]&&n[1]<=r[1]&&e[1]>=i[1]&&n[2]<=r[2]&&e[2]>=i[2];}},{key:"intersection",value:function(e){if(!this.intersects(e))return null;var n=new t,r=J([0,0,0],this.getMin(),e.getMin()),i=tt([0,0,0],this.getMax(),e.getMax());return n.setMinMax(r,i),n;}},{key:"getNegativeFarPoint",value:function(t){return 273===t.pnVertexFlag?Q([0,0,0],this.min):272===t.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:257===t.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:256===t.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:17===t.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:16===t.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:1===t.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]];}},{key:"getPositiveFarPoint",value:function(t){return 273===t.pnVertexFlag?Q([0,0,0],this.max):272===t.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:257===t.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:256===t.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:17===t.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:16===t.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:1===t.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]];}}],[{key:"isEmpty",value:function(t){return!t||0===t.halfExtents[0]&&0===t.halfExtents[1]&&0===t.halfExtents[2];}}]);}(),ti=(0,R.default)(function t(e,n){(0,C.default)(this,t),this.distance=e||0,this.normal=n||G.vec3.fromValues(0,1,0),this.updatePNVertexFlag();},[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(Number(this.normal[0]>=0)<<8)+(Number(this.normal[1]>=0)<<4)+Number(this.normal[2]>=0);}},{key:"distanceToPoint",value:function(t){return G.vec3.dot(t,this.normal)-this.distance;}},{key:"normalize",value:function(){var t=1/G.vec3.len(this.normal);G.vec3.scale(this.normal,this.normal,t),this.distance*=t;}},{key:"intersectsLine",value:function(t,e,n){var r=this.distanceToPoint(t),i=r/(r-this.distanceToPoint(e)),a=i>=0&&i<=1;return a&&n&&G.vec3.lerp(n,t,e,i),a;}}]),ta=((a={})[a.OUTSIDE=4294967295]="OUTSIDE",a[a.INSIDE=0]="INSIDE",a[a.INDETERMINATE=2147483647]="INDETERMINATE",a),to=(0,R.default)(function t(e){if((0,C.default)(this,t),this.planes=[],e)this.planes=e;else for(var n=0;n<6;n++)this.planes.push(new ti);},[{key:"extractFromVPMatrix",value:function(t){var e=(0,D.default)(t,16),n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],v=e[12],p=e[13],g=e[14],y=e[15];G.vec3.set(this.planes[0].normal,a-n,u-o,f-c),this.planes[0].distance=y-v,G.vec3.set(this.planes[1].normal,a+n,u+o,f+c),this.planes[1].distance=y+v,G.vec3.set(this.planes[2].normal,a+r,u+s,f+h),this.planes[2].distance=y+p,G.vec3.set(this.planes[3].normal,a-r,u-s,f-h),this.planes[3].distance=y-p,G.vec3.set(this.planes[4].normal,a-i,u-l,f-d),this.planes[4].distance=y-g,G.vec3.set(this.planes[5].normal,a+i,u+l,f+d),this.planes[5].distance=y+g,this.planes.forEach(function(t){t.normalize(),t.updatePNVertexFlag();});}}]),ts=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,C.default)(this,t),this.x=0,this.y=0,this.x=e,this.y=n;}return(0,R.default)(t,[{key:"clone",value:function(){return new t(this.x,this.y);}},{key:"copyFrom",value:function(t){this.x=t.x,this.y=t.y;}}]);}(),tl=function(){function t(e,n,r,i){(0,C.default)(this,t),this.x=e,this.y=n,this.width=r,this.height=i,this.left=e,this.right=e+r,this.top=n,this.bottom=n+i;}return(0,R.default)(t,[{key:"toJSON",value:function(){}}],[{key:"fromRect",value:function(e){return new t(e.x,e.y,e.width,e.height);}},{key:"applyTransform",value:function(e,n){var r=G.vec4.fromValues(e.x,e.y,0,1),i=G.vec4.fromValues(e.x+e.width,e.y,0,1),a=G.vec4.fromValues(e.x,e.y+e.height,0,1),o=G.vec4.fromValues(e.x+e.width,e.y+e.height,0,1),s=G.vec4.create(),l=G.vec4.create(),u=G.vec4.create(),c=G.vec4.create();G.vec4.transformMat4(s,r,n),G.vec4.transformMat4(l,i,n),G.vec4.transformMat4(u,a,n),G.vec4.transformMat4(c,o,n);var h=Math.min(s[0],l[0],u[0],c[0]),d=Math.min(s[1],l[1],u[1],c[1]),f=Math.max(s[0],l[0],u[0],c[0]),v=Math.max(s[1],l[1],u[1],c[1]);return t.fromRect({x:h,y:d,width:f-h,height:v-d});}}]);}(),tu="Method not implemented.";function tc(t){return void 0===t?0:t>360||t<-360?t%360:t;}var th=G.vec3.create();function td(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];return Array.isArray(t)&&3===t.length?r?G.vec3.clone(t):G.vec3.copy(th,t):(0,F.isNumber)(t)?r?G.vec3.fromValues(t,e,n):G.vec3.set(th,t,e,n):r?G.vec3.fromValues(t[0],t[1]||e,t[2]||n):G.vec3.set(th,t[0],t[1]||e,t[2]||n);}var tf=Math.PI/180,tv=180/Math.PI,tp=Math.PI/2;function tg(t,e){var n,r,i,a,o,s,l,u,c,h,d,f,v,p,g,y,m;return 16===e.length?(i=G.mat4.getScaling(G.vec3.create(),e),o=(a=(0,D.default)(i,3))[0],s=a[1],l=a[2],(u=Math.asin(-e[2]/o))<tp?u>-tp?(n=Math.atan2(e[6]/s,e[10]/l),r=Math.atan2(e[1]/o,e[0]/o)):(r=0,n=-Math.atan2(e[4]/s,e[5]/s)):(r=0,n=Math.atan2(e[4]/s,e[5]/s)),t[0]=n,t[1]=u,t[2]=r):(c=e[0],h=e[1],d=e[2],f=e[3],y=c*c+(v=h*h)+(p=d*d)+(g=f*f),(m=c*f-h*d)>.499995*y?(t[0]=tp,t[1]=2*Math.atan2(h,c),t[2]=0):m<-.499995*y?(t[0]=-tp,t[1]=2*Math.atan2(h,c),t[2]=0):(t[0]=Math.asin(2*(c*d-f*h)),t[1]=Math.atan2(2*(c*f+h*d),1-2*(p+g)),t[2]=Math.atan2(2*(c*h+d*f),1-2*(v+p)))),t;}function ty(t){var e=t[0],n=t[1],r=t[3],i=t[4],a=Math.sqrt(e*e+n*n),o=Math.sqrt(r*r+i*i);if(e*i-n*r<0&&(e<i?a=-a:o=-o),a){var s=1/a;e*=s,n*=s;}if(o){var l=1/o;r*=l,i*=l;}var u=Math.atan2(n,e)*tv;return[t[6],t[7],a,o,u];}var tm=G.mat4.create(),tk=G.mat4.create(),tE=G.vec4.create(),tx=[G.vec3.create(),G.vec3.create(),G.vec3.create()],tT=G.vec3.create();function tN(t,e,n,r,i){t[0]=e[0]*r+n[0]*i,t[1]=e[1]*r+n[1]*i,t[2]=e[2]*r+n[2]*i;}var tb=((o={})[o.ORBITING=0]="ORBITING",o[o.EXPLORING=1]="EXPLORING",o[o.TRACKING=2]="TRACKING",o),tS=((s={})[s.DEFAULT=0]="DEFAULT",s[s.ROTATIONAL=1]="ROTATIONAL",s[s.TRANSLATIONAL=2]="TRANSLATIONAL",s[s.CINEMATIC=3]="CINEMATIC",s),tw=((l={})[l.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",l[l.PERSPECTIVE=1]="PERSPECTIVE",l),tP={UPDATED:"updated"},tM=(0,R.default)(function t(){(0,C.default)(this,t),this.clipSpaceNearZ=$.NEGATIVE_ONE,this.eventEmitter=new _.default,this.matrix=G.mat4.create(),this.right=G.vec3.fromValues(1,0,0),this.up=G.vec3.fromValues(0,1,0),this.forward=G.vec3.fromValues(0,0,1),this.position=G.vec3.fromValues(0,0,1),this.focalPoint=G.vec3.fromValues(0,0,0),this.distanceVector=G.vec3.fromValues(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=G.mat4.create(),this.projectionMatrixInverse=G.mat4.create(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=tb.EXPLORING,this.trackingMode=tS.DEFAULT,this.projectionMode=tw.PERSPECTIVE,this.frustum=new to,this.orthoMatrix=G.mat4.create();},[{key:"isOrtho",value:function(){return this.projectionMode===tw.ORTHOGRAPHIC;}},{key:"getProjectionMode",value:function(){return this.projectionMode;}},{key:"getPerspective",value:function(){return this.jitteredProjectionMatrix||this.projectionMatrix;}},{key:"getPerspectiveInverse",value:function(){return this.projectionMatrixInverse;}},{key:"getFrustum",value:function(){return this.frustum;}},{key:"getPosition",value:function(){return this.position;}},{key:"getFocalPoint",value:function(){return this.focalPoint;}},{key:"getDollyingStep",value:function(){return this.dollyingStep;}},{key:"getNear",value:function(){return this.near;}},{key:"getFar",value:function(){return this.far;}},{key:"getZoom",value:function(){return this.zoom;}},{key:"getOrthoMatrix",value:function(){return this.orthoMatrix;}},{key:"getView",value:function(){return this.view;}},{key:"setEnableUpdate",value:function(t){this.enableUpdate=t;}},{key:"setType",value:function(t,e){return this.type=t,this.type===tb.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===tb.TRACKING&&void 0!==e&&this.setTrackingMode(e),this;}},{key:"setProjectionMode",value:function(t){return this.projectionMode=t,this;}},{key:"setTrackingMode",value:function(t){if(this.type!==tb.TRACKING)throw Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=t,this;}},{key:"setWorldRotation",value:function(t){return this.rotateWorld=t,this._getAngles(),this;}},{key:"getViewTransform",value:function(){return G.mat4.invert(G.mat4.create(),this.matrix);}},{key:"getWorldTransform",value:function(){return this.matrix;}},{key:"jitterProjectionMatrix",value:function(t,e){var n=G.mat4.fromTranslation(G.mat4.create(),[t,e,0]);this.jitteredProjectionMatrix=G.mat4.multiply(G.mat4.create(),n,this.projectionMatrix);}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0;}},{key:"setMatrix",value:function(t){return this.matrix=t,this._update(),this;}},{key:"setProjectionMatrix",value:function(t){this.projectionMatrix=t;}},{key:"setFov",value:function(t){return this.setPerspective(this.near,this.far,t,this.aspect),this;}},{key:"setAspect",value:function(t){return this.setPerspective(this.near,this.far,this.fov,t),this;}},{key:"setNear",value:function(t){return this.projectionMode===tw.PERSPECTIVE?this.setPerspective(t,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,t,this.far),this;}},{key:"setFar",value:function(t){return this.projectionMode===tw.PERSPECTIVE?this.setPerspective(this.near,t,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,t),this;}},{key:"setViewOffset",value:function(t,e,n,r,i,a){return this.aspect=t/e,void 0===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.projectionMode===tw.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this;}},{key:"clearViewOffset",value:function(){return void 0!==this.view&&(this.view.enabled=!1),this.projectionMode===tw.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this;}},{key:"setZoom",value:function(t){return this.zoom=t,this.projectionMode===tw.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===tw.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this;}},{key:"setZoomByViewportPoint",value:function(t,e){var n=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),r=n.x,i=n.y,a=this.roll;this.rotate(0,0,-a),this.setPosition(r,i),this.setFocalPoint(r,i),this.setZoom(t),this.rotate(0,0,a);var o=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),s=o.x,l=o.y,u=G.vec3.fromValues(s-r,l-i,0),c=G.vec3.dot(u,this.right)/G.vec3.length(this.right),h=G.vec3.dot(u,this.up)/G.vec3.length(this.up),d=this.getPosition(),f=(0,D.default)(d,2),v=f[0],p=f[1],g=this.getFocalPoint(),y=(0,D.default)(g,2),m=y[0],k=y[1];return this.setPosition(v-c,p-h),this.setFocalPoint(m-c,k-h),this;}},{key:"setPerspective",value:function(t,e,n,r){this.projectionMode=tw.PERSPECTIVE,this.fov=n,this.near=t,this.far=e,this.aspect=r;var i,a=this.near*Math.tan(.5*this.fov*tf)/this.zoom,o=2*a,s=this.aspect*o,l=-.5*s;if(null!==(i=this.view)&&void 0!==i&&i.enabled){var u=this.view.fullWidth,c=this.view.fullHeight;l+=this.view.offsetX*s/u,a-=this.view.offsetY*o/c,s*=this.view.width/u,o*=this.view.height/c;}return!function(t,e,n,r,i,a,o){var s,l,u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=2*a,h=n-e,d=r-i,f=o-a,v=o*a;u?(s=-o/f,l=-v/f):(s=-(o+a)/f,l=-2*v/f),t[0]=c/h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c/d,t[6]=0,t[7]=0,t[8]=(n+e)/h,t[9]=(r+i)/d,t[10]=s,t[11]=-1,t[12]=0,t[13]=0,t[14]=l,t[15]=0;}(this.projectionMatrix,l,l+s,a-o,a,t,this.far,this.clipSpaceNearZ===$.ZERO),G.mat4.invert(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this;}},{key:"setOrthographic",value:function(t,e,n,r,i,a){this.projectionMode=tw.ORTHOGRAPHIC,this.rright=e,this.left=t,this.top=n,this.bottom=r,this.near=i,this.far=a;var o,s=(this.rright-this.left)/(2*this.zoom),l=(this.top-this.bottom)/(2*this.zoom),u=(this.rright+this.left)/2,c=(this.top+this.bottom)/2,h=u-s,d=u+s,f=c+l,v=c-l;if(null!==(o=this.view)&&void 0!==o&&o.enabled){var p=(this.rright-this.left)/this.view.fullWidth/this.zoom,g=(this.top-this.bottom)/this.view.fullHeight/this.zoom;h+=p*this.view.offsetX,d=h+p*this.view.width,f-=g*this.view.offsetY,v=f-g*this.view.height;}return this.clipSpaceNearZ===$.NEGATIVE_ONE?G.mat4.ortho(this.projectionMatrix,h,d,f,v,i,a):G.mat4.orthoZO(this.projectionMatrix,h,d,f,v,i,a),G.mat4.invert(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this;}},{key:"setPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.position[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.position[2],r=td(t,e,n);return this._setPosition(r),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this;}},{key:"setFocalPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.focalPoint[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.focalPoint[2],r=G.vec3.fromValues(0,1,0);if(this.focalPoint=td(t,e,n),this.trackingMode===tS.CINEMATIC){var i=G.vec3.subtract(G.vec3.create(),this.focalPoint,this.position);t=i[0],e=i[1],n=i[2];var a=Math.asin(e/G.vec3.length(i))*tv,o=90+Math.atan2(n,t)*tv,s=G.mat4.create();G.mat4.rotateY(s,s,o*tf),G.mat4.rotateX(s,s,a*tf),r=G.vec3.transformMat4(G.vec3.create(),[0,1,0],s);}return G.mat4.invert(this.matrix,G.mat4.lookAt(G.mat4.create(),this.position,this.focalPoint,r)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this;}},{key:"getDistance",value:function(){return this.distance;}},{key:"getDistanceVector",value:function(){return this.distanceVector;}},{key:"setDistance",value:function(t){if(this.distance===t||t<0)return this;this.distance=t,this.distance<2e-4&&(this.distance=2e-4),this.dollyingStep=this.distance/100;var e=G.vec3.create();t=this.distance;var n=this.forward,r=this.focalPoint;return e[0]=t*n[0]+r[0],e[1]=t*n[1]+r[1],e[2]=t*n[2]+r[2],this._setPosition(e),this.triggerUpdate(),this;}},{key:"setMaxDistance",value:function(t){return this.maxDistance=t,this;}},{key:"setMinDistance",value:function(t){return this.minDistance=t,this;}},{key:"setAzimuth",value:function(t){return this.azimuth=tc(t),this.computeMatrix(),this._getAxes(),this.type===tb.ORBITING||this.type===tb.EXPLORING?this._getPosition():this.type===tb.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getAzimuth",value:function(){return this.azimuth;}},{key:"setElevation",value:function(t){return this.elevation=tc(t),this.computeMatrix(),this._getAxes(),this.type===tb.ORBITING||this.type===tb.EXPLORING?this._getPosition():this.type===tb.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getElevation",value:function(){return this.elevation;}},{key:"setRoll",value:function(t){return this.roll=tc(t),this.computeMatrix(),this._getAxes(),this.type===tb.ORBITING||this.type===tb.EXPLORING?this._getPosition():this.type===tb.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getRoll",value:function(){return this.roll;}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate();}},{key:"computeMatrix",value:function(){var t=G.quat.setAxisAngle(G.quat.create(),[0,0,1],this.roll*tf);G.mat4.identity(this.matrix);var e=G.quat.setAxisAngle(G.quat.create(),[1,0,0],(this.rotateWorld&&this.type!==tb.TRACKING||this.type===tb.TRACKING?1:-1)*this.elevation*tf),n=G.quat.setAxisAngle(G.quat.create(),[0,1,0],(this.rotateWorld&&this.type!==tb.TRACKING||this.type===tb.TRACKING?1:-1)*this.azimuth*tf),r=G.quat.multiply(G.quat.create(),n,e);r=G.quat.multiply(G.quat.create(),r,t);var i=G.mat4.fromQuat(G.mat4.create(),r);this.type===tb.ORBITING||this.type===tb.EXPLORING?(G.mat4.translate(this.matrix,this.matrix,this.focalPoint),G.mat4.multiply(this.matrix,this.matrix,i),G.mat4.translate(this.matrix,this.matrix,[0,0,this.distance])):this.type===tb.TRACKING&&(G.mat4.translate(this.matrix,this.matrix,this.position),G.mat4.multiply(this.matrix,this.matrix,i));}},{key:"_setPosition",value:function(t,e,n){this.position=td(t,e,n);var r=this.matrix;r[12]=this.position[0],r[13]=this.position[1],r[14]=this.position[2],r[15]=1,this._getOrthoMatrix();}},{key:"_getAxes",value:function(){G.vec3.copy(this.right,td(G.vec4.transformMat4(G.vec4.create(),[1,0,0,0],this.matrix))),G.vec3.copy(this.up,td(G.vec4.transformMat4(G.vec4.create(),[0,1,0,0],this.matrix))),G.vec3.copy(this.forward,td(G.vec4.transformMat4(G.vec4.create(),[0,0,1,0],this.matrix))),G.vec3.normalize(this.right,this.right),G.vec3.normalize(this.up,this.up),G.vec3.normalize(this.forward,this.forward);}},{key:"_getAngles",value:function(){var t=this.distanceVector[0],e=this.distanceVector[1],n=this.distanceVector[2],r=G.vec3.length(this.distanceVector);if(0===r){this.elevation=0,this.azimuth=0;return;}this.type===tb.TRACKING?(this.elevation=Math.asin(e/r)*tv,this.azimuth=Math.atan2(-t,-n)*tv):this.rotateWorld?(this.elevation=Math.asin(e/r)*tv,this.azimuth=Math.atan2(-t,-n)*tv):(this.elevation=-(Math.asin(e/r)*tv),this.azimuth=-(Math.atan2(-t,-n)*tv));}},{key:"_getPosition",value:function(){G.vec3.copy(this.position,td(G.vec4.transformMat4(G.vec4.create(),[0,0,0,1],this.matrix))),this._getDistance();}},{key:"_getFocalPoint",value:function(){G.vec3.transformMat3(this.distanceVector,[0,0,-this.distance],G.mat3.fromMat4(G.mat3.create(),this.matrix)),G.vec3.add(this.focalPoint,this.position,this.distanceVector),this._getDistance();}},{key:"_getDistance",value:function(){this.distanceVector=G.vec3.subtract(G.vec3.create(),this.focalPoint,this.position),this.distance=G.vec3.length(this.distanceVector),this.dollyingStep=this.distance/100;}},{key:"_getOrthoMatrix",value:function(){if(this.projectionMode===tw.ORTHOGRAPHIC){var t=this.position,e=G.quat.setAxisAngle(G.quat.create(),[0,0,1],-this.roll*Math.PI/180);G.mat4.fromRotationTranslationScaleOrigin(this.orthoMatrix,e,G.vec3.fromValues((this.rright-this.left)/2-t[0],(this.top-this.bottom)/2-t[1],0),G.vec3.fromValues(this.zoom,this.zoom,1),t);}}},{key:"triggerUpdate",value:function(){if(this.enableUpdate){var t=this.getViewTransform(),e=G.mat4.multiply(G.mat4.create(),this.getPerspective(),t);this.getFrustum().extractFromVPMatrix(e),this.eventEmitter.emit(tP.UPDATED);}}},{key:"rotate",value:function(t,e,n){throw Error(tu);}},{key:"pan",value:function(t,e){throw Error(tu);}},{key:"dolly",value:function(t){throw Error(tu);}},{key:"createLandmark",value:function(t,e){throw Error(tu);}},{key:"gotoLandmark",value:function(t,e){throw Error(tu);}},{key:"cancelLandmarkAnimation",value:function(){throw Error(tu);}}]),tA=((u={})[u.Standard=0]="Standard",u),tC=((c={})[c.ADDED=0]="ADDED",c[c.REMOVED=1]="REMOVED",c[c.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED",c),tR=G.vec3.create(),tO=G.mat4.create(),tL=G.quat.create();function tI(t){if(t.localDirtyFlag){if(0!==t.localSkew[0]||0!==t.localSkew[1]){G.mat4.fromRotationTranslationScaleOrigin(t.localTransform,t.localRotation,t.localPosition,G.vec3.fromValues(1,1,1),t.origin),(0!==t.localSkew[0]||0!==t.localSkew[1])&&(G.mat4.identity(tO),tO[4]=Math.tan(t.localSkew[0]),tO[1]=Math.tan(t.localSkew[1]),G.mat4.multiply(t.localTransform,t.localTransform,tO));var e=G.mat4.fromRotationTranslationScaleOrigin(tO,G.quat.set(tL,0,0,0,1),G.vec3.set(tR,1,1,1),t.localScale,t.origin);G.mat4.multiply(t.localTransform,t.localTransform,e);}else{var n=t.localTransform,r=t.localPosition,i=t.localRotation,a=t.localScale,o=t.origin,s=0!==r[0]||0!==r[1]||0!==r[2],l=1!==i[3]||0!==i[0]||0!==i[1]||0!==i[2],u=1!==a[0]||1!==a[1]||1!==a[2],c=0!==o[0]||0!==o[1]||0!==o[2];l||u||c?G.mat4.fromRotationTranslationScaleOrigin(n,i,r,a,o):s?G.mat4.fromTranslation(n,r):G.mat4.identity(n);}t.localDirtyFlag=!1;}}var tD={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new tl(0,0,0,0)},t_=((h={}).COORDINATE="<coordinate>",h.COLOR="<color>",h.PAINT="<paint>",h.NUMBER="<number>",h.ANGLE="<angle>",h.OPACITY_VALUE="<opacity-value>",h.SHADOW_BLUR="<shadow-blur>",h.LENGTH="<length>",h.PERCENTAGE="<percentage>",h.LENGTH_PERCENTAGE="<length> | <percentage>",h.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",h.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",h.LIST_OF_POINTS="<list-of-points>",h.PATH="<path>",h.FILTER="<filter>",h.Z_INDEX="<z-index>",h.OFFSET_DISTANCE="<offset-distance>",h.DEFINED_PATH="<defined-path>",h.MARKER="<marker>",h.TRANSFORM="<transform>",h.TRANSFORM_ORIGIN="<transform-origin>",h.TEXT="<text>",h.TEXT_TRANSFORM="<text-transform>",h);function tG(t,e,n){t.prototype=e.prototype=n,n.constructor=t;}function tF(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n;}function tB(){}var tU="\\s*([+-]?\\d+)\\s*",tV="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",tz="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",tH=/^#([0-9a-f]{3,8})$/,tY=RegExp(`^rgb\\(${tU},${tU},${tU}\\)$`),tW=RegExp(`^rgb\\(${tz},${tz},${tz}\\)$`),tq=RegExp(`^rgba\\(${tU},${tU},${tU},${tV}\\)$`),tX=RegExp(`^rgba\\(${tz},${tz},${tz},${tV}\\)$`),tj=RegExp(`^hsl\\(${tV},${tz},${tz}\\)$`),t$=RegExp(`^hsla\\(${tV},${tz},${tz},${tV}\\)$`),tK={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function tZ(){return this.rgb().formatHex();}function tQ(){return this.rgb().formatRgb();}function tJ(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=tH.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?t0(e):3===n?new t2(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?t1(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?t1(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=tY.exec(t))?new t2(e[1],e[2],e[3],1):(e=tW.exec(t))?new t2(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=tq.exec(t))?t1(e[1],e[2],e[3],e[4]):(e=tX.exec(t))?t1(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=tj.exec(t))?t9(e[1],e[2]/100,e[3]/100,1):(e=t$.exec(t))?t9(e[1],e[2]/100,e[3]/100,e[4]):tK.hasOwnProperty(t)?t0(tK[t]):"transparent"===t?new t2(NaN,NaN,NaN,0):null;}function t0(t){return new t2(t>>16&255,t>>8&255,255&t,1);}function t1(t,e,n,r){return r<=0&&(t=e=n=NaN),new t2(t,e,n,r);}function t2(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r;}function t3(){return`#${t7(this.r)}${t7(this.g)}${t7(this.b)}`;}function t4(){let t=t5(this.opacity);return`${1===t?"rgb(":"rgba("}${t6(this.r)}, ${t6(this.g)}, ${t6(this.b)}${1===t?")":`, ${t})`}`;}function t5(t){return isNaN(t)?1:Math.max(0,Math.min(1,t));}function t6(t){return Math.max(0,Math.min(255,Math.round(t)||0));}function t7(t){return((t=t6(t))<16?"0":"")+t.toString(16);}function t9(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new et(t,e,n,r);}function t8(t){if(t instanceof et)return new et(t.h,t.s,t.l,t.opacity);if(t instanceof tB||(t=tJ(t)),!t)return new et;if(t instanceof et)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,l=(a+i)/2;return s?(o=e===a?(n-r)/s+(n<r)*6:n===a?(r-e)/s+2:(e-n)/s+4,s/=l<.5?a+i:2-a-i,o*=60):s=l>0&&l<1?0:o,new et(o,s,l,t.opacity);}function et(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r;}function ee(t){return(t=(t||0)%360)<0?t+360:t;}function en(t){return Math.max(0,Math.min(1,t||0));}function er(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255;}function ei(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw TypeError("Expected a function");var n=function(){for(var r=arguments.length,i=Array(r),a=0;a<r;a++)i[a]=arguments[a];var o=e?e.apply(this,i):i[0],s=n.cache;if(s.has(o))return s.get(o);var l=t.apply(this,i);return n.cache=s.set(o,l)||s,l;};return n.cache=new(ei.Cache||Map),ei.cacheList.push(n.cache),n;}tG(tB,tJ,{copy(t){return Object.assign(new this.constructor,this,t);},displayable(){return this.rgb().displayable();},hex:tZ,formatHex:tZ,formatHex8:function(){return this.rgb().formatHex8();},formatHsl:function(){return t8(this).formatHsl();},formatRgb:tQ,toString:tQ}),tG(t2,function(t,e,n,r){var i;return 1==arguments.length?((i=t)instanceof tB||(i=tJ(i)),i)?new t2((i=i.rgb()).r,i.g,i.b,i.opacity):new t2:new t2(t,e,n,null==r?1:r);},tF(tB,{brighter(t){return t=null==t?1.4285714285714286:Math.pow(1.4285714285714286,t),new t2(this.r*t,this.g*t,this.b*t,this.opacity);},darker(t){return t=null==t?.7:Math.pow(.7,t),new t2(this.r*t,this.g*t,this.b*t,this.opacity);},rgb(){return this;},clamp(){return new t2(t6(this.r),t6(this.g),t6(this.b),t5(this.opacity));},displayable(){return -.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1;},hex:t3,formatHex:t3,formatHex8:function(){return`#${t7(this.r)}${t7(this.g)}${t7(this.b)}${t7((isNaN(this.opacity)?1:this.opacity)*255)}`;},formatRgb:t4,toString:t4})),tG(et,function(t,e,n,r){return 1==arguments.length?t8(t):new et(t,e,n,null==r?1:r);},tF(tB,{brighter(t){return t=null==t?1.4285714285714286:Math.pow(1.4285714285714286,t),new et(this.h,this.s,this.l*t,this.opacity);},darker(t){return t=null==t?.7:Math.pow(.7,t),new et(this.h,this.s,this.l*t,this.opacity);},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new t2(er(t>=240?t-240:t+120,i,r),er(t,i,r),er(t<120?t+240:t-120,i,r),this.opacity);},clamp(){return new et(ee(this.h),en(this.s),en(this.l),t5(this.opacity));},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1;},formatHsl(){let t=t5(this.opacity);return`${1===t?"hsl(":"hsla("}${ee(this.h)}, ${100*en(this.s)}%, ${100*en(this.l)}%${1===t?")":`, ${t})`}`;}})),ei.Cache=Map,ei.cacheList=[],ei.clearCache=function(){ei.cacheList.forEach(function(t){return t.clear();});};var ea=((d={})[d.kUnknown=0]="kUnknown",d[d.kNumber=1]="kNumber",d[d.kPercentage=2]="kPercentage",d[d.kEms=3]="kEms",d[d.kPixels=4]="kPixels",d[d.kRems=5]="kRems",d[d.kDegrees=6]="kDegrees",d[d.kRadians=7]="kRadians",d[d.kGradians=8]="kGradians",d[d.kTurns=9]="kTurns",d[d.kMilliseconds=10]="kMilliseconds",d[d.kSeconds=11]="kSeconds",d[d.kInteger=12]="kInteger",d),eo=((f={})[f.kUNumber=0]="kUNumber",f[f.kUPercent=1]="kUPercent",f[f.kULength=2]="kULength",f[f.kUAngle=3]="kUAngle",f[f.kUTime=4]="kUTime",f[f.kUOther=5]="kUOther",f),es=((v={})[v.kYes=0]="kYes",v[v.kNo=1]="kNo",v),el=((p={})[p.kYes=0]="kYes",p[p.kNo=1]="kNo",p),eu=[{name:"em",unit_type:ea.kEms},{name:"px",unit_type:ea.kPixels},{name:"deg",unit_type:ea.kDegrees},{name:"rad",unit_type:ea.kRadians},{name:"grad",unit_type:ea.kGradians},{name:"ms",unit_type:ea.kMilliseconds},{name:"s",unit_type:ea.kSeconds},{name:"rem",unit_type:ea.kRems},{name:"turn",unit_type:ea.kTurns}],ec=((g={})[g.kUnknownType=0]="kUnknownType",g[g.kUnparsedType=1]="kUnparsedType",g[g.kKeywordType=2]="kKeywordType",g[g.kUnitType=3]="kUnitType",g[g.kSumType=4]="kSumType",g[g.kProductType=5]="kProductType",g[g.kNegateType=6]="kNegateType",g[g.kInvertType=7]="kInvertType",g[g.kMinType=8]="kMinType",g[g.kMaxType=9]="kMaxType",g[g.kClampType=10]="kClampType",g[g.kTransformType=11]="kTransformType",g[g.kPositionType=12]="kPositionType",g[g.kURLImageType=13]="kURLImageType",g[g.kColorType=14]="kColorType",g[g.kUnsupportedColorType=15]="kUnsupportedColorType",g),eh=function(t){switch(t){case ea.kNumber:case ea.kInteger:return eo.kUNumber;case ea.kPercentage:return eo.kUPercent;case ea.kPixels:return eo.kULength;case ea.kMilliseconds:case ea.kSeconds:return eo.kUTime;case ea.kDegrees:case ea.kRadians:case ea.kGradians:case ea.kTurns:return eo.kUAngle;default:return eo.kUOther;}},ed=function(t){switch(t){case eo.kUNumber:return ea.kNumber;case eo.kULength:return ea.kPixels;case eo.kUPercent:return ea.kPercentage;case eo.kUTime:return ea.kSeconds;case eo.kUAngle:return ea.kDegrees;default:return ea.kUnknown;}},ef=function(t){var e=1;switch(t){case ea.kPixels:case ea.kDegrees:case ea.kSeconds:break;case ea.kMilliseconds:e=.001;break;case ea.kRadians:e=180/Math.PI;break;case ea.kGradians:e=.9;break;case ea.kTurns:e=360;}return e;},ev=function(t){switch(t){case ea.kNumber:case ea.kInteger:break;case ea.kPercentage:return"%";case ea.kEms:return"em";case ea.kRems:return"rem";case ea.kPixels:return"px";case ea.kDegrees:return"deg";case ea.kRadians:return"rad";case ea.kGradians:return"grad";case ea.kMilliseconds:return"ms";case ea.kSeconds:return"s";case ea.kTurns:return"turn";}return"";},ep=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"toString",value:function(){return this.buildCSSText(es.kNo,el.kNo,"");}},{key:"isNumericValue",value:function(){return this.getType()>=ec.kUnitType&&this.getType()<=ec.kClampType;}}],[{key:"isAngle",value:function(t){return t===ea.kDegrees||t===ea.kRadians||t===ea.kGradians||t===ea.kTurns;}},{key:"isLength",value:function(t){return t>=ea.kEms&&t<ea.kDegrees;}},{key:"isRelativeUnit",value:function(t){return t===ea.kPercentage||t===ea.kEms||t===ea.kRems;}},{key:"isTime",value:function(t){return t===ea.kSeconds||t===ea.kMilliseconds;}}]),eg=function(t){function e(t){var n;return(0,C.default)(this,e),(n=(0,L.default)(this,e)).colorSpace=t,n;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getType",value:function(){return ec.kColorType;}},{key:"to",value:function(t){return this;}}]);}(ep),ey=((y={})[y.Constant=0]="Constant",y[y.LinearGradient=1]="LinearGradient",y[y.RadialGradient=2]="RadialGradient",y),em=function(t){function e(t,n){var r;return(0,C.default)(this,e),(r=(0,L.default)(this,e)).type=t,r.value=n,r;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return new e(this.type,this.value);}},{key:"buildCSSText",value:function(t,e,n){return n;}},{key:"getType",value:function(){return ec.kColorType;}}]);}(ep),ek=function(t){function e(t){var n;return(0,C.default)(this,e),(n=(0,L.default)(this,e)).value=t,n;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return new e(this.value);}},{key:"getType",value:function(){return ec.kKeywordType;}},{key:"buildCSSText",value:function(t,e,n){return n+this.value;}}]);}(ep),eE=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(Number.isFinite(t)?"NaN":t>0?"infinity":"-infinity")+e;},ex=function(t){return ed(eh(t));},eT=function(t){function e(t){var n,r,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ea.kNumber;return(0,C.default)(this,e),r=(0,L.default)(this,e),i="string"==typeof a?(n=a)?"number"===n?ea.kNumber:"percent"===n||"%"===n?ea.kPercentage:eu.find(function(t){return t.name===n;}).unit_type:ea.kUnknown:a,r.unit=i,r.value=t,r;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return new e(this.value,this.unit);}},{key:"equals",value:function(t){return this.value===t.value&&this.unit===t.unit;}},{key:"getType",value:function(){return ec.kUnitType;}},{key:"convertTo",value:function(t){if(this.unit===t)return new e(this.value,this.unit);var n=ex(this.unit);if(n!==ex(t)||n===ea.kUnknown)return null;var r=ef(this.unit)/ef(t);return new e(this.value*r,t);}},{key:"buildCSSText",value:function(t,e,n){var r;switch(this.unit){case ea.kUnknown:break;case ea.kInteger:r=Number(this.value).toFixed(0);break;case ea.kNumber:case ea.kPercentage:case ea.kEms:case ea.kRems:case ea.kPixels:case ea.kDegrees:case ea.kRadians:case ea.kGradians:case ea.kMilliseconds:case ea.kSeconds:case ea.kTurns:var i=this.value,a=ev(this.unit);if(i<-999999||i>999999){var o=ev(this.unit);r=!Number.isFinite(i)||Number.isNaN(i)?eE(i,o):i+(o||"");}else r="".concat(i).concat(a);}return n+r;}}]);}(ep),eN=new eT(0,"px");new eT(1,"px");var eb=new eT(0,"deg"),eS=function(t){function e(t,n,r){var i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return(0,C.default)(this,e),(i=(0,L.default)(this,e,["rgb"])).r=t,i.g=n,i.b=r,i.alpha=a,i.isNone=o,i;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return new e(this.r,this.g,this.b,this.alpha);}},{key:"buildCSSText",value:function(t,e,n){return"".concat(n,"rgba(").concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")");}}]);}(eg),ew=new ek("unset"),eP={"":ew,unset:ew,initial:new ek("initial"),inherit:new ek("inherit")},eM=new eS(0,0,0,0,!0),eA=new eS(0,0,0,0),eC=ei(function(t,e,n,r){return new eS(t,e,n,r);},function(t,e,n,r){return"rgba(".concat(t,",").concat(e,",").concat(n,",").concat(r,")");}),eR=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ea.kNumber;return new eT(t,e);};new eT(50,"%");var eO=function(){var t={linearGradient:/^(linear\-gradient)/i,repeatingLinearGradient:/^(repeating\-linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,repeatingRadialGradient:/^(repeating\-radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},e="";function n(t){throw Error("".concat(e,": ").concat(t));}function r(){return i("linear-gradient",t.linearGradient,o)||i("repeating-linear-gradient",t.repeatingLinearGradient,o)||i("radial-gradient",t.radialGradient,s)||i("repeating-radial-gradient",t.repeatingRadialGradient,s)||i("conic-gradient",t.conicGradient,s);}function i(e,r,i){return a(r,function(r){var a=i();return a&&!m(t.comma)&&n("Missing comma before color stops"),{type:e,orientation:a,colorStops:d(f)};});}function a(e,r){var i=m(e);if(i){m(t.startCall)||n("Missing (");var a=r(i);return m(t.endCall)||n("Missing )"),a;}}function o(){return y("directional",t.sideOrCorner,1)||y("angular",t.angleValue,1);}function s(){var n,r,i=l();return i&&((n=[]).push(i),r=e,m(t.comma)&&((i=l())?n.push(i):e=r)),n;}function l(){var t,e,n=((t=y("shape",/^(circle)/i,0))&&(t.style=g()||u()),t||((e=y("shape",/^(ellipse)/i,0))&&(e.style=p()||u()),e));if(n)n.at=c();else{var r=u();if(r){n=r;var i=c();i&&(n.at=i);}else{var a=h();a&&(n={type:"default-radial",at:a});}}return n;}function u(){return y("extent-keyword",t.extentKeywords,1);}function c(){if(y("position",/^at/,0)){var t=h();return t||n("Missing positioning value"),t;}}function h(){var t={x:p(),y:p()};if(t.x||t.y)return{type:"position",value:t};}function d(e){var r=e(),i=[];if(r)for(i.push(r);m(t.comma);)(r=e())?i.push(r):n("One extra comma");return i;}function f(){var e=y("hex",t.hexColor,1)||a(t.rgbaColor,function(){return{type:"rgba",value:d(v)};})||a(t.rgbColor,function(){return{type:"rgb",value:d(v)};})||y("literal",t.literalColor,0);return e||n("Expected color definition"),e.length=p(),e;}function v(){return m(t.number)[1];}function p(){return y("%",t.percentageValue,1)||y("position-keyword",t.positionKeywords,1)||g();}function g(){return y("px",t.pixelValue,1)||y("em",t.emValue,1);}function y(t,e,n){var r=m(e);if(r)return{type:t,value:r[n]};}function m(t){var n=/^[\n\r\t\s]+/.exec(e);n&&k(n[0].length);var r=t.exec(e);return r&&k(r[0].length),r;}function k(t){e=e.substring(t);}return function(t){var i;return e=t,i=d(r),e.length>0&&n("Invalid input not EOF"),i;};}(),eL=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,eI=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,eD=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,e_=/[\d.]+:(#[^\s]+|[^\)]+\))/gi,eG={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},eF=ei(function(t){return eR("angular"===t.type?Number(t.value):eG[t.value]||0,"deg");}),eB=ei(function(t){var e=50,n=50,r="%",i="%";if((null==t?void 0:t.type)==="position"){var a=t.value,o=a.x,s=a.y;(null==o?void 0:o.type)==="position-keyword"&&("left"===o.value?e=0:"center"===o.value?e=50:"right"===o.value?e=100:"top"===o.value?n=0:"bottom"===o.value&&(n=100)),(null==s?void 0:s.type)==="position-keyword"&&("left"===s.value?e=0:"center"===s.value?n=50:"right"===s.value?e=100:"top"===s.value?n=0:"bottom"===s.value&&(n=100)),((null==o?void 0:o.type)==="px"||(null==o?void 0:o.type)==="%"||(null==o?void 0:o.type)==="em")&&(r=null==o?void 0:o.type,e=Number(o.value)),((null==s?void 0:s.type)==="px"||(null==s?void 0:s.type)==="%"||(null==s?void 0:s.type)==="em")&&(i=null==s?void 0:s.type,n=Number(s.value));}return{cx:eR(e,r),cy:eR(n,i)};}),eU=ei(function(t){if(t.indexOf("linear")>-1||t.indexOf("radial")>-1)return eO(t).map(function(t){var e=t.type,n=t.orientation,r=t.colorStops;!function(t){var e=t.length;t[e-1].length=null!==(a=t[e-1].length)&&void 0!==a?a:{type:"%",value:"100"},e>1&&(t[0].length=null!==(o=t[0].length)&&void 0!==o?o:{type:"%",value:"0"});for(var n=0,r=Number(t[0].length.value),i=1;i<e;i++){var a,o,s,l=null===(s=t[i].length)||void 0===s?void 0:s.value;if(!(0,F.isNil)(l)&&!(0,F.isNil)(r)){for(var u=1;u<i-n;u++)t[n+u].length={type:"%",value:"".concat(r+(Number(l)-r)*u/(i-n))};n=i,r=Number(l);}}}(r);var i=r.map(function(t){var e,n;return{offset:eR(Number(t.length.value),"%"),color:(e=t.type,n=t.value,"hex"===e?"#".concat(n):"literal"===e?n:"rgb"===e?"rgb(".concat(n.join(","),")"):"rgba(".concat(n.join(","),")"))};});if("linear-gradient"===e)return new em(ey.LinearGradient,{angle:n?eF(n):eb,steps:i});if("radial-gradient"===e&&(n||(n=[{type:"shape",value:"circle"}]),"shape"===n[0].type&&"circle"===n[0].value)){var a,o=eB(n[0].at),s=o.cx,l=o.cy;if(n[0].style){var u=n[0].style,c=u.type,h=u.value;"extent-keyword"===c?(eP[h]||(eP[h]=new ek(h)),a=eP[h]):a=eR(h,c);}return new em(ey.RadialGradient,{cx:s,cy:l,size:a,steps:i});}});var e=t[0];if("("===t[1]||"("===t[2]){if("l"===e){var n=eL.exec(t);if(n){var r,i=(null===(r=n[2].match(e_))||void 0===r?void 0:r.map(function(t){return t.split(":");}))||[];return[new em(ey.LinearGradient,{angle:eR(parseFloat(n[1]),"deg"),steps:i.map(function(t){var e=(0,D.default)(t,2),n=e[0],r=e[1];return{offset:eR(100*Number(n),"%"),color:r};})})];}}else if("r"===e){var a=function(t){var e=eI.exec(t);if(e){var n,r=(null===(n=e[4].match(e_))||void 0===n?void 0:n.map(function(t){return t.split(":");}))||[];return{cx:eR(50,"%"),cy:eR(50,"%"),steps:r.map(function(t){var e=(0,D.default)(t,2),n=e[0],r=e[1];return{offset:eR(100*Number(n),"%"),color:r};})};}return null;}(t);if(a){if(!(0,F.isString)(a))return[new em(ey.RadialGradient,a)];t=a;}}else if("p"===e)return function(t){var e=eD.exec(t);if(e){var n=e[1],r=e[2];switch(n){case"a":n="repeat";break;case"x":n="repeat-x";break;case"y":n="repeat-y";break;default:n="no-repeat";}return{image:r,repetition:n};}return null;}(t);}});function eV(t){return t&&!!t.image;}function ez(t){return t&&!(0,F.isNil)(t.r)&&!(0,F.isNil)(t.g)&&!(0,F.isNil)(t.b);}var eH=ei(function(t){if(eV(t))return(0,A.default)({repetition:"repeat"},t);if((0,F.isNil)(t)&&(t=""),"transparent"===t)return eA;if("currentColor"===t)t="black";else if("none"===t)return eM;var e=eU(t);if(e)return e;var n=tJ(t),r=[0,0,0,0];return null!==n&&(r[0]=n.r||0,r[1]=n.g||0,r[2]=n.b||0,r[3]=n.opacity),eC.apply(void 0,r);});function eY(t,e){if(ez(t)&&ez(e))return[[Number(t.r),Number(t.g),Number(t.b),Number(t.alpha)],[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],function(t){var e=t.slice();if(e[3])for(var n=0;n<3;n++)e[n]=Math.round((0,F.clamp)(e[n],0,255));return e[3]=(0,F.clamp)(e[3],0,1),"rgba(".concat(e.join(","),")");}];}function eW(t,e){if((0,F.isNil)(e))return eR(0,"px");if(isFinite(Number(e="".concat(e).trim().toLowerCase()))){if("px".search(t)>=0)return eR(Number(e),"px");if("deg".search(t)>=0)return eR(Number(e),"deg");}var n=[];e=e.replace(t,function(t){return n.push(t),"U".concat(t);});var r="U(".concat(t.source,")");return n.map(function(t){return eR(Number(e.replace(RegExp("U".concat(t),"g"),"").replace(RegExp(r,"g"),"*0")),t);})[0];}var eq=function(t){return eW(/px/g,t);},eX=ei(eq);ei(function(t){return eW(RegExp("%","g"),t);});var ej=function(t){return(0,F.isNumber)(t)||isFinite(Number(t))?eR(Number(t)||0,"px"):eW(RegExp("px|%|em|rem","g"),t);},e$=ei(ej),eK=function(t){return eW(RegExp("deg|rad|grad|turn","g"),t);},eZ=ei(eK);function eQ(t){var e=0;return t.unit===ea.kDegrees?e=t.value:t.unit===ea.kRadians?e=Number(t.value)*tv:t.unit===ea.kTurns?e=360*Number(t.value):t.value&&(e=t.value),e;}function eJ(t,e){var n;return(Array.isArray(t)?n=t.map(function(t){return Number(t);}):(0,F.isString)(t)?n=t.split(" ").map(function(t){return Number(t);}):(0,F.isNumber)(t)&&(n=[t]),2===e)?1===n.length?[n[0],n[0]]:[n[0],n[1]]:4===e?1===n.length?[n[0],n[0],n[0],n[0]]:2===n.length?[n[0],n[1],n[0],n[1]]:3===n.length?[n[0],n[1],n[2],n[1]]:[n[0],n[1],n[2],n[3]]:"even"===e&&n.length%2==1?[].concat((0,O.default)(n),(0,O.default)(n)):n;}function e0(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t.unit===ea.kPixels)return Number(t.value);if(t.unit===ea.kPercentage&&n){var i=n.nodeName===j.GROUP?n.getLocalBounds():n.getGeometryBounds();return(r?i.min[e]:0)+t.value/100*i.halfExtents[e]*2;}return 0;}var e1=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function e2(t){return t.toString();}var e3=function(t){return"number"==typeof t?eR(t):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(t)?eR(Number(t)):eR(0);},e4=ei(e3);function e5(t,e){return[t,e,e2];}function e6(t,e){return function(n,r){return[n,r,function(n){return e2((0,F.clamp)(n,t,e));}];};}function e7(t,e){if(t.length===e.length)return[t,e,function(t){return t;}];}function e9(t){return 0===t.parsedStyle.d.totalLength&&(t.parsedStyle.d.totalLength=(0,F.getTotalLength)(t.parsedStyle.d.absolutePath)),t.parsedStyle.d.totalLength;}function e8(t,e){return t[0]===e[0]&&t[1]===e[1];}function nt(t,e){var n=t.prePoint,r=t.currentPoint,i=t.nextPoint,a=Math.pow(r[0]-n[0],2)+Math.pow(r[1]-n[1],2),o=Math.pow(r[0]-i[0],2)+Math.pow(r[1]-i[1],2),s=Math.acos((a+o-(Math.pow(n[0]-i[0],2)+Math.pow(n[1]-i[1],2)))/(2*Math.sqrt(a)*Math.sqrt(o)));if(!s||0===Math.sin(s)||(0,F.isNumberEqual)(s,0))return{xExtra:0,yExtra:0};var l=Math.abs(Math.atan2(i[1]-r[1],i[0]-r[0])),u=Math.abs(Math.atan2(i[0]-r[0],i[1]-r[1]));return{xExtra:e/2*(1/Math.sin(s/2))*Math.cos(s/2-(l=l>Math.PI/2?Math.PI-l:l))-e/2||0,yExtra:e/2*(1/Math.sin(s/2))*Math.cos((u=u>Math.PI/2?Math.PI-u:u)-s/2)-e/2||0};}function ne(t,e){return[e[0]+(e[0]-t[0]),e[1]+(e[1]-t[1])];}ei(function(t){return(0,F.isString)(t)?t.split(" ").map(e4):t.map(e4);});var nn=function(t,e){var n=t.x*e.x+t.y*e.y,r=Math.sqrt((Math.pow(t.x,2)+Math.pow(t.y,2))*(Math.pow(e.x,2)+Math.pow(e.y,2)));return(t.x*e.y-t.y*e.x<0?-1:1)*Math.acos(n/r);},nr=function(t,e,n,r,i,a,o,s){e=Math.abs(e),n=Math.abs(n);var l=(r=(0,F.mod)(r,360))*tf;if(t.x===o.x&&t.y===o.y)return{x:t.x,y:t.y,ellipticalArcAngle:0};if(0===e||0===n)return{x:0,y:0,ellipticalArcAngle:0};var u=(t.x-o.x)/2,c=(t.y-o.y)/2,h={x:Math.cos(l)*u+Math.sin(l)*c,y:-Math.sin(l)*u+Math.cos(l)*c},d=Math.pow(h.x,2)/Math.pow(e,2)+Math.pow(h.y,2)/Math.pow(n,2);d>1&&(e*=Math.sqrt(d),n*=Math.sqrt(d));var f=(Math.pow(e,2)*Math.pow(n,2)-Math.pow(e,2)*Math.pow(h.y,2)-Math.pow(n,2)*Math.pow(h.x,2))/(Math.pow(e,2)*Math.pow(h.y,2)+Math.pow(n,2)*Math.pow(h.x,2)),v=(i!==a?1:-1)*Math.sqrt(f=f<0?0:f),p={x:v*(e*h.y/n),y:v*(-(n*h.x)/e)},g={x:Math.cos(l)*p.x-Math.sin(l)*p.y+(t.x+o.x)/2,y:Math.sin(l)*p.x+Math.cos(l)*p.y+(t.y+o.y)/2},y={x:(h.x-p.x)/e,y:(h.y-p.y)/n},m=nn({x:1,y:0},y),k=nn(y,{x:(-h.x-p.x)/e,y:(-h.y-p.y)/n});!a&&k>0?k-=2*Math.PI:a&&k<0&&(k+=2*Math.PI);var E=m+(k%=2*Math.PI)*s,x=e*Math.cos(E),T=n*Math.sin(E);return{x:Math.cos(l)*x-Math.sin(l)*T+g.x,y:Math.sin(l)*x+Math.cos(l)*T+g.y,ellipticalArcStartAngle:m,ellipticalArcEndAngle:m+k,ellipticalArcAngle:E,ellipticalArcCenter:g,resultantRx:e,resultantRy:n};};function ni(t,e){var n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=t.arcParams,i=r.rx,a=void 0===i?0:i,o=r.ry,s=void 0===o?0:o,l=r.xRotation,u=r.arcFlag,c=r.sweepFlag,h=nr({x:t.prePoint[0],y:t.prePoint[1]},a,s,l,!!u,!!c,{x:t.currentPoint[0],y:t.currentPoint[1]},e),d=nr({x:t.prePoint[0],y:t.prePoint[1]},a,s,l,!!u,!!c,{x:t.currentPoint[0],y:t.currentPoint[1]},n?e+.005:e-.005),f=d.x-h.x,v=d.y-h.y,p=Math.sqrt(f*f+v*v);return{x:-f/p,y:-v/p};}function na(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1]);}function no(t,e){return na(t)*na(e)?(t[0]*e[0]+t[1]*e[1])/(na(t)*na(e)):1;}function ns(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(no(t,e));}var nl=function(t){if(""===t||Array.isArray(t)&&0===t.length)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};try{e=(0,F.normalizePath)(t);}catch(n){e=(0,F.normalizePath)(""),console.error("[g]: Invalid SVG Path definition: ".concat(t));}!function(t){for(var e=0;e<t.length;e++){var n=t[e-1],r=t[e];if("M"===r[0]&&n){var i=n[0],a=[r[1],r[2]],o=void 0;"L"===i||"M"===i?o=[n[1],n[2]]:("C"===i||"A"===i||"Q"===i)&&(o=[n[n.length-2],n[n.length-1]]),o&&e8(a,o)&&(t.splice(e,1),e--);}}}(e);var e,n=function(t){for(var e=!1,n=t.length,r=0;r<n;r++){var i=t[r][0];if("C"===i||"A"===i||"Q"===i){e=!0;break;}}return e;}(e),r=function(t){for(var e=[],n=[],r=[],i=0;i<t.length;i++){var a=t[i],o=a[0];"M"===o?(r.length&&(n.push(r),r=[]),r.push([a[1],a[2]])):"Z"===o?r.length&&(e.push(r),r=[]):r.push([a[1],a[2]]);}return r.length>0&&n.push(r),{polygons:e,polylines:n};}(e),i=r.polygons,a=r.polylines,o=function(t){for(var e=[],n=null,r=null,i=null,a=0,o=t.length,s=0;s<o;s++){var l=t[s];r=t[s+1];var u=l[0],c={command:u,prePoint:n,params:l,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(u){case"M":i=[l[1],l[2]],a=s;break;case"A":var h=function(t,e){var n=e[1],r=e[2],i=(0,F.mod)(e[3]*tf,2*Math.PI),a=e[4],o=e[5],s=t[0],l=t[1],u=e[6],c=e[7],h=Math.cos(i)*(s-u)/2+Math.sin(i)*(l-c)/2,d=-1*Math.sin(i)*(s-u)/2+Math.cos(i)*(l-c)/2,f=h*h/(n*n)+d*d/(r*r);f>1&&(n*=Math.sqrt(f),r*=Math.sqrt(f));var v=n*n*(d*d)+r*r*(h*h),p=v?Math.sqrt((n*n*(r*r)-v)/v):1;a===o&&(p*=-1),isNaN(p)&&(p=0);var g=r?p*n*d/r:0,y=n?-(p*r)*h/n:0,m=(s+u)/2+Math.cos(i)*g-Math.sin(i)*y,k=(l+c)/2+Math.sin(i)*g+Math.cos(i)*y,E=[(h-g)/n,(d-y)/r],x=[(-1*h-g)/n,(-1*d-y)/r],T=ns([1,0],E),N=ns(E,x);return -1>=no(E,x)&&(N=Math.PI),no(E,x)>=1&&(N=0),0===o&&N>0&&(N-=2*Math.PI),1===o&&N<0&&(N+=2*Math.PI),{cx:m,cy:k,rx:e8(t,[u,c])?0:n,ry:e8(t,[u,c])?0:r,startAngle:T,endAngle:T+N,xRotation:i,arcFlag:a,sweepFlag:o};}(n,l);c.arcParams=h;}if("Z"===u)n=i,r=t[a+1];else{var d=l.length;n=[l[d-2],l[d-1]];}r&&"Z"===r[0]&&(r=t[a],e[a]&&(e[a].prePoint=n)),c.currentPoint=n,e[a]&&e8(n,e[a].currentPoint)&&(e[a].prePoint=c.prePoint);var f=r?[r[r.length-2],r[r.length-1]]:null;c.nextPoint=f;var v=c.prePoint;if(["L","H","V"].includes(u))c.startTangent=[v[0]-n[0],v[1]-n[1]],c.endTangent=[n[0]-v[0],n[1]-v[1]];else if("Q"===u){var p=[l[1],l[2]];c.startTangent=[v[0]-p[0],v[1]-p[1]],c.endTangent=[n[0]-p[0],n[1]-p[1]];}else if("T"===u){var g=e[s-1],y=ne(g.currentPoint,v);"Q"===g.command?(c.command="Q",c.startTangent=[v[0]-y[0],v[1]-y[1]],c.endTangent=[n[0]-y[0],n[1]-y[1]]):(c.command="TL",c.startTangent=[v[0]-n[0],v[1]-n[1]],c.endTangent=[n[0]-v[0],n[1]-v[1]]);}else if("C"===u){var m=[l[1],l[2]],k=[l[3],l[4]];c.startTangent=[v[0]-m[0],v[1]-m[1]],c.endTangent=[n[0]-k[0],n[1]-k[1]],0===c.startTangent[0]&&0===c.startTangent[1]&&(c.startTangent=[m[0]-k[0],m[1]-k[1]]),0===c.endTangent[0]&&0===c.endTangent[1]&&(c.endTangent=[k[0]-m[0],k[1]-m[1]]);}else if("S"===u){var E=e[s-1],x=ne(E.currentPoint,v),T=[l[1],l[2]];"C"===E.command?(c.command="C",c.startTangent=[v[0]-x[0],v[1]-x[1]]):(c.command="SQ",c.startTangent=[v[0]-T[0],v[1]-T[1]]),c.endTangent=[n[0]-T[0],n[1]-T[1]];}else if("A"===u){var N=ni(c,0),b=N.x,S=N.y,w=ni(c,1,!1),P=w.x,M=w.y;c.startTangent=[b,S],c.endTangent=[P,M];}e.push(c);}return e;}(e),s=function(t,e){for(var n=[],r=[],i=[],a=0;a<t.length;a++){var o=t[a],s=o.currentPoint,l=o.params,u=o.prePoint,c=void 0;switch(o.command){case"Q":c=(0,z.quadBox)(u[0],u[1],l[1],l[2],l[3],l[4]);break;case"C":c=(0,z.cubicBox)(u[0],u[1],l[1],l[2],l[3],l[4],l[5],l[6]);break;case"A":var h=o.arcParams;c=(0,z.arcBox)(h.cx,h.cy,h.rx,h.ry,h.xRotation,h.startAngle,h.endAngle);break;default:n.push(s[0]),r.push(s[1]);}c&&(o.box=c,n.push(c.x,c.x+c.width),r.push(c.y,c.y+c.height));}n=n.filter(function(t){return!Number.isNaN(t)&&t!==1/0&&t!==-1/0;}),r=r.filter(function(t){return!Number.isNaN(t)&&t!==1/0&&t!==-1/0;});var d=(0,F.min)(n),f=(0,F.min)(r),v=(0,F.max)(n),p=(0,F.max)(r);if(0===i.length)return{x:d,y:f,width:v-d,height:p-f};for(var g=0;g<i.length;g++){var y=i[g],m=y.currentPoint;m[0]===d?d-=nt(y,0).xExtra:m[0]===v&&(v+=nt(y,0).xExtra),m[1]===f?f-=nt(y,e).yExtra:m[1]===p&&(p+=nt(y,e).yExtra);}return{x:d,y:f,width:v-d,height:p-f};}(o,0),l=s.x,u=s.y,c=s.width,h=s.height;return{absolutePath:e,hasArc:n,segments:o,polygons:i,polylines:a,totalLength:0,rect:{x:Number.isFinite(l)?l:0,y:Number.isFinite(u)?u:0,width:Number.isFinite(c)?c:0,height:Number.isFinite(h)?h:0}};},nu=ei(nl);function nc(t){return(0,F.isString)(t)?nu(t):nl(t);}function nh(t,e,n){var r=t.curve,i=e.curve;r&&0!==r.length||(r=(0,F.path2Curve)(t.absolutePath,!1),t.curve=r),i&&0!==i.length||(i=(0,F.path2Curve)(e.absolutePath,!1),e.curve=i);var a=[r,i];r.length!==i.length&&(a=(0,F.equalizeSegments)(r,i));var o=(0,F.getDrawDirection)(a[0])!==(0,F.getDrawDirection)(a[1])?(0,F.reverseCurve)(a[0]):(0,F.clonePath)(a[0]);return[o,(0,F.getRotatedCurve)(a[1],o),function(t){return t;}];}function nd(t,e){return[t.points,e.points,function(t){return t;}];}var nf=/\s*(\w+)\(([^)]*)\)/g;function nv(t){return function(e){var n=0;return t.map(function(t){return null===t?e[n++]:t;});};}function np(t){return t;}var ng={matrix:["NNNNNN",[null,null,0,0,null,null,0,0,0,0,1,0,null,null,0,1],np],matrix3d:["NNNNNNNNNNNNNNNN",np],rotate:["A"],rotateX:["A"],rotateY:["A"],rotateZ:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",nv([null,null,new eT(1)]),np],scaleX:["N",nv([null,new eT(1),new eT(1)]),nv([null,new eT(1)])],scaleY:["N",nv([new eT(1),null,new eT(1)]),nv([new eT(1),null])],scaleZ:["N",nv([new eT(1),new eT(1),null])],scale3d:["NNN",np],skew:["Aa",null,np],skewX:["A",null,nv([null,eb])],skewY:["A",null,nv([eb,null])],translate:["Tt",nv([null,null,eN]),np],translateX:["T",nv([null,eN,eN]),nv([null,eN])],translateY:["T",nv([eN,null,eN]),nv([eN,null])],translateZ:["L",nv([eN,eN,null])],translate3d:["TTL",np]};function ny(t){for(var e=[],n=t.length,r=0;r<n;r++){var i=t[r],a=i[0],o=i.slice(1);if("translate"===a||"skew"===a?1===o.length&&o.push(0):"scale"===a&&1===o.length&&o.push(o[0]),!ng[a])return[];var s=o.map(function(t){return eR(t);});e.push({t:a,d:s});}return e;}function nm(t){if(Array.isArray(t))return ny(t);if("none"===(t=(t||"none").trim()))return[];var e,n=[],r=0;for(nf.lastIndex=0;(e=nf.exec(t))&&e.index===r;){r=e.index+e[0].length;var i=e[1],a=ng[i];if(!a)break;var o=e[2].split(","),s=a[0];if(s.length<o.length)break;for(var l=[],u=0;u<s.length;u++){var c=o[u],h=s[u],d=void 0;if(void 0===(d=c?({A:function(t){return"0"===t.trim()?eb:eK(t);},N:e3,T:ej,L:eq})[h.toUpperCase()](c):({a:eb,n:l[0],t:eN})[h]))return[];l.push(d);}if(n.push({t:i,d:l}),nf.lastIndex===t.length)return n;}return[];}function nk(t){switch(t.t){case"rotateX":return[1,0,0,0,0,Math.cos(i=eQ(t.d[0])*tf),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1];case"rotateY":return[Math.cos(i=eQ(t.d[0])*tf),0,-Math.sin(i),0,0,1,0,0,Math.sin(i),0,Math.cos(i),0,0,0,0,1];case"rotate":case"rotateZ":return[Math.cos(i=eQ(t.d[0])*tf),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1,0,0,0,0,1];case"rotate3d":e=t.d[0].value,n=t.d[1].value,r=t.d[2].value,i=eQ(t.d[3])*tf;var e,n,r,i,a=e*e+n*n+r*r;if(0===a)e=1,n=0,r=0;else if(1!==a){var o=Math.sqrt(a);e/=o,n/=o,r/=o;}var s=Math.sin(i/2),l=s*Math.cos(i/2),u=s*s;return[1-2*(n*n+r*r)*u,2*(e*n*u+r*l),2*(e*r*u-n*l),0,2*(e*n*u-r*l),1-2*(e*e+r*r)*u,2*(n*r*u+e*l),0,2*(e*r*u+n*l),2*(n*r*u-e*l),1-2*(e*e+n*n)*u,0,0,0,0,1];case"scale":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scaleX":return[t.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaleY":return[1,0,0,0,0,t.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scaleZ":return[1,0,0,0,0,1,0,0,0,0,t.d[0].value,0,0,0,0,1];case"scale3d":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,t.d[2].value,0,0,0,0,1];case"skew":var c=eQ(t.d[0])*tf;return[1,Math.tan(eQ(t.d[1])*tf),0,0,Math.tan(c),1,0,0,0,0,1,0,0,0,0,1];case"skewX":return[1,0,0,0,Math.tan(i=eQ(t.d[0])*tf),1,0,0,0,0,1,0,0,0,0,1];case"skewY":return[1,Math.tan(i=eQ(t.d[0])*tf),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return[1,0,0,0,0,1,0,0,0,0,1,0,e=e0(t.d[0],0,null)||0,n=e0(t.d[1],0,null)||0,0,1];case"translateX":return[1,0,0,0,0,1,0,0,0,0,1,0,e=e0(t.d[0],0,null)||0,0,0,1];case"translateY":return[1,0,0,0,0,1,0,0,0,0,1,0,0,n=e0(t.d[0],0,null)||0,0,1];case"translateZ":return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,r=e0(t.d[0],0,null)||0,1];case"translate3d":return[1,0,0,0,0,1,0,0,0,0,1,0,e=e0(t.d[0],0,null)||0,n=e0(t.d[1],0,null)||0,r=e0(t.d[2],0,null)||0,1];case"perspective":var h=e0(t.d[0],0,null)||0;return[1,0,0,0,0,1,0,0,0,0,1,h?-1/h:0,0,0,0,1];case"matrix":return[t.d[0].value,t.d[1].value,0,0,t.d[2].value,t.d[3].value,0,0,0,0,1,0,t.d[4].value,t.d[5].value,0,1];case"matrix3d":return t.d.map(function(t){return t.value;});}}function nE(t,e){return[t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12]*e[3],t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13]*e[3],t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]*e[3],t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15]*e[3],t[0]*e[4]+t[4]*e[5]+t[8]*e[6]+t[12]*e[7],t[1]*e[4]+t[5]*e[5]+t[9]*e[6]+t[13]*e[7],t[2]*e[4]+t[6]*e[5]+t[10]*e[6]+t[14]*e[7],t[3]*e[4]+t[7]*e[5]+t[11]*e[6]+t[15]*e[7],t[0]*e[8]+t[4]*e[9]+t[8]*e[10]+t[12]*e[11],t[1]*e[8]+t[5]*e[9]+t[9]*e[10]+t[13]*e[11],t[2]*e[8]+t[6]*e[9]+t[10]*e[10]+t[14]*e[11],t[3]*e[8]+t[7]*e[9]+t[11]*e[10]+t[15]*e[11],t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12]*e[15],t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13]*e[15],t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14]*e[15],t[3]*e[12]+t[7]*e[13]+t[11]*e[14]+t[15]*e[15]];}function nx(t){var e=[0,0,0],n=[1,1,1],r=[0,0,0],i=[0,0,0,1],a=[0,0,0,1];return!function(t,e,n,r,i,a){if(!(!function(t,e){var n=e[15];if(0===n)return!1;for(var r=1/n,i=0;i<16;i++)t[i]=e[i]*r;return!0;}(tm,t)||(G.mat4.copy(tk,tm),tk[3]=0,tk[7]=0,tk[11]=0,tk[15]=1,1e-8>Math.abs(G.mat4.determinant(tk))))){var o=tm[3],s=tm[7],l=tm[11],u=tm[12],c=tm[13],h=tm[14],d=tm[15];if(0!==o||0!==s||0!==l){if(tE[0]=o,tE[1]=s,tE[2]=l,tE[3]=d,!G.mat4.invert(tk,tk))return;G.mat4.transpose(tk,tk),G.vec4.transformMat4(i,tE,tk);}else i[0]=i[1]=i[2]=0,i[3]=1;if(e[0]=u,e[1]=c,e[2]=h,tx[0][0]=tm[0],tx[0][1]=tm[1],tx[0][2]=tm[2],tx[1][0]=tm[4],tx[1][1]=tm[5],tx[1][2]=tm[6],tx[2][0]=tm[8],tx[2][1]=tm[9],tx[2][2]=tm[10],n[0]=G.vec3.length(tx[0]),G.vec3.normalize(tx[0],tx[0]),r[0]=G.vec3.dot(tx[0],tx[1]),tN(tx[1],tx[1],tx[0],1,-r[0]),n[1]=G.vec3.length(tx[1]),G.vec3.normalize(tx[1],tx[1]),r[0]/=n[1],r[1]=G.vec3.dot(tx[0],tx[2]),tN(tx[2],tx[2],tx[0],1,-r[1]),r[2]=G.vec3.dot(tx[1],tx[2]),tN(tx[2],tx[2],tx[1],1,-r[2]),n[2]=G.vec3.length(tx[2]),G.vec3.normalize(tx[2],tx[2]),r[1]/=n[2],r[2]/=n[2],G.vec3.cross(tT,tx[1],tx[2]),0>G.vec3.dot(tx[0],tT))for(var f=0;f<3;f++)n[f]*=-1,tx[f][0]*=-1,tx[f][1]*=-1,tx[f][2]*=-1;a[0]=.5*Math.sqrt(Math.max(1+tx[0][0]-tx[1][1]-tx[2][2],0)),a[1]=.5*Math.sqrt(Math.max(1-tx[0][0]+tx[1][1]-tx[2][2],0)),a[2]=.5*Math.sqrt(Math.max(1-tx[0][0]-tx[1][1]+tx[2][2],0)),a[3]=.5*Math.sqrt(Math.max(1+tx[0][0]+tx[1][1]+tx[2][2],0)),tx[2][1]>tx[1][2]&&(a[0]=-a[0]),tx[0][2]>tx[2][0]&&(a[1]=-a[1]),tx[1][0]>tx[0][1]&&(a[2]=-a[2]);}}(0===t.length?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:t.map(nk).reduce(nE),e,n,r,i,a),[[e,n,r,a,i]];}var nT=function(){function t(t,e){for(var n=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],r=0;r<4;r++)for(var i=0;i<4;i++)for(var a=0;a<4;a++)n[r][i]+=e[r][a]*t[a][i];return n;}return function(e,n,r,i,a){for(var o,s=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],l=0;l<4;l++)s[l][3]=a[l];for(var u=0;u<3;u++)for(var c=0;c<3;c++)s[3][u]+=e[c]*s[c][u];var h=i[0],d=i[1],f=i[2],v=i[3],p=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];p[0][0]=1-2*(d*d+f*f),p[0][1]=2*(h*d-f*v),p[0][2]=2*(h*f+d*v),p[1][0]=2*(h*d+f*v),p[1][1]=1-2*(h*h+f*f),p[1][2]=2*(d*f-h*v),p[2][0]=2*(h*f-d*v),p[2][1]=2*(d*f+h*v),p[2][2]=1-2*(h*h+d*d),s=t(s,p);var g=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];r[2]&&(g[2][1]=r[2],s=t(s,g)),r[1]&&(g[2][1]=0,g[2][0]=r[0],s=t(s,g)),r[0]&&(g[2][0]=0,g[1][0]=r[0],s=t(s,g));for(var y=0;y<3;y++)for(var m=0;m<3;m++)s[y][m]*=n[y];return 0===(o=s)[0][2]&&0===o[0][3]&&0===o[1][2]&&0===o[1][3]&&0===o[2][0]&&0===o[2][1]&&1===o[2][2]&&0===o[2][3]&&0===o[3][2]&&1===o[3][3]?[s[0][0],s[0][1],s[1][0],s[1][1],s[3][0],s[3][1]]:s[0].concat(s[1],s[2],s[3]);};}();function nN(t){return t.toFixed(6).replace(".000000","");}function nb(t,e){var n,r;return(t.decompositionPair!==e&&(t.decompositionPair=e,n=nx(t)),e.decompositionPair!==t&&(e.decompositionPair=t,r=nx(e)),null===n[0]||null===r[0])?[[!1],[!0],function(n){return n?e[0].d:t[0].d;}]:(n[0].push(0),r[0].push(1),[n,r,function(t){var e=function(t,e,n){var r=function(t,e){for(var n=0,r=0;r<t.length;r++)n+=t[r]*e[r];return n;}(t,e);r=(0,F.clamp)(r,-1,1);var i=[];if(1===r)i=t;else for(var a=Math.acos(r),o=1*Math.sin(n*a)/Math.sqrt(1-r*r),s=0;s<4;s++)i.push(t[s]*(Math.cos(n*a)-r*o)+e[s]*o);return i;}(n[0][3],r[0][3],t[5]);return nT(t[0],t[1],t[2],e,t[4]).map(nN).join(",");}]);}function nS(t){return t.replace(/[XY]/,"");}function nw(t){return t.replace(/(X|Y|Z|3d)?$/,"3d");}function nP(t,e,n){var r=!1;if(!t.length||!e.length){t.length||(r=!0,t=e,e=[]);for(var i=0;i<t.length;i++)!function(){var n=t[i],r=n.t,a=n.d,o="scale"===r.substring(0,5)?1:0;e.push({t:r,d:a.map(function(t){return"number"==typeof t?eR(o):eR(o,t.unit);})});}();}var a=[],o=[],s=[];if(t.length!==e.length){var l=nb(t,e);a=[l[0]],o=[l[1]],s=[["matrix",[l[2]]]];}else for(var u=0;u<t.length;u++){var c=t[u].t,h=e[u].t,d=t[u].d,f=e[u].d,v=ng[c],p=ng[h],g=void 0;if("perspective"===c&&"perspective"===h||("matrix"===c||"matrix3d"===c)&&("matrix"===h||"matrix3d"===h)){var y=nb([t[u]],[e[u]]);a.push(y[0]),o.push(y[1]),s.push(["matrix",[y[2]]]);continue;}if(c===h)g=c;else if(v[2]&&p[2]&&nS(c)===nS(h))g=nS(c),d=v[2](d),f=p[2](f);else if(v[1]&&p[1]&&nw(c)===nw(h))g=nw(c),d=v[1](d),f=p[1](f);else{var m=nb(t,e);a=[m[0]],o=[m[1]],s=[["matrix",[m[2]]]];break;}for(var k=[],E=[],x=[],T=0;T<d.length;T++){var N=function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a="",o=t.value||0,s=e.value||0,l=ex(t.unit),u=t.convertTo(l),c=e.convertTo(l);return u&&c?(o=u.value,s=c.value,a=ev(t.unit)):(eT.isLength(t.unit)||eT.isLength(e.unit))&&(o=e0(t,i,n),s=e0(e,i,n),a="px"),[o,s,function(t){return r&&(t=Math.max(t,0)),t+a;}];}(d[T],f[T],n,!1,T);k[T]=N[0],E[T]=N[1],x.push(N[2]);}a.push(k),o.push(E),s.push([g,x]);}if(r){var b=a;a=o,o=b;}return[a,o,function(t){return t.map(function(t,e){var n=t.map(function(t,n){return s[e][1][n](t);}).join(",");return"matrix"===s[e][0]&&16===n.split(",").length&&(s[e][0]="matrix3d"),"matrix3d"===s[e][0]&&6===n.split(",").length&&(s[e][0]="matrix"),"".concat(s[e][0],"(").concat(n,")");}).join(" ");}];}var nM=ei(function(t){if((0,F.isString)(t)){if("text-anchor"===t)return[eR(0,"px"),eR(0,"px")];var e=t.split(" ");return(1===e.length&&("top"===e[0]||"bottom"===e[0]?(e[1]=e[0],e[0]="center"):e[1]="center"),2!==e.length)?null:[e$(nA(e[0])),e$(nA(e[1]))];}return[eR(t[0]||0,"px"),eR(t[1]||0,"px")];});function nA(t){return"center"===t?"50%":"left"===t||"top"===t?"0%":"right"===t||"bottom"===t?"100%":t;}var nC=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:t_.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:t_.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:t_.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:t_.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:t_.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:t_.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:t_.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:t_.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:t_.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:t_.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:t_.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:t_.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:t_.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:t_.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:t_.FILTER},{n:"clipPath",syntax:t_.DEFINED_PATH},{n:"textPath",syntax:t_.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:t_.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:t_.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:t_.COORDINATE},{n:"y1",int:!0,l:!0,syntax:t_.COORDINATE},{n:"z1",int:!0,l:!0,syntax:t_.COORDINATE},{n:"x2",int:!0,l:!0,syntax:t_.COORDINATE},{n:"y2",int:!0,l:!0,syntax:t_.COORDINATE},{n:"z2",int:!0,l:!0,syntax:t_.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:t_.PATH,p:50},{n:"points",int:!0,l:!0,syntax:t_.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:t_.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:t_.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:t_.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:t_.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:t_.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:t_.NUMBER,d:function(t){return t===j.PATH||t===j.POLYGON||t===j.POLYLINE?"4":"10";}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:t_.MARKER},{n:"markerEnd",syntax:t_.MARKER},{n:"markerMid",syntax:t_.MARKER},{n:"markerStartOffset",syntax:t_.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:t_.LENGTH,l:!0,int:!0,d:"0"}],nR=new Set(nC.filter(function(t){return!!t.l;}).map(function(t){return t.n;})),nO={},nL=(0,R.default)(function t(e){var n=this;(0,C.default)(this,t),this.runtime=e,nC.forEach(function(t){n.registerMetadata(t);});},[{key:"registerMetadata",value:function(t){[t.n].concat((0,O.default)(t.a||[])).forEach(function(e){nO[e]=t;});}},{key:"getPropertySyntax",value:function(t){return this.runtime.CSSPropertySyntaxFactory[t];}},{key:"processProperties",value:function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[],memoize:!0};Object.assign(t.attributes,e);var i=t.parsedStyle.clipPath,a=t.parsedStyle.offsetPath;!function(t,e){var n=nI(t);for(var r in e)n.has(r)&&(t.parsedStyle[r]=e[r]);}(t,e);var o=!!r.forceUpdateGeometry;if(!o){for(var s in e)if(nR.has(s)){o=!0;break;}}var l=nI(t);l.has("fill")&&e.fill&&(t.parsedStyle.fill=eH(e.fill)),l.has("stroke")&&e.stroke&&(t.parsedStyle.stroke=eH(e.stroke)),l.has("shadowColor")&&e.shadowColor&&(t.parsedStyle.shadowColor=eH(e.shadowColor)),l.has("filter")&&e.filter&&(t.parsedStyle.filter=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if("none"===(e=e.toLowerCase().trim()))return[];for(var n=/\s*([\w-]+)\(([^)]*)\)/g,r=[],i=0;(t=n.exec(e))&&t.index===i;)if(i=t.index+t[0].length,e1.indexOf(t[1])>-1&&r.push({name:t[1],params:t[2].split(" ").map(function(t){return eW(/deg|rad|grad|turn|px|%/g,t)||eH(t);})}),n.lastIndex===e.length)return r;return[];}(e.filter)),l.has("radius")&&!(0,F.isNil)(e.radius)&&(t.parsedStyle.radius=eJ(e.radius,4)),l.has("lineDash")&&!(0,F.isNil)(e.lineDash)&&(t.parsedStyle.lineDash=eJ(e.lineDash,"even")),l.has("points")&&e.points&&(t.parsedStyle.points=(n=e.points,{points:(0,F.isString)(n)?n.split(" ").map(function(t){var e=t.split(","),n=(0,D.default)(e,2),r=n[0],i=n[1];return[Number(r),Number(i)];}):n,totalLength:0,segments:[]})),l.has("d")&&""===e.d&&(t.parsedStyle.d=(0,A.default)({},tD)),l.has("d")&&e.d&&(t.parsedStyle.d=nc(e.d)),l.has("textTransform")&&e.textTransform&&this.runtime.CSSPropertySyntaxFactory[t_.TEXT_TRANSFORM].calculator(null,null,{value:e.textTransform},t,null),l.has("clipPath")&&!(0,F.isUndefined)(e.clipPath)&&this.runtime.CSSPropertySyntaxFactory[t_.DEFINED_PATH].calculator("clipPath",i,e.clipPath,t,this.runtime),l.has("offsetPath")&&e.offsetPath&&this.runtime.CSSPropertySyntaxFactory[t_.DEFINED_PATH].calculator("offsetPath",a,e.offsetPath,t,this.runtime),l.has("transform")&&e.transform&&(t.parsedStyle.transform=function(t){if(Array.isArray(t))return ny(t);if("none"===(t=(t||"none").trim()))return[];var e,n=[],r=0;for(nf.lastIndex=0;(e=nf.exec(t))&&e.index===r;){r=e.index+e[0].length;var i=e[1],a=ng[i];if(!a)break;var o=e[2].split(","),s=a[0];if(s.length<o.length)break;for(var l=[],u=0;u<s.length;u++){var c=o[u],h=s[u],d=void 0;if(void 0===(d=c?({A:function(t){return"0"===t.trim()?eb:eZ(t);},N:e4,T:e$,L:eX})[h.toUpperCase()](c):({a:eb,n:l[0],t:eN})[h]))return[];l.push(d);}if(n.push({t:i,d:l}),nf.lastIndex===t.length)return n;}return[];}(e.transform)),l.has("transformOrigin")&&e.transformOrigin&&(t.parsedStyle.transformOrigin=nM(e.transformOrigin)),l.has("markerStart")&&e.markerStart&&(t.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory[t_.MARKER].calculator(null,e.markerStart,e.markerStart,null,null)),l.has("markerEnd")&&e.markerEnd&&(t.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory[t_.MARKER].calculator(null,e.markerEnd,e.markerEnd,null,null)),l.has("markerMid")&&e.markerMid&&(t.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory[t_.MARKER].calculator("",e.markerMid,e.markerMid,null,null)),l.has("zIndex")&&!(0,F.isNil)(e.zIndex)&&this.runtime.CSSPropertySyntaxFactory[t_.Z_INDEX].postProcessor(t),l.has("offsetDistance")&&!(0,F.isNil)(e.offsetDistance)&&this.runtime.CSSPropertySyntaxFactory[t_.OFFSET_DISTANCE].postProcessor(t),l.has("transform")&&e.transform&&this.runtime.CSSPropertySyntaxFactory[t_.TRANSFORM].postProcessor(t),l.has("transformOrigin")&&e.transformOrigin&&this.runtime.CSSPropertySyntaxFactory[t_.TRANSFORM_ORIGIN].postProcessor(t),o&&(t.dirty(!0,!0),r.forceUpdateGeometry||this.runtime.sceneGraphService.dirtyToRoot(t));}},{key:"updateGeometry",value:function(t){var e=t.nodeName,n=this.runtime.geometryUpdaterFactory[e];if(n){var r=t.geometry;r.contentBounds||(r.contentBounds=new tr),r.renderBounds||(r.renderBounds=new tr);var i=t.parsedStyle,a=n.update(i,t),o=a.cx,s=a.cy,l=a.cz,u=a.hwidth,c=void 0===u?0:u,h=a.hheight,d=void 0===h?0:h,f=a.hdepth,v=[Math.abs(c),Math.abs(d),void 0===f?0:f],p=i.stroke,g=i.lineWidth,y=i.increasedLineWidthForHitTesting,m=i.shadowType,k=void 0===m?"outer":m,E=i.shadowColor,x=i.filter,T=i.transformOrigin,N=[void 0===o?0:o,void 0===s?0:s,void 0===l?0:l];r.contentBounds.update(N,v);var b=e===j.POLYLINE||e===j.POLYGON||e===j.PATH?Math.SQRT2:.5;if(p&&!p.isNone){var S=(((void 0===g?1:g)||0)+((void 0===y?0:y)||0))*b;v[0]+=S,v[1]+=S;}if(r.renderBounds.update(N,v),E&&k&&"inner"!==k){var w=r.renderBounds,P=w.min,M=w.max,A=i.shadowBlur,C=i.shadowOffsetX,R=i.shadowOffsetY,O=A||0,L=C||0,I=R||0,D=P[0]-O+L,_=M[0]+O+L,F=P[1]-O+I,B=M[1]+O+I;P[0]=Math.min(P[0],D),M[0]=Math.max(M[0],_),P[1]=Math.min(P[1],F),M[1]=Math.max(M[1],B),r.renderBounds.setMinMax(P,M);}(void 0===x?[]:x).forEach(function(t){var e=t.name,n=t.params;if("blur"===e){var i=n[0].value;r.renderBounds.update(r.renderBounds.center,G.vec3.add(r.renderBounds.halfExtents,r.renderBounds.halfExtents,[i,i,0]));}else if("drop-shadow"===e){var a=n[0].value,o=n[1].value,s=n[2].value,l=r.renderBounds,u=l.min,c=l.max,h=u[0]-s+a,d=c[0]+s+a,f=u[1]-s+o,v=c[1]+s+o;u[0]=Math.min(u[0],h),c[0]=Math.max(c[0],d),u[1]=Math.min(u[1],f),c[1]=Math.max(c[1],v),r.renderBounds.setMinMax(u,c);}}),t.geometry.dirty=!1;var U=d<0,V=(c<0?-1:1)*(T?e0(T[0],0,t,!0):0),z=(U?-1:1)*(T?e0(T[1],1,t,!0):0);(V||z)&&t.setOrigin(V,z);}}},{key:"updateSizeAttenuation",value:function(t,e){t.style.isSizeAttenuation?(t.style.rawLineWidth||(t.style.rawLineWidth=t.style.lineWidth),t.style.lineWidth=(t.style.rawLineWidth||1)/e,t.nodeName===j.CIRCLE&&(t.style.rawR||(t.style.rawR=t.style.r),t.style.r=(t.style.rawR||1)/e)):(t.style.rawLineWidth&&(t.style.lineWidth=t.style.rawLineWidth,delete t.style.rawLineWidth),t.nodeName===j.CIRCLE&&t.style.rawR&&(t.style.r=t.style.rawR,delete t.style.rawR));}}]);function nI(t){return t.constructor.PARSED_STYLE_LIST;}var nD=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e5;},[{key:"calculator",value:function(t,e,n,r){return eQ(n);}}]),n_=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r,i){return n instanceof ek&&(n=null),i.sceneGraphService.updateDisplayObjectDependency(t,e,n,r),"clipPath"===t&&r.forEach(function(t){0===t.childNodes.length&&i.sceneGraphService.dirtyToRoot(t);}),n;}}]),nG=(0,R.default)(function t(){(0,C.default)(this,t),this.parser=eH,this.mixer=eY;},[{key:"calculator",value:function(t,e,n,r){return n instanceof ek?"none"===n.value?eM:eA:n;}}]),nF=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n){return n instanceof ek?[]:n;}}]);function nB(t){var e=t.parsedStyle.fontSize;return(0,F.isNil)(e)?null:e;}var nU=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e5;},[{key:"calculator",value:function(t,e,n,r,i){if((0,F.isNumber)(n))return n;if(!eT.isRelativeUnit(n.unit))return n.value;if(n.unit===ea.kPercentage)return 0;if(n.unit===ea.kEms){if(r.parentNode){var a,o=nB(r.parentNode);if(o)return o*n.value;}return 0;}if(n.unit===ea.kRems){if(null!=r&&null!==(a=r.ownerDocument)&&void 0!==a&&a.documentElement){var s=nB(r.ownerDocument.documentElement);if(s)return s*n.value;}return 0;}}}]),nV=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e7;},[{key:"calculator",value:function(t,e,n){return n.map(function(t){return t.value;});}}]),nz=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e7;},[{key:"calculator",value:function(t,e,n){return n.map(function(t){return t.value;});}}]),nH=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){n instanceof ek&&(n=null);var i,a=null===(i=n)||void 0===i?void 0:i.cloneNode(!0);return a&&(a.style.isMarker=!0),a;}}]),nY=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e5;},[{key:"calculator",value:function(t,e,n){return n.value;}}]),nW=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e6(0,1);},[{key:"calculator",value:function(t,e,n){return n.value;}},{key:"postProcessor",value:function(t){var e=t.parsedStyle,n=e.offsetPath,r=e.offsetDistance;if(n){var i=n.nodeName;if(i===j.LINE||i===j.PATH||i===j.POLYLINE){var a=n.getPoint(r);a&&t.setLocalPosition(a.x,a.y);}}}}]),nq=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e6(0,1);},[{key:"calculator",value:function(t,e,n){return n.value;}}]),nX=(0,R.default)(function t(){(0,C.default)(this,t),this.parser=nc,this.mixer=nh;},[{key:"calculator",value:function(t,e,n){return n instanceof ek&&"unset"===n.value?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new tl(0,0,0,0)}:n;}}]),nj=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=nd;}),n$=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).mixer=e6(0,1/0),t;}return(0,I.default)(e,t),(0,R.default)(e);}(nU),nK=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){return n instanceof ek?"unset"===n.value?"":n.value:"".concat(n);}},{key:"postProcessor",value:function(t){t.nodeValue="".concat(t.parsedStyle.text)||"";}}]),nZ=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){var i=r.getAttribute("text");if(i){var a=i;"capitalize"===n.value?a=i.charAt(0).toUpperCase()+i.slice(1):"lowercase"===n.value?a=i.toLowerCase():"uppercase"===n.value&&(a=i.toUpperCase()),r.parsedStyle.text=a;}return n.value;}}]);function nQ(t,e){var n=Number(t.parsedStyle.zIndex||0),r=Number(e.parsedStyle.zIndex||0);if(n===r){var i=t.parentNode;if(i){var a=i.childNodes||[];return a.indexOf(t)-a.indexOf(e);}}return n-r;}new WeakMap,"undefined"!=typeof window&&window.document;var nJ={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},n0="object"==typeof performance&&performance.now?performance:Date;function n1(t){return t.nodeName===j.FRAGMENT||t.getRootNode().nodeName===j.FRAGMENT;}var n2=1,n3="object"==typeof self&&self.self===self?self:"object"==typeof X&&X.global===X?X:{},n4=Date.now(),n5={},n6=Date.now(),n7=function(t){if("function"!=typeof t)throw TypeError("".concat(t," is not a function"));var e=Date.now(),n=e-n6,r=n2++;return n5[r]=t,Object.keys(n5).length>1||setTimeout(function(){n6=e;var t=n5;n5={},Object.keys(t).forEach(function(e){return t[e](n3.performance&&"function"==typeof n3.performance.now?n3.performance.now():Date.now()-n4);});},n>16?0:16-n),r;},n9=function(t){return"string"!=typeof t?n7:""===t?n3.requestAnimationFrame:n3["".concat(t,"RequestAnimationFrame")];},n8=function(t,e){for(var n=0;void 0!==t[n];){if(e(t[n]))return t[n];n+=1;}}(["","webkit","moz","ms","o"],function(t){return!!n9(t);}),rt=n9(n8),re="string"!=typeof n8?function(t){delete n5[t];}:""===n8?n3.cancelAnimationFrame:n3["".concat(n8,"CancelAnimationFrame")]||n3["".concat(n8,"CancelRequestAnimationFrame")];n3.requestAnimationFrame=rt,n3.cancelAnimationFrame=re;var rn=(0,R.default)(function t(){(0,C.default)(this,t),this.callbacks=[];},[{key:"getCallbacksNum",value:function(){return this.callbacks.length;}},{key:"tapPromise",value:function(t,e){this.callbacks.push(e);}},{key:"promise",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return Promise.all(this.callbacks.map(function(t){return t.apply(void 0,e);}));}}]),rr=(0,R.default)(function t(){(0,C.default)(this,t),this.callbacks=[];},[{key:"tapPromise",value:function(t,e){this.callbacks.push(e);}},{key:"promise",value:(m=(0,Y.default)((0,H.default)().mark(function t(){var e,n,r,i,a=arguments;return(0,H.default)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.callbacks.length){t.next=6;break;}return t.next=1,(e=this.callbacks)[0].apply(e,a);case 1:n=t.sent,r=1;case 2:if(!(r<this.callbacks.length)){t.next=5;break;}return i=this.callbacks[r],t.next=3,i(n);case 3:n=t.sent;case 4:r++,t.next=2;break;case 5:return t.abrupt("return",n);case 6:return t.abrupt("return",null);case 7:case"end":return t.stop();}},t,this);})),function(){return m.apply(this,arguments);})}]),ri=(0,R.default)(function t(){(0,C.default)(this,t),this.callbacks=[];},[{key:"tap",value:function(t,e){this.callbacks.push(e);}},{key:"call",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=arguments;this.callbacks.forEach(function(t){t.apply(void 0,r);});}}]),ra=(0,R.default)(function t(){(0,C.default)(this,t),this.callbacks=[];},[{key:"tap",value:function(t,e){this.callbacks.push(e);}},{key:"call",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];if(this.callbacks.length){for(var r=arguments,i=this.callbacks[0].apply(void 0,r),a=1;a<this.callbacks.length;a++)i=(0,this.callbacks[a])(i);return i;}return null;}}]),ro=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],rs=/([\"\'])[^\'\"]+\1/;function rl(t){var e=t.fontSize,n=t.fontFamily,r=t.fontStyle,i=t.fontVariant,a=t.fontWeight;return{fontSize:void 0===e?16:e,fontFamily:void 0===n?"sans-serif":n,fontStyle:void 0===r?"normal":r,fontVariant:void 0===i?"normal":i,fontWeight:void 0===a?"normal":a};}var ru=ei(function(t){for(var e=rl(t),n=e.fontSize,r=e.fontFamily,i=e.fontStyle,a=e.fontVariant,o=e.fontWeight,s=(0,F.isNumber)(n)&&"".concat(n,"px")||"16px",l=r.split(","),u=l.length-1;u>=0;u--){var c=l[u].trim();!rs.test(c)&&0>ro.indexOf(c)&&(c='"'.concat(c,'"')),l[u]=c;}return"".concat(i," ").concat(a," ").concat(o," ").concat(s," ").concat(l.join(","));},function(t){var e=rl(t),n=e.fontSize,r=e.fontFamily,i=e.fontStyle,a=e.fontVariant,o=e.fontWeight;return"".concat(i,"_").concat(a,"_").concat(o,"_").concat(n,"_").concat(r);}),rc=function(t){return Math.max(t,1e-6);};function rh(t,e,n){return G.mat4.identity(t),t[4]=Math.tan(e),t[1]=Math.tan(n),t;}var rd=G.mat4.create(),rf=G.mat4.create(),rv={scale:function(t){G.mat4.fromScaling(rd,[t[0].value,t[1].value,1].map(function(t){return rc(t);}));},scaleX:function(t){G.mat4.fromScaling(rd,[t[0].value,1,1].map(function(t){return rc(t);}));},scaleY:function(t){G.mat4.fromScaling(rd,[1,t[0].value,1].map(function(t){return rc(t);}));},scaleZ:function(t){G.mat4.fromScaling(rd,[1,1,t[0].value].map(function(t){return rc(t);}));},scale3d:function(t){G.mat4.fromScaling(rd,[t[0].value,t[1].value,t[2].value].map(function(t){return rc(t);}));},translate:function(t){G.mat4.fromTranslation(rd,[t[0].value,t[1].value,0]);},translateX:function(t){G.mat4.fromTranslation(rd,[t[0].value,0,0]);},translateY:function(t){G.mat4.fromTranslation(rd,[0,t[0].value,0]);},translateZ:function(t){G.mat4.fromTranslation(rd,[0,0,t[0].value]);},translate3d:function(t){G.mat4.fromTranslation(rd,[t[0].value,t[1].value,t[2].value]);},rotate:function(t){G.mat4.fromZRotation(rd,eQ(t[0])*tf);},rotateX:function(t){G.mat4.fromXRotation(rd,eQ(t[0])*tf);},rotateY:function(t){G.mat4.fromYRotation(rd,eQ(t[0])*tf);},rotateZ:function(t){G.mat4.fromZRotation(rd,eQ(t[0])*tf);},rotate3d:function(t){G.mat4.fromRotation(rd,eQ(t[3])*tf,[t[0].value,t[1].value,t[2].value]);},skew:function(t){rh(rd,t[0].value*tf,t[1].value*tf);},skewX:function(t){rh(rd,t[0].value*tf,0);},skewY:function(t){rh(rd,0,t[0].value*tf);},matrix:function(t){G.mat4.set(rd,t[0].value,t[1].value,0,0,t[2].value,t[3].value,0,0,0,0,1,0,t[4].value,t[5].value,0,1);},matrix3d:function(t){G.mat4.set.apply(G.mat4,[rd].concat((0,O.default)(t.map(function(t){return t.value;}))));}},rp=G.vec3.fromValues(1,1,1),rg=G.vec3.create(),ry={translate:function(t,e){ii.sceneGraphService.setLocalScale(t,rp,!1),ii.sceneGraphService.setLocalEulerAngles(t,rg,void 0,void 0,!1),ii.sceneGraphService.setLocalPosition(t,[e[0].value,e[1].value,0],!1),ii.sceneGraphService.dirtyLocalTransform(t,t.transformable);}},rm=(0,R.default)(function t(){(0,C.default)(this,t),this.parser=nm,this.mixer=nP;},[{key:"calculator",value:function(t,e,n,r){return n instanceof ek?[]:n;}},{key:"postProcessor",value:function(t){!function(t,e){if(t.length){if(1===t.length&&ry[t[0].t]){ry[t[0].t](e,t[0].d);return;}for(var n=G.mat4.identity(rf),r=0;r<t.length;r++){var i=t[r],a=i.t,o=i.d,s=rv[a];s&&(s(o),G.mat4.mul(n,n,rd));}e.setLocalTransform(n);}else e.resetLocalTransform();e.getLocalTransform();}(t.parsedStyle.transform,t);}}]),rk=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"postProcessor",value:function(t){var e=t.parsedStyle.transformOrigin;e[0].unit===ea.kPixels&&e[1].unit===ea.kPixels?t.setOrigin(e[0].value,e[1].value):t.getGeometryBounds();}}]),rE=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){return n.value;}},{key:"postProcessor",value:function(t){if(t.parentNode){var e=t.parentNode,n=e.renderable,r=e.sortable;n&&e.dirty(),r&&(r.dirty=!0,r.dirtyReason=tC.Z_INDEX_CHANGED);}}}]),rx=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){var n=t.cx,r=t.cy,i=t.r,a=void 0===i?0:i;return{cx:void 0===n?0:n,cy:void 0===r?0:r,hwidth:a,hheight:a};}}]),rT=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){var n=t.cx,r=t.cy,i=t.rx,a=t.ry;return{cx:void 0===n?0:n,cy:void 0===r?0:r,hwidth:void 0===i?0:i,hheight:void 0===a?0:a};}}]),rN=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t){var e=t.x1,n=t.y1,r=t.x2,i=t.y2,a=Math.min(e,r),o=Math.min(n,i),s=(Math.max(e,r)-a)/2,l=(Math.max(n,i)-o)/2;return{cx:a+s,cy:o+l,hwidth:s,hheight:l};}}]),rb=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t){var e=t.d.rect,n=e.x,r=e.y,i=e.width,a=e.height,o=i/2,s=a/2;return{cx:n+o,cy:r+s,hwidth:o,hheight:s};}}]),rS=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t){if(t.points&&(0,F.isArray)(t.points.points)){var e=t.points.points,n=Math.min.apply(Math,(0,O.default)(e.map(function(t){return t[0];}))),r=Math.max.apply(Math,(0,O.default)(e.map(function(t){return t[0];}))),i=Math.min.apply(Math,(0,O.default)(e.map(function(t){return t[1];}))),a=Math.max.apply(Math,(0,O.default)(e.map(function(t){return t[1];}))),o=(r-n)/2,s=(a-i)/2;return{cx:n+o,cy:i+s,hwidth:o,hheight:s};}return{cx:0,cy:0,hwidth:0,hheight:0};}}]),rw=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){var n=t.x,r=t.y,i=t.src,a=t.width,o=t.height,s=void 0===a?0:a,l=void 0===o?0:o;return!i||(0,F.isString)(i)||(s||(s=i.width,t.width=s),l||(l=i.height,t.height=l)),{cx:(void 0===n?0:n)+s/2,cy:(void 0===r?0:r)+l/2,hwidth:s/2,hheight:l/2};}}]),rP=(0,R.default)(function t(e){(0,C.default)(this,t),this.globalRuntime=e;},[{key:"isReadyToMeasure",value:function(t,e){return t.text;}},{key:"update",value:function(t,e){var n,r=t.text,i=t.textAlign,a=void 0===i?"start":i,o=t.lineWidth,s=void 0===o?1:o,l=t.textBaseline,u=void 0===l?"alphabetic":l,c=t.dx,h=void 0===c?0:c,d=t.dy,f=void 0===d?0:d,v=t.x,p=t.y;if(!this.isReadyToMeasure(t,e))return t.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var g=((null==e||null===(n=e.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n?void 0:n.getConfig())||{}).offscreenCanvas,y=this.globalRuntime.textService.measureText(r,t,g);t.metrics=y;var m=y.width,k=y.height,E=m/2,x=k/2,T=(void 0===v?0:v)+E;"center"===a||"middle"===a?T+=s/2-E:("right"===a||"end"===a)&&(T+=s-2*E);var N=(void 0===p?0:p)-x;return"middle"===u?N+=x:"top"===u||"hanging"===u?N+=2*x:"alphabetic"===u||("bottom"===u||"ideographic"===u)&&(N+=0),h&&(T+=h),f&&(N+=f),{cx:T,cy:N,hwidth:E,hheight:x};}}]),rM=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){return{cx:0,cy:0,hwidth:0,hheight:0};}}]),rA=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){var n=t.x,r=t.y,i=t.width,a=void 0===i?0:i,o=t.height,s=void 0===o?0:o;return{cx:(void 0===n?0:n)+a/2,cy:(void 0===r?0:r)+s/2,hwidth:a/2,hheight:s/2};}}]),rC=(0,R.default)(function t(e){(0,C.default)(this,t),this.eventPhase=t.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new ts,this.page=new ts,this.canvas=new ts,this.viewport=new ts,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e;},[{key:"name",get:function(){return this.type;}},{key:"layerX",get:function(){return this.layer.x;}},{key:"layerY",get:function(){return this.layer.y;}},{key:"pageX",get:function(){return this.page.x;}},{key:"pageY",get:function(){return this.page.y;}},{key:"x",get:function(){return this.canvas.x;}},{key:"y",get:function(){return this.canvas.y;}},{key:"canvasX",get:function(){return this.canvas.x;}},{key:"canvasY",get:function(){return this.canvas.y;}},{key:"viewportX",get:function(){return this.viewport.x;}},{key:"viewportY",get:function(){return this.viewport.y;}},{key:"composedPath",value:function(){return this.manager&&(!this.path||this.path[0]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path;}},{key:"propagationPath",get:function(){return this.composedPath();}},{key:"preventDefault",value:function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0;}},{key:"stopImmediatePropagation",value:function(){this.propagationImmediatelyStopped=!0;}},{key:"stopPropagation",value:function(){this.propagationStopped=!0;}},{key:"initEvent",value:function(){}},{key:"initUIEvent",value:function(){}},{key:"clone",value:function(){throw Error(tu);}}]),rR=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).client=new ts,t.movement=new ts,t.offset=new ts,t.global=new ts,t.screen=new ts,t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clientX",get:function(){return this.client.x;}},{key:"clientY",get:function(){return this.client.y;}},{key:"movementX",get:function(){return this.movement.x;}},{key:"movementY",get:function(){return this.movement.y;}},{key:"offsetX",get:function(){return this.offset.x;}},{key:"offsetY",get:function(){return this.offset.y;}},{key:"globalX",get:function(){return this.global.x;}},{key:"globalY",get:function(){return this.global.y;}},{key:"screenX",get:function(){return this.screen.x;}},{key:"screenY",get:function(){return this.screen.y;}},{key:"getModifierState",value:function(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t);}},{key:"initMouseEvent",value:function(){throw Error(tu);}}]);}(rC),rO=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).width=0,t.height=0,t.isPrimary=!1,t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getCoalescedEvents",value:function(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[];}},{key:"getPredictedEvents",value:function(){throw Error("getPredictedEvents is not supported!");}},{key:"clone",value:function(){return this.manager.clonePointerEvent(this);}}]);}(rR),rL=function(t){function e(){return(0,C.default)(this,e),(0,L.default)(this,e,arguments);}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return this.manager.cloneWheelEvent(this);}}]);}(rR),rI=function(t){function e(t,n){var r;return(0,C.default)(this,e),(r=(0,L.default)(this,e,[null])).type=t,r.detail=null==n?void 0:n.detail,!n||"detail"in n||(r.detail=n),Object.assign(r,n),r;}return(0,I.default)(e,t),(0,R.default)(e);}(rC),rD=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).shadow=!1,t.ownerDocument=null,t.isConnected=!1,t.baseURI="",t.childNodes=[],t.nodeType=0,t.nodeName="",t.nodeValue=null,t.mutations=void 0,t.parentNode=null,t.destroyed=!1,t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"textContent",get:function(){var t="";this.nodeName===j.TEXT&&(t+=this.style.text);var e,n=(0,W.default)(this.childNodes);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.nodeName===j.TEXT?t+=r.nodeValue:t+=r.textContent;}}catch(t){n.e(t);}finally{n.f();}return t;},set:function(t){var e=this;this.childNodes.slice().forEach(function(t){e.removeChild(t);}),this.nodeName===j.TEXT&&(this.style.text="".concat(t));}},{key:"getRootNode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.parentNode?this.parentNode.getRootNode(t):t.composed&&this.host?this.host.getRootNode(t):this;}},{key:"hasChildNodes",value:function(){return this.childNodes.length>0;}},{key:"isDefaultNamespace",value:function(t){throw Error(tu);}},{key:"lookupNamespaceURI",value:function(t){throw Error(tu);}},{key:"lookupPrefix",value:function(t){throw Error(tu);}},{key:"normalize",value:function(){throw Error(tu);}},{key:"isEqualNode",value:function(t){return this===t;}},{key:"isSameNode",value:function(t){return this.isEqualNode(t);}},{key:"parent",get:function(){return this.parentNode;}},{key:"parentElement",get:function(){return null;}},{key:"nextSibling",get:function(){return null;}},{key:"previousSibling",get:function(){return null;}},{key:"firstChild",get:function(){return this.childNodes.length>0?this.childNodes[0]:null;}},{key:"lastChild",get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null;}},{key:"compareDocumentPosition",value:function(t){if(t===this)return 0;for(var n,r=t,i=this,a=[r],o=[i];null!==(n=r.parentNode)&&void 0!==n?n:i.parentNode;)r=r.parentNode?(a.push(r.parentNode),r.parentNode):r,i=i.parentNode?(o.push(i.parentNode),i.parentNode):i;if(r!==i)return e.DOCUMENT_POSITION_DISCONNECTED|e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|e.DOCUMENT_POSITION_PRECEDING;var s=a.length>o.length?a:o,l=s===a?o:a;if(s[s.length-l.length]===l[0])return s===a?e.DOCUMENT_POSITION_CONTAINED_BY|e.DOCUMENT_POSITION_FOLLOWING:e.DOCUMENT_POSITION_CONTAINS|e.DOCUMENT_POSITION_PRECEDING;for(var u=s.length-l.length,c=l.length-1;c>=0;c--){var h=l[c],d=s[u+c];if(d!==h){var f=h.parentNode.childNodes;if(f.indexOf(h)<f.indexOf(d)){if(l===a)return e.DOCUMENT_POSITION_PRECEDING;return e.DOCUMENT_POSITION_FOLLOWING;}if(s===a)return e.DOCUMENT_POSITION_PRECEDING;break;}}return e.DOCUMENT_POSITION_FOLLOWING;}},{key:"contain",value:function(t){return this.contains(t);}},{key:"contains",value:function(t){for(var e=t;e&&this!==e;)e=e.parentNode;return!!e;}},{key:"getAncestor",value:function(t){for(var e=this;t>0&&e;)e=e.parentNode,t--;return e;}},{key:"forEach",value:function(t){for(var e=[this];e.length>0;){var n=e.pop();if(!1===t(n))break;for(var r=n.childNodes.length-1;r>=0;r--)e.push(n.childNodes[r]);}}}],[{key:"isNode",value:function(t){return!!t.childNodes;}}]);}((0,R.default)(function t(){(0,C.default)(this,t),this.emitter=new _.default;},[{key:"on",value:function(t,e,n){return this.addEventListener(t,e,n),this;}},{key:"addEventListener",value:function(t,e,n){var r=!1,i=!1;if((0,F.isBoolean)(n))r=n;else if(n){var a=n.capture;r=void 0!==a&&a;var o=n.once;i=void 0!==o&&o;}r&&(t+="capture"),e=(0,F.isFunction)(e)?e:e.handleEvent;var s=(0,F.isFunction)(e)?void 0:e;return i?this.emitter.once(t,e,s):this.emitter.on(t,e,s),this;}},{key:"off",value:function(t,e,n){return t?this.removeEventListener(t,e,n):this.removeAllEventListeners(),this;}},{key:"removeAllEventListeners",value:function(){var t;null===(t=this.emitter)||void 0===t||t.removeAllListeners();}},{key:"removeEventListener",value:function(t,e,n){if(!this.emitter)return this;((0,F.isBoolean)(n)?n:null==n?void 0:n.capture)&&(t+="capture"),e=(0,F.isFunction)(e)?e:null===(r=e)||void 0===r?void 0:r.handleEvent;var r,i=(0,F.isFunction)(e)?void 0:e;return this.emitter.off(t,e,i),this;}},{key:"emit",value:function(t,e){this.dispatchEvent(new rI(t,e));}},{key:"dispatchEventToSelf",value:function(t){t.target||(t.target=this),t.currentTarget=this,this.emitter.emit(t.type,t);}},{key:"dispatchEvent",value:function(t){var e,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0;if(i)return this.dispatchEventToSelf(t),!0;if(e=this.document?this:this.defaultView?this.defaultView:null===(n=this.ownerDocument)||void 0===n?void 0:n.defaultView){if(t.manager=e.getEventService(),!t.manager)return!1;t.defaultPrevented=!1,t.path?t.path.length=0:t.page=[],r||(t.target=this),t.manager.dispatchEvent(t,t.type,r);}else this.dispatchEventToSelf(t);return!t.defaultPrevented;}}]));rD.DOCUMENT_POSITION_DISCONNECTED=1,rD.DOCUMENT_POSITION_PRECEDING=2,rD.DOCUMENT_POSITION_FOLLOWING=4,rD.DOCUMENT_POSITION_CONTAINS=8,rD.DOCUMENT_POSITION_CONTAINED_BY=16,rD.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32,(0,R.default)(function t(e,n){var r=this;(0,C.default)(this,t),this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=G.mat4.create(),this.tmpVec3=G.vec3.create(),this.onPointerDown=function(t){var e=r.createPointerEvent(t);if(r.dispatchEvent(e,"pointerdown"),"touch"===e.pointerType)r.dispatchEvent(e,"touchstart");else if("mouse"===e.pointerType||"pen"===e.pointerType){var n=2===e.button;r.dispatchEvent(e,n?"rightdown":"mousedown");}r.trackingData(t.pointerId).pressTargetsByButton[t.button]=e.composedPath(),r.freeEvent(e);},this.onPointerUp=function(t){var e=n0.now(),n=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);if(r.dispatchEvent(n,"pointerup"),"touch"===n.pointerType)r.dispatchEvent(n,"touchend");else if("mouse"===n.pointerType||"pen"===n.pointerType){var i=2===n.button;r.dispatchEvent(n,i?"rightup":"mouseup");}var a=r.trackingData(t.pointerId),o=r.findMountedTarget(a.pressTargetsByButton[t.button]),s=o;if(o&&!n.composedPath().includes(o)){for(var l=o;l&&!n.composedPath().includes(l);){if(n.currentTarget=l,r.notifyTarget(n,"pointerupoutside"),"touch"===n.pointerType)r.notifyTarget(n,"touchendoutside");else if("mouse"===n.pointerType||"pen"===n.pointerType){var u=2===n.button;r.notifyTarget(n,u?"rightupoutside":"mouseupoutside");}rD.isNode(l)&&(l=l.parentNode);}delete a.pressTargetsByButton[t.button],s=l;}if(s){var c,h=r.clonePointerEvent(n,"click");h.target=s,h.path=[],a.clicksByButton[t.button]||(a.clicksByButton[t.button]={clickCount:0,target:h.target,timeStamp:e});var d=r.context.renderingContext.root.ownerDocument.defaultView,f=a.clicksByButton[t.button];f.target===h.target&&e-f.timeStamp<d.getConfig().dblClickSpeed?++f.clickCount:f.clickCount=1,f.target=h.target,f.timeStamp=e,h.detail=f.clickCount,null!==(c=n.detail)&&void 0!==c&&c.preventClick||(r.context.config.useNativeClickEvent||"mouse"!==h.pointerType&&"touch"!==h.pointerType||r.dispatchEvent(h,"click"),r.dispatchEvent(h,"pointertap")),r.freeEvent(h);}r.freeEvent(n);},this.onPointerMove=function(t){var e=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0),n="mouse"===e.pointerType||"pen"===e.pointerType,i=r.trackingData(t.pointerId),a=r.findMountedTarget(i.overTargets);if(i.overTargets&&a!==e.target){var o="mousemove"===t.type?"mouseout":"pointerout",s=r.createPointerEvent(t,o,a||void 0);if(r.dispatchEvent(s,"pointerout"),n&&r.dispatchEvent(s,"mouseout"),!e.composedPath().includes(a)){var l=r.createPointerEvent(t,"pointerleave",a||void 0);for(l.eventPhase=l.AT_TARGET;l.target&&!e.composedPath().includes(l.target);)l.currentTarget=l.target,r.notifyTarget(l),n&&r.notifyTarget(l,"mouseleave"),rD.isNode(l.target)&&(l.target=l.target.parentNode);r.freeEvent(l);}r.freeEvent(s);}if(a!==e.target){var u="mousemove"===t.type?"mouseover":"pointerover",c=r.clonePointerEvent(e,u);r.dispatchEvent(c,"pointerover"),n&&r.dispatchEvent(c,"mouseover");for(var h=a&&rD.isNode(a)&&a.parentNode;h&&h!==(rD.isNode(r.rootTarget)&&r.rootTarget.parentNode)&&h!==e.target;)h=h.parentNode;if(!h||h===(rD.isNode(r.rootTarget)&&r.rootTarget.parentNode)){var d=r.clonePointerEvent(e,"pointerenter");for(d.eventPhase=d.AT_TARGET;d.target&&d.target!==a&&d.target!==(rD.isNode(r.rootTarget)&&r.rootTarget.parentNode);)d.currentTarget=d.target,r.notifyTarget(d),n&&r.notifyTarget(d,"mouseenter"),rD.isNode(d.target)&&(d.target=d.target.parentNode);r.freeEvent(d);}r.freeEvent(c);}r.dispatchEvent(e,"pointermove"),"touch"===e.pointerType&&r.dispatchEvent(e,"touchmove"),n&&(r.dispatchEvent(e,"mousemove"),r.cursor=r.getCursor(e.target)),i.overTargets=e.composedPath(),r.freeEvent(e);},this.onPointerOut=function(t){var e=r.trackingData(t.pointerId);if(e.overTargets){var n="mouse"===t.pointerType||"pen"===t.pointerType,i=r.findMountedTarget(e.overTargets),a=r.createPointerEvent(t,"pointerout",i||void 0);r.dispatchEvent(a),n&&r.dispatchEvent(a,"mouseout");var o=r.createPointerEvent(t,"pointerleave",i||void 0);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==(rD.isNode(r.rootTarget)&&r.rootTarget.parentNode);)o.currentTarget=o.target,r.notifyTarget(o),n&&r.notifyTarget(o,"mouseleave"),rD.isNode(o.target)&&(o.target=o.target.parentNode);e.overTargets=null,r.freeEvent(a),r.freeEvent(o);}r.cursor=null;},this.onPointerOver=function(t){var e=r.trackingData(t.pointerId),n=r.createPointerEvent(t),i="mouse"===n.pointerType||"pen"===n.pointerType;r.dispatchEvent(n,"pointerover"),i&&r.dispatchEvent(n,"mouseover"),"mouse"===n.pointerType&&(r.cursor=r.getCursor(n.target));var a=r.clonePointerEvent(n,"pointerenter");for(a.eventPhase=a.AT_TARGET;a.target&&a.target!==(rD.isNode(r.rootTarget)&&r.rootTarget.parentNode);)a.currentTarget=a.target,r.notifyTarget(a),i&&r.notifyTarget(a,"mouseenter"),rD.isNode(a.target)&&(a.target=a.target.parentNode);e.overTargets=n.composedPath(),r.freeEvent(n),r.freeEvent(a);},this.onPointerUpOutside=function(t){var e=r.trackingData(t.pointerId),n=r.findMountedTarget(e.pressTargetsByButton[t.button]),i=r.createPointerEvent(t);if(n){for(var a=n;a;)i.currentTarget=a,r.notifyTarget(i,"pointerupoutside"),"touch"===i.pointerType||("mouse"===i.pointerType||"pen"===i.pointerType)&&r.notifyTarget(i,2===i.button?"rightupoutside":"mouseupoutside"),rD.isNode(a)&&(a=a.parentNode);delete e.pressTargetsByButton[t.button];}r.freeEvent(i);},this.onWheel=function(t){var e=r.createWheelEvent(t);r.dispatchEvent(e),r.freeEvent(e);},this.onClick=function(t){if(r.context.config.useNativeClickEvent){var e=r.createPointerEvent(t);r.dispatchEvent(e),r.freeEvent(e);}},this.onPointerCancel=function(t){var e=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);r.dispatchEvent(e),r.freeEvent(e);},this.globalRuntime=e,this.context=n;},[{key:"init",value:function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick);}},{key:"destroy",value:function(){this.mappingTable={},this.mappingState={},this.eventPool.clear();}},{key:"getScale",value:function(){var t=this.context.contextService.getBoundingClientRect(),e=1,n=1,r=this.context.contextService.getDomElement();if(r&&t){var i=r.offsetWidth,a=r.offsetHeight;i&&a&&(e=t.width/i,n=t.height/a);}return{scaleX:e,scaleY:n,bbox:t};}},{key:"client2Viewport",value:function(t){var e=this.getScale(),n=e.scaleX,r=e.scaleY,i=e.bbox;return new ts((t.x-((null==i?void 0:i.left)||0))/n,(t.y-((null==i?void 0:i.top)||0))/r);}},{key:"viewport2Client",value:function(t){var e=this.getScale(),n=e.scaleX,r=e.scaleY,i=e.bbox;return new ts((t.x+((null==i?void 0:i.left)||0))*n,(t.y+((null==i?void 0:i.top)||0))*r);}},{key:"viewport2Canvas",value:function(t){var e=t.x,n=t.y,r=this.rootTarget.defaultView.getCamera(),i=this.context.config,a=i.width,o=i.height,s=r.getPerspectiveInverse(),l=r.getWorldTransform(),u=G.mat4.multiply(this.tmpMatrix,l,s),c=G.vec3.set(this.tmpVec3,e/a*2-1,(1-n/o)*2-1,0);return G.vec3.transformMat4(c,c,u),new ts(c[0],c[1]);}},{key:"canvas2Viewport",value:function(t){var e=this.rootTarget.defaultView.getCamera(),n=e.getPerspective(),r=e.getViewTransform(),i=G.mat4.multiply(this.tmpMatrix,n,r),a=G.vec3.set(this.tmpVec3,t.x,t.y,0);G.vec3.transformMat4(this.tmpVec3,this.tmpVec3,i);var o=this.context.config,s=o.width,l=o.height;return new ts((a[0]+1)/2*s,(1-(a[1]+1)/2)*l);}},{key:"setPickHandler",value:function(t){this.pickHandler=t;}},{key:"addEventMapping",value:function(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort(function(t,e){return t.priority-e.priority;});}},{key:"mapEvent",value:function(t){if(this.rootTarget){var e=this.mappingTable[t.type];if(e)for(var n=0,r=e.length;n<r;n++)e[n].fn(t);else console.warn("[EventService]: Event mapping not defined for ".concat(t.type));}}},{key:"dispatchEvent",value:function(t,e,n){if(n){t.eventPhase=t.AT_TARGET;var r=this.rootTarget.defaultView||null;t.currentTarget=r,this.notifyListeners(t,e);}else t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e);}},{key:"propagate",value:function(t,e){if(t.target){var n=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(var r=n.length-1;r>=1;r--)if(t.currentTarget=n[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!t.propagationStopped&&!t.propagationImmediatelyStopped){var i=n.indexOf(t.currentTarget);t.eventPhase=t.BUBBLING_PHASE;for(var a=i+1;a<n.length;a++)if(t.currentTarget=n[a],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;}}}},{key:"propagationPath",value:function(t){var e=[t],n=this.rootTarget.defaultView||null;if(n&&n===t)return e.unshift(n.document),e;for(var r=0;r<2048&&t!==this.rootTarget;r++)rD.isNode(t)&&t.parentNode&&(e.push(t.parentNode),t=t.parentNode);return n&&e.push(n),e;}},{key:"hitTest",value:function(t){var e=t.viewportX,n=t.viewportY,r=this.context.config,i=r.width,a=r.height,o=r.disableHitTesting;return e<0||n<0||e>i||n>a?null:!o&&this.pickHandler(t)||this.rootTarget||null;}},{key:"isNativeEventFromCanvas",value:function(t,e){var n,r=null==e?void 0:e.target;if(null!==(n=r)&&void 0!==n&&n.shadowRoot&&(r=e.composedPath()[0]),r){if(r===t)return!0;if(t&&t.contains)return t.contains(r);}return null!=e&&!!e.composedPath&&e.composedPath().indexOf(t)>-1;}},{key:"getExistedHTML",value:function(t){if(t.nativeEvent.composedPath)for(var e=0,n=t.nativeEvent.composedPath();e<n.length;e++){var r=n[e],i=this.nativeHTMLMap.get(r);if(i)return i;}return null;}},{key:"pickTarget",value:function(t){return this.hitTest({clientX:t.clientX,clientY:t.clientY,viewportX:t.viewportX,viewportY:t.viewportY,x:t.canvasX,y:t.canvasY});}},{key:"createPointerEvent",value:function(t,e,n,r){var i=this.allocateEvent(rO);this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.nativeEvent=t.nativeEvent,i.originalEvent=t;var a=this.getExistedHTML(i),o=this.context.contextService.getDomElement();return i.target=null!=n?n:a||this.isNativeEventFromCanvas(o,i.nativeEvent)&&this.pickTarget(i)||r,"string"==typeof e&&(i.type=e),i;}},{key:"createWheelEvent",value:function(t){var e=this.allocateEvent(rL);this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t;var n=this.getExistedHTML(e),r=this.context.contextService.getDomElement();return e.target=n||this.isNativeEventFromCanvas(r,e.nativeEvent)&&this.pickTarget(e),e;}},{key:"trackingData",value:function(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t];}},{key:"cloneWheelEvent",value:function(t){var e=this.allocateEvent(rL);return e.nativeEvent=t.nativeEvent,e.originalEvent=t.originalEvent,this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.target=t.target,e.path=t.composedPath().slice(),e.type=t.type,e;}},{key:"clonePointerEvent",value:function(t,e){var n=this.allocateEvent(rO);return n.nativeEvent=t.nativeEvent,n.originalEvent=t.originalEvent,this.copyPointerData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.target=t.target,n.path=t.composedPath().slice(),n.type=null!=e?e:n.type,n;}},{key:"copyPointerData",value:function(t,e){e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist;}},{key:"copyMouseData",value:function(t,e){e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey,e.client.copyFrom(t.client),e.movement.copyFrom(t.movement),e.canvas.copyFrom(t.canvas),e.screen.copyFrom(t.screen),e.global.copyFrom(t.global),e.offset.copyFrom(t.offset);}},{key:"copyWheelData",value:function(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;}},{key:"copyData",value:function(t,e){e.isTrusted=t.isTrusted,e.timeStamp=n0.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.page.copyFrom(t.page),e.viewport.copyFrom(t.viewport);}},{key:"allocateEvent",value:function(t){this.eventPool.has(t)||this.eventPool.set(t,[]);var e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=[],e.target=null,e;}},{key:"freeEvent",value:function(t){if(t.manager!==this)throw Error("It is illegal to free an event not managed by this EventBoundary!");var e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t);}},{key:"notifyTarget",value:function(t,e){e=null!=e?e:t.type;var n=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?"".concat(e,"capture"):e;this.notifyListeners(t,n),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e);}},{key:"notifyListeners",value:function(t,e){var n=t.currentTarget.emitter,r=n._events[e];if(r){if("fn"in r)r.once&&n.removeListener(e,r.fn,void 0,!0),r.fn.call(t.currentTarget||r.context,t);else for(var i=0;i<r.length&&!t.propagationImmediatelyStopped;i++)r[i].once&&n.removeListener(e,r[i].fn,void 0,!0),r[i].fn.call(t.currentTarget||r[i].context,t);}}},{key:"findMountedTarget",value:function(t){if(!t)return null;for(var e=t[t.length-1],n=t.length-2;n>=0;n--){var r=t[n];if(r===this.rootTarget||rD.isNode(r)&&r.parentNode===e)e=t[n];else break;}return e;}},{key:"getCursor",value:function(t){for(var e=t;e;){var n=!!e.getAttribute&&e.getAttribute("cursor");if(n)return n;e=rD.isNode(e)&&e.parentNode;}}}]);var r_=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"getOrCreateCanvas",value:function(t,e){if(this.canvas)return this.canvas;if(t||ii.offscreenCanvas)this.canvas=t||ii.offscreenCanvas,this.context=this.canvas.getContext("2d",(0,A.default)({willReadFrequently:!0},e));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",(0,A.default)({willReadFrequently:!0},e)),this.context&&this.context.measureText||(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"));}catch(t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",(0,A.default)({willReadFrequently:!0},e));}return this.canvas.width=10,this.canvas.height=10,this.canvas;}},{key:"getOrCreateContext",value:function(t,e){return this.context||this.getOrCreateCanvas(t,e),this.context;}}],[{key:"createCanvas",value:function(){try{return new window.OffscreenCanvas(0,0);}catch(t){}try{return document.createElement("canvas");}catch(t){}return null;}}]),rG=((k={})[k.CAMERA_CHANGED=0]="CAMERA_CHANGED",k[k.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",k[k.NONE=2]="NONE",k);(0,R.default)(function t(e,n){(0,C.default)(this,t),this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new ri,initAsync:new rn,dirtycheck:new ra,cull:new ra,beginFrame:new ri,beforeRender:new ri,render:new ri,afterRender:new ri,endFrame:new ri,destroy:new ri,pick:new rr,pickSync:new ra,pointerDown:new ri,pointerUp:new ri,pointerMove:new ri,pointerOut:new ri,pointerOver:new ri,pointerWheel:new ri,pointerCancel:new ri,click:new ri},this.globalRuntime=e,this.context=n;},[{key:"init",value:function(t){var e=this,n=(0,A.default)((0,A.default)({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach(function(t){t.apply(n,e.globalRuntime);}),this.hooks.init.call(),0===this.hooks.initAsync.getCallbacksNum()?(this.inited=!0,t()):this.hooks.initAsync.promise().then(function(){e.inited=!0,t();}).catch(function(t){});}},{key:"getStats",value:function(){return this.stats;}},{key:"disableDirtyRectangleRendering",value:function(){return!this.context.config.renderer.getConfig().enableDirtyRectangleRendering||this.context.renderingContext.renderReasons.has(rG.CAMERA_CHANGED);}},{key:"render",value:function(t,e,n){var r=this,i=t.getConfig(),a=this.context.renderingContext;if(this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0,this.globalRuntime.sceneGraphService.syncHierarchy(a.root),this.globalRuntime.sceneGraphService.notifyMutationObservers(t),a.renderReasons.size&&this.inited){a.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var o=1===a.renderReasons.size&&a.renderReasons.has(rG.CAMERA_CHANGED),s=!i.disableRenderHooks||!o;s&&this.renderDisplayObject(a.root,i,a),this.hooks.beginFrame.call(e),s&&a.renderListCurrentFrame.forEach(function(t){r.hooks.beforeRender.call(t),r.hooks.render.call(t),r.hooks.afterRender.call(t);}),this.hooks.endFrame.call(e),a.renderListCurrentFrame=[],a.renderReasons.clear(),n();}}},{key:"renderDisplayObject",value:function(t,e,n){for(var r=this,i=e.renderer.getConfig(),a=i.enableDirtyCheck,o=i.enableCulling,s=[t];s.length>0;){var l,u=s.pop();!function(t){var e=t.renderable,i=t.sortable,s=a?e.dirty||n.dirtyRectangleRenderingDisabled?t:null:t,l=null;s&&(l=o?r.hooks.cull.call(s,r.context.camera):s)&&(r.stats.rendered+=1,n.renderListCurrentFrame.push(l)),t.dirty(!1),i.renderOrder=r.zIndexCounter,r.zIndexCounter+=1,r.stats.total+=1,i.dirty&&(r.sort(t,i),i.dirty=!1,i.dirtyChildren=[],i.dirtyReason=void 0);}(u);for(var c=(null===(l=u.sortable)||void 0===l||null===(l=l.sorted)||void 0===l?void 0:l.length)>0?u.sortable.sorted:u.childNodes,h=c.length-1;h>=0;h--)s.push(c[h]);}}},{key:"sort",value:function(t,e){var n,r;(null==e||null===(n=e.sorted)||void 0===n?void 0:n.length)>0&&e.dirtyReason!==tC.Z_INDEX_CHANGED?e.dirtyChildren.forEach(function(n){var r=e.sorted.indexOf(n);if(r>-1&&e.sorted.splice(r,1),t.childNodes.indexOf(n)>-1){if(0===e.sorted.length)e.sorted.push(n);else{var i=function(t,e){for(var n=0,r=t.length;n<r;){var i=n+r>>>1;0>nQ(t[i],e)?n=i+1:r=i;}return n;}(e.sorted,n);e.sorted.splice(i,0,n);}}}):e.sorted=t.childNodes.slice().sort(nQ),(null===(r=e.sorted)||void 0===r?void 0:r.length)>0&&0===t.childNodes.filter(function(t){return t.parsedStyle.zIndex;}).length&&(e.sorted=[]);}},{key:"destroy",value:function(){this.inited=!1,this.hooks.destroy.call();}},{key:"dirty",value:function(){this.context.renderingContext.renderReasons.add(rG.DISPLAY_OBJECT_CHANGED);}}]);var rF=/\[\s*(.*)=(.*)\s*\]/,rB=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"selectOne",value:function(t,e){var n=this;if(t.startsWith("."))return e.find(function(e){return((null==e?void 0:e.classList)||[]).indexOf(n.getIdOrClassname(t))>-1;});if(t.startsWith("#"))return e.find(function(e){return e.id===n.getIdOrClassname(t);});if(t.startsWith("[")){var r=this.getAttribute(t),i=r.name,a=r.value;return i?e.find(function(t){return e!==t&&("name"===i?t.name===a:n.attributeToString(t,i)===a);}):null;}return e.find(function(n){return e!==n&&n.nodeName===t;});}},{key:"selectAll",value:function(t,e){var n=this;if(t.startsWith("."))return e.findAll(function(r){return e!==r&&((null==r?void 0:r.classList)||[]).indexOf(n.getIdOrClassname(t))>-1;});if(t.startsWith("#"))return e.findAll(function(r){return e!==r&&r.id===n.getIdOrClassname(t);});if(t.startsWith("[")){var r=this.getAttribute(t),i=r.name,a=r.value;return i?e.findAll(function(t){return e!==t&&("name"===i?t.name===a:n.attributeToString(t,i)===a);}):[];}return e.findAll(function(n){return e!==n&&n.nodeName===t;});}},{key:"is",value:function(t,e){if(t.startsWith("."))return e.className===this.getIdOrClassname(t);if(t.startsWith("#"))return e.id===this.getIdOrClassname(t);if(t.startsWith("[")){var n=this.getAttribute(t),r=n.name,i=n.value;return"name"===r?e.name===i:this.attributeToString(e,r)===i;}return e.nodeName===t;}},{key:"getIdOrClassname",value:function(t){return t.substring(1);}},{key:"getAttribute",value:function(t){var e=t.match(rF),n="",r="";return e&&e.length>2&&(n=e[1].replace(/"/g,""),r=e[2].replace(/"/g,"")),{name:n,value:r};}},{key:"attributeToString",value:function(t,e){if(!t.getAttribute)return"";var n=t.getAttribute(e);return(0,F.isNil)(n)?"":n.toString?n.toString():"";}}]),rU=((E={}).ATTR_MODIFIED="DOMAttrModified",E.INSERTED="DOMNodeInserted",E.MOUNTED="DOMNodeInsertedIntoDocument",E.REMOVED="removed",E.UNMOUNTED="DOMNodeRemovedFromDocument",E.REPARENT="reparent",E.DESTROY="destroy",E.BOUNDS_CHANGED="bounds-changed",E.CULLED="culled",E),rV=function(t){function e(t,n,r,i,a,o,s,l){var u;return(0,C.default)(this,e),(u=(0,L.default)(this,e,[null])).relatedNode=n,u.prevValue=r,u.newValue=i,u.attrName=a,u.attrChange=o,u.prevParsedValue=s,u.newParsedValue=l,u.type=t,u;}return(0,I.default)(e,t),(0,R.default)(e);}(rC);rV.ADDITION=2,rV.MODIFICATION=1,rV.REMOVAL=3;var rz=new rV(rU.REPARENT,null,"","","",0,"",""),rH=G.vec2.create(),rY=G.vec3.create(),rW=G.vec3.fromValues(1,1,1),rq=G.mat4.create(),rX=G.vec2.create(),rj=G.vec3.create(),r$=G.mat4.create(),rK=G.quat.create(),rZ=G.vec3.create(),rQ=G.quat.create(),rJ=G.vec3.create(),r0=G.vec3.create(),r1=G.vec3.create(),r2=G.mat4.create(),r3=G.quat.create(),r4=G.quat.create(),r5=G.quat.create(),r6=(0,R.default)(function t(e){(0,C.default)(this,t),this.displayObjectDependencyMap=new WeakMap,this.runtime=e;},[{key:"matches",value:function(t,e){return this.runtime.sceneGraphSelector.is(t,e);}},{key:"querySelector",value:function(t,e){return this.runtime.sceneGraphSelector.selectOne(t,e);}},{key:"querySelectorAll",value:function(t,e){return this.runtime.sceneGraphSelector.selectAll(t,e);}},{key:"attach",value:function(t,e,n){var r=!1;t.parentNode&&(r=t.parentNode!==e,this.detach(t));var i=t.nodeName===j.FRAGMENT,a=n1(e);t.parentNode=e;var o=i?t.childNodes:[t];(0,F.isNumber)(n)?o.forEach(function(t){e.childNodes.splice(n,0,t),t.parentNode=e;}):o.forEach(function(t){e.childNodes.push(t),t.parentNode=e;});var s=e.sortable;if((null!=s&&null!==(u=s.sorted)&&void 0!==u&&u.length||s.dirty||t.parsedStyle.zIndex)&&(-1===s.dirtyChildren.indexOf(t)&&s.dirtyChildren.push(t),s.dirty=!0,s.dirtyReason=tC.ADDED),!a){if(i)this.dirtyFragment(t);else{var l=t.transformable;l&&this.dirtyWorldTransform(t,l);}if(r){var u,c,h=(null===(c=e.ownerDocument)||void 0===c||null===(c=c.defaultView)||void 0===c||null===(c=c.getConfig())||void 0===c||null===(c=c.future)||void 0===c?void 0:c.experimentalCancelEventPropagation)===!0;t.dispatchEvent(rz,h,h);}}}},{key:"detach",value:function(t){if(t.parentNode){var e,n,r=t.transformable,i=t.parentNode.sortable;(null!=i&&null!==(e=i.sorted)&&void 0!==e&&e.length||null!==(n=t.style)&&void 0!==n&&n.zIndex)&&(-1===i.dirtyChildren.indexOf(t)&&i.dirtyChildren.push(t),i.dirty=!0,i.dirtyReason=tC.REMOVED);var a=t.parentNode.childNodes.indexOf(t);a>-1&&t.parentNode.childNodes.splice(a,1),r&&this.dirtyWorldTransform(t,r),t.parentNode=null;}}},{key:"getLocalPosition",value:function(t){return t.transformable.localPosition;}},{key:"getLocalRotation",value:function(t){return t.transformable.localRotation;}},{key:"getLocalScale",value:function(t){return t.transformable.localScale;}},{key:"getLocalSkew",value:function(t){return t.transformable.localSkew;}},{key:"getLocalTransform",value:function(t){var e=t.transformable;return tI(e),e.localTransform;}},{key:"setLocalPosition",value:function(t,e){var n,r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=t.transformable;r0[0]=e[0],r0[1]=e[1],r0[2]=null!==(n=e[2])&&void 0!==n?n:0,!G.vec3.equals(i.localPosition,r0)&&(G.vec3.copy(i.localPosition,r0),r&&this.dirtyLocalTransform(t,i));}},{key:"translateLocal",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var i=t.transformable;G.vec3.equals(e,rY)||(G.vec3.transformQuat(e,e,i.localRotation),G.vec3.add(i.localPosition,i.localPosition,e),this.dirtyLocalTransform(t,i));}},{key:"setLocalRotation",value:function(t,e,n,r,i){var a=!(arguments.length>5)||void 0===arguments[5]||arguments[5];"number"==typeof e&&(e=G.quat.set(rK,e,n,r,i));var o=t.transformable;G.quat.copy(o.localRotation,e),a&&this.dirtyLocalTransform(t,o);}},{key:"rotateLocal",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var i=t.transformable;G.quat.fromEuler(r4,e[0],e[1],e[2]),G.quat.mul(i.localRotation,i.localRotation,r4),this.dirtyLocalTransform(t,i);}},{key:"setLocalScale",value:function(t,e){var n,r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=t.transformable;G.vec3.set(rj,e[0],e[1],null!==(n=e[2])&&void 0!==n?n:i.localScale[2]),!G.vec3.equals(rj,i.localScale)&&(G.vec3.copy(i.localScale,rj),r&&this.dirtyLocalTransform(t,i));}},{key:"scaleLocal",value:function(t,e){var n,r=t.transformable;G.vec3.multiply(r.localScale,r.localScale,G.vec3.set(rj,e[0],e[1],null!==(n=e[2])&&void 0!==n?n:1)),this.dirtyLocalTransform(t,r);}},{key:"setLocalSkew",value:function(t,e,n){var r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];"number"==typeof e&&(e=G.vec2.set(rX,e,n));var i=t.transformable;G.vec2.copy(i.localSkew,e),r&&this.dirtyLocalTransform(t,i);}},{key:"setLocalEulerAngles",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=!(arguments.length>4)||void 0===arguments[4]||arguments[4];"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var a=t.transformable;G.quat.fromEuler(a.localRotation,e[0],e[1],e[2]),i&&this.dirtyLocalTransform(t,a);}},{key:"setLocalTransform",value:function(t,e){var n=G.mat4.getTranslation(rZ,e),r=G.mat4.getRotation(rQ,e),i=G.mat4.getScaling(rJ,e);this.setLocalScale(t,i,!1),this.setLocalPosition(t,n,!1),this.setLocalRotation(t,r,void 0,void 0,void 0,!1),this.dirtyLocalTransform(t,t.transformable);}},{key:"resetLocalTransform",value:function(t){this.setLocalScale(t,rW,!1),this.setLocalPosition(t,rY,!1),this.setLocalEulerAngles(t,rY,void 0,void 0,!1),this.setLocalSkew(t,rH,void 0,!1),this.dirtyLocalTransform(t,t.transformable);}},{key:"getPosition",value:function(t){var e=t.transformable;return G.mat4.getTranslation(e.position,this.getWorldTransform(t,e));}},{key:"getRotation",value:function(t){var e=t.transformable;return G.mat4.getRotation(e.rotation,this.getWorldTransform(t,e));}},{key:"getScale",value:function(t){var e=t.transformable;return G.mat4.getScaling(e.scaling,this.getWorldTransform(t,e));}},{key:"getOrigin",value:function(t){return t.getGeometryBounds(),t.transformable.origin;}},{key:"getWorldTransform",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.transformable;return(e.localDirtyFlag||e.dirtyFlag)&&(t.parentNode&&t.parentNode.transformable&&this.getWorldTransform(t.parentNode),this.internalUpdateTransform(t)),e.worldTransform;}},{key:"setPosition",value:function(t,e){var n,r=t.transformable;if(r1[0]=e[0],r1[1]=e[1],r1[2]=null!==(n=e[2])&&void 0!==n?n:0,!G.vec3.equals(this.getPosition(t),r1)){if(G.vec3.copy(r.position,r1),null!==t.parentNode&&t.parentNode.transformable){var i=t.parentNode.transformable;G.mat4.copy(r2,i.worldTransform),G.mat4.invert(r2,r2),G.vec3.transformMat4(r.localPosition,r1,r2);}else G.vec3.copy(r.localPosition,r1);this.dirtyLocalTransform(t,r);}}},{key:"translate",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.set(rj,e,n,r)),G.vec3.equals(e,rY)||(G.vec3.add(rj,this.getPosition(t),e),this.setPosition(t,rj));}},{key:"setRotation",value:function(t,e,n,r,i){var a=t.transformable;if("number"==typeof e&&(e=G.quat.fromValues(e,n,r,i)),null!==t.parentNode&&t.parentNode.transformable){var o=this.getRotation(t.parentNode);G.quat.copy(rK,o),G.quat.invert(rK,rK),G.quat.multiply(a.localRotation,rK,e),G.quat.normalize(a.localRotation,a.localRotation),this.dirtyLocalTransform(t,a);}else this.setLocalRotation(t,e);}},{key:"rotate",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var i=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){G.quat.fromEuler(rK,e[0],e[1],e[2]);var a=this.getRotation(t),o=this.getRotation(t.parentNode);G.quat.copy(r5,o),G.quat.invert(r5,r5),G.quat.multiply(rK,r5,rK),G.quat.multiply(i.localRotation,rK,a),G.quat.normalize(i.localRotation,i.localRotation),this.dirtyLocalTransform(t,i);}else this.rotateLocal(t,e);}},{key:"setOrigin",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=[e,n,r]);var i=t.transformable;if(e[0]!==i.origin[0]||e[1]!==i.origin[1]||e[2]!==i.origin[2]){var a=i.origin;a[0]=e[0],a[1]=e[1],a[2]=e[2]||0,this.dirtyLocalTransform(t,i);}}},{key:"setEulerAngles",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var i=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){G.quat.fromEuler(i.localRotation,e[0],e[1],e[2]);var a=this.getRotation(t.parentNode);G.quat.copy(r3,G.quat.invert(rK,a)),G.quat.mul(i.localRotation,i.localRotation,r3),this.dirtyLocalTransform(t,i);}else this.setLocalEulerAngles(t,e);}},{key:"getGeometryBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.geometry;return n.dirty&&ii.styleValueRegistry.updateGeometry(t),(e?n.renderBounds:n.contentBounds||null)||new tr;}},{key:"getTransformedGeometryBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this.getGeometryBounds(t,e);if(!tr.isEmpty(r)){var i=n||new tr;return i.setFromTransformedAABB(r,this.getWorldTransform(t)),i;}return null;}},{key:"getBounds",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t.renderable;if(!r.boundsDirty&&!n&&r.bounds)return r.bounds;if(!r.renderBoundsDirty&&n&&r.renderBounds)return r.renderBounds;var i=n?r.renderBounds:r.bounds,a=this.getTransformedGeometryBounds(t,n,i);if(t.childNodes.forEach(function(t){var r=e.getBounds(t,n);r&&(a?a.add(r):(a=i||new tr).update(r.center,r.halfExtents));}),a||(a=new tr),n){var o=function(t){var e,n=t;do{if(null===(e=n.parsedStyle)||void 0===e?void 0:e.clipPath)return n;n=n.parentElement;}while(null!==n)return null;}(t);if(o){var s=o.parsedStyle.clipPath.getBounds(n);a?s&&(a=s.intersection(a)):a.update(s.center,s.halfExtents);}}return n?(r.renderBounds=a,r.renderBoundsDirty=!1):(r.bounds=a,r.boundsDirty=!1),a;}},{key:"getLocalBounds",value:function(t){if(t.parentNode){var e=rq;t.parentNode.transformable&&(e=G.mat4.invert(r$,this.getWorldTransform(t.parentNode)));var n=this.getBounds(t);if(!tr.isEmpty(n)){var r=new tr;return r.setFromTransformedAABB(n,e),r;}}return this.getBounds(t);}},{key:"getBoundingClientRect",value:function(t){var e,n,r=this.getGeometryBounds(t);tr.isEmpty(r)||(n=new tr).setFromTransformedAABB(r,this.getWorldTransform(t));var i=null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e?void 0:e.getContextService().getBoundingClientRect();if(n){var a=n.getMin(),o=(0,D.default)(a,2),s=o[0],l=o[1],u=n.getMax(),c=(0,D.default)(u,2),h=c[0],d=c[1];return new tl(s+((null==i?void 0:i.left)||0),l+((null==i?void 0:i.top)||0),h-s,d-l);}return new tl((null==i?void 0:i.left)||0,(null==i?void 0:i.top)||0,0,0);}},{key:"internalUpdateTransform",value:function(t){var e,n,r=null===(n=t.parentNode)||void 0===n?void 0:n.transformable;tI(t.transformable),(e=t.transformable).dirtyFlag&&(r?G.mat4.multiply(e.worldTransform,r.worldTransform,e.localTransform):G.mat4.copy(e.worldTransform,e.localTransform),e.dirtyFlag=!1);}},{key:"internalUpdateElement",value:function(t,e){var n=(null===(s=t.ownerDocument)||void 0===s||null===(s=s.defaultView)||void 0===s||null===(s=s.getConfig())||void 0===s||null===(s=s.future)||void 0===s?void 0:s.experimentalAttributeUpdateOptimization)===!0,r=e[e.length-1],i=(null==r?void 0:r.transformDirty)||(null===(l=t.transformable)||void 0===l?void 0:l.localDirtyFlag);t.transformable&&((h=t.transformable).dirtyFlag||(h.dirtyFlag=i)),this.internalUpdateTransform(t),i&&(null===(d=t.dirty)||void 0===d||d.call(t,!0,!0));var a=(null===(u=t.renderable)||void 0===u?void 0:u.boundsDirty)||(null===(c=t.renderable)||void 0===c?void 0:c.renderBoundsDirty);if((i||a)&&(null==r?void 0:r.shapeUpdated)===!1&&n)for(var o=e.length-1;o>=0;){var s,l,u,c,h,d,f,v,p=e[o];if(p.shapeUpdated)break;null===(f=(v=p.node).dirty)||void 0===f||f.call(v,!0,!0),p.shapeUpdated=!0,o-=1;}return i;}},{key:"syncHierarchy",value:function(t){for(var e,n,r=[t],i=t.parentNode?[{node:t.parentNode,transformDirty:(null===(e=t.parentNode.transformable)||void 0===e?void 0:e.localDirtyFlag)||(null===(n=t.parentNode.transformable)||void 0===n?void 0:n.dirtyFlag),shapeUpdated:!1}]:[];r.length>0;){for(var a=r.pop(),o=i[i.length-1];i.length>0&&a.parentNode!==o.node;)o=i.pop();var s=this.internalUpdateElement(a,i);if(a.childNodes.length>0){for(var l=a.childNodes.length-1;l>=0;l--)r.push(a.childNodes[l]);i.push({node:a,transformDirty:s,shapeUpdated:!1});}}}},{key:"dirtyLocalTransform",value:function(t,e){n1(t)||e.localDirtyFlag||(e.localDirtyFlag=!0,e.dirtyFlag||this.dirtyWorldTransform(t,e));}},{key:"dirtyWorldTransform",value:function(t,e){this.dirtyWorldInternal(t,e),this.dirtyToRoot(t,!0);}},{key:"dirtyWorldInternal",value:function(t,e){var n,r=this,i=(null===(n=t.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n||null===(n=n.getConfig())||void 0===n||null===(n=n.future)||void 0===n?void 0:n.experimentalAttributeUpdateOptimization)===!0;e.dirtyFlag||(e.dirtyFlag=!0,t.dirty(!0,!0),i||t.childNodes.forEach(function(t){var e=t.transformable;r.dirtyWorldInternal(t,e);}));}},{key:"dirtyToRoot",value:function(t){for(var e,n,r,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=t,o=(null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig())||void 0===e||null===(e=e.future)||void 0===e?void 0:e.experimentalAttributeUpdateOptimization)===!0;a&&(null===(n=(r=a).dirty)||void 0===n||n.call(r,!0,!0),!o);)a=a.parentNode;i&&t.forEach(function(t){var e;null===(e=t.dirty)||void 0===e||e.call(t,!0,!0);}),this.informDependentDisplayObjects(t);var s=t.mutations||[],l=s.find(function(t){return"attributes"===t.type&&t._boundsChangeData;});l?l._boundsChangeData={affectChildren:l._boundsChangeData.affectChildren||i}:(l={type:"attributes",target:t,_boundsChangeData:{affectChildren:i}},s.push(l)),t.mutations=s;}},{key:"dirtyFragment",value:function(t){var e,n=t.transformable;n&&(n.dirtyFlag=!0,n.localDirtyFlag=!0),null===(e=t.dirty)||void 0===e||e.call(t,!0,!0);for(var r=t.childNodes.length,i=0;i<r;i++)this.dirtyFragment(t.childNodes[i]);}},{key:"notifyMutationObservers",value:function(t){var e=new Set;if(t.getRoot().forEach(function(t){(t.mutations||[]).forEach(function(n){"attributes"===n.type&&n._boundsChangeData&&(n._boundsChangeData.affectChildren?t.forEach(function(t){var r=(0,A.default)({},n);r.target=t,e.add(r);}):e.add(n));}),t.mutations=void 0;}),e.size>0){var n=new rI(rU.BOUNDS_CHANGED,{detail:Array.from(e)});t.dispatchEvent(n,!0,!0);}}},{key:"updateDisplayObjectDependency",value:function(t,e,n,r){if(e&&e!==n){var i=this.displayObjectDependencyMap.get(e);if(i&&i[t]){var a=i[t].indexOf(r);i[t].splice(a,1);}}if(n){var o=this.displayObjectDependencyMap.get(n);o||(this.displayObjectDependencyMap.set(n,{}),o=this.displayObjectDependencyMap.get(n)),o[t]||(o[t]=[]),o[t].push(r);}}},{key:"informDependentDisplayObjects",value:function(t){var e,n=this,r=this.displayObjectDependencyMap.get(t);if(r){var i=null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig())||void 0===e||null===(e=e.future)||void 0===e?void 0:e.experimentalCancelEventPropagation;Object.keys(r).forEach(function(t){r[t].forEach(function(e){n.dirtyToRoot(e,!0),e.dispatchEvent(new rV(rU.ATTR_MODIFIED,e,n,n,t,rV.MODIFICATION,n,n),i,i),e.isCustomElement&&e.isConnected&&e.attributeChangedCallback&&e.attributeChangedCallback(t,n,n);});});}}}]),r7=(0,R.default)(function t(e){if((0,C.default)(this,t),e<=0)throw Error("LRU capacity must be a positive number.");this.capacity=e,this.cache=new Map;},[{key:"get",value:function(t){if(this.cache.has(t)){var e=this.cache.get(t);return this.cache.delete(t),this.cache.set(t,e),e;}}},{key:"put",value:function(t,e){if(this.cache.has(t)&&this.cache.delete(t),this.cache.set(t,e),this.cache.size>this.capacity){var n=this.cache.keys().next().value;this.cache.delete(n);}}},{key:"len",value:function(){return this.cache.size;}},{key:"clear",value:function(){this.cache.clear();}}]),r9={MetricsString:"|\xc9q\xc5",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},r8=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,it=new RegExp("".concat(/[!%),.:;?\]}'""]/.source,"|").concat(/[!),.:;?\]}'""]/.source,"|").concat(/[)\]'"?!:;,.]/.source,"|").concat(/[!%),.:;?\]}'"]/.source)),ie=new RegExp("".concat(/[$('"]/.source,"|").concat(/[([{'"]/.source,"|").concat(/[(['"...]/.source,"|").concat(/[$([{'"#]/.source)),ir=(0,R.default)(function t(e){var n=this;(0,C.default)(this,t),this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(t,e){return!n.isBreakingSpace(e)&&!!(t&&(ie.exec(e)||it.exec(t)));},this.trimByKinsokuShorui=function(t){var e=(0,O.default)(t),n=e[e.length-2];if(!n)return t;var r=n[n.length-1];return e[e.length-2]=n.slice(0,-1),e[e.length-1]=r+e[e.length-1],e;},this.runtime=e,this.charWidthCache=new r7(100);},[{key:"measureFont",value:function(t,e){if(this.fontMetricsCache[t])return this.fontMetricsCache[t];var n={ascent:0,descent:0,fontSize:0},r=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(e),i=this.runtime.offscreenCanvasCreator.getOrCreateContext(e,{willReadFrequently:!0});i.font=t;var a=r9.MetricsString+r9.BaselineSymbol,o=Math.ceil(i.measureText(a).width),s=Math.ceil(i.measureText(r9.BaselineSymbol).width),l=r9.HeightMultiplier*s;s=s*r9.BaselineMultiplier|0,r.width=o,r.height=l,i.fillStyle="#f00",i.fillRect(0,0,o,l),i.font=t,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(a,0,s);var u=i.getImageData(0,0,o||1,l||1).data,c=u.length,h=4*o,d=0,f=0,v=!1;for(d=0;d<s;++d){for(var p=0;p<h;p+=4)if(255!==u[f+p]){v=!0;break;}if(v)break;f+=h;}for(n.ascent=s-d,f=c-h,v=!1,d=l;d>s;--d){for(var g=0;g<h;g+=4)if(255!==u[f+g]){v=!0;break;}if(v)break;f-=h;}return n.descent=d-s,n.fontSize=n.ascent+n.descent,this.fontMetricsCache[t]=n,n;}},{key:"measureText",value:function(t,e,n){var r=e.fontSize,i=void 0===r?16:r,a=e.wordWrap,o=e.lineHeight,s=e.lineWidth,l=void 0===s?1:s,u=e.textBaseline,c=void 0===u?"alphabetic":u,h=e.textAlign,d=void 0===h?"start":h,f=e.letterSpacing,v=void 0===f?0:f,p=e.textPath;e.textPathSide,e.textPathStartOffset;var g=e.leading,y=void 0===g?0:g,m=ru(e),k=this.measureFont(m,n);0===k.fontSize&&(k.fontSize=i,k.ascent=i);var E=this.runtime.offscreenCanvasCreator.getOrCreateContext(n);E.font=m,e.isOverflowing=!1;var x=(void 0!==a&&a?this.wordWrap(t,e,n):t).split(/(?:\r\n|\r|\n)/),T=Array(x.length),N=0;if(p){p.getTotalLength();for(var b=0;b<x.length;b++)E.measureText(x[b]).width,x[b].length;}else{for(var S=0;S<x.length;S++){var w=E.measureText(x[S]).width+(x[S].length-1)*v;T[S]=w,N=Math.max(N,w);}var P=N+l,M=o||k.fontSize+l,A=Math.max(M,k.fontSize+l)+(x.length-1)*(M+y);M+=y;var C=0;return"middle"===c?C=-A/2:"bottom"===c||"alphabetic"===c||"ideographic"===c?C=-A:("top"===c||"hanging"===c)&&(C=0),{font:m,width:P,height:A,lines:x,lineWidths:T,lineHeight:M,maxLineWidth:N,fontProperties:k,lineMetrics:T.map(function(t,e){var n=0;return"center"===d||"middle"===d?n-=t/2:("right"===d||"end"===d)&&(n-=t),new tl(n-l/2,C+e*M,t+l,M);})};}}},{key:"wordWrap",value:function(t,e,n){var r=this,i=Array.from(t);if(0===i.length)return"";var a=this,o=e.wordWrapWidth,s=e.letterSpacing,l=void 0===s?0:s,u=e.maxLines,c=void 0===u?1/0:u,h=e.textOverflow,d=this.runtime.offscreenCanvasCreator.getOrCreateContext(n),f=(void 0===o?0:o)+l,v="";"ellipsis"===h?v="...":h&&"clip"!==h&&(v=h);var p=[""],g=0,y=0,m=-1,k=ru(e),E=this.charWidthCache.get(k);E||(E=new r7(500),this.charWidthCache.put(k,E));var x=function(t){return r.getFromCache(t,l,E,d);},T=x(v);function N(t,e,n,r){for(;x(t)<r&&e<i.length-1&&!a.isNewline(i[e+1]);)e+=1,t+=i[e];for(;x(t)>r&&e>=n;)e-=1,t=t.slice(0,-1);return{lineTxt:t,txtLastCharIndex:e};}function b(t,e){if(!(T<=0)&&!(T>f)){if(!p[t]){p[t]=v;return;}var n=N(p[t],e,m+1,f-T);p[t]=n.lineTxt+v;}}for(var S=0;S<i.length;S++){var w=i[S],P=i[S-1],M=i[S+1],A=x(w);if(this.isNewline(w)){if(g+1>=c){S<i.length-1&&b(g,S-1),e.isOverflowing=!0;break;}m=S-1,y=0,p[g+=1]="";continue;}if(A>f){b(g,S-1),e.isOverflowing=!0;break;}if(y>0&&y+A>f){var C=N(p[g],S-1,m+1,f);if(C.txtLastCharIndex!==S-1){if(p[g]=C.lineTxt,C.txtLastCharIndex===i.length-1)break;w=i[S=C.txtLastCharIndex+1],P=i[S-1],M=i[S+1],A=x(w);}if(g+1>=c){b(g,S-1),e.isOverflowing=!0;break;}if(m=S-1,y=0,p[g+=1]="",this.isBreakingSpace(w))continue;this.canBreakInLastChar(w)||(p=this.trimToBreakable(p),y=this.sumTextWidthByCache(p[g]||"",x)),this.shouldBreakByKinsokuShorui(w,M)&&(p=this.trimByKinsokuShorui(p),y+=x(P||""));}y+=A,p[g]+=w;}return p.join("\n");}},{key:"isBreakingSpace",value:function(t){return"string"==typeof t&&r9.BreakingSpaces.indexOf(t.charCodeAt(0))>=0;}},{key:"isNewline",value:function(t){return"string"==typeof t&&r9.Newlines.indexOf(t.charCodeAt(0))>=0;}},{key:"trimToBreakable",value:function(t){var e=(0,O.default)(t),n=e[e.length-2],r=this.findBreakableIndex(n);if(-1===r||!n)return e;var i=n.slice(r,r+1),a=this.isBreakingSpace(i);return e[e.length-1]+=n.slice(r+1,n.length),e[e.length-2]=n.slice(0,r+(a?0:1)),e;}},{key:"canBreakInLastChar",value:function(t){return!(t&&r8.test(t));}},{key:"sumTextWidthByCache",value:function(t,e){return t.split("").reduce(function(t,n){return t+e(n);},0);}},{key:"findBreakableIndex",value:function(t){for(var e=t.length-1;e>=0;e--)if(!r8.test(t[e]))return e;return -1;}},{key:"getFromCache",value:function(t,e,n,r){var i=n.get(t);if("number"!=typeof i){var a=t.length*e;i=r.measureText(t).width+a,n.put(t,i);}return i;}},{key:"clearCache",value:function(){this.fontMetricsCache={},this.charWidthCache.clear();}}]),ii={},ia=(T=new rw,N=new rS,x={},(0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)(x,j.FRAGMENT,null),j.CIRCLE,new rx),j.ELLIPSE,new rT),j.RECT,T),j.IMAGE,T),j.GROUP,new rM),j.LINE,new rN),j.TEXT,new rP(ii)),j.POLYLINE,N),j.POLYGON,N),(0,B.default)((0,B.default)((0,B.default)(x,j.PATH,new rb),j.HTML,new rA),j.MESH,null)),io=(S=new nG,w=new nU,b={},(0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)(b,t_.PERCENTAGE,null),t_.NUMBER,new nY),t_.ANGLE,new nD),t_.DEFINED_PATH,new n_),t_.PAINT,S),t_.COLOR,S),t_.FILTER,new nF),t_.LENGTH,w),t_.LENGTH_PERCENTAGE,w),t_.LENGTH_PERCENTAGE_12,new nV),(0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)(b,t_.LENGTH_PERCENTAGE_14,new nz),t_.COORDINATE,new nU),t_.OFFSET_DISTANCE,new nW),t_.OPACITY_VALUE,new nq),t_.PATH,new nX),t_.LIST_OF_POINTS,new nj),t_.SHADOW_BLUR,new n$),t_.TEXT,new nK),t_.TEXT_TRANSFORM,new nZ),t_.TRANSFORM,new rm),(0,B.default)((0,B.default)((0,B.default)(b,t_.TRANSFORM_ORIGIN,new rk),t_.Z_INDEX,new rE),t_.MARKER,new nH));ii.CameraContribution=tM,ii.AnimationTimeline=null,ii.EasingFunction=null,ii.offscreenCanvasCreator=new r_,ii.sceneGraphSelector=new rB,ii.sceneGraphService=new r6(ii),ii.textService=new ir(ii),ii.geometryUpdaterFactory=ia,ii.CSSPropertySyntaxFactory=io,ii.styleValueRegistry=new nL(ii),ii.layoutRegistry=null,ii.globalThis="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==X?X:{},ii.enableStyleSyntax=!0,ii.enableSizeAttenuation=!1;var is=0,il=new rV(rU.INSERTED,null,"","","",0,"",""),iu=new rV(rU.REMOVED,null,"","","",0,"",""),ic=new rI(rU.DESTROY),ih=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).entity=is++,t.transformable={dirtyFlag:!1,localDirtyFlag:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},t.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},t.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},t.cullable={strategy:tA.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},t.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},t.rBushNode={aabb:void 0},t.namespaceURI="g",t.scrollLeft=0,t.scrollTop=0,t.clientTop=0,t.clientLeft=0,t.style={},t.computedStyle={},t.parsedStyle={},t.attributes={},t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"dirty",value:function(){var t=!(arguments.length>0)||void 0===arguments[0]||arguments[0],e=arguments.length>1?arguments[1]:void 0;this.renderable.dirty=t,void 0!==e&&(this.renderable.boundsDirty=e,this.renderable.renderBoundsDirty=e,this.geometry.dirty=e);}},{key:"className",get:function(){return this.getAttribute("class")||"";},set:function(t){this.setAttribute("class",t);}},{key:"classList",get:function(){return this.className.split(" ").filter(function(t){return""!==t;});}},{key:"tagName",get:function(){return this.nodeName;}},{key:"children",get:function(){return this.childNodes;}},{key:"childElementCount",get:function(){return this.childNodes.length;}},{key:"firstElementChild",get:function(){return this.firstChild;}},{key:"lastElementChild",get:function(){return this.lastChild;}},{key:"parentElement",get:function(){return this.parentNode;}},{key:"nextSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t+1]||null;}return null;}},{key:"previousSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t-1]||null;}return null;}},{key:"cloneNode",value:function(t){throw Error(tu);}},{key:"appendChild",value:function(t,e){var n;if(t.destroyed)throw Error("Cannot append a destroyed element.");return ii.sceneGraphService.attach(t,this,e),null!==(n=this.ownerDocument)&&void 0!==n&&n.defaultView&&(n1(this)||t.nodeName!==j.FRAGMENT?this.ownerDocument.defaultView.mountChildren(t):this.ownerDocument.defaultView.mountFragment(t)),this.isMutationObserved&&(il.relatedNode=this,t.dispatchEvent(il)),t;}},{key:"insertBefore",value:function(t,e){if(e){t.parentElement&&t.parentElement.removeChild(t);var n=this.childNodes.indexOf(e);-1===n?this.appendChild(t):this.appendChild(t,n);}else this.appendChild(t);return t;}},{key:"replaceChild",value:function(t,e){var n=this.childNodes.indexOf(e);return this.removeChild(e),this.appendChild(t,n),e;}},{key:"removeChild",value:function(t){var e,n,r=(null===(e=this.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig().future)||void 0===e?void 0:e.experimentalCancelEventPropagation)===!0;return iu.relatedNode=this,t.dispatchEvent(iu,r,r),null!==(n=t.ownerDocument)&&void 0!==n&&n.defaultView&&t.ownerDocument.defaultView.unmountChildren(t),ii.sceneGraphService.detach(t),t;}},{key:"removeChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var e=this.childNodes[t];this.removeChild(e);}}},{key:"destroyChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var e=this.childNodes[t];e.childNodes.length>0&&e.destroyChildren(),e.destroy();}}},{key:"matches",value:function(t){return ii.sceneGraphService.matches(t,this);}},{key:"getElementById",value:function(t){return ii.sceneGraphService.querySelector("#".concat(t),this);}},{key:"getElementsByName",value:function(t){return ii.sceneGraphService.querySelectorAll('[name="'.concat(t,'"]'),this);}},{key:"getElementsByClassName",value:function(t){return ii.sceneGraphService.querySelectorAll(".".concat(t),this);}},{key:"getElementsByTagName",value:function(t){return ii.sceneGraphService.querySelectorAll(t,this);}},{key:"querySelector",value:function(t){return ii.sceneGraphService.querySelector(t,this);}},{key:"querySelectorAll",value:function(t){return ii.sceneGraphService.querySelectorAll(t,this);}},{key:"closest",value:function(t){var e=this;do{if(ii.sceneGraphService.matches(t,e))return e;e=e.parentElement;}while(null!==e)return null;}},{key:"find",value:function(t){var e=this,n=null;return this.forEach(function(r){return!(r!==e&&t(r))||(n=r,!1);}),n;}},{key:"findAll",value:function(t){var e=this,n=[];return this.forEach(function(r){r!==e&&t(r)&&n.push(r);}),n;}},{key:"after",value:function(){var t=this;if(this.parentNode){for(var e=this.parentNode.childNodes.indexOf(this),n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];r.forEach(function(n,r){var i;return null===(i=t.parentNode)||void 0===i?void 0:i.appendChild(n,e+r+1);});}}},{key:"before",value:function(){if(this.parentNode){for(var t=this.parentNode.childNodes.indexOf(this),e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n[0],a=(0,V.default)(n).slice(1);this.parentNode.appendChild(i,t),i.after.apply(i,(0,O.default)(a));}}},{key:"replaceWith",value:function(){this.after.apply(this,arguments),this.remove();}},{key:"append",value:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(function(e){return t.appendChild(e);});}},{key:"prepend",value:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(function(e,n){return t.appendChild(e,n);});}},{key:"replaceChildren",value:function(){for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,arguments);}},{key:"remove",value:function(){return this.parentNode?this.parentNode.removeChild(this):this;}},{key:"destroy",value:function(){var t,e=(null===(t=this.ownerDocument)||void 0===t||null===(t=t.defaultView)||void 0===t||null===(t=t.getConfig().future)||void 0===t?void 0:t.experimentalCancelEventPropagation)===!0;this.destroyChildren(),this.dispatchEvent(ic,e,e),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0;}},{key:"getGeometryBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return ii.sceneGraphService.getGeometryBounds(this,t);}},{key:"getTransformedGeometryBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return ii.sceneGraphService.getTransformedGeometryBounds(this,t);}},{key:"getBounds",value:function(){return ii.sceneGraphService.getBounds(this);}},{key:"getRenderBounds",value:function(){return ii.sceneGraphService.getBounds(this,!0);}},{key:"getLocalBounds",value:function(){return ii.sceneGraphService.getLocalBounds(this);}},{key:"getBoundingClientRect",value:function(){return ii.sceneGraphService.getBoundingClientRect(this);}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()];}},{key:"computedStyleMap",value:function(){return new Map(Object.entries(this.computedStyle));}},{key:"getAttributeNames",value:function(){return Object.keys(this.attributes);}},{key:"getAttribute",value:function(t){if("symbol"!=typeof t)return this.attributes[t];}},{key:"hasAttribute",value:function(t){return this.getAttributeNames().includes(t);}},{key:"hasAttributes",value:function(){return!!this.getAttributeNames().length;}},{key:"removeAttribute",value:function(t){this.setAttribute(t,null),delete this.attributes[t];}},{key:"setAttribute",value:function(t,e){this.attributes[t]=e;}},{key:"getAttributeNS",value:function(t,e){throw Error(tu);}},{key:"getAttributeNode",value:function(t){throw Error(tu);}},{key:"getAttributeNodeNS",value:function(t,e){throw Error(tu);}},{key:"hasAttributeNS",value:function(t,e){throw Error(tu);}},{key:"removeAttributeNS",value:function(t,e){throw Error(tu);}},{key:"removeAttributeNode",value:function(t){throw Error(tu);}},{key:"setAttributeNS",value:function(t,e,n){throw Error(tu);}},{key:"setAttributeNode",value:function(t){throw Error(tu);}},{key:"setAttributeNodeNS",value:function(t){throw Error(tu);}},{key:"toggleAttribute",value:function(t,e){throw Error(tu);}}]);}(rD);function id(t){return!!(null!=t&&t.nodeName);}var iv=ii.globalThis.Proxy?ii.globalThis.Proxy:function(){},ip=new rV(rU.ATTR_MODIFIED,null,null,null,null,rV.MODIFICATION,null,null),ig=G.vec3.create(),iy=G.quat.create(),im=function(t){function e(t){var n;return(0,C.default)(this,e),(n=(0,L.default)(this,e)).isCustomElement=!1,n.isMutationObserved=!1,n.activeAnimations=[],n.config=t,n.id=t.id||"",n.name=t.name||"",(t.className||t.class)&&(n.className=t.className||t.class),n.nodeName=t.type||j.GROUP,t.initialParsedStyle&&Object.assign(n.parsedStyle,t.initialParsedStyle),n.initAttributes(t.style),ii.enableStyleSyntax&&(n.style=new iv({setProperty:function(t,e){n.setAttribute(t,e);},getPropertyValue:function(t){return n.getAttribute(t);},removeProperty:function(t){n.removeAttribute(t);},item:function(){return"";}},{get:function(t,e){return void 0!==t[e]?t[e]:n.getAttribute(e);},set:function(t,e,r){return n.setAttribute(e,r),!0;}})),n;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"destroy",value:function(){(0,U.default)(e,"destroy",this,3)([]),this.getAnimations().forEach(function(t){t.cancel();});}},{key:"cloneNode",value:function(t,e){var n=(0,A.default)({},this.attributes);for(var r in n){var i=n[r];id(i)&&"clipPath"!==r&&"offsetPath"!==r&&"textPath"!==r&&(n[r]=i.cloneNode(t)),e&&(n[r]=e(r,i));}var a=new this.constructor((0,A.default)((0,A.default)({},this.config),{},{style:n}));return a.setLocalTransform(this.getLocalTransform()),t&&this.children.forEach(function(e){if(!e.style.isMarker){var n=e.cloneNode(t);a.appendChild(n);}}),a;}},{key:"initAttributes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ii.styleValueRegistry.processProperties(this,t,{forceUpdateGeometry:!0}),this.dirty();}},{key:"setAttribute",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!(arguments.length>3)||void 0===arguments[3]||arguments[3];!(0,F.isUndefined)(n)&&(r||n!==this.attributes[t])&&(this.internalSetAttribute(t,n,{memoize:i}),(0,U.default)(e,"setAttribute",this,3)([t,n]));}},{key:"internalSetAttribute",value:function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.attributes[t],a=this.parsedStyle[t];ii.styleValueRegistry.processProperties(this,(0,B.default)({},t,e),r),this.dirty();var o=this.parsedStyle[t];if(this.isConnected){if(ip.relatedNode=this,ip.prevValue=i,ip.newValue=e,ip.attrName=t,ip.prevParsedValue=a,ip.newParsedValue=o,this.isMutationObserved)this.dispatchEvent(ip);else{var s,l=(null===(s=this.ownerDocument.defaultView.getConfig().future)||void 0===s?void 0:s.experimentalCancelEventPropagation)===!0;ip.target=this,this.ownerDocument.defaultView.dispatchEvent(ip,!0,l);}}(this.isCustomElement&&this.isConnected||!this.isCustomElement)&&(null===(n=this.attributeChangedCallback)||void 0===n||n.call(this,t,i,e,a,o));}},{key:"getBBox",value:function(){var t=this.getBounds(),e=t.getMin(),n=(0,D.default)(e,2),r=n[0],i=n[1],a=t.getMax(),o=(0,D.default)(a,2);return new tl(r,i,o[0]-r,o[1]-i);}},{key:"setOrigin",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ii.sceneGraphService.setOrigin(this,td(t,e,n,!1)),this;}},{key:"getOrigin",value:function(){return ii.sceneGraphService.getOrigin(this);}},{key:"setPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ii.sceneGraphService.setPosition(this,td(t,e,n,!1)),this;}},{key:"setLocalPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ii.sceneGraphService.setLocalPosition(this,td(t,e,n,!1)),this;}},{key:"translate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ii.sceneGraphService.translate(this,td(t,e,n,!1)),this;}},{key:"translateLocal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ii.sceneGraphService.translateLocal(this,td(t,e,n,!1)),this;}},{key:"getPosition",value:function(){return ii.sceneGraphService.getPosition(this);}},{key:"getLocalPosition",value:function(){return ii.sceneGraphService.getLocalPosition(this);}},{key:"scale",value:function(t,e,n){return this.scaleLocal(t,e,n);}},{key:"scaleLocal",value:function(t,e,n){return"number"==typeof t&&(e=e||t,n=n||t,t=td(t,e,n,!1)),ii.sceneGraphService.scaleLocal(this,t),this;}},{key:"setLocalScale",value:function(t,e,n){return"number"==typeof t&&(e=e||t,n=n||t,t=td(t,e,n,!1)),ii.sceneGraphService.setLocalScale(this,t),this;}},{key:"getLocalScale",value:function(){return ii.sceneGraphService.getLocalScale(this);}},{key:"getScale",value:function(){return ii.sceneGraphService.getScale(this);}},{key:"getEulerAngles",value:function(){var t=tg(ig,ii.sceneGraphService.getWorldTransform(this));return(0,D.default)(t,3)[2]*tv;}},{key:"getLocalEulerAngles",value:function(){var t=tg(ig,ii.sceneGraphService.getLocalRotation(this));return(0,D.default)(t,3)[2]*tv;}},{key:"setEulerAngles",value:function(t){return ii.sceneGraphService.setEulerAngles(this,0,0,t),this;}},{key:"setLocalEulerAngles",value:function(t){return ii.sceneGraphService.setLocalEulerAngles(this,0,0,t),this;}},{key:"rotateLocal",value:function(t,e,n){return(0,F.isNil)(e)&&(0,F.isNil)(n)?ii.sceneGraphService.rotateLocal(this,0,0,t):ii.sceneGraphService.rotateLocal(this,t,e,n),this;}},{key:"rotate",value:function(t,e,n){return(0,F.isNil)(e)&&(0,F.isNil)(n)?ii.sceneGraphService.rotate(this,0,0,t):ii.sceneGraphService.rotate(this,t,e,n),this;}},{key:"setRotation",value:function(t,e,n,r){return ii.sceneGraphService.setRotation(this,t,e,n,r),this;}},{key:"setLocalRotation",value:function(t,e,n,r){return ii.sceneGraphService.setLocalRotation(this,t,e,n,r),this;}},{key:"setLocalSkew",value:function(t,e){return ii.sceneGraphService.setLocalSkew(this,t,e),this;}},{key:"getRotation",value:function(){return ii.sceneGraphService.getRotation(this);}},{key:"getLocalRotation",value:function(){return ii.sceneGraphService.getLocalRotation(this);}},{key:"getLocalSkew",value:function(){return ii.sceneGraphService.getLocalSkew(this);}},{key:"getLocalTransform",value:function(){return ii.sceneGraphService.getLocalTransform(this);}},{key:"getWorldTransform",value:function(){return ii.sceneGraphService.getWorldTransform(this);}},{key:"setLocalTransform",value:function(t){return ii.sceneGraphService.setLocalTransform(this,t),this;}},{key:"resetLocalTransform",value:function(){ii.sceneGraphService.resetLocalTransform(this);}},{key:"getAnimations",value:function(){return this.activeAnimations;}},{key:"animate",value:function(t,e){var n,r=null===(n=this.ownerDocument)||void 0===n?void 0:n.timeline;return r?r.play(this,t,e):null;}},{key:"isVisible",value:function(){var t;return(null===(t=this.parsedStyle)||void 0===t?void 0:t.visibility)!=="hidden";}},{key:"interactive",get:function(){return this.isInteractive();},set:function(t){this.style.pointerEvents=t?"auto":"none";}},{key:"isInteractive",value:function(){var t;return(null===(t=this.parsedStyle)||void 0===t?void 0:t.pointerEvents)!=="none";}},{key:"isCulled",value:function(){return!!(this.cullable&&this.cullable.enable&&!this.cullable.visible);}},{key:"toFront",value:function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,(0,O.default)(this.parentNode.children.map(function(t){return Number(t.style.zIndex);})))+1),this;}},{key:"toBack",value:function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,(0,O.default)(this.parentNode.children.map(function(t){return Number(t.style.zIndex);})))-1),this;}},{key:"getConfig",value:function(){return this.config;}},{key:"attr",value:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n[0],a=n[1];return i?(0,F.isObject)(i)?(Object.keys(i).forEach(function(e){t.setAttribute(e,i[e]);}),this):2===n.length?(this.setAttribute(i,a),this):this.attributes[i]:this.attributes;}},{key:"getMatrix",value:function(t){var e,n,r,i=t||this.getWorldTransform(),a=G.mat4.getTranslation(ig,i),o=(0,D.default)(a,2),s=o[0],l=o[1],u=G.mat4.getScaling(ig,i),c=(0,D.default)(u,2),h=c[0],d=c[1],f=tg(ig,G.mat4.getRotation(iy,i)),v=(0,D.default)(f,3),p=v[0],g=v[2];return n=Math.cos(e=p||g),r=Math.sin(e),G.mat3.fromValues(h*n,d*r,0,-h*r,d*n,0,s,l,1);}},{key:"getLocalMatrix",value:function(){return this.getMatrix(this.getLocalTransform());}},{key:"setMatrix",value:function(t){var e=ty(t),n=(0,D.default)(e,5),r=n[0],i=n[1],a=n[2],o=n[3],s=n[4];this.setEulerAngles(s).setPosition(r,i).setLocalScale(a,o);}},{key:"setLocalMatrix",value:function(t){var e=ty(t),n=(0,D.default)(e,5),r=n[0],i=n[1],a=n[2],o=n[3],s=n[4];this.setLocalEulerAngles(s).setLocalPosition(r,i).setLocalScale(a,o);}},{key:"show",value:function(){this.forEach(function(t){t.style.visibility="visible";});}},{key:"hide",value:function(){this.forEach(function(t){t.style.visibility="hidden";});}},{key:"getCount",value:function(){return this.childElementCount;}},{key:"getParent",value:function(){return this.parentElement;}},{key:"getChildren",value:function(){return this.children;}},{key:"getFirst",value:function(){return this.firstElementChild;}},{key:"getLast",value:function(){return this.lastElementChild;}},{key:"getChildByIndex",value:function(t){return this.children[t]||null;}},{key:"add",value:function(t,e){return this.appendChild(t,e);}},{key:"set",value:function(t,e){this.config[t]=e;}},{key:"get",value:function(t){return this.config[t];}},{key:"moveTo",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(t,e,n),this;}},{key:"move",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(t,e,n),this;}},{key:"setZIndex",value:function(t){return this.style.zIndex=t,this;}}]);}(ih);im.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","display","draggable","droppable","fill","fillOpacity","fillRule","filter","increasedLineWidthForHitTesting","lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit","hitArea","offsetDistance","offsetPath","offsetX","offsetY","opacity","pointerEvents","shadowColor","shadowType","shadowBlur","shadowOffsetX","shadowOffsetY","stroke","strokeOpacity","strokeWidth","strokeLinecap","strokeLineJoin","strokeDasharray","strokeDashoffset","transform","transformOrigin","textTransform","visibility","zIndex"]);var ik=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.CIRCLE},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(im);ik.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(im.PARSED_STYLE_LIST),["cx","cy","cz","r","isBillboard","isSizeAttenuation"]));var iE=["style"];(function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iE);return(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({style:r},i)])).isCustomElement=!0,t;}return(0,I.default)(e,t),(0,R.default)(e);})(im).PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var ix=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.ELLIPSE},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(im);ix.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(im.PARSED_STYLE_LIST),["cx","cy","cz","rx","ry","isBillboard","isSizeAttenuation"])),function(t){function e(){return(0,C.default)(this,e),(0,L.default)(this,e,[{type:j.FRAGMENT}]);}return(0,I.default)(e,t),(0,R.default)(e);}(im).PARSED_STYLE_LIST=new Set(["class","className"]);var iT=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.GROUP},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(im);iT.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var iN=["style"],ib=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iN);return(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({type:j.HTML,style:r},i)])).cullable.enable=!1,t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getDomElement",value:function(){return this.parsedStyle.$el;}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()];}},{key:"getLocalBounds",value:function(){if(this.parentNode){var t=G.mat4.invert(G.mat4.create(),this.parentNode.getWorldTransform()),e=this.getBounds();if(!tr.isEmpty(e)){var n=new tr;return n.setFromTransformedAABB(e,t),n;}}return this.getBounds();}}]);}(im);ib.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(im.PARSED_STYLE_LIST),["x","y","$el","innerHTML","width","height"]));var iS=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.IMAGE},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(im);iS.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(im.PARSED_STYLE_LIST),["x","y","z","src","width","height","isBillboard","billboardRotation","isSizeAttenuation","keepAspectRatio"]));var iw=["style"],iP=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iw);(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({type:j.LINE,style:(0,A.default)({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},r)},i)])).markerStartAngle=0,t.markerEndAngle=0;var a=t.parsedStyle,o=a.markerStart,s=a.markerEnd;return o&&id(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),s&&id(s)&&(t.markerEndAngle=s.getLocalEulerAngles(),t.appendChild(s)),t.transformMarker(!0),t.transformMarker(!1),t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"x1"===t||"y1"===t||"x2"===t||"y2"===t||"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&id(r)&&(this.markerStartAngle=0,r.remove()),i&&id(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t&&(r&&id(r)&&(this.markerEndAngle=0,r.remove()),i&&id(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1)));}},{key:"transformMarker",value:function(t){var e,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,h=s.markerEndOffset,d=s.x1,f=s.x2,v=s.y1,p=s.y2,g=t?l:u;if(g&&id(g)){var y=0;t?(r=d,i=v,e=f-d,n=p-v,a=c||0,o=this.markerStartAngle):(r=f,i=p,e=d-f,n=v-p,a=h||0,o=this.markerEndAngle),y=Math.atan2(n,e),g.setLocalEulerAngles(180*y/Math.PI+o),g.setLocalPosition(r+Math.cos(y)*a,i+Math.sin(y)*a);}}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle,r=n.x1,i=n.y1,a=n.x2,o=n.y2,s=(0,z.linePointAt)(r,i,a,o,t),l=s.x,u=s.y,c=G.vec3.transformMat4(G.vec3.create(),G.vec3.fromValues(l,u,0),e?this.getWorldTransform():this.getLocalTransform());return new ts(c[0],c[1]);}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(t/this.getTotalLength(),e);}},{key:"getTotalLength",value:function(){var t=this.parsedStyle,e=t.x1,n=t.y1,r=t.x2,i=t.y2;return(0,z.lineLength)(e,n,r,i);}}]);}(im);iP.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(im.PARSED_STYLE_LIST),["x1","y1","x2","y2","z1","z2","isBillboard","isSizeAttenuation","markerStart","markerEnd","markerStartOffset","markerEndOffset"]));var iM=["style"],iA=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iM);(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({type:j.PATH,style:r,initialParsedStyle:{miterLimit:4,d:(0,A.default)({},tD)}},i)])).markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var a=t.parsedStyle,o=a.markerStart,s=a.markerEnd,l=a.markerMid;return o&&id(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),l&&id(l)&&t.placeMarkerMid(l),s&&id(s)&&(t.markerEndAngle=s.getLocalEulerAngles(),t.appendChild(s)),t.transformMarker(!0),t.transformMarker(!1),t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"d"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&id(r)&&(this.markerStartAngle=0,r.remove()),i&&id(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t?(r&&id(r)&&(this.markerEndAngle=0,r.remove()),i&&id(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(i);}},{key:"transformMarker",value:function(t){var e,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,h=s.markerEndOffset,d=t?l:u;if(d&&id(d)){var f=0;if(t){var v=this.getStartTangent(),p=(0,D.default)(v,2),g=p[0],y=p[1];r=y[0],i=y[1],e=g[0]-y[0],n=g[1]-y[1],a=c||0,o=this.markerStartAngle;}else{var m=this.getEndTangent(),k=(0,D.default)(m,2),E=k[0],x=k[1];r=x[0],i=x[1],e=E[0]-x[0],n=E[1]-x[1],a=h||0,o=this.markerEndAngle;}f=Math.atan2(n,e),d.setLocalEulerAngles(180*f/Math.PI+o),d.setLocalPosition(r+Math.cos(f)*a,i+Math.sin(f)*a);}}},{key:"placeMarkerMid",value:function(t){var e=this.parsedStyle.d.segments;if(this.markerMidList.forEach(function(t){t.remove();}),t&&id(t))for(var n=1;n<e.length-1;n++){var r=(0,D.default)(e[n].currentPoint,2),i=r[0],a=r[1],o=1===n?t:t.cloneNode(!0);this.markerMidList.push(o),this.appendChild(o),o.setLocalPosition(i,a);}}},{key:"getTotalLength",value:function(){return e9(this);}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle.d.absolutePath,r=(0,F.getPointAtLength)(n,t),i=r.x,a=r.y,o=G.vec3.transformMat4(G.vec3.create(),G.vec3.fromValues(i,a,0),e?this.getWorldTransform():this.getLocalTransform());return new ts(o[0],o[1]);}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPointAtLength(t*e9(this),e);}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.d.segments,e=[];if(t.length>1){var n=t[0].currentPoint,r=t[1].currentPoint,i=t[1].startTangent;e=[],i?e.push([n[0]-i[0],n[1]-i[1]]):e.push([r[0],r[1]]),e.push([n[0],n[1]]);}return e;}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.d.segments,e=t.length,n=[];if(e>1){var r=t[e-2].currentPoint,i=t[e-1].currentPoint,a=t[e-1].endTangent;n=[],a?n.push([i[0]-a[0],i[1]-a[1]]):n.push([r[0],r[1]]),n.push([i[0],i[1]]);}return n;}}]);}(im);iA.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(im.PARSED_STYLE_LIST),["d","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard","isSizeAttenuation"]));var iC=["style"],iR=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iC);(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({type:j.POLYGON,style:r,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},i)])).markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var a=t.parsedStyle,o=a.markerStart,s=a.markerEnd,l=a.markerMid;return o&&id(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),l&&id(l)&&t.placeMarkerMid(l),s&&id(s)&&(t.markerEndAngle=s.getLocalEulerAngles(),t.appendChild(s)),t.transformMarker(!0),t.transformMarker(!1),t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"points"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&id(r)&&(this.markerStartAngle=0,r.remove()),i&&id(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t?(r&&id(r)&&(this.markerEndAngle=0,r.remove()),i&&id(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(i);}},{key:"transformMarker",value:function(t){var e,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,h=s.markerEndOffset,d=(s.points||{}).points,f=t?l:u;if(f&&id(f)&&d){var v=0;if(r=d[0][0],i=d[0][1],t)e=d[1][0]-d[0][0],n=d[1][1]-d[0][1],a=c||0,o=this.markerStartAngle;else{var p=d.length;this.parsedStyle.isClosed?(e=d[p-1][0]-d[0][0],n=d[p-1][1]-d[0][1]):(r=d[p-1][0],i=d[p-1][1],e=d[p-2][0]-d[p-1][0],n=d[p-2][1]-d[p-1][1]),a=h||0,o=this.markerEndAngle;}v=Math.atan2(n,e),f.setLocalEulerAngles(180*v/Math.PI+o),f.setLocalPosition(r+Math.cos(v)*a,i+Math.sin(v)*a);}}},{key:"placeMarkerMid",value:function(t){var e=(this.parsedStyle.points||{}).points;if(this.markerMidList.forEach(function(t){t.remove();}),this.markerMidList=[],t&&id(t)&&e)for(var n=1;n<(this.parsedStyle.isClosed?e.length:e.length-1);n++){var r=e[n][0],i=e[n][1],a=1===n?t:t.cloneNode(!0);this.markerMidList.push(a),this.appendChild(a),a.setLocalPosition(r,i);}}}]);}(im);iR.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(im.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isClosed","isBillboard","isSizeAttenuation"]));var iO=["style"],iL=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.style,r=(0,q.default)(t,iO);return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.POLYLINE,style:n,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},r)]);}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getTotalLength",value:function(){return 0===this.parsedStyle.points.totalLength&&(this.parsedStyle.points.totalLength=(0,z.polylineLength)(this.parsedStyle.points.points)),this.parsedStyle.points.totalLength;}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(t/this.getTotalLength(),e);}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle.points.points;if(0===this.parsedStyle.points.segments.length){var r,i,a=[],o=0,s=this.getTotalLength();n.forEach(function(t,e){n[e+1]&&((r=[0,0])[0]=o/s,i=(0,z.lineLength)(t[0],t[1],n[e+1][0],n[e+1][1]),o+=i,r[1]=o/s,a.push(r));}),this.parsedStyle.points.segments=a;}var l=0,u=0;this.parsedStyle.points.segments.forEach(function(e,n){t>=e[0]&&t<=e[1]&&(l=(t-e[0])/(e[1]-e[0]),u=n);});var c=(0,z.linePointAt)(n[u][0],n[u][1],n[u+1][0],n[u+1][1],l),h=c.x,d=c.y,f=G.vec3.transformMat4(G.vec3.create(),G.vec3.fromValues(h,d,0),e?this.getWorldTransform():this.getLocalTransform());return new ts(f[0],f[1]);}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.points.points,e=[];return e.push([t[1][0],t[1][1]]),e.push([t[0][0],t[0][1]]),e;}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.points.points,e=t.length-1,n=[];return n.push([t[e-1][0],t[e-1][1]]),n.push([t[e][0],t[e][1]]),n;}}]);}(iR);iL.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iR.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard"]));var iI=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.RECT},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(im);iI.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(im.PARSED_STYLE_LIST),["x","y","z","width","height","isBillboard","isSizeAttenuation","radius"]));var iD=["style"],i_=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.style,r=(0,q.default)(t,iD);return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.TEXT,style:(0,A.default)({fill:"black"},n)},r)]);}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getComputedTextLength",value:function(){var t;return this.getGeometryBounds(),(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.maxLineWidth)||0;}},{key:"getLineBoundingRects",value:function(){var t;return this.getGeometryBounds(),(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.lineMetrics)||[];}},{key:"isOverflowing",value:function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing;}}]);}(im);i_.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(im.PARSED_STYLE_LIST),["x","y","z","isBillboard","billboardRotation","isSizeAttenuation","text","textAlign","textBaseline","fontStyle","fontSize","fontFamily","fontWeight","fontVariant","lineHeight","letterSpacing","leading","wordWrap","wordWrapWidth","maxLines","textOverflow","isOverflowing","textPath","textDecorationLine","textDecorationColor","textDecorationStyle","textDecorationThickness","textPathSide","textPathStartOffset","metrics","dx","dy"])),(0,R.default)(function t(){(0,C.default)(this,t),this.registry={},this.define(j.CIRCLE,ik),this.define(j.ELLIPSE,ix),this.define(j.RECT,iI),this.define(j.IMAGE,iS),this.define(j.LINE,iP),this.define(j.GROUP,iT),this.define(j.PATH,iA),this.define(j.POLYGON,iR),this.define(j.POLYLINE,iL),this.define(j.TEXT,i_),this.define(j.HTML,ib);},[{key:"define",value:function(t,e){this.registry[t]=e;}},{key:"get",value:function(t){return this.registry[t];}}]),function(){function t(e){(0,C.default)(this,t),this.strategies=e;}return(0,R.default)(t,[{key:"apply",value:function(e){var n=e.config,r=e.camera,i=e.renderingService,a=e.renderingContext,o=this.strategies;i.hooks.cull.tap(t.tag,function(t){if(t){var e,i=t.cullable;if(0===o.length?i.visible=a.unculledEntities.indexOf(t.entity)>-1:i.visible=o.every(function(e){return e.isVisible(r,t);}),!t.isCulled()&&t.isVisible())return t;var s=(null===(e=n.future)||void 0===e?void 0:e.experimentalCancelEventPropagation)===!0;return t.dispatchEvent(new rI(rU.CULLED),s,s),null;}return t;}),i.hooks.afterRender.tap(t.tag,function(t){t.cullable.visibilityPlaneMask=-1;});}}]);}().tag="Culling",function(){function t(){var e=this;(0,C.default)(this,t),this.autoPreventDefault=!1,this.rootPointerEvent=new rO(null),this.rootWheelEvent=new rL(null),this.onPointerMove=function(t){var n=null===(r=e.context.renderingContext.root)||void 0===r||null===(r=r.ownerDocument)||void 0===r?void 0:r.defaultView;if(!n.supportsTouchEvents||"touch"!==t.pointerType){var r,i,a=e.normalizeToPointerEvent(t,n),o=(0,W.default)(a);try{for(o.s();!(i=o.n()).done;){var s=i.value,l=e.bootstrapEvent(e.rootPointerEvent,s,n,t);e.context.eventService.mapEvent(l);}}catch(t){o.e(t);}finally{o.f();}e.setCursor(e.context.eventService.cursor);}},this.onClick=function(t){var n,r,i=null===(n=e.context.renderingContext.root)||void 0===n||null===(n=n.ownerDocument)||void 0===n?void 0:n.defaultView,a=e.normalizeToPointerEvent(t,i),o=(0,W.default)(a);try{for(o.s();!(r=o.n()).done;){var s=r.value,l=e.bootstrapEvent(e.rootPointerEvent,s,i,t);e.context.eventService.mapEvent(l);}}catch(t){o.e(t);}finally{o.f();}e.setCursor(e.context.eventService.cursor);};}return(0,R.default)(t,[{key:"apply",value:function(e){var n=this;this.context=e;var r=e.renderingService,i=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler(function(t){return n.context.renderingService.hooks.pickSync.call({position:t,picked:[],topmost:!0}).picked[0]||null;}),r.hooks.pointerWheel.tap(t.tag,function(t){var e=n.normalizeWheelEvent(t);n.context.eventService.mapEvent(e);}),r.hooks.pointerDown.tap(t.tag,function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){var e=n.normalizeToPointerEvent(t,i);n.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();var r,a=(0,W.default)(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=n.bootstrapEvent(n.rootPointerEvent,o,i,t);n.context.eventService.mapEvent(s);}}catch(t){a.e(t);}finally{a.f();}n.setCursor(n.context.eventService.cursor);}}),r.hooks.pointerUp.tap(t.tag,function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){var e,r=n.context.contextService.getDomElement(),a=n.context.eventService.isNativeEventFromCanvas(r,t)?"":"outside",o=n.normalizeToPointerEvent(t,i),s=(0,W.default)(o);try{for(s.s();!(e=s.n()).done;){var l=e.value,u=n.bootstrapEvent(n.rootPointerEvent,l,i,t);u.type+=a,n.context.eventService.mapEvent(u);}}catch(t){s.e(t);}finally{s.f();}n.setCursor(n.context.eventService.cursor);}}),r.hooks.pointerMove.tap(t.tag,this.onPointerMove),r.hooks.pointerOver.tap(t.tag,this.onPointerMove),r.hooks.pointerOut.tap(t.tag,this.onPointerMove),r.hooks.click.tap(t.tag,this.onClick),r.hooks.pointerCancel.tap(t.tag,function(t){var e,r=n.normalizeToPointerEvent(t,i),a=(0,W.default)(r);try{for(a.s();!(e=a.n()).done;){var o=e.value,s=n.bootstrapEvent(n.rootPointerEvent,o,i,t);n.context.eventService.mapEvent(s);}}catch(t){a.e(t);}finally{a.f();}n.setCursor(n.context.eventService.cursor);});}},{key:"bootstrapEvent",value:function(t,e,n,r){t.view=n,t.originalEvent=null,t.nativeEvent=r,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);var i=this.context.eventService.client2Viewport({x:e.clientX,y:e.clientY}),a=i.x,o=i.y;t.viewport.x=a,t.viewport.y=o;var s=this.context.eventService.viewport2Canvas(t.viewport),l=s.x,u=s.y;return t.canvas.x=l,t.canvas.y=u,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=r.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=nJ[t.type]||t.type),t;}},{key:"normalizeWheelEvent",value:function(t){var e=this.rootWheelEvent;this.transferMouseData(e,t),e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;var n=this.context.eventService.client2Viewport({x:t.clientX,y:t.clientY}),r=n.x,i=n.y;e.viewport.x=r,e.viewport.y=i;var a=this.context.eventService.viewport2Canvas(e.viewport),o=a.x,s=a.y;return e.canvas.x=o,e.canvas.y=s,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.nativeEvent=t,e.type=t.type,e;}},{key:"transferMouseData",value:function(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=n0.now(),t.type=e.type,t.altKey=e.altKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.ctrlKey=e.ctrlKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.screen.x=e.screenX,t.screen.y=e.screenY,t.relatedTarget=null;}},{key:"setCursor",value:function(t){this.context.contextService.applyCursorStyle(t||this.context.config.cursor||"default");}},{key:"normalizeToPointerEvent",value:function(t,e){var n=[];if(e.isTouchEvent(t))for(var r=0;r<t.changedTouches.length;r++){var i=t.changedTouches[r];(0,F.isUndefined)(i.button)&&(i.button=0),(0,F.isUndefined)(i.buttons)&&(i.buttons=1),(0,F.isUndefined)(i.isPrimary)&&(i.isPrimary=1===t.touches.length&&"touchstart"===t.type),(0,F.isUndefined)(i.width)&&(i.width=i.radiusX||1),(0,F.isUndefined)(i.height)&&(i.height=i.radiusY||1),(0,F.isUndefined)(i.tiltX)&&(i.tiltX=0),(0,F.isUndefined)(i.tiltY)&&(i.tiltY=0),(0,F.isUndefined)(i.pointerType)&&(i.pointerType="touch"),(0,F.isUndefined)(i.pointerId)&&(i.pointerId=i.identifier||0),(0,F.isUndefined)(i.pressure)&&(i.pressure=i.force||.5),(0,F.isUndefined)(i.twist)&&(i.twist=0),(0,F.isUndefined)(i.tangentialPressure)&&(i.tangentialPressure=0),i.isNormalized=!0,i.type=t.type,n.push(i);}else e.isMouseEvent(t)&&((0,F.isUndefined)(t.isPrimary)&&(t.isPrimary=!0),(0,F.isUndefined)(t.width)&&(t.width=1),(0,F.isUndefined)(t.height)&&(t.height=1),(0,F.isUndefined)(t.tiltX)&&(t.tiltX=0),(0,F.isUndefined)(t.tiltY)&&(t.tiltY=0),(0,F.isUndefined)(t.pointerType)&&(t.pointerType="mouse"),(0,F.isUndefined)(t.pointerId)&&(t.pointerId=1),(0,F.isUndefined)(t.pressure)&&(t.pressure=.5),(0,F.isUndefined)(t.twist)&&(t.twist=0),(0,F.isUndefined)(t.tangentialPressure)&&(t.tangentialPressure=0),t.isNormalized=!0),n.push(t);return n;}}]);}().tag="Event";var iG=[j.CIRCLE,j.ELLIPSE,j.IMAGE,j.RECT,j.LINE,j.POLYLINE,j.POLYGON,j.TEXT,j.PATH,j.HTML];(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"isVisible",value:function(t,e){var n,r=e.cullable;if(!r.enable)return!0;var i=e.getRenderBounds();if(tr.isEmpty(i))return!1;var a=t.getFrustum(),o=null===(n=e.parentNode)||void 0===n||null===(n=n.cullable)||void 0===n?void 0:n.visibilityPlaneMask;return r.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(e,i,o||ta.INDETERMINATE,a.planes),r.visible=r.visibilityPlaneMask!==ta.OUTSIDE,r.visible;}},{key:"computeVisibilityWithPlaneMask",value:function(t,e,n,r){if(n===ta.OUTSIDE||n===ta.INSIDE)return n;for(var i=ta.INSIDE,a=iG.indexOf(t.nodeName)>-1,o=0,s=r.length;o<s;++o){var l=1<<o;if((n&l)!=0&&(!a||4!==o&&5!==o)){var u=r[o],c=u.normal,h=u.distance;if(G.vec3.dot(c,e.getPositiveFarPoint(r[o]))+h<0)return ta.OUTSIDE;G.vec3.dot(c,e.getNegativeFarPoint(r[o]))+h<0&&(i|=l);}}return i;}}]),function(){function t(){(0,C.default)(this,t),this.mutationRecords=[],this.isFirstTimeRendering=!0,this.isFirstTimeRenderingFinished=!1;}return(0,R.default)(t,[{key:"apply",value:function(e){var n,r=this,i=e.renderingService,a=e.renderingContext.root.ownerDocument.defaultView,o=function(t){i.dirty();},s=function(t){var e,n=t.detail;(e=r.mutationRecords).push.apply(e,(0,O.default)(n)),i.dirty();},l=function(t){var e=t.target;ii.enableSizeAttenuation&&ii.styleValueRegistry.updateSizeAttenuation(e,a.getCamera().getZoom());},u=function(t){var e=t.target;ii.sceneGraphService.dirtyToRoot(e),i.dirty();};i.hooks.init.tap(t.tag,function(){a.addEventListener(rU.MOUNTED,l),a.addEventListener(rU.UNMOUNTED,u),a.addEventListener(rU.ATTR_MODIFIED,o),a.addEventListener(rU.BOUNDS_CHANGED,s);}),i.hooks.destroy.tap(t.tag,function(){a.removeEventListener(rU.MOUNTED,l),a.removeEventListener(rU.UNMOUNTED,u),a.removeEventListener(rU.ATTR_MODIFIED,o),a.removeEventListener(rU.BOUNDS_CHANGED,s),r.mutationRecords=[];});var c=null!==(n=ii.globalThis.requestIdleCallback)&&void 0!==n?n:rt.bind(ii.globalThis);i.hooks.endFrame.tap(t.tag,function(){r.isFirstTimeRendering&&(r.isFirstTimeRendering=!1,c(function(){r.isFirstTimeRenderingFinished=!0;})),r.mutationRecords=[];});}}]);}().tag="Prepare";var iF=((P={}).READY="ready",P.BEFORE_RENDER="beforerender",P.RERENDER="rerender",P.AFTER_RENDER="afterrender",P.BEFORE_DESTROY="beforedestroy",P.AFTER_DESTROY="afterdestroy",P.RESIZE="resize",P.DIRTY_RECTANGLE="dirtyrectangle",P.RENDERER_CHANGED="rendererchanged",P);new rI(rU.MOUNTED),new rI(rU.UNMOUNTED),new rI(iF.BEFORE_RENDER),new rI(iF.RERENDER),new rI(iF.AFTER_RENDER);},"276fa9d1":function(t,e,n){"use strict";n.d(e,"__esModule",{value:!0}),n.e(e,{AABB:function(){return ti;},CSS:function(){return iq;},Camera:function(){return tR;},CameraType:function(){return tP;},Canvas:function(){return i5;},Circle:function(){return iw;},CustomElement:function(){return iM;},CustomEvent:function(){return rF;},DisplayObject:function(){return iS;},ERROR_MSG_METHOD_NOT_IMPLEMENTED:function(){return tc;},ElementEvent:function(){return rX;},Ellipse:function(){return iA;},FederatedEvent:function(){return rI;},Group:function(){return iC;},HTML:function(){return iO;},Image:function(){return iL;},Line:function(){return iD;},MutationEvent:function(){return rj;},Path:function(){return iG;},Polygon:function(){return iB;},Polyline:function(){return iV;},PropertySyntax:function(){return tB;},Rect:function(){return iz;},Shape:function(){return K;},Text:function(){return iY;},convertToPath:function(){return nh;},createVec3:function(){return tv;},deg2rad:function(){return tg;},getAngle:function(){return td;},parseColor:function(){return eW;},propertyMetadataCache:function(){return n_;},runtime:function(){return ih;}});var r,i,a,o,s,l,u,c,h,d,f,v,p,g,y,m,k,E,x,T,N,b,S,w,P,M,A=n("777fffbe"),C=A._(n("ab297151")),R=A._(n("b1a4abb6")),O=A._(n("72ce8fb5")),L=A._(n("d60881d0")),I=A._(n("0b95a4d2")),D=A._(n("0afdccfb")),_=A._(n("7465ab36")),G=A._(n("32f41e1c")),F=n("597fa39f");n("f90e84e3");var B=n("abe9d8d6"),U=A._(n("3214ccb5")),V=A._(n("51ffafbb")),z=n("b1a96927"),H=A._(n("2fabd5d4")),Y=A._(n("cb203630")),W=A._(n("1982f763")),q=A._(n("01aac514"));let X=n("1714eebe");"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==X||"undefined"!=typeof self&&self;var j={exports:{}};r=function(){function t(t,e,n){var r=t[e];t[e]=t[n],t[n]=r;}function e(t,e){return t<e?-1:t>e?1:0;}var n=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear();};function r(t,e){i(t,0,t.children.length,e,t);}function i(t,e,n,r,i){i||(i=d(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o=e;o<n;o++){var s=t.children[o];a(i,t.leaf?r(s):s);}return i;}function a(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t;}function o(t,e){return t.minX-e.minX;}function s(t,e){return t.minY-e.minY;}function l(t){return(t.maxX-t.minX)*(t.maxY-t.minY);}function u(t){return t.maxX-t.minX+(t.maxY-t.minY);}function c(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY;}function h(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY;}function d(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};}function f(n,r,i,a,o){for(var s=[r,i];s.length;)if(!((i=s.pop())-(r=s.pop())<=a)){var l=r+Math.ceil((i-r)/a/2)*a;(function e(n,r,i,a,o){for(;a>i;){if(a-i>600){var s=a-i+1,l=r-i+1,u=Math.log(s),c=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*c*(s-c)/s)*(l-s/2<0?-1:1),d=Math.max(i,Math.floor(r-l*c/s+h)),f=Math.min(a,Math.floor(r+(s-l)*c/s+h));e(n,r,d,f,o);}var v=n[r],p=i,g=a;for(t(n,i,r),o(n[a],v)>0&&t(n,i,a);p<g;){for(t(n,p,g),p++,g--;0>o(n[p],v);)p++;for(;o(n[g],v)>0;)g--;}0===o(n[i],v)?t(n,i,g):t(n,++g,a),g<=r&&(i=g+1),r<=g&&(a=g-1);}})(n,l,r||0,i||n.length-1,o||e),s.push(r,l,l,i);}}return n.prototype.all=function(){return this._all(this.data,[]);},n.prototype.search=function(t){var e=this.data,n=[];if(!h(t,e))return n;for(var r=this.toBBox,i=[];e;){for(var a=0;a<e.children.length;a++){var o=e.children[a],s=e.leaf?r(o):o;h(t,s)&&(e.leaf?n.push(o):c(t,s)?this._all(o,n):i.push(o));}e=i.pop();}return n;},n.prototype.collides=function(t){var e=this.data;if(!h(t,e))return!1;for(var n=[];e;){for(var r=0;r<e.children.length;r++){var i=e.children[r],a=e.leaf?this.toBBox(i):i;if(h(t,a)){if(e.leaf||c(t,a))return!0;n.push(i);}}e=n.pop();}return!1;},n.prototype.load=function(t){if(!(t&&t.length))return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this;}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length){if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r;}this._insert(n,this.data.height-n.height-1,!0);}}else this.data=n;return this;},n.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this;},n.prototype.clear=function(){return this.data=d([]),this;},n.prototype.remove=function(t,e){if(!t)return this;for(var n,r,i,a=this.data,o=this.toBBox(t),s=[],l=[];a||s.length;){if(a||(a=s.pop(),r=s[s.length-1],n=l.pop(),i=!0),a.leaf){var u=function(t,e,n){if(!n)return e.indexOf(t);for(var r=0;r<e.length;r++)if(n(t,e[r]))return r;return -1;}(t,a.children,e);if(-1!==u){a.children.splice(u,1),s.push(a),this._condense(s);break;}}!i&&!a.leaf&&c(a,o)?(s.push(a),l.push(n),n=0,r=a,a=a.children[0]):r?(n++,a=r.children[n],i=!1):a=null;}return this;},n.prototype.toBBox=function(t){return t;},n.prototype.compareMinX=function(t,e){return t.minX-e.minX;},n.prototype.compareMinY=function(t,e){return t.minY-e.minY;},n.prototype.toJSON=function(){return this.data;},n.prototype.fromJSON=function(t){return this.data=t,this;},n.prototype._all=function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e;},n.prototype._build=function(t,e,n,i){var a,o=n-e+1,s=this._maxEntries;if(o<=s)return r(a=d(t.slice(e,n+1)),this.toBBox),a;i||(i=Math.ceil(Math.log(o)/Math.log(s)),s=Math.ceil(o/Math.pow(s,i-1))),(a=d([])).leaf=!1,a.height=i;var l=Math.ceil(o/s),u=l*Math.ceil(Math.sqrt(s));f(t,e,n,u,this.compareMinX);for(var c=e;c<=n;c+=u){var h=Math.min(c+u-1,n);f(t,c,h,l,this.compareMinY);for(var v=c;v<=h;v+=l){var p=Math.min(v+l-1,h);a.children.push(this._build(t,v,p,i-1));}}return r(a,this.toBBox),a;},n.prototype._chooseSubtree=function(t,e,n,r){for(;r.push(e),!e.leaf&&r.length-1!==n;){for(var i=1/0,a=1/0,o=void 0,s=0;s<e.children.length;s++){var u=e.children[s],c=l(u),h=(Math.max(u.maxX,t.maxX)-Math.min(u.minX,t.minX))*(Math.max(u.maxY,t.maxY)-Math.min(u.minY,t.minY))-c;h<a?(a=h,i=c<i?c:i,o=u):h===a&&c<i&&(i=c,o=u);}e=o||e.children[0];}return e;},n.prototype._insert=function(t,e,n){var r=n?t:this.toBBox(t),i=[],o=this._chooseSubtree(r,this.data,e,i);for(o.children.push(t),a(o,r);e>=0;)if(i[e].children.length>this._maxEntries)this._split(i,e),e--;else break;this._adjustParentBBoxes(r,i,e);},n.prototype._split=function(t,e){var n=t[e],i=n.children.length,a=this._minEntries;this._chooseSplitAxis(n,a,i);var o=this._chooseSplitIndex(n,a,i),s=d(n.children.splice(o,n.children.length-o));s.height=n.height,s.leaf=n.leaf,r(n,this.toBBox),r(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(n,s);},n.prototype._splitRoot=function(t,e){this.data=d([t,e]),this.data.height=t.height+1,this.data.leaf=!1,r(this.data,this.toBBox);},n.prototype._chooseSplitIndex=function(t,e,n){for(var r,a=1/0,o=1/0,s=e;s<=n-e;s++){var u=i(t,0,s,this.toBBox),c=i(t,s,n,this.toBBox),h=function(t,e){var n=Math.max(t.minX,e.minX),r=Math.max(t.minY,e.minY);return Math.max(0,Math.min(t.maxX,e.maxX)-n)*Math.max(0,Math.min(t.maxY,e.maxY)-r);}(u,c),d=l(u)+l(c);h<a?(a=h,r=s,o=d<o?d:o):h===a&&d<o&&(o=d,r=s);}return r||n-e;},n.prototype._chooseSplitAxis=function(t,e,n){var r=t.leaf?this.compareMinX:o,i=t.leaf?this.compareMinY:s;this._allDistMargin(t,e,n,r)<this._allDistMargin(t,e,n,i)&&t.children.sort(r);},n.prototype._allDistMargin=function(t,e,n,r){t.children.sort(r);for(var o=this.toBBox,s=i(t,0,e,o),l=i(t,n-e,n,o),c=u(s)+u(l),h=e;h<n-e;h++){var d=t.children[h];a(s,t.leaf?o(d):d),c+=u(s);}for(var f=n-e-1;f>=e;f--){var v=t.children[f];a(l,t.leaf?o(v):v),c+=u(l);}return c;},n.prototype._adjustParentBBoxes=function(t,e,n){for(var r=n;r>=0;r--)a(e[r],t);},n.prototype._condense=function(t){for(var e=t.length-1,n=void 0;e>=0;e--)0===t[e].children.length?e>0?(n=t[e-1].children).splice(n.indexOf(t[e]),1):this.clear():r(t[e],this.toBBox);},n;},j.exports=r();var $=j.exports,K=((i={}).GROUP="g",i.FRAGMENT="fragment",i.CIRCLE="circle",i.ELLIPSE="ellipse",i.IMAGE="image",i.RECT="rect",i.LINE="line",i.POLYLINE="polyline",i.POLYGON="polygon",i.TEXT="text",i.PATH="path",i.HTML="html",i.MESH="mesh",i),Z=((a={})[a.ZERO=0]="ZERO",a[a.NEGATIVE_ONE=1]="NEGATIVE_ONE",a),Q=F.vec3.add,J=F.vec3.copy,tt=F.vec3.max,te=F.vec3.min,tn=F.vec3.scale,tr=F.vec3.sub,ti=function(){function t(){(0,R.default)(this,t),this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0];}return(0,O.default)(t,[{key:"update",value:function(t,e){J(this.center,t),J(this.halfExtents,e),tr(this.min,this.center,this.halfExtents),Q(this.max,this.center,this.halfExtents);}},{key:"setMinMax",value:function(t,e){Q(this.center,e,t),tn(this.center,this.center,.5),tr(this.halfExtents,e,t),tn(this.halfExtents,this.halfExtents,.5),J(this.min,t),J(this.max,e);}},{key:"getMin",value:function(){return this.min;}},{key:"getMax",value:function(){return this.max;}},{key:"add",value:function(e){if(!t.isEmpty(e)){if(t.isEmpty(this)){this.setMinMax(e.getMin(),e.getMax());return;}var n=this.center,r=n[0],i=n[1],a=n[2],o=this.halfExtents,s=o[0],l=o[1],u=o[2],c=r-s,h=r+s,d=i-l,f=i+l,v=a-u,p=a+u,g=e.center,y=g[0],m=g[1],k=g[2],E=e.halfExtents,x=E[0],T=E[1],N=E[2],b=y-x,S=y+x,w=m-T,P=m+T,M=k-N,A=k+N;b<c&&(c=b),S>h&&(h=S),w<d&&(d=w),P>f&&(f=P),M<v&&(v=M),A>p&&(p=A),n[0]=(c+h)*.5,n[1]=(d+f)*.5,n[2]=(v+p)*.5,o[0]=(h-c)*.5,o[1]=(f-d)*.5,o[2]=(p-v)*.5,this.min[0]=c,this.min[1]=d,this.min[2]=v,this.max[0]=h,this.max[1]=f,this.max[2]=p;}}},{key:"setFromTransformedAABB",value:function(t,e){var n=this.center,r=this.halfExtents,i=t.center,a=t.halfExtents,o=e[0],s=e[4],l=e[8],u=e[1],c=e[5],h=e[9],d=e[2],f=e[6],v=e[10],p=Math.abs(o),g=Math.abs(s),y=Math.abs(l),m=Math.abs(u),k=Math.abs(c),E=Math.abs(h),x=Math.abs(d),T=Math.abs(f),N=Math.abs(v);n[0]=e[12]+o*i[0]+s*i[1]+l*i[2],n[1]=e[13]+u*i[0]+c*i[1]+h*i[2],n[2]=e[14]+d*i[0]+f*i[1]+v*i[2],r[0]=p*a[0]+g*a[1]+y*a[2],r[1]=m*a[0]+k*a[1]+E*a[2],r[2]=x*a[0]+T*a[1]+N*a[2],tr(this.min,n,r),Q(this.max,n,r);}},{key:"intersects",value:function(t){var e=this.getMax(),n=this.getMin(),r=t.getMax(),i=t.getMin();return n[0]<=r[0]&&e[0]>=i[0]&&n[1]<=r[1]&&e[1]>=i[1]&&n[2]<=r[2]&&e[2]>=i[2];}},{key:"intersection",value:function(e){if(!this.intersects(e))return null;var n=new t,r=tt([0,0,0],this.getMin(),e.getMin()),i=te([0,0,0],this.getMax(),e.getMax());return n.setMinMax(r,i),n;}},{key:"getNegativeFarPoint",value:function(t){return 273===t.pnVertexFlag?J([0,0,0],this.min):272===t.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:257===t.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:256===t.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:17===t.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:16===t.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:1===t.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]];}},{key:"getPositiveFarPoint",value:function(t){return 273===t.pnVertexFlag?J([0,0,0],this.max):272===t.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:257===t.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:256===t.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:17===t.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:16===t.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:1===t.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]];}}],[{key:"isEmpty",value:function(t){return!t||0===t.halfExtents[0]&&0===t.halfExtents[1]&&0===t.halfExtents[2];}}]);}(),ta=(0,O.default)(function t(e,n){(0,R.default)(this,t),this.distance=e||0,this.normal=n||F.vec3.fromValues(0,1,0),this.updatePNVertexFlag();},[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(Number(this.normal[0]>=0)<<8)+(Number(this.normal[1]>=0)<<4)+Number(this.normal[2]>=0);}},{key:"distanceToPoint",value:function(t){return F.vec3.dot(t,this.normal)-this.distance;}},{key:"normalize",value:function(){var t=1/F.vec3.len(this.normal);F.vec3.scale(this.normal,this.normal,t),this.distance*=t;}},{key:"intersectsLine",value:function(t,e,n){var r=this.distanceToPoint(t),i=r/(r-this.distanceToPoint(e)),a=i>=0&&i<=1;return a&&n&&F.vec3.lerp(n,t,e,i),a;}}]),to=((o={})[o.OUTSIDE=4294967295]="OUTSIDE",o[o.INSIDE=0]="INSIDE",o[o.INDETERMINATE=2147483647]="INDETERMINATE",o),ts=(0,O.default)(function t(e){if((0,R.default)(this,t),this.planes=[],e)this.planes=e;else for(var n=0;n<6;n++)this.planes.push(new ta);},[{key:"extractFromVPMatrix",value:function(t){var e=(0,_.default)(t,16),n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],v=e[12],p=e[13],g=e[14],y=e[15];F.vec3.set(this.planes[0].normal,a-n,u-o,f-c),this.planes[0].distance=y-v,F.vec3.set(this.planes[1].normal,a+n,u+o,f+c),this.planes[1].distance=y+v,F.vec3.set(this.planes[2].normal,a+r,u+s,f+h),this.planes[2].distance=y+p,F.vec3.set(this.planes[3].normal,a-r,u-s,f-h),this.planes[3].distance=y-p,F.vec3.set(this.planes[4].normal,a-i,u-l,f-d),this.planes[4].distance=y-g,F.vec3.set(this.planes[5].normal,a+i,u+l,f+d),this.planes[5].distance=y+g,this.planes.forEach(function(t){t.normalize(),t.updatePNVertexFlag();});}}]),tl=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,R.default)(this,t),this.x=0,this.y=0,this.x=e,this.y=n;}return(0,O.default)(t,[{key:"clone",value:function(){return new t(this.x,this.y);}},{key:"copyFrom",value:function(t){this.x=t.x,this.y=t.y;}}]);}(),tu=function(){function t(e,n,r,i){(0,R.default)(this,t),this.x=e,this.y=n,this.width=r,this.height=i,this.left=e,this.right=e+r,this.top=n,this.bottom=n+i;}return(0,O.default)(t,[{key:"toJSON",value:function(){}}],[{key:"fromRect",value:function(e){return new t(e.x,e.y,e.width,e.height);}},{key:"applyTransform",value:function(e,n){var r=F.vec4.fromValues(e.x,e.y,0,1),i=F.vec4.fromValues(e.x+e.width,e.y,0,1),a=F.vec4.fromValues(e.x,e.y+e.height,0,1),o=F.vec4.fromValues(e.x+e.width,e.y+e.height,0,1),s=F.vec4.create(),l=F.vec4.create(),u=F.vec4.create(),c=F.vec4.create();F.vec4.transformMat4(s,r,n),F.vec4.transformMat4(l,i,n),F.vec4.transformMat4(u,a,n),F.vec4.transformMat4(c,o,n);var h=Math.min(s[0],l[0],u[0],c[0]),d=Math.min(s[1],l[1],u[1],c[1]),f=Math.max(s[0],l[0],u[0],c[0]),v=Math.max(s[1],l[1],u[1],c[1]);return t.fromRect({x:h,y:d,width:f-h,height:v-d});}}]);}(),tc="Method not implemented.",th="Use document.documentElement instead.";function td(t){return void 0===t?0:t>360||t<-360?t%360:t;}var tf=F.vec3.create();function tv(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];return Array.isArray(t)&&3===t.length?r?F.vec3.clone(t):F.vec3.copy(tf,t):(0,B.isNumber)(t)?r?F.vec3.fromValues(t,e,n):F.vec3.set(tf,t,e,n):r?F.vec3.fromValues(t[0],t[1]||e,t[2]||n):F.vec3.set(tf,t[0],t[1]||e,t[2]||n);}var tp=Math.PI/180;function tg(t){return t*tp;}var ty=180/Math.PI,tm=Math.PI/2;function tk(t,e){var n,r,i,a,o,s,l,u,c,h,d,f,v,p,g,y,m;return 16===e.length?(i=F.mat4.getScaling(F.vec3.create(),e),o=(a=(0,_.default)(i,3))[0],s=a[1],l=a[2],(u=Math.asin(-e[2]/o))<tm?u>-tm?(n=Math.atan2(e[6]/s,e[10]/l),r=Math.atan2(e[1]/o,e[0]/o)):(r=0,n=-Math.atan2(e[4]/s,e[5]/s)):(r=0,n=Math.atan2(e[4]/s,e[5]/s)),t[0]=n,t[1]=u,t[2]=r):(c=e[0],h=e[1],d=e[2],f=e[3],y=c*c+(v=h*h)+(p=d*d)+(g=f*f),(m=c*f-h*d)>.499995*y?(t[0]=tm,t[1]=2*Math.atan2(h,c),t[2]=0):m<-.499995*y?(t[0]=-tm,t[1]=2*Math.atan2(h,c),t[2]=0):(t[0]=Math.asin(2*(c*d-f*h)),t[1]=Math.atan2(2*(c*f+h*d),1-2*(p+g)),t[2]=Math.atan2(2*(c*h+d*f),1-2*(v+p)))),t;}function tE(t){var e=t[0],n=t[1],r=t[3],i=t[4],a=Math.sqrt(e*e+n*n),o=Math.sqrt(r*r+i*i);if(e*i-n*r<0&&(e<i?a=-a:o=-o),a){var s=1/a;e*=s,n*=s;}if(o){var l=1/o;r*=l,i*=l;}var u=Math.atan2(n,e)*ty;return[t[6],t[7],a,o,u];}var tx=F.mat4.create(),tT=F.mat4.create(),tN=F.vec4.create(),tb=[F.vec3.create(),F.vec3.create(),F.vec3.create()],tS=F.vec3.create();function tw(t,e,n,r,i){t[0]=e[0]*r+n[0]*i,t[1]=e[1]*r+n[1]*i,t[2]=e[2]*r+n[2]*i;}var tP=((s={})[s.ORBITING=0]="ORBITING",s[s.EXPLORING=1]="EXPLORING",s[s.TRACKING=2]="TRACKING",s),tM=((l={})[l.DEFAULT=0]="DEFAULT",l[l.ROTATIONAL=1]="ROTATIONAL",l[l.TRANSLATIONAL=2]="TRANSLATIONAL",l[l.CINEMATIC=3]="CINEMATIC",l),tA=((u={})[u.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",u[u.PERSPECTIVE=1]="PERSPECTIVE",u),tC={UPDATED:"updated"},tR=(0,O.default)(function t(){(0,R.default)(this,t),this.clipSpaceNearZ=Z.NEGATIVE_ONE,this.eventEmitter=new G.default,this.matrix=F.mat4.create(),this.right=F.vec3.fromValues(1,0,0),this.up=F.vec3.fromValues(0,1,0),this.forward=F.vec3.fromValues(0,0,1),this.position=F.vec3.fromValues(0,0,1),this.focalPoint=F.vec3.fromValues(0,0,0),this.distanceVector=F.vec3.fromValues(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=F.mat4.create(),this.projectionMatrixInverse=F.mat4.create(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=tP.EXPLORING,this.trackingMode=tM.DEFAULT,this.projectionMode=tA.PERSPECTIVE,this.frustum=new ts,this.orthoMatrix=F.mat4.create();},[{key:"isOrtho",value:function(){return this.projectionMode===tA.ORTHOGRAPHIC;}},{key:"getProjectionMode",value:function(){return this.projectionMode;}},{key:"getPerspective",value:function(){return this.jitteredProjectionMatrix||this.projectionMatrix;}},{key:"getPerspectiveInverse",value:function(){return this.projectionMatrixInverse;}},{key:"getFrustum",value:function(){return this.frustum;}},{key:"getPosition",value:function(){return this.position;}},{key:"getFocalPoint",value:function(){return this.focalPoint;}},{key:"getDollyingStep",value:function(){return this.dollyingStep;}},{key:"getNear",value:function(){return this.near;}},{key:"getFar",value:function(){return this.far;}},{key:"getZoom",value:function(){return this.zoom;}},{key:"getOrthoMatrix",value:function(){return this.orthoMatrix;}},{key:"getView",value:function(){return this.view;}},{key:"setEnableUpdate",value:function(t){this.enableUpdate=t;}},{key:"setType",value:function(t,e){return this.type=t,this.type===tP.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===tP.TRACKING&&void 0!==e&&this.setTrackingMode(e),this;}},{key:"setProjectionMode",value:function(t){return this.projectionMode=t,this;}},{key:"setTrackingMode",value:function(t){if(this.type!==tP.TRACKING)throw Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=t,this;}},{key:"setWorldRotation",value:function(t){return this.rotateWorld=t,this._getAngles(),this;}},{key:"getViewTransform",value:function(){return F.mat4.invert(F.mat4.create(),this.matrix);}},{key:"getWorldTransform",value:function(){return this.matrix;}},{key:"jitterProjectionMatrix",value:function(t,e){var n=F.mat4.fromTranslation(F.mat4.create(),[t,e,0]);this.jitteredProjectionMatrix=F.mat4.multiply(F.mat4.create(),n,this.projectionMatrix);}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0;}},{key:"setMatrix",value:function(t){return this.matrix=t,this._update(),this;}},{key:"setProjectionMatrix",value:function(t){this.projectionMatrix=t;}},{key:"setFov",value:function(t){return this.setPerspective(this.near,this.far,t,this.aspect),this;}},{key:"setAspect",value:function(t){return this.setPerspective(this.near,this.far,this.fov,t),this;}},{key:"setNear",value:function(t){return this.projectionMode===tA.PERSPECTIVE?this.setPerspective(t,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,t,this.far),this;}},{key:"setFar",value:function(t){return this.projectionMode===tA.PERSPECTIVE?this.setPerspective(this.near,t,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,t),this;}},{key:"setViewOffset",value:function(t,e,n,r,i,a){return this.aspect=t/e,void 0===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.projectionMode===tA.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this;}},{key:"clearViewOffset",value:function(){return void 0!==this.view&&(this.view.enabled=!1),this.projectionMode===tA.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this;}},{key:"setZoom",value:function(t){return this.zoom=t,this.projectionMode===tA.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===tA.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this;}},{key:"setZoomByViewportPoint",value:function(t,e){var n=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),r=n.x,i=n.y,a=this.roll;this.rotate(0,0,-a),this.setPosition(r,i),this.setFocalPoint(r,i),this.setZoom(t),this.rotate(0,0,a);var o=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),s=o.x,l=o.y,u=F.vec3.fromValues(s-r,l-i,0),c=F.vec3.dot(u,this.right)/F.vec3.length(this.right),h=F.vec3.dot(u,this.up)/F.vec3.length(this.up),d=this.getPosition(),f=(0,_.default)(d,2),v=f[0],p=f[1],g=this.getFocalPoint(),y=(0,_.default)(g,2),m=y[0],k=y[1];return this.setPosition(v-c,p-h),this.setFocalPoint(m-c,k-h),this;}},{key:"setPerspective",value:function(t,e,n,r){this.projectionMode=tA.PERSPECTIVE,this.fov=n,this.near=t,this.far=e,this.aspect=r;var i,a=this.near*Math.tan(.5*this.fov*tp)/this.zoom,o=2*a,s=this.aspect*o,l=-.5*s;if(null!==(i=this.view)&&void 0!==i&&i.enabled){var u=this.view.fullWidth,c=this.view.fullHeight;l+=this.view.offsetX*s/u,a-=this.view.offsetY*o/c,s*=this.view.width/u,o*=this.view.height/c;}return!function(t,e,n,r,i,a,o){var s,l,u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=2*a,h=n-e,d=r-i,f=o-a,v=o*a;u?(s=-o/f,l=-v/f):(s=-(o+a)/f,l=-2*v/f),t[0]=c/h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c/d,t[6]=0,t[7]=0,t[8]=(n+e)/h,t[9]=(r+i)/d,t[10]=s,t[11]=-1,t[12]=0,t[13]=0,t[14]=l,t[15]=0;}(this.projectionMatrix,l,l+s,a-o,a,t,this.far,this.clipSpaceNearZ===Z.ZERO),F.mat4.invert(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this;}},{key:"setOrthographic",value:function(t,e,n,r,i,a){this.projectionMode=tA.ORTHOGRAPHIC,this.rright=e,this.left=t,this.top=n,this.bottom=r,this.near=i,this.far=a;var o,s=(this.rright-this.left)/(2*this.zoom),l=(this.top-this.bottom)/(2*this.zoom),u=(this.rright+this.left)/2,c=(this.top+this.bottom)/2,h=u-s,d=u+s,f=c+l,v=c-l;if(null!==(o=this.view)&&void 0!==o&&o.enabled){var p=(this.rright-this.left)/this.view.fullWidth/this.zoom,g=(this.top-this.bottom)/this.view.fullHeight/this.zoom;h+=p*this.view.offsetX,d=h+p*this.view.width,f-=g*this.view.offsetY,v=f-g*this.view.height;}return this.clipSpaceNearZ===Z.NEGATIVE_ONE?F.mat4.ortho(this.projectionMatrix,h,d,f,v,i,a):F.mat4.orthoZO(this.projectionMatrix,h,d,f,v,i,a),F.mat4.invert(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this;}},{key:"setPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.position[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.position[2],r=tv(t,e,n);return this._setPosition(r),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this;}},{key:"setFocalPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.focalPoint[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.focalPoint[2],r=F.vec3.fromValues(0,1,0);if(this.focalPoint=tv(t,e,n),this.trackingMode===tM.CINEMATIC){var i=F.vec3.subtract(F.vec3.create(),this.focalPoint,this.position);t=i[0],e=i[1],n=i[2];var a=Math.asin(e/F.vec3.length(i))*ty,o=90+Math.atan2(n,t)*ty,s=F.mat4.create();F.mat4.rotateY(s,s,o*tp),F.mat4.rotateX(s,s,a*tp),r=F.vec3.transformMat4(F.vec3.create(),[0,1,0],s);}return F.mat4.invert(this.matrix,F.mat4.lookAt(F.mat4.create(),this.position,this.focalPoint,r)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this;}},{key:"getDistance",value:function(){return this.distance;}},{key:"getDistanceVector",value:function(){return this.distanceVector;}},{key:"setDistance",value:function(t){if(this.distance===t||t<0)return this;this.distance=t,this.distance<2e-4&&(this.distance=2e-4),this.dollyingStep=this.distance/100;var e=F.vec3.create();t=this.distance;var n=this.forward,r=this.focalPoint;return e[0]=t*n[0]+r[0],e[1]=t*n[1]+r[1],e[2]=t*n[2]+r[2],this._setPosition(e),this.triggerUpdate(),this;}},{key:"setMaxDistance",value:function(t){return this.maxDistance=t,this;}},{key:"setMinDistance",value:function(t){return this.minDistance=t,this;}},{key:"setAzimuth",value:function(t){return this.azimuth=td(t),this.computeMatrix(),this._getAxes(),this.type===tP.ORBITING||this.type===tP.EXPLORING?this._getPosition():this.type===tP.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getAzimuth",value:function(){return this.azimuth;}},{key:"setElevation",value:function(t){return this.elevation=td(t),this.computeMatrix(),this._getAxes(),this.type===tP.ORBITING||this.type===tP.EXPLORING?this._getPosition():this.type===tP.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getElevation",value:function(){return this.elevation;}},{key:"setRoll",value:function(t){return this.roll=td(t),this.computeMatrix(),this._getAxes(),this.type===tP.ORBITING||this.type===tP.EXPLORING?this._getPosition():this.type===tP.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getRoll",value:function(){return this.roll;}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate();}},{key:"computeMatrix",value:function(){var t=F.quat.setAxisAngle(F.quat.create(),[0,0,1],this.roll*tp);F.mat4.identity(this.matrix);var e=F.quat.setAxisAngle(F.quat.create(),[1,0,0],(this.rotateWorld&&this.type!==tP.TRACKING||this.type===tP.TRACKING?1:-1)*this.elevation*tp),n=F.quat.setAxisAngle(F.quat.create(),[0,1,0],(this.rotateWorld&&this.type!==tP.TRACKING||this.type===tP.TRACKING?1:-1)*this.azimuth*tp),r=F.quat.multiply(F.quat.create(),n,e);r=F.quat.multiply(F.quat.create(),r,t);var i=F.mat4.fromQuat(F.mat4.create(),r);this.type===tP.ORBITING||this.type===tP.EXPLORING?(F.mat4.translate(this.matrix,this.matrix,this.focalPoint),F.mat4.multiply(this.matrix,this.matrix,i),F.mat4.translate(this.matrix,this.matrix,[0,0,this.distance])):this.type===tP.TRACKING&&(F.mat4.translate(this.matrix,this.matrix,this.position),F.mat4.multiply(this.matrix,this.matrix,i));}},{key:"_setPosition",value:function(t,e,n){this.position=tv(t,e,n);var r=this.matrix;r[12]=this.position[0],r[13]=this.position[1],r[14]=this.position[2],r[15]=1,this._getOrthoMatrix();}},{key:"_getAxes",value:function(){F.vec3.copy(this.right,tv(F.vec4.transformMat4(F.vec4.create(),[1,0,0,0],this.matrix))),F.vec3.copy(this.up,tv(F.vec4.transformMat4(F.vec4.create(),[0,1,0,0],this.matrix))),F.vec3.copy(this.forward,tv(F.vec4.transformMat4(F.vec4.create(),[0,0,1,0],this.matrix))),F.vec3.normalize(this.right,this.right),F.vec3.normalize(this.up,this.up),F.vec3.normalize(this.forward,this.forward);}},{key:"_getAngles",value:function(){var t=this.distanceVector[0],e=this.distanceVector[1],n=this.distanceVector[2],r=F.vec3.length(this.distanceVector);if(0===r){this.elevation=0,this.azimuth=0;return;}this.type===tP.TRACKING?(this.elevation=Math.asin(e/r)*ty,this.azimuth=Math.atan2(-t,-n)*ty):this.rotateWorld?(this.elevation=Math.asin(e/r)*ty,this.azimuth=Math.atan2(-t,-n)*ty):(this.elevation=-(Math.asin(e/r)*ty),this.azimuth=-(Math.atan2(-t,-n)*ty));}},{key:"_getPosition",value:function(){F.vec3.copy(this.position,tv(F.vec4.transformMat4(F.vec4.create(),[0,0,0,1],this.matrix))),this._getDistance();}},{key:"_getFocalPoint",value:function(){F.vec3.transformMat3(this.distanceVector,[0,0,-this.distance],F.mat3.fromMat4(F.mat3.create(),this.matrix)),F.vec3.add(this.focalPoint,this.position,this.distanceVector),this._getDistance();}},{key:"_getDistance",value:function(){this.distanceVector=F.vec3.subtract(F.vec3.create(),this.focalPoint,this.position),this.distance=F.vec3.length(this.distanceVector),this.dollyingStep=this.distance/100;}},{key:"_getOrthoMatrix",value:function(){if(this.projectionMode===tA.ORTHOGRAPHIC){var t=this.position,e=F.quat.setAxisAngle(F.quat.create(),[0,0,1],-this.roll*Math.PI/180);F.mat4.fromRotationTranslationScaleOrigin(this.orthoMatrix,e,F.vec3.fromValues((this.rright-this.left)/2-t[0],(this.top-this.bottom)/2-t[1],0),F.vec3.fromValues(this.zoom,this.zoom,1),t);}}},{key:"triggerUpdate",value:function(){if(this.enableUpdate){var t=this.getViewTransform(),e=F.mat4.multiply(F.mat4.create(),this.getPerspective(),t);this.getFrustum().extractFromVPMatrix(e),this.eventEmitter.emit(tC.UPDATED);}}},{key:"rotate",value:function(t,e,n){throw Error(tc);}},{key:"pan",value:function(t,e){throw Error(tc);}},{key:"dolly",value:function(t){throw Error(tc);}},{key:"createLandmark",value:function(t,e){throw Error(tc);}},{key:"gotoLandmark",value:function(t,e){throw Error(tc);}},{key:"cancelLandmarkAnimation",value:function(){throw Error(tc);}}]),tO=((c={})[c.Standard=0]="Standard",c),tL=((h={})[h.ADDED=0]="ADDED",h[h.REMOVED=1]="REMOVED",h[h.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED",h),tI=F.vec3.create(),tD=F.mat4.create(),t_=F.quat.create();function tG(t){if(t.localDirtyFlag){if(0!==t.localSkew[0]||0!==t.localSkew[1]){F.mat4.fromRotationTranslationScaleOrigin(t.localTransform,t.localRotation,t.localPosition,F.vec3.fromValues(1,1,1),t.origin),(0!==t.localSkew[0]||0!==t.localSkew[1])&&(F.mat4.identity(tD),tD[4]=Math.tan(t.localSkew[0]),tD[1]=Math.tan(t.localSkew[1]),F.mat4.multiply(t.localTransform,t.localTransform,tD));var e=F.mat4.fromRotationTranslationScaleOrigin(tD,F.quat.set(t_,0,0,0,1),F.vec3.set(tI,1,1,1),t.localScale,t.origin);F.mat4.multiply(t.localTransform,t.localTransform,e);}else{var n=t.localTransform,r=t.localPosition,i=t.localRotation,a=t.localScale,o=t.origin,s=0!==r[0]||0!==r[1]||0!==r[2],l=1!==i[3]||0!==i[0]||0!==i[1]||0!==i[2],u=1!==a[0]||1!==a[1]||1!==a[2],c=0!==o[0]||0!==o[1]||0!==o[2];l||u||c?F.mat4.fromRotationTranslationScaleOrigin(n,i,r,a,o):s?F.mat4.fromTranslation(n,r):F.mat4.identity(n);}t.localDirtyFlag=!1;}}var tF={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new tu(0,0,0,0)},tB=((d={}).COORDINATE="<coordinate>",d.COLOR="<color>",d.PAINT="<paint>",d.NUMBER="<number>",d.ANGLE="<angle>",d.OPACITY_VALUE="<opacity-value>",d.SHADOW_BLUR="<shadow-blur>",d.LENGTH="<length>",d.PERCENTAGE="<percentage>",d.LENGTH_PERCENTAGE="<length> | <percentage>",d.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",d.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",d.LIST_OF_POINTS="<list-of-points>",d.PATH="<path>",d.FILTER="<filter>",d.Z_INDEX="<z-index>",d.OFFSET_DISTANCE="<offset-distance>",d.DEFINED_PATH="<defined-path>",d.MARKER="<marker>",d.TRANSFORM="<transform>",d.TRANSFORM_ORIGIN="<transform-origin>",d.TEXT="<text>",d.TEXT_TRANSFORM="<text-transform>",d);function tU(t,e,n){t.prototype=e.prototype=n,n.constructor=t;}function tV(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n;}function tz(){}var tH="\\s*([+-]?\\d+)\\s*",tY="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",tW="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",tq=/^#([0-9a-f]{3,8})$/,tX=RegExp(`^rgb\\(${tH},${tH},${tH}\\)$`),tj=RegExp(`^rgb\\(${tW},${tW},${tW}\\)$`),t$=RegExp(`^rgba\\(${tH},${tH},${tH},${tY}\\)$`),tK=RegExp(`^rgba\\(${tW},${tW},${tW},${tY}\\)$`),tZ=RegExp(`^hsl\\(${tY},${tW},${tW}\\)$`),tQ=RegExp(`^hsla\\(${tY},${tW},${tW},${tY}\\)$`),tJ={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function t0(){return this.rgb().formatHex();}function t1(){return this.rgb().formatRgb();}function t2(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=tq.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?t3(e):3===n?new t5(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?t4(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?t4(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=tX.exec(t))?new t5(e[1],e[2],e[3],1):(e=tj.exec(t))?new t5(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=t$.exec(t))?t4(e[1],e[2],e[3],e[4]):(e=tK.exec(t))?t4(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=tZ.exec(t))?ee(e[1],e[2]/100,e[3]/100,1):(e=tQ.exec(t))?ee(e[1],e[2]/100,e[3]/100,e[4]):tJ.hasOwnProperty(t)?t3(tJ[t]):"transparent"===t?new t5(NaN,NaN,NaN,0):null;}function t3(t){return new t5(t>>16&255,t>>8&255,255&t,1);}function t4(t,e,n,r){return r<=0&&(t=e=n=NaN),new t5(t,e,n,r);}function t5(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r;}function t6(){return`#${et(this.r)}${et(this.g)}${et(this.b)}`;}function t7(){let t=t9(this.opacity);return`${1===t?"rgb(":"rgba("}${t8(this.r)}, ${t8(this.g)}, ${t8(this.b)}${1===t?")":`, ${t})`}`;}function t9(t){return isNaN(t)?1:Math.max(0,Math.min(1,t));}function t8(t){return Math.max(0,Math.min(255,Math.round(t)||0));}function et(t){return((t=t8(t))<16?"0":"")+t.toString(16);}function ee(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new er(t,e,n,r);}function en(t){if(t instanceof er)return new er(t.h,t.s,t.l,t.opacity);if(t instanceof tz||(t=t2(t)),!t)return new er;if(t instanceof er)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,l=(a+i)/2;return s?(o=e===a?(n-r)/s+(n<r)*6:n===a?(r-e)/s+2:(e-n)/s+4,s/=l<.5?a+i:2-a-i,o*=60):s=l>0&&l<1?0:o,new er(o,s,l,t.opacity);}function er(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r;}function ei(t){return(t=(t||0)%360)<0?t+360:t;}function ea(t){return Math.max(0,Math.min(1,t||0));}function eo(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255;}function es(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw TypeError("Expected a function");var n=function(){for(var r=arguments.length,i=Array(r),a=0;a<r;a++)i[a]=arguments[a];var o=e?e.apply(this,i):i[0],s=n.cache;if(s.has(o))return s.get(o);var l=t.apply(this,i);return n.cache=s.set(o,l)||s,l;};return n.cache=new(es.Cache||Map),es.cacheList.push(n.cache),n;}tU(tz,t2,{copy(t){return Object.assign(new this.constructor,this,t);},displayable(){return this.rgb().displayable();},hex:t0,formatHex:t0,formatHex8:function(){return this.rgb().formatHex8();},formatHsl:function(){return en(this).formatHsl();},formatRgb:t1,toString:t1}),tU(t5,function(t,e,n,r){var i;return 1==arguments.length?((i=t)instanceof tz||(i=t2(i)),i)?new t5((i=i.rgb()).r,i.g,i.b,i.opacity):new t5:new t5(t,e,n,null==r?1:r);},tV(tz,{brighter(t){return t=null==t?1.4285714285714286:Math.pow(1.4285714285714286,t),new t5(this.r*t,this.g*t,this.b*t,this.opacity);},darker(t){return t=null==t?.7:Math.pow(.7,t),new t5(this.r*t,this.g*t,this.b*t,this.opacity);},rgb(){return this;},clamp(){return new t5(t8(this.r),t8(this.g),t8(this.b),t9(this.opacity));},displayable(){return -.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1;},hex:t6,formatHex:t6,formatHex8:function(){return`#${et(this.r)}${et(this.g)}${et(this.b)}${et((isNaN(this.opacity)?1:this.opacity)*255)}`;},formatRgb:t7,toString:t7})),tU(er,function(t,e,n,r){return 1==arguments.length?en(t):new er(t,e,n,null==r?1:r);},tV(tz,{brighter(t){return t=null==t?1.4285714285714286:Math.pow(1.4285714285714286,t),new er(this.h,this.s,this.l*t,this.opacity);},darker(t){return t=null==t?.7:Math.pow(.7,t),new er(this.h,this.s,this.l*t,this.opacity);},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new t5(eo(t>=240?t-240:t+120,i,r),eo(t,i,r),eo(t<120?t+240:t-120,i,r),this.opacity);},clamp(){return new er(ei(this.h),ea(this.s),ea(this.l),t9(this.opacity));},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1;},formatHsl(){let t=t9(this.opacity);return`${1===t?"hsl(":"hsla("}${ei(this.h)}, ${100*ea(this.s)}%, ${100*ea(this.l)}%${1===t?")":`, ${t})`}`;}})),es.Cache=Map,es.cacheList=[],es.clearCache=function(){es.cacheList.forEach(function(t){return t.clear();});};var el=((f={})[f.kUnknown=0]="kUnknown",f[f.kNumber=1]="kNumber",f[f.kPercentage=2]="kPercentage",f[f.kEms=3]="kEms",f[f.kPixels=4]="kPixels",f[f.kRems=5]="kRems",f[f.kDegrees=6]="kDegrees",f[f.kRadians=7]="kRadians",f[f.kGradians=8]="kGradians",f[f.kTurns=9]="kTurns",f[f.kMilliseconds=10]="kMilliseconds",f[f.kSeconds=11]="kSeconds",f[f.kInteger=12]="kInteger",f),eu=((v={})[v.kUNumber=0]="kUNumber",v[v.kUPercent=1]="kUPercent",v[v.kULength=2]="kULength",v[v.kUAngle=3]="kUAngle",v[v.kUTime=4]="kUTime",v[v.kUOther=5]="kUOther",v),ec=((p={})[p.kYes=0]="kYes",p[p.kNo=1]="kNo",p),eh=((g={})[g.kYes=0]="kYes",g[g.kNo=1]="kNo",g),ed=[{name:"em",unit_type:el.kEms},{name:"px",unit_type:el.kPixels},{name:"deg",unit_type:el.kDegrees},{name:"rad",unit_type:el.kRadians},{name:"grad",unit_type:el.kGradians},{name:"ms",unit_type:el.kMilliseconds},{name:"s",unit_type:el.kSeconds},{name:"rem",unit_type:el.kRems},{name:"turn",unit_type:el.kTurns}],ef=((y={})[y.kUnknownType=0]="kUnknownType",y[y.kUnparsedType=1]="kUnparsedType",y[y.kKeywordType=2]="kKeywordType",y[y.kUnitType=3]="kUnitType",y[y.kSumType=4]="kSumType",y[y.kProductType=5]="kProductType",y[y.kNegateType=6]="kNegateType",y[y.kInvertType=7]="kInvertType",y[y.kMinType=8]="kMinType",y[y.kMaxType=9]="kMaxType",y[y.kClampType=10]="kClampType",y[y.kTransformType=11]="kTransformType",y[y.kPositionType=12]="kPositionType",y[y.kURLImageType=13]="kURLImageType",y[y.kColorType=14]="kColorType",y[y.kUnsupportedColorType=15]="kUnsupportedColorType",y),ev=function(t){switch(t){case el.kNumber:case el.kInteger:return eu.kUNumber;case el.kPercentage:return eu.kUPercent;case el.kPixels:return eu.kULength;case el.kMilliseconds:case el.kSeconds:return eu.kUTime;case el.kDegrees:case el.kRadians:case el.kGradians:case el.kTurns:return eu.kUAngle;default:return eu.kUOther;}},ep=function(t){switch(t){case eu.kUNumber:return el.kNumber;case eu.kULength:return el.kPixels;case eu.kUPercent:return el.kPercentage;case eu.kUTime:return el.kSeconds;case eu.kUAngle:return el.kDegrees;default:return el.kUnknown;}},eg=function(t){var e=1;switch(t){case el.kPixels:case el.kDegrees:case el.kSeconds:break;case el.kMilliseconds:e=.001;break;case el.kRadians:e=180/Math.PI;break;case el.kGradians:e=.9;break;case el.kTurns:e=360;}return e;},ey=function(t){switch(t){case el.kNumber:case el.kInteger:break;case el.kPercentage:return"%";case el.kEms:return"em";case el.kRems:return"rem";case el.kPixels:return"px";case el.kDegrees:return"deg";case el.kRadians:return"rad";case el.kGradians:return"grad";case el.kMilliseconds:return"ms";case el.kSeconds:return"s";case el.kTurns:return"turn";}return"";},em=(0,O.default)(function t(){(0,R.default)(this,t);},[{key:"toString",value:function(){return this.buildCSSText(ec.kNo,eh.kNo,"");}},{key:"isNumericValue",value:function(){return this.getType()>=ef.kUnitType&&this.getType()<=ef.kClampType;}}],[{key:"isAngle",value:function(t){return t===el.kDegrees||t===el.kRadians||t===el.kGradians||t===el.kTurns;}},{key:"isLength",value:function(t){return t>=el.kEms&&t<el.kDegrees;}},{key:"isRelativeUnit",value:function(t){return t===el.kPercentage||t===el.kEms||t===el.kRems;}},{key:"isTime",value:function(t){return t===el.kSeconds||t===el.kMilliseconds;}}]),ek=function(t){function e(t){var n;return(0,R.default)(this,e),(n=(0,I.default)(this,e)).colorSpace=t,n;}return(0,D.default)(e,t),(0,O.default)(e,[{key:"getType",value:function(){return ef.kColorType;}},{key:"to",value:function(t){return this;}}]);}(em),eE=((m={})[m.Constant=0]="Constant",m[m.LinearGradient=1]="LinearGradient",m[m.RadialGradient=2]="RadialGradient",m),ex=function(t){function e(t,n){var r;return(0,R.default)(this,e),(r=(0,I.default)(this,e)).type=t,r.value=n,r;}return(0,D.default)(e,t),(0,O.default)(e,[{key:"clone",value:function(){return new e(this.type,this.value);}},{key:"buildCSSText",value:function(t,e,n){return n;}},{key:"getType",value:function(){return ef.kColorType;}}]);}(em),eT=function(t){function e(t){var n;return(0,R.default)(this,e),(n=(0,I.default)(this,e)).value=t,n;}return(0,D.default)(e,t),(0,O.default)(e,[{key:"clone",value:function(){return new e(this.value);}},{key:"getType",value:function(){return ef.kKeywordType;}},{key:"buildCSSText",value:function(t,e,n){return n+this.value;}}]);}(em),eN=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(Number.isFinite(t)?"NaN":t>0?"infinity":"-infinity")+e;},eb=function(t){return ep(ev(t));},eS=function(t){function e(t){var n,r,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:el.kNumber;return(0,R.default)(this,e),r=(0,I.default)(this,e),i="string"==typeof a?(n=a)?"number"===n?el.kNumber:"percent"===n||"%"===n?el.kPercentage:ed.find(function(t){return t.name===n;}).unit_type:el.kUnknown:a,r.unit=i,r.value=t,r;}return(0,D.default)(e,t),(0,O.default)(e,[{key:"clone",value:function(){return new e(this.value,this.unit);}},{key:"equals",value:function(t){return this.value===t.value&&this.unit===t.unit;}},{key:"getType",value:function(){return ef.kUnitType;}},{key:"convertTo",value:function(t){if(this.unit===t)return new e(this.value,this.unit);var n=eb(this.unit);if(n!==eb(t)||n===el.kUnknown)return null;var r=eg(this.unit)/eg(t);return new e(this.value*r,t);}},{key:"buildCSSText",value:function(t,e,n){var r;switch(this.unit){case el.kUnknown:break;case el.kInteger:r=Number(this.value).toFixed(0);break;case el.kNumber:case el.kPercentage:case el.kEms:case el.kRems:case el.kPixels:case el.kDegrees:case el.kRadians:case el.kGradians:case el.kMilliseconds:case el.kSeconds:case el.kTurns:var i=this.value,a=ey(this.unit);if(i<-999999||i>999999){var o=ey(this.unit);r=!Number.isFinite(i)||Number.isNaN(i)?eN(i,o):i+(o||"");}else r="".concat(i).concat(a);}return n+r;}}]);}(em),ew=new eS(0,"px");new eS(1,"px");var eP=new eS(0,"deg"),eM=function(t){function e(t,n,r){var i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return(0,R.default)(this,e),(i=(0,I.default)(this,e,["rgb"])).r=t,i.g=n,i.b=r,i.alpha=a,i.isNone=o,i;}return(0,D.default)(e,t),(0,O.default)(e,[{key:"clone",value:function(){return new e(this.r,this.g,this.b,this.alpha);}},{key:"buildCSSText",value:function(t,e,n){return"".concat(n,"rgba(").concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")");}}]);}(ek),eA=new eT("unset"),eC={"":eA,unset:eA,initial:new eT("initial"),inherit:new eT("inherit")},eR=new eM(0,0,0,0,!0),eO=new eM(0,0,0,0),eL=es(function(t,e,n,r){return new eM(t,e,n,r);},function(t,e,n,r){return"rgba(".concat(t,",").concat(e,",").concat(n,",").concat(r,")");}),eI=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:el.kNumber;return new eS(t,e);};new eS(50,"%");var eD=function(){var t={linearGradient:/^(linear\-gradient)/i,repeatingLinearGradient:/^(repeating\-linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,repeatingRadialGradient:/^(repeating\-radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},e="";function n(t){throw Error("".concat(e,": ").concat(t));}function r(){return i("linear-gradient",t.linearGradient,o)||i("repeating-linear-gradient",t.repeatingLinearGradient,o)||i("radial-gradient",t.radialGradient,s)||i("repeating-radial-gradient",t.repeatingRadialGradient,s)||i("conic-gradient",t.conicGradient,s);}function i(e,r,i){return a(r,function(r){var a=i();return a&&!m(t.comma)&&n("Missing comma before color stops"),{type:e,orientation:a,colorStops:d(f)};});}function a(e,r){var i=m(e);if(i){m(t.startCall)||n("Missing (");var a=r(i);return m(t.endCall)||n("Missing )"),a;}}function o(){return y("directional",t.sideOrCorner,1)||y("angular",t.angleValue,1);}function s(){var n,r,i=l();return i&&((n=[]).push(i),r=e,m(t.comma)&&((i=l())?n.push(i):e=r)),n;}function l(){var t,e,n=((t=y("shape",/^(circle)/i,0))&&(t.style=g()||u()),t||((e=y("shape",/^(ellipse)/i,0))&&(e.style=p()||u()),e));if(n)n.at=c();else{var r=u();if(r){n=r;var i=c();i&&(n.at=i);}else{var a=h();a&&(n={type:"default-radial",at:a});}}return n;}function u(){return y("extent-keyword",t.extentKeywords,1);}function c(){if(y("position",/^at/,0)){var t=h();return t||n("Missing positioning value"),t;}}function h(){var t={x:p(),y:p()};if(t.x||t.y)return{type:"position",value:t};}function d(e){var r=e(),i=[];if(r)for(i.push(r);m(t.comma);)(r=e())?i.push(r):n("One extra comma");return i;}function f(){var e=y("hex",t.hexColor,1)||a(t.rgbaColor,function(){return{type:"rgba",value:d(v)};})||a(t.rgbColor,function(){return{type:"rgb",value:d(v)};})||y("literal",t.literalColor,0);return e||n("Expected color definition"),e.length=p(),e;}function v(){return m(t.number)[1];}function p(){return y("%",t.percentageValue,1)||y("position-keyword",t.positionKeywords,1)||g();}function g(){return y("px",t.pixelValue,1)||y("em",t.emValue,1);}function y(t,e,n){var r=m(e);if(r)return{type:t,value:r[n]};}function m(t){var n=/^[\n\r\t\s]+/.exec(e);n&&k(n[0].length);var r=t.exec(e);return r&&k(r[0].length),r;}function k(t){e=e.substring(t);}return function(t){var i;return e=t,i=d(r),e.length>0&&n("Invalid input not EOF"),i;};}(),e_=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,eG=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,eF=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,eB=/[\d.]+:(#[^\s]+|[^\)]+\))/gi,eU={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},eV=es(function(t){return eI("angular"===t.type?Number(t.value):eU[t.value]||0,"deg");}),ez=es(function(t){var e=50,n=50,r="%",i="%";if((null==t?void 0:t.type)==="position"){var a=t.value,o=a.x,s=a.y;(null==o?void 0:o.type)==="position-keyword"&&("left"===o.value?e=0:"center"===o.value?e=50:"right"===o.value?e=100:"top"===o.value?n=0:"bottom"===o.value&&(n=100)),(null==s?void 0:s.type)==="position-keyword"&&("left"===s.value?e=0:"center"===s.value?n=50:"right"===s.value?e=100:"top"===s.value?n=0:"bottom"===s.value&&(n=100)),((null==o?void 0:o.type)==="px"||(null==o?void 0:o.type)==="%"||(null==o?void 0:o.type)==="em")&&(r=null==o?void 0:o.type,e=Number(o.value)),((null==s?void 0:s.type)==="px"||(null==s?void 0:s.type)==="%"||(null==s?void 0:s.type)==="em")&&(i=null==s?void 0:s.type,n=Number(s.value));}return{cx:eI(e,r),cy:eI(n,i)};}),eH=es(function(t){if(t.indexOf("linear")>-1||t.indexOf("radial")>-1)return eD(t).map(function(t){var e=t.type,n=t.orientation,r=t.colorStops;!function(t){var e=t.length;t[e-1].length=null!==(a=t[e-1].length)&&void 0!==a?a:{type:"%",value:"100"},e>1&&(t[0].length=null!==(o=t[0].length)&&void 0!==o?o:{type:"%",value:"0"});for(var n=0,r=Number(t[0].length.value),i=1;i<e;i++){var a,o,s,l=null===(s=t[i].length)||void 0===s?void 0:s.value;if(!(0,B.isNil)(l)&&!(0,B.isNil)(r)){for(var u=1;u<i-n;u++)t[n+u].length={type:"%",value:"".concat(r+(Number(l)-r)*u/(i-n))};n=i,r=Number(l);}}}(r);var i=r.map(function(t){var e,n;return{offset:eI(Number(t.length.value),"%"),color:(e=t.type,n=t.value,"hex"===e?"#".concat(n):"literal"===e?n:"rgb"===e?"rgb(".concat(n.join(","),")"):"rgba(".concat(n.join(","),")"))};});if("linear-gradient"===e)return new ex(eE.LinearGradient,{angle:n?eV(n):eP,steps:i});if("radial-gradient"===e&&(n||(n=[{type:"shape",value:"circle"}]),"shape"===n[0].type&&"circle"===n[0].value)){var a,o=ez(n[0].at),s=o.cx,l=o.cy;if(n[0].style){var u=n[0].style,c=u.type,h=u.value;"extent-keyword"===c?(eC[h]||(eC[h]=new eT(h)),a=eC[h]):a=eI(h,c);}return new ex(eE.RadialGradient,{cx:s,cy:l,size:a,steps:i});}});var e=t[0];if("("===t[1]||"("===t[2]){if("l"===e){var n=e_.exec(t);if(n){var r,i=(null===(r=n[2].match(eB))||void 0===r?void 0:r.map(function(t){return t.split(":");}))||[];return[new ex(eE.LinearGradient,{angle:eI(parseFloat(n[1]),"deg"),steps:i.map(function(t){var e=(0,_.default)(t,2),n=e[0],r=e[1];return{offset:eI(100*Number(n),"%"),color:r};})})];}}else if("r"===e){var a=function(t){var e=eG.exec(t);if(e){var n,r=(null===(n=e[4].match(eB))||void 0===n?void 0:n.map(function(t){return t.split(":");}))||[];return{cx:eI(50,"%"),cy:eI(50,"%"),steps:r.map(function(t){var e=(0,_.default)(t,2),n=e[0],r=e[1];return{offset:eI(100*Number(n),"%"),color:r};})};}return null;}(t);if(a){if(!(0,B.isString)(a))return[new ex(eE.RadialGradient,a)];t=a;}}else if("p"===e)return function(t){var e=eF.exec(t);if(e){var n=e[1],r=e[2];switch(n){case"a":n="repeat";break;case"x":n="repeat-x";break;case"y":n="repeat-y";break;default:n="no-repeat";}return{image:r,repetition:n};}return null;}(t);}});function eY(t){return t&&!(0,B.isNil)(t.r)&&!(0,B.isNil)(t.g)&&!(0,B.isNil)(t.b);}var eW=es(function(t){if((e=t)&&e.image)return(0,C.default)({repetition:"repeat"},t);if((0,B.isNil)(t)&&(t=""),"transparent"===t)return eO;if("currentColor"===t)t="black";else if("none"===t)return eR;var e,n=eH(t);if(n)return n;var r=t2(t),i=[0,0,0,0];return null!==r&&(i[0]=r.r||0,i[1]=r.g||0,i[2]=r.b||0,i[3]=r.opacity),eL.apply(void 0,i);});function eq(t,e){if(eY(t)&&eY(e))return[[Number(t.r),Number(t.g),Number(t.b),Number(t.alpha)],[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],function(t){var e=t.slice();if(e[3])for(var n=0;n<3;n++)e[n]=Math.round((0,B.clamp)(e[n],0,255));return e[3]=(0,B.clamp)(e[3],0,1),"rgba(".concat(e.join(","),")");}];}function eX(t,e){if((0,B.isNil)(e))return eI(0,"px");if(isFinite(Number(e="".concat(e).trim().toLowerCase()))){if("px".search(t)>=0)return eI(Number(e),"px");if("deg".search(t)>=0)return eI(Number(e),"deg");}var n=[];e=e.replace(t,function(t){return n.push(t),"U".concat(t);});var r="U(".concat(t.source,")");return n.map(function(t){return eI(Number(e.replace(RegExp("U".concat(t),"g"),"").replace(RegExp(r,"g"),"*0")),t);})[0];}var ej=function(t){return eX(/px/g,t);},e$=es(ej);es(function(t){return eX(RegExp("%","g"),t);});var eK=function(t){return(0,B.isNumber)(t)||isFinite(Number(t))?eI(Number(t)||0,"px"):eX(RegExp("px|%|em|rem","g"),t);},eZ=es(eK),eQ=function(t){return eX(RegExp("deg|rad|grad|turn","g"),t);},eJ=es(eQ);function e0(t){var e=0;return t.unit===el.kDegrees?e=t.value:t.unit===el.kRadians?e=Number(t.value)*ty:t.unit===el.kTurns?e=360*Number(t.value):t.value&&(e=t.value),e;}function e1(t,e){var n;return(Array.isArray(t)?n=t.map(function(t){return Number(t);}):(0,B.isString)(t)?n=t.split(" ").map(function(t){return Number(t);}):(0,B.isNumber)(t)&&(n=[t]),2===e)?1===n.length?[n[0],n[0]]:[n[0],n[1]]:4===e?1===n.length?[n[0],n[0],n[0],n[0]]:2===n.length?[n[0],n[1],n[0],n[1]]:3===n.length?[n[0],n[1],n[2],n[1]]:[n[0],n[1],n[2],n[3]]:"even"===e&&n.length%2==1?[].concat((0,L.default)(n),(0,L.default)(n)):n;}function e2(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t.unit===el.kPixels)return Number(t.value);if(t.unit===el.kPercentage&&n){var i=n.nodeName===K.GROUP?n.getLocalBounds():n.getGeometryBounds();return(r?i.min[e]:0)+t.value/100*i.halfExtents[e]*2;}return 0;}var e3=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function e4(t){return t.toString();}var e5=function(t){return"number"==typeof t?eI(t):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(t)?eI(Number(t)):eI(0);},e6=es(e5);function e7(t,e){return[t,e,e4];}function e9(t,e){return function(n,r){return[n,r,function(n){return e4((0,B.clamp)(n,t,e));}];};}function e8(t,e){if(t.length===e.length)return[t,e,function(t){return t;}];}function nt(t){return 0===t.parsedStyle.d.totalLength&&(t.parsedStyle.d.totalLength=(0,B.getTotalLength)(t.parsedStyle.d.absolutePath)),t.parsedStyle.d.totalLength;}function ne(t,e){return t[0]===e[0]&&t[1]===e[1];}function nn(t,e){var n=t.prePoint,r=t.currentPoint,i=t.nextPoint,a=Math.pow(r[0]-n[0],2)+Math.pow(r[1]-n[1],2),o=Math.pow(r[0]-i[0],2)+Math.pow(r[1]-i[1],2),s=Math.acos((a+o-(Math.pow(n[0]-i[0],2)+Math.pow(n[1]-i[1],2)))/(2*Math.sqrt(a)*Math.sqrt(o)));if(!s||0===Math.sin(s)||(0,B.isNumberEqual)(s,0))return{xExtra:0,yExtra:0};var l=Math.abs(Math.atan2(i[1]-r[1],i[0]-r[0])),u=Math.abs(Math.atan2(i[0]-r[0],i[1]-r[1]));return{xExtra:e/2*(1/Math.sin(s/2))*Math.cos(s/2-(l=l>Math.PI/2?Math.PI-l:l))-e/2||0,yExtra:e/2*(1/Math.sin(s/2))*Math.cos((u=u>Math.PI/2?Math.PI-u:u)-s/2)-e/2||0};}function nr(t,e){return[e[0]+(e[0]-t[0]),e[1]+(e[1]-t[1])];}es(function(t){return(0,B.isString)(t)?t.split(" ").map(e6):t.map(e6);});var ni=function(t,e){var n=t.x*e.x+t.y*e.y,r=Math.sqrt((Math.pow(t.x,2)+Math.pow(t.y,2))*(Math.pow(e.x,2)+Math.pow(e.y,2)));return(t.x*e.y-t.y*e.x<0?-1:1)*Math.acos(n/r);},na=function(t,e,n,r,i,a,o,s){e=Math.abs(e),n=Math.abs(n);var l=(r=(0,B.mod)(r,360))*tp;if(t.x===o.x&&t.y===o.y)return{x:t.x,y:t.y,ellipticalArcAngle:0};if(0===e||0===n)return{x:0,y:0,ellipticalArcAngle:0};var u=(t.x-o.x)/2,c=(t.y-o.y)/2,h={x:Math.cos(l)*u+Math.sin(l)*c,y:-Math.sin(l)*u+Math.cos(l)*c},d=Math.pow(h.x,2)/Math.pow(e,2)+Math.pow(h.y,2)/Math.pow(n,2);d>1&&(e*=Math.sqrt(d),n*=Math.sqrt(d));var f=(Math.pow(e,2)*Math.pow(n,2)-Math.pow(e,2)*Math.pow(h.y,2)-Math.pow(n,2)*Math.pow(h.x,2))/(Math.pow(e,2)*Math.pow(h.y,2)+Math.pow(n,2)*Math.pow(h.x,2)),v=(i!==a?1:-1)*Math.sqrt(f=f<0?0:f),p={x:v*(e*h.y/n),y:v*(-(n*h.x)/e)},g={x:Math.cos(l)*p.x-Math.sin(l)*p.y+(t.x+o.x)/2,y:Math.sin(l)*p.x+Math.cos(l)*p.y+(t.y+o.y)/2},y={x:(h.x-p.x)/e,y:(h.y-p.y)/n},m=ni({x:1,y:0},y),k=ni(y,{x:(-h.x-p.x)/e,y:(-h.y-p.y)/n});!a&&k>0?k-=2*Math.PI:a&&k<0&&(k+=2*Math.PI);var E=m+(k%=2*Math.PI)*s,x=e*Math.cos(E),T=n*Math.sin(E);return{x:Math.cos(l)*x-Math.sin(l)*T+g.x,y:Math.sin(l)*x+Math.cos(l)*T+g.y,ellipticalArcStartAngle:m,ellipticalArcEndAngle:m+k,ellipticalArcAngle:E,ellipticalArcCenter:g,resultantRx:e,resultantRy:n};};function no(t,e){var n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=t.arcParams,i=r.rx,a=void 0===i?0:i,o=r.ry,s=void 0===o?0:o,l=r.xRotation,u=r.arcFlag,c=r.sweepFlag,h=na({x:t.prePoint[0],y:t.prePoint[1]},a,s,l,!!u,!!c,{x:t.currentPoint[0],y:t.currentPoint[1]},e),d=na({x:t.prePoint[0],y:t.prePoint[1]},a,s,l,!!u,!!c,{x:t.currentPoint[0],y:t.currentPoint[1]},n?e+.005:e-.005),f=d.x-h.x,v=d.y-h.y,p=Math.sqrt(f*f+v*v);return{x:-f/p,y:-v/p};}function ns(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1]);}function nl(t,e){return ns(t)*ns(e)?(t[0]*e[0]+t[1]*e[1])/(ns(t)*ns(e)):1;}function nu(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(nl(t,e));}function nc(t,e,n,r){var i=(-1+Math.sqrt(2))/3*4,a=t*i,o=e*i,s=n-t,l=n+t,u=r-e,c=r+e;return[["M",s,r],["C",s,r-o,n-a,u,n,u],["C",n+a,u,l,r-o,l,r],["C",l,r+o,n+a,c,n,c],["C",n-a,c,s,r+o,s,r],["Z"]];}function nh(t){var e,n,r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.getLocalTransform(),a=[];switch(t.nodeName){case K.LINE:var o=t.parsedStyle,s=o.x1,l=o.y1,u=o.x2,c=o.y2;a=[["M",void 0===s?0:s,void 0===l?0:l],["L",void 0===u?0:u,void 0===c?0:c]];break;case K.CIRCLE:var h=t.parsedStyle,d=h.r,f=void 0===d?0:d,v=h.cx,p=h.cy;a=nc(f,f,void 0===v?0:v,void 0===p?0:p);break;case K.ELLIPSE:var g=t.parsedStyle,y=g.rx,m=g.ry,k=g.cx,E=g.cy;a=nc(void 0===y?0:y,void 0===m?0:m,void 0===k?0:k,void 0===E?0:E);break;case K.POLYLINE:case K.POLYGON:e=t.parsedStyle.points.points,n=t.nodeName===K.POLYGON,r=e.map(function(t,e){return[0===e?"M":"L",t[0],t[1]];}),n&&r.push(["Z"]),a=r;break;case K.RECT:var x=t.parsedStyle,T=x.width,N=void 0===T?0:T,b=x.height,S=void 0===b?0:b,w=x.x,P=x.y,M=x.radius;a=function(t,e,n,r,i){if(i){var a=(0,_.default)(i,4),o=a[0],s=a[1],l=a[2],u=a[3],c=t>0?1:-1,h=e>0?1:-1,d=c+h!==0?1:0;return[["M",c*o+n,r],["L",t-c*s+n,r],s?["A",s,s,0,0,d,t+n,h*s+r]:null,["L",t+n,e-h*l+r],l?["A",l,l,0,0,d,t+n-c*l,e+r]:null,["L",n+c*u,e+r],u?["A",u,u,0,0,d,n,e+r-h*u]:null,["L",n,h*o+r],o?["A",o,o,0,0,d,c*o+n,r]:null,["Z"]].filter(function(t){return t;});}return[["M",n,r],["L",n+t,r],["L",n+t,r+e],["L",n,r+e],["Z"]];}(N,S,void 0===w?0:w,void 0===P?0:P,M&&M.some(function(t){return 0!==t;})&&M.map(function(t){return(0,B.clamp)(t,0,Math.min(Math.abs(N)/2,Math.abs(S)/2));}));break;case K.PATH:var A=t.parsedStyle.d.absolutePath;a=(0,L.default)(A);}if(a.length)return a.reduce(function(t,e){var n="";if("M"===e[0]||"L"===e[0]){var r=F.vec3.fromValues(e[1],e[2],0);i&&F.vec3.transformMat4(r,r,i),n="".concat(e[0]).concat(r[0],",").concat(r[1]);}else if("Z"===e[0])n=e[0];else if("C"===e[0]){var a=F.vec3.fromValues(e[1],e[2],0),o=F.vec3.fromValues(e[3],e[4],0),s=F.vec3.fromValues(e[5],e[6],0);i&&(F.vec3.transformMat4(a,a,i),F.vec3.transformMat4(o,o,i),F.vec3.transformMat4(s,s,i)),n="".concat(e[0]).concat(a[0],",").concat(a[1],",").concat(o[0],",").concat(o[1],",").concat(s[0],",").concat(s[1]);}else if("A"===e[0]){var l=F.vec3.fromValues(e[6],e[7],0);i&&F.vec3.transformMat4(l,l,i),n="".concat(e[0]).concat(e[1],",").concat(e[2],",").concat(e[3],",").concat(e[4],",").concat(e[5],",").concat(l[0],",").concat(l[1]);}else if("Q"===e[0]){var u=F.vec3.fromValues(e[1],e[2],0),c=F.vec3.fromValues(e[3],e[4],0);i&&(F.vec3.transformMat4(u,u,i),F.vec3.transformMat4(c,c,i)),n="".concat(e[0]).concat(e[1],",").concat(e[2],",").concat(e[3],",").concat(e[4],"}");}return t+n;},"");}var nd=function(t){if(""===t||Array.isArray(t)&&0===t.length)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};try{e=(0,B.normalizePath)(t);}catch(n){e=(0,B.normalizePath)(""),console.error("[g]: Invalid SVG Path definition: ".concat(t));}!function(t){for(var e=0;e<t.length;e++){var n=t[e-1],r=t[e];if("M"===r[0]&&n){var i=n[0],a=[r[1],r[2]],o=void 0;"L"===i||"M"===i?o=[n[1],n[2]]:("C"===i||"A"===i||"Q"===i)&&(o=[n[n.length-2],n[n.length-1]]),o&&ne(a,o)&&(t.splice(e,1),e--);}}}(e);var e,n=function(t){for(var e=!1,n=t.length,r=0;r<n;r++){var i=t[r][0];if("C"===i||"A"===i||"Q"===i){e=!0;break;}}return e;}(e),r=function(t){for(var e=[],n=[],r=[],i=0;i<t.length;i++){var a=t[i],o=a[0];"M"===o?(r.length&&(n.push(r),r=[]),r.push([a[1],a[2]])):"Z"===o?r.length&&(e.push(r),r=[]):r.push([a[1],a[2]]);}return r.length>0&&n.push(r),{polygons:e,polylines:n};}(e),i=r.polygons,a=r.polylines,o=function(t){for(var e=[],n=null,r=null,i=null,a=0,o=t.length,s=0;s<o;s++){var l=t[s];r=t[s+1];var u=l[0],c={command:u,prePoint:n,params:l,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(u){case"M":i=[l[1],l[2]],a=s;break;case"A":var h=function(t,e){var n=e[1],r=e[2],i=(0,B.mod)(e[3]*tp,2*Math.PI),a=e[4],o=e[5],s=t[0],l=t[1],u=e[6],c=e[7],h=Math.cos(i)*(s-u)/2+Math.sin(i)*(l-c)/2,d=-1*Math.sin(i)*(s-u)/2+Math.cos(i)*(l-c)/2,f=h*h/(n*n)+d*d/(r*r);f>1&&(n*=Math.sqrt(f),r*=Math.sqrt(f));var v=n*n*(d*d)+r*r*(h*h),p=v?Math.sqrt((n*n*(r*r)-v)/v):1;a===o&&(p*=-1),isNaN(p)&&(p=0);var g=r?p*n*d/r:0,y=n?-(p*r)*h/n:0,m=(s+u)/2+Math.cos(i)*g-Math.sin(i)*y,k=(l+c)/2+Math.sin(i)*g+Math.cos(i)*y,E=[(h-g)/n,(d-y)/r],x=[(-1*h-g)/n,(-1*d-y)/r],T=nu([1,0],E),N=nu(E,x);return -1>=nl(E,x)&&(N=Math.PI),nl(E,x)>=1&&(N=0),0===o&&N>0&&(N-=2*Math.PI),1===o&&N<0&&(N+=2*Math.PI),{cx:m,cy:k,rx:ne(t,[u,c])?0:n,ry:ne(t,[u,c])?0:r,startAngle:T,endAngle:T+N,xRotation:i,arcFlag:a,sweepFlag:o};}(n,l);c.arcParams=h;}if("Z"===u)n=i,r=t[a+1];else{var d=l.length;n=[l[d-2],l[d-1]];}r&&"Z"===r[0]&&(r=t[a],e[a]&&(e[a].prePoint=n)),c.currentPoint=n,e[a]&&ne(n,e[a].currentPoint)&&(e[a].prePoint=c.prePoint);var f=r?[r[r.length-2],r[r.length-1]]:null;c.nextPoint=f;var v=c.prePoint;if(["L","H","V"].includes(u))c.startTangent=[v[0]-n[0],v[1]-n[1]],c.endTangent=[n[0]-v[0],n[1]-v[1]];else if("Q"===u){var p=[l[1],l[2]];c.startTangent=[v[0]-p[0],v[1]-p[1]],c.endTangent=[n[0]-p[0],n[1]-p[1]];}else if("T"===u){var g=e[s-1],y=nr(g.currentPoint,v);"Q"===g.command?(c.command="Q",c.startTangent=[v[0]-y[0],v[1]-y[1]],c.endTangent=[n[0]-y[0],n[1]-y[1]]):(c.command="TL",c.startTangent=[v[0]-n[0],v[1]-n[1]],c.endTangent=[n[0]-v[0],n[1]-v[1]]);}else if("C"===u){var m=[l[1],l[2]],k=[l[3],l[4]];c.startTangent=[v[0]-m[0],v[1]-m[1]],c.endTangent=[n[0]-k[0],n[1]-k[1]],0===c.startTangent[0]&&0===c.startTangent[1]&&(c.startTangent=[m[0]-k[0],m[1]-k[1]]),0===c.endTangent[0]&&0===c.endTangent[1]&&(c.endTangent=[k[0]-m[0],k[1]-m[1]]);}else if("S"===u){var E=e[s-1],x=nr(E.currentPoint,v),T=[l[1],l[2]];"C"===E.command?(c.command="C",c.startTangent=[v[0]-x[0],v[1]-x[1]]):(c.command="SQ",c.startTangent=[v[0]-T[0],v[1]-T[1]]),c.endTangent=[n[0]-T[0],n[1]-T[1]];}else if("A"===u){var N=no(c,0),b=N.x,S=N.y,w=no(c,1,!1),P=w.x,M=w.y;c.startTangent=[b,S],c.endTangent=[P,M];}e.push(c);}return e;}(e),s=function(t,e){for(var n=[],r=[],i=[],a=0;a<t.length;a++){var o=t[a],s=o.currentPoint,l=o.params,u=o.prePoint,c=void 0;switch(o.command){case"Q":c=(0,z.quadBox)(u[0],u[1],l[1],l[2],l[3],l[4]);break;case"C":c=(0,z.cubicBox)(u[0],u[1],l[1],l[2],l[3],l[4],l[5],l[6]);break;case"A":var h=o.arcParams;c=(0,z.arcBox)(h.cx,h.cy,h.rx,h.ry,h.xRotation,h.startAngle,h.endAngle);break;default:n.push(s[0]),r.push(s[1]);}c&&(o.box=c,n.push(c.x,c.x+c.width),r.push(c.y,c.y+c.height));}n=n.filter(function(t){return!Number.isNaN(t)&&t!==1/0&&t!==-1/0;}),r=r.filter(function(t){return!Number.isNaN(t)&&t!==1/0&&t!==-1/0;});var d=(0,B.min)(n),f=(0,B.min)(r),v=(0,B.max)(n),p=(0,B.max)(r);if(0===i.length)return{x:d,y:f,width:v-d,height:p-f};for(var g=0;g<i.length;g++){var y=i[g],m=y.currentPoint;m[0]===d?d-=nn(y,0).xExtra:m[0]===v&&(v+=nn(y,0).xExtra),m[1]===f?f-=nn(y,e).yExtra:m[1]===p&&(p+=nn(y,e).yExtra);}return{x:d,y:f,width:v-d,height:p-f};}(o,0),l=s.x,u=s.y,c=s.width,h=s.height;return{absolutePath:e,hasArc:n,segments:o,polygons:i,polylines:a,totalLength:0,rect:{x:Number.isFinite(l)?l:0,y:Number.isFinite(u)?u:0,width:Number.isFinite(c)?c:0,height:Number.isFinite(h)?h:0}};},nf=es(nd);function nv(t){return(0,B.isString)(t)?nf(t):nd(t);}function np(t,e,n){var r=t.curve,i=e.curve;r&&0!==r.length||(r=(0,B.path2Curve)(t.absolutePath,!1),t.curve=r),i&&0!==i.length||(i=(0,B.path2Curve)(e.absolutePath,!1),e.curve=i);var a=[r,i];r.length!==i.length&&(a=(0,B.equalizeSegments)(r,i));var o=(0,B.getDrawDirection)(a[0])!==(0,B.getDrawDirection)(a[1])?(0,B.reverseCurve)(a[0]):(0,B.clonePath)(a[0]);return[o,(0,B.getRotatedCurve)(a[1],o),function(t){return t;}];}function ng(t,e){return[t.points,e.points,function(t){return t;}];}var ny=/\s*(\w+)\(([^)]*)\)/g;function nm(t){return function(e){var n=0;return t.map(function(t){return null===t?e[n++]:t;});};}function nk(t){return t;}var nE={matrix:["NNNNNN",[null,null,0,0,null,null,0,0,0,0,1,0,null,null,0,1],nk],matrix3d:["NNNNNNNNNNNNNNNN",nk],rotate:["A"],rotateX:["A"],rotateY:["A"],rotateZ:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",nm([null,null,new eS(1)]),nk],scaleX:["N",nm([null,new eS(1),new eS(1)]),nm([null,new eS(1)])],scaleY:["N",nm([new eS(1),null,new eS(1)]),nm([new eS(1),null])],scaleZ:["N",nm([new eS(1),new eS(1),null])],scale3d:["NNN",nk],skew:["Aa",null,nk],skewX:["A",null,nm([null,eP])],skewY:["A",null,nm([eP,null])],translate:["Tt",nm([null,null,ew]),nk],translateX:["T",nm([null,ew,ew]),nm([null,ew])],translateY:["T",nm([ew,null,ew]),nm([ew,null])],translateZ:["L",nm([ew,ew,null])],translate3d:["TTL",nk]};function nx(t){for(var e=[],n=t.length,r=0;r<n;r++){var i=t[r],a=i[0],o=i.slice(1);if("translate"===a||"skew"===a?1===o.length&&o.push(0):"scale"===a&&1===o.length&&o.push(o[0]),!nE[a])return[];var s=o.map(function(t){return eI(t);});e.push({t:a,d:s});}return e;}function nT(t){if(Array.isArray(t))return nx(t);if("none"===(t=(t||"none").trim()))return[];var e,n=[],r=0;for(ny.lastIndex=0;(e=ny.exec(t))&&e.index===r;){r=e.index+e[0].length;var i=e[1],a=nE[i];if(!a)break;var o=e[2].split(","),s=a[0];if(s.length<o.length)break;for(var l=[],u=0;u<s.length;u++){var c=o[u],h=s[u],d=void 0;if(void 0===(d=c?({A:function(t){return"0"===t.trim()?eP:eQ(t);},N:e5,T:eK,L:ej})[h.toUpperCase()](c):({a:eP,n:l[0],t:ew})[h]))return[];l.push(d);}if(n.push({t:i,d:l}),ny.lastIndex===t.length)return n;}return[];}function nN(t){switch(t.t){case"rotateX":return[1,0,0,0,0,Math.cos(i=e0(t.d[0])*tp),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1];case"rotateY":return[Math.cos(i=e0(t.d[0])*tp),0,-Math.sin(i),0,0,1,0,0,Math.sin(i),0,Math.cos(i),0,0,0,0,1];case"rotate":case"rotateZ":return[Math.cos(i=e0(t.d[0])*tp),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1,0,0,0,0,1];case"rotate3d":e=t.d[0].value,n=t.d[1].value,r=t.d[2].value,i=e0(t.d[3])*tp;var e,n,r,i,a=e*e+n*n+r*r;if(0===a)e=1,n=0,r=0;else if(1!==a){var o=Math.sqrt(a);e/=o,n/=o,r/=o;}var s=Math.sin(i/2),l=s*Math.cos(i/2),u=s*s;return[1-2*(n*n+r*r)*u,2*(e*n*u+r*l),2*(e*r*u-n*l),0,2*(e*n*u-r*l),1-2*(e*e+r*r)*u,2*(n*r*u+e*l),0,2*(e*r*u+n*l),2*(n*r*u-e*l),1-2*(e*e+n*n)*u,0,0,0,0,1];case"scale":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scaleX":return[t.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaleY":return[1,0,0,0,0,t.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scaleZ":return[1,0,0,0,0,1,0,0,0,0,t.d[0].value,0,0,0,0,1];case"scale3d":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,t.d[2].value,0,0,0,0,1];case"skew":var c=e0(t.d[0])*tp;return[1,Math.tan(e0(t.d[1])*tp),0,0,Math.tan(c),1,0,0,0,0,1,0,0,0,0,1];case"skewX":return[1,0,0,0,Math.tan(i=e0(t.d[0])*tp),1,0,0,0,0,1,0,0,0,0,1];case"skewY":return[1,Math.tan(i=e0(t.d[0])*tp),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return[1,0,0,0,0,1,0,0,0,0,1,0,e=e2(t.d[0],0,null)||0,n=e2(t.d[1],0,null)||0,0,1];case"translateX":return[1,0,0,0,0,1,0,0,0,0,1,0,e=e2(t.d[0],0,null)||0,0,0,1];case"translateY":return[1,0,0,0,0,1,0,0,0,0,1,0,0,n=e2(t.d[0],0,null)||0,0,1];case"translateZ":return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,r=e2(t.d[0],0,null)||0,1];case"translate3d":return[1,0,0,0,0,1,0,0,0,0,1,0,e=e2(t.d[0],0,null)||0,n=e2(t.d[1],0,null)||0,r=e2(t.d[2],0,null)||0,1];case"perspective":var h=e2(t.d[0],0,null)||0;return[1,0,0,0,0,1,0,0,0,0,1,h?-1/h:0,0,0,0,1];case"matrix":return[t.d[0].value,t.d[1].value,0,0,t.d[2].value,t.d[3].value,0,0,0,0,1,0,t.d[4].value,t.d[5].value,0,1];case"matrix3d":return t.d.map(function(t){return t.value;});}}function nb(t,e){return[t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12]*e[3],t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13]*e[3],t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]*e[3],t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15]*e[3],t[0]*e[4]+t[4]*e[5]+t[8]*e[6]+t[12]*e[7],t[1]*e[4]+t[5]*e[5]+t[9]*e[6]+t[13]*e[7],t[2]*e[4]+t[6]*e[5]+t[10]*e[6]+t[14]*e[7],t[3]*e[4]+t[7]*e[5]+t[11]*e[6]+t[15]*e[7],t[0]*e[8]+t[4]*e[9]+t[8]*e[10]+t[12]*e[11],t[1]*e[8]+t[5]*e[9]+t[9]*e[10]+t[13]*e[11],t[2]*e[8]+t[6]*e[9]+t[10]*e[10]+t[14]*e[11],t[3]*e[8]+t[7]*e[9]+t[11]*e[10]+t[15]*e[11],t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12]*e[15],t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13]*e[15],t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14]*e[15],t[3]*e[12]+t[7]*e[13]+t[11]*e[14]+t[15]*e[15]];}function nS(t){var e=[0,0,0],n=[1,1,1],r=[0,0,0],i=[0,0,0,1],a=[0,0,0,1];return!function(t,e,n,r,i,a){if(!(!function(t,e){var n=e[15];if(0===n)return!1;for(var r=1/n,i=0;i<16;i++)t[i]=e[i]*r;return!0;}(tx,t)||(F.mat4.copy(tT,tx),tT[3]=0,tT[7]=0,tT[11]=0,tT[15]=1,1e-8>Math.abs(F.mat4.determinant(tT))))){var o=tx[3],s=tx[7],l=tx[11],u=tx[12],c=tx[13],h=tx[14],d=tx[15];if(0!==o||0!==s||0!==l){if(tN[0]=o,tN[1]=s,tN[2]=l,tN[3]=d,!F.mat4.invert(tT,tT))return;F.mat4.transpose(tT,tT),F.vec4.transformMat4(i,tN,tT);}else i[0]=i[1]=i[2]=0,i[3]=1;if(e[0]=u,e[1]=c,e[2]=h,tb[0][0]=tx[0],tb[0][1]=tx[1],tb[0][2]=tx[2],tb[1][0]=tx[4],tb[1][1]=tx[5],tb[1][2]=tx[6],tb[2][0]=tx[8],tb[2][1]=tx[9],tb[2][2]=tx[10],n[0]=F.vec3.length(tb[0]),F.vec3.normalize(tb[0],tb[0]),r[0]=F.vec3.dot(tb[0],tb[1]),tw(tb[1],tb[1],tb[0],1,-r[0]),n[1]=F.vec3.length(tb[1]),F.vec3.normalize(tb[1],tb[1]),r[0]/=n[1],r[1]=F.vec3.dot(tb[0],tb[2]),tw(tb[2],tb[2],tb[0],1,-r[1]),r[2]=F.vec3.dot(tb[1],tb[2]),tw(tb[2],tb[2],tb[1],1,-r[2]),n[2]=F.vec3.length(tb[2]),F.vec3.normalize(tb[2],tb[2]),r[1]/=n[2],r[2]/=n[2],F.vec3.cross(tS,tb[1],tb[2]),0>F.vec3.dot(tb[0],tS))for(var f=0;f<3;f++)n[f]*=-1,tb[f][0]*=-1,tb[f][1]*=-1,tb[f][2]*=-1;a[0]=.5*Math.sqrt(Math.max(1+tb[0][0]-tb[1][1]-tb[2][2],0)),a[1]=.5*Math.sqrt(Math.max(1-tb[0][0]+tb[1][1]-tb[2][2],0)),a[2]=.5*Math.sqrt(Math.max(1-tb[0][0]-tb[1][1]+tb[2][2],0)),a[3]=.5*Math.sqrt(Math.max(1+tb[0][0]+tb[1][1]+tb[2][2],0)),tb[2][1]>tb[1][2]&&(a[0]=-a[0]),tb[0][2]>tb[2][0]&&(a[1]=-a[1]),tb[1][0]>tb[0][1]&&(a[2]=-a[2]);}}(0===t.length?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:t.map(nN).reduce(nb),e,n,r,i,a),[[e,n,r,a,i]];}var nw=function(){function t(t,e){for(var n=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],r=0;r<4;r++)for(var i=0;i<4;i++)for(var a=0;a<4;a++)n[r][i]+=e[r][a]*t[a][i];return n;}return function(e,n,r,i,a){for(var o,s=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],l=0;l<4;l++)s[l][3]=a[l];for(var u=0;u<3;u++)for(var c=0;c<3;c++)s[3][u]+=e[c]*s[c][u];var h=i[0],d=i[1],f=i[2],v=i[3],p=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];p[0][0]=1-2*(d*d+f*f),p[0][1]=2*(h*d-f*v),p[0][2]=2*(h*f+d*v),p[1][0]=2*(h*d+f*v),p[1][1]=1-2*(h*h+f*f),p[1][2]=2*(d*f-h*v),p[2][0]=2*(h*f-d*v),p[2][1]=2*(d*f+h*v),p[2][2]=1-2*(h*h+d*d),s=t(s,p);var g=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];r[2]&&(g[2][1]=r[2],s=t(s,g)),r[1]&&(g[2][1]=0,g[2][0]=r[0],s=t(s,g)),r[0]&&(g[2][0]=0,g[1][0]=r[0],s=t(s,g));for(var y=0;y<3;y++)for(var m=0;m<3;m++)s[y][m]*=n[y];return 0===(o=s)[0][2]&&0===o[0][3]&&0===o[1][2]&&0===o[1][3]&&0===o[2][0]&&0===o[2][1]&&1===o[2][2]&&0===o[2][3]&&0===o[3][2]&&1===o[3][3]?[s[0][0],s[0][1],s[1][0],s[1][1],s[3][0],s[3][1]]:s[0].concat(s[1],s[2],s[3]);};}();function nP(t){return t.toFixed(6).replace(".000000","");}function nM(t,e){var n,r;return(t.decompositionPair!==e&&(t.decompositionPair=e,n=nS(t)),e.decompositionPair!==t&&(e.decompositionPair=t,r=nS(e)),null===n[0]||null===r[0])?[[!1],[!0],function(n){return n?e[0].d:t[0].d;}]:(n[0].push(0),r[0].push(1),[n,r,function(t){var e=function(t,e,n){var r=function(t,e){for(var n=0,r=0;r<t.length;r++)n+=t[r]*e[r];return n;}(t,e);r=(0,B.clamp)(r,-1,1);var i=[];if(1===r)i=t;else for(var a=Math.acos(r),o=1*Math.sin(n*a)/Math.sqrt(1-r*r),s=0;s<4;s++)i.push(t[s]*(Math.cos(n*a)-r*o)+e[s]*o);return i;}(n[0][3],r[0][3],t[5]);return nw(t[0],t[1],t[2],e,t[4]).map(nP).join(",");}]);}function nA(t){return t.replace(/[XY]/,"");}function nC(t){return t.replace(/(X|Y|Z|3d)?$/,"3d");}function nR(t,e,n){var r=!1;if(!t.length||!e.length){t.length||(r=!0,t=e,e=[]);for(var i=0;i<t.length;i++)!function(){var n=t[i],r=n.t,a=n.d,o="scale"===r.substring(0,5)?1:0;e.push({t:r,d:a.map(function(t){return"number"==typeof t?eI(o):eI(o,t.unit);})});}();}var a=[],o=[],s=[];if(t.length!==e.length){var l=nM(t,e);a=[l[0]],o=[l[1]],s=[["matrix",[l[2]]]];}else for(var u=0;u<t.length;u++){var c=t[u].t,h=e[u].t,d=t[u].d,f=e[u].d,v=nE[c],p=nE[h],g=void 0;if("perspective"===c&&"perspective"===h||("matrix"===c||"matrix3d"===c)&&("matrix"===h||"matrix3d"===h)){var y=nM([t[u]],[e[u]]);a.push(y[0]),o.push(y[1]),s.push(["matrix",[y[2]]]);continue;}if(c===h)g=c;else if(v[2]&&p[2]&&nA(c)===nA(h))g=nA(c),d=v[2](d),f=p[2](f);else if(v[1]&&p[1]&&nC(c)===nC(h))g=nC(c),d=v[1](d),f=p[1](f);else{var m=nM(t,e);a=[m[0]],o=[m[1]],s=[["matrix",[m[2]]]];break;}for(var k=[],E=[],x=[],T=0;T<d.length;T++){var N=function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a="",o=t.value||0,s=e.value||0,l=eb(t.unit),u=t.convertTo(l),c=e.convertTo(l);return u&&c?(o=u.value,s=c.value,a=ey(t.unit)):(eS.isLength(t.unit)||eS.isLength(e.unit))&&(o=e2(t,i,n),s=e2(e,i,n),a="px"),[o,s,function(t){return r&&(t=Math.max(t,0)),t+a;}];}(d[T],f[T],n,!1,T);k[T]=N[0],E[T]=N[1],x.push(N[2]);}a.push(k),o.push(E),s.push([g,x]);}if(r){var b=a;a=o,o=b;}return[a,o,function(t){return t.map(function(t,e){var n=t.map(function(t,n){return s[e][1][n](t);}).join(",");return"matrix"===s[e][0]&&16===n.split(",").length&&(s[e][0]="matrix3d"),"matrix3d"===s[e][0]&&6===n.split(",").length&&(s[e][0]="matrix"),"".concat(s[e][0],"(").concat(n,")");}).join(" ");}];}var nO=es(function(t){if((0,B.isString)(t)){if("text-anchor"===t)return[eI(0,"px"),eI(0,"px")];var e=t.split(" ");return(1===e.length&&("top"===e[0]||"bottom"===e[0]?(e[1]=e[0],e[0]="center"):e[1]="center"),2!==e.length)?null:[eZ(nL(e[0])),eZ(nL(e[1]))];}return[eI(t[0]||0,"px"),eI(t[1]||0,"px")];});function nL(t){return"center"===t?"50%":"left"===t||"top"===t?"0%":"right"===t||"bottom"===t?"100%":t;}var nI=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:tB.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:tB.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:tB.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:tB.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:tB.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:tB.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:tB.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:tB.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:tB.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:tB.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:tB.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:tB.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:tB.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:tB.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:tB.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:tB.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:tB.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:tB.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:tB.FILTER},{n:"clipPath",syntax:tB.DEFINED_PATH},{n:"textPath",syntax:tB.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:tB.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:tB.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:tB.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:tB.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:tB.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:tB.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:tB.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:tB.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:tB.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:tB.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:tB.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:tB.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:tB.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:tB.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:tB.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:tB.COORDINATE},{n:"y1",int:!0,l:!0,syntax:tB.COORDINATE},{n:"z1",int:!0,l:!0,syntax:tB.COORDINATE},{n:"x2",int:!0,l:!0,syntax:tB.COORDINATE},{n:"y2",int:!0,l:!0,syntax:tB.COORDINATE},{n:"z2",int:!0,l:!0,syntax:tB.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:tB.PATH,p:50},{n:"points",int:!0,l:!0,syntax:tB.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:tB.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:tB.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:tB.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:tB.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:tB.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:tB.NUMBER,d:function(t){return t===K.PATH||t===K.POLYGON||t===K.POLYLINE?"4":"10";}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:tB.MARKER},{n:"markerEnd",syntax:tB.MARKER},{n:"markerMid",syntax:tB.MARKER},{n:"markerStartOffset",syntax:tB.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:tB.LENGTH,l:!0,int:!0,d:"0"}],nD=new Set(nI.filter(function(t){return!!t.l;}).map(function(t){return t.n;})),n_={},nG=(0,O.default)(function t(e){var n=this;(0,R.default)(this,t),this.runtime=e,nI.forEach(function(t){n.registerMetadata(t);});},[{key:"registerMetadata",value:function(t){[t.n].concat((0,L.default)(t.a||[])).forEach(function(e){n_[e]=t;});}},{key:"getPropertySyntax",value:function(t){return this.runtime.CSSPropertySyntaxFactory[t];}},{key:"processProperties",value:function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[],memoize:!0};Object.assign(t.attributes,e);var i=t.parsedStyle.clipPath,a=t.parsedStyle.offsetPath;!function(t,e){var n=nF(t);for(var r in e)n.has(r)&&(t.parsedStyle[r]=e[r]);}(t,e);var o=!!r.forceUpdateGeometry;if(!o){for(var s in e)if(nD.has(s)){o=!0;break;}}var l=nF(t);l.has("fill")&&e.fill&&(t.parsedStyle.fill=eW(e.fill)),l.has("stroke")&&e.stroke&&(t.parsedStyle.stroke=eW(e.stroke)),l.has("shadowColor")&&e.shadowColor&&(t.parsedStyle.shadowColor=eW(e.shadowColor)),l.has("filter")&&e.filter&&(t.parsedStyle.filter=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if("none"===(e=e.toLowerCase().trim()))return[];for(var n=/\s*([\w-]+)\(([^)]*)\)/g,r=[],i=0;(t=n.exec(e))&&t.index===i;)if(i=t.index+t[0].length,e3.indexOf(t[1])>-1&&r.push({name:t[1],params:t[2].split(" ").map(function(t){return eX(/deg|rad|grad|turn|px|%/g,t)||eW(t);})}),n.lastIndex===e.length)return r;return[];}(e.filter)),l.has("radius")&&!(0,B.isNil)(e.radius)&&(t.parsedStyle.radius=e1(e.radius,4)),l.has("lineDash")&&!(0,B.isNil)(e.lineDash)&&(t.parsedStyle.lineDash=e1(e.lineDash,"even")),l.has("points")&&e.points&&(t.parsedStyle.points=(n=e.points,{points:(0,B.isString)(n)?n.split(" ").map(function(t){var e=t.split(","),n=(0,_.default)(e,2),r=n[0],i=n[1];return[Number(r),Number(i)];}):n,totalLength:0,segments:[]})),l.has("d")&&""===e.d&&(t.parsedStyle.d=(0,C.default)({},tF)),l.has("d")&&e.d&&(t.parsedStyle.d=nv(e.d)),l.has("textTransform")&&e.textTransform&&this.runtime.CSSPropertySyntaxFactory[tB.TEXT_TRANSFORM].calculator(null,null,{value:e.textTransform},t,null),l.has("clipPath")&&!(0,B.isUndefined)(e.clipPath)&&this.runtime.CSSPropertySyntaxFactory[tB.DEFINED_PATH].calculator("clipPath",i,e.clipPath,t,this.runtime),l.has("offsetPath")&&e.offsetPath&&this.runtime.CSSPropertySyntaxFactory[tB.DEFINED_PATH].calculator("offsetPath",a,e.offsetPath,t,this.runtime),l.has("transform")&&e.transform&&(t.parsedStyle.transform=function(t){if(Array.isArray(t))return nx(t);if("none"===(t=(t||"none").trim()))return[];var e,n=[],r=0;for(ny.lastIndex=0;(e=ny.exec(t))&&e.index===r;){r=e.index+e[0].length;var i=e[1],a=nE[i];if(!a)break;var o=e[2].split(","),s=a[0];if(s.length<o.length)break;for(var l=[],u=0;u<s.length;u++){var c=o[u],h=s[u],d=void 0;if(void 0===(d=c?({A:function(t){return"0"===t.trim()?eP:eJ(t);},N:e6,T:eZ,L:e$})[h.toUpperCase()](c):({a:eP,n:l[0],t:ew})[h]))return[];l.push(d);}if(n.push({t:i,d:l}),ny.lastIndex===t.length)return n;}return[];}(e.transform)),l.has("transformOrigin")&&e.transformOrigin&&(t.parsedStyle.transformOrigin=nO(e.transformOrigin)),l.has("markerStart")&&e.markerStart&&(t.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory[tB.MARKER].calculator(null,e.markerStart,e.markerStart,null,null)),l.has("markerEnd")&&e.markerEnd&&(t.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory[tB.MARKER].calculator(null,e.markerEnd,e.markerEnd,null,null)),l.has("markerMid")&&e.markerMid&&(t.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory[tB.MARKER].calculator("",e.markerMid,e.markerMid,null,null)),l.has("zIndex")&&!(0,B.isNil)(e.zIndex)&&this.runtime.CSSPropertySyntaxFactory[tB.Z_INDEX].postProcessor(t),l.has("offsetDistance")&&!(0,B.isNil)(e.offsetDistance)&&this.runtime.CSSPropertySyntaxFactory[tB.OFFSET_DISTANCE].postProcessor(t),l.has("transform")&&e.transform&&this.runtime.CSSPropertySyntaxFactory[tB.TRANSFORM].postProcessor(t),l.has("transformOrigin")&&e.transformOrigin&&this.runtime.CSSPropertySyntaxFactory[tB.TRANSFORM_ORIGIN].postProcessor(t),o&&(t.geometry.dirty=!0,t.dirty(!0,!0),r.forceUpdateGeometry||this.runtime.sceneGraphService.dirtyToRoot(t));}},{key:"updateGeometry",value:function(t){var e=t.nodeName,n=this.runtime.geometryUpdaterFactory[e];if(n){var r=t.geometry;r.contentBounds||(r.contentBounds=new ti),r.renderBounds||(r.renderBounds=new ti);var i=t.parsedStyle,a=n.update(i,t),o=a.cx,s=a.cy,l=a.cz,u=a.hwidth,c=void 0===u?0:u,h=a.hheight,d=void 0===h?0:h,f=a.hdepth,v=[Math.abs(c),Math.abs(d),void 0===f?0:f],p=i.stroke,g=i.lineWidth,y=i.increasedLineWidthForHitTesting,m=i.shadowType,k=void 0===m?"outer":m,E=i.shadowColor,x=i.filter,T=i.transformOrigin,N=[void 0===o?0:o,void 0===s?0:s,void 0===l?0:l];r.contentBounds.update(N,v);var b=e===K.POLYLINE||e===K.POLYGON||e===K.PATH?Math.SQRT2:.5;if(p&&!p.isNone){var S=(((void 0===g?1:g)||0)+((void 0===y?0:y)||0))*b;v[0]+=S,v[1]+=S;}if(r.renderBounds.update(N,v),E&&k&&"inner"!==k){var w=r.renderBounds,P=w.min,M=w.max,A=i.shadowBlur,C=i.shadowOffsetX,R=i.shadowOffsetY,O=A||0,L=C||0,I=R||0,D=P[0]-O+L,_=M[0]+O+L,G=P[1]-O+I,B=M[1]+O+I;P[0]=Math.min(P[0],D),M[0]=Math.max(M[0],_),P[1]=Math.min(P[1],G),M[1]=Math.max(M[1],B),r.renderBounds.setMinMax(P,M);}(void 0===x?[]:x).forEach(function(t){var e=t.name,n=t.params;if("blur"===e){var i=n[0].value;r.renderBounds.update(r.renderBounds.center,F.vec3.add(r.renderBounds.halfExtents,r.renderBounds.halfExtents,[i,i,0]));}else if("drop-shadow"===e){var a=n[0].value,o=n[1].value,s=n[2].value,l=r.renderBounds,u=l.min,c=l.max,h=u[0]-s+a,d=c[0]+s+a,f=u[1]-s+o,v=c[1]+s+o;u[0]=Math.min(u[0],h),c[0]=Math.max(c[0],d),u[1]=Math.min(u[1],f),c[1]=Math.max(c[1],v),r.renderBounds.setMinMax(u,c);}}),t.geometry.dirty=!1;var U=d<0,V=(c<0?-1:1)*(T?e2(T[0],0,t,!0):0),z=(U?-1:1)*(T?e2(T[1],1,t,!0):0);(V||z)&&t.setOrigin(V,z);}}},{key:"updateSizeAttenuation",value:function(t,e){t.style.isSizeAttenuation?(t.style.rawLineWidth||(t.style.rawLineWidth=t.style.lineWidth),t.style.lineWidth=(t.style.rawLineWidth||1)/e,t.nodeName===K.CIRCLE&&(t.style.rawR||(t.style.rawR=t.style.r),t.style.r=(t.style.rawR||1)/e)):(t.style.rawLineWidth&&(t.style.lineWidth=t.style.rawLineWidth,delete t.style.rawLineWidth),t.nodeName===K.CIRCLE&&t.style.rawR&&(t.style.r=t.style.rawR,delete t.style.rawR));}}]);function nF(t){return t.constructor.PARSED_STYLE_LIST;}var nB=(0,O.default)(function t(){(0,R.default)(this,t),this.mixer=e7;},[{key:"calculator",value:function(t,e,n,r){return e0(n);}}]),nU=(0,O.default)(function t(){(0,R.default)(this,t);},[{key:"calculator",value:function(t,e,n,r,i){return n instanceof eT&&(n=null),i.sceneGraphService.updateDisplayObjectDependency(t,e,n,r),"clipPath"===t&&r.forEach(function(t){0===t.childNodes.length&&i.sceneGraphService.dirtyToRoot(t);}),n;}}]),nV=(0,O.default)(function t(){(0,R.default)(this,t),this.parser=eW,this.mixer=eq;},[{key:"calculator",value:function(t,e,n,r){return n instanceof eT?"none"===n.value?eR:eO:n;}}]),nz=(0,O.default)(function t(){(0,R.default)(this,t);},[{key:"calculator",value:function(t,e,n){return n instanceof eT?[]:n;}}]);function nH(t){var e=t.parsedStyle.fontSize;return(0,B.isNil)(e)?null:e;}var nY=(0,O.default)(function t(){(0,R.default)(this,t),this.mixer=e7;},[{key:"calculator",value:function(t,e,n,r,i){if((0,B.isNumber)(n))return n;if(!eS.isRelativeUnit(n.unit))return n.value;if(n.unit===el.kPercentage)return 0;if(n.unit===el.kEms){if(r.parentNode){var a,o=nH(r.parentNode);if(o)return o*n.value;}return 0;}if(n.unit===el.kRems){if(null!=r&&null!==(a=r.ownerDocument)&&void 0!==a&&a.documentElement){var s=nH(r.ownerDocument.documentElement);if(s)return s*n.value;}return 0;}}}]),nW=(0,O.default)(function t(){(0,R.default)(this,t),this.mixer=e8;},[{key:"calculator",value:function(t,e,n){return n.map(function(t){return t.value;});}}]),nq=(0,O.default)(function t(){(0,R.default)(this,t),this.mixer=e8;},[{key:"calculator",value:function(t,e,n){return n.map(function(t){return t.value;});}}]),nX=(0,O.default)(function t(){(0,R.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){n instanceof eT&&(n=null);var i,a=null===(i=n)||void 0===i?void 0:i.cloneNode(!0);return a&&(a.style.isMarker=!0),a;}}]),nj=(0,O.default)(function t(){(0,R.default)(this,t),this.mixer=e7;},[{key:"calculator",value:function(t,e,n){return n.value;}}]),n$=(0,O.default)(function t(){(0,R.default)(this,t),this.mixer=e9(0,1);},[{key:"calculator",value:function(t,e,n){return n.value;}},{key:"postProcessor",value:function(t){var e=t.parsedStyle,n=e.offsetPath,r=e.offsetDistance;if(n){var i=n.nodeName;if(i===K.LINE||i===K.PATH||i===K.POLYLINE){var a=n.getPoint(r);a&&t.setLocalPosition(a.x,a.y);}}}}]),nK=(0,O.default)(function t(){(0,R.default)(this,t),this.mixer=e9(0,1);},[{key:"calculator",value:function(t,e,n){return n.value;}}]),nZ=(0,O.default)(function t(){(0,R.default)(this,t),this.parser=nv,this.mixer=np;},[{key:"calculator",value:function(t,e,n){return n instanceof eT&&"unset"===n.value?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new tu(0,0,0,0)}:n;}}]),nQ=(0,O.default)(function t(){(0,R.default)(this,t),this.mixer=ng;}),nJ=function(t){function e(){var t;(0,R.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,I.default)(this,e,[].concat(r))).mixer=e9(0,1/0),t;}return(0,D.default)(e,t),(0,O.default)(e);}(nY),n0=(0,O.default)(function t(){(0,R.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){return n instanceof eT?"unset"===n.value?"":n.value:"".concat(n);}},{key:"postProcessor",value:function(t){t.nodeValue="".concat(t.parsedStyle.text)||"";}}]),n1=(0,O.default)(function t(){(0,R.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){var i=r.getAttribute("text");if(i){var a=i;"capitalize"===n.value?a=i.charAt(0).toUpperCase()+i.slice(1):"lowercase"===n.value?a=i.toLowerCase():"uppercase"===n.value&&(a=i.toUpperCase()),r.parsedStyle.text=a;}return n.value;}}]),n2=new WeakMap,n3="undefined"!=typeof window&&void 0!==window.document;function n4(t,e){var n=Number(t.parsedStyle.zIndex||0),r=Number(e.parsedStyle.zIndex||0);if(n===r){var i=t.parentNode;if(i){var a=i.childNodes||[];return a.indexOf(t)-a.indexOf(e);}}return n-r;}function n5(t,e){if(n3)return document.defaultView.getComputedStyle(t,null).getPropertyValue(e);}var n6={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},n7="object"==typeof performance&&performance.now?performance:Date;function n9(t){return t.nodeName===K.FRAGMENT||t.getRootNode().nodeName===K.FRAGMENT;}var n8=1,rt="object"==typeof self&&self.self===self?self:"object"==typeof X&&X.global===X?X:{},re=Date.now(),rn={},rr=Date.now(),ri=function(t){if("function"!=typeof t)throw TypeError("".concat(t," is not a function"));var e=Date.now(),n=e-rr,r=n8++;return rn[r]=t,Object.keys(rn).length>1||setTimeout(function(){rr=e;var t=rn;rn={},Object.keys(t).forEach(function(e){return t[e](rt.performance&&"function"==typeof rt.performance.now?rt.performance.now():Date.now()-re);});},n>16?0:16-n),r;},ra=function(t){return"string"!=typeof t?ri:""===t?rt.requestAnimationFrame:rt["".concat(t,"RequestAnimationFrame")];},ro=function(t,e){for(var n=0;void 0!==t[n];){if(e(t[n]))return t[n];n+=1;}}(["","webkit","moz","ms","o"],function(t){return!!ra(t);}),rs=ra(ro),rl="string"!=typeof ro?function(t){delete rn[t];}:""===ro?rt.cancelAnimationFrame:rt["".concat(ro,"CancelAnimationFrame")]||rt["".concat(ro,"CancelRequestAnimationFrame")];rt.requestAnimationFrame=rs,rt.cancelAnimationFrame=rl;var ru=(0,O.default)(function t(){(0,R.default)(this,t),this.callbacks=[];},[{key:"getCallbacksNum",value:function(){return this.callbacks.length;}},{key:"tapPromise",value:function(t,e){this.callbacks.push(e);}},{key:"promise",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return Promise.all(this.callbacks.map(function(t){return t.apply(void 0,e);}));}}]),rc=(0,O.default)(function t(){(0,R.default)(this,t),this.callbacks=[];},[{key:"tapPromise",value:function(t,e){this.callbacks.push(e);}},{key:"promise",value:(k=(0,Y.default)((0,H.default)().mark(function t(){var e,n,r,i,a=arguments;return(0,H.default)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.callbacks.length){t.next=6;break;}return t.next=1,(e=this.callbacks)[0].apply(e,a);case 1:n=t.sent,r=0;case 2:if(!(r<this.callbacks.length-1)){t.next=5;break;}return i=this.callbacks[r],t.next=3,i(n);case 3:n=t.sent;case 4:r++,t.next=2;break;case 5:return t.abrupt("return",n);case 6:return t.abrupt("return",null);case 7:case"end":return t.stop();}},t,this);})),function(){return k.apply(this,arguments);})}]),rh=(0,O.default)(function t(){(0,R.default)(this,t),this.callbacks=[];},[{key:"tap",value:function(t,e){this.callbacks.push(e);}},{key:"call",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=arguments;this.callbacks.forEach(function(t){t.apply(void 0,r);});}}]),rd=(0,O.default)(function t(){(0,R.default)(this,t),this.callbacks=[];},[{key:"tap",value:function(t,e){this.callbacks.push(e);}},{key:"call",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];if(this.callbacks.length){for(var r=arguments,i=this.callbacks[0].apply(void 0,r),a=0;a<this.callbacks.length-1;a++)i=(0,this.callbacks[a])(i);return i;}return null;}}]),rf=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],rv=/([\"\'])[^\'\"]+\1/;function rp(t,e,n){return F.mat4.identity(t),t[4]=Math.tan(e),t[1]=Math.tan(n),t;}var rg=F.mat4.create(),ry=F.mat4.create(),rm={scale:function(t){F.mat4.fromScaling(rg,[t[0].value,t[1].value,1]);},scaleX:function(t){F.mat4.fromScaling(rg,[t[0].value,1,1]);},scaleY:function(t){F.mat4.fromScaling(rg,[1,t[0].value,1]);},scaleZ:function(t){F.mat4.fromScaling(rg,[1,1,t[0].value]);},scale3d:function(t){F.mat4.fromScaling(rg,[t[0].value,t[1].value,t[2].value]);},translate:function(t){F.mat4.fromTranslation(rg,[t[0].value,t[1].value,0]);},translateX:function(t){F.mat4.fromTranslation(rg,[t[0].value,0,0]);},translateY:function(t){F.mat4.fromTranslation(rg,[0,t[0].value,0]);},translateZ:function(t){F.mat4.fromTranslation(rg,[0,0,t[0].value]);},translate3d:function(t){F.mat4.fromTranslation(rg,[t[0].value,t[1].value,t[2].value]);},rotate:function(t){F.mat4.fromZRotation(rg,e0(t[0])*tp);},rotateX:function(t){F.mat4.fromXRotation(rg,e0(t[0])*tp);},rotateY:function(t){F.mat4.fromYRotation(rg,e0(t[0])*tp);},rotateZ:function(t){F.mat4.fromZRotation(rg,e0(t[0])*tp);},rotate3d:function(t){F.mat4.fromRotation(rg,e0(t[3])*tp,[t[0].value,t[1].value,t[2].value]);},skew:function(t){rp(rg,t[0].value*tp,t[1].value*tp);},skewX:function(t){rp(rg,t[0].value*tp,0);},skewY:function(t){rp(rg,0,t[0].value*tp);},matrix:function(t){F.mat4.set(rg,t[0].value,t[1].value,0,0,t[2].value,t[3].value,0,0,0,0,1,0,t[4].value,t[5].value,0,1);},matrix3d:function(t){F.mat4.set.apply(F.mat4,[rg].concat((0,L.default)(t.map(function(t){return t.value;}))));}},rk=F.vec3.fromValues(1,1,1),rE=F.vec3.create(),rx={translate:function(t,e){ih.sceneGraphService.setLocalScale(t,rk,!1),ih.sceneGraphService.setLocalEulerAngles(t,rE,void 0,void 0,!1),ih.sceneGraphService.setLocalPosition(t,[e[0].value,e[1].value,0],!1),ih.sceneGraphService.dirtyLocalTransform(t,t.transformable);}},rT=(0,O.default)(function t(){(0,R.default)(this,t),this.parser=nT,this.mixer=nR;},[{key:"calculator",value:function(t,e,n,r){return n instanceof eT?[]:n;}},{key:"postProcessor",value:function(t){!function(t,e){if(t.length){if(1===t.length&&rx[t[0].t]){rx[t[0].t](e,t[0].d);return;}for(var n=F.mat4.identity(ry),r=0;r<t.length;r++){var i=t[r],a=i.t,o=i.d,s=rm[a];s&&(s(o),F.mat4.mul(n,n,rg));}e.setLocalTransform(n);}else e.resetLocalTransform();e.getLocalTransform();}(t.parsedStyle.transform,t);}}]),rN=(0,O.default)(function t(){(0,R.default)(this,t);},[{key:"postProcessor",value:function(t){var e=t.parsedStyle.transformOrigin;e[0].unit===el.kPixels&&e[1].unit===el.kPixels?t.setOrigin(e[0].value,e[1].value):t.getGeometryBounds();}}]),rb=(0,O.default)(function t(){(0,R.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){return n.value;}},{key:"postProcessor",value:function(t){if(t.parentNode){var e=t.parentNode,n=e.renderable,r=e.sortable;n&&e.dirty(),r&&(r.dirty=!0,r.dirtyReason=tL.Z_INDEX_CHANGED);}}}]),rS=(0,O.default)(function t(){(0,R.default)(this,t);},[{key:"update",value:function(t,e){var n=t.cx,r=t.cy,i=t.r,a=void 0===i?0:i;return{cx:void 0===n?0:n,cy:void 0===r?0:r,hwidth:a,hheight:a};}}]),rw=(0,O.default)(function t(){(0,R.default)(this,t);},[{key:"update",value:function(t,e){var n=t.cx,r=t.cy,i=t.rx,a=t.ry;return{cx:void 0===n?0:n,cy:void 0===r?0:r,hwidth:void 0===i?0:i,hheight:void 0===a?0:a};}}]),rP=(0,O.default)(function t(){(0,R.default)(this,t);},[{key:"update",value:function(t){var e=t.x1,n=t.y1,r=t.x2,i=t.y2,a=Math.min(e,r),o=Math.min(n,i),s=(Math.max(e,r)-a)/2,l=(Math.max(n,i)-o)/2;return{cx:a+s,cy:o+l,hwidth:s,hheight:l};}}]),rM=(0,O.default)(function t(){(0,R.default)(this,t);},[{key:"update",value:function(t){var e=t.d.rect,n=e.x,r=e.y,i=e.width,a=e.height,o=i/2,s=a/2;return{cx:n+o,cy:r+s,hwidth:o,hheight:s};}}]),rA=(0,O.default)(function t(){(0,R.default)(this,t);},[{key:"update",value:function(t){if(t.points&&(0,B.isArray)(t.points.points)){var e=t.points.points,n=Math.min.apply(Math,(0,L.default)(e.map(function(t){return t[0];}))),r=Math.max.apply(Math,(0,L.default)(e.map(function(t){return t[0];}))),i=Math.min.apply(Math,(0,L.default)(e.map(function(t){return t[1];}))),a=Math.max.apply(Math,(0,L.default)(e.map(function(t){return t[1];}))),o=(r-n)/2,s=(a-i)/2;return{cx:n+o,cy:i+s,hwidth:o,hheight:s};}return{cx:0,cy:0,hwidth:0,hheight:0};}}]),rC=(0,O.default)(function t(){(0,R.default)(this,t);},[{key:"update",value:function(t,e){var n=t.x,r=t.y,i=t.src,a=t.width,o=t.height,s=void 0===a?0:a,l=void 0===o?0:o;return!i||(0,B.isString)(i)||(s||(s=i.width,t.width=s),l||(l=i.height,t.height=l)),{cx:(void 0===n?0:n)+s/2,cy:(void 0===r?0:r)+l/2,hwidth:s/2,hheight:l/2};}}]),rR=(0,O.default)(function t(e){(0,R.default)(this,t),this.globalRuntime=e;},[{key:"isReadyToMeasure",value:function(t,e){return t.text;}},{key:"update",value:function(t,e){var n,r=t.text,i=t.textAlign,a=void 0===i?"start":i,o=t.lineWidth,s=void 0===o?1:o,l=t.textBaseline,u=void 0===l?"alphabetic":l,c=t.dx,h=void 0===c?0:c,d=t.dy,f=void 0===d?0:d,v=t.x,p=t.y;if(!this.isReadyToMeasure(t,e))return t.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var g=((null==e||null===(n=e.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n?void 0:n.getConfig())||{}).offscreenCanvas,y=this.globalRuntime.textService.measureText(r,t,g);t.metrics=y;var m=y.width,k=y.height,E=m/2,x=k/2,T=(void 0===v?0:v)+E;"center"===a||"middle"===a?T+=s/2-E:("right"===a||"end"===a)&&(T+=s-2*E);var N=(void 0===p?0:p)-x;return"middle"===u?N+=x:"top"===u||"hanging"===u?N+=2*x:"alphabetic"===u||("bottom"===u||"ideographic"===u)&&(N+=0),h&&(T+=h),f&&(N+=f),{cx:T,cy:N,hwidth:E,hheight:x};}}]),rO=(0,O.default)(function t(){(0,R.default)(this,t);},[{key:"update",value:function(t,e){return{cx:0,cy:0,hwidth:0,hheight:0};}}]),rL=(0,O.default)(function t(){(0,R.default)(this,t);},[{key:"update",value:function(t,e){var n=t.x,r=t.y,i=t.width,a=void 0===i?0:i,o=t.height,s=void 0===o?0:o;return{cx:(void 0===n?0:n)+a/2,cy:(void 0===r?0:r)+s/2,hwidth:a/2,hheight:s/2};}}]),rI=(0,O.default)(function t(e){(0,R.default)(this,t),this.eventPhase=t.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new tl,this.page=new tl,this.canvas=new tl,this.viewport=new tl,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e;},[{key:"name",get:function(){return this.type;}},{key:"layerX",get:function(){return this.layer.x;}},{key:"layerY",get:function(){return this.layer.y;}},{key:"pageX",get:function(){return this.page.x;}},{key:"pageY",get:function(){return this.page.y;}},{key:"x",get:function(){return this.canvas.x;}},{key:"y",get:function(){return this.canvas.y;}},{key:"canvasX",get:function(){return this.canvas.x;}},{key:"canvasY",get:function(){return this.canvas.y;}},{key:"viewportX",get:function(){return this.viewport.x;}},{key:"viewportY",get:function(){return this.viewport.y;}},{key:"composedPath",value:function(){return this.manager&&(!this.path||this.path[0]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path;}},{key:"propagationPath",get:function(){return this.composedPath();}},{key:"preventDefault",value:function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0;}},{key:"stopImmediatePropagation",value:function(){this.propagationImmediatelyStopped=!0;}},{key:"stopPropagation",value:function(){this.propagationStopped=!0;}},{key:"initEvent",value:function(){}},{key:"initUIEvent",value:function(){}},{key:"clone",value:function(){throw Error(tc);}}]),rD=function(t){function e(){var t;(0,R.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,I.default)(this,e,[].concat(r))).client=new tl,t.movement=new tl,t.offset=new tl,t.global=new tl,t.screen=new tl,t;}return(0,D.default)(e,t),(0,O.default)(e,[{key:"clientX",get:function(){return this.client.x;}},{key:"clientY",get:function(){return this.client.y;}},{key:"movementX",get:function(){return this.movement.x;}},{key:"movementY",get:function(){return this.movement.y;}},{key:"offsetX",get:function(){return this.offset.x;}},{key:"offsetY",get:function(){return this.offset.y;}},{key:"globalX",get:function(){return this.global.x;}},{key:"globalY",get:function(){return this.global.y;}},{key:"screenX",get:function(){return this.screen.x;}},{key:"screenY",get:function(){return this.screen.y;}},{key:"getModifierState",value:function(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t);}},{key:"initMouseEvent",value:function(){throw Error(tc);}}]);}(rI),r_=function(t){function e(){var t;(0,R.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,I.default)(this,e,[].concat(r))).width=0,t.height=0,t.isPrimary=!1,t;}return(0,D.default)(e,t),(0,O.default)(e,[{key:"getCoalescedEvents",value:function(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[];}},{key:"getPredictedEvents",value:function(){throw Error("getPredictedEvents is not supported!");}},{key:"clone",value:function(){return this.manager.clonePointerEvent(this);}}]);}(rD),rG=function(t){function e(){return(0,R.default)(this,e),(0,I.default)(this,e,arguments);}return(0,D.default)(e,t),(0,O.default)(e,[{key:"clone",value:function(){return this.manager.cloneWheelEvent(this);}}]);}(rD),rF=function(t){function e(t,n){var r;return(0,R.default)(this,e),(r=(0,I.default)(this,e,[null])).type=t,r.detail=n,Object.assign(r,n),r;}return(0,D.default)(e,t),(0,O.default)(e);}(rI),rB=(0,O.default)(function t(){(0,R.default)(this,t),this.emitter=new G.default;},[{key:"on",value:function(t,e,n){return this.addEventListener(t,e,n),this;}},{key:"addEventListener",value:function(t,e,n){var r=!1,i=!1;if((0,B.isBoolean)(n))r=n;else if(n){var a=n.capture;r=void 0!==a&&a;var o=n.once;i=void 0!==o&&o;}r&&(t+="capture"),e=(0,B.isFunction)(e)?e:e.handleEvent;var s=(0,B.isFunction)(e)?void 0:e;return i?this.emitter.once(t,e,s):this.emitter.on(t,e,s),this;}},{key:"off",value:function(t,e,n){return t?this.removeEventListener(t,e,n):this.removeAllEventListeners(),this;}},{key:"removeAllEventListeners",value:function(){var t;null===(t=this.emitter)||void 0===t||t.removeAllListeners();}},{key:"removeEventListener",value:function(t,e,n){if(!this.emitter)return this;((0,B.isBoolean)(n)?n:null==n?void 0:n.capture)&&(t+="capture"),e=(0,B.isFunction)(e)?e:null===(r=e)||void 0===r?void 0:r.handleEvent;var r,i=(0,B.isFunction)(e)?void 0:e;return this.emitter.off(t,e,i),this;}},{key:"emit",value:function(t,e){this.dispatchEvent(new rF(t,e));}},{key:"dispatchEventToSelf",value:function(t){t.target||(t.target=this),t.currentTarget=this,this.emitter.emit(t.type,t);}},{key:"dispatchEvent",value:function(t){var e,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0;if(i)return this.dispatchEventToSelf(t),!0;if(e=this.document?this:this.defaultView?this.defaultView:null===(n=this.ownerDocument)||void 0===n?void 0:n.defaultView){if(t.manager=e.getEventService(),!t.manager)return!1;t.defaultPrevented=!1,t.path?t.path.length=0:t.page=[],r||(t.target=this),t.manager.dispatchEvent(t,t.type,r);}else this.dispatchEventToSelf(t);return!t.defaultPrevented;}}]),rU=function(t){function e(){var t;(0,R.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,I.default)(this,e,[].concat(r))).shadow=!1,t.ownerDocument=null,t.isConnected=!1,t.baseURI="",t.childNodes=[],t.nodeType=0,t.nodeName="",t.nodeValue=null,t.parentNode=null,t.destroyed=!1,t;}return(0,D.default)(e,t),(0,O.default)(e,[{key:"textContent",get:function(){var t="";this.nodeName===K.TEXT&&(t+=this.style.text);var e,n=(0,W.default)(this.childNodes);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.nodeName===K.TEXT?t+=r.nodeValue:t+=r.textContent;}}catch(t){n.e(t);}finally{n.f();}return t;},set:function(t){var e=this;this.childNodes.slice().forEach(function(t){e.removeChild(t);}),this.nodeName===K.TEXT&&(this.style.text="".concat(t));}},{key:"getRootNode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.parentNode?this.parentNode.getRootNode(t):t.composed&&this.host?this.host.getRootNode(t):this;}},{key:"hasChildNodes",value:function(){return this.childNodes.length>0;}},{key:"isDefaultNamespace",value:function(t){throw Error(tc);}},{key:"lookupNamespaceURI",value:function(t){throw Error(tc);}},{key:"lookupPrefix",value:function(t){throw Error(tc);}},{key:"normalize",value:function(){throw Error(tc);}},{key:"isEqualNode",value:function(t){return this===t;}},{key:"isSameNode",value:function(t){return this.isEqualNode(t);}},{key:"parent",get:function(){return this.parentNode;}},{key:"parentElement",get:function(){return null;}},{key:"nextSibling",get:function(){return null;}},{key:"previousSibling",get:function(){return null;}},{key:"firstChild",get:function(){return this.childNodes.length>0?this.childNodes[0]:null;}},{key:"lastChild",get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null;}},{key:"compareDocumentPosition",value:function(t){if(t===this)return 0;for(var n,r=t,i=this,a=[r],o=[i];null!==(n=r.parentNode)&&void 0!==n?n:i.parentNode;)r=r.parentNode?(a.push(r.parentNode),r.parentNode):r,i=i.parentNode?(o.push(i.parentNode),i.parentNode):i;if(r!==i)return e.DOCUMENT_POSITION_DISCONNECTED|e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|e.DOCUMENT_POSITION_PRECEDING;var s=a.length>o.length?a:o,l=s===a?o:a;if(s[s.length-l.length]===l[0])return s===a?e.DOCUMENT_POSITION_CONTAINED_BY|e.DOCUMENT_POSITION_FOLLOWING:e.DOCUMENT_POSITION_CONTAINS|e.DOCUMENT_POSITION_PRECEDING;for(var u=s.length-l.length,c=l.length-1;c>=0;c--){var h=l[c],d=s[u+c];if(d!==h){var f=h.parentNode.childNodes;if(f.indexOf(h)<f.indexOf(d)){if(l===a)return e.DOCUMENT_POSITION_PRECEDING;return e.DOCUMENT_POSITION_FOLLOWING;}if(s===a)return e.DOCUMENT_POSITION_PRECEDING;break;}}return e.DOCUMENT_POSITION_FOLLOWING;}},{key:"contain",value:function(t){return this.contains(t);}},{key:"contains",value:function(t){for(var e=t;e&&this!==e;)e=e.parentNode;return!!e;}},{key:"getAncestor",value:function(t){for(var e=this;t>0&&e;)e=e.parentNode,t--;return e;}},{key:"forEach",value:function(t){for(var e=[this];e.length>0;){var n=e.pop();if(!1===t(n))break;for(var r=n.childNodes.length-1;r>=0;r--)e.push(n.childNodes[r]);}}}],[{key:"isNode",value:function(t){return!!t.childNodes;}}]);}(rB);rU.DOCUMENT_POSITION_DISCONNECTED=1,rU.DOCUMENT_POSITION_PRECEDING=2,rU.DOCUMENT_POSITION_FOLLOWING=4,rU.DOCUMENT_POSITION_CONTAINS=8,rU.DOCUMENT_POSITION_CONTAINED_BY=16,rU.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32;var rV=(0,O.default)(function t(e,n){var r=this;(0,R.default)(this,t),this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=F.mat4.create(),this.tmpVec3=F.vec3.create(),this.onPointerDown=function(t){var e=r.createPointerEvent(t);if(r.dispatchEvent(e,"pointerdown"),"touch"===e.pointerType)r.dispatchEvent(e,"touchstart");else if("mouse"===e.pointerType||"pen"===e.pointerType){var n=2===e.button;r.dispatchEvent(e,n?"rightdown":"mousedown");}r.trackingData(t.pointerId).pressTargetsByButton[t.button]=e.composedPath(),r.freeEvent(e);},this.onPointerUp=function(t){var e=n7.now(),n=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);if(r.dispatchEvent(n,"pointerup"),"touch"===n.pointerType)r.dispatchEvent(n,"touchend");else if("mouse"===n.pointerType||"pen"===n.pointerType){var i=2===n.button;r.dispatchEvent(n,i?"rightup":"mouseup");}var a=r.trackingData(t.pointerId),o=r.findMountedTarget(a.pressTargetsByButton[t.button]),s=o;if(o&&!n.composedPath().includes(o)){for(var l=o;l&&!n.composedPath().includes(l);){if(n.currentTarget=l,r.notifyTarget(n,"pointerupoutside"),"touch"===n.pointerType)r.notifyTarget(n,"touchendoutside");else if("mouse"===n.pointerType||"pen"===n.pointerType){var u=2===n.button;r.notifyTarget(n,u?"rightupoutside":"mouseupoutside");}rU.isNode(l)&&(l=l.parentNode);}delete a.pressTargetsByButton[t.button],s=l;}if(s){var c,h=r.clonePointerEvent(n,"click");h.target=s,h.path=[],a.clicksByButton[t.button]||(a.clicksByButton[t.button]={clickCount:0,target:h.target,timeStamp:e});var d=r.context.renderingContext.root.ownerDocument.defaultView,f=a.clicksByButton[t.button];f.target===h.target&&e-f.timeStamp<d.getConfig().dblClickSpeed?++f.clickCount:f.clickCount=1,f.target=h.target,f.timeStamp=e,h.detail=f.clickCount,null!==(c=n.detail)&&void 0!==c&&c.preventClick||(r.context.config.useNativeClickEvent||"mouse"!==h.pointerType&&"touch"!==h.pointerType||r.dispatchEvent(h,"click"),r.dispatchEvent(h,"pointertap")),r.freeEvent(h);}r.freeEvent(n);},this.onPointerMove=function(t){var e=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0),n="mouse"===e.pointerType||"pen"===e.pointerType,i=r.trackingData(t.pointerId),a=r.findMountedTarget(i.overTargets);if(i.overTargets&&a!==e.target){var o="mousemove"===t.type?"mouseout":"pointerout",s=r.createPointerEvent(t,o,a||void 0);if(r.dispatchEvent(s,"pointerout"),n&&r.dispatchEvent(s,"mouseout"),!e.composedPath().includes(a)){var l=r.createPointerEvent(t,"pointerleave",a||void 0);for(l.eventPhase=l.AT_TARGET;l.target&&!e.composedPath().includes(l.target);)l.currentTarget=l.target,r.notifyTarget(l),n&&r.notifyTarget(l,"mouseleave"),rU.isNode(l.target)&&(l.target=l.target.parentNode);r.freeEvent(l);}r.freeEvent(s);}if(a!==e.target){var u="mousemove"===t.type?"mouseover":"pointerover",c=r.clonePointerEvent(e,u);r.dispatchEvent(c,"pointerover"),n&&r.dispatchEvent(c,"mouseover");for(var h=a&&rU.isNode(a)&&a.parentNode;h&&h!==(rU.isNode(r.rootTarget)&&r.rootTarget.parentNode)&&h!==e.target;)h=h.parentNode;if(!h||h===(rU.isNode(r.rootTarget)&&r.rootTarget.parentNode)){var d=r.clonePointerEvent(e,"pointerenter");for(d.eventPhase=d.AT_TARGET;d.target&&d.target!==a&&d.target!==(rU.isNode(r.rootTarget)&&r.rootTarget.parentNode);)d.currentTarget=d.target,r.notifyTarget(d),n&&r.notifyTarget(d,"mouseenter"),rU.isNode(d.target)&&(d.target=d.target.parentNode);r.freeEvent(d);}r.freeEvent(c);}r.dispatchEvent(e,"pointermove"),"touch"===e.pointerType&&r.dispatchEvent(e,"touchmove"),n&&(r.dispatchEvent(e,"mousemove"),r.cursor=r.getCursor(e.target)),i.overTargets=e.composedPath(),r.freeEvent(e);},this.onPointerOut=function(t){var e=r.trackingData(t.pointerId);if(e.overTargets){var n="mouse"===t.pointerType||"pen"===t.pointerType,i=r.findMountedTarget(e.overTargets),a=r.createPointerEvent(t,"pointerout",i||void 0);r.dispatchEvent(a),n&&r.dispatchEvent(a,"mouseout");var o=r.createPointerEvent(t,"pointerleave",i||void 0);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==(rU.isNode(r.rootTarget)&&r.rootTarget.parentNode);)o.currentTarget=o.target,r.notifyTarget(o),n&&r.notifyTarget(o,"mouseleave"),rU.isNode(o.target)&&(o.target=o.target.parentNode);e.overTargets=null,r.freeEvent(a),r.freeEvent(o);}r.cursor=null;},this.onPointerOver=function(t){var e=r.trackingData(t.pointerId),n=r.createPointerEvent(t),i="mouse"===n.pointerType||"pen"===n.pointerType;r.dispatchEvent(n,"pointerover"),i&&r.dispatchEvent(n,"mouseover"),"mouse"===n.pointerType&&(r.cursor=r.getCursor(n.target));var a=r.clonePointerEvent(n,"pointerenter");for(a.eventPhase=a.AT_TARGET;a.target&&a.target!==(rU.isNode(r.rootTarget)&&r.rootTarget.parentNode);)a.currentTarget=a.target,r.notifyTarget(a),i&&r.notifyTarget(a,"mouseenter"),rU.isNode(a.target)&&(a.target=a.target.parentNode);e.overTargets=n.composedPath(),r.freeEvent(n),r.freeEvent(a);},this.onPointerUpOutside=function(t){var e=r.trackingData(t.pointerId),n=r.findMountedTarget(e.pressTargetsByButton[t.button]),i=r.createPointerEvent(t);if(n){for(var a=n;a;)i.currentTarget=a,r.notifyTarget(i,"pointerupoutside"),"touch"===i.pointerType||("mouse"===i.pointerType||"pen"===i.pointerType)&&r.notifyTarget(i,2===i.button?"rightupoutside":"mouseupoutside"),rU.isNode(a)&&(a=a.parentNode);delete e.pressTargetsByButton[t.button];}r.freeEvent(i);},this.onWheel=function(t){var e=r.createWheelEvent(t);r.dispatchEvent(e),r.freeEvent(e);},this.onClick=function(t){if(r.context.config.useNativeClickEvent){var e=r.createPointerEvent(t);r.dispatchEvent(e),r.freeEvent(e);}},this.onPointerCancel=function(t){var e=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);r.dispatchEvent(e),r.freeEvent(e);},this.globalRuntime=e,this.context=n;},[{key:"init",value:function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick);}},{key:"destroy",value:function(){this.mappingTable={},this.mappingState={},this.eventPool.clear();}},{key:"getScale",value:function(){var t=this.context.contextService.getBoundingClientRect(),e=1,n=1,r=this.context.contextService.getDomElement();if(r&&t){var i=r.offsetWidth,a=r.offsetHeight;i&&a&&(e=t.width/i,n=t.height/a);}return{scaleX:e,scaleY:n,bbox:t};}},{key:"client2Viewport",value:function(t){var e=this.getScale(),n=e.scaleX,r=e.scaleY,i=e.bbox;return new tl((t.x-((null==i?void 0:i.left)||0))/n,(t.y-((null==i?void 0:i.top)||0))/r);}},{key:"viewport2Client",value:function(t){var e=this.getScale(),n=e.scaleX,r=e.scaleY,i=e.bbox;return new tl((t.x+((null==i?void 0:i.left)||0))*n,(t.y+((null==i?void 0:i.top)||0))*r);}},{key:"viewport2Canvas",value:function(t){var e=t.x,n=t.y,r=this.rootTarget.defaultView.getCamera(),i=this.context.config,a=i.width,o=i.height,s=r.getPerspectiveInverse(),l=r.getWorldTransform(),u=F.mat4.multiply(this.tmpMatrix,l,s),c=F.vec3.set(this.tmpVec3,e/a*2-1,(1-n/o)*2-1,0);return F.vec3.transformMat4(c,c,u),new tl(c[0],c[1]);}},{key:"canvas2Viewport",value:function(t){var e=this.rootTarget.defaultView.getCamera(),n=e.getPerspective(),r=e.getViewTransform(),i=F.mat4.multiply(this.tmpMatrix,n,r),a=F.vec3.set(this.tmpVec3,t.x,t.y,0);F.vec3.transformMat4(this.tmpVec3,this.tmpVec3,i);var o=this.context.config,s=o.width,l=o.height;return new tl((a[0]+1)/2*s,(1-(a[1]+1)/2)*l);}},{key:"setPickHandler",value:function(t){this.pickHandler=t;}},{key:"addEventMapping",value:function(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort(function(t,e){return t.priority-e.priority;});}},{key:"mapEvent",value:function(t){if(this.rootTarget){var e=this.mappingTable[t.type];if(e)for(var n=0,r=e.length;n<r;n++)e[n].fn(t);else console.warn("[EventService]: Event mapping not defined for ".concat(t.type));}}},{key:"dispatchEvent",value:function(t,e,n){if(n){t.eventPhase=t.AT_TARGET;var r=this.rootTarget.defaultView||null;t.currentTarget=r,this.notifyListeners(t,e);}else t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e);}},{key:"propagate",value:function(t,e){if(t.target){var n=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(var r=n.length-1;r>=1;r--)if(t.currentTarget=n[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!t.propagationStopped&&!t.propagationImmediatelyStopped){var i=n.indexOf(t.currentTarget);t.eventPhase=t.BUBBLING_PHASE;for(var a=i+1;a<n.length;a++)if(t.currentTarget=n[a],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;}}}},{key:"propagationPath",value:function(t){var e=[t],n=this.rootTarget.defaultView||null;if(n&&n===t)return e.unshift(n.document),e;for(var r=0;r<2048&&t!==this.rootTarget;r++)rU.isNode(t)&&t.parentNode&&(e.push(t.parentNode),t=t.parentNode);return n&&e.push(n),e;}},{key:"hitTest",value:function(t){var e=t.viewportX,n=t.viewportY,r=this.context.config,i=r.width,a=r.height,o=r.disableHitTesting;return e<0||n<0||e>i||n>a?null:!o&&this.pickHandler(t)||this.rootTarget||null;}},{key:"isNativeEventFromCanvas",value:function(t,e){var n,r=null==e?void 0:e.target;if(null!==(n=r)&&void 0!==n&&n.shadowRoot&&(r=e.composedPath()[0]),r){if(r===t)return!0;if(t&&t.contains)return t.contains(r);}return null!=e&&!!e.composedPath&&e.composedPath().indexOf(t)>-1;}},{key:"getExistedHTML",value:function(t){if(t.nativeEvent.composedPath)for(var e=0,n=t.nativeEvent.composedPath();e<n.length;e++){var r=n[e],i=this.nativeHTMLMap.get(r);if(i)return i;}return null;}},{key:"pickTarget",value:function(t){return this.hitTest({clientX:t.clientX,clientY:t.clientY,viewportX:t.viewportX,viewportY:t.viewportY,x:t.canvasX,y:t.canvasY});}},{key:"createPointerEvent",value:function(t,e,n,r){var i=this.allocateEvent(r_);this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.nativeEvent=t.nativeEvent,i.originalEvent=t;var a=this.getExistedHTML(i),o=this.context.contextService.getDomElement();return i.target=null!=n?n:a||this.isNativeEventFromCanvas(o,i.nativeEvent)&&this.pickTarget(i)||r,"string"==typeof e&&(i.type=e),i;}},{key:"createWheelEvent",value:function(t){var e=this.allocateEvent(rG);this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t;var n=this.getExistedHTML(e),r=this.context.contextService.getDomElement();return e.target=n||this.isNativeEventFromCanvas(r,e.nativeEvent)&&this.pickTarget(e),e;}},{key:"trackingData",value:function(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t];}},{key:"cloneWheelEvent",value:function(t){var e=this.allocateEvent(rG);return e.nativeEvent=t.nativeEvent,e.originalEvent=t.originalEvent,this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.target=t.target,e.path=t.composedPath().slice(),e.type=t.type,e;}},{key:"clonePointerEvent",value:function(t,e){var n=this.allocateEvent(r_);return n.nativeEvent=t.nativeEvent,n.originalEvent=t.originalEvent,this.copyPointerData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.target=t.target,n.path=t.composedPath().slice(),n.type=null!=e?e:n.type,n;}},{key:"copyPointerData",value:function(t,e){e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist;}},{key:"copyMouseData",value:function(t,e){e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey,e.client.copyFrom(t.client),e.movement.copyFrom(t.movement),e.canvas.copyFrom(t.canvas),e.screen.copyFrom(t.screen),e.global.copyFrom(t.global),e.offset.copyFrom(t.offset);}},{key:"copyWheelData",value:function(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;}},{key:"copyData",value:function(t,e){e.isTrusted=t.isTrusted,e.timeStamp=n7.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.page.copyFrom(t.page),e.viewport.copyFrom(t.viewport);}},{key:"allocateEvent",value:function(t){this.eventPool.has(t)||this.eventPool.set(t,[]);var e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=[],e.target=null,e;}},{key:"freeEvent",value:function(t){if(t.manager!==this)throw Error("It is illegal to free an event not managed by this EventBoundary!");var e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t);}},{key:"notifyTarget",value:function(t,e){e=null!=e?e:t.type;var n=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?"".concat(e,"capture"):e;this.notifyListeners(t,n),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e);}},{key:"notifyListeners",value:function(t,e){var n=t.currentTarget.emitter,r=n._events[e];if(r){if("fn"in r)r.once&&n.removeListener(e,r.fn,void 0,!0),r.fn.call(t.currentTarget||r.context,t);else for(var i=0;i<r.length&&!t.propagationImmediatelyStopped;i++)r[i].once&&n.removeListener(e,r[i].fn,void 0,!0),r[i].fn.call(t.currentTarget||r[i].context,t);}}},{key:"findMountedTarget",value:function(t){if(!t)return null;for(var e=t[t.length-1],n=t.length-2;n>=0;n--){var r=t[n];if(r===this.rootTarget||rU.isNode(r)&&r.parentNode===e)e=t[n];else break;}return e;}},{key:"getCursor",value:function(t){for(var e=t;e;){var n=!!e.getAttribute&&e.getAttribute("cursor");if(n)return n;e=rU.isNode(e)&&e.parentNode;}}}]),rz=(0,O.default)(function t(){(0,R.default)(this,t);},[{key:"getOrCreateCanvas",value:function(t,e){if(this.canvas)return this.canvas;if(t||ih.offscreenCanvas)this.canvas=t||ih.offscreenCanvas,this.context=this.canvas.getContext("2d",(0,C.default)({willReadFrequently:!0},e));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",(0,C.default)({willReadFrequently:!0},e)),this.context&&this.context.measureText||(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"));}catch(t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",(0,C.default)({willReadFrequently:!0},e));}return this.canvas.width=10,this.canvas.height=10,this.canvas;}},{key:"getOrCreateContext",value:function(t,e){return this.context||this.getOrCreateCanvas(t,e),this.context;}}],[{key:"createCanvas",value:function(){try{return new window.OffscreenCanvas(0,0);}catch(t){}try{return document.createElement("canvas");}catch(t){}return null;}}]),rH=((E={})[E.CAMERA_CHANGED=0]="CAMERA_CHANGED",E[E.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",E[E.NONE=2]="NONE",E),rY=(0,O.default)(function t(e,n){(0,R.default)(this,t),this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new rh,initAsync:new ru,dirtycheck:new rd,cull:new rd,beginFrame:new rh,beforeRender:new rh,render:new rh,afterRender:new rh,endFrame:new rh,destroy:new rh,pick:new rc,pickSync:new rd,pointerDown:new rh,pointerUp:new rh,pointerMove:new rh,pointerOut:new rh,pointerOver:new rh,pointerWheel:new rh,pointerCancel:new rh,click:new rh},this.globalRuntime=e,this.context=n;},[{key:"init",value:function(t){var e=this,n=(0,C.default)((0,C.default)({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach(function(t){t.apply(n,e.globalRuntime);}),this.hooks.init.call(),0===this.hooks.initAsync.getCallbacksNum()?(this.inited=!0,t()):this.hooks.initAsync.promise().then(function(){e.inited=!0,t();}).catch(function(t){});}},{key:"getStats",value:function(){return this.stats;}},{key:"disableDirtyRectangleRendering",value:function(){return!this.context.config.renderer.getConfig().enableDirtyRectangleRendering||this.context.renderingContext.renderReasons.has(rH.CAMERA_CHANGED);}},{key:"render",value:function(t,e,n){var r=this;this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0;var i=this.context.renderingContext;if(this.globalRuntime.sceneGraphService.syncHierarchy(i.root),this.globalRuntime.sceneGraphService.triggerPendingEvents(),i.renderReasons.size&&this.inited){i.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var a=1===i.renderReasons.size&&i.renderReasons.has(rH.CAMERA_CHANGED),o=!t.disableRenderHooks||!a;o&&this.renderDisplayObject(i.root,t,i),this.hooks.beginFrame.call(e),o&&i.renderListCurrentFrame.forEach(function(t){r.hooks.beforeRender.call(t),r.hooks.render.call(t),r.hooks.afterRender.call(t);}),this.hooks.endFrame.call(e),i.renderListCurrentFrame=[],i.renderReasons.clear(),n();}}},{key:"renderDisplayObject",value:function(t,e,n){for(var r=this,i=e.renderer.getConfig(),a=i.enableDirtyCheck,o=i.enableCulling,s=[t];s.length>0;){var l,u=s.pop();!function(t){var e=t.renderable,i=t.sortable,s=a?e.dirty||n.dirtyRectangleRenderingDisabled?t:null:t,l=null;s&&(l=o?r.hooks.cull.call(s,r.context.camera):s)&&(r.stats.rendered+=1,n.renderListCurrentFrame.push(l)),t.dirty(!1),i.renderOrder=r.zIndexCounter,r.zIndexCounter+=1,r.stats.total+=1,i.dirty&&(r.sort(t,i),i.dirty=!1,i.dirtyChildren=[],i.dirtyReason=void 0);}(u);for(var c=(null===(l=u.sortable)||void 0===l||null===(l=l.sorted)||void 0===l?void 0:l.length)>0?u.sortable.sorted:u.childNodes,h=c.length-1;h>=0;h--)s.push(c[h]);}}},{key:"sort",value:function(t,e){var n,r;(null==e||null===(n=e.sorted)||void 0===n?void 0:n.length)>0&&e.dirtyReason!==tL.Z_INDEX_CHANGED?e.dirtyChildren.forEach(function(n){var r=e.sorted.indexOf(n);if(r>-1&&e.sorted.splice(r,1),t.childNodes.indexOf(n)>-1){if(0===e.sorted.length)e.sorted.push(n);else{var i=function(t,e){for(var n=0,r=t.length;n<r;){var i=n+r>>>1;0>n4(t[i],e)?n=i+1:r=i;}return n;}(e.sorted,n);e.sorted.splice(i,0,n);}}}):e.sorted=t.childNodes.slice().sort(n4),(null===(r=e.sorted)||void 0===r?void 0:r.length)>0&&0===t.childNodes.filter(function(t){return t.parsedStyle.zIndex;}).length&&(e.sorted=[]);}},{key:"destroy",value:function(){this.inited=!1,this.hooks.destroy.call(),this.globalRuntime.sceneGraphService.clearPendingEvents();}},{key:"dirtify",value:function(){this.context.renderingContext.renderReasons.add(rH.DISPLAY_OBJECT_CHANGED);}}]),rW=/\[\s*(.*)=(.*)\s*\]/,rq=(0,O.default)(function t(){(0,R.default)(this,t);},[{key:"selectOne",value:function(t,e){var n=this;if(t.startsWith("."))return e.find(function(e){return((null==e?void 0:e.classList)||[]).indexOf(n.getIdOrClassname(t))>-1;});if(t.startsWith("#"))return e.find(function(e){return e.id===n.getIdOrClassname(t);});if(t.startsWith("[")){var r=this.getAttribute(t),i=r.name,a=r.value;return i?e.find(function(t){return e!==t&&("name"===i?t.name===a:n.attributeToString(t,i)===a);}):null;}return e.find(function(n){return e!==n&&n.nodeName===t;});}},{key:"selectAll",value:function(t,e){var n=this;if(t.startsWith("."))return e.findAll(function(r){return e!==r&&((null==r?void 0:r.classList)||[]).indexOf(n.getIdOrClassname(t))>-1;});if(t.startsWith("#"))return e.findAll(function(r){return e!==r&&r.id===n.getIdOrClassname(t);});if(t.startsWith("[")){var r=this.getAttribute(t),i=r.name,a=r.value;return i?e.findAll(function(t){return e!==t&&("name"===i?t.name===a:n.attributeToString(t,i)===a);}):[];}return e.findAll(function(n){return e!==n&&n.nodeName===t;});}},{key:"is",value:function(t,e){if(t.startsWith("."))return e.className===this.getIdOrClassname(t);if(t.startsWith("#"))return e.id===this.getIdOrClassname(t);if(t.startsWith("[")){var n=this.getAttribute(t),r=n.name,i=n.value;return"name"===r?e.name===i:this.attributeToString(e,r)===i;}return e.nodeName===t;}},{key:"getIdOrClassname",value:function(t){return t.substring(1);}},{key:"getAttribute",value:function(t){var e=t.match(rW),n="",r="";return e&&e.length>2&&(n=e[1].replace(/"/g,""),r=e[2].replace(/"/g,"")),{name:n,value:r};}},{key:"attributeToString",value:function(t,e){if(!t.getAttribute)return"";var n=t.getAttribute(e);return(0,B.isNil)(n)?"":n.toString?n.toString():"";}}]),rX=((x={}).ATTR_MODIFIED="DOMAttrModified",x.INSERTED="DOMNodeInserted",x.MOUNTED="DOMNodeInsertedIntoDocument",x.REMOVED="removed",x.UNMOUNTED="DOMNodeRemovedFromDocument",x.REPARENT="reparent",x.DESTROY="destroy",x.BOUNDS_CHANGED="bounds-changed",x.CULLED="culled",x),rj=function(t){function e(t,n,r,i,a,o,s,l){var u;return(0,R.default)(this,e),(u=(0,I.default)(this,e,[null])).relatedNode=n,u.prevValue=r,u.newValue=i,u.attrName=a,u.attrChange=o,u.prevParsedValue=s,u.newParsedValue=l,u.type=t,u;}return(0,D.default)(e,t),(0,O.default)(e);}(rI);rj.ADDITION=2,rj.MODIFICATION=1,rj.REMOVAL=3;var r$=new rj(rX.REPARENT,null,"","","",0,"",""),rK=F.vec2.create(),rZ=F.vec3.create(),rQ=F.vec3.fromValues(1,1,1),rJ=F.mat4.create(),r0=F.vec2.create(),r1=F.vec3.create(),r2=F.mat4.create(),r3=F.quat.create(),r4=F.vec3.create(),r5=F.quat.create(),r6=F.vec3.create(),r7=F.vec3.create(),r9=F.vec3.create(),r8=F.mat4.create(),it=F.quat.create(),ie=F.quat.create(),ir=F.quat.create(),ii={affectChildren:!0},ia=(0,O.default)(function t(e){(0,R.default)(this,t),this.pendingEvents=new Map,this.boundsChangedEvent=new rF(rX.BOUNDS_CHANGED),this.displayObjectDependencyMap=new WeakMap,this.runtime=e;},[{key:"matches",value:function(t,e){return this.runtime.sceneGraphSelector.is(t,e);}},{key:"querySelector",value:function(t,e){return this.runtime.sceneGraphSelector.selectOne(t,e);}},{key:"querySelectorAll",value:function(t,e){return this.runtime.sceneGraphSelector.selectAll(t,e);}},{key:"attach",value:function(t,e,n){var r=!1;t.parentNode&&(r=t.parentNode!==e,this.detach(t));var i=t.nodeName===K.FRAGMENT,a=n9(e);t.parentNode=e;var o=i?t.childNodes:[t];(0,B.isNumber)(n)?o.forEach(function(t){e.childNodes.splice(n,0,t),t.parentNode=e;}):o.forEach(function(t){e.childNodes.push(t),t.parentNode=e;});var s=e.sortable;if((null!=s&&null!==(u=s.sorted)&&void 0!==u&&u.length||s.dirty||t.parsedStyle.zIndex)&&(-1===s.dirtyChildren.indexOf(t)&&s.dirtyChildren.push(t),s.dirty=!0,s.dirtyReason=tL.ADDED),!a){if(i)this.dirtifyFragment(t);else{var l=t.transformable;l&&this.dirtyWorldTransform(t,l);}if(r){var u,c,h=(null===(c=e.ownerDocument)||void 0===c||null===(c=c.defaultView)||void 0===c||null===(c=c.getConfig())||void 0===c||null===(c=c.future)||void 0===c?void 0:c.experimentalCancelEventPropagation)===!0;t.dispatchEvent(r$,h,h);}}}},{key:"detach",value:function(t){if(t.parentNode){var e,n,r=t.transformable,i=t.parentNode.sortable;(null!=i&&null!==(e=i.sorted)&&void 0!==e&&e.length||null!==(n=t.style)&&void 0!==n&&n.zIndex)&&(-1===i.dirtyChildren.indexOf(t)&&i.dirtyChildren.push(t),i.dirty=!0,i.dirtyReason=tL.REMOVED);var a=t.parentNode.childNodes.indexOf(t);a>-1&&t.parentNode.childNodes.splice(a,1),r&&this.dirtyWorldTransform(t,r),t.parentNode=null;}}},{key:"getLocalPosition",value:function(t){return t.transformable.localPosition;}},{key:"getLocalRotation",value:function(t){return t.transformable.localRotation;}},{key:"getLocalScale",value:function(t){return t.transformable.localScale;}},{key:"getLocalSkew",value:function(t){return t.transformable.localSkew;}},{key:"getLocalTransform",value:function(t){var e=t.transformable;return tG(e),e.localTransform;}},{key:"setLocalPosition",value:function(t,e){var n,r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=t.transformable;r7[0]=e[0],r7[1]=e[1],r7[2]=null!==(n=e[2])&&void 0!==n?n:0,!F.vec3.equals(i.localPosition,r7)&&(F.vec3.copy(i.localPosition,r7),r&&this.dirtyLocalTransform(t,i));}},{key:"translateLocal",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=F.vec3.fromValues(e,n,r));var i=t.transformable;F.vec3.equals(e,rZ)||(F.vec3.transformQuat(e,e,i.localRotation),F.vec3.add(i.localPosition,i.localPosition,e),this.dirtyLocalTransform(t,i));}},{key:"setLocalRotation",value:function(t,e,n,r,i){var a=!(arguments.length>5)||void 0===arguments[5]||arguments[5];"number"==typeof e&&(e=F.quat.set(r3,e,n,r,i));var o=t.transformable;F.quat.copy(o.localRotation,e),a&&this.dirtyLocalTransform(t,o);}},{key:"rotateLocal",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=F.vec3.fromValues(e,n,r));var i=t.transformable;F.quat.fromEuler(ie,e[0],e[1],e[2]),F.quat.mul(i.localRotation,i.localRotation,ie),this.dirtyLocalTransform(t,i);}},{key:"setLocalScale",value:function(t,e){var n,r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=t.transformable;F.vec3.set(r1,e[0],e[1],null!==(n=e[2])&&void 0!==n?n:i.localScale[2]),!F.vec3.equals(r1,i.localScale)&&(F.vec3.copy(i.localScale,r1),r&&this.dirtyLocalTransform(t,i));}},{key:"scaleLocal",value:function(t,e){var n,r=t.transformable;F.vec3.multiply(r.localScale,r.localScale,F.vec3.set(r1,e[0],e[1],null!==(n=e[2])&&void 0!==n?n:1)),this.dirtyLocalTransform(t,r);}},{key:"setLocalSkew",value:function(t,e,n){var r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];"number"==typeof e&&(e=F.vec2.set(r0,e,n));var i=t.transformable;F.vec2.copy(i.localSkew,e),r&&this.dirtyLocalTransform(t,i);}},{key:"setLocalEulerAngles",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=!(arguments.length>4)||void 0===arguments[4]||arguments[4];"number"==typeof e&&(e=F.vec3.fromValues(e,n,r));var a=t.transformable;F.quat.fromEuler(a.localRotation,e[0],e[1],e[2]),i&&this.dirtyLocalTransform(t,a);}},{key:"setLocalTransform",value:function(t,e){var n=F.mat4.getTranslation(r4,e),r=F.mat4.getRotation(r5,e),i=F.mat4.getScaling(r6,e);this.setLocalScale(t,i,!1),this.setLocalPosition(t,n,!1),this.setLocalRotation(t,r,void 0,void 0,void 0,!1),this.dirtyLocalTransform(t,t.transformable);}},{key:"resetLocalTransform",value:function(t){this.setLocalScale(t,rQ,!1),this.setLocalPosition(t,rZ,!1),this.setLocalEulerAngles(t,rZ,void 0,void 0,!1),this.setLocalSkew(t,rK,void 0,!1),this.dirtyLocalTransform(t,t.transformable);}},{key:"getPosition",value:function(t){var e=t.transformable;return F.mat4.getTranslation(e.position,this.getWorldTransform(t,e));}},{key:"getRotation",value:function(t){var e=t.transformable;return F.mat4.getRotation(e.rotation,this.getWorldTransform(t,e));}},{key:"getScale",value:function(t){var e=t.transformable;return F.mat4.getScaling(e.scaling,this.getWorldTransform(t,e));}},{key:"getOrigin",value:function(t){return t.getGeometryBounds(),t.transformable.origin;}},{key:"getWorldTransform",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.transformable;return(e.localDirtyFlag||e.dirtyFlag)&&(t.parentNode&&t.parentNode.transformable&&this.getWorldTransform(t.parentNode),this.internalUpdateTransform(t)),e.worldTransform;}},{key:"setPosition",value:function(t,e){var n,r=t.transformable;if(r9[0]=e[0],r9[1]=e[1],r9[2]=null!==(n=e[2])&&void 0!==n?n:0,!F.vec3.equals(this.getPosition(t),r9)){if(F.vec3.copy(r.position,r9),null!==t.parentNode&&t.parentNode.transformable){var i=t.parentNode.transformable;F.mat4.copy(r8,i.worldTransform),F.mat4.invert(r8,r8),F.vec3.transformMat4(r.localPosition,r9,r8);}else F.vec3.copy(r.localPosition,r9);this.dirtyLocalTransform(t,r);}}},{key:"translate",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=F.vec3.set(r1,e,n,r)),F.vec3.equals(e,rZ)||(F.vec3.add(r1,this.getPosition(t),e),this.setPosition(t,r1));}},{key:"setRotation",value:function(t,e,n,r,i){var a=t.transformable;if("number"==typeof e&&(e=F.quat.fromValues(e,n,r,i)),null!==t.parentNode&&t.parentNode.transformable){var o=this.getRotation(t.parentNode);F.quat.copy(r3,o),F.quat.invert(r3,r3),F.quat.multiply(a.localRotation,r3,e),F.quat.normalize(a.localRotation,a.localRotation),this.dirtyLocalTransform(t,a);}else this.setLocalRotation(t,e);}},{key:"rotate",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=F.vec3.fromValues(e,n,r));var i=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){F.quat.fromEuler(r3,e[0],e[1],e[2]);var a=this.getRotation(t),o=this.getRotation(t.parentNode);F.quat.copy(ir,o),F.quat.invert(ir,ir),F.quat.multiply(r3,ir,r3),F.quat.multiply(i.localRotation,r3,a),F.quat.normalize(i.localRotation,i.localRotation),this.dirtyLocalTransform(t,i);}else this.rotateLocal(t,e);}},{key:"setOrigin",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=[e,n,r]);var i=t.transformable;if(e[0]!==i.origin[0]||e[1]!==i.origin[1]||e[2]!==i.origin[2]){var a=i.origin;a[0]=e[0],a[1]=e[1],a[2]=e[2]||0,this.dirtyLocalTransform(t,i);}}},{key:"setEulerAngles",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=F.vec3.fromValues(e,n,r));var i=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){F.quat.fromEuler(i.localRotation,e[0],e[1],e[2]);var a=this.getRotation(t.parentNode);F.quat.copy(it,F.quat.invert(r3,a)),F.quat.mul(i.localRotation,i.localRotation,it),this.dirtyLocalTransform(t,i);}else this.setLocalEulerAngles(t,e);}},{key:"getTransformedGeometryBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this.getGeometryBounds(t,e);if(!ti.isEmpty(r)){var i=n||new ti;return i.setFromTransformedAABB(r,this.getWorldTransform(t)),i;}return null;}},{key:"getGeometryBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.geometry;return n.dirty&&ih.styleValueRegistry.updateGeometry(t),(e?n.renderBounds:n.contentBounds||null)||new ti;}},{key:"getBounds",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t.renderable;if(!r.boundsDirty&&!n&&r.bounds)return r.bounds;if(!r.renderBoundsDirty&&n&&r.renderBounds)return r.renderBounds;var i=n?r.renderBounds:r.bounds,a=this.getTransformedGeometryBounds(t,n,i);if(t.childNodes.forEach(function(t){var r=e.getBounds(t,n);r&&(a?a.add(r):(a=i||new ti).update(r.center,r.halfExtents));}),a||(a=new ti),n){var o=function(t){var e,n=t;do{if(null===(e=n.parsedStyle)||void 0===e?void 0:e.clipPath)return n;n=n.parentElement;}while(null!==n)return null;}(t);if(o){var s=o.parsedStyle.clipPath.getBounds(n);a?s&&(a=s.intersection(a)):a.update(s.center,s.halfExtents);}}return n?(r.renderBounds=a,r.renderBoundsDirty=!1):(r.bounds=a,r.boundsDirty=!1),a;}},{key:"getLocalBounds",value:function(t){if(t.parentNode){var e=rJ;t.parentNode.transformable&&(e=F.mat4.invert(r2,this.getWorldTransform(t.parentNode)));var n=this.getBounds(t);if(!ti.isEmpty(n)){var r=new ti;return r.setFromTransformedAABB(n,e),r;}}return this.getBounds(t);}},{key:"getBoundingClientRect",value:function(t){var e,n,r=this.getGeometryBounds(t);ti.isEmpty(r)||(n=new ti).setFromTransformedAABB(r,this.getWorldTransform(t));var i=null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e?void 0:e.getContextService().getBoundingClientRect();if(n){var a=n.getMin(),o=(0,_.default)(a,2),s=o[0],l=o[1],u=n.getMax(),c=(0,_.default)(u,2),h=c[0],d=c[1];return new tu(s+((null==i?void 0:i.left)||0),l+((null==i?void 0:i.top)||0),h-s,d-l);}return new tu((null==i?void 0:i.left)||0,(null==i?void 0:i.top)||0,0,0);}},{key:"internalUpdateTransform",value:function(t){var e,n,r=null===(n=t.parentNode)||void 0===n?void 0:n.transformable;tG(t.transformable),(e=t.transformable).dirtyFlag&&(r?F.mat4.multiply(e.worldTransform,r.worldTransform,e.localTransform):F.mat4.copy(e.worldTransform,e.localTransform),e.dirtyFlag=!1);}},{key:"internalUpdateElement",value:function(t,e){var n=(null===(s=t.ownerDocument)||void 0===s||null===(s=s.defaultView)||void 0===s||null===(s=s.getConfig())||void 0===s||null===(s=s.future)||void 0===s?void 0:s.experimentalAttributeUpdateOptimization)===!0,r=e[e.length-1],i=(null==r?void 0:r.transformDirty)||(null===(l=t.transformable)||void 0===l?void 0:l.localDirtyFlag);t.transformable&&((h=t.transformable).dirtyFlag||(h.dirtyFlag=i)),this.internalUpdateTransform(t),i&&(null===(d=t.dirty)||void 0===d||d.call(t,!0,!0));var a=(null===(u=t.renderable)||void 0===u?void 0:u.boundsDirty)||(null===(c=t.renderable)||void 0===c?void 0:c.renderBoundsDirty);if((i||a)&&(null==r?void 0:r.shapeUpdated)===!1&&n)for(var o=e.length-1;o>=0;){var s,l,u,c,h,d,f,v,p=e[o];if(p.shapeUpdated)break;null===(f=(v=p.node).dirty)||void 0===f||f.call(v,!0,!0),p.shapeUpdated=!0,o-=1;}return i;}},{key:"syncHierarchy",value:function(t){for(var e,n,r=[t],i=t.parentNode?[{node:t.parentNode,transformDirty:(null===(e=t.parentNode.transformable)||void 0===e?void 0:e.localDirtyFlag)||(null===(n=t.parentNode.transformable)||void 0===n?void 0:n.dirtyFlag),shapeUpdated:!1}]:[];r.length>0;){for(var a=r.pop(),o=i[i.length-1];i.length>0&&a.parentNode!==o.node;)o=i.pop();var s=this.internalUpdateElement(a,i);if(a.childNodes.length>0){for(var l=a.childNodes.length-1;l>=0;l--)r.push(a.childNodes[l]);i.push({node:a,transformDirty:s,shapeUpdated:!1});}}}},{key:"dirtyLocalTransform",value:function(t,e){n9(t)||e.localDirtyFlag||(e.localDirtyFlag=!0,e.dirtyFlag||this.dirtyWorldTransform(t,e));}},{key:"dirtyWorldTransform",value:function(t,e){this.dirtifyWorldInternal(t,e),this.dirtyToRoot(t,!0);}},{key:"dirtifyWorldInternal",value:function(t,e){var n,r=this,i=(null===(n=t.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n||null===(n=n.getConfig())||void 0===n||null===(n=n.future)||void 0===n?void 0:n.experimentalAttributeUpdateOptimization)===!0;e.dirtyFlag||(e.dirtyFlag=!0,t.dirty(!0,!0),i||t.childNodes.forEach(function(t){var e=t.transformable;r.dirtifyWorldInternal(t,e);}));}},{key:"dirtyToRoot",value:function(t){for(var e,n,r,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=t,o=(null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig())||void 0===e||null===(e=e.future)||void 0===e?void 0:e.experimentalAttributeUpdateOptimization)===!0;a&&(null===(n=(r=a).dirty)||void 0===n||n.call(r,!0,!0),!o);)a=a.parentNode;i&&t.forEach(function(t){var e;null===(e=t.dirty)||void 0===e||e.call(t,!0,!0);}),this.informDependentDisplayObjects(t),this.pendingEvents.set(t,i);}},{key:"dirtifyFragment",value:function(t){var e,n=t.transformable;n&&(n.dirtyFlag=!0,n.localDirtyFlag=!0),null===(e=t.dirty)||void 0===e||e.call(t,!0,!0);for(var r=t.childNodes.length,i=0;i<r;i++)this.dirtifyFragment(t.childNodes[i]);t.nodeName===K.FRAGMENT&&this.pendingEvents.set(t,!1);}},{key:"triggerPendingEvents",value:function(){var t,e,n=this,r=new Set,i=function(e,i){if(!(!e.isConnected||r.has(e))&&e.nodeName!==K.FRAGMENT){if(n.boundsChangedEvent.detail=i,n.boundsChangedEvent.target=e,e.isMutationObserved)e.dispatchEvent(n.boundsChangedEvent);else{if(void 0===t){var a;t=(null===(a=e.ownerDocument.defaultView)||void 0===a||null===(a=a.getConfig())||void 0===a||null===(a=a.future)||void 0===a?void 0:a.experimentalCancelEventPropagation)===!0;}e.ownerDocument.defaultView.dispatchEvent(n.boundsChangedEvent,!0,t);}r.add(e);}};this.pendingEvents.forEach(function(t,n){if(n.nodeName!==K.FRAGMENT){if(void 0===e){var r;e=(null===(r=n.ownerDocument)||void 0===r||null===(r=r.defaultView)||void 0===r||null===(r=r.getConfig())||void 0===r||null===(r=r.future)||void 0===r?void 0:r.experimentalAttributeUpdateOptimization)===!0;}ii.affectChildren=t,e?i(n,ii):t?n.forEach(function(t){i(t,ii);}):i(n,ii);}}),r.clear(),this.clearPendingEvents();}},{key:"clearPendingEvents",value:function(){this.pendingEvents.clear();}},{key:"updateDisplayObjectDependency",value:function(t,e,n,r){if(e&&e!==n){var i=this.displayObjectDependencyMap.get(e);if(i&&i[t]){var a=i[t].indexOf(r);i[t].splice(a,1);}}if(n){var o=this.displayObjectDependencyMap.get(n);o||(this.displayObjectDependencyMap.set(n,{}),o=this.displayObjectDependencyMap.get(n)),o[t]||(o[t]=[]),o[t].push(r);}}},{key:"informDependentDisplayObjects",value:function(t){var e,n=this,r=this.displayObjectDependencyMap.get(t);if(r){var i=null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig())||void 0===e||null===(e=e.future)||void 0===e?void 0:e.experimentalCancelEventPropagation;Object.keys(r).forEach(function(t){r[t].forEach(function(e){n.dirtyToRoot(e,!0),e.dispatchEvent(new rj(rX.ATTR_MODIFIED,e,n,n,t,rj.MODIFICATION,n,n),i,i),e.isCustomElement&&e.isConnected&&e.attributeChangedCallback&&e.attributeChangedCallback(t,n,n);});});}}}]),io={MetricsString:"|\xc9q\xc5",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},is=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,il=new RegExp("".concat(/[!%),.:;?\]}'""]/.source,"|").concat(/[!),.:;?\]}'""]/.source,"|").concat(/[)\]'"?!:;,.]/.source,"|").concat(/[!%),.:;?\]}'"]/.source)),iu=new RegExp("".concat(/[$('"]/.source,"|").concat(/[([{'"]/.source,"|").concat(/[(['"...]/.source,"|").concat(/[$([{'"#]/.source)),ic=(0,O.default)(function t(e){var n=this;(0,R.default)(this,t),this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(t,e){return!n.isBreakingSpace(e)&&!!(t&&(iu.exec(e)||il.exec(t)));},this.trimByKinsokuShorui=function(t){var e=(0,L.default)(t),n=e[e.length-2];if(!n)return t;var r=n[n.length-1];return e[e.length-2]=n.slice(0,-1),e[e.length-1]=r+e[e.length-1],e;},this.runtime=e;},[{key:"measureFont",value:function(t,e){if(this.fontMetricsCache[t])return this.fontMetricsCache[t];var n={ascent:0,descent:0,fontSize:0},r=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(e),i=this.runtime.offscreenCanvasCreator.getOrCreateContext(e,{willReadFrequently:!0});i.font=t;var a=io.MetricsString+io.BaselineSymbol,o=Math.ceil(i.measureText(a).width),s=Math.ceil(i.measureText(io.BaselineSymbol).width),l=io.HeightMultiplier*s;s=s*io.BaselineMultiplier|0,r.width=o,r.height=l,i.fillStyle="#f00",i.fillRect(0,0,o,l),i.font=t,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(a,0,s);var u=i.getImageData(0,0,o||1,l||1).data,c=u.length,h=4*o,d=0,f=0,v=!1;for(d=0;d<s;++d){for(var p=0;p<h;p+=4)if(255!==u[f+p]){v=!0;break;}if(v)break;f+=h;}for(n.ascent=s-d,f=c-h,v=!1,d=l;d>s;--d){for(var g=0;g<h;g+=4)if(255!==u[f+g]){v=!0;break;}if(v)break;f-=h;}return n.descent=d-s,n.fontSize=n.ascent+n.descent,this.fontMetricsCache[t]=n,n;}},{key:"measureText",value:function(t,e,n){var r=e.fontSize,i=void 0===r?16:r,a=e.wordWrap,o=e.lineHeight,s=e.lineWidth,l=void 0===s?1:s,u=e.textBaseline,c=void 0===u?"alphabetic":u,h=e.textAlign,d=void 0===h?"start":h,f=e.letterSpacing,v=void 0===f?0:f,p=e.textPath;e.textPathSide,e.textPathStartOffset;var g=e.leading,y=void 0===g?0:g,m=function(t){for(var e=t.fontSize,n=void 0===e?16:e,r=t.fontFamily,i=t.fontStyle,a=t.fontVariant,o=t.fontWeight,s=(0,B.isNumber)(n)&&"".concat(n,"px")||"16px",l=(void 0===r?"sans-serif":r).split(","),u=l.length-1;u>=0;u--){var c=l[u].trim();!rv.test(c)&&0>rf.indexOf(c)&&(c='"'.concat(c,'"')),l[u]=c;}return"".concat(void 0===i?"normal":i," ").concat(void 0===a?"normal":a," ").concat(void 0===o?"normal":o," ").concat(s," ").concat(l.join(","));}(e),k=this.measureFont(m,n);0===k.fontSize&&(k.fontSize=i,k.ascent=i);var E=this.runtime.offscreenCanvasCreator.getOrCreateContext(n);E.font=m,e.isOverflowing=!1;var x=(void 0!==a&&a?this.wordWrap(t,e,n):t).split(/(?:\r\n|\r|\n)/),T=Array(x.length),N=0;if(p){p.getTotalLength();for(var b=0;b<x.length;b++)E.measureText(x[b]).width,x[b].length;}else{for(var S=0;S<x.length;S++){var w=E.measureText(x[S]).width+(x[S].length-1)*v;T[S]=w,N=Math.max(N,w);}var P=N+l,M=o||k.fontSize+l,A=Math.max(M,k.fontSize+l)+(x.length-1)*(M+y);M+=y;var C=0;return"middle"===c?C=-A/2:"bottom"===c||"alphabetic"===c||"ideographic"===c?C=-A:("top"===c||"hanging"===c)&&(C=0),{font:m,width:P,height:A,lines:x,lineWidths:T,lineHeight:M,maxLineWidth:N,fontProperties:k,lineMetrics:T.map(function(t,e){var n=0;return"center"===d||"middle"===d?n-=t/2:("right"===d||"end"===d)&&(n-=t),new tu(n-l/2,C+e*M,t+l,M);})};}}},{key:"wordWrap",value:function(t,e,n){var r=this,i=Array.from(t);if(0===i.length)return"";var a=this,o=e.wordWrapWidth,s=e.letterSpacing,l=void 0===s?0:s,u=e.maxLines,c=void 0===u?1/0:u,h=e.textOverflow,d=this.runtime.offscreenCanvasCreator.getOrCreateContext(n),f=(void 0===o?0:o)+l,v="";"ellipsis"===h?v="...":h&&"clip"!==h&&(v=h);var p=[""],g=0,y=0,m=-1,k={},E=function(t){return r.getFromCache(t,l,k,d);},x=E(v);function T(t,e,n,r){for(;E(t)<r&&e<i.length-1&&!a.isNewline(i[e+1]);)e+=1,t+=i[e];for(;E(t)>r&&e>=n;)e-=1,t=t.slice(0,-1);return{lineTxt:t,txtLastCharIndex:e};}function N(t,e){if(!(x<=0)&&!(x>f)){if(!p[t]){p[t]=v;return;}var n=T(p[t],e,m+1,f-x);p[t]=n.lineTxt+v;}}for(var b=0;b<i.length;b++){var S=i[b],w=i[b-1],P=i[b+1],M=E(S);if(this.isNewline(S)){if(g+1>=c){b<i.length-1&&N(g,b-1),e.isOverflowing=!0;break;}m=b-1,y=0,p[g+=1]="";continue;}if(M>f){N(g,b-1),e.isOverflowing=!0;break;}if(y>0&&y+M>f){var A=T(p[g],b-1,m+1,f);if(A.txtLastCharIndex!==b-1){if(p[g]=A.lineTxt,A.txtLastCharIndex===i.length-1)break;S=i[b=A.txtLastCharIndex+1],w=i[b-1],P=i[b+1],M=E(S);}if(g+1>=c){N(g,b-1),e.isOverflowing=!0;break;}if(m=b-1,y=0,p[g+=1]="",this.isBreakingSpace(S))continue;this.canBreakInLastChar(S)||(p=this.trimToBreakable(p),y=this.sumTextWidthByCache(p[g]||"",E)),this.shouldBreakByKinsokuShorui(S,P)&&(p=this.trimByKinsokuShorui(p),y+=E(w||""));}y+=M,p[g]+=S;}return p.join("\n");}},{key:"isBreakingSpace",value:function(t){return"string"==typeof t&&io.BreakingSpaces.indexOf(t.charCodeAt(0))>=0;}},{key:"isNewline",value:function(t){return"string"==typeof t&&io.Newlines.indexOf(t.charCodeAt(0))>=0;}},{key:"trimToBreakable",value:function(t){var e=(0,L.default)(t),n=e[e.length-2],r=this.findBreakableIndex(n);if(-1===r||!n)return e;var i=n.slice(r,r+1),a=this.isBreakingSpace(i);return e[e.length-1]+=n.slice(r+1,n.length),e[e.length-2]=n.slice(0,r+(a?0:1)),e;}},{key:"canBreakInLastChar",value:function(t){return!(t&&is.test(t));}},{key:"sumTextWidthByCache",value:function(t,e){return t.split("").reduce(function(t,n){return t+e(n);},0);}},{key:"findBreakableIndex",value:function(t){for(var e=t.length-1;e>=0;e--)if(!is.test(t[e]))return e;return -1;}},{key:"getFromCache",value:function(t,e,n,r){var i=n[t];if("number"!=typeof i){var a=t.length*e;i=r.measureText(t).width+a,n[t]=i;}return i;}}]),ih={},id=(N=new rC,b=new rA,T={},(0,U.default)((0,U.default)((0,U.default)((0,U.default)((0,U.default)((0,U.default)((0,U.default)((0,U.default)((0,U.default)((0,U.default)(T,K.FRAGMENT,null),K.CIRCLE,new rS),K.ELLIPSE,new rw),K.RECT,N),K.IMAGE,N),K.GROUP,new rO),K.LINE,new rP),K.TEXT,new rR(ih)),K.POLYLINE,b),K.POLYGON,b),(0,U.default)((0,U.default)((0,U.default)(T,K.PATH,new rM),K.HTML,new rL),K.MESH,null)),iv=(w=new nV,P=new nY,S={},(0,U.default)((0,U.default)((0,U.default)((0,U.default)((0,U.default)((0,U.default)((0,U.default)((0,U.default)((0,U.default)((0,U.default)(S,tB.PERCENTAGE,null),tB.NUMBER,new nj),tB.ANGLE,new nB),tB.DEFINED_PATH,new nU),tB.PAINT,w),tB.COLOR,w),tB.FILTER,new nz),tB.LENGTH,P),tB.LENGTH_PERCENTAGE,P),tB.LENGTH_PERCENTAGE_12,new nW),(0,U.default)((0,U.default)((0,U.default)((0,U.default)((0,U.default)((0,U.default)((0,U.default)((0,U.default)((0,U.default)((0,U.default)(S,tB.LENGTH_PERCENTAGE_14,new nq),tB.COORDINATE,new nY),tB.OFFSET_DISTANCE,new n$),tB.OPACITY_VALUE,new nK),tB.PATH,new nZ),tB.LIST_OF_POINTS,new nQ),tB.SHADOW_BLUR,new nJ),tB.TEXT,new n0),tB.TEXT_TRANSFORM,new n1),tB.TRANSFORM,new rT),(0,U.default)((0,U.default)((0,U.default)(S,tB.TRANSFORM_ORIGIN,new rN),tB.Z_INDEX,new rb),tB.MARKER,new nX));ih.CameraContribution=tR,ih.AnimationTimeline=null,ih.EasingFunction=null,ih.offscreenCanvasCreator=new rz,ih.sceneGraphSelector=new rq,ih.sceneGraphService=new ia(ih),ih.textService=new ic(ih),ih.geometryUpdaterFactory=id,ih.CSSPropertySyntaxFactory=iv,ih.styleValueRegistry=new nG(ih),ih.layoutRegistry=null,ih.globalThis="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==X?X:{},ih.enableStyleSyntax=!0,ih.enableSizeAttenuation=!1;var ip=0,ig=new rj(rX.INSERTED,null,"","","",0,"",""),iy=new rj(rX.REMOVED,null,"","","",0,"",""),im=new rF(rX.DESTROY),ik=function(t){function e(){var t;(0,R.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,I.default)(this,e,[].concat(r))).entity=ip++,t.transformable={dirtyFlag:!1,localDirtyFlag:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},t.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},t.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},t.cullable={strategy:tO.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},t.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},t.rBushNode={aabb:void 0},t.namespaceURI="g",t.scrollLeft=0,t.scrollTop=0,t.clientTop=0,t.clientLeft=0,t.style={},t.computedStyle={},t.parsedStyle={},t.attributes={},t;}return(0,D.default)(e,t),(0,O.default)(e,[{key:"dirty",value:function(){var t=!(arguments.length>0)||void 0===arguments[0]||arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.renderable.dirty=t,e&&(this.renderable.boundsDirty=t,this.renderable.renderBoundsDirty=t);}},{key:"className",get:function(){return this.getAttribute("class")||"";},set:function(t){this.setAttribute("class",t);}},{key:"classList",get:function(){return this.className.split(" ").filter(function(t){return""!==t;});}},{key:"tagName",get:function(){return this.nodeName;}},{key:"children",get:function(){return this.childNodes;}},{key:"childElementCount",get:function(){return this.childNodes.length;}},{key:"firstElementChild",get:function(){return this.firstChild;}},{key:"lastElementChild",get:function(){return this.lastChild;}},{key:"parentElement",get:function(){return this.parentNode;}},{key:"nextSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t+1]||null;}return null;}},{key:"previousSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t-1]||null;}return null;}},{key:"cloneNode",value:function(t){throw Error(tc);}},{key:"appendChild",value:function(t,e){var n;if(t.destroyed)throw Error("Cannot append a destroyed element.");return ih.sceneGraphService.attach(t,this,e),null!==(n=this.ownerDocument)&&void 0!==n&&n.defaultView&&(n9(this)||t.nodeName!==K.FRAGMENT?this.ownerDocument.defaultView.mountChildren(t):this.ownerDocument.defaultView.mountFragment(t)),this.isMutationObserved&&(ig.relatedNode=this,t.dispatchEvent(ig)),t;}},{key:"insertBefore",value:function(t,e){if(e){t.parentElement&&t.parentElement.removeChild(t);var n=this.childNodes.indexOf(e);-1===n?this.appendChild(t):this.appendChild(t,n);}else this.appendChild(t);return t;}},{key:"replaceChild",value:function(t,e){var n=this.childNodes.indexOf(e);return this.removeChild(e),this.appendChild(t,n),e;}},{key:"removeChild",value:function(t){var e,n,r=(null===(e=this.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig().future)||void 0===e?void 0:e.experimentalCancelEventPropagation)===!0;return iy.relatedNode=this,t.dispatchEvent(iy,r,r),null!==(n=t.ownerDocument)&&void 0!==n&&n.defaultView&&t.ownerDocument.defaultView.unmountChildren(t),ih.sceneGraphService.detach(t),t;}},{key:"removeChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var e=this.childNodes[t];this.removeChild(e);}}},{key:"destroyChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var e=this.childNodes[t];e.childNodes.length>0&&e.destroyChildren(),e.destroy();}}},{key:"matches",value:function(t){return ih.sceneGraphService.matches(t,this);}},{key:"getElementById",value:function(t){return ih.sceneGraphService.querySelector("#".concat(t),this);}},{key:"getElementsByName",value:function(t){return ih.sceneGraphService.querySelectorAll('[name="'.concat(t,'"]'),this);}},{key:"getElementsByClassName",value:function(t){return ih.sceneGraphService.querySelectorAll(".".concat(t),this);}},{key:"getElementsByTagName",value:function(t){return ih.sceneGraphService.querySelectorAll(t,this);}},{key:"querySelector",value:function(t){return ih.sceneGraphService.querySelector(t,this);}},{key:"querySelectorAll",value:function(t){return ih.sceneGraphService.querySelectorAll(t,this);}},{key:"closest",value:function(t){var e=this;do{if(ih.sceneGraphService.matches(t,e))return e;e=e.parentElement;}while(null!==e)return null;}},{key:"find",value:function(t){var e=this,n=null;return this.forEach(function(r){return!(r!==e&&t(r))||(n=r,!1);}),n;}},{key:"findAll",value:function(t){var e=this,n=[];return this.forEach(function(r){r!==e&&t(r)&&n.push(r);}),n;}},{key:"after",value:function(){var t=this;if(this.parentNode){for(var e=this.parentNode.childNodes.indexOf(this),n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];r.forEach(function(n,r){var i;return null===(i=t.parentNode)||void 0===i?void 0:i.appendChild(n,e+r+1);});}}},{key:"before",value:function(){if(this.parentNode){for(var t=this.parentNode.childNodes.indexOf(this),e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n[0],a=n.slice(1);this.parentNode.appendChild(i,t),i.after.apply(i,(0,L.default)(a));}}},{key:"replaceWith",value:function(){this.after.apply(this,arguments),this.remove();}},{key:"append",value:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(function(e){return t.appendChild(e);});}},{key:"prepend",value:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(function(e,n){return t.appendChild(e,n);});}},{key:"replaceChildren",value:function(){for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,arguments);}},{key:"remove",value:function(){return this.parentNode?this.parentNode.removeChild(this):this;}},{key:"destroy",value:function(){var t,e=(null===(t=this.ownerDocument)||void 0===t||null===(t=t.defaultView)||void 0===t||null===(t=t.getConfig().future)||void 0===t?void 0:t.experimentalCancelEventPropagation)===!0;this.destroyChildren(),this.dispatchEvent(im,e,e),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0;}},{key:"getGeometryBounds",value:function(){return ih.sceneGraphService.getGeometryBounds(this);}},{key:"getRenderBounds",value:function(){return ih.sceneGraphService.getBounds(this,!0);}},{key:"getBounds",value:function(){return ih.sceneGraphService.getBounds(this);}},{key:"getLocalBounds",value:function(){return ih.sceneGraphService.getLocalBounds(this);}},{key:"getBoundingClientRect",value:function(){return ih.sceneGraphService.getBoundingClientRect(this);}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()];}},{key:"computedStyleMap",value:function(){return new Map(Object.entries(this.computedStyle));}},{key:"getAttributeNames",value:function(){return Object.keys(this.attributes);}},{key:"getAttribute",value:function(t){if("symbol"!=typeof t)return this.attributes[t];}},{key:"hasAttribute",value:function(t){return this.getAttributeNames().includes(t);}},{key:"hasAttributes",value:function(){return!!this.getAttributeNames().length;}},{key:"removeAttribute",value:function(t){this.setAttribute(t,null),delete this.attributes[t];}},{key:"setAttribute",value:function(t,e,n,r){this.attributes[t]=e;}},{key:"getAttributeNS",value:function(t,e){throw Error(tc);}},{key:"getAttributeNode",value:function(t){throw Error(tc);}},{key:"getAttributeNodeNS",value:function(t,e){throw Error(tc);}},{key:"hasAttributeNS",value:function(t,e){throw Error(tc);}},{key:"removeAttributeNS",value:function(t,e){throw Error(tc);}},{key:"removeAttributeNode",value:function(t){throw Error(tc);}},{key:"setAttributeNS",value:function(t,e,n){throw Error(tc);}},{key:"setAttributeNode",value:function(t){throw Error(tc);}},{key:"setAttributeNodeNS",value:function(t){throw Error(tc);}},{key:"toggleAttribute",value:function(t,e){throw Error(tc);}}]);}(rU);function iE(t){return!!(null!=t&&t.nodeName);}var ix=ih.globalThis.Proxy?ih.globalThis.Proxy:function(){},iT=new rj(rX.ATTR_MODIFIED,null,null,null,null,rj.MODIFICATION,null,null),iN=F.vec3.create(),ib=F.quat.create(),iS=function(t){function e(t){var n;return(0,R.default)(this,e),(n=(0,I.default)(this,e)).isCustomElement=!1,n.isMutationObserved=!1,n.activeAnimations=[],n.config=t,n.id=t.id||"",n.name=t.name||"",(t.className||t.class)&&(n.className=t.className||t.class),n.nodeName=t.type||K.GROUP,t.initialParsedStyle&&Object.assign(n.parsedStyle,t.initialParsedStyle),n.initAttributes(t.style),ih.enableStyleSyntax&&(n.style=new ix({setProperty:function(t,e){n.setAttribute(t,e);},getPropertyValue:function(t){return n.getAttribute(t);},removeProperty:function(t){n.removeAttribute(t);},item:function(){return"";}},{get:function(t,e){return void 0!==t[e]?t[e]:n.getAttribute(e);},set:function(t,e,r){return n.setAttribute(e,r),!0;}})),n;}return(0,D.default)(e,t),(0,O.default)(e,[{key:"destroy",value:function(){(0,V.default)(e,"destroy",this,3)([]),this.getAnimations().forEach(function(t){t.cancel();});}},{key:"cloneNode",value:function(t,e){var n=(0,C.default)({},this.attributes);for(var r in n){var i=n[r];iE(i)&&"clipPath"!==r&&"offsetPath"!==r&&"textPath"!==r&&(n[r]=i.cloneNode(t)),e&&(n[r]=e(r,i));}var a=new this.constructor((0,C.default)((0,C.default)({},this.config),{},{style:n}));return a.setLocalTransform(this.getLocalTransform()),t&&this.children.forEach(function(e){if(!e.style.isMarker){var n=e.cloneNode(t);a.appendChild(n);}}),a;}},{key:"initAttributes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ih.styleValueRegistry.processProperties(this,t,{forceUpdateGeometry:!0}),this.dirty();}},{key:"setAttribute",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!(arguments.length>3)||void 0===arguments[3]||arguments[3];!(0,B.isUndefined)(n)&&(r||n!==this.attributes[t])&&(this.internalSetAttribute(t,n,{memoize:i}),(0,V.default)(e,"setAttribute",this,3)([t,n]));}},{key:"internalSetAttribute",value:function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.attributes[t],a=this.parsedStyle[t];ih.styleValueRegistry.processProperties(this,(0,U.default)({},t,e),r),this.dirty();var o=this.parsedStyle[t];if(this.isConnected){if(iT.relatedNode=this,iT.prevValue=i,iT.newValue=e,iT.attrName=t,iT.prevParsedValue=a,iT.newParsedValue=o,this.isMutationObserved)this.dispatchEvent(iT);else{var s,l=(null===(s=this.ownerDocument.defaultView.getConfig().future)||void 0===s?void 0:s.experimentalCancelEventPropagation)===!0;iT.target=this,this.ownerDocument.defaultView.dispatchEvent(iT,!0,l);}}(this.isCustomElement&&this.isConnected||!this.isCustomElement)&&(null===(n=this.attributeChangedCallback)||void 0===n||n.call(this,t,i,e,a,o));}},{key:"getBBox",value:function(){var t=this.getBounds(),e=t.getMin(),n=(0,_.default)(e,2),r=n[0],i=n[1],a=t.getMax(),o=(0,_.default)(a,2);return new tu(r,i,o[0]-r,o[1]-i);}},{key:"setOrigin",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ih.sceneGraphService.setOrigin(this,tv(t,e,n,!1)),this;}},{key:"getOrigin",value:function(){return ih.sceneGraphService.getOrigin(this);}},{key:"setPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ih.sceneGraphService.setPosition(this,tv(t,e,n,!1)),this;}},{key:"setLocalPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ih.sceneGraphService.setLocalPosition(this,tv(t,e,n,!1)),this;}},{key:"translate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ih.sceneGraphService.translate(this,tv(t,e,n,!1)),this;}},{key:"translateLocal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ih.sceneGraphService.translateLocal(this,tv(t,e,n,!1)),this;}},{key:"getPosition",value:function(){return ih.sceneGraphService.getPosition(this);}},{key:"getLocalPosition",value:function(){return ih.sceneGraphService.getLocalPosition(this);}},{key:"scale",value:function(t,e,n){return this.scaleLocal(t,e,n);}},{key:"scaleLocal",value:function(t,e,n){return"number"==typeof t&&(e=e||t,n=n||t,t=tv(t,e,n,!1)),ih.sceneGraphService.scaleLocal(this,t),this;}},{key:"setLocalScale",value:function(t,e,n){return"number"==typeof t&&(e=e||t,n=n||t,t=tv(t,e,n,!1)),ih.sceneGraphService.setLocalScale(this,t),this;}},{key:"getLocalScale",value:function(){return ih.sceneGraphService.getLocalScale(this);}},{key:"getScale",value:function(){return ih.sceneGraphService.getScale(this);}},{key:"getEulerAngles",value:function(){var t=tk(iN,ih.sceneGraphService.getWorldTransform(this));return(0,_.default)(t,3)[2]*ty;}},{key:"getLocalEulerAngles",value:function(){var t=tk(iN,ih.sceneGraphService.getLocalRotation(this));return(0,_.default)(t,3)[2]*ty;}},{key:"setEulerAngles",value:function(t){return ih.sceneGraphService.setEulerAngles(this,0,0,t),this;}},{key:"setLocalEulerAngles",value:function(t){return ih.sceneGraphService.setLocalEulerAngles(this,0,0,t),this;}},{key:"rotateLocal",value:function(t,e,n){return(0,B.isNil)(e)&&(0,B.isNil)(n)?ih.sceneGraphService.rotateLocal(this,0,0,t):ih.sceneGraphService.rotateLocal(this,t,e,n),this;}},{key:"rotate",value:function(t,e,n){return(0,B.isNil)(e)&&(0,B.isNil)(n)?ih.sceneGraphService.rotate(this,0,0,t):ih.sceneGraphService.rotate(this,t,e,n),this;}},{key:"setRotation",value:function(t,e,n,r){return ih.sceneGraphService.setRotation(this,t,e,n,r),this;}},{key:"setLocalRotation",value:function(t,e,n,r){return ih.sceneGraphService.setLocalRotation(this,t,e,n,r),this;}},{key:"setLocalSkew",value:function(t,e){return ih.sceneGraphService.setLocalSkew(this,t,e),this;}},{key:"getRotation",value:function(){return ih.sceneGraphService.getRotation(this);}},{key:"getLocalRotation",value:function(){return ih.sceneGraphService.getLocalRotation(this);}},{key:"getLocalSkew",value:function(){return ih.sceneGraphService.getLocalSkew(this);}},{key:"getLocalTransform",value:function(){return ih.sceneGraphService.getLocalTransform(this);}},{key:"getWorldTransform",value:function(){return ih.sceneGraphService.getWorldTransform(this);}},{key:"setLocalTransform",value:function(t){return ih.sceneGraphService.setLocalTransform(this,t),this;}},{key:"resetLocalTransform",value:function(){ih.sceneGraphService.resetLocalTransform(this);}},{key:"getAnimations",value:function(){return this.activeAnimations;}},{key:"animate",value:function(t,e){var n,r=null===(n=this.ownerDocument)||void 0===n?void 0:n.timeline;return r?r.play(this,t,e):null;}},{key:"isVisible",value:function(){var t;return(null===(t=this.parsedStyle)||void 0===t?void 0:t.visibility)!=="hidden";}},{key:"interactive",get:function(){return this.isInteractive();},set:function(t){this.style.pointerEvents=t?"auto":"none";}},{key:"isInteractive",value:function(){var t;return(null===(t=this.parsedStyle)||void 0===t?void 0:t.pointerEvents)!=="none";}},{key:"isCulled",value:function(){return!!(this.cullable&&this.cullable.enable&&!this.cullable.visible);}},{key:"toFront",value:function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,(0,L.default)(this.parentNode.children.map(function(t){return Number(t.style.zIndex);})))+1),this;}},{key:"toBack",value:function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,(0,L.default)(this.parentNode.children.map(function(t){return Number(t.style.zIndex);})))-1),this;}},{key:"getConfig",value:function(){return this.config;}},{key:"attr",value:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n[0],a=n[1];return i?(0,B.isObject)(i)?(Object.keys(i).forEach(function(e){t.setAttribute(e,i[e]);}),this):2===n.length?(this.setAttribute(i,a),this):this.attributes[i]:this.attributes;}},{key:"getMatrix",value:function(t){var e,n,r,i=t||this.getWorldTransform(),a=F.mat4.getTranslation(iN,i),o=(0,_.default)(a,2),s=o[0],l=o[1],u=F.mat4.getScaling(iN,i),c=(0,_.default)(u,2),h=c[0],d=c[1],f=tk(iN,F.mat4.getRotation(ib,i)),v=(0,_.default)(f,3),p=v[0],g=v[2];return n=Math.cos(e=p||g),r=Math.sin(e),F.mat3.fromValues(h*n,d*r,0,-h*r,d*n,0,s,l,1);}},{key:"getLocalMatrix",value:function(){return this.getMatrix(this.getLocalTransform());}},{key:"setMatrix",value:function(t){var e=tE(t),n=(0,_.default)(e,5),r=n[0],i=n[1],a=n[2],o=n[3],s=n[4];this.setEulerAngles(s).setPosition(r,i).setLocalScale(a,o);}},{key:"setLocalMatrix",value:function(t){var e=tE(t),n=(0,_.default)(e,5),r=n[0],i=n[1],a=n[2],o=n[3],s=n[4];this.setLocalEulerAngles(s).setLocalPosition(r,i).setLocalScale(a,o);}},{key:"show",value:function(){this.forEach(function(t){t.style.visibility="visible";});}},{key:"hide",value:function(){this.forEach(function(t){t.style.visibility="hidden";});}},{key:"getCount",value:function(){return this.childElementCount;}},{key:"getParent",value:function(){return this.parentElement;}},{key:"getChildren",value:function(){return this.children;}},{key:"getFirst",value:function(){return this.firstElementChild;}},{key:"getLast",value:function(){return this.lastElementChild;}},{key:"getChildByIndex",value:function(t){return this.children[t]||null;}},{key:"add",value:function(t,e){return this.appendChild(t,e);}},{key:"set",value:function(t,e){this.config[t]=e;}},{key:"get",value:function(t){return this.config[t];}},{key:"moveTo",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(t,e,n),this;}},{key:"move",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(t,e,n),this;}},{key:"setZIndex",value:function(t){return this.style.zIndex=t,this;}}]);}(ik);iS.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","display","draggable","droppable","fill","fillOpacity","fillRule","filter","increasedLineWidthForHitTesting","lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit","hitArea","offsetDistance","offsetPath","offsetX","offsetY","opacity","pointerEvents","shadowColor","shadowType","shadowBlur","shadowOffsetX","shadowOffsetY","stroke","strokeOpacity","strokeWidth","strokeLinecap","strokeLineJoin","strokeDasharray","strokeDashoffset","transform","transformOrigin","textTransform","visibility","zIndex"]);var iw=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,R.default)(this,e),(0,I.default)(this,e,[(0,C.default)({type:K.CIRCLE},t)]);}return(0,D.default)(e,t),(0,O.default)(e);}(iS);iw.PARSED_STYLE_LIST=new Set([].concat((0,L.default)(iS.PARSED_STYLE_LIST),["cx","cy","cz","r","isBillboard","isSizeAttenuation"]));var iP=["style"],iM=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iP);return(0,R.default)(this,e),(t=(0,I.default)(this,e,[(0,C.default)({style:r},i)])).isCustomElement=!0,t;}return(0,D.default)(e,t),(0,O.default)(e);}(iS);iM.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var iA=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,R.default)(this,e),(0,I.default)(this,e,[(0,C.default)({type:K.ELLIPSE},t)]);}return(0,D.default)(e,t),(0,O.default)(e);}(iS);iA.PARSED_STYLE_LIST=new Set([].concat((0,L.default)(iS.PARSED_STYLE_LIST),["cx","cy","cz","rx","ry","isBillboard","isSizeAttenuation"])),function(t){function e(){return(0,R.default)(this,e),(0,I.default)(this,e,[{type:K.FRAGMENT}]);}return(0,D.default)(e,t),(0,O.default)(e);}(iS).PARSED_STYLE_LIST=new Set(["class","className"]);var iC=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,R.default)(this,e),(0,I.default)(this,e,[(0,C.default)({type:K.GROUP},t)]);}return(0,D.default)(e,t),(0,O.default)(e);}(iS);iC.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var iR=["style"],iO=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iR);return(0,R.default)(this,e),(t=(0,I.default)(this,e,[(0,C.default)({type:K.HTML,style:r},i)])).cullable.enable=!1,t;}return(0,D.default)(e,t),(0,O.default)(e,[{key:"getDomElement",value:function(){return this.parsedStyle.$el;}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()];}},{key:"getLocalBounds",value:function(){if(this.parentNode){var t=F.mat4.invert(F.mat4.create(),this.parentNode.getWorldTransform()),e=this.getBounds();if(!ti.isEmpty(e)){var n=new ti;return n.setFromTransformedAABB(e,t),n;}}return this.getBounds();}}]);}(iS);iO.PARSED_STYLE_LIST=new Set([].concat((0,L.default)(iS.PARSED_STYLE_LIST),["x","y","$el","innerHTML","width","height"]));var iL=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,R.default)(this,e),(0,I.default)(this,e,[(0,C.default)({type:K.IMAGE},t)]);}return(0,D.default)(e,t),(0,O.default)(e);}(iS);iL.PARSED_STYLE_LIST=new Set([].concat((0,L.default)(iS.PARSED_STYLE_LIST),["x","y","z","src","width","height","isBillboard","billboardRotation","isSizeAttenuation","keepAspectRatio"]));var iI=["style"],iD=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iI);(0,R.default)(this,e),(t=(0,I.default)(this,e,[(0,C.default)({type:K.LINE,style:(0,C.default)({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},r)},i)])).markerStartAngle=0,t.markerEndAngle=0;var a=t.parsedStyle,o=a.markerStart,s=a.markerEnd;return o&&iE(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),s&&iE(s)&&(t.markerEndAngle=s.getLocalEulerAngles(),t.appendChild(s)),t.transformMarker(!0),t.transformMarker(!1),t;}return(0,D.default)(e,t),(0,O.default)(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"x1"===t||"y1"===t||"x2"===t||"y2"===t||"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&iE(r)&&(this.markerStartAngle=0,r.remove()),i&&iE(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t&&(r&&iE(r)&&(this.markerEndAngle=0,r.remove()),i&&iE(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1)));}},{key:"transformMarker",value:function(t){var e,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,h=s.markerEndOffset,d=s.x1,f=s.x2,v=s.y1,p=s.y2,g=t?l:u;if(g&&iE(g)){var y=0;t?(r=d,i=v,e=f-d,n=p-v,a=c||0,o=this.markerStartAngle):(r=f,i=p,e=d-f,n=v-p,a=h||0,o=this.markerEndAngle),y=Math.atan2(n,e),g.setLocalEulerAngles(180*y/Math.PI+o),g.setLocalPosition(r+Math.cos(y)*a,i+Math.sin(y)*a);}}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle,r=n.x1,i=n.y1,a=n.x2,o=n.y2,s=(0,z.linePointAt)(r,i,a,o,t),l=s.x,u=s.y,c=F.vec3.transformMat4(F.vec3.create(),F.vec3.fromValues(l,u,0),e?this.getWorldTransform():this.getLocalTransform());return new tl(c[0],c[1]);}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(t/this.getTotalLength(),e);}},{key:"getTotalLength",value:function(){var t=this.parsedStyle,e=t.x1,n=t.y1,r=t.x2,i=t.y2;return(0,z.lineLength)(e,n,r,i);}}]);}(iS);iD.PARSED_STYLE_LIST=new Set([].concat((0,L.default)(iS.PARSED_STYLE_LIST),["x1","y1","x2","y2","z1","z2","isBillboard","isSizeAttenuation","markerStart","markerEnd","markerStartOffset","markerEndOffset"]));var i_=["style"],iG=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,i_);(0,R.default)(this,e),(t=(0,I.default)(this,e,[(0,C.default)({type:K.PATH,style:r,initialParsedStyle:{miterLimit:4,d:(0,C.default)({},tF)}},i)])).markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var a=t.parsedStyle,o=a.markerStart,s=a.markerEnd,l=a.markerMid;return o&&iE(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),l&&iE(l)&&t.placeMarkerMid(l),s&&iE(s)&&(t.markerEndAngle=s.getLocalEulerAngles(),t.appendChild(s)),t.transformMarker(!0),t.transformMarker(!1),t;}return(0,D.default)(e,t),(0,O.default)(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"d"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&iE(r)&&(this.markerStartAngle=0,r.remove()),i&&iE(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t?(r&&iE(r)&&(this.markerEndAngle=0,r.remove()),i&&iE(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(i);}},{key:"transformMarker",value:function(t){var e,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,h=s.markerEndOffset,d=t?l:u;if(d&&iE(d)){var f=0;if(t){var v=this.getStartTangent(),p=(0,_.default)(v,2),g=p[0],y=p[1];r=y[0],i=y[1],e=g[0]-y[0],n=g[1]-y[1],a=c||0,o=this.markerStartAngle;}else{var m=this.getEndTangent(),k=(0,_.default)(m,2),E=k[0],x=k[1];r=x[0],i=x[1],e=E[0]-x[0],n=E[1]-x[1],a=h||0,o=this.markerEndAngle;}f=Math.atan2(n,e),d.setLocalEulerAngles(180*f/Math.PI+o),d.setLocalPosition(r+Math.cos(f)*a,i+Math.sin(f)*a);}}},{key:"placeMarkerMid",value:function(t){var e=this.parsedStyle.d.segments;if(this.markerMidList.forEach(function(t){t.remove();}),t&&iE(t))for(var n=1;n<e.length-1;n++){var r=(0,_.default)(e[n].currentPoint,2),i=r[0],a=r[1],o=1===n?t:t.cloneNode(!0);this.markerMidList.push(o),this.appendChild(o),o.setLocalPosition(i,a);}}},{key:"getTotalLength",value:function(){return nt(this);}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle.d.absolutePath,r=(0,B.getPointAtLength)(n,t),i=r.x,a=r.y,o=F.vec3.transformMat4(F.vec3.create(),F.vec3.fromValues(i,a,0),e?this.getWorldTransform():this.getLocalTransform());return new tl(o[0],o[1]);}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPointAtLength(t*nt(this),e);}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.d.segments,e=[];if(t.length>1){var n=t[0].currentPoint,r=t[1].currentPoint,i=t[1].startTangent;e=[],i?e.push([n[0]-i[0],n[1]-i[1]]):e.push([r[0],r[1]]),e.push([n[0],n[1]]);}return e;}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.d.segments,e=t.length,n=[];if(e>1){var r=t[e-2].currentPoint,i=t[e-1].currentPoint,a=t[e-1].endTangent;n=[],a?n.push([i[0]-a[0],i[1]-a[1]]):n.push([r[0],r[1]]),n.push([i[0],i[1]]);}return n;}}]);}(iS);iG.PARSED_STYLE_LIST=new Set([].concat((0,L.default)(iS.PARSED_STYLE_LIST),["d","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard","isSizeAttenuation"]));var iF=["style"],iB=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iF);(0,R.default)(this,e),(t=(0,I.default)(this,e,[(0,C.default)({type:K.POLYGON,style:r,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},i)])).markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var a=t.parsedStyle,o=a.markerStart,s=a.markerEnd,l=a.markerMid;return o&&iE(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),l&&iE(l)&&t.placeMarkerMid(l),s&&iE(s)&&(t.markerEndAngle=s.getLocalEulerAngles(),t.appendChild(s)),t.transformMarker(!0),t.transformMarker(!1),t;}return(0,D.default)(e,t),(0,O.default)(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"points"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&iE(r)&&(this.markerStartAngle=0,r.remove()),i&&iE(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t?(r&&iE(r)&&(this.markerEndAngle=0,r.remove()),i&&iE(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(i);}},{key:"transformMarker",value:function(t){var e,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,h=s.markerEndOffset,d=(s.points||{}).points,f=t?l:u;if(f&&iE(f)&&d){var v=0;if(r=d[0][0],i=d[0][1],t)e=d[1][0]-d[0][0],n=d[1][1]-d[0][1],a=c||0,o=this.markerStartAngle;else{var p=d.length;this.parsedStyle.isClosed?(e=d[p-1][0]-d[0][0],n=d[p-1][1]-d[0][1]):(r=d[p-1][0],i=d[p-1][1],e=d[p-2][0]-d[p-1][0],n=d[p-2][1]-d[p-1][1]),a=h||0,o=this.markerEndAngle;}v=Math.atan2(n,e),f.setLocalEulerAngles(180*v/Math.PI+o),f.setLocalPosition(r+Math.cos(v)*a,i+Math.sin(v)*a);}}},{key:"placeMarkerMid",value:function(t){var e=(this.parsedStyle.points||{}).points;if(this.markerMidList.forEach(function(t){t.remove();}),this.markerMidList=[],t&&iE(t)&&e)for(var n=1;n<(this.parsedStyle.isClosed?e.length:e.length-1);n++){var r=e[n][0],i=e[n][1],a=1===n?t:t.cloneNode(!0);this.markerMidList.push(a),this.appendChild(a),a.setLocalPosition(r,i);}}}]);}(iS);iB.PARSED_STYLE_LIST=new Set([].concat((0,L.default)(iS.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isClosed","isBillboard","isSizeAttenuation"]));var iU=["style"],iV=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.style,r=(0,q.default)(t,iU);return(0,R.default)(this,e),(0,I.default)(this,e,[(0,C.default)({type:K.POLYLINE,style:n,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},r)]);}return(0,D.default)(e,t),(0,O.default)(e,[{key:"getTotalLength",value:function(){return 0===this.parsedStyle.points.totalLength&&(this.parsedStyle.points.totalLength=(0,z.polylineLength)(this.parsedStyle.points.points)),this.parsedStyle.points.totalLength;}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(t/this.getTotalLength(),e);}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle.points.points;if(0===this.parsedStyle.points.segments.length){var r,i,a=[],o=0,s=this.getTotalLength();n.forEach(function(t,e){n[e+1]&&((r=[0,0])[0]=o/s,i=(0,z.lineLength)(t[0],t[1],n[e+1][0],n[e+1][1]),o+=i,r[1]=o/s,a.push(r));}),this.parsedStyle.points.segments=a;}var l=0,u=0;this.parsedStyle.points.segments.forEach(function(e,n){t>=e[0]&&t<=e[1]&&(l=(t-e[0])/(e[1]-e[0]),u=n);});var c=(0,z.linePointAt)(n[u][0],n[u][1],n[u+1][0],n[u+1][1],l),h=c.x,d=c.y,f=F.vec3.transformMat4(F.vec3.create(),F.vec3.fromValues(h,d,0),e?this.getWorldTransform():this.getLocalTransform());return new tl(f[0],f[1]);}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.points.points,e=[];return e.push([t[1][0],t[1][1]]),e.push([t[0][0],t[0][1]]),e;}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.points.points,e=t.length-1,n=[];return n.push([t[e-1][0],t[e-1][1]]),n.push([t[e][0],t[e][1]]),n;}}]);}(iB);iV.PARSED_STYLE_LIST=new Set([].concat((0,L.default)(iB.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard"]));var iz=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,R.default)(this,e),(0,I.default)(this,e,[(0,C.default)({type:K.RECT},t)]);}return(0,D.default)(e,t),(0,O.default)(e);}(iS);iz.PARSED_STYLE_LIST=new Set([].concat((0,L.default)(iS.PARSED_STYLE_LIST),["x","y","z","width","height","isBillboard","isSizeAttenuation","radius"]));var iH=["style"],iY=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.style,r=(0,q.default)(t,iH);return(0,R.default)(this,e),(0,I.default)(this,e,[(0,C.default)({type:K.TEXT,style:(0,C.default)({fill:"black"},n)},r)]);}return(0,D.default)(e,t),(0,O.default)(e,[{key:"getComputedTextLength",value:function(){var t;return this.getGeometryBounds(),(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.maxLineWidth)||0;}},{key:"getLineBoundingRects",value:function(){var t;return this.getGeometryBounds(),(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.lineMetrics)||[];}},{key:"isOverflowing",value:function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing;}}]);}(iS);iY.PARSED_STYLE_LIST=new Set([].concat((0,L.default)(iS.PARSED_STYLE_LIST),["x","y","z","isBillboard","billboardRotation","isSizeAttenuation","text","textAlign","textBaseline","fontStyle","fontSize","fontFamily","fontWeight","fontVariant","lineHeight","letterSpacing","leading","wordWrap","wordWrapWidth","maxLines","textOverflow","isOverflowing","textPath","textDecorationLine","textDecorationColor","textDecorationStyle","textPathSide","textPathStartOffset","metrics","dx","dy"]));var iW=(0,O.default)(function t(){(0,R.default)(this,t),this.registry={},this.define(K.CIRCLE,iw),this.define(K.ELLIPSE,iA),this.define(K.RECT,iz),this.define(K.IMAGE,iL),this.define(K.LINE,iD),this.define(K.GROUP,iC),this.define(K.PATH,iG),this.define(K.POLYGON,iB),this.define(K.POLYLINE,iV),this.define(K.TEXT,iY),this.define(K.HTML,iO);},[{key:"define",value:function(t,e){this.registry[t]=e;}},{key:"get",value:function(t){return this.registry[t];}}]),iq={number:function(t){return new eS(t);},percent:function(t){return new eS(t,"%");},px:function(t){return new eS(t,"px");},em:function(t){return new eS(t,"em");},rem:function(t){return new eS(t,"rem");},deg:function(t){return new eS(t,"deg");},grad:function(t){return new eS(t,"grad");},rad:function(t){return new eS(t,"rad");},turn:function(t){return new eS(t,"turn");},s:function(t){return new eS(t,"s");},ms:function(t){return new eS(t,"ms");},registerProperty:function(t){var e=t.name,n=t.inherits,r=t.interpolable,i=t.initialValue,a=t.syntax;ih.styleValueRegistry.registerMetadata({n:e,inh:n,int:r,d:i,syntax:a});},registerLayout:function(t,e){ih.layoutRegistry.registerLayout(t,e);}},iX=function(t){var e,n;function r(){(0,R.default)(this,r),(t=(0,I.default)(this,r)).defaultView=null,t.ownerDocument=null,t.nodeName="document";try{t.timeline=new ih.AnimationTimeline(t);}catch(t){}var t,e={};return nI.forEach(function(t){var n=t.n,r=t.inh,i=t.d;r&&i&&(e[n]=(0,B.isFunction)(i)?i(K.GROUP):i);}),t.documentElement=new iC({id:"g-root",style:e}),t.documentElement.ownerDocument=t,t.documentElement.parentNode=t,t.childNodes=[t.documentElement],t;}return(0,D.default)(r,t),(0,O.default)(r,[{key:"children",get:function(){return this.childNodes;}},{key:"childElementCount",get:function(){return this.childNodes.length;}},{key:"firstElementChild",get:function(){return this.firstChild;}},{key:"lastElementChild",get:function(){return this.lastChild;}},{key:"createElement",value:function(t,e){if("svg"===t)return this.documentElement;var n=this.defaultView.customElements.get(t);n||(console.warn("Unsupported tagName: ",t),n="tspan"===t?iY:iC);var r=new n(e);return r.ownerDocument=this,r;}},{key:"createElementNS",value:function(t,e,n){return this.createElement(e,n);}},{key:"cloneNode",value:function(t){throw Error(tc);}},{key:"destroy",value:function(){try{this.documentElement.destroyChildren(),this.timeline.destroy();}catch(t){}}},{key:"elementsFromBBox",value:function(t,e,n,r){var i=this.defaultView.context.rBushRoot.search({minX:t,minY:e,maxX:n,maxY:r}),a=[];return i.forEach(function(t){var e=t.displayObject,n=e.parsedStyle.pointerEvents,r=["auto","visiblepainted","visiblefill","visiblestroke","visible"].includes(void 0===n?"auto":n);(!r||r&&e.isVisible())&&!e.isCulled()&&e.isInteractive()&&a.push(e);}),a.sort(function(t,e){return e.sortable.renderOrder-t.sortable.renderOrder;}),a;}},{key:"elementFromPointSync",value:function(t,e){var n=this.defaultView.canvas2Viewport({x:t,y:e}),r=n.x,i=n.y,a=this.defaultView.getConfig(),o=a.width,s=a.height;if(r<0||i<0||r>o||i>s)return null;var l=this.defaultView.viewport2Client({x:r,y:i}),u=l.x,c=l.y,h=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!0,position:{x:t,y:e,viewportX:r,viewportY:i,clientX:u,clientY:c},picked:[]}).picked;return h&&h[0]||this.documentElement;}},{key:"elementFromPoint",value:(e=(0,Y.default)((0,H.default)().mark(function t(e,n){var r,i,a,o,s,l,u,c,h,d;return(0,H.default)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i=(r=this.defaultView.canvas2Viewport({x:e,y:n})).x,a=r.y,s=(o=this.defaultView.getConfig()).width,l=o.height,!(i<0||a<0||i>s||a>l)){t.next=1;break;}return t.abrupt("return",null);case 1:return c=(u=this.defaultView.viewport2Client({x:i,y:a})).x,h=u.y,t.next=2,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!0,position:{x:e,y:n,viewportX:i,viewportY:a,clientX:c,clientY:h},picked:[]});case 2:return d=t.sent.picked,t.abrupt("return",d&&d[0]||this.documentElement);case 3:case"end":return t.stop();}},t,this);})),function(t,n){return e.apply(this,arguments);})},{key:"elementsFromPointSync",value:function(t,e){var n=this.defaultView.canvas2Viewport({x:t,y:e}),r=n.x,i=n.y,a=this.defaultView.getConfig(),o=a.width,s=a.height;if(r<0||i<0||r>o||i>s)return[];var l=this.defaultView.viewport2Client({x:r,y:i}),u=l.x,c=l.y,h=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!1,position:{x:t,y:e,viewportX:r,viewportY:i,clientX:u,clientY:c},picked:[]}).picked;return h[h.length-1]!==this.documentElement&&h.push(this.documentElement),h;}},{key:"elementsFromPoint",value:(n=(0,Y.default)((0,H.default)().mark(function t(e,n){var r,i,a,o,s,l,u,c,h,d;return(0,H.default)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i=(r=this.defaultView.canvas2Viewport({x:e,y:n})).x,a=r.y,s=(o=this.defaultView.getConfig()).width,l=o.height,!(i<0||a<0||i>s||a>l)){t.next=1;break;}return t.abrupt("return",[]);case 1:return c=(u=this.defaultView.viewport2Client({x:i,y:a})).x,h=u.y,t.next=2,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!1,position:{x:e,y:n,viewportX:i,viewportY:a,clientX:c,clientY:h},picked:[]});case 2:return(d=t.sent.picked)[d.length-1]!==this.documentElement&&d.push(this.documentElement),t.abrupt("return",d);case 3:case"end":return t.stop();}},t,this);})),function(t,e){return n.apply(this,arguments);})},{key:"appendChild",value:function(t,e){throw Error(th);}},{key:"insertBefore",value:function(t,e){throw Error(th);}},{key:"removeChild",value:function(t,e){throw Error(th);}},{key:"replaceChild",value:function(t,e,n){throw Error(th);}},{key:"append",value:function(){throw Error(th);}},{key:"prepend",value:function(){throw Error(th);}},{key:"getElementById",value:function(t){return this.documentElement.getElementById(t);}},{key:"getElementsByName",value:function(t){return this.documentElement.getElementsByName(t);}},{key:"getElementsByTagName",value:function(t){return this.documentElement.getElementsByTagName(t);}},{key:"getElementsByClassName",value:function(t){return this.documentElement.getElementsByClassName(t);}},{key:"querySelector",value:function(t){return this.documentElement.querySelector(t);}},{key:"querySelectorAll",value:function(t){return this.documentElement.querySelectorAll(t);}},{key:"find",value:function(t){return this.documentElement.find(t);}},{key:"findAll",value:function(t){return this.documentElement.findAll(t);}}]);}(rU),ij=function(){function t(e){(0,R.default)(this,t),this.strategies=e;}return(0,O.default)(t,[{key:"apply",value:function(e){var n=e.config,r=e.camera,i=e.renderingService,a=e.renderingContext,o=this.strategies;i.hooks.cull.tap(t.tag,function(t){if(t){var e,i=t.cullable;if(0===o.length?i.visible=a.unculledEntities.indexOf(t.entity)>-1:i.visible=o.every(function(e){return e.isVisible(r,t);}),!t.isCulled()&&t.isVisible())return t;var s=(null===(e=n.future)||void 0===e?void 0:e.experimentalCancelEventPropagation)===!0;return t.dispatchEvent(new rF(rX.CULLED),s,s),null;}return t;}),i.hooks.afterRender.tap(t.tag,function(t){t.cullable.visibilityPlaneMask=-1;});}}]);}();ij.tag="Culling";var i$=function(){function t(){var e=this;(0,R.default)(this,t),this.autoPreventDefault=!1,this.rootPointerEvent=new r_(null),this.rootWheelEvent=new rG(null),this.onPointerMove=function(t){var n=null===(r=e.context.renderingContext.root)||void 0===r||null===(r=r.ownerDocument)||void 0===r?void 0:r.defaultView;if(!n.supportsTouchEvents||"touch"!==t.pointerType){var r,i,a=e.normalizeToPointerEvent(t,n),o=(0,W.default)(a);try{for(o.s();!(i=o.n()).done;){var s=i.value,l=e.bootstrapEvent(e.rootPointerEvent,s,n,t);e.context.eventService.mapEvent(l);}}catch(t){o.e(t);}finally{o.f();}e.setCursor(e.context.eventService.cursor);}},this.onClick=function(t){var n,r,i=null===(n=e.context.renderingContext.root)||void 0===n||null===(n=n.ownerDocument)||void 0===n?void 0:n.defaultView,a=e.normalizeToPointerEvent(t,i),o=(0,W.default)(a);try{for(o.s();!(r=o.n()).done;){var s=r.value,l=e.bootstrapEvent(e.rootPointerEvent,s,i,t);e.context.eventService.mapEvent(l);}}catch(t){o.e(t);}finally{o.f();}e.setCursor(e.context.eventService.cursor);};}return(0,O.default)(t,[{key:"apply",value:function(e){var n=this;this.context=e;var r=e.renderingService,i=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler(function(t){return n.context.renderingService.hooks.pickSync.call({position:t,picked:[],topmost:!0}).picked[0]||null;}),r.hooks.pointerWheel.tap(t.tag,function(t){var e=n.normalizeWheelEvent(t);n.context.eventService.mapEvent(e);}),r.hooks.pointerDown.tap(t.tag,function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){var e=n.normalizeToPointerEvent(t,i);n.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();var r,a=(0,W.default)(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=n.bootstrapEvent(n.rootPointerEvent,o,i,t);n.context.eventService.mapEvent(s);}}catch(t){a.e(t);}finally{a.f();}n.setCursor(n.context.eventService.cursor);}}),r.hooks.pointerUp.tap(t.tag,function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){var e,r=n.context.contextService.getDomElement(),a=n.context.eventService.isNativeEventFromCanvas(r,t)?"":"outside",o=n.normalizeToPointerEvent(t,i),s=(0,W.default)(o);try{for(s.s();!(e=s.n()).done;){var l=e.value,u=n.bootstrapEvent(n.rootPointerEvent,l,i,t);u.type+=a,n.context.eventService.mapEvent(u);}}catch(t){s.e(t);}finally{s.f();}n.setCursor(n.context.eventService.cursor);}}),r.hooks.pointerMove.tap(t.tag,this.onPointerMove),r.hooks.pointerOver.tap(t.tag,this.onPointerMove),r.hooks.pointerOut.tap(t.tag,this.onPointerMove),r.hooks.click.tap(t.tag,this.onClick),r.hooks.pointerCancel.tap(t.tag,function(t){var e,r=n.normalizeToPointerEvent(t,i),a=(0,W.default)(r);try{for(a.s();!(e=a.n()).done;){var o=e.value,s=n.bootstrapEvent(n.rootPointerEvent,o,i,t);n.context.eventService.mapEvent(s);}}catch(t){a.e(t);}finally{a.f();}n.setCursor(n.context.eventService.cursor);});}},{key:"bootstrapEvent",value:function(t,e,n,r){t.view=n,t.originalEvent=null,t.nativeEvent=r,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);var i=this.context.eventService.client2Viewport({x:e.clientX,y:e.clientY}),a=i.x,o=i.y;t.viewport.x=a,t.viewport.y=o;var s=this.context.eventService.viewport2Canvas(t.viewport),l=s.x,u=s.y;return t.canvas.x=l,t.canvas.y=u,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=r.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=n6[t.type]||t.type),t;}},{key:"normalizeWheelEvent",value:function(t){var e=this.rootWheelEvent;this.transferMouseData(e,t),e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;var n=this.context.eventService.client2Viewport({x:t.clientX,y:t.clientY}),r=n.x,i=n.y;e.viewport.x=r,e.viewport.y=i;var a=this.context.eventService.viewport2Canvas(e.viewport),o=a.x,s=a.y;return e.canvas.x=o,e.canvas.y=s,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.nativeEvent=t,e.type=t.type,e;}},{key:"transferMouseData",value:function(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=n7.now(),t.type=e.type,t.altKey=e.altKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.ctrlKey=e.ctrlKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.screen.x=e.screenX,t.screen.y=e.screenY,t.relatedTarget=null;}},{key:"setCursor",value:function(t){this.context.contextService.applyCursorStyle(t||this.context.config.cursor||"default");}},{key:"normalizeToPointerEvent",value:function(t,e){var n=[];if(e.isTouchEvent(t))for(var r=0;r<t.changedTouches.length;r++){var i=t.changedTouches[r];(0,B.isUndefined)(i.button)&&(i.button=0),(0,B.isUndefined)(i.buttons)&&(i.buttons=1),(0,B.isUndefined)(i.isPrimary)&&(i.isPrimary=1===t.touches.length&&"touchstart"===t.type),(0,B.isUndefined)(i.width)&&(i.width=i.radiusX||1),(0,B.isUndefined)(i.height)&&(i.height=i.radiusY||1),(0,B.isUndefined)(i.tiltX)&&(i.tiltX=0),(0,B.isUndefined)(i.tiltY)&&(i.tiltY=0),(0,B.isUndefined)(i.pointerType)&&(i.pointerType="touch"),(0,B.isUndefined)(i.pointerId)&&(i.pointerId=i.identifier||0),(0,B.isUndefined)(i.pressure)&&(i.pressure=i.force||.5),(0,B.isUndefined)(i.twist)&&(i.twist=0),(0,B.isUndefined)(i.tangentialPressure)&&(i.tangentialPressure=0),i.isNormalized=!0,i.type=t.type,n.push(i);}else e.isMouseEvent(t)&&((0,B.isUndefined)(t.isPrimary)&&(t.isPrimary=!0),(0,B.isUndefined)(t.width)&&(t.width=1),(0,B.isUndefined)(t.height)&&(t.height=1),(0,B.isUndefined)(t.tiltX)&&(t.tiltX=0),(0,B.isUndefined)(t.tiltY)&&(t.tiltY=0),(0,B.isUndefined)(t.pointerType)&&(t.pointerType="mouse"),(0,B.isUndefined)(t.pointerId)&&(t.pointerId=1),(0,B.isUndefined)(t.pressure)&&(t.pressure=.5),(0,B.isUndefined)(t.twist)&&(t.twist=0),(0,B.isUndefined)(t.tangentialPressure)&&(t.tangentialPressure=0),t.isNormalized=!0),n.push(t);return n;}}]);}();i$.tag="Event";var iK=[K.CIRCLE,K.ELLIPSE,K.IMAGE,K.RECT,K.LINE,K.POLYLINE,K.POLYGON,K.TEXT,K.PATH,K.HTML],iZ=(0,O.default)(function t(){(0,R.default)(this,t);},[{key:"isVisible",value:function(t,e){var n,r=e.cullable;if(!r.enable)return!0;var i=e.getRenderBounds();if(ti.isEmpty(i))return!1;var a=t.getFrustum(),o=null===(n=e.parentNode)||void 0===n||null===(n=n.cullable)||void 0===n?void 0:n.visibilityPlaneMask;return r.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(e,i,o||to.INDETERMINATE,a.planes),r.visible=r.visibilityPlaneMask!==to.OUTSIDE,r.visible;}},{key:"computeVisibilityWithPlaneMask",value:function(t,e,n,r){if(n===to.OUTSIDE||n===to.INSIDE)return n;for(var i=to.INSIDE,a=iK.indexOf(t.nodeName)>-1,o=0,s=r.length;o<s;++o){var l=1<<o;if((n&l)!=0&&(!a||4!==o&&5!==o)){var u=r[o],c=u.normal,h=u.distance;if(F.vec3.dot(c,e.getPositiveFarPoint(r[o]))+h<0)return to.OUTSIDE;F.vec3.dot(c,e.getNegativeFarPoint(r[o]))+h<0&&(i|=l);}}return i;}}]),iQ=function(){function t(){(0,R.default)(this,t),this.syncTasks=new Map,this.isFirstTimeRendering=!0,this.syncing=!1,this.isFirstTimeRenderingFinished=!1;}return(0,O.default)(t,[{key:"apply",value:function(e){var n,r,i=this,a=e.config,o=e.renderingService,s=e.renderingContext,l=e.rBushRoot,u=s.root.ownerDocument.defaultView;this.rBush=l;var c=function(t){o.dirtify();},h=function(t){i.syncTasks.set(t.target,t.detail.affectChildren),o.dirtify();},d=function(t){var e=t.target;ih.enableSizeAttenuation&&ih.styleValueRegistry.updateSizeAttenuation(e,u.getCamera().getZoom());},f=function(t){var e=t.target,n=e.rBushNode;null!=n&&n.aabb&&i.rBush.remove(n.aabb),i.syncTasks.delete(e),ih.sceneGraphService.dirtyToRoot(e),o.dirtify();};o.hooks.init.tap(t.tag,function(){u.addEventListener(rX.MOUNTED,d),u.addEventListener(rX.UNMOUNTED,f),u.addEventListener(rX.ATTR_MODIFIED,c),u.addEventListener(rX.BOUNDS_CHANGED,h);}),o.hooks.destroy.tap(t.tag,function(){u.removeEventListener(rX.MOUNTED,d),u.removeEventListener(rX.UNMOUNTED,f),u.removeEventListener(rX.ATTR_MODIFIED,c),u.removeEventListener(rX.BOUNDS_CHANGED,h),i.syncTasks.clear();});var v=null!==(n=ih.globalThis.requestIdleCallback)&&void 0!==n?n:rs.bind(ih.globalThis),p=(null===(r=a.future)||void 0===r?void 0:r.experimentalRICSyncRTree)===!0;o.hooks.endFrame.tap(t.tag,function(){i.isFirstTimeRendering?(i.isFirstTimeRendering=!1,i.syncing=!0,v(function(){i.syncRTree(!0),i.isFirstTimeRenderingFinished=!0;})):p&&ih.globalThis.requestIdleCallback&&ih.globalThis.cancelIdleCallback?(ih.globalThis.cancelIdleCallback(i.ricSyncRTreeId),i.ricSyncRTreeId=ih.globalThis.requestIdleCallback(function(){return i.syncRTree();})):i.syncRTree();});}},{key:"syncNode",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t.isConnected){var n=t.rBushNode;n.aabb&&this.rBush.remove(n.aabb);var r=t.getRenderBounds();if(r){var i=t.renderable;e&&(i.dirtyRenderBounds||(i.dirtyRenderBounds=new ti),i.dirtyRenderBounds.update(r.center,r.halfExtents));var a=r.getMin(),o=(0,_.default)(a,2),s=o[0],l=o[1],u=r.getMax(),c=(0,_.default)(u,2),h=c[0],d=c[1];n.aabb||(n.aabb={}),n.aabb.displayObject=t,n.aabb.minX=s,n.aabb.minY=l,n.aabb.maxX=h,n.aabb.maxY=d;}if(n.aabb&&!isNaN(n.aabb.maxX)&&!isNaN(n.aabb.maxX)&&!isNaN(n.aabb.minX)&&!isNaN(n.aabb.minY))return n.aabb;}}},{key:"syncRTree",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e||!this.syncing&&0!==this.syncTasks.size){this.syncing=!0;var n=[],r=new Set,i=function(i){if(!r.has(i)&&i.renderable){var a=t.syncNode(i,e);a&&(n.push(a),r.add(i));}};this.syncTasks.forEach(function(t,e){t&&e.forEach(i);for(var n=e;n;)i(n),n=n.parentElement;}),this.rBush.load(n),n.length=0,this.syncing=!1;}}}]);}();iQ.tag="Prepare";var iJ=((M={}).READY="ready",M.BEFORE_RENDER="beforerender",M.RERENDER="rerender",M.AFTER_RENDER="afterrender",M.BEFORE_DESTROY="beforedestroy",M.AFTER_DESTROY="afterdestroy",M.RESIZE="resize",M.DIRTY_RECTANGLE="dirtyrectangle",M.RENDERER_CHANGED="rendererchanged",M),i0=new rF(rX.MOUNTED),i1=new rF(rX.UNMOUNTED),i2=new rF(iJ.BEFORE_RENDER),i3=new rF(iJ.RERENDER),i4=new rF(iJ.AFTER_RENDER),i5=function(t){function e(t){(0,R.default)(this,e),(i=(0,I.default)(this,e)).Element=iS,i.inited=!1,i.context={};var n,r,i,a=t.container,o=t.canvas,s=t.renderer,l=t.width,u=t.height,c=t.background,h=t.cursor,d=t.supportsMutipleCanvasesInOneContainer,f=t.cleanUpOnDestroy,v=void 0===f||f,p=t.offscreenCanvas,g=t.devicePixelRatio,y=t.requestAnimationFrame,m=t.cancelAnimationFrame,k=t.createImage,E=t.supportsTouchEvents,x=t.supportsPointerEvents,T=t.isTouchEvent,N=t.isMouseEvent,b=t.dblClickSpeed,S=l,w=u,P=g||n3&&window.devicePixelRatio||1;return P=P>=1?Math.ceil(P):1,o&&(S=l||("auto"===(n=n5(o,"width"))?o.offsetWidth:parseFloat(n))||o.width/P,w=u||("auto"===(r=n5(o,"height"))?o.offsetHeight:parseFloat(r))||o.height/P),i.customElements=new iW,i.devicePixelRatio=P,i.requestAnimationFrame=null!=y?y:rs.bind(ih.globalThis),i.cancelAnimationFrame=null!=m?m:rl.bind(ih.globalThis),i.createImage=null!=k?k:function(){return new window.Image;},i.supportsTouchEvents=null!=E?E:"ontouchstart"in ih.globalThis,i.supportsPointerEvents=null!=x?x:!!ih.globalThis.PointerEvent,i.isTouchEvent=null!=T?T:function(t){return i.supportsTouchEvents&&t instanceof ih.globalThis.TouchEvent;},i.isMouseEvent=null!=N?N:function(t){return!ih.globalThis.MouseEvent||t instanceof ih.globalThis.MouseEvent&&(!i.supportsPointerEvents||!(t instanceof ih.globalThis.PointerEvent));},p&&(ih.offscreenCanvas=p),i.document=new iX,i.document.defaultView=i,d||function(t,e,n){if(t){var r="string"==typeof t?document.getElementById(t):t;n2.has(r)&&n2.get(r).destroy(n),n2.set(r,e);}}(a,i,v),i.initRenderingContext((0,C.default)((0,C.default)({},t),{},{width:S,height:w,background:null!=c?c:"transparent",cursor:null!=h?h:"default",cleanUpOnDestroy:v,devicePixelRatio:P,requestAnimationFrame:i.requestAnimationFrame,cancelAnimationFrame:i.cancelAnimationFrame,createImage:i.createImage,supportsTouchEvents:i.supportsTouchEvents,supportsPointerEvents:i.supportsPointerEvents,isTouchEvent:i.isTouchEvent,isMouseEvent:i.isMouseEvent,dblClickSpeed:null!=b?b:200})),i.initDefaultCamera(S,w,s.clipSpaceNearZ),i.initRenderer(s,!0),i;}return(0,D.default)(e,t),(0,O.default)(e,[{key:"initRenderingContext",value:function(t){this.context.config=t,this.context.renderingContext={root:this.document.documentElement,unculledEntities:[],renderListCurrentFrame:[],renderReasons:new Set,force:!1,dirty:!1};}},{key:"initDefaultCamera",value:function(t,e,n){var r=this,i=new ih.CameraContribution;i.clipSpaceNearZ=n,i.setType(tP.EXPLORING,tM.DEFAULT).setPosition(t/2,e/2,500).setFocalPoint(t/2,e/2,0).setOrthographic(-(t/2),t/2,e/2,-(e/2),.1,1e3),i.canvas=this,i.eventEmitter.on(tC.UPDATED,function(){r.context.renderingContext.renderReasons.add(rH.CAMERA_CHANGED),ih.enableSizeAttenuation&&r.getConfig().renderer.getConfig().enableSizeAttenuation&&r.updateSizeAttenuation();}),this.context.camera=i;}},{key:"updateSizeAttenuation",value:function(){var t=this.getCamera().getZoom();this.document.documentElement.forEach(function(e){ih.styleValueRegistry.updateSizeAttenuation(e,t);});}},{key:"getConfig",value:function(){return this.context.config;}},{key:"getRoot",value:function(){return this.document.documentElement;}},{key:"getCamera",value:function(){return this.context.camera;}},{key:"getContextService",value:function(){return this.context.contextService;}},{key:"getEventService",value:function(){return this.context.eventService;}},{key:"getRenderingService",value:function(){return this.context.renderingService;}},{key:"getRenderingContext",value:function(){return this.context.renderingContext;}},{key:"getStats",value:function(){return this.getRenderingService().getStats();}},{key:"ready",get:function(){var t=this;return!this.readyPromise&&(this.readyPromise=new Promise(function(e){t.resolveReadyPromise=function(){e(t);};}),this.inited&&this.resolveReadyPromise()),this.readyPromise;}},{key:"destroy",value:function(){var t,e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],n=arguments.length>1?arguments[1]:void 0;es.clearCache();var r=(null===(t=this.getConfig().future)||void 0===t?void 0:t.experimentalCancelEventPropagation)===!0;n||this.dispatchEvent(new rF(iJ.BEFORE_DESTROY),r,r),this.frameId&&this.cancelAnimationFrame(this.frameId);var i=this.getRoot();e&&(this.unmountChildren(i),this.document.destroy(),this.getEventService().destroy()),this.getRenderingService().destroy(),this.getContextService().destroy(),this.context.rBushRoot&&this.context.rBushRoot.clear(),n||this.dispatchEvent(new rF(iJ.AFTER_DESTROY),r,r);var a=function(t){t.currentTarget=null,t.manager=null,t.target=null,t.relatedNode=null;};a(i0),a(i1),a(i2),a(i3),a(i4),a(iT),a(ig),a(iy),a(im);}},{key:"changeSize",value:function(t,e){this.resize(t,e);}},{key:"resize",value:function(t,e){var n,r=this.context.config;r.width=t,r.height=e,this.getContextService().resize(t,e);var i=this.context.camera,a=i.getProjectionMode();i.setPosition(t/2,e/2,500).setFocalPoint(t/2,e/2,0),a===tA.ORTHOGRAPHIC?i.setOrthographic(-(t/2),t/2,e/2,-(e/2),i.getNear(),i.getFar()):i.setAspect(t/e);var o=(null===(n=r.future)||void 0===n?void 0:n.experimentalCancelEventPropagation)===!0;this.dispatchEvent(new rF(iJ.RESIZE,{width:t,height:e}),o,o);}},{key:"appendChild",value:function(t,e){return this.document.documentElement.appendChild(t,e);}},{key:"insertBefore",value:function(t,e){return this.document.documentElement.insertBefore(t,e);}},{key:"removeChild",value:function(t){return this.document.documentElement.removeChild(t);}},{key:"removeChildren",value:function(){this.document.documentElement.removeChildren();}},{key:"destroyChildren",value:function(){this.document.documentElement.destroyChildren();}},{key:"render",value:function(t){var e,n=this;t&&(i2.detail=t,i4.detail=t);var r=(null===(e=this.getConfig().future)||void 0===e?void 0:e.experimentalCancelEventPropagation)===!0;this.dispatchEvent(i2,r,r),this.getRenderingService().render(this.getConfig(),t,function(){n.dispatchEvent(i3,r,r);}),this.dispatchEvent(i4,r,r);}},{key:"run",value:function(){var t=this,e=function(n,r){t.render(r),t.frameId=t.requestAnimationFrame(e);};e();}},{key:"initRenderer",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t)throw Error("Renderer is required.");this.inited=!1,this.readyPromise=void 0,this.context.rBushRoot=new $,this.context.renderingPlugins=[],this.context.renderingPlugins.push(new i$,new iQ,new ij([new iZ])),this.loadRendererContainerModule(t),this.context.contextService=new this.context.ContextService((0,C.default)((0,C.default)({},ih),this.context)),this.context.renderingService=new rY(ih,this.context),this.context.eventService=new rV(ih,this.context),this.context.eventService.init(),this.context.contextService.init?(this.context.contextService.init(),this.initRenderingService(t,n,!0)):this.context.contextService.initAsync().then(function(){e.initRenderingService(t,n);}).catch(function(t){console.error(t);});}},{key:"initRenderingService",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.context.renderingService.init(function(){e.inited=!0;var i,a=(null===(i=e.getConfig().future)||void 0===i?void 0:i.experimentalCancelEventPropagation)===!0;n?r?e.requestAnimationFrame(function(){e.dispatchEvent(new rF(iJ.READY),a,a);}):e.dispatchEvent(new rF(iJ.READY),a,a):e.dispatchEvent(new rF(iJ.RENDERER_CHANGED),a,a),e.readyPromise&&e.resolveReadyPromise(),n||e.getRoot().forEach(function(t){var e;null===(e=t.dirty)||void 0===e||e.call(t,!0,!0);}),e.mountChildren(e.getRoot()),t.getConfig().enableAutoRendering&&e.run();});}},{key:"loadRendererContainerModule",value:function(t){var e=this;t.getPlugins().forEach(function(t){t.context=e.context,t.init(ih);});}},{key:"setRenderer",value:function(t){var e=this.getConfig();if(e.renderer!==t){var n=e.renderer;e.renderer=t,this.destroy(!1,!0),(0,L.default)((null==n?void 0:n.getPlugins())||[]).reverse().forEach(function(t){t.destroy(ih);}),this.initRenderer(t);}}},{key:"setCursor",value:function(t){this.getConfig().cursor=t,this.getContextService().applyCursorStyle(t);}},{key:"unmountChildren",value:function(t){var e=this;if(t.childNodes.forEach(function(t){e.unmountChildren(t);}),this.inited){if(t.isMutationObserved)t.dispatchEvent(i1);else{var n,r=(null===(n=this.getConfig().future)||void 0===n?void 0:n.experimentalCancelEventPropagation)===!0;i1.target=t,this.dispatchEvent(i1,!0,r);}t!==this.document.documentElement&&(t.ownerDocument=null),t.isConnected=!1;}t.isCustomElement&&t.disconnectedCallback&&t.disconnectedCallback();}},{key:"mountChildren",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n9(t);if(this.inited){if(!t.isConnected&&(t.ownerDocument=this.document,t.isConnected=!0,!n)){if(t.isMutationObserved)t.dispatchEvent(i0);else{var r,i=(null===(r=this.getConfig().future)||void 0===r?void 0:r.experimentalCancelEventPropagation)===!0;i0.target=t,this.dispatchEvent(i0,!0,i);}}}else console.warn("[g]: You are trying to call `canvas.appendChild` before canvas' initialization finished. You can either await `canvas.ready` or listen to `CanvasEvent.READY` manually.","appended child: ",t.nodeName);t.childNodes.forEach(function(t){e.mountChildren(t,n);}),t.isCustomElement&&t.connectedCallback&&t.connectedCallback();}},{key:"mountFragment",value:function(t){this.mountChildren(t,!1);}},{key:"client2Viewport",value:function(t){return this.getEventService().client2Viewport(t);}},{key:"viewport2Client",value:function(t){return this.getEventService().viewport2Client(t);}},{key:"viewport2Canvas",value:function(t){return this.getEventService().viewport2Canvas(t);}},{key:"canvas2Viewport",value:function(t){return this.getEventService().canvas2Viewport(t);}},{key:"getPointByClient",value:function(t,e){return this.client2Viewport({x:t,y:e});}},{key:"getClientByPoint",value:function(t,e){return this.viewport2Client({x:t,y:e});}}]);}(rB);},"27eed8e3":function(t,e,n){"use strict";n.d(e,"__esModule",{value:!0}),n.e(e,{AbstractRendererPlugin:function(){return K;},Point:function(){return ts;},Shape:function(){return j;},findClosestClipPathTarget:function(){return nQ;},getOrCalculatePathTotalLength:function(){return e7;},isFillOrStrokeAffected:function(){return n2;}});var r,i,a,o,s,l,u,c,h,d,f,v,p,g,y,m,k,E,x,T,N,b,S,w,P,M=n("777fffbe"),A=M._(n("ab297151")),C=M._(n("b1a4abb6")),R=M._(n("72ce8fb5")),O=M._(n("d60881d0")),L=M._(n("0b95a4d2")),I=M._(n("0afdccfb")),D=M._(n("7465ab36")),_=M._(n("32f41e1c")),G=n("597fa39f");n("f90e84e3");var F=n("abe9d8d6"),B=M._(n("3214ccb5")),U=M._(n("51ffafbb")),V=M._(n("3c7f532e")),z=n("b1a96927"),H=M._(n("2fabd5d4")),Y=M._(n("cb203630")),W=M._(n("1982f763")),q=M._(n("01aac514"));let X=n("1714eebe");var j=((r={}).GROUP="g",r.FRAGMENT="fragment",r.CIRCLE="circle",r.ELLIPSE="ellipse",r.IMAGE="image",r.RECT="rect",r.LINE="line",r.POLYLINE="polyline",r.POLYGON="polygon",r.TEXT="text",r.PATH="path",r.HTML="html",r.MESH="mesh",r),$=((i={})[i.ZERO=0]="ZERO",i[i.NEGATIVE_ONE=1]="NEGATIVE_ONE",i),K=(0,R.default)(function t(){(0,C.default)(this,t),this.plugins=[];},[{key:"addRenderingPlugin",value:function(t){this.plugins.push(t),this.context.renderingPlugins.push(t);}},{key:"removeAllRenderingPlugins",value:function(){var t=this;this.plugins.forEach(function(e){var n=t.context.renderingPlugins.indexOf(e);n>=0&&t.context.renderingPlugins.splice(n,1);});}}]),Z=G.vec3.add,Q=G.vec3.copy,J=G.vec3.max,tt=G.vec3.min,te=G.vec3.scale,tn=G.vec3.sub,tr=function(){function t(){(0,C.default)(this,t),this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0];}return(0,R.default)(t,[{key:"update",value:function(t,e){Q(this.center,t),Q(this.halfExtents,e),tn(this.min,this.center,this.halfExtents),Z(this.max,this.center,this.halfExtents);}},{key:"setMinMax",value:function(t,e){Z(this.center,e,t),te(this.center,this.center,.5),tn(this.halfExtents,e,t),te(this.halfExtents,this.halfExtents,.5),Q(this.min,t),Q(this.max,e);}},{key:"getMin",value:function(){return this.min;}},{key:"getMax",value:function(){return this.max;}},{key:"add",value:function(e){if(!t.isEmpty(e)){if(t.isEmpty(this)){this.setMinMax(e.getMin(),e.getMax());return;}var n=this.center,r=n[0],i=n[1],a=n[2],o=this.halfExtents,s=o[0],l=o[1],u=o[2],c=r-s,h=r+s,d=i-l,f=i+l,v=a-u,p=a+u,g=e.center,y=g[0],m=g[1],k=g[2],E=e.halfExtents,x=E[0],T=E[1],N=E[2],b=y-x,S=y+x,w=m-T,P=m+T,M=k-N,A=k+N;b<c&&(c=b),S>h&&(h=S),w<d&&(d=w),P>f&&(f=P),M<v&&(v=M),A>p&&(p=A),n[0]=(c+h)*.5,n[1]=(d+f)*.5,n[2]=(v+p)*.5,o[0]=(h-c)*.5,o[1]=(f-d)*.5,o[2]=(p-v)*.5,this.min[0]=c,this.min[1]=d,this.min[2]=v,this.max[0]=h,this.max[1]=f,this.max[2]=p;}}},{key:"setFromTransformedAABB",value:function(t,e){var n=this.center,r=this.halfExtents,i=t.center,a=t.halfExtents,o=e[0],s=e[4],l=e[8],u=e[1],c=e[5],h=e[9],d=e[2],f=e[6],v=e[10],p=Math.abs(o),g=Math.abs(s),y=Math.abs(l),m=Math.abs(u),k=Math.abs(c),E=Math.abs(h),x=Math.abs(d),T=Math.abs(f),N=Math.abs(v);n[0]=e[12]+o*i[0]+s*i[1]+l*i[2],n[1]=e[13]+u*i[0]+c*i[1]+h*i[2],n[2]=e[14]+d*i[0]+f*i[1]+v*i[2],r[0]=p*a[0]+g*a[1]+y*a[2],r[1]=m*a[0]+k*a[1]+E*a[2],r[2]=x*a[0]+T*a[1]+N*a[2],tn(this.min,n,r),Z(this.max,n,r);}},{key:"intersects",value:function(t){var e=this.getMax(),n=this.getMin(),r=t.getMax(),i=t.getMin();return n[0]<=r[0]&&e[0]>=i[0]&&n[1]<=r[1]&&e[1]>=i[1]&&n[2]<=r[2]&&e[2]>=i[2];}},{key:"intersection",value:function(e){if(!this.intersects(e))return null;var n=new t,r=J([0,0,0],this.getMin(),e.getMin()),i=tt([0,0,0],this.getMax(),e.getMax());return n.setMinMax(r,i),n;}},{key:"getNegativeFarPoint",value:function(t){return 273===t.pnVertexFlag?Q([0,0,0],this.min):272===t.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:257===t.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:256===t.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:17===t.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:16===t.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:1===t.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]];}},{key:"getPositiveFarPoint",value:function(t){return 273===t.pnVertexFlag?Q([0,0,0],this.max):272===t.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:257===t.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:256===t.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:17===t.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:16===t.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:1===t.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]];}}],[{key:"isEmpty",value:function(t){return!t||0===t.halfExtents[0]&&0===t.halfExtents[1]&&0===t.halfExtents[2];}}]);}(),ti=(0,R.default)(function t(e,n){(0,C.default)(this,t),this.distance=e||0,this.normal=n||G.vec3.fromValues(0,1,0),this.updatePNVertexFlag();},[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(Number(this.normal[0]>=0)<<8)+(Number(this.normal[1]>=0)<<4)+Number(this.normal[2]>=0);}},{key:"distanceToPoint",value:function(t){return G.vec3.dot(t,this.normal)-this.distance;}},{key:"normalize",value:function(){var t=1/G.vec3.len(this.normal);G.vec3.scale(this.normal,this.normal,t),this.distance*=t;}},{key:"intersectsLine",value:function(t,e,n){var r=this.distanceToPoint(t),i=r/(r-this.distanceToPoint(e)),a=i>=0&&i<=1;return a&&n&&G.vec3.lerp(n,t,e,i),a;}}]),ta=((a={})[a.OUTSIDE=4294967295]="OUTSIDE",a[a.INSIDE=0]="INSIDE",a[a.INDETERMINATE=2147483647]="INDETERMINATE",a),to=(0,R.default)(function t(e){if((0,C.default)(this,t),this.planes=[],e)this.planes=e;else for(var n=0;n<6;n++)this.planes.push(new ti);},[{key:"extractFromVPMatrix",value:function(t){var e=(0,D.default)(t,16),n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],v=e[12],p=e[13],g=e[14],y=e[15];G.vec3.set(this.planes[0].normal,a-n,u-o,f-c),this.planes[0].distance=y-v,G.vec3.set(this.planes[1].normal,a+n,u+o,f+c),this.planes[1].distance=y+v,G.vec3.set(this.planes[2].normal,a+r,u+s,f+h),this.planes[2].distance=y+p,G.vec3.set(this.planes[3].normal,a-r,u-s,f-h),this.planes[3].distance=y-p,G.vec3.set(this.planes[4].normal,a-i,u-l,f-d),this.planes[4].distance=y-g,G.vec3.set(this.planes[5].normal,a+i,u+l,f+d),this.planes[5].distance=y+g,this.planes.forEach(function(t){t.normalize(),t.updatePNVertexFlag();});}}]),ts=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,C.default)(this,t),this.x=0,this.y=0,this.x=e,this.y=n;}return(0,R.default)(t,[{key:"clone",value:function(){return new t(this.x,this.y);}},{key:"copyFrom",value:function(t){this.x=t.x,this.y=t.y;}}]);}(),tl=function(){function t(e,n,r,i){(0,C.default)(this,t),this.x=e,this.y=n,this.width=r,this.height=i,this.left=e,this.right=e+r,this.top=n,this.bottom=n+i;}return(0,R.default)(t,[{key:"toJSON",value:function(){}}],[{key:"fromRect",value:function(e){return new t(e.x,e.y,e.width,e.height);}},{key:"applyTransform",value:function(e,n){var r=G.vec4.fromValues(e.x,e.y,0,1),i=G.vec4.fromValues(e.x+e.width,e.y,0,1),a=G.vec4.fromValues(e.x,e.y+e.height,0,1),o=G.vec4.fromValues(e.x+e.width,e.y+e.height,0,1),s=G.vec4.create(),l=G.vec4.create(),u=G.vec4.create(),c=G.vec4.create();G.vec4.transformMat4(s,r,n),G.vec4.transformMat4(l,i,n),G.vec4.transformMat4(u,a,n),G.vec4.transformMat4(c,o,n);var h=Math.min(s[0],l[0],u[0],c[0]),d=Math.min(s[1],l[1],u[1],c[1]),f=Math.max(s[0],l[0],u[0],c[0]),v=Math.max(s[1],l[1],u[1],c[1]);return t.fromRect({x:h,y:d,width:f-h,height:v-d});}}]);}(),tu="Method not implemented.";function tc(t){return void 0===t?0:t>360||t<-360?t%360:t;}var th=G.vec3.create();function td(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];return Array.isArray(t)&&3===t.length?r?G.vec3.clone(t):G.vec3.copy(th,t):(0,F.isNumber)(t)?r?G.vec3.fromValues(t,e,n):G.vec3.set(th,t,e,n):r?G.vec3.fromValues(t[0],t[1]||e,t[2]||n):G.vec3.set(th,t[0],t[1]||e,t[2]||n);}var tf=Math.PI/180,tv=180/Math.PI,tp=Math.PI/2;function tg(t,e){var n,r,i,a,o,s,l,u,c,h,d,f,v,p,g,y,m;return 16===e.length?(i=G.mat4.getScaling(G.vec3.create(),e),o=(a=(0,D.default)(i,3))[0],s=a[1],l=a[2],(u=Math.asin(-e[2]/o))<tp?u>-tp?(n=Math.atan2(e[6]/s,e[10]/l),r=Math.atan2(e[1]/o,e[0]/o)):(r=0,n=-Math.atan2(e[4]/s,e[5]/s)):(r=0,n=Math.atan2(e[4]/s,e[5]/s)),t[0]=n,t[1]=u,t[2]=r):(c=e[0],h=e[1],d=e[2],f=e[3],y=c*c+(v=h*h)+(p=d*d)+(g=f*f),(m=c*f-h*d)>.499995*y?(t[0]=tp,t[1]=2*Math.atan2(h,c),t[2]=0):m<-.499995*y?(t[0]=-tp,t[1]=2*Math.atan2(h,c),t[2]=0):(t[0]=Math.asin(2*(c*d-f*h)),t[1]=Math.atan2(2*(c*f+h*d),1-2*(p+g)),t[2]=Math.atan2(2*(c*h+d*f),1-2*(v+p)))),t;}function ty(t){var e=t[0],n=t[1],r=t[3],i=t[4],a=Math.sqrt(e*e+n*n),o=Math.sqrt(r*r+i*i);if(e*i-n*r<0&&(e<i?a=-a:o=-o),a){var s=1/a;e*=s,n*=s;}if(o){var l=1/o;r*=l,i*=l;}var u=Math.atan2(n,e)*tv;return[t[6],t[7],a,o,u];}var tm=G.mat4.create(),tk=G.mat4.create(),tE=G.vec4.create(),tx=[G.vec3.create(),G.vec3.create(),G.vec3.create()],tT=G.vec3.create();function tN(t,e,n,r,i){t[0]=e[0]*r+n[0]*i,t[1]=e[1]*r+n[1]*i,t[2]=e[2]*r+n[2]*i;}var tb=((o={})[o.ORBITING=0]="ORBITING",o[o.EXPLORING=1]="EXPLORING",o[o.TRACKING=2]="TRACKING",o),tS=((s={})[s.DEFAULT=0]="DEFAULT",s[s.ROTATIONAL=1]="ROTATIONAL",s[s.TRANSLATIONAL=2]="TRANSLATIONAL",s[s.CINEMATIC=3]="CINEMATIC",s),tw=((l={})[l.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",l[l.PERSPECTIVE=1]="PERSPECTIVE",l),tP={UPDATED:"updated"},tM=(0,R.default)(function t(){(0,C.default)(this,t),this.clipSpaceNearZ=$.NEGATIVE_ONE,this.eventEmitter=new _.default,this.matrix=G.mat4.create(),this.right=G.vec3.fromValues(1,0,0),this.up=G.vec3.fromValues(0,1,0),this.forward=G.vec3.fromValues(0,0,1),this.position=G.vec3.fromValues(0,0,1),this.focalPoint=G.vec3.fromValues(0,0,0),this.distanceVector=G.vec3.fromValues(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=G.mat4.create(),this.projectionMatrixInverse=G.mat4.create(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=tb.EXPLORING,this.trackingMode=tS.DEFAULT,this.projectionMode=tw.PERSPECTIVE,this.frustum=new to,this.orthoMatrix=G.mat4.create();},[{key:"isOrtho",value:function(){return this.projectionMode===tw.ORTHOGRAPHIC;}},{key:"getProjectionMode",value:function(){return this.projectionMode;}},{key:"getPerspective",value:function(){return this.jitteredProjectionMatrix||this.projectionMatrix;}},{key:"getPerspectiveInverse",value:function(){return this.projectionMatrixInverse;}},{key:"getFrustum",value:function(){return this.frustum;}},{key:"getPosition",value:function(){return this.position;}},{key:"getFocalPoint",value:function(){return this.focalPoint;}},{key:"getDollyingStep",value:function(){return this.dollyingStep;}},{key:"getNear",value:function(){return this.near;}},{key:"getFar",value:function(){return this.far;}},{key:"getZoom",value:function(){return this.zoom;}},{key:"getOrthoMatrix",value:function(){return this.orthoMatrix;}},{key:"getView",value:function(){return this.view;}},{key:"setEnableUpdate",value:function(t){this.enableUpdate=t;}},{key:"setType",value:function(t,e){return this.type=t,this.type===tb.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===tb.TRACKING&&void 0!==e&&this.setTrackingMode(e),this;}},{key:"setProjectionMode",value:function(t){return this.projectionMode=t,this;}},{key:"setTrackingMode",value:function(t){if(this.type!==tb.TRACKING)throw Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=t,this;}},{key:"setWorldRotation",value:function(t){return this.rotateWorld=t,this._getAngles(),this;}},{key:"getViewTransform",value:function(){return G.mat4.invert(G.mat4.create(),this.matrix);}},{key:"getWorldTransform",value:function(){return this.matrix;}},{key:"jitterProjectionMatrix",value:function(t,e){var n=G.mat4.fromTranslation(G.mat4.create(),[t,e,0]);this.jitteredProjectionMatrix=G.mat4.multiply(G.mat4.create(),n,this.projectionMatrix);}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0;}},{key:"setMatrix",value:function(t){return this.matrix=t,this._update(),this;}},{key:"setProjectionMatrix",value:function(t){this.projectionMatrix=t;}},{key:"setFov",value:function(t){return this.setPerspective(this.near,this.far,t,this.aspect),this;}},{key:"setAspect",value:function(t){return this.setPerspective(this.near,this.far,this.fov,t),this;}},{key:"setNear",value:function(t){return this.projectionMode===tw.PERSPECTIVE?this.setPerspective(t,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,t,this.far),this;}},{key:"setFar",value:function(t){return this.projectionMode===tw.PERSPECTIVE?this.setPerspective(this.near,t,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,t),this;}},{key:"setViewOffset",value:function(t,e,n,r,i,a){return this.aspect=t/e,void 0===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.projectionMode===tw.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this;}},{key:"clearViewOffset",value:function(){return void 0!==this.view&&(this.view.enabled=!1),this.projectionMode===tw.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this;}},{key:"setZoom",value:function(t){return this.zoom=t,this.projectionMode===tw.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===tw.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this;}},{key:"setZoomByViewportPoint",value:function(t,e){var n=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),r=n.x,i=n.y,a=this.roll;this.rotate(0,0,-a),this.setPosition(r,i),this.setFocalPoint(r,i),this.setZoom(t),this.rotate(0,0,a);var o=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),s=o.x,l=o.y,u=G.vec3.fromValues(s-r,l-i,0),c=G.vec3.dot(u,this.right)/G.vec3.length(this.right),h=G.vec3.dot(u,this.up)/G.vec3.length(this.up),d=this.getPosition(),f=(0,D.default)(d,2),v=f[0],p=f[1],g=this.getFocalPoint(),y=(0,D.default)(g,2),m=y[0],k=y[1];return this.setPosition(v-c,p-h),this.setFocalPoint(m-c,k-h),this;}},{key:"setPerspective",value:function(t,e,n,r){this.projectionMode=tw.PERSPECTIVE,this.fov=n,this.near=t,this.far=e,this.aspect=r;var i,a=this.near*Math.tan(.5*this.fov*tf)/this.zoom,o=2*a,s=this.aspect*o,l=-.5*s;if(null!==(i=this.view)&&void 0!==i&&i.enabled){var u=this.view.fullWidth,c=this.view.fullHeight;l+=this.view.offsetX*s/u,a-=this.view.offsetY*o/c,s*=this.view.width/u,o*=this.view.height/c;}return!function(t,e,n,r,i,a,o){var s,l,u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=2*a,h=n-e,d=r-i,f=o-a,v=o*a;u?(s=-o/f,l=-v/f):(s=-(o+a)/f,l=-2*v/f),t[0]=c/h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c/d,t[6]=0,t[7]=0,t[8]=(n+e)/h,t[9]=(r+i)/d,t[10]=s,t[11]=-1,t[12]=0,t[13]=0,t[14]=l,t[15]=0;}(this.projectionMatrix,l,l+s,a-o,a,t,this.far,this.clipSpaceNearZ===$.ZERO),G.mat4.invert(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this;}},{key:"setOrthographic",value:function(t,e,n,r,i,a){this.projectionMode=tw.ORTHOGRAPHIC,this.rright=e,this.left=t,this.top=n,this.bottom=r,this.near=i,this.far=a;var o,s=(this.rright-this.left)/(2*this.zoom),l=(this.top-this.bottom)/(2*this.zoom),u=(this.rright+this.left)/2,c=(this.top+this.bottom)/2,h=u-s,d=u+s,f=c+l,v=c-l;if(null!==(o=this.view)&&void 0!==o&&o.enabled){var p=(this.rright-this.left)/this.view.fullWidth/this.zoom,g=(this.top-this.bottom)/this.view.fullHeight/this.zoom;h+=p*this.view.offsetX,d=h+p*this.view.width,f-=g*this.view.offsetY,v=f-g*this.view.height;}return this.clipSpaceNearZ===$.NEGATIVE_ONE?G.mat4.ortho(this.projectionMatrix,h,d,f,v,i,a):G.mat4.orthoZO(this.projectionMatrix,h,d,f,v,i,a),G.mat4.invert(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this;}},{key:"setPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.position[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.position[2],r=td(t,e,n);return this._setPosition(r),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this;}},{key:"setFocalPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.focalPoint[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.focalPoint[2],r=G.vec3.fromValues(0,1,0);if(this.focalPoint=td(t,e,n),this.trackingMode===tS.CINEMATIC){var i=G.vec3.subtract(G.vec3.create(),this.focalPoint,this.position);t=i[0],e=i[1],n=i[2];var a=Math.asin(e/G.vec3.length(i))*tv,o=90+Math.atan2(n,t)*tv,s=G.mat4.create();G.mat4.rotateY(s,s,o*tf),G.mat4.rotateX(s,s,a*tf),r=G.vec3.transformMat4(G.vec3.create(),[0,1,0],s);}return G.mat4.invert(this.matrix,G.mat4.lookAt(G.mat4.create(),this.position,this.focalPoint,r)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this;}},{key:"getDistance",value:function(){return this.distance;}},{key:"getDistanceVector",value:function(){return this.distanceVector;}},{key:"setDistance",value:function(t){if(this.distance===t||t<0)return this;this.distance=t,this.distance<2e-4&&(this.distance=2e-4),this.dollyingStep=this.distance/100;var e=G.vec3.create();t=this.distance;var n=this.forward,r=this.focalPoint;return e[0]=t*n[0]+r[0],e[1]=t*n[1]+r[1],e[2]=t*n[2]+r[2],this._setPosition(e),this.triggerUpdate(),this;}},{key:"setMaxDistance",value:function(t){return this.maxDistance=t,this;}},{key:"setMinDistance",value:function(t){return this.minDistance=t,this;}},{key:"setAzimuth",value:function(t){return this.azimuth=tc(t),this.computeMatrix(),this._getAxes(),this.type===tb.ORBITING||this.type===tb.EXPLORING?this._getPosition():this.type===tb.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getAzimuth",value:function(){return this.azimuth;}},{key:"setElevation",value:function(t){return this.elevation=tc(t),this.computeMatrix(),this._getAxes(),this.type===tb.ORBITING||this.type===tb.EXPLORING?this._getPosition():this.type===tb.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getElevation",value:function(){return this.elevation;}},{key:"setRoll",value:function(t){return this.roll=tc(t),this.computeMatrix(),this._getAxes(),this.type===tb.ORBITING||this.type===tb.EXPLORING?this._getPosition():this.type===tb.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getRoll",value:function(){return this.roll;}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate();}},{key:"computeMatrix",value:function(){var t=G.quat.setAxisAngle(G.quat.create(),[0,0,1],this.roll*tf);G.mat4.identity(this.matrix);var e=G.quat.setAxisAngle(G.quat.create(),[1,0,0],(this.rotateWorld&&this.type!==tb.TRACKING||this.type===tb.TRACKING?1:-1)*this.elevation*tf),n=G.quat.setAxisAngle(G.quat.create(),[0,1,0],(this.rotateWorld&&this.type!==tb.TRACKING||this.type===tb.TRACKING?1:-1)*this.azimuth*tf),r=G.quat.multiply(G.quat.create(),n,e);r=G.quat.multiply(G.quat.create(),r,t);var i=G.mat4.fromQuat(G.mat4.create(),r);this.type===tb.ORBITING||this.type===tb.EXPLORING?(G.mat4.translate(this.matrix,this.matrix,this.focalPoint),G.mat4.multiply(this.matrix,this.matrix,i),G.mat4.translate(this.matrix,this.matrix,[0,0,this.distance])):this.type===tb.TRACKING&&(G.mat4.translate(this.matrix,this.matrix,this.position),G.mat4.multiply(this.matrix,this.matrix,i));}},{key:"_setPosition",value:function(t,e,n){this.position=td(t,e,n);var r=this.matrix;r[12]=this.position[0],r[13]=this.position[1],r[14]=this.position[2],r[15]=1,this._getOrthoMatrix();}},{key:"_getAxes",value:function(){G.vec3.copy(this.right,td(G.vec4.transformMat4(G.vec4.create(),[1,0,0,0],this.matrix))),G.vec3.copy(this.up,td(G.vec4.transformMat4(G.vec4.create(),[0,1,0,0],this.matrix))),G.vec3.copy(this.forward,td(G.vec4.transformMat4(G.vec4.create(),[0,0,1,0],this.matrix))),G.vec3.normalize(this.right,this.right),G.vec3.normalize(this.up,this.up),G.vec3.normalize(this.forward,this.forward);}},{key:"_getAngles",value:function(){var t=this.distanceVector[0],e=this.distanceVector[1],n=this.distanceVector[2],r=G.vec3.length(this.distanceVector);if(0===r){this.elevation=0,this.azimuth=0;return;}this.type===tb.TRACKING?(this.elevation=Math.asin(e/r)*tv,this.azimuth=Math.atan2(-t,-n)*tv):this.rotateWorld?(this.elevation=Math.asin(e/r)*tv,this.azimuth=Math.atan2(-t,-n)*tv):(this.elevation=-(Math.asin(e/r)*tv),this.azimuth=-(Math.atan2(-t,-n)*tv));}},{key:"_getPosition",value:function(){G.vec3.copy(this.position,td(G.vec4.transformMat4(G.vec4.create(),[0,0,0,1],this.matrix))),this._getDistance();}},{key:"_getFocalPoint",value:function(){G.vec3.transformMat3(this.distanceVector,[0,0,-this.distance],G.mat3.fromMat4(G.mat3.create(),this.matrix)),G.vec3.add(this.focalPoint,this.position,this.distanceVector),this._getDistance();}},{key:"_getDistance",value:function(){this.distanceVector=G.vec3.subtract(G.vec3.create(),this.focalPoint,this.position),this.distance=G.vec3.length(this.distanceVector),this.dollyingStep=this.distance/100;}},{key:"_getOrthoMatrix",value:function(){if(this.projectionMode===tw.ORTHOGRAPHIC){var t=this.position,e=G.quat.setAxisAngle(G.quat.create(),[0,0,1],-this.roll*Math.PI/180);G.mat4.fromRotationTranslationScaleOrigin(this.orthoMatrix,e,G.vec3.fromValues((this.rright-this.left)/2-t[0],(this.top-this.bottom)/2-t[1],0),G.vec3.fromValues(this.zoom,this.zoom,1),t);}}},{key:"triggerUpdate",value:function(){if(this.enableUpdate){var t=this.getViewTransform(),e=G.mat4.multiply(G.mat4.create(),this.getPerspective(),t);this.getFrustum().extractFromVPMatrix(e),this.eventEmitter.emit(tP.UPDATED);}}},{key:"rotate",value:function(t,e,n){throw Error(tu);}},{key:"pan",value:function(t,e){throw Error(tu);}},{key:"dolly",value:function(t){throw Error(tu);}},{key:"createLandmark",value:function(t,e){throw Error(tu);}},{key:"gotoLandmark",value:function(t,e){throw Error(tu);}},{key:"cancelLandmarkAnimation",value:function(){throw Error(tu);}}]),tA=((u={})[u.Standard=0]="Standard",u),tC=((c={})[c.ADDED=0]="ADDED",c[c.REMOVED=1]="REMOVED",c[c.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED",c),tR=G.vec3.create(),tO=G.mat4.create(),tL=G.quat.create();function tI(t){if(t.localDirtyFlag){if(0!==t.localSkew[0]||0!==t.localSkew[1]){G.mat4.fromRotationTranslationScaleOrigin(t.localTransform,t.localRotation,t.localPosition,G.vec3.fromValues(1,1,1),t.origin),(0!==t.localSkew[0]||0!==t.localSkew[1])&&(G.mat4.identity(tO),tO[4]=Math.tan(t.localSkew[0]),tO[1]=Math.tan(t.localSkew[1]),G.mat4.multiply(t.localTransform,t.localTransform,tO));var e=G.mat4.fromRotationTranslationScaleOrigin(tO,G.quat.set(tL,0,0,0,1),G.vec3.set(tR,1,1,1),t.localScale,t.origin);G.mat4.multiply(t.localTransform,t.localTransform,e);}else{var n=t.localTransform,r=t.localPosition,i=t.localRotation,a=t.localScale,o=t.origin,s=0!==r[0]||0!==r[1]||0!==r[2],l=1!==i[3]||0!==i[0]||0!==i[1]||0!==i[2],u=1!==a[0]||1!==a[1]||1!==a[2],c=0!==o[0]||0!==o[1]||0!==o[2];l||u||c?G.mat4.fromRotationTranslationScaleOrigin(n,i,r,a,o):s?G.mat4.fromTranslation(n,r):G.mat4.identity(n);}t.localDirtyFlag=!1;}}var tD={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new tl(0,0,0,0)},t_=((h={}).COORDINATE="<coordinate>",h.COLOR="<color>",h.PAINT="<paint>",h.NUMBER="<number>",h.ANGLE="<angle>",h.OPACITY_VALUE="<opacity-value>",h.SHADOW_BLUR="<shadow-blur>",h.LENGTH="<length>",h.PERCENTAGE="<percentage>",h.LENGTH_PERCENTAGE="<length> | <percentage>",h.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",h.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",h.LIST_OF_POINTS="<list-of-points>",h.PATH="<path>",h.FILTER="<filter>",h.Z_INDEX="<z-index>",h.OFFSET_DISTANCE="<offset-distance>",h.DEFINED_PATH="<defined-path>",h.MARKER="<marker>",h.TRANSFORM="<transform>",h.TRANSFORM_ORIGIN="<transform-origin>",h.TEXT="<text>",h.TEXT_TRANSFORM="<text-transform>",h);function tG(t,e,n){t.prototype=e.prototype=n,n.constructor=t;}function tF(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n;}function tB(){}var tU="\\s*([+-]?\\d+)\\s*",tV="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",tz="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",tH=/^#([0-9a-f]{3,8})$/,tY=RegExp(`^rgb\\(${tU},${tU},${tU}\\)$`),tW=RegExp(`^rgb\\(${tz},${tz},${tz}\\)$`),tq=RegExp(`^rgba\\(${tU},${tU},${tU},${tV}\\)$`),tX=RegExp(`^rgba\\(${tz},${tz},${tz},${tV}\\)$`),tj=RegExp(`^hsl\\(${tV},${tz},${tz}\\)$`),t$=RegExp(`^hsla\\(${tV},${tz},${tz},${tV}\\)$`),tK={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function tZ(){return this.rgb().formatHex();}function tQ(){return this.rgb().formatRgb();}function tJ(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=tH.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?t0(e):3===n?new t2(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?t1(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?t1(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=tY.exec(t))?new t2(e[1],e[2],e[3],1):(e=tW.exec(t))?new t2(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=tq.exec(t))?t1(e[1],e[2],e[3],e[4]):(e=tX.exec(t))?t1(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=tj.exec(t))?t9(e[1],e[2]/100,e[3]/100,1):(e=t$.exec(t))?t9(e[1],e[2]/100,e[3]/100,e[4]):tK.hasOwnProperty(t)?t0(tK[t]):"transparent"===t?new t2(NaN,NaN,NaN,0):null;}function t0(t){return new t2(t>>16&255,t>>8&255,255&t,1);}function t1(t,e,n,r){return r<=0&&(t=e=n=NaN),new t2(t,e,n,r);}function t2(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r;}function t3(){return`#${t7(this.r)}${t7(this.g)}${t7(this.b)}`;}function t4(){let t=t5(this.opacity);return`${1===t?"rgb(":"rgba("}${t6(this.r)}, ${t6(this.g)}, ${t6(this.b)}${1===t?")":`, ${t})`}`;}function t5(t){return isNaN(t)?1:Math.max(0,Math.min(1,t));}function t6(t){return Math.max(0,Math.min(255,Math.round(t)||0));}function t7(t){return((t=t6(t))<16?"0":"")+t.toString(16);}function t9(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new et(t,e,n,r);}function t8(t){if(t instanceof et)return new et(t.h,t.s,t.l,t.opacity);if(t instanceof tB||(t=tJ(t)),!t)return new et;if(t instanceof et)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,l=(a+i)/2;return s?(o=e===a?(n-r)/s+(n<r)*6:n===a?(r-e)/s+2:(e-n)/s+4,s/=l<.5?a+i:2-a-i,o*=60):s=l>0&&l<1?0:o,new et(o,s,l,t.opacity);}function et(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r;}function ee(t){return(t=(t||0)%360)<0?t+360:t;}function en(t){return Math.max(0,Math.min(1,t||0));}function er(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255;}function ei(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw TypeError("Expected a function");var n=function(){for(var r=arguments.length,i=Array(r),a=0;a<r;a++)i[a]=arguments[a];var o=e?e.apply(this,i):i[0],s=n.cache;if(s.has(o))return s.get(o);var l=t.apply(this,i);return n.cache=s.set(o,l)||s,l;};return n.cache=new(ei.Cache||Map),ei.cacheList.push(n.cache),n;}tG(tB,tJ,{copy(t){return Object.assign(new this.constructor,this,t);},displayable(){return this.rgb().displayable();},hex:tZ,formatHex:tZ,formatHex8:function(){return this.rgb().formatHex8();},formatHsl:function(){return t8(this).formatHsl();},formatRgb:tQ,toString:tQ}),tG(t2,function(t,e,n,r){var i;return 1==arguments.length?((i=t)instanceof tB||(i=tJ(i)),i)?new t2((i=i.rgb()).r,i.g,i.b,i.opacity):new t2:new t2(t,e,n,null==r?1:r);},tF(tB,{brighter(t){return t=null==t?1.4285714285714286:Math.pow(1.4285714285714286,t),new t2(this.r*t,this.g*t,this.b*t,this.opacity);},darker(t){return t=null==t?.7:Math.pow(.7,t),new t2(this.r*t,this.g*t,this.b*t,this.opacity);},rgb(){return this;},clamp(){return new t2(t6(this.r),t6(this.g),t6(this.b),t5(this.opacity));},displayable(){return -.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1;},hex:t3,formatHex:t3,formatHex8:function(){return`#${t7(this.r)}${t7(this.g)}${t7(this.b)}${t7((isNaN(this.opacity)?1:this.opacity)*255)}`;},formatRgb:t4,toString:t4})),tG(et,function(t,e,n,r){return 1==arguments.length?t8(t):new et(t,e,n,null==r?1:r);},tF(tB,{brighter(t){return t=null==t?1.4285714285714286:Math.pow(1.4285714285714286,t),new et(this.h,this.s,this.l*t,this.opacity);},darker(t){return t=null==t?.7:Math.pow(.7,t),new et(this.h,this.s,this.l*t,this.opacity);},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new t2(er(t>=240?t-240:t+120,i,r),er(t,i,r),er(t<120?t+240:t-120,i,r),this.opacity);},clamp(){return new et(ee(this.h),en(this.s),en(this.l),t5(this.opacity));},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1;},formatHsl(){let t=t5(this.opacity);return`${1===t?"hsl(":"hsla("}${ee(this.h)}, ${100*en(this.s)}%, ${100*en(this.l)}%${1===t?")":`, ${t})`}`;}})),ei.Cache=Map,ei.cacheList=[],ei.clearCache=function(){ei.cacheList.forEach(function(t){return t.clear();});};var ea=((d={})[d.kUnknown=0]="kUnknown",d[d.kNumber=1]="kNumber",d[d.kPercentage=2]="kPercentage",d[d.kEms=3]="kEms",d[d.kPixels=4]="kPixels",d[d.kRems=5]="kRems",d[d.kDegrees=6]="kDegrees",d[d.kRadians=7]="kRadians",d[d.kGradians=8]="kGradians",d[d.kTurns=9]="kTurns",d[d.kMilliseconds=10]="kMilliseconds",d[d.kSeconds=11]="kSeconds",d[d.kInteger=12]="kInteger",d),eo=((f={})[f.kUNumber=0]="kUNumber",f[f.kUPercent=1]="kUPercent",f[f.kULength=2]="kULength",f[f.kUAngle=3]="kUAngle",f[f.kUTime=4]="kUTime",f[f.kUOther=5]="kUOther",f),es=((v={})[v.kYes=0]="kYes",v[v.kNo=1]="kNo",v),el=((p={})[p.kYes=0]="kYes",p[p.kNo=1]="kNo",p),eu=[{name:"em",unit_type:ea.kEms},{name:"px",unit_type:ea.kPixels},{name:"deg",unit_type:ea.kDegrees},{name:"rad",unit_type:ea.kRadians},{name:"grad",unit_type:ea.kGradians},{name:"ms",unit_type:ea.kMilliseconds},{name:"s",unit_type:ea.kSeconds},{name:"rem",unit_type:ea.kRems},{name:"turn",unit_type:ea.kTurns}],ec=((g={})[g.kUnknownType=0]="kUnknownType",g[g.kUnparsedType=1]="kUnparsedType",g[g.kKeywordType=2]="kKeywordType",g[g.kUnitType=3]="kUnitType",g[g.kSumType=4]="kSumType",g[g.kProductType=5]="kProductType",g[g.kNegateType=6]="kNegateType",g[g.kInvertType=7]="kInvertType",g[g.kMinType=8]="kMinType",g[g.kMaxType=9]="kMaxType",g[g.kClampType=10]="kClampType",g[g.kTransformType=11]="kTransformType",g[g.kPositionType=12]="kPositionType",g[g.kURLImageType=13]="kURLImageType",g[g.kColorType=14]="kColorType",g[g.kUnsupportedColorType=15]="kUnsupportedColorType",g),eh=function(t){switch(t){case ea.kNumber:case ea.kInteger:return eo.kUNumber;case ea.kPercentage:return eo.kUPercent;case ea.kPixels:return eo.kULength;case ea.kMilliseconds:case ea.kSeconds:return eo.kUTime;case ea.kDegrees:case ea.kRadians:case ea.kGradians:case ea.kTurns:return eo.kUAngle;default:return eo.kUOther;}},ed=function(t){switch(t){case eo.kUNumber:return ea.kNumber;case eo.kULength:return ea.kPixels;case eo.kUPercent:return ea.kPercentage;case eo.kUTime:return ea.kSeconds;case eo.kUAngle:return ea.kDegrees;default:return ea.kUnknown;}},ef=function(t){var e=1;switch(t){case ea.kPixels:case ea.kDegrees:case ea.kSeconds:break;case ea.kMilliseconds:e=.001;break;case ea.kRadians:e=180/Math.PI;break;case ea.kGradians:e=.9;break;case ea.kTurns:e=360;}return e;},ev=function(t){switch(t){case ea.kNumber:case ea.kInteger:break;case ea.kPercentage:return"%";case ea.kEms:return"em";case ea.kRems:return"rem";case ea.kPixels:return"px";case ea.kDegrees:return"deg";case ea.kRadians:return"rad";case ea.kGradians:return"grad";case ea.kMilliseconds:return"ms";case ea.kSeconds:return"s";case ea.kTurns:return"turn";}return"";},ep=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"toString",value:function(){return this.buildCSSText(es.kNo,el.kNo,"");}},{key:"isNumericValue",value:function(){return this.getType()>=ec.kUnitType&&this.getType()<=ec.kClampType;}}],[{key:"isAngle",value:function(t){return t===ea.kDegrees||t===ea.kRadians||t===ea.kGradians||t===ea.kTurns;}},{key:"isLength",value:function(t){return t>=ea.kEms&&t<ea.kDegrees;}},{key:"isRelativeUnit",value:function(t){return t===ea.kPercentage||t===ea.kEms||t===ea.kRems;}},{key:"isTime",value:function(t){return t===ea.kSeconds||t===ea.kMilliseconds;}}]),eg=function(t){function e(t){var n;return(0,C.default)(this,e),(n=(0,L.default)(this,e)).colorSpace=t,n;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getType",value:function(){return ec.kColorType;}},{key:"to",value:function(t){return this;}}]);}(ep),ey=((y={})[y.Constant=0]="Constant",y[y.LinearGradient=1]="LinearGradient",y[y.RadialGradient=2]="RadialGradient",y),em=function(t){function e(t,n){var r;return(0,C.default)(this,e),(r=(0,L.default)(this,e)).type=t,r.value=n,r;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return new e(this.type,this.value);}},{key:"buildCSSText",value:function(t,e,n){return n;}},{key:"getType",value:function(){return ec.kColorType;}}]);}(ep),ek=function(t){function e(t){var n;return(0,C.default)(this,e),(n=(0,L.default)(this,e)).value=t,n;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return new e(this.value);}},{key:"getType",value:function(){return ec.kKeywordType;}},{key:"buildCSSText",value:function(t,e,n){return n+this.value;}}]);}(ep),eE=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(Number.isFinite(t)?"NaN":t>0?"infinity":"-infinity")+e;},ex=function(t){return ed(eh(t));},eT=function(t){function e(t){var n,r,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ea.kNumber;return(0,C.default)(this,e),r=(0,L.default)(this,e),i="string"==typeof a?(n=a)?"number"===n?ea.kNumber:"percent"===n||"%"===n?ea.kPercentage:eu.find(function(t){return t.name===n;}).unit_type:ea.kUnknown:a,r.unit=i,r.value=t,r;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return new e(this.value,this.unit);}},{key:"equals",value:function(t){return this.value===t.value&&this.unit===t.unit;}},{key:"getType",value:function(){return ec.kUnitType;}},{key:"convertTo",value:function(t){if(this.unit===t)return new e(this.value,this.unit);var n=ex(this.unit);if(n!==ex(t)||n===ea.kUnknown)return null;var r=ef(this.unit)/ef(t);return new e(this.value*r,t);}},{key:"buildCSSText",value:function(t,e,n){var r;switch(this.unit){case ea.kUnknown:break;case ea.kInteger:r=Number(this.value).toFixed(0);break;case ea.kNumber:case ea.kPercentage:case ea.kEms:case ea.kRems:case ea.kPixels:case ea.kDegrees:case ea.kRadians:case ea.kGradians:case ea.kMilliseconds:case ea.kSeconds:case ea.kTurns:var i=this.value,a=ev(this.unit);if(i<-999999||i>999999){var o=ev(this.unit);r=!Number.isFinite(i)||Number.isNaN(i)?eE(i,o):i+(o||"");}else r="".concat(i).concat(a);}return n+r;}}]);}(ep),eN=new eT(0,"px");new eT(1,"px");var eb=new eT(0,"deg"),eS=function(t){function e(t,n,r){var i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return(0,C.default)(this,e),(i=(0,L.default)(this,e,["rgb"])).r=t,i.g=n,i.b=r,i.alpha=a,i.isNone=o,i;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return new e(this.r,this.g,this.b,this.alpha);}},{key:"buildCSSText",value:function(t,e,n){return"".concat(n,"rgba(").concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")");}}]);}(eg),ew=new ek("unset"),eP={"":ew,unset:ew,initial:new ek("initial"),inherit:new ek("inherit")},eM=new eS(0,0,0,0,!0),eA=new eS(0,0,0,0),eC=ei(function(t,e,n,r){return new eS(t,e,n,r);},function(t,e,n,r){return"rgba(".concat(t,",").concat(e,",").concat(n,",").concat(r,")");}),eR=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ea.kNumber;return new eT(t,e);};new eT(50,"%");var eO=function(){var t={linearGradient:/^(linear\-gradient)/i,repeatingLinearGradient:/^(repeating\-linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,repeatingRadialGradient:/^(repeating\-radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},e="";function n(t){throw Error("".concat(e,": ").concat(t));}function r(){return i("linear-gradient",t.linearGradient,o)||i("repeating-linear-gradient",t.repeatingLinearGradient,o)||i("radial-gradient",t.radialGradient,s)||i("repeating-radial-gradient",t.repeatingRadialGradient,s)||i("conic-gradient",t.conicGradient,s);}function i(e,r,i){return a(r,function(r){var a=i();return a&&!m(t.comma)&&n("Missing comma before color stops"),{type:e,orientation:a,colorStops:d(f)};});}function a(e,r){var i=m(e);if(i){m(t.startCall)||n("Missing (");var a=r(i);return m(t.endCall)||n("Missing )"),a;}}function o(){return y("directional",t.sideOrCorner,1)||y("angular",t.angleValue,1);}function s(){var n,r,i=l();return i&&((n=[]).push(i),r=e,m(t.comma)&&((i=l())?n.push(i):e=r)),n;}function l(){var t,e,n=((t=y("shape",/^(circle)/i,0))&&(t.style=g()||u()),t||((e=y("shape",/^(ellipse)/i,0))&&(e.style=p()||u()),e));if(n)n.at=c();else{var r=u();if(r){n=r;var i=c();i&&(n.at=i);}else{var a=h();a&&(n={type:"default-radial",at:a});}}return n;}function u(){return y("extent-keyword",t.extentKeywords,1);}function c(){if(y("position",/^at/,0)){var t=h();return t||n("Missing positioning value"),t;}}function h(){var t={x:p(),y:p()};if(t.x||t.y)return{type:"position",value:t};}function d(e){var r=e(),i=[];if(r)for(i.push(r);m(t.comma);)(r=e())?i.push(r):n("One extra comma");return i;}function f(){var e=y("hex",t.hexColor,1)||a(t.rgbaColor,function(){return{type:"rgba",value:d(v)};})||a(t.rgbColor,function(){return{type:"rgb",value:d(v)};})||y("literal",t.literalColor,0);return e||n("Expected color definition"),e.length=p(),e;}function v(){return m(t.number)[1];}function p(){return y("%",t.percentageValue,1)||y("position-keyword",t.positionKeywords,1)||g();}function g(){return y("px",t.pixelValue,1)||y("em",t.emValue,1);}function y(t,e,n){var r=m(e);if(r)return{type:t,value:r[n]};}function m(t){var n=/^[\n\r\t\s]+/.exec(e);n&&k(n[0].length);var r=t.exec(e);return r&&k(r[0].length),r;}function k(t){e=e.substring(t);}return function(t){var i;return e=t,i=d(r),e.length>0&&n("Invalid input not EOF"),i;};}(),eL=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,eI=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,eD=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,e_=/[\d.]+:(#[^\s]+|[^\)]+\))/gi,eG={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},eF=ei(function(t){return eR("angular"===t.type?Number(t.value):eG[t.value]||0,"deg");}),eB=ei(function(t){var e=50,n=50,r="%",i="%";if((null==t?void 0:t.type)==="position"){var a=t.value,o=a.x,s=a.y;(null==o?void 0:o.type)==="position-keyword"&&("left"===o.value?e=0:"center"===o.value?e=50:"right"===o.value?e=100:"top"===o.value?n=0:"bottom"===o.value&&(n=100)),(null==s?void 0:s.type)==="position-keyword"&&("left"===s.value?e=0:"center"===s.value?n=50:"right"===s.value?e=100:"top"===s.value?n=0:"bottom"===s.value&&(n=100)),((null==o?void 0:o.type)==="px"||(null==o?void 0:o.type)==="%"||(null==o?void 0:o.type)==="em")&&(r=null==o?void 0:o.type,e=Number(o.value)),((null==s?void 0:s.type)==="px"||(null==s?void 0:s.type)==="%"||(null==s?void 0:s.type)==="em")&&(i=null==s?void 0:s.type,n=Number(s.value));}return{cx:eR(e,r),cy:eR(n,i)};}),eU=ei(function(t){if(t.indexOf("linear")>-1||t.indexOf("radial")>-1)return eO(t).map(function(t){var e=t.type,n=t.orientation,r=t.colorStops;!function(t){var e=t.length;t[e-1].length=null!==(a=t[e-1].length)&&void 0!==a?a:{type:"%",value:"100"},e>1&&(t[0].length=null!==(o=t[0].length)&&void 0!==o?o:{type:"%",value:"0"});for(var n=0,r=Number(t[0].length.value),i=1;i<e;i++){var a,o,s,l=null===(s=t[i].length)||void 0===s?void 0:s.value;if(!(0,F.isNil)(l)&&!(0,F.isNil)(r)){for(var u=1;u<i-n;u++)t[n+u].length={type:"%",value:"".concat(r+(Number(l)-r)*u/(i-n))};n=i,r=Number(l);}}}(r);var i=r.map(function(t){var e,n;return{offset:eR(Number(t.length.value),"%"),color:(e=t.type,n=t.value,"hex"===e?"#".concat(n):"literal"===e?n:"rgb"===e?"rgb(".concat(n.join(","),")"):"rgba(".concat(n.join(","),")"))};});if("linear-gradient"===e)return new em(ey.LinearGradient,{angle:n?eF(n):eb,steps:i});if("radial-gradient"===e&&(n||(n=[{type:"shape",value:"circle"}]),"shape"===n[0].type&&"circle"===n[0].value)){var a,o=eB(n[0].at),s=o.cx,l=o.cy;if(n[0].style){var u=n[0].style,c=u.type,h=u.value;"extent-keyword"===c?(eP[h]||(eP[h]=new ek(h)),a=eP[h]):a=eR(h,c);}return new em(ey.RadialGradient,{cx:s,cy:l,size:a,steps:i});}});var e=t[0];if("("===t[1]||"("===t[2]){if("l"===e){var n=eL.exec(t);if(n){var r,i=(null===(r=n[2].match(e_))||void 0===r?void 0:r.map(function(t){return t.split(":");}))||[];return[new em(ey.LinearGradient,{angle:eR(parseFloat(n[1]),"deg"),steps:i.map(function(t){var e=(0,D.default)(t,2),n=e[0],r=e[1];return{offset:eR(100*Number(n),"%"),color:r};})})];}}else if("r"===e){var a=function(t){var e=eI.exec(t);if(e){var n,r=(null===(n=e[4].match(e_))||void 0===n?void 0:n.map(function(t){return t.split(":");}))||[];return{cx:eR(50,"%"),cy:eR(50,"%"),steps:r.map(function(t){var e=(0,D.default)(t,2),n=e[0],r=e[1];return{offset:eR(100*Number(n),"%"),color:r};})};}return null;}(t);if(a){if(!(0,F.isString)(a))return[new em(ey.RadialGradient,a)];t=a;}}else if("p"===e)return function(t){var e=eD.exec(t);if(e){var n=e[1],r=e[2];switch(n){case"a":n="repeat";break;case"x":n="repeat-x";break;case"y":n="repeat-y";break;default:n="no-repeat";}return{image:r,repetition:n};}return null;}(t);}});function eV(t){return t&&!(0,F.isNil)(t.r)&&!(0,F.isNil)(t.g)&&!(0,F.isNil)(t.b);}var ez=ei(function(t){if((e=t)&&e.image)return(0,A.default)({repetition:"repeat"},t);if((0,F.isNil)(t)&&(t=""),"transparent"===t)return eA;if("currentColor"===t)t="black";else if("none"===t)return eM;var e,n=eU(t);if(n)return n;var r=tJ(t),i=[0,0,0,0];return null!==r&&(i[0]=r.r||0,i[1]=r.g||0,i[2]=r.b||0,i[3]=r.opacity),eC.apply(void 0,i);});function eH(t,e){if(eV(t)&&eV(e))return[[Number(t.r),Number(t.g),Number(t.b),Number(t.alpha)],[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],function(t){var e=t.slice();if(e[3])for(var n=0;n<3;n++)e[n]=Math.round((0,F.clamp)(e[n],0,255));return e[3]=(0,F.clamp)(e[3],0,1),"rgba(".concat(e.join(","),")");}];}function eY(t,e){if((0,F.isNil)(e))return eR(0,"px");if(isFinite(Number(e="".concat(e).trim().toLowerCase()))){if("px".search(t)>=0)return eR(Number(e),"px");if("deg".search(t)>=0)return eR(Number(e),"deg");}var n=[];e=e.replace(t,function(t){return n.push(t),"U".concat(t);});var r="U(".concat(t.source,")");return n.map(function(t){return eR(Number(e.replace(RegExp("U".concat(t),"g"),"").replace(RegExp(r,"g"),"*0")),t);})[0];}var eW=function(t){return eY(/px/g,t);},eq=ei(eW);ei(function(t){return eY(RegExp("%","g"),t);});var eX=function(t){return(0,F.isNumber)(t)||isFinite(Number(t))?eR(Number(t)||0,"px"):eY(RegExp("px|%|em|rem","g"),t);},ej=ei(eX),e$=function(t){return eY(RegExp("deg|rad|grad|turn","g"),t);},eK=ei(e$);function eZ(t){var e=0;return t.unit===ea.kDegrees?e=t.value:t.unit===ea.kRadians?e=Number(t.value)*tv:t.unit===ea.kTurns?e=360*Number(t.value):t.value&&(e=t.value),e;}function eQ(t,e){var n;return(Array.isArray(t)?n=t.map(function(t){return Number(t);}):(0,F.isString)(t)?n=t.split(" ").map(function(t){return Number(t);}):(0,F.isNumber)(t)&&(n=[t]),2===e)?1===n.length?[n[0],n[0]]:[n[0],n[1]]:4===e?1===n.length?[n[0],n[0],n[0],n[0]]:2===n.length?[n[0],n[1],n[0],n[1]]:3===n.length?[n[0],n[1],n[2],n[1]]:[n[0],n[1],n[2],n[3]]:"even"===e&&n.length%2==1?[].concat((0,O.default)(n),(0,O.default)(n)):n;}function eJ(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t.unit===ea.kPixels)return Number(t.value);if(t.unit===ea.kPercentage&&n){var i=n.nodeName===j.GROUP?n.getLocalBounds():n.getGeometryBounds();return(r?i.min[e]:0)+t.value/100*i.halfExtents[e]*2;}return 0;}var e0=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function e1(t){return t.toString();}var e2=function(t){return"number"==typeof t?eR(t):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(t)?eR(Number(t)):eR(0);},e3=ei(e2);function e4(t,e){return[t,e,e1];}function e5(t,e){return function(n,r){return[n,r,function(n){return e1((0,F.clamp)(n,t,e));}];};}function e6(t,e){if(t.length===e.length)return[t,e,function(t){return t;}];}function e7(t){return 0===t.parsedStyle.d.totalLength&&(t.parsedStyle.d.totalLength=(0,F.getTotalLength)(t.parsedStyle.d.absolutePath)),t.parsedStyle.d.totalLength;}function e9(t,e){return t[0]===e[0]&&t[1]===e[1];}function e8(t,e){var n=t.prePoint,r=t.currentPoint,i=t.nextPoint,a=Math.pow(r[0]-n[0],2)+Math.pow(r[1]-n[1],2),o=Math.pow(r[0]-i[0],2)+Math.pow(r[1]-i[1],2),s=Math.acos((a+o-(Math.pow(n[0]-i[0],2)+Math.pow(n[1]-i[1],2)))/(2*Math.sqrt(a)*Math.sqrt(o)));if(!s||0===Math.sin(s)||(0,F.isNumberEqual)(s,0))return{xExtra:0,yExtra:0};var l=Math.abs(Math.atan2(i[1]-r[1],i[0]-r[0])),u=Math.abs(Math.atan2(i[0]-r[0],i[1]-r[1]));return{xExtra:e/2*(1/Math.sin(s/2))*Math.cos(s/2-(l=l>Math.PI/2?Math.PI-l:l))-e/2||0,yExtra:e/2*(1/Math.sin(s/2))*Math.cos((u=u>Math.PI/2?Math.PI-u:u)-s/2)-e/2||0};}function nt(t,e){return[e[0]+(e[0]-t[0]),e[1]+(e[1]-t[1])];}ei(function(t){return(0,F.isString)(t)?t.split(" ").map(e3):t.map(e3);});var ne=function(t,e){var n=t.x*e.x+t.y*e.y,r=Math.sqrt((Math.pow(t.x,2)+Math.pow(t.y,2))*(Math.pow(e.x,2)+Math.pow(e.y,2)));return(t.x*e.y-t.y*e.x<0?-1:1)*Math.acos(n/r);},nn=function(t,e,n,r,i,a,o,s){e=Math.abs(e),n=Math.abs(n);var l=(r=(0,F.mod)(r,360))*tf;if(t.x===o.x&&t.y===o.y)return{x:t.x,y:t.y,ellipticalArcAngle:0};if(0===e||0===n)return{x:0,y:0,ellipticalArcAngle:0};var u=(t.x-o.x)/2,c=(t.y-o.y)/2,h={x:Math.cos(l)*u+Math.sin(l)*c,y:-Math.sin(l)*u+Math.cos(l)*c},d=Math.pow(h.x,2)/Math.pow(e,2)+Math.pow(h.y,2)/Math.pow(n,2);d>1&&(e*=Math.sqrt(d),n*=Math.sqrt(d));var f=(Math.pow(e,2)*Math.pow(n,2)-Math.pow(e,2)*Math.pow(h.y,2)-Math.pow(n,2)*Math.pow(h.x,2))/(Math.pow(e,2)*Math.pow(h.y,2)+Math.pow(n,2)*Math.pow(h.x,2)),v=(i!==a?1:-1)*Math.sqrt(f=f<0?0:f),p={x:v*(e*h.y/n),y:v*(-(n*h.x)/e)},g={x:Math.cos(l)*p.x-Math.sin(l)*p.y+(t.x+o.x)/2,y:Math.sin(l)*p.x+Math.cos(l)*p.y+(t.y+o.y)/2},y={x:(h.x-p.x)/e,y:(h.y-p.y)/n},m=ne({x:1,y:0},y),k=ne(y,{x:(-h.x-p.x)/e,y:(-h.y-p.y)/n});!a&&k>0?k-=2*Math.PI:a&&k<0&&(k+=2*Math.PI);var E=m+(k%=2*Math.PI)*s,x=e*Math.cos(E),T=n*Math.sin(E);return{x:Math.cos(l)*x-Math.sin(l)*T+g.x,y:Math.sin(l)*x+Math.cos(l)*T+g.y,ellipticalArcStartAngle:m,ellipticalArcEndAngle:m+k,ellipticalArcAngle:E,ellipticalArcCenter:g,resultantRx:e,resultantRy:n};};function nr(t,e){var n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=t.arcParams,i=r.rx,a=void 0===i?0:i,o=r.ry,s=void 0===o?0:o,l=r.xRotation,u=r.arcFlag,c=r.sweepFlag,h=nn({x:t.prePoint[0],y:t.prePoint[1]},a,s,l,!!u,!!c,{x:t.currentPoint[0],y:t.currentPoint[1]},e),d=nn({x:t.prePoint[0],y:t.prePoint[1]},a,s,l,!!u,!!c,{x:t.currentPoint[0],y:t.currentPoint[1]},n?e+.005:e-.005),f=d.x-h.x,v=d.y-h.y,p=Math.sqrt(f*f+v*v);return{x:-f/p,y:-v/p};}function ni(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1]);}function na(t,e){return ni(t)*ni(e)?(t[0]*e[0]+t[1]*e[1])/(ni(t)*ni(e)):1;}function no(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(na(t,e));}var ns=function(t){if(""===t||Array.isArray(t)&&0===t.length)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};try{e=(0,F.normalizePath)(t);}catch(n){e=(0,F.normalizePath)(""),console.error("[g]: Invalid SVG Path definition: ".concat(t));}!function(t){for(var e=0;e<t.length;e++){var n=t[e-1],r=t[e];if("M"===r[0]&&n){var i=n[0],a=[r[1],r[2]],o=void 0;"L"===i||"M"===i?o=[n[1],n[2]]:("C"===i||"A"===i||"Q"===i)&&(o=[n[n.length-2],n[n.length-1]]),o&&e9(a,o)&&(t.splice(e,1),e--);}}}(e);var e,n=function(t){for(var e=!1,n=t.length,r=0;r<n;r++){var i=t[r][0];if("C"===i||"A"===i||"Q"===i){e=!0;break;}}return e;}(e),r=function(t){for(var e=[],n=[],r=[],i=0;i<t.length;i++){var a=t[i],o=a[0];"M"===o?(r.length&&(n.push(r),r=[]),r.push([a[1],a[2]])):"Z"===o?r.length&&(e.push(r),r=[]):r.push([a[1],a[2]]);}return r.length>0&&n.push(r),{polygons:e,polylines:n};}(e),i=r.polygons,a=r.polylines,o=function(t){for(var e=[],n=null,r=null,i=null,a=0,o=t.length,s=0;s<o;s++){var l=t[s];r=t[s+1];var u=l[0],c={command:u,prePoint:n,params:l,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(u){case"M":i=[l[1],l[2]],a=s;break;case"A":var h=function(t,e){var n=e[1],r=e[2],i=(0,F.mod)(e[3]*tf,2*Math.PI),a=e[4],o=e[5],s=t[0],l=t[1],u=e[6],c=e[7],h=Math.cos(i)*(s-u)/2+Math.sin(i)*(l-c)/2,d=-1*Math.sin(i)*(s-u)/2+Math.cos(i)*(l-c)/2,f=h*h/(n*n)+d*d/(r*r);f>1&&(n*=Math.sqrt(f),r*=Math.sqrt(f));var v=n*n*(d*d)+r*r*(h*h),p=v?Math.sqrt((n*n*(r*r)-v)/v):1;a===o&&(p*=-1),isNaN(p)&&(p=0);var g=r?p*n*d/r:0,y=n?-(p*r)*h/n:0,m=(s+u)/2+Math.cos(i)*g-Math.sin(i)*y,k=(l+c)/2+Math.sin(i)*g+Math.cos(i)*y,E=[(h-g)/n,(d-y)/r],x=[(-1*h-g)/n,(-1*d-y)/r],T=no([1,0],E),N=no(E,x);return -1>=na(E,x)&&(N=Math.PI),na(E,x)>=1&&(N=0),0===o&&N>0&&(N-=2*Math.PI),1===o&&N<0&&(N+=2*Math.PI),{cx:m,cy:k,rx:e9(t,[u,c])?0:n,ry:e9(t,[u,c])?0:r,startAngle:T,endAngle:T+N,xRotation:i,arcFlag:a,sweepFlag:o};}(n,l);c.arcParams=h;}if("Z"===u)n=i,r=t[a+1];else{var d=l.length;n=[l[d-2],l[d-1]];}r&&"Z"===r[0]&&(r=t[a],e[a]&&(e[a].prePoint=n)),c.currentPoint=n,e[a]&&e9(n,e[a].currentPoint)&&(e[a].prePoint=c.prePoint);var f=r?[r[r.length-2],r[r.length-1]]:null;c.nextPoint=f;var v=c.prePoint;if(["L","H","V"].includes(u))c.startTangent=[v[0]-n[0],v[1]-n[1]],c.endTangent=[n[0]-v[0],n[1]-v[1]];else if("Q"===u){var p=[l[1],l[2]];c.startTangent=[v[0]-p[0],v[1]-p[1]],c.endTangent=[n[0]-p[0],n[1]-p[1]];}else if("T"===u){var g=e[s-1],y=nt(g.currentPoint,v);"Q"===g.command?(c.command="Q",c.startTangent=[v[0]-y[0],v[1]-y[1]],c.endTangent=[n[0]-y[0],n[1]-y[1]]):(c.command="TL",c.startTangent=[v[0]-n[0],v[1]-n[1]],c.endTangent=[n[0]-v[0],n[1]-v[1]]);}else if("C"===u){var m=[l[1],l[2]],k=[l[3],l[4]];c.startTangent=[v[0]-m[0],v[1]-m[1]],c.endTangent=[n[0]-k[0],n[1]-k[1]],0===c.startTangent[0]&&0===c.startTangent[1]&&(c.startTangent=[m[0]-k[0],m[1]-k[1]]),0===c.endTangent[0]&&0===c.endTangent[1]&&(c.endTangent=[k[0]-m[0],k[1]-m[1]]);}else if("S"===u){var E=e[s-1],x=nt(E.currentPoint,v),T=[l[1],l[2]];"C"===E.command?(c.command="C",c.startTangent=[v[0]-x[0],v[1]-x[1]]):(c.command="SQ",c.startTangent=[v[0]-T[0],v[1]-T[1]]),c.endTangent=[n[0]-T[0],n[1]-T[1]];}else if("A"===u){var N=nr(c,0),b=N.x,S=N.y,w=nr(c,1,!1),P=w.x,M=w.y;c.startTangent=[b,S],c.endTangent=[P,M];}e.push(c);}return e;}(e),s=function(t,e){for(var n=[],r=[],i=[],a=0;a<t.length;a++){var o=t[a],s=o.currentPoint,l=o.params,u=o.prePoint,c=void 0;switch(o.command){case"Q":c=(0,z.quadBox)(u[0],u[1],l[1],l[2],l[3],l[4]);break;case"C":c=(0,z.cubicBox)(u[0],u[1],l[1],l[2],l[3],l[4],l[5],l[6]);break;case"A":var h=o.arcParams;c=(0,z.arcBox)(h.cx,h.cy,h.rx,h.ry,h.xRotation,h.startAngle,h.endAngle);break;default:n.push(s[0]),r.push(s[1]);}c&&(o.box=c,n.push(c.x,c.x+c.width),r.push(c.y,c.y+c.height));}n=n.filter(function(t){return!Number.isNaN(t)&&t!==1/0&&t!==-1/0;}),r=r.filter(function(t){return!Number.isNaN(t)&&t!==1/0&&t!==-1/0;});var d=(0,F.min)(n),f=(0,F.min)(r),v=(0,F.max)(n),p=(0,F.max)(r);if(0===i.length)return{x:d,y:f,width:v-d,height:p-f};for(var g=0;g<i.length;g++){var y=i[g],m=y.currentPoint;m[0]===d?d-=e8(y,0).xExtra:m[0]===v&&(v+=e8(y,0).xExtra),m[1]===f?f-=e8(y,e).yExtra:m[1]===p&&(p+=e8(y,e).yExtra);}return{x:d,y:f,width:v-d,height:p-f};}(o,0),l=s.x,u=s.y,c=s.width,h=s.height;return{absolutePath:e,hasArc:n,segments:o,polygons:i,polylines:a,totalLength:0,rect:{x:Number.isFinite(l)?l:0,y:Number.isFinite(u)?u:0,width:Number.isFinite(c)?c:0,height:Number.isFinite(h)?h:0}};},nl=ei(ns);function nu(t){return(0,F.isString)(t)?nl(t):ns(t);}function nc(t,e,n){var r=t.curve,i=e.curve;r&&0!==r.length||(r=(0,F.path2Curve)(t.absolutePath,!1),t.curve=r),i&&0!==i.length||(i=(0,F.path2Curve)(e.absolutePath,!1),e.curve=i);var a=[r,i];r.length!==i.length&&(a=(0,F.equalizeSegments)(r,i));var o=(0,F.getDrawDirection)(a[0])!==(0,F.getDrawDirection)(a[1])?(0,F.reverseCurve)(a[0]):(0,F.clonePath)(a[0]);return[o,(0,F.getRotatedCurve)(a[1],o),function(t){return t;}];}function nh(t,e){return[t.points,e.points,function(t){return t;}];}var nd=/\s*(\w+)\(([^)]*)\)/g;function nf(t){return function(e){var n=0;return t.map(function(t){return null===t?e[n++]:t;});};}function nv(t){return t;}var np={matrix:["NNNNNN",[null,null,0,0,null,null,0,0,0,0,1,0,null,null,0,1],nv],matrix3d:["NNNNNNNNNNNNNNNN",nv],rotate:["A"],rotateX:["A"],rotateY:["A"],rotateZ:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",nf([null,null,new eT(1)]),nv],scaleX:["N",nf([null,new eT(1),new eT(1)]),nf([null,new eT(1)])],scaleY:["N",nf([new eT(1),null,new eT(1)]),nf([new eT(1),null])],scaleZ:["N",nf([new eT(1),new eT(1),null])],scale3d:["NNN",nv],skew:["Aa",null,nv],skewX:["A",null,nf([null,eb])],skewY:["A",null,nf([eb,null])],translate:["Tt",nf([null,null,eN]),nv],translateX:["T",nf([null,eN,eN]),nf([null,eN])],translateY:["T",nf([eN,null,eN]),nf([eN,null])],translateZ:["L",nf([eN,eN,null])],translate3d:["TTL",nv]};function ng(t){for(var e=[],n=t.length,r=0;r<n;r++){var i=t[r],a=i[0],o=i.slice(1);if("translate"===a||"skew"===a?1===o.length&&o.push(0):"scale"===a&&1===o.length&&o.push(o[0]),!np[a])return[];var s=o.map(function(t){return eR(t);});e.push({t:a,d:s});}return e;}function ny(t){if(Array.isArray(t))return ng(t);if("none"===(t=(t||"none").trim()))return[];var e,n=[],r=0;for(nd.lastIndex=0;(e=nd.exec(t))&&e.index===r;){r=e.index+e[0].length;var i=e[1],a=np[i];if(!a)break;var o=e[2].split(","),s=a[0];if(s.length<o.length)break;for(var l=[],u=0;u<s.length;u++){var c=o[u],h=s[u],d=void 0;if(void 0===(d=c?({A:function(t){return"0"===t.trim()?eb:e$(t);},N:e2,T:eX,L:eW})[h.toUpperCase()](c):({a:eb,n:l[0],t:eN})[h]))return[];l.push(d);}if(n.push({t:i,d:l}),nd.lastIndex===t.length)return n;}return[];}function nm(t){switch(t.t){case"rotateX":return[1,0,0,0,0,Math.cos(i=eZ(t.d[0])*tf),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1];case"rotateY":return[Math.cos(i=eZ(t.d[0])*tf),0,-Math.sin(i),0,0,1,0,0,Math.sin(i),0,Math.cos(i),0,0,0,0,1];case"rotate":case"rotateZ":return[Math.cos(i=eZ(t.d[0])*tf),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1,0,0,0,0,1];case"rotate3d":e=t.d[0].value,n=t.d[1].value,r=t.d[2].value,i=eZ(t.d[3])*tf;var e,n,r,i,a=e*e+n*n+r*r;if(0===a)e=1,n=0,r=0;else if(1!==a){var o=Math.sqrt(a);e/=o,n/=o,r/=o;}var s=Math.sin(i/2),l=s*Math.cos(i/2),u=s*s;return[1-2*(n*n+r*r)*u,2*(e*n*u+r*l),2*(e*r*u-n*l),0,2*(e*n*u-r*l),1-2*(e*e+r*r)*u,2*(n*r*u+e*l),0,2*(e*r*u+n*l),2*(n*r*u-e*l),1-2*(e*e+n*n)*u,0,0,0,0,1];case"scale":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scaleX":return[t.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaleY":return[1,0,0,0,0,t.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scaleZ":return[1,0,0,0,0,1,0,0,0,0,t.d[0].value,0,0,0,0,1];case"scale3d":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,t.d[2].value,0,0,0,0,1];case"skew":var c=eZ(t.d[0])*tf;return[1,Math.tan(eZ(t.d[1])*tf),0,0,Math.tan(c),1,0,0,0,0,1,0,0,0,0,1];case"skewX":return[1,0,0,0,Math.tan(i=eZ(t.d[0])*tf),1,0,0,0,0,1,0,0,0,0,1];case"skewY":return[1,Math.tan(i=eZ(t.d[0])*tf),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return[1,0,0,0,0,1,0,0,0,0,1,0,e=eJ(t.d[0],0,null)||0,n=eJ(t.d[1],0,null)||0,0,1];case"translateX":return[1,0,0,0,0,1,0,0,0,0,1,0,e=eJ(t.d[0],0,null)||0,0,0,1];case"translateY":return[1,0,0,0,0,1,0,0,0,0,1,0,0,n=eJ(t.d[0],0,null)||0,0,1];case"translateZ":return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,r=eJ(t.d[0],0,null)||0,1];case"translate3d":return[1,0,0,0,0,1,0,0,0,0,1,0,e=eJ(t.d[0],0,null)||0,n=eJ(t.d[1],0,null)||0,r=eJ(t.d[2],0,null)||0,1];case"perspective":var h=eJ(t.d[0],0,null)||0;return[1,0,0,0,0,1,0,0,0,0,1,h?-1/h:0,0,0,0,1];case"matrix":return[t.d[0].value,t.d[1].value,0,0,t.d[2].value,t.d[3].value,0,0,0,0,1,0,t.d[4].value,t.d[5].value,0,1];case"matrix3d":return t.d.map(function(t){return t.value;});}}function nk(t,e){return[t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12]*e[3],t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13]*e[3],t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]*e[3],t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15]*e[3],t[0]*e[4]+t[4]*e[5]+t[8]*e[6]+t[12]*e[7],t[1]*e[4]+t[5]*e[5]+t[9]*e[6]+t[13]*e[7],t[2]*e[4]+t[6]*e[5]+t[10]*e[6]+t[14]*e[7],t[3]*e[4]+t[7]*e[5]+t[11]*e[6]+t[15]*e[7],t[0]*e[8]+t[4]*e[9]+t[8]*e[10]+t[12]*e[11],t[1]*e[8]+t[5]*e[9]+t[9]*e[10]+t[13]*e[11],t[2]*e[8]+t[6]*e[9]+t[10]*e[10]+t[14]*e[11],t[3]*e[8]+t[7]*e[9]+t[11]*e[10]+t[15]*e[11],t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12]*e[15],t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13]*e[15],t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14]*e[15],t[3]*e[12]+t[7]*e[13]+t[11]*e[14]+t[15]*e[15]];}function nE(t){var e=[0,0,0],n=[1,1,1],r=[0,0,0],i=[0,0,0,1],a=[0,0,0,1];return!function(t,e,n,r,i,a){if(!(!function(t,e){var n=e[15];if(0===n)return!1;for(var r=1/n,i=0;i<16;i++)t[i]=e[i]*r;return!0;}(tm,t)||(G.mat4.copy(tk,tm),tk[3]=0,tk[7]=0,tk[11]=0,tk[15]=1,1e-8>Math.abs(G.mat4.determinant(tk))))){var o=tm[3],s=tm[7],l=tm[11],u=tm[12],c=tm[13],h=tm[14],d=tm[15];if(0!==o||0!==s||0!==l){if(tE[0]=o,tE[1]=s,tE[2]=l,tE[3]=d,!G.mat4.invert(tk,tk))return;G.mat4.transpose(tk,tk),G.vec4.transformMat4(i,tE,tk);}else i[0]=i[1]=i[2]=0,i[3]=1;if(e[0]=u,e[1]=c,e[2]=h,tx[0][0]=tm[0],tx[0][1]=tm[1],tx[0][2]=tm[2],tx[1][0]=tm[4],tx[1][1]=tm[5],tx[1][2]=tm[6],tx[2][0]=tm[8],tx[2][1]=tm[9],tx[2][2]=tm[10],n[0]=G.vec3.length(tx[0]),G.vec3.normalize(tx[0],tx[0]),r[0]=G.vec3.dot(tx[0],tx[1]),tN(tx[1],tx[1],tx[0],1,-r[0]),n[1]=G.vec3.length(tx[1]),G.vec3.normalize(tx[1],tx[1]),r[0]/=n[1],r[1]=G.vec3.dot(tx[0],tx[2]),tN(tx[2],tx[2],tx[0],1,-r[1]),r[2]=G.vec3.dot(tx[1],tx[2]),tN(tx[2],tx[2],tx[1],1,-r[2]),n[2]=G.vec3.length(tx[2]),G.vec3.normalize(tx[2],tx[2]),r[1]/=n[2],r[2]/=n[2],G.vec3.cross(tT,tx[1],tx[2]),0>G.vec3.dot(tx[0],tT))for(var f=0;f<3;f++)n[f]*=-1,tx[f][0]*=-1,tx[f][1]*=-1,tx[f][2]*=-1;a[0]=.5*Math.sqrt(Math.max(1+tx[0][0]-tx[1][1]-tx[2][2],0)),a[1]=.5*Math.sqrt(Math.max(1-tx[0][0]+tx[1][1]-tx[2][2],0)),a[2]=.5*Math.sqrt(Math.max(1-tx[0][0]-tx[1][1]+tx[2][2],0)),a[3]=.5*Math.sqrt(Math.max(1+tx[0][0]+tx[1][1]+tx[2][2],0)),tx[2][1]>tx[1][2]&&(a[0]=-a[0]),tx[0][2]>tx[2][0]&&(a[1]=-a[1]),tx[1][0]>tx[0][1]&&(a[2]=-a[2]);}}(0===t.length?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:t.map(nm).reduce(nk),e,n,r,i,a),[[e,n,r,a,i]];}var nx=function(){function t(t,e){for(var n=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],r=0;r<4;r++)for(var i=0;i<4;i++)for(var a=0;a<4;a++)n[r][i]+=e[r][a]*t[a][i];return n;}return function(e,n,r,i,a){for(var o,s=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],l=0;l<4;l++)s[l][3]=a[l];for(var u=0;u<3;u++)for(var c=0;c<3;c++)s[3][u]+=e[c]*s[c][u];var h=i[0],d=i[1],f=i[2],v=i[3],p=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];p[0][0]=1-2*(d*d+f*f),p[0][1]=2*(h*d-f*v),p[0][2]=2*(h*f+d*v),p[1][0]=2*(h*d+f*v),p[1][1]=1-2*(h*h+f*f),p[1][2]=2*(d*f-h*v),p[2][0]=2*(h*f-d*v),p[2][1]=2*(d*f+h*v),p[2][2]=1-2*(h*h+d*d),s=t(s,p);var g=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];r[2]&&(g[2][1]=r[2],s=t(s,g)),r[1]&&(g[2][1]=0,g[2][0]=r[0],s=t(s,g)),r[0]&&(g[2][0]=0,g[1][0]=r[0],s=t(s,g));for(var y=0;y<3;y++)for(var m=0;m<3;m++)s[y][m]*=n[y];return 0===(o=s)[0][2]&&0===o[0][3]&&0===o[1][2]&&0===o[1][3]&&0===o[2][0]&&0===o[2][1]&&1===o[2][2]&&0===o[2][3]&&0===o[3][2]&&1===o[3][3]?[s[0][0],s[0][1],s[1][0],s[1][1],s[3][0],s[3][1]]:s[0].concat(s[1],s[2],s[3]);};}();function nT(t){return t.toFixed(6).replace(".000000","");}function nN(t,e){var n,r;return(t.decompositionPair!==e&&(t.decompositionPair=e,n=nE(t)),e.decompositionPair!==t&&(e.decompositionPair=t,r=nE(e)),null===n[0]||null===r[0])?[[!1],[!0],function(n){return n?e[0].d:t[0].d;}]:(n[0].push(0),r[0].push(1),[n,r,function(t){var e=function(t,e,n){var r=function(t,e){for(var n=0,r=0;r<t.length;r++)n+=t[r]*e[r];return n;}(t,e);r=(0,F.clamp)(r,-1,1);var i=[];if(1===r)i=t;else for(var a=Math.acos(r),o=1*Math.sin(n*a)/Math.sqrt(1-r*r),s=0;s<4;s++)i.push(t[s]*(Math.cos(n*a)-r*o)+e[s]*o);return i;}(n[0][3],r[0][3],t[5]);return nx(t[0],t[1],t[2],e,t[4]).map(nT).join(",");}]);}function nb(t){return t.replace(/[XY]/,"");}function nS(t){return t.replace(/(X|Y|Z|3d)?$/,"3d");}function nw(t,e,n){var r=!1;if(!t.length||!e.length){t.length||(r=!0,t=e,e=[]);for(var i=0;i<t.length;i++)!function(){var n=t[i],r=n.t,a=n.d,o="scale"===r.substring(0,5)?1:0;e.push({t:r,d:a.map(function(t){return"number"==typeof t?eR(o):eR(o,t.unit);})});}();}var a=[],o=[],s=[];if(t.length!==e.length){var l=nN(t,e);a=[l[0]],o=[l[1]],s=[["matrix",[l[2]]]];}else for(var u=0;u<t.length;u++){var c=t[u].t,h=e[u].t,d=t[u].d,f=e[u].d,v=np[c],p=np[h],g=void 0;if("perspective"===c&&"perspective"===h||("matrix"===c||"matrix3d"===c)&&("matrix"===h||"matrix3d"===h)){var y=nN([t[u]],[e[u]]);a.push(y[0]),o.push(y[1]),s.push(["matrix",[y[2]]]);continue;}if(c===h)g=c;else if(v[2]&&p[2]&&nb(c)===nb(h))g=nb(c),d=v[2](d),f=p[2](f);else if(v[1]&&p[1]&&nS(c)===nS(h))g=nS(c),d=v[1](d),f=p[1](f);else{var m=nN(t,e);a=[m[0]],o=[m[1]],s=[["matrix",[m[2]]]];break;}for(var k=[],E=[],x=[],T=0;T<d.length;T++){var N=function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a="",o=t.value||0,s=e.value||0,l=ex(t.unit),u=t.convertTo(l),c=e.convertTo(l);return u&&c?(o=u.value,s=c.value,a=ev(t.unit)):(eT.isLength(t.unit)||eT.isLength(e.unit))&&(o=eJ(t,i,n),s=eJ(e,i,n),a="px"),[o,s,function(t){return r&&(t=Math.max(t,0)),t+a;}];}(d[T],f[T],n,!1,T);k[T]=N[0],E[T]=N[1],x.push(N[2]);}a.push(k),o.push(E),s.push([g,x]);}if(r){var b=a;a=o,o=b;}return[a,o,function(t){return t.map(function(t,e){var n=t.map(function(t,n){return s[e][1][n](t);}).join(",");return"matrix"===s[e][0]&&16===n.split(",").length&&(s[e][0]="matrix3d"),"matrix3d"===s[e][0]&&6===n.split(",").length&&(s[e][0]="matrix"),"".concat(s[e][0],"(").concat(n,")");}).join(" ");}];}var nP=ei(function(t){if((0,F.isString)(t)){if("text-anchor"===t)return[eR(0,"px"),eR(0,"px")];var e=t.split(" ");return(1===e.length&&("top"===e[0]||"bottom"===e[0]?(e[1]=e[0],e[0]="center"):e[1]="center"),2!==e.length)?null:[ej(nM(e[0])),ej(nM(e[1]))];}return[eR(t[0]||0,"px"),eR(t[1]||0,"px")];});function nM(t){return"center"===t?"50%":"left"===t||"top"===t?"0%":"right"===t||"bottom"===t?"100%":t;}var nA=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:t_.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:t_.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:t_.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:t_.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:t_.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:t_.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:t_.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:t_.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:t_.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:t_.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:t_.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:t_.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:t_.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:t_.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:t_.FILTER},{n:"clipPath",syntax:t_.DEFINED_PATH},{n:"textPath",syntax:t_.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:t_.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:t_.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:t_.COORDINATE},{n:"y1",int:!0,l:!0,syntax:t_.COORDINATE},{n:"z1",int:!0,l:!0,syntax:t_.COORDINATE},{n:"x2",int:!0,l:!0,syntax:t_.COORDINATE},{n:"y2",int:!0,l:!0,syntax:t_.COORDINATE},{n:"z2",int:!0,l:!0,syntax:t_.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:t_.PATH,p:50},{n:"points",int:!0,l:!0,syntax:t_.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:t_.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:t_.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:t_.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:t_.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:t_.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:t_.NUMBER,d:function(t){return t===j.PATH||t===j.POLYGON||t===j.POLYLINE?"4":"10";}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:t_.MARKER},{n:"markerEnd",syntax:t_.MARKER},{n:"markerMid",syntax:t_.MARKER},{n:"markerStartOffset",syntax:t_.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:t_.LENGTH,l:!0,int:!0,d:"0"}],nC=new Set(nA.filter(function(t){return!!t.l;}).map(function(t){return t.n;})),nR={},nO=(0,R.default)(function t(e){var n=this;(0,C.default)(this,t),this.runtime=e,nA.forEach(function(t){n.registerMetadata(t);});},[{key:"registerMetadata",value:function(t){[t.n].concat((0,O.default)(t.a||[])).forEach(function(e){nR[e]=t;});}},{key:"getPropertySyntax",value:function(t){return this.runtime.CSSPropertySyntaxFactory[t];}},{key:"processProperties",value:function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[],memoize:!0};Object.assign(t.attributes,e);var i=t.parsedStyle.clipPath,a=t.parsedStyle.offsetPath;!function(t,e){var n=nL(t);for(var r in e)n.has(r)&&(t.parsedStyle[r]=e[r]);}(t,e);var o=!!r.forceUpdateGeometry;if(!o){for(var s in e)if(nC.has(s)){o=!0;break;}}var l=nL(t);l.has("fill")&&e.fill&&(t.parsedStyle.fill=ez(e.fill)),l.has("stroke")&&e.stroke&&(t.parsedStyle.stroke=ez(e.stroke)),l.has("shadowColor")&&e.shadowColor&&(t.parsedStyle.shadowColor=ez(e.shadowColor)),l.has("filter")&&e.filter&&(t.parsedStyle.filter=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if("none"===(e=e.toLowerCase().trim()))return[];for(var n=/\s*([\w-]+)\(([^)]*)\)/g,r=[],i=0;(t=n.exec(e))&&t.index===i;)if(i=t.index+t[0].length,e0.indexOf(t[1])>-1&&r.push({name:t[1],params:t[2].split(" ").map(function(t){return eY(/deg|rad|grad|turn|px|%/g,t)||ez(t);})}),n.lastIndex===e.length)return r;return[];}(e.filter)),l.has("radius")&&!(0,F.isNil)(e.radius)&&(t.parsedStyle.radius=eQ(e.radius,4)),l.has("lineDash")&&!(0,F.isNil)(e.lineDash)&&(t.parsedStyle.lineDash=eQ(e.lineDash,"even")),l.has("points")&&e.points&&(t.parsedStyle.points=(n=e.points,{points:(0,F.isString)(n)?n.split(" ").map(function(t){var e=t.split(","),n=(0,D.default)(e,2),r=n[0],i=n[1];return[Number(r),Number(i)];}):n,totalLength:0,segments:[]})),l.has("d")&&""===e.d&&(t.parsedStyle.d=(0,A.default)({},tD)),l.has("d")&&e.d&&(t.parsedStyle.d=nu(e.d)),l.has("textTransform")&&e.textTransform&&this.runtime.CSSPropertySyntaxFactory[t_.TEXT_TRANSFORM].calculator(null,null,{value:e.textTransform},t,null),l.has("clipPath")&&!(0,F.isUndefined)(e.clipPath)&&this.runtime.CSSPropertySyntaxFactory[t_.DEFINED_PATH].calculator("clipPath",i,e.clipPath,t,this.runtime),l.has("offsetPath")&&e.offsetPath&&this.runtime.CSSPropertySyntaxFactory[t_.DEFINED_PATH].calculator("offsetPath",a,e.offsetPath,t,this.runtime),l.has("transform")&&e.transform&&(t.parsedStyle.transform=function(t){if(Array.isArray(t))return ng(t);if("none"===(t=(t||"none").trim()))return[];var e,n=[],r=0;for(nd.lastIndex=0;(e=nd.exec(t))&&e.index===r;){r=e.index+e[0].length;var i=e[1],a=np[i];if(!a)break;var o=e[2].split(","),s=a[0];if(s.length<o.length)break;for(var l=[],u=0;u<s.length;u++){var c=o[u],h=s[u],d=void 0;if(void 0===(d=c?({A:function(t){return"0"===t.trim()?eb:eK(t);},N:e3,T:ej,L:eq})[h.toUpperCase()](c):({a:eb,n:l[0],t:eN})[h]))return[];l.push(d);}if(n.push({t:i,d:l}),nd.lastIndex===t.length)return n;}return[];}(e.transform)),l.has("transformOrigin")&&e.transformOrigin&&(t.parsedStyle.transformOrigin=nP(e.transformOrigin)),l.has("markerStart")&&e.markerStart&&(t.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory[t_.MARKER].calculator(null,e.markerStart,e.markerStart,null,null)),l.has("markerEnd")&&e.markerEnd&&(t.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory[t_.MARKER].calculator(null,e.markerEnd,e.markerEnd,null,null)),l.has("markerMid")&&e.markerMid&&(t.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory[t_.MARKER].calculator("",e.markerMid,e.markerMid,null,null)),l.has("zIndex")&&!(0,F.isNil)(e.zIndex)&&this.runtime.CSSPropertySyntaxFactory[t_.Z_INDEX].postProcessor(t),l.has("offsetDistance")&&!(0,F.isNil)(e.offsetDistance)&&this.runtime.CSSPropertySyntaxFactory[t_.OFFSET_DISTANCE].postProcessor(t),l.has("transform")&&e.transform&&this.runtime.CSSPropertySyntaxFactory[t_.TRANSFORM].postProcessor(t),l.has("transformOrigin")&&e.transformOrigin&&this.runtime.CSSPropertySyntaxFactory[t_.TRANSFORM_ORIGIN].postProcessor(t),o&&(t.dirty(!0,!0),r.forceUpdateGeometry||this.runtime.sceneGraphService.dirtyToRoot(t));}},{key:"updateGeometry",value:function(t){var e=t.nodeName,n=this.runtime.geometryUpdaterFactory[e];if(n){var r=t.geometry;r.contentBounds||(r.contentBounds=new tr),r.renderBounds||(r.renderBounds=new tr);var i=t.parsedStyle,a=n.update(i,t),o=a.cx,s=a.cy,l=a.cz,u=a.hwidth,c=void 0===u?0:u,h=a.hheight,d=void 0===h?0:h,f=a.hdepth,v=[Math.abs(c),Math.abs(d),void 0===f?0:f],p=i.stroke,g=i.lineWidth,y=i.increasedLineWidthForHitTesting,m=i.shadowType,k=void 0===m?"outer":m,E=i.shadowColor,x=i.filter,T=i.transformOrigin,N=[void 0===o?0:o,void 0===s?0:s,void 0===l?0:l];r.contentBounds.update(N,v);var b=e===j.POLYLINE||e===j.POLYGON||e===j.PATH?Math.SQRT2:.5;if(p&&!p.isNone){var S=(((void 0===g?1:g)||0)+((void 0===y?0:y)||0))*b;v[0]+=S,v[1]+=S;}if(r.renderBounds.update(N,v),E&&k&&"inner"!==k){var w=r.renderBounds,P=w.min,M=w.max,A=i.shadowBlur,C=i.shadowOffsetX,R=i.shadowOffsetY,O=A||0,L=C||0,I=R||0,D=P[0]-O+L,_=M[0]+O+L,F=P[1]-O+I,B=M[1]+O+I;P[0]=Math.min(P[0],D),M[0]=Math.max(M[0],_),P[1]=Math.min(P[1],F),M[1]=Math.max(M[1],B),r.renderBounds.setMinMax(P,M);}(void 0===x?[]:x).forEach(function(t){var e=t.name,n=t.params;if("blur"===e){var i=n[0].value;r.renderBounds.update(r.renderBounds.center,G.vec3.add(r.renderBounds.halfExtents,r.renderBounds.halfExtents,[i,i,0]));}else if("drop-shadow"===e){var a=n[0].value,o=n[1].value,s=n[2].value,l=r.renderBounds,u=l.min,c=l.max,h=u[0]-s+a,d=c[0]+s+a,f=u[1]-s+o,v=c[1]+s+o;u[0]=Math.min(u[0],h),c[0]=Math.max(c[0],d),u[1]=Math.min(u[1],f),c[1]=Math.max(c[1],v),r.renderBounds.setMinMax(u,c);}}),t.geometry.dirty=!1;var U=d<0,V=(c<0?-1:1)*(T?eJ(T[0],0,t,!0):0),z=(U?-1:1)*(T?eJ(T[1],1,t,!0):0);(V||z)&&t.setOrigin(V,z);}}},{key:"updateSizeAttenuation",value:function(t,e){t.style.isSizeAttenuation?(t.style.rawLineWidth||(t.style.rawLineWidth=t.style.lineWidth),t.style.lineWidth=(t.style.rawLineWidth||1)/e,t.nodeName===j.CIRCLE&&(t.style.rawR||(t.style.rawR=t.style.r),t.style.r=(t.style.rawR||1)/e)):(t.style.rawLineWidth&&(t.style.lineWidth=t.style.rawLineWidth,delete t.style.rawLineWidth),t.nodeName===j.CIRCLE&&t.style.rawR&&(t.style.r=t.style.rawR,delete t.style.rawR));}}]);function nL(t){return t.constructor.PARSED_STYLE_LIST;}var nI=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e4;},[{key:"calculator",value:function(t,e,n,r){return eZ(n);}}]),nD=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r,i){return n instanceof ek&&(n=null),i.sceneGraphService.updateDisplayObjectDependency(t,e,n,r),"clipPath"===t&&r.forEach(function(t){0===t.childNodes.length&&i.sceneGraphService.dirtyToRoot(t);}),n;}}]),n_=(0,R.default)(function t(){(0,C.default)(this,t),this.parser=ez,this.mixer=eH;},[{key:"calculator",value:function(t,e,n,r){return n instanceof ek?"none"===n.value?eM:eA:n;}}]),nG=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n){return n instanceof ek?[]:n;}}]);function nF(t){var e=t.parsedStyle.fontSize;return(0,F.isNil)(e)?null:e;}var nB=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e4;},[{key:"calculator",value:function(t,e,n,r,i){if((0,F.isNumber)(n))return n;if(!eT.isRelativeUnit(n.unit))return n.value;if(n.unit===ea.kPercentage)return 0;if(n.unit===ea.kEms){if(r.parentNode){var a,o=nF(r.parentNode);if(o)return o*n.value;}return 0;}if(n.unit===ea.kRems){if(null!=r&&null!==(a=r.ownerDocument)&&void 0!==a&&a.documentElement){var s=nF(r.ownerDocument.documentElement);if(s)return s*n.value;}return 0;}}}]),nU=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e6;},[{key:"calculator",value:function(t,e,n){return n.map(function(t){return t.value;});}}]),nV=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e6;},[{key:"calculator",value:function(t,e,n){return n.map(function(t){return t.value;});}}]),nz=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){n instanceof ek&&(n=null);var i,a=null===(i=n)||void 0===i?void 0:i.cloneNode(!0);return a&&(a.style.isMarker=!0),a;}}]),nH=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e4;},[{key:"calculator",value:function(t,e,n){return n.value;}}]),nY=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e5(0,1);},[{key:"calculator",value:function(t,e,n){return n.value;}},{key:"postProcessor",value:function(t){var e=t.parsedStyle,n=e.offsetPath,r=e.offsetDistance;if(n){var i=n.nodeName;if(i===j.LINE||i===j.PATH||i===j.POLYLINE){var a=n.getPoint(r);a&&t.setLocalPosition(a.x,a.y);}}}}]),nW=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e5(0,1);},[{key:"calculator",value:function(t,e,n){return n.value;}}]),nq=(0,R.default)(function t(){(0,C.default)(this,t),this.parser=nu,this.mixer=nc;},[{key:"calculator",value:function(t,e,n){return n instanceof ek&&"unset"===n.value?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new tl(0,0,0,0)}:n;}}]),nX=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=nh;}),nj=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).mixer=e5(0,1/0),t;}return(0,I.default)(e,t),(0,R.default)(e);}(nB),n$=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){return n instanceof ek?"unset"===n.value?"":n.value:"".concat(n);}},{key:"postProcessor",value:function(t){t.nodeValue="".concat(t.parsedStyle.text)||"";}}]),nK=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){var i=r.getAttribute("text");if(i){var a=i;"capitalize"===n.value?a=i.charAt(0).toUpperCase()+i.slice(1):"lowercase"===n.value?a=i.toLowerCase():"uppercase"===n.value&&(a=i.toUpperCase()),r.parsedStyle.text=a;}return n.value;}}]);function nZ(t,e){var n=Number(t.parsedStyle.zIndex||0),r=Number(e.parsedStyle.zIndex||0);if(n===r){var i=t.parentNode;if(i){var a=i.childNodes||[];return a.indexOf(t)-a.indexOf(e);}}return n-r;}function nQ(t){var e,n=t;do{if(null===(e=n.parsedStyle)||void 0===e?void 0:e.clipPath)return n;n=n.parentElement;}while(null!==n)return null;}new WeakMap,"undefined"!=typeof window&&window.document;var nJ={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},n0="object"==typeof performance&&performance.now?performance:Date;function n1(t){return t.nodeName===j.FRAGMENT||t.getRootNode().nodeName===j.FRAGMENT;}function n2(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"auto",e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=!1,i=!1,a=!!e&&!e.isNone,o=!!n&&!n.isNone;return"visiblepainted"===t||"painted"===t||"auto"===t?(r=a,i=o):"visiblefill"===t||"fill"===t?r=!0:"visiblestroke"===t||"stroke"===t?i=!0:("visible"===t||"all"===t)&&(r=!0,i=!0),[r,i];}var n3=1,n4="object"==typeof self&&self.self===self?self:"object"==typeof X&&X.global===X?X:{},n5=Date.now(),n6={},n7=Date.now(),n9=function(t){if("function"!=typeof t)throw TypeError("".concat(t," is not a function"));var e=Date.now(),n=e-n7,r=n3++;return n6[r]=t,Object.keys(n6).length>1||setTimeout(function(){n7=e;var t=n6;n6={},Object.keys(t).forEach(function(e){return t[e](n4.performance&&"function"==typeof n4.performance.now?n4.performance.now():Date.now()-n5);});},n>16?0:16-n),r;},n8=function(t){return"string"!=typeof t?n9:""===t?n4.requestAnimationFrame:n4["".concat(t,"RequestAnimationFrame")];},rt=function(t,e){for(var n=0;void 0!==t[n];){if(e(t[n]))return t[n];n+=1;}}(["","webkit","moz","ms","o"],function(t){return!!n8(t);}),re=n8(rt),rn="string"!=typeof rt?function(t){delete n6[t];}:""===rt?n4.cancelAnimationFrame:n4["".concat(rt,"CancelAnimationFrame")]||n4["".concat(rt,"CancelRequestAnimationFrame")];n4.requestAnimationFrame=re,n4.cancelAnimationFrame=rn;var rr=(0,R.default)(function t(){(0,C.default)(this,t),this.callbacks=[];},[{key:"getCallbacksNum",value:function(){return this.callbacks.length;}},{key:"tapPromise",value:function(t,e){this.callbacks.push(e);}},{key:"promise",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return Promise.all(this.callbacks.map(function(t){return t.apply(void 0,e);}));}}]),ri=(0,R.default)(function t(){(0,C.default)(this,t),this.callbacks=[];},[{key:"tapPromise",value:function(t,e){this.callbacks.push(e);}},{key:"promise",value:(m=(0,Y.default)((0,H.default)().mark(function t(){var e,n,r,i,a=arguments;return(0,H.default)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.callbacks.length){t.next=6;break;}return t.next=1,(e=this.callbacks)[0].apply(e,a);case 1:n=t.sent,r=1;case 2:if(!(r<this.callbacks.length)){t.next=5;break;}return i=this.callbacks[r],t.next=3,i(n);case 3:n=t.sent;case 4:r++,t.next=2;break;case 5:return t.abrupt("return",n);case 6:return t.abrupt("return",null);case 7:case"end":return t.stop();}},t,this);})),function(){return m.apply(this,arguments);})}]),ra=(0,R.default)(function t(){(0,C.default)(this,t),this.callbacks=[];},[{key:"tap",value:function(t,e){this.callbacks.push(e);}},{key:"call",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=arguments;this.callbacks.forEach(function(t){t.apply(void 0,r);});}}]),ro=(0,R.default)(function t(){(0,C.default)(this,t),this.callbacks=[];},[{key:"tap",value:function(t,e){this.callbacks.push(e);}},{key:"call",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];if(this.callbacks.length){for(var r=arguments,i=this.callbacks[0].apply(void 0,r),a=1;a<this.callbacks.length;a++)i=(0,this.callbacks[a])(i);return i;}return null;}}]),rs=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],rl=/([\"\'])[^\'\"]+\1/;function ru(t){var e=t.fontSize,n=t.fontFamily,r=t.fontStyle,i=t.fontVariant,a=t.fontWeight;return{fontSize:void 0===e?16:e,fontFamily:void 0===n?"sans-serif":n,fontStyle:void 0===r?"normal":r,fontVariant:void 0===i?"normal":i,fontWeight:void 0===a?"normal":a};}var rc=ei(function(t){for(var e=ru(t),n=e.fontSize,r=e.fontFamily,i=e.fontStyle,a=e.fontVariant,o=e.fontWeight,s=(0,F.isNumber)(n)&&"".concat(n,"px")||"16px",l=r.split(","),u=l.length-1;u>=0;u--){var c=l[u].trim();!rl.test(c)&&0>rs.indexOf(c)&&(c='"'.concat(c,'"')),l[u]=c;}return"".concat(i," ").concat(a," ").concat(o," ").concat(s," ").concat(l.join(","));},function(t){var e=ru(t),n=e.fontSize,r=e.fontFamily,i=e.fontStyle,a=e.fontVariant,o=e.fontWeight;return"".concat(i,"_").concat(a,"_").concat(o,"_").concat(n,"_").concat(r);}),rh=function(t){return Math.max(t,1e-6);};function rd(t,e,n){return G.mat4.identity(t),t[4]=Math.tan(e),t[1]=Math.tan(n),t;}var rf=G.mat4.create(),rv=G.mat4.create(),rp={scale:function(t){G.mat4.fromScaling(rf,[t[0].value,t[1].value,1].map(function(t){return rh(t);}));},scaleX:function(t){G.mat4.fromScaling(rf,[t[0].value,1,1].map(function(t){return rh(t);}));},scaleY:function(t){G.mat4.fromScaling(rf,[1,t[0].value,1].map(function(t){return rh(t);}));},scaleZ:function(t){G.mat4.fromScaling(rf,[1,1,t[0].value].map(function(t){return rh(t);}));},scale3d:function(t){G.mat4.fromScaling(rf,[t[0].value,t[1].value,t[2].value].map(function(t){return rh(t);}));},translate:function(t){G.mat4.fromTranslation(rf,[t[0].value,t[1].value,0]);},translateX:function(t){G.mat4.fromTranslation(rf,[t[0].value,0,0]);},translateY:function(t){G.mat4.fromTranslation(rf,[0,t[0].value,0]);},translateZ:function(t){G.mat4.fromTranslation(rf,[0,0,t[0].value]);},translate3d:function(t){G.mat4.fromTranslation(rf,[t[0].value,t[1].value,t[2].value]);},rotate:function(t){G.mat4.fromZRotation(rf,eZ(t[0])*tf);},rotateX:function(t){G.mat4.fromXRotation(rf,eZ(t[0])*tf);},rotateY:function(t){G.mat4.fromYRotation(rf,eZ(t[0])*tf);},rotateZ:function(t){G.mat4.fromZRotation(rf,eZ(t[0])*tf);},rotate3d:function(t){G.mat4.fromRotation(rf,eZ(t[3])*tf,[t[0].value,t[1].value,t[2].value]);},skew:function(t){rd(rf,t[0].value*tf,t[1].value*tf);},skewX:function(t){rd(rf,t[0].value*tf,0);},skewY:function(t){rd(rf,0,t[0].value*tf);},matrix:function(t){G.mat4.set(rf,t[0].value,t[1].value,0,0,t[2].value,t[3].value,0,0,0,0,1,0,t[4].value,t[5].value,0,1);},matrix3d:function(t){G.mat4.set.apply(G.mat4,[rf].concat((0,O.default)(t.map(function(t){return t.value;}))));}},rg=G.vec3.fromValues(1,1,1),ry=G.vec3.create(),rm={translate:function(t,e){ia.sceneGraphService.setLocalScale(t,rg,!1),ia.sceneGraphService.setLocalEulerAngles(t,ry,void 0,void 0,!1),ia.sceneGraphService.setLocalPosition(t,[e[0].value,e[1].value,0],!1),ia.sceneGraphService.dirtyLocalTransform(t,t.transformable);}},rk=(0,R.default)(function t(){(0,C.default)(this,t),this.parser=ny,this.mixer=nw;},[{key:"calculator",value:function(t,e,n,r){return n instanceof ek?[]:n;}},{key:"postProcessor",value:function(t){!function(t,e){if(t.length){if(1===t.length&&rm[t[0].t]){rm[t[0].t](e,t[0].d);return;}for(var n=G.mat4.identity(rv),r=0;r<t.length;r++){var i=t[r],a=i.t,o=i.d,s=rp[a];s&&(s(o),G.mat4.mul(n,n,rf));}e.setLocalTransform(n);}else e.resetLocalTransform();e.getLocalTransform();}(t.parsedStyle.transform,t);}}]),rE=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"postProcessor",value:function(t){var e=t.parsedStyle.transformOrigin;e[0].unit===ea.kPixels&&e[1].unit===ea.kPixels?t.setOrigin(e[0].value,e[1].value):t.getGeometryBounds();}}]),rx=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){return n.value;}},{key:"postProcessor",value:function(t){if(t.parentNode){var e=t.parentNode,n=e.renderable,r=e.sortable;n&&e.dirty(),r&&(r.dirty=!0,r.dirtyReason=tC.Z_INDEX_CHANGED);}}}]),rT=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){var n=t.cx,r=t.cy,i=t.r,a=void 0===i?0:i;return{cx:void 0===n?0:n,cy:void 0===r?0:r,hwidth:a,hheight:a};}}]),rN=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){var n=t.cx,r=t.cy,i=t.rx,a=t.ry;return{cx:void 0===n?0:n,cy:void 0===r?0:r,hwidth:void 0===i?0:i,hheight:void 0===a?0:a};}}]),rb=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t){var e=t.x1,n=t.y1,r=t.x2,i=t.y2,a=Math.min(e,r),o=Math.min(n,i),s=(Math.max(e,r)-a)/2,l=(Math.max(n,i)-o)/2;return{cx:a+s,cy:o+l,hwidth:s,hheight:l};}}]),rS=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t){var e=t.d.rect,n=e.x,r=e.y,i=e.width,a=e.height,o=i/2,s=a/2;return{cx:n+o,cy:r+s,hwidth:o,hheight:s};}}]),rw=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t){if(t.points&&(0,F.isArray)(t.points.points)){var e=t.points.points,n=Math.min.apply(Math,(0,O.default)(e.map(function(t){return t[0];}))),r=Math.max.apply(Math,(0,O.default)(e.map(function(t){return t[0];}))),i=Math.min.apply(Math,(0,O.default)(e.map(function(t){return t[1];}))),a=Math.max.apply(Math,(0,O.default)(e.map(function(t){return t[1];}))),o=(r-n)/2,s=(a-i)/2;return{cx:n+o,cy:i+s,hwidth:o,hheight:s};}return{cx:0,cy:0,hwidth:0,hheight:0};}}]),rP=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){var n=t.x,r=t.y,i=t.src,a=t.width,o=t.height,s=void 0===a?0:a,l=void 0===o?0:o;return!i||(0,F.isString)(i)||(s||(s=i.width,t.width=s),l||(l=i.height,t.height=l)),{cx:(void 0===n?0:n)+s/2,cy:(void 0===r?0:r)+l/2,hwidth:s/2,hheight:l/2};}}]),rM=(0,R.default)(function t(e){(0,C.default)(this,t),this.globalRuntime=e;},[{key:"isReadyToMeasure",value:function(t,e){return t.text;}},{key:"update",value:function(t,e){var n,r=t.text,i=t.textAlign,a=void 0===i?"start":i,o=t.lineWidth,s=void 0===o?1:o,l=t.textBaseline,u=void 0===l?"alphabetic":l,c=t.dx,h=void 0===c?0:c,d=t.dy,f=void 0===d?0:d,v=t.x,p=t.y;if(!this.isReadyToMeasure(t,e))return t.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var g=((null==e||null===(n=e.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n?void 0:n.getConfig())||{}).offscreenCanvas,y=this.globalRuntime.textService.measureText(r,t,g);t.metrics=y;var m=y.width,k=y.height,E=m/2,x=k/2,T=(void 0===v?0:v)+E;"center"===a||"middle"===a?T+=s/2-E:("right"===a||"end"===a)&&(T+=s-2*E);var N=(void 0===p?0:p)-x;return"middle"===u?N+=x:"top"===u||"hanging"===u?N+=2*x:"alphabetic"===u||("bottom"===u||"ideographic"===u)&&(N+=0),h&&(T+=h),f&&(N+=f),{cx:T,cy:N,hwidth:E,hheight:x};}}]),rA=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){return{cx:0,cy:0,hwidth:0,hheight:0};}}]),rC=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){var n=t.x,r=t.y,i=t.width,a=void 0===i?0:i,o=t.height,s=void 0===o?0:o;return{cx:(void 0===n?0:n)+a/2,cy:(void 0===r?0:r)+s/2,hwidth:a/2,hheight:s/2};}}]),rR=(0,R.default)(function t(e){(0,C.default)(this,t),this.eventPhase=t.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new ts,this.page=new ts,this.canvas=new ts,this.viewport=new ts,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e;},[{key:"name",get:function(){return this.type;}},{key:"layerX",get:function(){return this.layer.x;}},{key:"layerY",get:function(){return this.layer.y;}},{key:"pageX",get:function(){return this.page.x;}},{key:"pageY",get:function(){return this.page.y;}},{key:"x",get:function(){return this.canvas.x;}},{key:"y",get:function(){return this.canvas.y;}},{key:"canvasX",get:function(){return this.canvas.x;}},{key:"canvasY",get:function(){return this.canvas.y;}},{key:"viewportX",get:function(){return this.viewport.x;}},{key:"viewportY",get:function(){return this.viewport.y;}},{key:"composedPath",value:function(){return this.manager&&(!this.path||this.path[0]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path;}},{key:"propagationPath",get:function(){return this.composedPath();}},{key:"preventDefault",value:function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0;}},{key:"stopImmediatePropagation",value:function(){this.propagationImmediatelyStopped=!0;}},{key:"stopPropagation",value:function(){this.propagationStopped=!0;}},{key:"initEvent",value:function(){}},{key:"initUIEvent",value:function(){}},{key:"clone",value:function(){throw Error(tu);}}]),rO=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).client=new ts,t.movement=new ts,t.offset=new ts,t.global=new ts,t.screen=new ts,t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clientX",get:function(){return this.client.x;}},{key:"clientY",get:function(){return this.client.y;}},{key:"movementX",get:function(){return this.movement.x;}},{key:"movementY",get:function(){return this.movement.y;}},{key:"offsetX",get:function(){return this.offset.x;}},{key:"offsetY",get:function(){return this.offset.y;}},{key:"globalX",get:function(){return this.global.x;}},{key:"globalY",get:function(){return this.global.y;}},{key:"screenX",get:function(){return this.screen.x;}},{key:"screenY",get:function(){return this.screen.y;}},{key:"getModifierState",value:function(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t);}},{key:"initMouseEvent",value:function(){throw Error(tu);}}]);}(rR),rL=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).width=0,t.height=0,t.isPrimary=!1,t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getCoalescedEvents",value:function(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[];}},{key:"getPredictedEvents",value:function(){throw Error("getPredictedEvents is not supported!");}},{key:"clone",value:function(){return this.manager.clonePointerEvent(this);}}]);}(rO),rI=function(t){function e(){return(0,C.default)(this,e),(0,L.default)(this,e,arguments);}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return this.manager.cloneWheelEvent(this);}}]);}(rO),rD=function(t){function e(t,n){var r;return(0,C.default)(this,e),(r=(0,L.default)(this,e,[null])).type=t,r.detail=null==n?void 0:n.detail,!n||"detail"in n||(r.detail=n),Object.assign(r,n),r;}return(0,I.default)(e,t),(0,R.default)(e);}(rR),r_=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).shadow=!1,t.ownerDocument=null,t.isConnected=!1,t.baseURI="",t.childNodes=[],t.nodeType=0,t.nodeName="",t.nodeValue=null,t.mutations=void 0,t.parentNode=null,t.destroyed=!1,t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"textContent",get:function(){var t="";this.nodeName===j.TEXT&&(t+=this.style.text);var e,n=(0,W.default)(this.childNodes);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.nodeName===j.TEXT?t+=r.nodeValue:t+=r.textContent;}}catch(t){n.e(t);}finally{n.f();}return t;},set:function(t){var e=this;this.childNodes.slice().forEach(function(t){e.removeChild(t);}),this.nodeName===j.TEXT&&(this.style.text="".concat(t));}},{key:"getRootNode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.parentNode?this.parentNode.getRootNode(t):t.composed&&this.host?this.host.getRootNode(t):this;}},{key:"hasChildNodes",value:function(){return this.childNodes.length>0;}},{key:"isDefaultNamespace",value:function(t){throw Error(tu);}},{key:"lookupNamespaceURI",value:function(t){throw Error(tu);}},{key:"lookupPrefix",value:function(t){throw Error(tu);}},{key:"normalize",value:function(){throw Error(tu);}},{key:"isEqualNode",value:function(t){return this===t;}},{key:"isSameNode",value:function(t){return this.isEqualNode(t);}},{key:"parent",get:function(){return this.parentNode;}},{key:"parentElement",get:function(){return null;}},{key:"nextSibling",get:function(){return null;}},{key:"previousSibling",get:function(){return null;}},{key:"firstChild",get:function(){return this.childNodes.length>0?this.childNodes[0]:null;}},{key:"lastChild",get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null;}},{key:"compareDocumentPosition",value:function(t){if(t===this)return 0;for(var n,r=t,i=this,a=[r],o=[i];null!==(n=r.parentNode)&&void 0!==n?n:i.parentNode;)r=r.parentNode?(a.push(r.parentNode),r.parentNode):r,i=i.parentNode?(o.push(i.parentNode),i.parentNode):i;if(r!==i)return e.DOCUMENT_POSITION_DISCONNECTED|e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|e.DOCUMENT_POSITION_PRECEDING;var s=a.length>o.length?a:o,l=s===a?o:a;if(s[s.length-l.length]===l[0])return s===a?e.DOCUMENT_POSITION_CONTAINED_BY|e.DOCUMENT_POSITION_FOLLOWING:e.DOCUMENT_POSITION_CONTAINS|e.DOCUMENT_POSITION_PRECEDING;for(var u=s.length-l.length,c=l.length-1;c>=0;c--){var h=l[c],d=s[u+c];if(d!==h){var f=h.parentNode.childNodes;if(f.indexOf(h)<f.indexOf(d)){if(l===a)return e.DOCUMENT_POSITION_PRECEDING;return e.DOCUMENT_POSITION_FOLLOWING;}if(s===a)return e.DOCUMENT_POSITION_PRECEDING;break;}}return e.DOCUMENT_POSITION_FOLLOWING;}},{key:"contain",value:function(t){return this.contains(t);}},{key:"contains",value:function(t){for(var e=t;e&&this!==e;)e=e.parentNode;return!!e;}},{key:"getAncestor",value:function(t){for(var e=this;t>0&&e;)e=e.parentNode,t--;return e;}},{key:"forEach",value:function(t){for(var e=[this];e.length>0;){var n=e.pop();if(!1===t(n))break;for(var r=n.childNodes.length-1;r>=0;r--)e.push(n.childNodes[r]);}}}],[{key:"isNode",value:function(t){return!!t.childNodes;}}]);}((0,R.default)(function t(){(0,C.default)(this,t),this.emitter=new _.default;},[{key:"on",value:function(t,e,n){return this.addEventListener(t,e,n),this;}},{key:"addEventListener",value:function(t,e,n){var r=!1,i=!1;if((0,F.isBoolean)(n))r=n;else if(n){var a=n.capture;r=void 0!==a&&a;var o=n.once;i=void 0!==o&&o;}r&&(t+="capture"),e=(0,F.isFunction)(e)?e:e.handleEvent;var s=(0,F.isFunction)(e)?void 0:e;return i?this.emitter.once(t,e,s):this.emitter.on(t,e,s),this;}},{key:"off",value:function(t,e,n){return t?this.removeEventListener(t,e,n):this.removeAllEventListeners(),this;}},{key:"removeAllEventListeners",value:function(){var t;null===(t=this.emitter)||void 0===t||t.removeAllListeners();}},{key:"removeEventListener",value:function(t,e,n){if(!this.emitter)return this;((0,F.isBoolean)(n)?n:null==n?void 0:n.capture)&&(t+="capture"),e=(0,F.isFunction)(e)?e:null===(r=e)||void 0===r?void 0:r.handleEvent;var r,i=(0,F.isFunction)(e)?void 0:e;return this.emitter.off(t,e,i),this;}},{key:"emit",value:function(t,e){this.dispatchEvent(new rD(t,e));}},{key:"dispatchEventToSelf",value:function(t){t.target||(t.target=this),t.currentTarget=this,this.emitter.emit(t.type,t);}},{key:"dispatchEvent",value:function(t){var e,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0;if(i)return this.dispatchEventToSelf(t),!0;if(e=this.document?this:this.defaultView?this.defaultView:null===(n=this.ownerDocument)||void 0===n?void 0:n.defaultView){if(t.manager=e.getEventService(),!t.manager)return!1;t.defaultPrevented=!1,t.path?t.path.length=0:t.page=[],r||(t.target=this),t.manager.dispatchEvent(t,t.type,r);}else this.dispatchEventToSelf(t);return!t.defaultPrevented;}}]));r_.DOCUMENT_POSITION_DISCONNECTED=1,r_.DOCUMENT_POSITION_PRECEDING=2,r_.DOCUMENT_POSITION_FOLLOWING=4,r_.DOCUMENT_POSITION_CONTAINS=8,r_.DOCUMENT_POSITION_CONTAINED_BY=16,r_.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32,(0,R.default)(function t(e,n){var r=this;(0,C.default)(this,t),this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=G.mat4.create(),this.tmpVec3=G.vec3.create(),this.onPointerDown=function(t){var e=r.createPointerEvent(t);if(r.dispatchEvent(e,"pointerdown"),"touch"===e.pointerType)r.dispatchEvent(e,"touchstart");else if("mouse"===e.pointerType||"pen"===e.pointerType){var n=2===e.button;r.dispatchEvent(e,n?"rightdown":"mousedown");}r.trackingData(t.pointerId).pressTargetsByButton[t.button]=e.composedPath(),r.freeEvent(e);},this.onPointerUp=function(t){var e=n0.now(),n=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);if(r.dispatchEvent(n,"pointerup"),"touch"===n.pointerType)r.dispatchEvent(n,"touchend");else if("mouse"===n.pointerType||"pen"===n.pointerType){var i=2===n.button;r.dispatchEvent(n,i?"rightup":"mouseup");}var a=r.trackingData(t.pointerId),o=r.findMountedTarget(a.pressTargetsByButton[t.button]),s=o;if(o&&!n.composedPath().includes(o)){for(var l=o;l&&!n.composedPath().includes(l);){if(n.currentTarget=l,r.notifyTarget(n,"pointerupoutside"),"touch"===n.pointerType)r.notifyTarget(n,"touchendoutside");else if("mouse"===n.pointerType||"pen"===n.pointerType){var u=2===n.button;r.notifyTarget(n,u?"rightupoutside":"mouseupoutside");}r_.isNode(l)&&(l=l.parentNode);}delete a.pressTargetsByButton[t.button],s=l;}if(s){var c,h=r.clonePointerEvent(n,"click");h.target=s,h.path=[],a.clicksByButton[t.button]||(a.clicksByButton[t.button]={clickCount:0,target:h.target,timeStamp:e});var d=r.context.renderingContext.root.ownerDocument.defaultView,f=a.clicksByButton[t.button];f.target===h.target&&e-f.timeStamp<d.getConfig().dblClickSpeed?++f.clickCount:f.clickCount=1,f.target=h.target,f.timeStamp=e,h.detail=f.clickCount,null!==(c=n.detail)&&void 0!==c&&c.preventClick||(r.context.config.useNativeClickEvent||"mouse"!==h.pointerType&&"touch"!==h.pointerType||r.dispatchEvent(h,"click"),r.dispatchEvent(h,"pointertap")),r.freeEvent(h);}r.freeEvent(n);},this.onPointerMove=function(t){var e=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0),n="mouse"===e.pointerType||"pen"===e.pointerType,i=r.trackingData(t.pointerId),a=r.findMountedTarget(i.overTargets);if(i.overTargets&&a!==e.target){var o="mousemove"===t.type?"mouseout":"pointerout",s=r.createPointerEvent(t,o,a||void 0);if(r.dispatchEvent(s,"pointerout"),n&&r.dispatchEvent(s,"mouseout"),!e.composedPath().includes(a)){var l=r.createPointerEvent(t,"pointerleave",a||void 0);for(l.eventPhase=l.AT_TARGET;l.target&&!e.composedPath().includes(l.target);)l.currentTarget=l.target,r.notifyTarget(l),n&&r.notifyTarget(l,"mouseleave"),r_.isNode(l.target)&&(l.target=l.target.parentNode);r.freeEvent(l);}r.freeEvent(s);}if(a!==e.target){var u="mousemove"===t.type?"mouseover":"pointerover",c=r.clonePointerEvent(e,u);r.dispatchEvent(c,"pointerover"),n&&r.dispatchEvent(c,"mouseover");for(var h=a&&r_.isNode(a)&&a.parentNode;h&&h!==(r_.isNode(r.rootTarget)&&r.rootTarget.parentNode)&&h!==e.target;)h=h.parentNode;if(!h||h===(r_.isNode(r.rootTarget)&&r.rootTarget.parentNode)){var d=r.clonePointerEvent(e,"pointerenter");for(d.eventPhase=d.AT_TARGET;d.target&&d.target!==a&&d.target!==(r_.isNode(r.rootTarget)&&r.rootTarget.parentNode);)d.currentTarget=d.target,r.notifyTarget(d),n&&r.notifyTarget(d,"mouseenter"),r_.isNode(d.target)&&(d.target=d.target.parentNode);r.freeEvent(d);}r.freeEvent(c);}r.dispatchEvent(e,"pointermove"),"touch"===e.pointerType&&r.dispatchEvent(e,"touchmove"),n&&(r.dispatchEvent(e,"mousemove"),r.cursor=r.getCursor(e.target)),i.overTargets=e.composedPath(),r.freeEvent(e);},this.onPointerOut=function(t){var e=r.trackingData(t.pointerId);if(e.overTargets){var n="mouse"===t.pointerType||"pen"===t.pointerType,i=r.findMountedTarget(e.overTargets),a=r.createPointerEvent(t,"pointerout",i||void 0);r.dispatchEvent(a),n&&r.dispatchEvent(a,"mouseout");var o=r.createPointerEvent(t,"pointerleave",i||void 0);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==(r_.isNode(r.rootTarget)&&r.rootTarget.parentNode);)o.currentTarget=o.target,r.notifyTarget(o),n&&r.notifyTarget(o,"mouseleave"),r_.isNode(o.target)&&(o.target=o.target.parentNode);e.overTargets=null,r.freeEvent(a),r.freeEvent(o);}r.cursor=null;},this.onPointerOver=function(t){var e=r.trackingData(t.pointerId),n=r.createPointerEvent(t),i="mouse"===n.pointerType||"pen"===n.pointerType;r.dispatchEvent(n,"pointerover"),i&&r.dispatchEvent(n,"mouseover"),"mouse"===n.pointerType&&(r.cursor=r.getCursor(n.target));var a=r.clonePointerEvent(n,"pointerenter");for(a.eventPhase=a.AT_TARGET;a.target&&a.target!==(r_.isNode(r.rootTarget)&&r.rootTarget.parentNode);)a.currentTarget=a.target,r.notifyTarget(a),i&&r.notifyTarget(a,"mouseenter"),r_.isNode(a.target)&&(a.target=a.target.parentNode);e.overTargets=n.composedPath(),r.freeEvent(n),r.freeEvent(a);},this.onPointerUpOutside=function(t){var e=r.trackingData(t.pointerId),n=r.findMountedTarget(e.pressTargetsByButton[t.button]),i=r.createPointerEvent(t);if(n){for(var a=n;a;)i.currentTarget=a,r.notifyTarget(i,"pointerupoutside"),"touch"===i.pointerType||("mouse"===i.pointerType||"pen"===i.pointerType)&&r.notifyTarget(i,2===i.button?"rightupoutside":"mouseupoutside"),r_.isNode(a)&&(a=a.parentNode);delete e.pressTargetsByButton[t.button];}r.freeEvent(i);},this.onWheel=function(t){var e=r.createWheelEvent(t);r.dispatchEvent(e),r.freeEvent(e);},this.onClick=function(t){if(r.context.config.useNativeClickEvent){var e=r.createPointerEvent(t);r.dispatchEvent(e),r.freeEvent(e);}},this.onPointerCancel=function(t){var e=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);r.dispatchEvent(e),r.freeEvent(e);},this.globalRuntime=e,this.context=n;},[{key:"init",value:function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick);}},{key:"destroy",value:function(){this.mappingTable={},this.mappingState={},this.eventPool.clear();}},{key:"getScale",value:function(){var t=this.context.contextService.getBoundingClientRect(),e=1,n=1,r=this.context.contextService.getDomElement();if(r&&t){var i=r.offsetWidth,a=r.offsetHeight;i&&a&&(e=t.width/i,n=t.height/a);}return{scaleX:e,scaleY:n,bbox:t};}},{key:"client2Viewport",value:function(t){var e=this.getScale(),n=e.scaleX,r=e.scaleY,i=e.bbox;return new ts((t.x-((null==i?void 0:i.left)||0))/n,(t.y-((null==i?void 0:i.top)||0))/r);}},{key:"viewport2Client",value:function(t){var e=this.getScale(),n=e.scaleX,r=e.scaleY,i=e.bbox;return new ts((t.x+((null==i?void 0:i.left)||0))*n,(t.y+((null==i?void 0:i.top)||0))*r);}},{key:"viewport2Canvas",value:function(t){var e=t.x,n=t.y,r=this.rootTarget.defaultView.getCamera(),i=this.context.config,a=i.width,o=i.height,s=r.getPerspectiveInverse(),l=r.getWorldTransform(),u=G.mat4.multiply(this.tmpMatrix,l,s),c=G.vec3.set(this.tmpVec3,e/a*2-1,(1-n/o)*2-1,0);return G.vec3.transformMat4(c,c,u),new ts(c[0],c[1]);}},{key:"canvas2Viewport",value:function(t){var e=this.rootTarget.defaultView.getCamera(),n=e.getPerspective(),r=e.getViewTransform(),i=G.mat4.multiply(this.tmpMatrix,n,r),a=G.vec3.set(this.tmpVec3,t.x,t.y,0);G.vec3.transformMat4(this.tmpVec3,this.tmpVec3,i);var o=this.context.config,s=o.width,l=o.height;return new ts((a[0]+1)/2*s,(1-(a[1]+1)/2)*l);}},{key:"setPickHandler",value:function(t){this.pickHandler=t;}},{key:"addEventMapping",value:function(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort(function(t,e){return t.priority-e.priority;});}},{key:"mapEvent",value:function(t){if(this.rootTarget){var e=this.mappingTable[t.type];if(e)for(var n=0,r=e.length;n<r;n++)e[n].fn(t);else console.warn("[EventService]: Event mapping not defined for ".concat(t.type));}}},{key:"dispatchEvent",value:function(t,e,n){if(n){t.eventPhase=t.AT_TARGET;var r=this.rootTarget.defaultView||null;t.currentTarget=r,this.notifyListeners(t,e);}else t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e);}},{key:"propagate",value:function(t,e){if(t.target){var n=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(var r=n.length-1;r>=1;r--)if(t.currentTarget=n[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!t.propagationStopped&&!t.propagationImmediatelyStopped){var i=n.indexOf(t.currentTarget);t.eventPhase=t.BUBBLING_PHASE;for(var a=i+1;a<n.length;a++)if(t.currentTarget=n[a],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;}}}},{key:"propagationPath",value:function(t){var e=[t],n=this.rootTarget.defaultView||null;if(n&&n===t)return e.unshift(n.document),e;for(var r=0;r<2048&&t!==this.rootTarget;r++)r_.isNode(t)&&t.parentNode&&(e.push(t.parentNode),t=t.parentNode);return n&&e.push(n),e;}},{key:"hitTest",value:function(t){var e=t.viewportX,n=t.viewportY,r=this.context.config,i=r.width,a=r.height,o=r.disableHitTesting;return e<0||n<0||e>i||n>a?null:!o&&this.pickHandler(t)||this.rootTarget||null;}},{key:"isNativeEventFromCanvas",value:function(t,e){var n,r=null==e?void 0:e.target;if(null!==(n=r)&&void 0!==n&&n.shadowRoot&&(r=e.composedPath()[0]),r){if(r===t)return!0;if(t&&t.contains)return t.contains(r);}return null!=e&&!!e.composedPath&&e.composedPath().indexOf(t)>-1;}},{key:"getExistedHTML",value:function(t){if(t.nativeEvent.composedPath)for(var e=0,n=t.nativeEvent.composedPath();e<n.length;e++){var r=n[e],i=this.nativeHTMLMap.get(r);if(i)return i;}return null;}},{key:"pickTarget",value:function(t){return this.hitTest({clientX:t.clientX,clientY:t.clientY,viewportX:t.viewportX,viewportY:t.viewportY,x:t.canvasX,y:t.canvasY});}},{key:"createPointerEvent",value:function(t,e,n,r){var i=this.allocateEvent(rL);this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.nativeEvent=t.nativeEvent,i.originalEvent=t;var a=this.getExistedHTML(i),o=this.context.contextService.getDomElement();return i.target=null!=n?n:a||this.isNativeEventFromCanvas(o,i.nativeEvent)&&this.pickTarget(i)||r,"string"==typeof e&&(i.type=e),i;}},{key:"createWheelEvent",value:function(t){var e=this.allocateEvent(rI);this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t;var n=this.getExistedHTML(e),r=this.context.contextService.getDomElement();return e.target=n||this.isNativeEventFromCanvas(r,e.nativeEvent)&&this.pickTarget(e),e;}},{key:"trackingData",value:function(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t];}},{key:"cloneWheelEvent",value:function(t){var e=this.allocateEvent(rI);return e.nativeEvent=t.nativeEvent,e.originalEvent=t.originalEvent,this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.target=t.target,e.path=t.composedPath().slice(),e.type=t.type,e;}},{key:"clonePointerEvent",value:function(t,e){var n=this.allocateEvent(rL);return n.nativeEvent=t.nativeEvent,n.originalEvent=t.originalEvent,this.copyPointerData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.target=t.target,n.path=t.composedPath().slice(),n.type=null!=e?e:n.type,n;}},{key:"copyPointerData",value:function(t,e){e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist;}},{key:"copyMouseData",value:function(t,e){e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey,e.client.copyFrom(t.client),e.movement.copyFrom(t.movement),e.canvas.copyFrom(t.canvas),e.screen.copyFrom(t.screen),e.global.copyFrom(t.global),e.offset.copyFrom(t.offset);}},{key:"copyWheelData",value:function(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;}},{key:"copyData",value:function(t,e){e.isTrusted=t.isTrusted,e.timeStamp=n0.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.page.copyFrom(t.page),e.viewport.copyFrom(t.viewport);}},{key:"allocateEvent",value:function(t){this.eventPool.has(t)||this.eventPool.set(t,[]);var e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=[],e.target=null,e;}},{key:"freeEvent",value:function(t){if(t.manager!==this)throw Error("It is illegal to free an event not managed by this EventBoundary!");var e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t);}},{key:"notifyTarget",value:function(t,e){e=null!=e?e:t.type;var n=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?"".concat(e,"capture"):e;this.notifyListeners(t,n),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e);}},{key:"notifyListeners",value:function(t,e){var n=t.currentTarget.emitter,r=n._events[e];if(r){if("fn"in r)r.once&&n.removeListener(e,r.fn,void 0,!0),r.fn.call(t.currentTarget||r.context,t);else for(var i=0;i<r.length&&!t.propagationImmediatelyStopped;i++)r[i].once&&n.removeListener(e,r[i].fn,void 0,!0),r[i].fn.call(t.currentTarget||r[i].context,t);}}},{key:"findMountedTarget",value:function(t){if(!t)return null;for(var e=t[t.length-1],n=t.length-2;n>=0;n--){var r=t[n];if(r===this.rootTarget||r_.isNode(r)&&r.parentNode===e)e=t[n];else break;}return e;}},{key:"getCursor",value:function(t){for(var e=t;e;){var n=!!e.getAttribute&&e.getAttribute("cursor");if(n)return n;e=r_.isNode(e)&&e.parentNode;}}}]);var rG=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"getOrCreateCanvas",value:function(t,e){if(this.canvas)return this.canvas;if(t||ia.offscreenCanvas)this.canvas=t||ia.offscreenCanvas,this.context=this.canvas.getContext("2d",(0,A.default)({willReadFrequently:!0},e));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",(0,A.default)({willReadFrequently:!0},e)),this.context&&this.context.measureText||(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"));}catch(t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",(0,A.default)({willReadFrequently:!0},e));}return this.canvas.width=10,this.canvas.height=10,this.canvas;}},{key:"getOrCreateContext",value:function(t,e){return this.context||this.getOrCreateCanvas(t,e),this.context;}}],[{key:"createCanvas",value:function(){try{return new window.OffscreenCanvas(0,0);}catch(t){}try{return document.createElement("canvas");}catch(t){}return null;}}]),rF=((k={})[k.CAMERA_CHANGED=0]="CAMERA_CHANGED",k[k.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",k[k.NONE=2]="NONE",k);(0,R.default)(function t(e,n){(0,C.default)(this,t),this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new ra,initAsync:new rr,dirtycheck:new ro,cull:new ro,beginFrame:new ra,beforeRender:new ra,render:new ra,afterRender:new ra,endFrame:new ra,destroy:new ra,pick:new ri,pickSync:new ro,pointerDown:new ra,pointerUp:new ra,pointerMove:new ra,pointerOut:new ra,pointerOver:new ra,pointerWheel:new ra,pointerCancel:new ra,click:new ra},this.globalRuntime=e,this.context=n;},[{key:"init",value:function(t){var e=this,n=(0,A.default)((0,A.default)({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach(function(t){t.apply(n,e.globalRuntime);}),this.hooks.init.call(),0===this.hooks.initAsync.getCallbacksNum()?(this.inited=!0,t()):this.hooks.initAsync.promise().then(function(){e.inited=!0,t();}).catch(function(t){});}},{key:"getStats",value:function(){return this.stats;}},{key:"disableDirtyRectangleRendering",value:function(){return!this.context.config.renderer.getConfig().enableDirtyRectangleRendering||this.context.renderingContext.renderReasons.has(rF.CAMERA_CHANGED);}},{key:"render",value:function(t,e,n){var r=this,i=t.getConfig(),a=this.context.renderingContext;if(this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0,this.globalRuntime.sceneGraphService.syncHierarchy(a.root),this.globalRuntime.sceneGraphService.notifyMutationObservers(t),a.renderReasons.size&&this.inited){a.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var o=1===a.renderReasons.size&&a.renderReasons.has(rF.CAMERA_CHANGED),s=!i.disableRenderHooks||!o;s&&this.renderDisplayObject(a.root,i,a),this.hooks.beginFrame.call(e),s&&a.renderListCurrentFrame.forEach(function(t){r.hooks.beforeRender.call(t),r.hooks.render.call(t),r.hooks.afterRender.call(t);}),this.hooks.endFrame.call(e),a.renderListCurrentFrame=[],a.renderReasons.clear(),n();}}},{key:"renderDisplayObject",value:function(t,e,n){for(var r=this,i=e.renderer.getConfig(),a=i.enableDirtyCheck,o=i.enableCulling,s=[t];s.length>0;){var l,u=s.pop();!function(t){var e=t.renderable,i=t.sortable,s=a?e.dirty||n.dirtyRectangleRenderingDisabled?t:null:t,l=null;s&&(l=o?r.hooks.cull.call(s,r.context.camera):s)&&(r.stats.rendered+=1,n.renderListCurrentFrame.push(l)),t.dirty(!1),i.renderOrder=r.zIndexCounter,r.zIndexCounter+=1,r.stats.total+=1,i.dirty&&(r.sort(t,i),i.dirty=!1,i.dirtyChildren=[],i.dirtyReason=void 0);}(u);for(var c=(null===(l=u.sortable)||void 0===l||null===(l=l.sorted)||void 0===l?void 0:l.length)>0?u.sortable.sorted:u.childNodes,h=c.length-1;h>=0;h--)s.push(c[h]);}}},{key:"sort",value:function(t,e){var n,r;(null==e||null===(n=e.sorted)||void 0===n?void 0:n.length)>0&&e.dirtyReason!==tC.Z_INDEX_CHANGED?e.dirtyChildren.forEach(function(n){var r=e.sorted.indexOf(n);if(r>-1&&e.sorted.splice(r,1),t.childNodes.indexOf(n)>-1){if(0===e.sorted.length)e.sorted.push(n);else{var i=function(t,e){for(var n=0,r=t.length;n<r;){var i=n+r>>>1;0>nZ(t[i],e)?n=i+1:r=i;}return n;}(e.sorted,n);e.sorted.splice(i,0,n);}}}):e.sorted=t.childNodes.slice().sort(nZ),(null===(r=e.sorted)||void 0===r?void 0:r.length)>0&&0===t.childNodes.filter(function(t){return t.parsedStyle.zIndex;}).length&&(e.sorted=[]);}},{key:"destroy",value:function(){this.inited=!1,this.hooks.destroy.call();}},{key:"dirty",value:function(){this.context.renderingContext.renderReasons.add(rF.DISPLAY_OBJECT_CHANGED);}}]);var rB=/\[\s*(.*)=(.*)\s*\]/,rU=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"selectOne",value:function(t,e){var n=this;if(t.startsWith("."))return e.find(function(e){return((null==e?void 0:e.classList)||[]).indexOf(n.getIdOrClassname(t))>-1;});if(t.startsWith("#"))return e.find(function(e){return e.id===n.getIdOrClassname(t);});if(t.startsWith("[")){var r=this.getAttribute(t),i=r.name,a=r.value;return i?e.find(function(t){return e!==t&&("name"===i?t.name===a:n.attributeToString(t,i)===a);}):null;}return e.find(function(n){return e!==n&&n.nodeName===t;});}},{key:"selectAll",value:function(t,e){var n=this;if(t.startsWith("."))return e.findAll(function(r){return e!==r&&((null==r?void 0:r.classList)||[]).indexOf(n.getIdOrClassname(t))>-1;});if(t.startsWith("#"))return e.findAll(function(r){return e!==r&&r.id===n.getIdOrClassname(t);});if(t.startsWith("[")){var r=this.getAttribute(t),i=r.name,a=r.value;return i?e.findAll(function(t){return e!==t&&("name"===i?t.name===a:n.attributeToString(t,i)===a);}):[];}return e.findAll(function(n){return e!==n&&n.nodeName===t;});}},{key:"is",value:function(t,e){if(t.startsWith("."))return e.className===this.getIdOrClassname(t);if(t.startsWith("#"))return e.id===this.getIdOrClassname(t);if(t.startsWith("[")){var n=this.getAttribute(t),r=n.name,i=n.value;return"name"===r?e.name===i:this.attributeToString(e,r)===i;}return e.nodeName===t;}},{key:"getIdOrClassname",value:function(t){return t.substring(1);}},{key:"getAttribute",value:function(t){var e=t.match(rB),n="",r="";return e&&e.length>2&&(n=e[1].replace(/"/g,""),r=e[2].replace(/"/g,"")),{name:n,value:r};}},{key:"attributeToString",value:function(t,e){if(!t.getAttribute)return"";var n=t.getAttribute(e);return(0,F.isNil)(n)?"":n.toString?n.toString():"";}}]),rV=((E={}).ATTR_MODIFIED="DOMAttrModified",E.INSERTED="DOMNodeInserted",E.MOUNTED="DOMNodeInsertedIntoDocument",E.REMOVED="removed",E.UNMOUNTED="DOMNodeRemovedFromDocument",E.REPARENT="reparent",E.DESTROY="destroy",E.BOUNDS_CHANGED="bounds-changed",E.CULLED="culled",E),rz=function(t){function e(t,n,r,i,a,o,s,l){var u;return(0,C.default)(this,e),(u=(0,L.default)(this,e,[null])).relatedNode=n,u.prevValue=r,u.newValue=i,u.attrName=a,u.attrChange=o,u.prevParsedValue=s,u.newParsedValue=l,u.type=t,u;}return(0,I.default)(e,t),(0,R.default)(e);}(rR);rz.ADDITION=2,rz.MODIFICATION=1,rz.REMOVAL=3;var rH=new rz(rV.REPARENT,null,"","","",0,"",""),rY=G.vec2.create(),rW=G.vec3.create(),rq=G.vec3.fromValues(1,1,1),rX=G.mat4.create(),rj=G.vec2.create(),r$=G.vec3.create(),rK=G.mat4.create(),rZ=G.quat.create(),rQ=G.vec3.create(),rJ=G.quat.create(),r0=G.vec3.create(),r1=G.vec3.create(),r2=G.vec3.create(),r3=G.mat4.create(),r4=G.quat.create(),r5=G.quat.create(),r6=G.quat.create(),r7=(0,R.default)(function t(e){(0,C.default)(this,t),this.displayObjectDependencyMap=new WeakMap,this.runtime=e;},[{key:"matches",value:function(t,e){return this.runtime.sceneGraphSelector.is(t,e);}},{key:"querySelector",value:function(t,e){return this.runtime.sceneGraphSelector.selectOne(t,e);}},{key:"querySelectorAll",value:function(t,e){return this.runtime.sceneGraphSelector.selectAll(t,e);}},{key:"attach",value:function(t,e,n){var r=!1;t.parentNode&&(r=t.parentNode!==e,this.detach(t));var i=t.nodeName===j.FRAGMENT,a=n1(e);t.parentNode=e;var o=i?t.childNodes:[t];(0,F.isNumber)(n)?o.forEach(function(t){e.childNodes.splice(n,0,t),t.parentNode=e;}):o.forEach(function(t){e.childNodes.push(t),t.parentNode=e;});var s=e.sortable;if((null!=s&&null!==(u=s.sorted)&&void 0!==u&&u.length||s.dirty||t.parsedStyle.zIndex)&&(-1===s.dirtyChildren.indexOf(t)&&s.dirtyChildren.push(t),s.dirty=!0,s.dirtyReason=tC.ADDED),!a){if(i)this.dirtyFragment(t);else{var l=t.transformable;l&&this.dirtyWorldTransform(t,l);}if(r){var u,c,h=(null===(c=e.ownerDocument)||void 0===c||null===(c=c.defaultView)||void 0===c||null===(c=c.getConfig())||void 0===c||null===(c=c.future)||void 0===c?void 0:c.experimentalCancelEventPropagation)===!0;t.dispatchEvent(rH,h,h);}}}},{key:"detach",value:function(t){if(t.parentNode){var e,n,r=t.transformable,i=t.parentNode.sortable;(null!=i&&null!==(e=i.sorted)&&void 0!==e&&e.length||null!==(n=t.style)&&void 0!==n&&n.zIndex)&&(-1===i.dirtyChildren.indexOf(t)&&i.dirtyChildren.push(t),i.dirty=!0,i.dirtyReason=tC.REMOVED);var a=t.parentNode.childNodes.indexOf(t);a>-1&&t.parentNode.childNodes.splice(a,1),r&&this.dirtyWorldTransform(t,r),t.parentNode=null;}}},{key:"getLocalPosition",value:function(t){return t.transformable.localPosition;}},{key:"getLocalRotation",value:function(t){return t.transformable.localRotation;}},{key:"getLocalScale",value:function(t){return t.transformable.localScale;}},{key:"getLocalSkew",value:function(t){return t.transformable.localSkew;}},{key:"getLocalTransform",value:function(t){var e=t.transformable;return tI(e),e.localTransform;}},{key:"setLocalPosition",value:function(t,e){var n,r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=t.transformable;r1[0]=e[0],r1[1]=e[1],r1[2]=null!==(n=e[2])&&void 0!==n?n:0,!G.vec3.equals(i.localPosition,r1)&&(G.vec3.copy(i.localPosition,r1),r&&this.dirtyLocalTransform(t,i));}},{key:"translateLocal",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var i=t.transformable;G.vec3.equals(e,rW)||(G.vec3.transformQuat(e,e,i.localRotation),G.vec3.add(i.localPosition,i.localPosition,e),this.dirtyLocalTransform(t,i));}},{key:"setLocalRotation",value:function(t,e,n,r,i){var a=!(arguments.length>5)||void 0===arguments[5]||arguments[5];"number"==typeof e&&(e=G.quat.set(rZ,e,n,r,i));var o=t.transformable;G.quat.copy(o.localRotation,e),a&&this.dirtyLocalTransform(t,o);}},{key:"rotateLocal",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var i=t.transformable;G.quat.fromEuler(r5,e[0],e[1],e[2]),G.quat.mul(i.localRotation,i.localRotation,r5),this.dirtyLocalTransform(t,i);}},{key:"setLocalScale",value:function(t,e){var n,r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=t.transformable;G.vec3.set(r$,e[0],e[1],null!==(n=e[2])&&void 0!==n?n:i.localScale[2]),!G.vec3.equals(r$,i.localScale)&&(G.vec3.copy(i.localScale,r$),r&&this.dirtyLocalTransform(t,i));}},{key:"scaleLocal",value:function(t,e){var n,r=t.transformable;G.vec3.multiply(r.localScale,r.localScale,G.vec3.set(r$,e[0],e[1],null!==(n=e[2])&&void 0!==n?n:1)),this.dirtyLocalTransform(t,r);}},{key:"setLocalSkew",value:function(t,e,n){var r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];"number"==typeof e&&(e=G.vec2.set(rj,e,n));var i=t.transformable;G.vec2.copy(i.localSkew,e),r&&this.dirtyLocalTransform(t,i);}},{key:"setLocalEulerAngles",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=!(arguments.length>4)||void 0===arguments[4]||arguments[4];"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var a=t.transformable;G.quat.fromEuler(a.localRotation,e[0],e[1],e[2]),i&&this.dirtyLocalTransform(t,a);}},{key:"setLocalTransform",value:function(t,e){var n=G.mat4.getTranslation(rQ,e),r=G.mat4.getRotation(rJ,e),i=G.mat4.getScaling(r0,e);this.setLocalScale(t,i,!1),this.setLocalPosition(t,n,!1),this.setLocalRotation(t,r,void 0,void 0,void 0,!1),this.dirtyLocalTransform(t,t.transformable);}},{key:"resetLocalTransform",value:function(t){this.setLocalScale(t,rq,!1),this.setLocalPosition(t,rW,!1),this.setLocalEulerAngles(t,rW,void 0,void 0,!1),this.setLocalSkew(t,rY,void 0,!1),this.dirtyLocalTransform(t,t.transformable);}},{key:"getPosition",value:function(t){var e=t.transformable;return G.mat4.getTranslation(e.position,this.getWorldTransform(t,e));}},{key:"getRotation",value:function(t){var e=t.transformable;return G.mat4.getRotation(e.rotation,this.getWorldTransform(t,e));}},{key:"getScale",value:function(t){var e=t.transformable;return G.mat4.getScaling(e.scaling,this.getWorldTransform(t,e));}},{key:"getOrigin",value:function(t){return t.getGeometryBounds(),t.transformable.origin;}},{key:"getWorldTransform",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.transformable;return(e.localDirtyFlag||e.dirtyFlag)&&(t.parentNode&&t.parentNode.transformable&&this.getWorldTransform(t.parentNode),this.internalUpdateTransform(t)),e.worldTransform;}},{key:"setPosition",value:function(t,e){var n,r=t.transformable;if(r2[0]=e[0],r2[1]=e[1],r2[2]=null!==(n=e[2])&&void 0!==n?n:0,!G.vec3.equals(this.getPosition(t),r2)){if(G.vec3.copy(r.position,r2),null!==t.parentNode&&t.parentNode.transformable){var i=t.parentNode.transformable;G.mat4.copy(r3,i.worldTransform),G.mat4.invert(r3,r3),G.vec3.transformMat4(r.localPosition,r2,r3);}else G.vec3.copy(r.localPosition,r2);this.dirtyLocalTransform(t,r);}}},{key:"translate",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.set(r$,e,n,r)),G.vec3.equals(e,rW)||(G.vec3.add(r$,this.getPosition(t),e),this.setPosition(t,r$));}},{key:"setRotation",value:function(t,e,n,r,i){var a=t.transformable;if("number"==typeof e&&(e=G.quat.fromValues(e,n,r,i)),null!==t.parentNode&&t.parentNode.transformable){var o=this.getRotation(t.parentNode);G.quat.copy(rZ,o),G.quat.invert(rZ,rZ),G.quat.multiply(a.localRotation,rZ,e),G.quat.normalize(a.localRotation,a.localRotation),this.dirtyLocalTransform(t,a);}else this.setLocalRotation(t,e);}},{key:"rotate",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var i=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){G.quat.fromEuler(rZ,e[0],e[1],e[2]);var a=this.getRotation(t),o=this.getRotation(t.parentNode);G.quat.copy(r6,o),G.quat.invert(r6,r6),G.quat.multiply(rZ,r6,rZ),G.quat.multiply(i.localRotation,rZ,a),G.quat.normalize(i.localRotation,i.localRotation),this.dirtyLocalTransform(t,i);}else this.rotateLocal(t,e);}},{key:"setOrigin",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=[e,n,r]);var i=t.transformable;if(e[0]!==i.origin[0]||e[1]!==i.origin[1]||e[2]!==i.origin[2]){var a=i.origin;a[0]=e[0],a[1]=e[1],a[2]=e[2]||0,this.dirtyLocalTransform(t,i);}}},{key:"setEulerAngles",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var i=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){G.quat.fromEuler(i.localRotation,e[0],e[1],e[2]);var a=this.getRotation(t.parentNode);G.quat.copy(r4,G.quat.invert(rZ,a)),G.quat.mul(i.localRotation,i.localRotation,r4),this.dirtyLocalTransform(t,i);}else this.setLocalEulerAngles(t,e);}},{key:"getGeometryBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.geometry;return n.dirty&&ia.styleValueRegistry.updateGeometry(t),(e?n.renderBounds:n.contentBounds||null)||new tr;}},{key:"getTransformedGeometryBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this.getGeometryBounds(t,e);if(!tr.isEmpty(r)){var i=n||new tr;return i.setFromTransformedAABB(r,this.getWorldTransform(t)),i;}return null;}},{key:"getBounds",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t.renderable;if(!r.boundsDirty&&!n&&r.bounds)return r.bounds;if(!r.renderBoundsDirty&&n&&r.renderBounds)return r.renderBounds;var i=n?r.renderBounds:r.bounds,a=this.getTransformedGeometryBounds(t,n,i);if(t.childNodes.forEach(function(t){var r=e.getBounds(t,n);r&&(a?a.add(r):(a=i||new tr).update(r.center,r.halfExtents));}),a||(a=new tr),n){var o=nQ(t);if(o){var s=o.parsedStyle.clipPath.getBounds(n);a?s&&(a=s.intersection(a)):a.update(s.center,s.halfExtents);}}return n?(r.renderBounds=a,r.renderBoundsDirty=!1):(r.bounds=a,r.boundsDirty=!1),a;}},{key:"getLocalBounds",value:function(t){if(t.parentNode){var e=rX;t.parentNode.transformable&&(e=G.mat4.invert(rK,this.getWorldTransform(t.parentNode)));var n=this.getBounds(t);if(!tr.isEmpty(n)){var r=new tr;return r.setFromTransformedAABB(n,e),r;}}return this.getBounds(t);}},{key:"getBoundingClientRect",value:function(t){var e,n,r=this.getGeometryBounds(t);tr.isEmpty(r)||(n=new tr).setFromTransformedAABB(r,this.getWorldTransform(t));var i=null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e?void 0:e.getContextService().getBoundingClientRect();if(n){var a=n.getMin(),o=(0,D.default)(a,2),s=o[0],l=o[1],u=n.getMax(),c=(0,D.default)(u,2),h=c[0],d=c[1];return new tl(s+((null==i?void 0:i.left)||0),l+((null==i?void 0:i.top)||0),h-s,d-l);}return new tl((null==i?void 0:i.left)||0,(null==i?void 0:i.top)||0,0,0);}},{key:"internalUpdateTransform",value:function(t){var e,n,r=null===(n=t.parentNode)||void 0===n?void 0:n.transformable;tI(t.transformable),(e=t.transformable).dirtyFlag&&(r?G.mat4.multiply(e.worldTransform,r.worldTransform,e.localTransform):G.mat4.copy(e.worldTransform,e.localTransform),e.dirtyFlag=!1);}},{key:"internalUpdateElement",value:function(t,e){var n=(null===(s=t.ownerDocument)||void 0===s||null===(s=s.defaultView)||void 0===s||null===(s=s.getConfig())||void 0===s||null===(s=s.future)||void 0===s?void 0:s.experimentalAttributeUpdateOptimization)===!0,r=e[e.length-1],i=(null==r?void 0:r.transformDirty)||(null===(l=t.transformable)||void 0===l?void 0:l.localDirtyFlag);t.transformable&&((h=t.transformable).dirtyFlag||(h.dirtyFlag=i)),this.internalUpdateTransform(t),i&&(null===(d=t.dirty)||void 0===d||d.call(t,!0,!0));var a=(null===(u=t.renderable)||void 0===u?void 0:u.boundsDirty)||(null===(c=t.renderable)||void 0===c?void 0:c.renderBoundsDirty);if((i||a)&&(null==r?void 0:r.shapeUpdated)===!1&&n)for(var o=e.length-1;o>=0;){var s,l,u,c,h,d,f,v,p=e[o];if(p.shapeUpdated)break;null===(f=(v=p.node).dirty)||void 0===f||f.call(v,!0,!0),p.shapeUpdated=!0,o-=1;}return i;}},{key:"syncHierarchy",value:function(t){for(var e,n,r=[t],i=t.parentNode?[{node:t.parentNode,transformDirty:(null===(e=t.parentNode.transformable)||void 0===e?void 0:e.localDirtyFlag)||(null===(n=t.parentNode.transformable)||void 0===n?void 0:n.dirtyFlag),shapeUpdated:!1}]:[];r.length>0;){for(var a=r.pop(),o=i[i.length-1];i.length>0&&a.parentNode!==o.node;)o=i.pop();var s=this.internalUpdateElement(a,i);if(a.childNodes.length>0){for(var l=a.childNodes.length-1;l>=0;l--)r.push(a.childNodes[l]);i.push({node:a,transformDirty:s,shapeUpdated:!1});}}}},{key:"dirtyLocalTransform",value:function(t,e){n1(t)||e.localDirtyFlag||(e.localDirtyFlag=!0,e.dirtyFlag||this.dirtyWorldTransform(t,e));}},{key:"dirtyWorldTransform",value:function(t,e){this.dirtyWorldInternal(t,e),this.dirtyToRoot(t,!0);}},{key:"dirtyWorldInternal",value:function(t,e){var n,r=this,i=(null===(n=t.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n||null===(n=n.getConfig())||void 0===n||null===(n=n.future)||void 0===n?void 0:n.experimentalAttributeUpdateOptimization)===!0;e.dirtyFlag||(e.dirtyFlag=!0,t.dirty(!0,!0),i||t.childNodes.forEach(function(t){var e=t.transformable;r.dirtyWorldInternal(t,e);}));}},{key:"dirtyToRoot",value:function(t){for(var e,n,r,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=t,o=(null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig())||void 0===e||null===(e=e.future)||void 0===e?void 0:e.experimentalAttributeUpdateOptimization)===!0;a&&(null===(n=(r=a).dirty)||void 0===n||n.call(r,!0,!0),!o);)a=a.parentNode;i&&t.forEach(function(t){var e;null===(e=t.dirty)||void 0===e||e.call(t,!0,!0);}),this.informDependentDisplayObjects(t);var s=t.mutations||[],l=s.find(function(t){return"attributes"===t.type&&t._boundsChangeData;});l?l._boundsChangeData={affectChildren:l._boundsChangeData.affectChildren||i}:(l={type:"attributes",target:t,_boundsChangeData:{affectChildren:i}},s.push(l)),t.mutations=s;}},{key:"dirtyFragment",value:function(t){var e,n=t.transformable;n&&(n.dirtyFlag=!0,n.localDirtyFlag=!0),null===(e=t.dirty)||void 0===e||e.call(t,!0,!0);for(var r=t.childNodes.length,i=0;i<r;i++)this.dirtyFragment(t.childNodes[i]);}},{key:"notifyMutationObservers",value:function(t){var e=new Set;if(t.getRoot().forEach(function(t){(t.mutations||[]).forEach(function(n){"attributes"===n.type&&n._boundsChangeData&&(n._boundsChangeData.affectChildren?t.forEach(function(t){var r=(0,A.default)({},n);r.target=t,e.add(r);}):e.add(n));}),t.mutations=void 0;}),e.size>0){var n=new rD(rV.BOUNDS_CHANGED,{detail:Array.from(e)});t.dispatchEvent(n,!0,!0);}}},{key:"updateDisplayObjectDependency",value:function(t,e,n,r){if(e&&e!==n){var i=this.displayObjectDependencyMap.get(e);if(i&&i[t]){var a=i[t].indexOf(r);i[t].splice(a,1);}}if(n){var o=this.displayObjectDependencyMap.get(n);o||(this.displayObjectDependencyMap.set(n,{}),o=this.displayObjectDependencyMap.get(n)),o[t]||(o[t]=[]),o[t].push(r);}}},{key:"informDependentDisplayObjects",value:function(t){var e,n=this,r=this.displayObjectDependencyMap.get(t);if(r){var i=null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig())||void 0===e||null===(e=e.future)||void 0===e?void 0:e.experimentalCancelEventPropagation;Object.keys(r).forEach(function(t){r[t].forEach(function(e){n.dirtyToRoot(e,!0),e.dispatchEvent(new rz(rV.ATTR_MODIFIED,e,n,n,t,rz.MODIFICATION,n,n),i,i),e.isCustomElement&&e.isConnected&&e.attributeChangedCallback&&e.attributeChangedCallback(t,n,n);});});}}}]),r9=(0,R.default)(function t(e){if((0,C.default)(this,t),e<=0)throw Error("LRU capacity must be a positive number.");this.capacity=e,this.cache=new Map;},[{key:"get",value:function(t){if(this.cache.has(t)){var e=this.cache.get(t);return this.cache.delete(t),this.cache.set(t,e),e;}}},{key:"put",value:function(t,e){if(this.cache.has(t)&&this.cache.delete(t),this.cache.set(t,e),this.cache.size>this.capacity){var n=this.cache.keys().next().value;this.cache.delete(n);}}},{key:"len",value:function(){return this.cache.size;}},{key:"clear",value:function(){this.cache.clear();}}]),r8={MetricsString:"|\xc9q\xc5",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},it=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,ie=new RegExp("".concat(/[!%),.:;?\]}'""]/.source,"|").concat(/[!),.:;?\]}'""]/.source,"|").concat(/[)\]'"?!:;,.]/.source,"|").concat(/[!%),.:;?\]}'"]/.source)),ir=new RegExp("".concat(/[$('"]/.source,"|").concat(/[([{'"]/.source,"|").concat(/[(['"...]/.source,"|").concat(/[$([{'"#]/.source)),ii=(0,R.default)(function t(e){var n=this;(0,C.default)(this,t),this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(t,e){return!n.isBreakingSpace(e)&&!!(t&&(ir.exec(e)||ie.exec(t)));},this.trimByKinsokuShorui=function(t){var e=(0,O.default)(t),n=e[e.length-2];if(!n)return t;var r=n[n.length-1];return e[e.length-2]=n.slice(0,-1),e[e.length-1]=r+e[e.length-1],e;},this.runtime=e,this.charWidthCache=new r9(100);},[{key:"measureFont",value:function(t,e){if(this.fontMetricsCache[t])return this.fontMetricsCache[t];var n={ascent:0,descent:0,fontSize:0},r=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(e),i=this.runtime.offscreenCanvasCreator.getOrCreateContext(e,{willReadFrequently:!0});i.font=t;var a=r8.MetricsString+r8.BaselineSymbol,o=Math.ceil(i.measureText(a).width),s=Math.ceil(i.measureText(r8.BaselineSymbol).width),l=r8.HeightMultiplier*s;s=s*r8.BaselineMultiplier|0,r.width=o,r.height=l,i.fillStyle="#f00",i.fillRect(0,0,o,l),i.font=t,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(a,0,s);var u=i.getImageData(0,0,o||1,l||1).data,c=u.length,h=4*o,d=0,f=0,v=!1;for(d=0;d<s;++d){for(var p=0;p<h;p+=4)if(255!==u[f+p]){v=!0;break;}if(v)break;f+=h;}for(n.ascent=s-d,f=c-h,v=!1,d=l;d>s;--d){for(var g=0;g<h;g+=4)if(255!==u[f+g]){v=!0;break;}if(v)break;f-=h;}return n.descent=d-s,n.fontSize=n.ascent+n.descent,this.fontMetricsCache[t]=n,n;}},{key:"measureText",value:function(t,e,n){var r=e.fontSize,i=void 0===r?16:r,a=e.wordWrap,o=e.lineHeight,s=e.lineWidth,l=void 0===s?1:s,u=e.textBaseline,c=void 0===u?"alphabetic":u,h=e.textAlign,d=void 0===h?"start":h,f=e.letterSpacing,v=void 0===f?0:f,p=e.textPath;e.textPathSide,e.textPathStartOffset;var g=e.leading,y=void 0===g?0:g,m=rc(e),k=this.measureFont(m,n);0===k.fontSize&&(k.fontSize=i,k.ascent=i);var E=this.runtime.offscreenCanvasCreator.getOrCreateContext(n);E.font=m,e.isOverflowing=!1;var x=(void 0!==a&&a?this.wordWrap(t,e,n):t).split(/(?:\r\n|\r|\n)/),T=Array(x.length),N=0;if(p){p.getTotalLength();for(var b=0;b<x.length;b++)E.measureText(x[b]).width,x[b].length;}else{for(var S=0;S<x.length;S++){var w=E.measureText(x[S]).width+(x[S].length-1)*v;T[S]=w,N=Math.max(N,w);}var P=N+l,M=o||k.fontSize+l,A=Math.max(M,k.fontSize+l)+(x.length-1)*(M+y);M+=y;var C=0;return"middle"===c?C=-A/2:"bottom"===c||"alphabetic"===c||"ideographic"===c?C=-A:("top"===c||"hanging"===c)&&(C=0),{font:m,width:P,height:A,lines:x,lineWidths:T,lineHeight:M,maxLineWidth:N,fontProperties:k,lineMetrics:T.map(function(t,e){var n=0;return"center"===d||"middle"===d?n-=t/2:("right"===d||"end"===d)&&(n-=t),new tl(n-l/2,C+e*M,t+l,M);})};}}},{key:"wordWrap",value:function(t,e,n){var r=this,i=Array.from(t);if(0===i.length)return"";var a=this,o=e.wordWrapWidth,s=e.letterSpacing,l=void 0===s?0:s,u=e.maxLines,c=void 0===u?1/0:u,h=e.textOverflow,d=this.runtime.offscreenCanvasCreator.getOrCreateContext(n),f=(void 0===o?0:o)+l,v="";"ellipsis"===h?v="...":h&&"clip"!==h&&(v=h);var p=[""],g=0,y=0,m=-1,k=rc(e),E=this.charWidthCache.get(k);E||(E=new r9(500),this.charWidthCache.put(k,E));var x=function(t){return r.getFromCache(t,l,E,d);},T=x(v);function N(t,e,n,r){for(;x(t)<r&&e<i.length-1&&!a.isNewline(i[e+1]);)e+=1,t+=i[e];for(;x(t)>r&&e>=n;)e-=1,t=t.slice(0,-1);return{lineTxt:t,txtLastCharIndex:e};}function b(t,e){if(!(T<=0)&&!(T>f)){if(!p[t]){p[t]=v;return;}var n=N(p[t],e,m+1,f-T);p[t]=n.lineTxt+v;}}for(var S=0;S<i.length;S++){var w=i[S],P=i[S-1],M=i[S+1],A=x(w);if(this.isNewline(w)){if(g+1>=c){S<i.length-1&&b(g,S-1),e.isOverflowing=!0;break;}m=S-1,y=0,p[g+=1]="";continue;}if(A>f){b(g,S-1),e.isOverflowing=!0;break;}if(y>0&&y+A>f){var C=N(p[g],S-1,m+1,f);if(C.txtLastCharIndex!==S-1){if(p[g]=C.lineTxt,C.txtLastCharIndex===i.length-1)break;w=i[S=C.txtLastCharIndex+1],P=i[S-1],M=i[S+1],A=x(w);}if(g+1>=c){b(g,S-1),e.isOverflowing=!0;break;}if(m=S-1,y=0,p[g+=1]="",this.isBreakingSpace(w))continue;this.canBreakInLastChar(w)||(p=this.trimToBreakable(p),y=this.sumTextWidthByCache(p[g]||"",x)),this.shouldBreakByKinsokuShorui(w,M)&&(p=this.trimByKinsokuShorui(p),y+=x(P||""));}y+=A,p[g]+=w;}return p.join("\n");}},{key:"isBreakingSpace",value:function(t){return"string"==typeof t&&r8.BreakingSpaces.indexOf(t.charCodeAt(0))>=0;}},{key:"isNewline",value:function(t){return"string"==typeof t&&r8.Newlines.indexOf(t.charCodeAt(0))>=0;}},{key:"trimToBreakable",value:function(t){var e=(0,O.default)(t),n=e[e.length-2],r=this.findBreakableIndex(n);if(-1===r||!n)return e;var i=n.slice(r,r+1),a=this.isBreakingSpace(i);return e[e.length-1]+=n.slice(r+1,n.length),e[e.length-2]=n.slice(0,r+(a?0:1)),e;}},{key:"canBreakInLastChar",value:function(t){return!(t&&it.test(t));}},{key:"sumTextWidthByCache",value:function(t,e){return t.split("").reduce(function(t,n){return t+e(n);},0);}},{key:"findBreakableIndex",value:function(t){for(var e=t.length-1;e>=0;e--)if(!it.test(t[e]))return e;return -1;}},{key:"getFromCache",value:function(t,e,n,r){var i=n.get(t);if("number"!=typeof i){var a=t.length*e;i=r.measureText(t).width+a,n.put(t,i);}return i;}},{key:"clearCache",value:function(){this.fontMetricsCache={},this.charWidthCache.clear();}}]),ia={},io=(T=new rP,N=new rw,x={},(0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)(x,j.FRAGMENT,null),j.CIRCLE,new rT),j.ELLIPSE,new rN),j.RECT,T),j.IMAGE,T),j.GROUP,new rA),j.LINE,new rb),j.TEXT,new rM(ia)),j.POLYLINE,N),j.POLYGON,N),(0,B.default)((0,B.default)((0,B.default)(x,j.PATH,new rS),j.HTML,new rC),j.MESH,null)),is=(S=new n_,w=new nB,b={},(0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)(b,t_.PERCENTAGE,null),t_.NUMBER,new nH),t_.ANGLE,new nI),t_.DEFINED_PATH,new nD),t_.PAINT,S),t_.COLOR,S),t_.FILTER,new nG),t_.LENGTH,w),t_.LENGTH_PERCENTAGE,w),t_.LENGTH_PERCENTAGE_12,new nU),(0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)(b,t_.LENGTH_PERCENTAGE_14,new nV),t_.COORDINATE,new nB),t_.OFFSET_DISTANCE,new nY),t_.OPACITY_VALUE,new nW),t_.PATH,new nq),t_.LIST_OF_POINTS,new nX),t_.SHADOW_BLUR,new nj),t_.TEXT,new n$),t_.TEXT_TRANSFORM,new nK),t_.TRANSFORM,new rk),(0,B.default)((0,B.default)((0,B.default)(b,t_.TRANSFORM_ORIGIN,new rE),t_.Z_INDEX,new rx),t_.MARKER,new nz));ia.CameraContribution=tM,ia.AnimationTimeline=null,ia.EasingFunction=null,ia.offscreenCanvasCreator=new rG,ia.sceneGraphSelector=new rU,ia.sceneGraphService=new r7(ia),ia.textService=new ii(ia),ia.geometryUpdaterFactory=io,ia.CSSPropertySyntaxFactory=is,ia.styleValueRegistry=new nO(ia),ia.layoutRegistry=null,ia.globalThis="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==X?X:{},ia.enableStyleSyntax=!0,ia.enableSizeAttenuation=!1;var il=0,iu=new rz(rV.INSERTED,null,"","","",0,"",""),ic=new rz(rV.REMOVED,null,"","","",0,"",""),ih=new rD(rV.DESTROY),id=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).entity=il++,t.transformable={dirtyFlag:!1,localDirtyFlag:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},t.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},t.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},t.cullable={strategy:tA.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},t.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},t.rBushNode={aabb:void 0},t.namespaceURI="g",t.scrollLeft=0,t.scrollTop=0,t.clientTop=0,t.clientLeft=0,t.style={},t.computedStyle={},t.parsedStyle={},t.attributes={},t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"dirty",value:function(){var t=!(arguments.length>0)||void 0===arguments[0]||arguments[0],e=arguments.length>1?arguments[1]:void 0;this.renderable.dirty=t,void 0!==e&&(this.renderable.boundsDirty=e,this.renderable.renderBoundsDirty=e,this.geometry.dirty=e);}},{key:"className",get:function(){return this.getAttribute("class")||"";},set:function(t){this.setAttribute("class",t);}},{key:"classList",get:function(){return this.className.split(" ").filter(function(t){return""!==t;});}},{key:"tagName",get:function(){return this.nodeName;}},{key:"children",get:function(){return this.childNodes;}},{key:"childElementCount",get:function(){return this.childNodes.length;}},{key:"firstElementChild",get:function(){return this.firstChild;}},{key:"lastElementChild",get:function(){return this.lastChild;}},{key:"parentElement",get:function(){return this.parentNode;}},{key:"nextSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t+1]||null;}return null;}},{key:"previousSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t-1]||null;}return null;}},{key:"cloneNode",value:function(t){throw Error(tu);}},{key:"appendChild",value:function(t,e){var n;if(t.destroyed)throw Error("Cannot append a destroyed element.");return ia.sceneGraphService.attach(t,this,e),null!==(n=this.ownerDocument)&&void 0!==n&&n.defaultView&&(n1(this)||t.nodeName!==j.FRAGMENT?this.ownerDocument.defaultView.mountChildren(t):this.ownerDocument.defaultView.mountFragment(t)),this.isMutationObserved&&(iu.relatedNode=this,t.dispatchEvent(iu)),t;}},{key:"insertBefore",value:function(t,e){if(e){t.parentElement&&t.parentElement.removeChild(t);var n=this.childNodes.indexOf(e);-1===n?this.appendChild(t):this.appendChild(t,n);}else this.appendChild(t);return t;}},{key:"replaceChild",value:function(t,e){var n=this.childNodes.indexOf(e);return this.removeChild(e),this.appendChild(t,n),e;}},{key:"removeChild",value:function(t){var e,n,r=(null===(e=this.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig().future)||void 0===e?void 0:e.experimentalCancelEventPropagation)===!0;return ic.relatedNode=this,t.dispatchEvent(ic,r,r),null!==(n=t.ownerDocument)&&void 0!==n&&n.defaultView&&t.ownerDocument.defaultView.unmountChildren(t),ia.sceneGraphService.detach(t),t;}},{key:"removeChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var e=this.childNodes[t];this.removeChild(e);}}},{key:"destroyChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var e=this.childNodes[t];e.childNodes.length>0&&e.destroyChildren(),e.destroy();}}},{key:"matches",value:function(t){return ia.sceneGraphService.matches(t,this);}},{key:"getElementById",value:function(t){return ia.sceneGraphService.querySelector("#".concat(t),this);}},{key:"getElementsByName",value:function(t){return ia.sceneGraphService.querySelectorAll('[name="'.concat(t,'"]'),this);}},{key:"getElementsByClassName",value:function(t){return ia.sceneGraphService.querySelectorAll(".".concat(t),this);}},{key:"getElementsByTagName",value:function(t){return ia.sceneGraphService.querySelectorAll(t,this);}},{key:"querySelector",value:function(t){return ia.sceneGraphService.querySelector(t,this);}},{key:"querySelectorAll",value:function(t){return ia.sceneGraphService.querySelectorAll(t,this);}},{key:"closest",value:function(t){var e=this;do{if(ia.sceneGraphService.matches(t,e))return e;e=e.parentElement;}while(null!==e)return null;}},{key:"find",value:function(t){var e=this,n=null;return this.forEach(function(r){return!(r!==e&&t(r))||(n=r,!1);}),n;}},{key:"findAll",value:function(t){var e=this,n=[];return this.forEach(function(r){r!==e&&t(r)&&n.push(r);}),n;}},{key:"after",value:function(){var t=this;if(this.parentNode){for(var e=this.parentNode.childNodes.indexOf(this),n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];r.forEach(function(n,r){var i;return null===(i=t.parentNode)||void 0===i?void 0:i.appendChild(n,e+r+1);});}}},{key:"before",value:function(){if(this.parentNode){for(var t=this.parentNode.childNodes.indexOf(this),e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n[0],a=(0,V.default)(n).slice(1);this.parentNode.appendChild(i,t),i.after.apply(i,(0,O.default)(a));}}},{key:"replaceWith",value:function(){this.after.apply(this,arguments),this.remove();}},{key:"append",value:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(function(e){return t.appendChild(e);});}},{key:"prepend",value:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(function(e,n){return t.appendChild(e,n);});}},{key:"replaceChildren",value:function(){for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,arguments);}},{key:"remove",value:function(){return this.parentNode?this.parentNode.removeChild(this):this;}},{key:"destroy",value:function(){var t,e=(null===(t=this.ownerDocument)||void 0===t||null===(t=t.defaultView)||void 0===t||null===(t=t.getConfig().future)||void 0===t?void 0:t.experimentalCancelEventPropagation)===!0;this.destroyChildren(),this.dispatchEvent(ih,e,e),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0;}},{key:"getGeometryBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return ia.sceneGraphService.getGeometryBounds(this,t);}},{key:"getTransformedGeometryBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return ia.sceneGraphService.getTransformedGeometryBounds(this,t);}},{key:"getBounds",value:function(){return ia.sceneGraphService.getBounds(this);}},{key:"getRenderBounds",value:function(){return ia.sceneGraphService.getBounds(this,!0);}},{key:"getLocalBounds",value:function(){return ia.sceneGraphService.getLocalBounds(this);}},{key:"getBoundingClientRect",value:function(){return ia.sceneGraphService.getBoundingClientRect(this);}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()];}},{key:"computedStyleMap",value:function(){return new Map(Object.entries(this.computedStyle));}},{key:"getAttributeNames",value:function(){return Object.keys(this.attributes);}},{key:"getAttribute",value:function(t){if("symbol"!=typeof t)return this.attributes[t];}},{key:"hasAttribute",value:function(t){return this.getAttributeNames().includes(t);}},{key:"hasAttributes",value:function(){return!!this.getAttributeNames().length;}},{key:"removeAttribute",value:function(t){this.setAttribute(t,null),delete this.attributes[t];}},{key:"setAttribute",value:function(t,e){this.attributes[t]=e;}},{key:"getAttributeNS",value:function(t,e){throw Error(tu);}},{key:"getAttributeNode",value:function(t){throw Error(tu);}},{key:"getAttributeNodeNS",value:function(t,e){throw Error(tu);}},{key:"hasAttributeNS",value:function(t,e){throw Error(tu);}},{key:"removeAttributeNS",value:function(t,e){throw Error(tu);}},{key:"removeAttributeNode",value:function(t){throw Error(tu);}},{key:"setAttributeNS",value:function(t,e,n){throw Error(tu);}},{key:"setAttributeNode",value:function(t){throw Error(tu);}},{key:"setAttributeNodeNS",value:function(t){throw Error(tu);}},{key:"toggleAttribute",value:function(t,e){throw Error(tu);}}]);}(r_);function iv(t){return!!(null!=t&&t.nodeName);}var ip=ia.globalThis.Proxy?ia.globalThis.Proxy:function(){},ig=new rz(rV.ATTR_MODIFIED,null,null,null,null,rz.MODIFICATION,null,null),iy=G.vec3.create(),im=G.quat.create(),ik=function(t){function e(t){var n;return(0,C.default)(this,e),(n=(0,L.default)(this,e)).isCustomElement=!1,n.isMutationObserved=!1,n.activeAnimations=[],n.config=t,n.id=t.id||"",n.name=t.name||"",(t.className||t.class)&&(n.className=t.className||t.class),n.nodeName=t.type||j.GROUP,t.initialParsedStyle&&Object.assign(n.parsedStyle,t.initialParsedStyle),n.initAttributes(t.style),ia.enableStyleSyntax&&(n.style=new ip({setProperty:function(t,e){n.setAttribute(t,e);},getPropertyValue:function(t){return n.getAttribute(t);},removeProperty:function(t){n.removeAttribute(t);},item:function(){return"";}},{get:function(t,e){return void 0!==t[e]?t[e]:n.getAttribute(e);},set:function(t,e,r){return n.setAttribute(e,r),!0;}})),n;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"destroy",value:function(){(0,U.default)(e,"destroy",this,3)([]),this.getAnimations().forEach(function(t){t.cancel();});}},{key:"cloneNode",value:function(t,e){var n=(0,A.default)({},this.attributes);for(var r in n){var i=n[r];iv(i)&&"clipPath"!==r&&"offsetPath"!==r&&"textPath"!==r&&(n[r]=i.cloneNode(t)),e&&(n[r]=e(r,i));}var a=new this.constructor((0,A.default)((0,A.default)({},this.config),{},{style:n}));return a.setLocalTransform(this.getLocalTransform()),t&&this.children.forEach(function(e){if(!e.style.isMarker){var n=e.cloneNode(t);a.appendChild(n);}}),a;}},{key:"initAttributes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ia.styleValueRegistry.processProperties(this,t,{forceUpdateGeometry:!0}),this.dirty();}},{key:"setAttribute",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!(arguments.length>3)||void 0===arguments[3]||arguments[3];!(0,F.isUndefined)(n)&&(r||n!==this.attributes[t])&&(this.internalSetAttribute(t,n,{memoize:i}),(0,U.default)(e,"setAttribute",this,3)([t,n]));}},{key:"internalSetAttribute",value:function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.attributes[t],a=this.parsedStyle[t];ia.styleValueRegistry.processProperties(this,(0,B.default)({},t,e),r),this.dirty();var o=this.parsedStyle[t];if(this.isConnected){if(ig.relatedNode=this,ig.prevValue=i,ig.newValue=e,ig.attrName=t,ig.prevParsedValue=a,ig.newParsedValue=o,this.isMutationObserved)this.dispatchEvent(ig);else{var s,l=(null===(s=this.ownerDocument.defaultView.getConfig().future)||void 0===s?void 0:s.experimentalCancelEventPropagation)===!0;ig.target=this,this.ownerDocument.defaultView.dispatchEvent(ig,!0,l);}}(this.isCustomElement&&this.isConnected||!this.isCustomElement)&&(null===(n=this.attributeChangedCallback)||void 0===n||n.call(this,t,i,e,a,o));}},{key:"getBBox",value:function(){var t=this.getBounds(),e=t.getMin(),n=(0,D.default)(e,2),r=n[0],i=n[1],a=t.getMax(),o=(0,D.default)(a,2);return new tl(r,i,o[0]-r,o[1]-i);}},{key:"setOrigin",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ia.sceneGraphService.setOrigin(this,td(t,e,n,!1)),this;}},{key:"getOrigin",value:function(){return ia.sceneGraphService.getOrigin(this);}},{key:"setPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ia.sceneGraphService.setPosition(this,td(t,e,n,!1)),this;}},{key:"setLocalPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ia.sceneGraphService.setLocalPosition(this,td(t,e,n,!1)),this;}},{key:"translate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ia.sceneGraphService.translate(this,td(t,e,n,!1)),this;}},{key:"translateLocal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ia.sceneGraphService.translateLocal(this,td(t,e,n,!1)),this;}},{key:"getPosition",value:function(){return ia.sceneGraphService.getPosition(this);}},{key:"getLocalPosition",value:function(){return ia.sceneGraphService.getLocalPosition(this);}},{key:"scale",value:function(t,e,n){return this.scaleLocal(t,e,n);}},{key:"scaleLocal",value:function(t,e,n){return"number"==typeof t&&(e=e||t,n=n||t,t=td(t,e,n,!1)),ia.sceneGraphService.scaleLocal(this,t),this;}},{key:"setLocalScale",value:function(t,e,n){return"number"==typeof t&&(e=e||t,n=n||t,t=td(t,e,n,!1)),ia.sceneGraphService.setLocalScale(this,t),this;}},{key:"getLocalScale",value:function(){return ia.sceneGraphService.getLocalScale(this);}},{key:"getScale",value:function(){return ia.sceneGraphService.getScale(this);}},{key:"getEulerAngles",value:function(){var t=tg(iy,ia.sceneGraphService.getWorldTransform(this));return(0,D.default)(t,3)[2]*tv;}},{key:"getLocalEulerAngles",value:function(){var t=tg(iy,ia.sceneGraphService.getLocalRotation(this));return(0,D.default)(t,3)[2]*tv;}},{key:"setEulerAngles",value:function(t){return ia.sceneGraphService.setEulerAngles(this,0,0,t),this;}},{key:"setLocalEulerAngles",value:function(t){return ia.sceneGraphService.setLocalEulerAngles(this,0,0,t),this;}},{key:"rotateLocal",value:function(t,e,n){return(0,F.isNil)(e)&&(0,F.isNil)(n)?ia.sceneGraphService.rotateLocal(this,0,0,t):ia.sceneGraphService.rotateLocal(this,t,e,n),this;}},{key:"rotate",value:function(t,e,n){return(0,F.isNil)(e)&&(0,F.isNil)(n)?ia.sceneGraphService.rotate(this,0,0,t):ia.sceneGraphService.rotate(this,t,e,n),this;}},{key:"setRotation",value:function(t,e,n,r){return ia.sceneGraphService.setRotation(this,t,e,n,r),this;}},{key:"setLocalRotation",value:function(t,e,n,r){return ia.sceneGraphService.setLocalRotation(this,t,e,n,r),this;}},{key:"setLocalSkew",value:function(t,e){return ia.sceneGraphService.setLocalSkew(this,t,e),this;}},{key:"getRotation",value:function(){return ia.sceneGraphService.getRotation(this);}},{key:"getLocalRotation",value:function(){return ia.sceneGraphService.getLocalRotation(this);}},{key:"getLocalSkew",value:function(){return ia.sceneGraphService.getLocalSkew(this);}},{key:"getLocalTransform",value:function(){return ia.sceneGraphService.getLocalTransform(this);}},{key:"getWorldTransform",value:function(){return ia.sceneGraphService.getWorldTransform(this);}},{key:"setLocalTransform",value:function(t){return ia.sceneGraphService.setLocalTransform(this,t),this;}},{key:"resetLocalTransform",value:function(){ia.sceneGraphService.resetLocalTransform(this);}},{key:"getAnimations",value:function(){return this.activeAnimations;}},{key:"animate",value:function(t,e){var n,r=null===(n=this.ownerDocument)||void 0===n?void 0:n.timeline;return r?r.play(this,t,e):null;}},{key:"isVisible",value:function(){var t;return(null===(t=this.parsedStyle)||void 0===t?void 0:t.visibility)!=="hidden";}},{key:"interactive",get:function(){return this.isInteractive();},set:function(t){this.style.pointerEvents=t?"auto":"none";}},{key:"isInteractive",value:function(){var t;return(null===(t=this.parsedStyle)||void 0===t?void 0:t.pointerEvents)!=="none";}},{key:"isCulled",value:function(){return!!(this.cullable&&this.cullable.enable&&!this.cullable.visible);}},{key:"toFront",value:function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,(0,O.default)(this.parentNode.children.map(function(t){return Number(t.style.zIndex);})))+1),this;}},{key:"toBack",value:function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,(0,O.default)(this.parentNode.children.map(function(t){return Number(t.style.zIndex);})))-1),this;}},{key:"getConfig",value:function(){return this.config;}},{key:"attr",value:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n[0],a=n[1];return i?(0,F.isObject)(i)?(Object.keys(i).forEach(function(e){t.setAttribute(e,i[e]);}),this):2===n.length?(this.setAttribute(i,a),this):this.attributes[i]:this.attributes;}},{key:"getMatrix",value:function(t){var e,n,r,i=t||this.getWorldTransform(),a=G.mat4.getTranslation(iy,i),o=(0,D.default)(a,2),s=o[0],l=o[1],u=G.mat4.getScaling(iy,i),c=(0,D.default)(u,2),h=c[0],d=c[1],f=tg(iy,G.mat4.getRotation(im,i)),v=(0,D.default)(f,3),p=v[0],g=v[2];return n=Math.cos(e=p||g),r=Math.sin(e),G.mat3.fromValues(h*n,d*r,0,-h*r,d*n,0,s,l,1);}},{key:"getLocalMatrix",value:function(){return this.getMatrix(this.getLocalTransform());}},{key:"setMatrix",value:function(t){var e=ty(t),n=(0,D.default)(e,5),r=n[0],i=n[1],a=n[2],o=n[3],s=n[4];this.setEulerAngles(s).setPosition(r,i).setLocalScale(a,o);}},{key:"setLocalMatrix",value:function(t){var e=ty(t),n=(0,D.default)(e,5),r=n[0],i=n[1],a=n[2],o=n[3],s=n[4];this.setLocalEulerAngles(s).setLocalPosition(r,i).setLocalScale(a,o);}},{key:"show",value:function(){this.forEach(function(t){t.style.visibility="visible";});}},{key:"hide",value:function(){this.forEach(function(t){t.style.visibility="hidden";});}},{key:"getCount",value:function(){return this.childElementCount;}},{key:"getParent",value:function(){return this.parentElement;}},{key:"getChildren",value:function(){return this.children;}},{key:"getFirst",value:function(){return this.firstElementChild;}},{key:"getLast",value:function(){return this.lastElementChild;}},{key:"getChildByIndex",value:function(t){return this.children[t]||null;}},{key:"add",value:function(t,e){return this.appendChild(t,e);}},{key:"set",value:function(t,e){this.config[t]=e;}},{key:"get",value:function(t){return this.config[t];}},{key:"moveTo",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(t,e,n),this;}},{key:"move",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(t,e,n),this;}},{key:"setZIndex",value:function(t){return this.style.zIndex=t,this;}}]);}(id);ik.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","display","draggable","droppable","fill","fillOpacity","fillRule","filter","increasedLineWidthForHitTesting","lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit","hitArea","offsetDistance","offsetPath","offsetX","offsetY","opacity","pointerEvents","shadowColor","shadowType","shadowBlur","shadowOffsetX","shadowOffsetY","stroke","strokeOpacity","strokeWidth","strokeLinecap","strokeLineJoin","strokeDasharray","strokeDashoffset","transform","transformOrigin","textTransform","visibility","zIndex"]);var iE=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.CIRCLE},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(ik);iE.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(ik.PARSED_STYLE_LIST),["cx","cy","cz","r","isBillboard","isSizeAttenuation"]));var ix=["style"];(function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,ix);return(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({style:r},i)])).isCustomElement=!0,t;}return(0,I.default)(e,t),(0,R.default)(e);})(ik).PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var iT=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.ELLIPSE},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(ik);iT.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(ik.PARSED_STYLE_LIST),["cx","cy","cz","rx","ry","isBillboard","isSizeAttenuation"])),function(t){function e(){return(0,C.default)(this,e),(0,L.default)(this,e,[{type:j.FRAGMENT}]);}return(0,I.default)(e,t),(0,R.default)(e);}(ik).PARSED_STYLE_LIST=new Set(["class","className"]);var iN=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.GROUP},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(ik);iN.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var ib=["style"],iS=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,ib);return(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({type:j.HTML,style:r},i)])).cullable.enable=!1,t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getDomElement",value:function(){return this.parsedStyle.$el;}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()];}},{key:"getLocalBounds",value:function(){if(this.parentNode){var t=G.mat4.invert(G.mat4.create(),this.parentNode.getWorldTransform()),e=this.getBounds();if(!tr.isEmpty(e)){var n=new tr;return n.setFromTransformedAABB(e,t),n;}}return this.getBounds();}}]);}(ik);iS.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(ik.PARSED_STYLE_LIST),["x","y","$el","innerHTML","width","height"]));var iw=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.IMAGE},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(ik);iw.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(ik.PARSED_STYLE_LIST),["x","y","z","src","width","height","isBillboard","billboardRotation","isSizeAttenuation","keepAspectRatio"]));var iP=["style"],iM=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iP);(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({type:j.LINE,style:(0,A.default)({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},r)},i)])).markerStartAngle=0,t.markerEndAngle=0;var a=t.parsedStyle,o=a.markerStart,s=a.markerEnd;return o&&iv(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),s&&iv(s)&&(t.markerEndAngle=s.getLocalEulerAngles(),t.appendChild(s)),t.transformMarker(!0),t.transformMarker(!1),t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"x1"===t||"y1"===t||"x2"===t||"y2"===t||"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&iv(r)&&(this.markerStartAngle=0,r.remove()),i&&iv(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t&&(r&&iv(r)&&(this.markerEndAngle=0,r.remove()),i&&iv(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1)));}},{key:"transformMarker",value:function(t){var e,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,h=s.markerEndOffset,d=s.x1,f=s.x2,v=s.y1,p=s.y2,g=t?l:u;if(g&&iv(g)){var y=0;t?(r=d,i=v,e=f-d,n=p-v,a=c||0,o=this.markerStartAngle):(r=f,i=p,e=d-f,n=v-p,a=h||0,o=this.markerEndAngle),y=Math.atan2(n,e),g.setLocalEulerAngles(180*y/Math.PI+o),g.setLocalPosition(r+Math.cos(y)*a,i+Math.sin(y)*a);}}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle,r=n.x1,i=n.y1,a=n.x2,o=n.y2,s=(0,z.linePointAt)(r,i,a,o,t),l=s.x,u=s.y,c=G.vec3.transformMat4(G.vec3.create(),G.vec3.fromValues(l,u,0),e?this.getWorldTransform():this.getLocalTransform());return new ts(c[0],c[1]);}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(t/this.getTotalLength(),e);}},{key:"getTotalLength",value:function(){var t=this.parsedStyle,e=t.x1,n=t.y1,r=t.x2,i=t.y2;return(0,z.lineLength)(e,n,r,i);}}]);}(ik);iM.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(ik.PARSED_STYLE_LIST),["x1","y1","x2","y2","z1","z2","isBillboard","isSizeAttenuation","markerStart","markerEnd","markerStartOffset","markerEndOffset"]));var iA=["style"],iC=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iA);(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({type:j.PATH,style:r,initialParsedStyle:{miterLimit:4,d:(0,A.default)({},tD)}},i)])).markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var a=t.parsedStyle,o=a.markerStart,s=a.markerEnd,l=a.markerMid;return o&&iv(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),l&&iv(l)&&t.placeMarkerMid(l),s&&iv(s)&&(t.markerEndAngle=s.getLocalEulerAngles(),t.appendChild(s)),t.transformMarker(!0),t.transformMarker(!1),t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"d"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&iv(r)&&(this.markerStartAngle=0,r.remove()),i&&iv(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t?(r&&iv(r)&&(this.markerEndAngle=0,r.remove()),i&&iv(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(i);}},{key:"transformMarker",value:function(t){var e,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,h=s.markerEndOffset,d=t?l:u;if(d&&iv(d)){var f=0;if(t){var v=this.getStartTangent(),p=(0,D.default)(v,2),g=p[0],y=p[1];r=y[0],i=y[1],e=g[0]-y[0],n=g[1]-y[1],a=c||0,o=this.markerStartAngle;}else{var m=this.getEndTangent(),k=(0,D.default)(m,2),E=k[0],x=k[1];r=x[0],i=x[1],e=E[0]-x[0],n=E[1]-x[1],a=h||0,o=this.markerEndAngle;}f=Math.atan2(n,e),d.setLocalEulerAngles(180*f/Math.PI+o),d.setLocalPosition(r+Math.cos(f)*a,i+Math.sin(f)*a);}}},{key:"placeMarkerMid",value:function(t){var e=this.parsedStyle.d.segments;if(this.markerMidList.forEach(function(t){t.remove();}),t&&iv(t))for(var n=1;n<e.length-1;n++){var r=(0,D.default)(e[n].currentPoint,2),i=r[0],a=r[1],o=1===n?t:t.cloneNode(!0);this.markerMidList.push(o),this.appendChild(o),o.setLocalPosition(i,a);}}},{key:"getTotalLength",value:function(){return e7(this);}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle.d.absolutePath,r=(0,F.getPointAtLength)(n,t),i=r.x,a=r.y,o=G.vec3.transformMat4(G.vec3.create(),G.vec3.fromValues(i,a,0),e?this.getWorldTransform():this.getLocalTransform());return new ts(o[0],o[1]);}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPointAtLength(t*e7(this),e);}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.d.segments,e=[];if(t.length>1){var n=t[0].currentPoint,r=t[1].currentPoint,i=t[1].startTangent;e=[],i?e.push([n[0]-i[0],n[1]-i[1]]):e.push([r[0],r[1]]),e.push([n[0],n[1]]);}return e;}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.d.segments,e=t.length,n=[];if(e>1){var r=t[e-2].currentPoint,i=t[e-1].currentPoint,a=t[e-1].endTangent;n=[],a?n.push([i[0]-a[0],i[1]-a[1]]):n.push([r[0],r[1]]),n.push([i[0],i[1]]);}return n;}}]);}(ik);iC.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(ik.PARSED_STYLE_LIST),["d","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard","isSizeAttenuation"]));var iR=["style"],iO=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iR);(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({type:j.POLYGON,style:r,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},i)])).markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var a=t.parsedStyle,o=a.markerStart,s=a.markerEnd,l=a.markerMid;return o&&iv(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),l&&iv(l)&&t.placeMarkerMid(l),s&&iv(s)&&(t.markerEndAngle=s.getLocalEulerAngles(),t.appendChild(s)),t.transformMarker(!0),t.transformMarker(!1),t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"points"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&iv(r)&&(this.markerStartAngle=0,r.remove()),i&&iv(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t?(r&&iv(r)&&(this.markerEndAngle=0,r.remove()),i&&iv(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(i);}},{key:"transformMarker",value:function(t){var e,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,h=s.markerEndOffset,d=(s.points||{}).points,f=t?l:u;if(f&&iv(f)&&d){var v=0;if(r=d[0][0],i=d[0][1],t)e=d[1][0]-d[0][0],n=d[1][1]-d[0][1],a=c||0,o=this.markerStartAngle;else{var p=d.length;this.parsedStyle.isClosed?(e=d[p-1][0]-d[0][0],n=d[p-1][1]-d[0][1]):(r=d[p-1][0],i=d[p-1][1],e=d[p-2][0]-d[p-1][0],n=d[p-2][1]-d[p-1][1]),a=h||0,o=this.markerEndAngle;}v=Math.atan2(n,e),f.setLocalEulerAngles(180*v/Math.PI+o),f.setLocalPosition(r+Math.cos(v)*a,i+Math.sin(v)*a);}}},{key:"placeMarkerMid",value:function(t){var e=(this.parsedStyle.points||{}).points;if(this.markerMidList.forEach(function(t){t.remove();}),this.markerMidList=[],t&&iv(t)&&e)for(var n=1;n<(this.parsedStyle.isClosed?e.length:e.length-1);n++){var r=e[n][0],i=e[n][1],a=1===n?t:t.cloneNode(!0);this.markerMidList.push(a),this.appendChild(a),a.setLocalPosition(r,i);}}}]);}(ik);iO.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(ik.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isClosed","isBillboard","isSizeAttenuation"]));var iL=["style"],iI=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.style,r=(0,q.default)(t,iL);return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.POLYLINE,style:n,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},r)]);}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getTotalLength",value:function(){return 0===this.parsedStyle.points.totalLength&&(this.parsedStyle.points.totalLength=(0,z.polylineLength)(this.parsedStyle.points.points)),this.parsedStyle.points.totalLength;}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(t/this.getTotalLength(),e);}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle.points.points;if(0===this.parsedStyle.points.segments.length){var r,i,a=[],o=0,s=this.getTotalLength();n.forEach(function(t,e){n[e+1]&&((r=[0,0])[0]=o/s,i=(0,z.lineLength)(t[0],t[1],n[e+1][0],n[e+1][1]),o+=i,r[1]=o/s,a.push(r));}),this.parsedStyle.points.segments=a;}var l=0,u=0;this.parsedStyle.points.segments.forEach(function(e,n){t>=e[0]&&t<=e[1]&&(l=(t-e[0])/(e[1]-e[0]),u=n);});var c=(0,z.linePointAt)(n[u][0],n[u][1],n[u+1][0],n[u+1][1],l),h=c.x,d=c.y,f=G.vec3.transformMat4(G.vec3.create(),G.vec3.fromValues(h,d,0),e?this.getWorldTransform():this.getLocalTransform());return new ts(f[0],f[1]);}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.points.points,e=[];return e.push([t[1][0],t[1][1]]),e.push([t[0][0],t[0][1]]),e;}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.points.points,e=t.length-1,n=[];return n.push([t[e-1][0],t[e-1][1]]),n.push([t[e][0],t[e][1]]),n;}}]);}(iO);iI.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iO.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard"]));var iD=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.RECT},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(ik);iD.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(ik.PARSED_STYLE_LIST),["x","y","z","width","height","isBillboard","isSizeAttenuation","radius"]));var i_=["style"],iG=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.style,r=(0,q.default)(t,i_);return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.TEXT,style:(0,A.default)({fill:"black"},n)},r)]);}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getComputedTextLength",value:function(){var t;return this.getGeometryBounds(),(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.maxLineWidth)||0;}},{key:"getLineBoundingRects",value:function(){var t;return this.getGeometryBounds(),(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.lineMetrics)||[];}},{key:"isOverflowing",value:function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing;}}]);}(ik);iG.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(ik.PARSED_STYLE_LIST),["x","y","z","isBillboard","billboardRotation","isSizeAttenuation","text","textAlign","textBaseline","fontStyle","fontSize","fontFamily","fontWeight","fontVariant","lineHeight","letterSpacing","leading","wordWrap","wordWrapWidth","maxLines","textOverflow","isOverflowing","textPath","textDecorationLine","textDecorationColor","textDecorationStyle","textDecorationThickness","textPathSide","textPathStartOffset","metrics","dx","dy"])),(0,R.default)(function t(){(0,C.default)(this,t),this.registry={},this.define(j.CIRCLE,iE),this.define(j.ELLIPSE,iT),this.define(j.RECT,iD),this.define(j.IMAGE,iw),this.define(j.LINE,iM),this.define(j.GROUP,iN),this.define(j.PATH,iC),this.define(j.POLYGON,iO),this.define(j.POLYLINE,iI),this.define(j.TEXT,iG),this.define(j.HTML,iS);},[{key:"define",value:function(t,e){this.registry[t]=e;}},{key:"get",value:function(t){return this.registry[t];}}]),function(){function t(e){(0,C.default)(this,t),this.strategies=e;}return(0,R.default)(t,[{key:"apply",value:function(e){var n=e.config,r=e.camera,i=e.renderingService,a=e.renderingContext,o=this.strategies;i.hooks.cull.tap(t.tag,function(t){if(t){var e,i=t.cullable;if(0===o.length?i.visible=a.unculledEntities.indexOf(t.entity)>-1:i.visible=o.every(function(e){return e.isVisible(r,t);}),!t.isCulled()&&t.isVisible())return t;var s=(null===(e=n.future)||void 0===e?void 0:e.experimentalCancelEventPropagation)===!0;return t.dispatchEvent(new rD(rV.CULLED),s,s),null;}return t;}),i.hooks.afterRender.tap(t.tag,function(t){t.cullable.visibilityPlaneMask=-1;});}}]);}().tag="Culling",function(){function t(){var e=this;(0,C.default)(this,t),this.autoPreventDefault=!1,this.rootPointerEvent=new rL(null),this.rootWheelEvent=new rI(null),this.onPointerMove=function(t){var n=null===(r=e.context.renderingContext.root)||void 0===r||null===(r=r.ownerDocument)||void 0===r?void 0:r.defaultView;if(!n.supportsTouchEvents||"touch"!==t.pointerType){var r,i,a=e.normalizeToPointerEvent(t,n),o=(0,W.default)(a);try{for(o.s();!(i=o.n()).done;){var s=i.value,l=e.bootstrapEvent(e.rootPointerEvent,s,n,t);e.context.eventService.mapEvent(l);}}catch(t){o.e(t);}finally{o.f();}e.setCursor(e.context.eventService.cursor);}},this.onClick=function(t){var n,r,i=null===(n=e.context.renderingContext.root)||void 0===n||null===(n=n.ownerDocument)||void 0===n?void 0:n.defaultView,a=e.normalizeToPointerEvent(t,i),o=(0,W.default)(a);try{for(o.s();!(r=o.n()).done;){var s=r.value,l=e.bootstrapEvent(e.rootPointerEvent,s,i,t);e.context.eventService.mapEvent(l);}}catch(t){o.e(t);}finally{o.f();}e.setCursor(e.context.eventService.cursor);};}return(0,R.default)(t,[{key:"apply",value:function(e){var n=this;this.context=e;var r=e.renderingService,i=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler(function(t){return n.context.renderingService.hooks.pickSync.call({position:t,picked:[],topmost:!0}).picked[0]||null;}),r.hooks.pointerWheel.tap(t.tag,function(t){var e=n.normalizeWheelEvent(t);n.context.eventService.mapEvent(e);}),r.hooks.pointerDown.tap(t.tag,function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){var e=n.normalizeToPointerEvent(t,i);n.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();var r,a=(0,W.default)(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=n.bootstrapEvent(n.rootPointerEvent,o,i,t);n.context.eventService.mapEvent(s);}}catch(t){a.e(t);}finally{a.f();}n.setCursor(n.context.eventService.cursor);}}),r.hooks.pointerUp.tap(t.tag,function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){var e,r=n.context.contextService.getDomElement(),a=n.context.eventService.isNativeEventFromCanvas(r,t)?"":"outside",o=n.normalizeToPointerEvent(t,i),s=(0,W.default)(o);try{for(s.s();!(e=s.n()).done;){var l=e.value,u=n.bootstrapEvent(n.rootPointerEvent,l,i,t);u.type+=a,n.context.eventService.mapEvent(u);}}catch(t){s.e(t);}finally{s.f();}n.setCursor(n.context.eventService.cursor);}}),r.hooks.pointerMove.tap(t.tag,this.onPointerMove),r.hooks.pointerOver.tap(t.tag,this.onPointerMove),r.hooks.pointerOut.tap(t.tag,this.onPointerMove),r.hooks.click.tap(t.tag,this.onClick),r.hooks.pointerCancel.tap(t.tag,function(t){var e,r=n.normalizeToPointerEvent(t,i),a=(0,W.default)(r);try{for(a.s();!(e=a.n()).done;){var o=e.value,s=n.bootstrapEvent(n.rootPointerEvent,o,i,t);n.context.eventService.mapEvent(s);}}catch(t){a.e(t);}finally{a.f();}n.setCursor(n.context.eventService.cursor);});}},{key:"bootstrapEvent",value:function(t,e,n,r){t.view=n,t.originalEvent=null,t.nativeEvent=r,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);var i=this.context.eventService.client2Viewport({x:e.clientX,y:e.clientY}),a=i.x,o=i.y;t.viewport.x=a,t.viewport.y=o;var s=this.context.eventService.viewport2Canvas(t.viewport),l=s.x,u=s.y;return t.canvas.x=l,t.canvas.y=u,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=r.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=nJ[t.type]||t.type),t;}},{key:"normalizeWheelEvent",value:function(t){var e=this.rootWheelEvent;this.transferMouseData(e,t),e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;var n=this.context.eventService.client2Viewport({x:t.clientX,y:t.clientY}),r=n.x,i=n.y;e.viewport.x=r,e.viewport.y=i;var a=this.context.eventService.viewport2Canvas(e.viewport),o=a.x,s=a.y;return e.canvas.x=o,e.canvas.y=s,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.nativeEvent=t,e.type=t.type,e;}},{key:"transferMouseData",value:function(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=n0.now(),t.type=e.type,t.altKey=e.altKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.ctrlKey=e.ctrlKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.screen.x=e.screenX,t.screen.y=e.screenY,t.relatedTarget=null;}},{key:"setCursor",value:function(t){this.context.contextService.applyCursorStyle(t||this.context.config.cursor||"default");}},{key:"normalizeToPointerEvent",value:function(t,e){var n=[];if(e.isTouchEvent(t))for(var r=0;r<t.changedTouches.length;r++){var i=t.changedTouches[r];(0,F.isUndefined)(i.button)&&(i.button=0),(0,F.isUndefined)(i.buttons)&&(i.buttons=1),(0,F.isUndefined)(i.isPrimary)&&(i.isPrimary=1===t.touches.length&&"touchstart"===t.type),(0,F.isUndefined)(i.width)&&(i.width=i.radiusX||1),(0,F.isUndefined)(i.height)&&(i.height=i.radiusY||1),(0,F.isUndefined)(i.tiltX)&&(i.tiltX=0),(0,F.isUndefined)(i.tiltY)&&(i.tiltY=0),(0,F.isUndefined)(i.pointerType)&&(i.pointerType="touch"),(0,F.isUndefined)(i.pointerId)&&(i.pointerId=i.identifier||0),(0,F.isUndefined)(i.pressure)&&(i.pressure=i.force||.5),(0,F.isUndefined)(i.twist)&&(i.twist=0),(0,F.isUndefined)(i.tangentialPressure)&&(i.tangentialPressure=0),i.isNormalized=!0,i.type=t.type,n.push(i);}else e.isMouseEvent(t)&&((0,F.isUndefined)(t.isPrimary)&&(t.isPrimary=!0),(0,F.isUndefined)(t.width)&&(t.width=1),(0,F.isUndefined)(t.height)&&(t.height=1),(0,F.isUndefined)(t.tiltX)&&(t.tiltX=0),(0,F.isUndefined)(t.tiltY)&&(t.tiltY=0),(0,F.isUndefined)(t.pointerType)&&(t.pointerType="mouse"),(0,F.isUndefined)(t.pointerId)&&(t.pointerId=1),(0,F.isUndefined)(t.pressure)&&(t.pressure=.5),(0,F.isUndefined)(t.twist)&&(t.twist=0),(0,F.isUndefined)(t.tangentialPressure)&&(t.tangentialPressure=0),t.isNormalized=!0),n.push(t);return n;}}]);}().tag="Event";var iF=[j.CIRCLE,j.ELLIPSE,j.IMAGE,j.RECT,j.LINE,j.POLYLINE,j.POLYGON,j.TEXT,j.PATH,j.HTML];(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"isVisible",value:function(t,e){var n,r=e.cullable;if(!r.enable)return!0;var i=e.getRenderBounds();if(tr.isEmpty(i))return!1;var a=t.getFrustum(),o=null===(n=e.parentNode)||void 0===n||null===(n=n.cullable)||void 0===n?void 0:n.visibilityPlaneMask;return r.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(e,i,o||ta.INDETERMINATE,a.planes),r.visible=r.visibilityPlaneMask!==ta.OUTSIDE,r.visible;}},{key:"computeVisibilityWithPlaneMask",value:function(t,e,n,r){if(n===ta.OUTSIDE||n===ta.INSIDE)return n;for(var i=ta.INSIDE,a=iF.indexOf(t.nodeName)>-1,o=0,s=r.length;o<s;++o){var l=1<<o;if((n&l)!=0&&(!a||4!==o&&5!==o)){var u=r[o],c=u.normal,h=u.distance;if(G.vec3.dot(c,e.getPositiveFarPoint(r[o]))+h<0)return ta.OUTSIDE;G.vec3.dot(c,e.getNegativeFarPoint(r[o]))+h<0&&(i|=l);}}return i;}}]),function(){function t(){(0,C.default)(this,t),this.mutationRecords=[],this.isFirstTimeRendering=!0,this.isFirstTimeRenderingFinished=!1;}return(0,R.default)(t,[{key:"apply",value:function(e){var n,r=this,i=e.renderingService,a=e.renderingContext.root.ownerDocument.defaultView,o=function(t){i.dirty();},s=function(t){var e,n=t.detail;(e=r.mutationRecords).push.apply(e,(0,O.default)(n)),i.dirty();},l=function(t){var e=t.target;ia.enableSizeAttenuation&&ia.styleValueRegistry.updateSizeAttenuation(e,a.getCamera().getZoom());},u=function(t){var e=t.target;ia.sceneGraphService.dirtyToRoot(e),i.dirty();};i.hooks.init.tap(t.tag,function(){a.addEventListener(rV.MOUNTED,l),a.addEventListener(rV.UNMOUNTED,u),a.addEventListener(rV.ATTR_MODIFIED,o),a.addEventListener(rV.BOUNDS_CHANGED,s);}),i.hooks.destroy.tap(t.tag,function(){a.removeEventListener(rV.MOUNTED,l),a.removeEventListener(rV.UNMOUNTED,u),a.removeEventListener(rV.ATTR_MODIFIED,o),a.removeEventListener(rV.BOUNDS_CHANGED,s),r.mutationRecords=[];});var c=null!==(n=ia.globalThis.requestIdleCallback)&&void 0!==n?n:re.bind(ia.globalThis);i.hooks.endFrame.tap(t.tag,function(){r.isFirstTimeRendering&&(r.isFirstTimeRendering=!1,c(function(){r.isFirstTimeRenderingFinished=!0;})),r.mutationRecords=[];});}}]);}().tag="Prepare";var iB=((P={}).READY="ready",P.BEFORE_RENDER="beforerender",P.RERENDER="rerender",P.AFTER_RENDER="afterrender",P.BEFORE_DESTROY="beforedestroy",P.AFTER_DESTROY="afterdestroy",P.RESIZE="resize",P.DIRTY_RECTANGLE="dirtyrectangle",P.RENDERER_CHANGED="rendererchanged",P);new rD(rV.MOUNTED),new rD(rV.UNMOUNTED),new rD(iB.BEFORE_RENDER),new rD(iB.RERENDER),new rD(iB.AFTER_RENDER);},"40fa2782":function(t,e,n){"use strict";n.d(e,"__esModule",{value:!0}),n.e(e,{AbstractRendererPlugin:function(){return K;},Shape:function(){return j;},isDisplayObject:function(){return ih;}});var r,i,a,o,s,l,u,c,h,d,f,v,p,g,y,m,k,E,x,T,N,b,S,w,P,M=n("777fffbe"),A=M._(n("ab297151")),C=M._(n("b1a4abb6")),R=M._(n("72ce8fb5")),O=M._(n("d60881d0")),L=M._(n("0b95a4d2")),I=M._(n("0afdccfb")),D=M._(n("7465ab36")),_=M._(n("32f41e1c")),G=n("597fa39f");n("f90e84e3");var F=n("abe9d8d6"),B=M._(n("3214ccb5")),U=M._(n("51ffafbb")),V=M._(n("3c7f532e")),z=n("b1a96927"),H=M._(n("2fabd5d4")),Y=M._(n("cb203630")),W=M._(n("1982f763")),q=M._(n("01aac514"));let X=n("1714eebe");var j=((r={}).GROUP="g",r.FRAGMENT="fragment",r.CIRCLE="circle",r.ELLIPSE="ellipse",r.IMAGE="image",r.RECT="rect",r.LINE="line",r.POLYLINE="polyline",r.POLYGON="polygon",r.TEXT="text",r.PATH="path",r.HTML="html",r.MESH="mesh",r),$=((i={})[i.ZERO=0]="ZERO",i[i.NEGATIVE_ONE=1]="NEGATIVE_ONE",i),K=(0,R.default)(function t(){(0,C.default)(this,t),this.plugins=[];},[{key:"addRenderingPlugin",value:function(t){this.plugins.push(t),this.context.renderingPlugins.push(t);}},{key:"removeAllRenderingPlugins",value:function(){var t=this;this.plugins.forEach(function(e){var n=t.context.renderingPlugins.indexOf(e);n>=0&&t.context.renderingPlugins.splice(n,1);});}}]),Z=G.vec3.add,Q=G.vec3.copy,J=G.vec3.max,tt=G.vec3.min,te=G.vec3.scale,tn=G.vec3.sub,tr=function(){function t(){(0,C.default)(this,t),this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0];}return(0,R.default)(t,[{key:"update",value:function(t,e){Q(this.center,t),Q(this.halfExtents,e),tn(this.min,this.center,this.halfExtents),Z(this.max,this.center,this.halfExtents);}},{key:"setMinMax",value:function(t,e){Z(this.center,e,t),te(this.center,this.center,.5),tn(this.halfExtents,e,t),te(this.halfExtents,this.halfExtents,.5),Q(this.min,t),Q(this.max,e);}},{key:"getMin",value:function(){return this.min;}},{key:"getMax",value:function(){return this.max;}},{key:"add",value:function(e){if(!t.isEmpty(e)){if(t.isEmpty(this)){this.setMinMax(e.getMin(),e.getMax());return;}var n=this.center,r=n[0],i=n[1],a=n[2],o=this.halfExtents,s=o[0],l=o[1],u=o[2],c=r-s,h=r+s,d=i-l,f=i+l,v=a-u,p=a+u,g=e.center,y=g[0],m=g[1],k=g[2],E=e.halfExtents,x=E[0],T=E[1],N=E[2],b=y-x,S=y+x,w=m-T,P=m+T,M=k-N,A=k+N;b<c&&(c=b),S>h&&(h=S),w<d&&(d=w),P>f&&(f=P),M<v&&(v=M),A>p&&(p=A),n[0]=(c+h)*.5,n[1]=(d+f)*.5,n[2]=(v+p)*.5,o[0]=(h-c)*.5,o[1]=(f-d)*.5,o[2]=(p-v)*.5,this.min[0]=c,this.min[1]=d,this.min[2]=v,this.max[0]=h,this.max[1]=f,this.max[2]=p;}}},{key:"setFromTransformedAABB",value:function(t,e){var n=this.center,r=this.halfExtents,i=t.center,a=t.halfExtents,o=e[0],s=e[4],l=e[8],u=e[1],c=e[5],h=e[9],d=e[2],f=e[6],v=e[10],p=Math.abs(o),g=Math.abs(s),y=Math.abs(l),m=Math.abs(u),k=Math.abs(c),E=Math.abs(h),x=Math.abs(d),T=Math.abs(f),N=Math.abs(v);n[0]=e[12]+o*i[0]+s*i[1]+l*i[2],n[1]=e[13]+u*i[0]+c*i[1]+h*i[2],n[2]=e[14]+d*i[0]+f*i[1]+v*i[2],r[0]=p*a[0]+g*a[1]+y*a[2],r[1]=m*a[0]+k*a[1]+E*a[2],r[2]=x*a[0]+T*a[1]+N*a[2],tn(this.min,n,r),Z(this.max,n,r);}},{key:"intersects",value:function(t){var e=this.getMax(),n=this.getMin(),r=t.getMax(),i=t.getMin();return n[0]<=r[0]&&e[0]>=i[0]&&n[1]<=r[1]&&e[1]>=i[1]&&n[2]<=r[2]&&e[2]>=i[2];}},{key:"intersection",value:function(e){if(!this.intersects(e))return null;var n=new t,r=J([0,0,0],this.getMin(),e.getMin()),i=tt([0,0,0],this.getMax(),e.getMax());return n.setMinMax(r,i),n;}},{key:"getNegativeFarPoint",value:function(t){return 273===t.pnVertexFlag?Q([0,0,0],this.min):272===t.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:257===t.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:256===t.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:17===t.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:16===t.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:1===t.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]];}},{key:"getPositiveFarPoint",value:function(t){return 273===t.pnVertexFlag?Q([0,0,0],this.max):272===t.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:257===t.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:256===t.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:17===t.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:16===t.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:1===t.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]];}}],[{key:"isEmpty",value:function(t){return!t||0===t.halfExtents[0]&&0===t.halfExtents[1]&&0===t.halfExtents[2];}}]);}(),ti=(0,R.default)(function t(e,n){(0,C.default)(this,t),this.distance=e||0,this.normal=n||G.vec3.fromValues(0,1,0),this.updatePNVertexFlag();},[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(Number(this.normal[0]>=0)<<8)+(Number(this.normal[1]>=0)<<4)+Number(this.normal[2]>=0);}},{key:"distanceToPoint",value:function(t){return G.vec3.dot(t,this.normal)-this.distance;}},{key:"normalize",value:function(){var t=1/G.vec3.len(this.normal);G.vec3.scale(this.normal,this.normal,t),this.distance*=t;}},{key:"intersectsLine",value:function(t,e,n){var r=this.distanceToPoint(t),i=r/(r-this.distanceToPoint(e)),a=i>=0&&i<=1;return a&&n&&G.vec3.lerp(n,t,e,i),a;}}]),ta=((a={})[a.OUTSIDE=4294967295]="OUTSIDE",a[a.INSIDE=0]="INSIDE",a[a.INDETERMINATE=2147483647]="INDETERMINATE",a),to=(0,R.default)(function t(e){if((0,C.default)(this,t),this.planes=[],e)this.planes=e;else for(var n=0;n<6;n++)this.planes.push(new ti);},[{key:"extractFromVPMatrix",value:function(t){var e=(0,D.default)(t,16),n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],v=e[12],p=e[13],g=e[14],y=e[15];G.vec3.set(this.planes[0].normal,a-n,u-o,f-c),this.planes[0].distance=y-v,G.vec3.set(this.planes[1].normal,a+n,u+o,f+c),this.planes[1].distance=y+v,G.vec3.set(this.planes[2].normal,a+r,u+s,f+h),this.planes[2].distance=y+p,G.vec3.set(this.planes[3].normal,a-r,u-s,f-h),this.planes[3].distance=y-p,G.vec3.set(this.planes[4].normal,a-i,u-l,f-d),this.planes[4].distance=y-g,G.vec3.set(this.planes[5].normal,a+i,u+l,f+d),this.planes[5].distance=y+g,this.planes.forEach(function(t){t.normalize(),t.updatePNVertexFlag();});}}]),ts=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,C.default)(this,t),this.x=0,this.y=0,this.x=e,this.y=n;}return(0,R.default)(t,[{key:"clone",value:function(){return new t(this.x,this.y);}},{key:"copyFrom",value:function(t){this.x=t.x,this.y=t.y;}}]);}(),tl=function(){function t(e,n,r,i){(0,C.default)(this,t),this.x=e,this.y=n,this.width=r,this.height=i,this.left=e,this.right=e+r,this.top=n,this.bottom=n+i;}return(0,R.default)(t,[{key:"toJSON",value:function(){}}],[{key:"fromRect",value:function(e){return new t(e.x,e.y,e.width,e.height);}},{key:"applyTransform",value:function(e,n){var r=G.vec4.fromValues(e.x,e.y,0,1),i=G.vec4.fromValues(e.x+e.width,e.y,0,1),a=G.vec4.fromValues(e.x,e.y+e.height,0,1),o=G.vec4.fromValues(e.x+e.width,e.y+e.height,0,1),s=G.vec4.create(),l=G.vec4.create(),u=G.vec4.create(),c=G.vec4.create();G.vec4.transformMat4(s,r,n),G.vec4.transformMat4(l,i,n),G.vec4.transformMat4(u,a,n),G.vec4.transformMat4(c,o,n);var h=Math.min(s[0],l[0],u[0],c[0]),d=Math.min(s[1],l[1],u[1],c[1]),f=Math.max(s[0],l[0],u[0],c[0]),v=Math.max(s[1],l[1],u[1],c[1]);return t.fromRect({x:h,y:d,width:f-h,height:v-d});}}]);}(),tu="Method not implemented.";function tc(t){return void 0===t?0:t>360||t<-360?t%360:t;}var th=G.vec3.create();function td(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];return Array.isArray(t)&&3===t.length?r?G.vec3.clone(t):G.vec3.copy(th,t):(0,F.isNumber)(t)?r?G.vec3.fromValues(t,e,n):G.vec3.set(th,t,e,n):r?G.vec3.fromValues(t[0],t[1]||e,t[2]||n):G.vec3.set(th,t[0],t[1]||e,t[2]||n);}var tf=Math.PI/180,tv=180/Math.PI,tp=Math.PI/2;function tg(t,e){var n,r,i,a,o,s,l,u,c,h,d,f,v,p,g,y,m;return 16===e.length?(i=G.mat4.getScaling(G.vec3.create(),e),o=(a=(0,D.default)(i,3))[0],s=a[1],l=a[2],(u=Math.asin(-e[2]/o))<tp?u>-tp?(n=Math.atan2(e[6]/s,e[10]/l),r=Math.atan2(e[1]/o,e[0]/o)):(r=0,n=-Math.atan2(e[4]/s,e[5]/s)):(r=0,n=Math.atan2(e[4]/s,e[5]/s)),t[0]=n,t[1]=u,t[2]=r):(c=e[0],h=e[1],d=e[2],f=e[3],y=c*c+(v=h*h)+(p=d*d)+(g=f*f),(m=c*f-h*d)>.499995*y?(t[0]=tp,t[1]=2*Math.atan2(h,c),t[2]=0):m<-.499995*y?(t[0]=-tp,t[1]=2*Math.atan2(h,c),t[2]=0):(t[0]=Math.asin(2*(c*d-f*h)),t[1]=Math.atan2(2*(c*f+h*d),1-2*(p+g)),t[2]=Math.atan2(2*(c*h+d*f),1-2*(v+p)))),t;}function ty(t){var e=t[0],n=t[1],r=t[3],i=t[4],a=Math.sqrt(e*e+n*n),o=Math.sqrt(r*r+i*i);if(e*i-n*r<0&&(e<i?a=-a:o=-o),a){var s=1/a;e*=s,n*=s;}if(o){var l=1/o;r*=l,i*=l;}var u=Math.atan2(n,e)*tv;return[t[6],t[7],a,o,u];}var tm=G.mat4.create(),tk=G.mat4.create(),tE=G.vec4.create(),tx=[G.vec3.create(),G.vec3.create(),G.vec3.create()],tT=G.vec3.create();function tN(t,e,n,r,i){t[0]=e[0]*r+n[0]*i,t[1]=e[1]*r+n[1]*i,t[2]=e[2]*r+n[2]*i;}var tb=((o={})[o.ORBITING=0]="ORBITING",o[o.EXPLORING=1]="EXPLORING",o[o.TRACKING=2]="TRACKING",o),tS=((s={})[s.DEFAULT=0]="DEFAULT",s[s.ROTATIONAL=1]="ROTATIONAL",s[s.TRANSLATIONAL=2]="TRANSLATIONAL",s[s.CINEMATIC=3]="CINEMATIC",s),tw=((l={})[l.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",l[l.PERSPECTIVE=1]="PERSPECTIVE",l),tP={UPDATED:"updated"},tM=(0,R.default)(function t(){(0,C.default)(this,t),this.clipSpaceNearZ=$.NEGATIVE_ONE,this.eventEmitter=new _.default,this.matrix=G.mat4.create(),this.right=G.vec3.fromValues(1,0,0),this.up=G.vec3.fromValues(0,1,0),this.forward=G.vec3.fromValues(0,0,1),this.position=G.vec3.fromValues(0,0,1),this.focalPoint=G.vec3.fromValues(0,0,0),this.distanceVector=G.vec3.fromValues(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=G.mat4.create(),this.projectionMatrixInverse=G.mat4.create(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=tb.EXPLORING,this.trackingMode=tS.DEFAULT,this.projectionMode=tw.PERSPECTIVE,this.frustum=new to,this.orthoMatrix=G.mat4.create();},[{key:"isOrtho",value:function(){return this.projectionMode===tw.ORTHOGRAPHIC;}},{key:"getProjectionMode",value:function(){return this.projectionMode;}},{key:"getPerspective",value:function(){return this.jitteredProjectionMatrix||this.projectionMatrix;}},{key:"getPerspectiveInverse",value:function(){return this.projectionMatrixInverse;}},{key:"getFrustum",value:function(){return this.frustum;}},{key:"getPosition",value:function(){return this.position;}},{key:"getFocalPoint",value:function(){return this.focalPoint;}},{key:"getDollyingStep",value:function(){return this.dollyingStep;}},{key:"getNear",value:function(){return this.near;}},{key:"getFar",value:function(){return this.far;}},{key:"getZoom",value:function(){return this.zoom;}},{key:"getOrthoMatrix",value:function(){return this.orthoMatrix;}},{key:"getView",value:function(){return this.view;}},{key:"setEnableUpdate",value:function(t){this.enableUpdate=t;}},{key:"setType",value:function(t,e){return this.type=t,this.type===tb.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===tb.TRACKING&&void 0!==e&&this.setTrackingMode(e),this;}},{key:"setProjectionMode",value:function(t){return this.projectionMode=t,this;}},{key:"setTrackingMode",value:function(t){if(this.type!==tb.TRACKING)throw Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=t,this;}},{key:"setWorldRotation",value:function(t){return this.rotateWorld=t,this._getAngles(),this;}},{key:"getViewTransform",value:function(){return G.mat4.invert(G.mat4.create(),this.matrix);}},{key:"getWorldTransform",value:function(){return this.matrix;}},{key:"jitterProjectionMatrix",value:function(t,e){var n=G.mat4.fromTranslation(G.mat4.create(),[t,e,0]);this.jitteredProjectionMatrix=G.mat4.multiply(G.mat4.create(),n,this.projectionMatrix);}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0;}},{key:"setMatrix",value:function(t){return this.matrix=t,this._update(),this;}},{key:"setProjectionMatrix",value:function(t){this.projectionMatrix=t;}},{key:"setFov",value:function(t){return this.setPerspective(this.near,this.far,t,this.aspect),this;}},{key:"setAspect",value:function(t){return this.setPerspective(this.near,this.far,this.fov,t),this;}},{key:"setNear",value:function(t){return this.projectionMode===tw.PERSPECTIVE?this.setPerspective(t,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,t,this.far),this;}},{key:"setFar",value:function(t){return this.projectionMode===tw.PERSPECTIVE?this.setPerspective(this.near,t,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,t),this;}},{key:"setViewOffset",value:function(t,e,n,r,i,a){return this.aspect=t/e,void 0===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.projectionMode===tw.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this;}},{key:"clearViewOffset",value:function(){return void 0!==this.view&&(this.view.enabled=!1),this.projectionMode===tw.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this;}},{key:"setZoom",value:function(t){return this.zoom=t,this.projectionMode===tw.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===tw.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this;}},{key:"setZoomByViewportPoint",value:function(t,e){var n=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),r=n.x,i=n.y,a=this.roll;this.rotate(0,0,-a),this.setPosition(r,i),this.setFocalPoint(r,i),this.setZoom(t),this.rotate(0,0,a);var o=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),s=o.x,l=o.y,u=G.vec3.fromValues(s-r,l-i,0),c=G.vec3.dot(u,this.right)/G.vec3.length(this.right),h=G.vec3.dot(u,this.up)/G.vec3.length(this.up),d=this.getPosition(),f=(0,D.default)(d,2),v=f[0],p=f[1],g=this.getFocalPoint(),y=(0,D.default)(g,2),m=y[0],k=y[1];return this.setPosition(v-c,p-h),this.setFocalPoint(m-c,k-h),this;}},{key:"setPerspective",value:function(t,e,n,r){this.projectionMode=tw.PERSPECTIVE,this.fov=n,this.near=t,this.far=e,this.aspect=r;var i,a=this.near*Math.tan(.5*this.fov*tf)/this.zoom,o=2*a,s=this.aspect*o,l=-.5*s;if(null!==(i=this.view)&&void 0!==i&&i.enabled){var u=this.view.fullWidth,c=this.view.fullHeight;l+=this.view.offsetX*s/u,a-=this.view.offsetY*o/c,s*=this.view.width/u,o*=this.view.height/c;}return!function(t,e,n,r,i,a,o){var s,l,u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=2*a,h=n-e,d=r-i,f=o-a,v=o*a;u?(s=-o/f,l=-v/f):(s=-(o+a)/f,l=-2*v/f),t[0]=c/h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c/d,t[6]=0,t[7]=0,t[8]=(n+e)/h,t[9]=(r+i)/d,t[10]=s,t[11]=-1,t[12]=0,t[13]=0,t[14]=l,t[15]=0;}(this.projectionMatrix,l,l+s,a-o,a,t,this.far,this.clipSpaceNearZ===$.ZERO),G.mat4.invert(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this;}},{key:"setOrthographic",value:function(t,e,n,r,i,a){this.projectionMode=tw.ORTHOGRAPHIC,this.rright=e,this.left=t,this.top=n,this.bottom=r,this.near=i,this.far=a;var o,s=(this.rright-this.left)/(2*this.zoom),l=(this.top-this.bottom)/(2*this.zoom),u=(this.rright+this.left)/2,c=(this.top+this.bottom)/2,h=u-s,d=u+s,f=c+l,v=c-l;if(null!==(o=this.view)&&void 0!==o&&o.enabled){var p=(this.rright-this.left)/this.view.fullWidth/this.zoom,g=(this.top-this.bottom)/this.view.fullHeight/this.zoom;h+=p*this.view.offsetX,d=h+p*this.view.width,f-=g*this.view.offsetY,v=f-g*this.view.height;}return this.clipSpaceNearZ===$.NEGATIVE_ONE?G.mat4.ortho(this.projectionMatrix,h,d,f,v,i,a):G.mat4.orthoZO(this.projectionMatrix,h,d,f,v,i,a),G.mat4.invert(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this;}},{key:"setPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.position[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.position[2],r=td(t,e,n);return this._setPosition(r),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this;}},{key:"setFocalPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.focalPoint[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.focalPoint[2],r=G.vec3.fromValues(0,1,0);if(this.focalPoint=td(t,e,n),this.trackingMode===tS.CINEMATIC){var i=G.vec3.subtract(G.vec3.create(),this.focalPoint,this.position);t=i[0],e=i[1],n=i[2];var a=Math.asin(e/G.vec3.length(i))*tv,o=90+Math.atan2(n,t)*tv,s=G.mat4.create();G.mat4.rotateY(s,s,o*tf),G.mat4.rotateX(s,s,a*tf),r=G.vec3.transformMat4(G.vec3.create(),[0,1,0],s);}return G.mat4.invert(this.matrix,G.mat4.lookAt(G.mat4.create(),this.position,this.focalPoint,r)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this;}},{key:"getDistance",value:function(){return this.distance;}},{key:"getDistanceVector",value:function(){return this.distanceVector;}},{key:"setDistance",value:function(t){if(this.distance===t||t<0)return this;this.distance=t,this.distance<2e-4&&(this.distance=2e-4),this.dollyingStep=this.distance/100;var e=G.vec3.create();t=this.distance;var n=this.forward,r=this.focalPoint;return e[0]=t*n[0]+r[0],e[1]=t*n[1]+r[1],e[2]=t*n[2]+r[2],this._setPosition(e),this.triggerUpdate(),this;}},{key:"setMaxDistance",value:function(t){return this.maxDistance=t,this;}},{key:"setMinDistance",value:function(t){return this.minDistance=t,this;}},{key:"setAzimuth",value:function(t){return this.azimuth=tc(t),this.computeMatrix(),this._getAxes(),this.type===tb.ORBITING||this.type===tb.EXPLORING?this._getPosition():this.type===tb.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getAzimuth",value:function(){return this.azimuth;}},{key:"setElevation",value:function(t){return this.elevation=tc(t),this.computeMatrix(),this._getAxes(),this.type===tb.ORBITING||this.type===tb.EXPLORING?this._getPosition():this.type===tb.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getElevation",value:function(){return this.elevation;}},{key:"setRoll",value:function(t){return this.roll=tc(t),this.computeMatrix(),this._getAxes(),this.type===tb.ORBITING||this.type===tb.EXPLORING?this._getPosition():this.type===tb.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getRoll",value:function(){return this.roll;}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate();}},{key:"computeMatrix",value:function(){var t=G.quat.setAxisAngle(G.quat.create(),[0,0,1],this.roll*tf);G.mat4.identity(this.matrix);var e=G.quat.setAxisAngle(G.quat.create(),[1,0,0],(this.rotateWorld&&this.type!==tb.TRACKING||this.type===tb.TRACKING?1:-1)*this.elevation*tf),n=G.quat.setAxisAngle(G.quat.create(),[0,1,0],(this.rotateWorld&&this.type!==tb.TRACKING||this.type===tb.TRACKING?1:-1)*this.azimuth*tf),r=G.quat.multiply(G.quat.create(),n,e);r=G.quat.multiply(G.quat.create(),r,t);var i=G.mat4.fromQuat(G.mat4.create(),r);this.type===tb.ORBITING||this.type===tb.EXPLORING?(G.mat4.translate(this.matrix,this.matrix,this.focalPoint),G.mat4.multiply(this.matrix,this.matrix,i),G.mat4.translate(this.matrix,this.matrix,[0,0,this.distance])):this.type===tb.TRACKING&&(G.mat4.translate(this.matrix,this.matrix,this.position),G.mat4.multiply(this.matrix,this.matrix,i));}},{key:"_setPosition",value:function(t,e,n){this.position=td(t,e,n);var r=this.matrix;r[12]=this.position[0],r[13]=this.position[1],r[14]=this.position[2],r[15]=1,this._getOrthoMatrix();}},{key:"_getAxes",value:function(){G.vec3.copy(this.right,td(G.vec4.transformMat4(G.vec4.create(),[1,0,0,0],this.matrix))),G.vec3.copy(this.up,td(G.vec4.transformMat4(G.vec4.create(),[0,1,0,0],this.matrix))),G.vec3.copy(this.forward,td(G.vec4.transformMat4(G.vec4.create(),[0,0,1,0],this.matrix))),G.vec3.normalize(this.right,this.right),G.vec3.normalize(this.up,this.up),G.vec3.normalize(this.forward,this.forward);}},{key:"_getAngles",value:function(){var t=this.distanceVector[0],e=this.distanceVector[1],n=this.distanceVector[2],r=G.vec3.length(this.distanceVector);if(0===r){this.elevation=0,this.azimuth=0;return;}this.type===tb.TRACKING?(this.elevation=Math.asin(e/r)*tv,this.azimuth=Math.atan2(-t,-n)*tv):this.rotateWorld?(this.elevation=Math.asin(e/r)*tv,this.azimuth=Math.atan2(-t,-n)*tv):(this.elevation=-(Math.asin(e/r)*tv),this.azimuth=-(Math.atan2(-t,-n)*tv));}},{key:"_getPosition",value:function(){G.vec3.copy(this.position,td(G.vec4.transformMat4(G.vec4.create(),[0,0,0,1],this.matrix))),this._getDistance();}},{key:"_getFocalPoint",value:function(){G.vec3.transformMat3(this.distanceVector,[0,0,-this.distance],G.mat3.fromMat4(G.mat3.create(),this.matrix)),G.vec3.add(this.focalPoint,this.position,this.distanceVector),this._getDistance();}},{key:"_getDistance",value:function(){this.distanceVector=G.vec3.subtract(G.vec3.create(),this.focalPoint,this.position),this.distance=G.vec3.length(this.distanceVector),this.dollyingStep=this.distance/100;}},{key:"_getOrthoMatrix",value:function(){if(this.projectionMode===tw.ORTHOGRAPHIC){var t=this.position,e=G.quat.setAxisAngle(G.quat.create(),[0,0,1],-this.roll*Math.PI/180);G.mat4.fromRotationTranslationScaleOrigin(this.orthoMatrix,e,G.vec3.fromValues((this.rright-this.left)/2-t[0],(this.top-this.bottom)/2-t[1],0),G.vec3.fromValues(this.zoom,this.zoom,1),t);}}},{key:"triggerUpdate",value:function(){if(this.enableUpdate){var t=this.getViewTransform(),e=G.mat4.multiply(G.mat4.create(),this.getPerspective(),t);this.getFrustum().extractFromVPMatrix(e),this.eventEmitter.emit(tP.UPDATED);}}},{key:"rotate",value:function(t,e,n){throw Error(tu);}},{key:"pan",value:function(t,e){throw Error(tu);}},{key:"dolly",value:function(t){throw Error(tu);}},{key:"createLandmark",value:function(t,e){throw Error(tu);}},{key:"gotoLandmark",value:function(t,e){throw Error(tu);}},{key:"cancelLandmarkAnimation",value:function(){throw Error(tu);}}]),tA=((u={})[u.Standard=0]="Standard",u),tC=((c={})[c.ADDED=0]="ADDED",c[c.REMOVED=1]="REMOVED",c[c.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED",c),tR=G.vec3.create(),tO=G.mat4.create(),tL=G.quat.create();function tI(t){if(t.localDirtyFlag){if(0!==t.localSkew[0]||0!==t.localSkew[1]){G.mat4.fromRotationTranslationScaleOrigin(t.localTransform,t.localRotation,t.localPosition,G.vec3.fromValues(1,1,1),t.origin),(0!==t.localSkew[0]||0!==t.localSkew[1])&&(G.mat4.identity(tO),tO[4]=Math.tan(t.localSkew[0]),tO[1]=Math.tan(t.localSkew[1]),G.mat4.multiply(t.localTransform,t.localTransform,tO));var e=G.mat4.fromRotationTranslationScaleOrigin(tO,G.quat.set(tL,0,0,0,1),G.vec3.set(tR,1,1,1),t.localScale,t.origin);G.mat4.multiply(t.localTransform,t.localTransform,e);}else{var n=t.localTransform,r=t.localPosition,i=t.localRotation,a=t.localScale,o=t.origin,s=0!==r[0]||0!==r[1]||0!==r[2],l=1!==i[3]||0!==i[0]||0!==i[1]||0!==i[2],u=1!==a[0]||1!==a[1]||1!==a[2],c=0!==o[0]||0!==o[1]||0!==o[2];l||u||c?G.mat4.fromRotationTranslationScaleOrigin(n,i,r,a,o):s?G.mat4.fromTranslation(n,r):G.mat4.identity(n);}t.localDirtyFlag=!1;}}var tD={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new tl(0,0,0,0)},t_=((h={}).COORDINATE="<coordinate>",h.COLOR="<color>",h.PAINT="<paint>",h.NUMBER="<number>",h.ANGLE="<angle>",h.OPACITY_VALUE="<opacity-value>",h.SHADOW_BLUR="<shadow-blur>",h.LENGTH="<length>",h.PERCENTAGE="<percentage>",h.LENGTH_PERCENTAGE="<length> | <percentage>",h.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",h.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",h.LIST_OF_POINTS="<list-of-points>",h.PATH="<path>",h.FILTER="<filter>",h.Z_INDEX="<z-index>",h.OFFSET_DISTANCE="<offset-distance>",h.DEFINED_PATH="<defined-path>",h.MARKER="<marker>",h.TRANSFORM="<transform>",h.TRANSFORM_ORIGIN="<transform-origin>",h.TEXT="<text>",h.TEXT_TRANSFORM="<text-transform>",h);function tG(t,e,n){t.prototype=e.prototype=n,n.constructor=t;}function tF(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n;}function tB(){}var tU="\\s*([+-]?\\d+)\\s*",tV="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",tz="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",tH=/^#([0-9a-f]{3,8})$/,tY=RegExp(`^rgb\\(${tU},${tU},${tU}\\)$`),tW=RegExp(`^rgb\\(${tz},${tz},${tz}\\)$`),tq=RegExp(`^rgba\\(${tU},${tU},${tU},${tV}\\)$`),tX=RegExp(`^rgba\\(${tz},${tz},${tz},${tV}\\)$`),tj=RegExp(`^hsl\\(${tV},${tz},${tz}\\)$`),t$=RegExp(`^hsla\\(${tV},${tz},${tz},${tV}\\)$`),tK={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function tZ(){return this.rgb().formatHex();}function tQ(){return this.rgb().formatRgb();}function tJ(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=tH.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?t0(e):3===n?new t2(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?t1(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?t1(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=tY.exec(t))?new t2(e[1],e[2],e[3],1):(e=tW.exec(t))?new t2(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=tq.exec(t))?t1(e[1],e[2],e[3],e[4]):(e=tX.exec(t))?t1(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=tj.exec(t))?t9(e[1],e[2]/100,e[3]/100,1):(e=t$.exec(t))?t9(e[1],e[2]/100,e[3]/100,e[4]):tK.hasOwnProperty(t)?t0(tK[t]):"transparent"===t?new t2(NaN,NaN,NaN,0):null;}function t0(t){return new t2(t>>16&255,t>>8&255,255&t,1);}function t1(t,e,n,r){return r<=0&&(t=e=n=NaN),new t2(t,e,n,r);}function t2(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r;}function t3(){return`#${t7(this.r)}${t7(this.g)}${t7(this.b)}`;}function t4(){let t=t5(this.opacity);return`${1===t?"rgb(":"rgba("}${t6(this.r)}, ${t6(this.g)}, ${t6(this.b)}${1===t?")":`, ${t})`}`;}function t5(t){return isNaN(t)?1:Math.max(0,Math.min(1,t));}function t6(t){return Math.max(0,Math.min(255,Math.round(t)||0));}function t7(t){return((t=t6(t))<16?"0":"")+t.toString(16);}function t9(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new et(t,e,n,r);}function t8(t){if(t instanceof et)return new et(t.h,t.s,t.l,t.opacity);if(t instanceof tB||(t=tJ(t)),!t)return new et;if(t instanceof et)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,l=(a+i)/2;return s?(o=e===a?(n-r)/s+(n<r)*6:n===a?(r-e)/s+2:(e-n)/s+4,s/=l<.5?a+i:2-a-i,o*=60):s=l>0&&l<1?0:o,new et(o,s,l,t.opacity);}function et(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r;}function ee(t){return(t=(t||0)%360)<0?t+360:t;}function en(t){return Math.max(0,Math.min(1,t||0));}function er(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255;}function ei(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw TypeError("Expected a function");var n=function(){for(var r=arguments.length,i=Array(r),a=0;a<r;a++)i[a]=arguments[a];var o=e?e.apply(this,i):i[0],s=n.cache;if(s.has(o))return s.get(o);var l=t.apply(this,i);return n.cache=s.set(o,l)||s,l;};return n.cache=new(ei.Cache||Map),ei.cacheList.push(n.cache),n;}tG(tB,tJ,{copy(t){return Object.assign(new this.constructor,this,t);},displayable(){return this.rgb().displayable();},hex:tZ,formatHex:tZ,formatHex8:function(){return this.rgb().formatHex8();},formatHsl:function(){return t8(this).formatHsl();},formatRgb:tQ,toString:tQ}),tG(t2,function(t,e,n,r){var i;return 1==arguments.length?((i=t)instanceof tB||(i=tJ(i)),i)?new t2((i=i.rgb()).r,i.g,i.b,i.opacity):new t2:new t2(t,e,n,null==r?1:r);},tF(tB,{brighter(t){return t=null==t?1.4285714285714286:Math.pow(1.4285714285714286,t),new t2(this.r*t,this.g*t,this.b*t,this.opacity);},darker(t){return t=null==t?.7:Math.pow(.7,t),new t2(this.r*t,this.g*t,this.b*t,this.opacity);},rgb(){return this;},clamp(){return new t2(t6(this.r),t6(this.g),t6(this.b),t5(this.opacity));},displayable(){return -.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1;},hex:t3,formatHex:t3,formatHex8:function(){return`#${t7(this.r)}${t7(this.g)}${t7(this.b)}${t7((isNaN(this.opacity)?1:this.opacity)*255)}`;},formatRgb:t4,toString:t4})),tG(et,function(t,e,n,r){return 1==arguments.length?t8(t):new et(t,e,n,null==r?1:r);},tF(tB,{brighter(t){return t=null==t?1.4285714285714286:Math.pow(1.4285714285714286,t),new et(this.h,this.s,this.l*t,this.opacity);},darker(t){return t=null==t?.7:Math.pow(.7,t),new et(this.h,this.s,this.l*t,this.opacity);},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new t2(er(t>=240?t-240:t+120,i,r),er(t,i,r),er(t<120?t+240:t-120,i,r),this.opacity);},clamp(){return new et(ee(this.h),en(this.s),en(this.l),t5(this.opacity));},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1;},formatHsl(){let t=t5(this.opacity);return`${1===t?"hsl(":"hsla("}${ee(this.h)}, ${100*en(this.s)}%, ${100*en(this.l)}%${1===t?")":`, ${t})`}`;}})),ei.Cache=Map,ei.cacheList=[],ei.clearCache=function(){ei.cacheList.forEach(function(t){return t.clear();});};var ea=((d={})[d.kUnknown=0]="kUnknown",d[d.kNumber=1]="kNumber",d[d.kPercentage=2]="kPercentage",d[d.kEms=3]="kEms",d[d.kPixels=4]="kPixels",d[d.kRems=5]="kRems",d[d.kDegrees=6]="kDegrees",d[d.kRadians=7]="kRadians",d[d.kGradians=8]="kGradians",d[d.kTurns=9]="kTurns",d[d.kMilliseconds=10]="kMilliseconds",d[d.kSeconds=11]="kSeconds",d[d.kInteger=12]="kInteger",d),eo=((f={})[f.kUNumber=0]="kUNumber",f[f.kUPercent=1]="kUPercent",f[f.kULength=2]="kULength",f[f.kUAngle=3]="kUAngle",f[f.kUTime=4]="kUTime",f[f.kUOther=5]="kUOther",f),es=((v={})[v.kYes=0]="kYes",v[v.kNo=1]="kNo",v),el=((p={})[p.kYes=0]="kYes",p[p.kNo=1]="kNo",p),eu=[{name:"em",unit_type:ea.kEms},{name:"px",unit_type:ea.kPixels},{name:"deg",unit_type:ea.kDegrees},{name:"rad",unit_type:ea.kRadians},{name:"grad",unit_type:ea.kGradians},{name:"ms",unit_type:ea.kMilliseconds},{name:"s",unit_type:ea.kSeconds},{name:"rem",unit_type:ea.kRems},{name:"turn",unit_type:ea.kTurns}],ec=((g={})[g.kUnknownType=0]="kUnknownType",g[g.kUnparsedType=1]="kUnparsedType",g[g.kKeywordType=2]="kKeywordType",g[g.kUnitType=3]="kUnitType",g[g.kSumType=4]="kSumType",g[g.kProductType=5]="kProductType",g[g.kNegateType=6]="kNegateType",g[g.kInvertType=7]="kInvertType",g[g.kMinType=8]="kMinType",g[g.kMaxType=9]="kMaxType",g[g.kClampType=10]="kClampType",g[g.kTransformType=11]="kTransformType",g[g.kPositionType=12]="kPositionType",g[g.kURLImageType=13]="kURLImageType",g[g.kColorType=14]="kColorType",g[g.kUnsupportedColorType=15]="kUnsupportedColorType",g),eh=function(t){switch(t){case ea.kNumber:case ea.kInteger:return eo.kUNumber;case ea.kPercentage:return eo.kUPercent;case ea.kPixels:return eo.kULength;case ea.kMilliseconds:case ea.kSeconds:return eo.kUTime;case ea.kDegrees:case ea.kRadians:case ea.kGradians:case ea.kTurns:return eo.kUAngle;default:return eo.kUOther;}},ed=function(t){switch(t){case eo.kUNumber:return ea.kNumber;case eo.kULength:return ea.kPixels;case eo.kUPercent:return ea.kPercentage;case eo.kUTime:return ea.kSeconds;case eo.kUAngle:return ea.kDegrees;default:return ea.kUnknown;}},ef=function(t){var e=1;switch(t){case ea.kPixels:case ea.kDegrees:case ea.kSeconds:break;case ea.kMilliseconds:e=.001;break;case ea.kRadians:e=180/Math.PI;break;case ea.kGradians:e=.9;break;case ea.kTurns:e=360;}return e;},ev=function(t){switch(t){case ea.kNumber:case ea.kInteger:break;case ea.kPercentage:return"%";case ea.kEms:return"em";case ea.kRems:return"rem";case ea.kPixels:return"px";case ea.kDegrees:return"deg";case ea.kRadians:return"rad";case ea.kGradians:return"grad";case ea.kMilliseconds:return"ms";case ea.kSeconds:return"s";case ea.kTurns:return"turn";}return"";},ep=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"toString",value:function(){return this.buildCSSText(es.kNo,el.kNo,"");}},{key:"isNumericValue",value:function(){return this.getType()>=ec.kUnitType&&this.getType()<=ec.kClampType;}}],[{key:"isAngle",value:function(t){return t===ea.kDegrees||t===ea.kRadians||t===ea.kGradians||t===ea.kTurns;}},{key:"isLength",value:function(t){return t>=ea.kEms&&t<ea.kDegrees;}},{key:"isRelativeUnit",value:function(t){return t===ea.kPercentage||t===ea.kEms||t===ea.kRems;}},{key:"isTime",value:function(t){return t===ea.kSeconds||t===ea.kMilliseconds;}}]),eg=function(t){function e(t){var n;return(0,C.default)(this,e),(n=(0,L.default)(this,e)).colorSpace=t,n;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getType",value:function(){return ec.kColorType;}},{key:"to",value:function(t){return this;}}]);}(ep),ey=((y={})[y.Constant=0]="Constant",y[y.LinearGradient=1]="LinearGradient",y[y.RadialGradient=2]="RadialGradient",y),em=function(t){function e(t,n){var r;return(0,C.default)(this,e),(r=(0,L.default)(this,e)).type=t,r.value=n,r;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return new e(this.type,this.value);}},{key:"buildCSSText",value:function(t,e,n){return n;}},{key:"getType",value:function(){return ec.kColorType;}}]);}(ep),ek=function(t){function e(t){var n;return(0,C.default)(this,e),(n=(0,L.default)(this,e)).value=t,n;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return new e(this.value);}},{key:"getType",value:function(){return ec.kKeywordType;}},{key:"buildCSSText",value:function(t,e,n){return n+this.value;}}]);}(ep),eE=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(Number.isFinite(t)?"NaN":t>0?"infinity":"-infinity")+e;},ex=function(t){return ed(eh(t));},eT=function(t){function e(t){var n,r,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ea.kNumber;return(0,C.default)(this,e),r=(0,L.default)(this,e),i="string"==typeof a?(n=a)?"number"===n?ea.kNumber:"percent"===n||"%"===n?ea.kPercentage:eu.find(function(t){return t.name===n;}).unit_type:ea.kUnknown:a,r.unit=i,r.value=t,r;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return new e(this.value,this.unit);}},{key:"equals",value:function(t){return this.value===t.value&&this.unit===t.unit;}},{key:"getType",value:function(){return ec.kUnitType;}},{key:"convertTo",value:function(t){if(this.unit===t)return new e(this.value,this.unit);var n=ex(this.unit);if(n!==ex(t)||n===ea.kUnknown)return null;var r=ef(this.unit)/ef(t);return new e(this.value*r,t);}},{key:"buildCSSText",value:function(t,e,n){var r;switch(this.unit){case ea.kUnknown:break;case ea.kInteger:r=Number(this.value).toFixed(0);break;case ea.kNumber:case ea.kPercentage:case ea.kEms:case ea.kRems:case ea.kPixels:case ea.kDegrees:case ea.kRadians:case ea.kGradians:case ea.kMilliseconds:case ea.kSeconds:case ea.kTurns:var i=this.value,a=ev(this.unit);if(i<-999999||i>999999){var o=ev(this.unit);r=!Number.isFinite(i)||Number.isNaN(i)?eE(i,o):i+(o||"");}else r="".concat(i).concat(a);}return n+r;}}]);}(ep),eN=new eT(0,"px");new eT(1,"px");var eb=new eT(0,"deg"),eS=function(t){function e(t,n,r){var i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return(0,C.default)(this,e),(i=(0,L.default)(this,e,["rgb"])).r=t,i.g=n,i.b=r,i.alpha=a,i.isNone=o,i;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return new e(this.r,this.g,this.b,this.alpha);}},{key:"buildCSSText",value:function(t,e,n){return"".concat(n,"rgba(").concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")");}}]);}(eg),ew=new ek("unset"),eP={"":ew,unset:ew,initial:new ek("initial"),inherit:new ek("inherit")},eM=new eS(0,0,0,0,!0),eA=new eS(0,0,0,0),eC=ei(function(t,e,n,r){return new eS(t,e,n,r);},function(t,e,n,r){return"rgba(".concat(t,",").concat(e,",").concat(n,",").concat(r,")");}),eR=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ea.kNumber;return new eT(t,e);};new eT(50,"%");var eO=function(){var t={linearGradient:/^(linear\-gradient)/i,repeatingLinearGradient:/^(repeating\-linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,repeatingRadialGradient:/^(repeating\-radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},e="";function n(t){throw Error("".concat(e,": ").concat(t));}function r(){return i("linear-gradient",t.linearGradient,o)||i("repeating-linear-gradient",t.repeatingLinearGradient,o)||i("radial-gradient",t.radialGradient,s)||i("repeating-radial-gradient",t.repeatingRadialGradient,s)||i("conic-gradient",t.conicGradient,s);}function i(e,r,i){return a(r,function(r){var a=i();return a&&!m(t.comma)&&n("Missing comma before color stops"),{type:e,orientation:a,colorStops:d(f)};});}function a(e,r){var i=m(e);if(i){m(t.startCall)||n("Missing (");var a=r(i);return m(t.endCall)||n("Missing )"),a;}}function o(){return y("directional",t.sideOrCorner,1)||y("angular",t.angleValue,1);}function s(){var n,r,i=l();return i&&((n=[]).push(i),r=e,m(t.comma)&&((i=l())?n.push(i):e=r)),n;}function l(){var t,e,n=((t=y("shape",/^(circle)/i,0))&&(t.style=g()||u()),t||((e=y("shape",/^(ellipse)/i,0))&&(e.style=p()||u()),e));if(n)n.at=c();else{var r=u();if(r){n=r;var i=c();i&&(n.at=i);}else{var a=h();a&&(n={type:"default-radial",at:a});}}return n;}function u(){return y("extent-keyword",t.extentKeywords,1);}function c(){if(y("position",/^at/,0)){var t=h();return t||n("Missing positioning value"),t;}}function h(){var t={x:p(),y:p()};if(t.x||t.y)return{type:"position",value:t};}function d(e){var r=e(),i=[];if(r)for(i.push(r);m(t.comma);)(r=e())?i.push(r):n("One extra comma");return i;}function f(){var e=y("hex",t.hexColor,1)||a(t.rgbaColor,function(){return{type:"rgba",value:d(v)};})||a(t.rgbColor,function(){return{type:"rgb",value:d(v)};})||y("literal",t.literalColor,0);return e||n("Expected color definition"),e.length=p(),e;}function v(){return m(t.number)[1];}function p(){return y("%",t.percentageValue,1)||y("position-keyword",t.positionKeywords,1)||g();}function g(){return y("px",t.pixelValue,1)||y("em",t.emValue,1);}function y(t,e,n){var r=m(e);if(r)return{type:t,value:r[n]};}function m(t){var n=/^[\n\r\t\s]+/.exec(e);n&&k(n[0].length);var r=t.exec(e);return r&&k(r[0].length),r;}function k(t){e=e.substring(t);}return function(t){var i;return e=t,i=d(r),e.length>0&&n("Invalid input not EOF"),i;};}(),eL=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,eI=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,eD=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,e_=/[\d.]+:(#[^\s]+|[^\)]+\))/gi,eG={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},eF=ei(function(t){return eR("angular"===t.type?Number(t.value):eG[t.value]||0,"deg");}),eB=ei(function(t){var e=50,n=50,r="%",i="%";if((null==t?void 0:t.type)==="position"){var a=t.value,o=a.x,s=a.y;(null==o?void 0:o.type)==="position-keyword"&&("left"===o.value?e=0:"center"===o.value?e=50:"right"===o.value?e=100:"top"===o.value?n=0:"bottom"===o.value&&(n=100)),(null==s?void 0:s.type)==="position-keyword"&&("left"===s.value?e=0:"center"===s.value?n=50:"right"===s.value?e=100:"top"===s.value?n=0:"bottom"===s.value&&(n=100)),((null==o?void 0:o.type)==="px"||(null==o?void 0:o.type)==="%"||(null==o?void 0:o.type)==="em")&&(r=null==o?void 0:o.type,e=Number(o.value)),((null==s?void 0:s.type)==="px"||(null==s?void 0:s.type)==="%"||(null==s?void 0:s.type)==="em")&&(i=null==s?void 0:s.type,n=Number(s.value));}return{cx:eR(e,r),cy:eR(n,i)};}),eU=ei(function(t){if(t.indexOf("linear")>-1||t.indexOf("radial")>-1)return eO(t).map(function(t){var e=t.type,n=t.orientation,r=t.colorStops;!function(t){var e=t.length;t[e-1].length=null!==(a=t[e-1].length)&&void 0!==a?a:{type:"%",value:"100"},e>1&&(t[0].length=null!==(o=t[0].length)&&void 0!==o?o:{type:"%",value:"0"});for(var n=0,r=Number(t[0].length.value),i=1;i<e;i++){var a,o,s,l=null===(s=t[i].length)||void 0===s?void 0:s.value;if(!(0,F.isNil)(l)&&!(0,F.isNil)(r)){for(var u=1;u<i-n;u++)t[n+u].length={type:"%",value:"".concat(r+(Number(l)-r)*u/(i-n))};n=i,r=Number(l);}}}(r);var i=r.map(function(t){var e,n;return{offset:eR(Number(t.length.value),"%"),color:(e=t.type,n=t.value,"hex"===e?"#".concat(n):"literal"===e?n:"rgb"===e?"rgb(".concat(n.join(","),")"):"rgba(".concat(n.join(","),")"))};});if("linear-gradient"===e)return new em(ey.LinearGradient,{angle:n?eF(n):eb,steps:i});if("radial-gradient"===e&&(n||(n=[{type:"shape",value:"circle"}]),"shape"===n[0].type&&"circle"===n[0].value)){var a,o=eB(n[0].at),s=o.cx,l=o.cy;if(n[0].style){var u=n[0].style,c=u.type,h=u.value;"extent-keyword"===c?(eP[h]||(eP[h]=new ek(h)),a=eP[h]):a=eR(h,c);}return new em(ey.RadialGradient,{cx:s,cy:l,size:a,steps:i});}});var e=t[0];if("("===t[1]||"("===t[2]){if("l"===e){var n=eL.exec(t);if(n){var r,i=(null===(r=n[2].match(e_))||void 0===r?void 0:r.map(function(t){return t.split(":");}))||[];return[new em(ey.LinearGradient,{angle:eR(parseFloat(n[1]),"deg"),steps:i.map(function(t){var e=(0,D.default)(t,2),n=e[0],r=e[1];return{offset:eR(100*Number(n),"%"),color:r};})})];}}else if("r"===e){var a=function(t){var e=eI.exec(t);if(e){var n,r=(null===(n=e[4].match(e_))||void 0===n?void 0:n.map(function(t){return t.split(":");}))||[];return{cx:eR(50,"%"),cy:eR(50,"%"),steps:r.map(function(t){var e=(0,D.default)(t,2),n=e[0],r=e[1];return{offset:eR(100*Number(n),"%"),color:r};})};}return null;}(t);if(a){if(!(0,F.isString)(a))return[new em(ey.RadialGradient,a)];t=a;}}else if("p"===e)return function(t){var e=eD.exec(t);if(e){var n=e[1],r=e[2];switch(n){case"a":n="repeat";break;case"x":n="repeat-x";break;case"y":n="repeat-y";break;default:n="no-repeat";}return{image:r,repetition:n};}return null;}(t);}});function eV(t){return t&&!(0,F.isNil)(t.r)&&!(0,F.isNil)(t.g)&&!(0,F.isNil)(t.b);}var ez=ei(function(t){if((e=t)&&e.image)return(0,A.default)({repetition:"repeat"},t);if((0,F.isNil)(t)&&(t=""),"transparent"===t)return eA;if("currentColor"===t)t="black";else if("none"===t)return eM;var e,n=eU(t);if(n)return n;var r=tJ(t),i=[0,0,0,0];return null!==r&&(i[0]=r.r||0,i[1]=r.g||0,i[2]=r.b||0,i[3]=r.opacity),eC.apply(void 0,i);});function eH(t,e){if(eV(t)&&eV(e))return[[Number(t.r),Number(t.g),Number(t.b),Number(t.alpha)],[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],function(t){var e=t.slice();if(e[3])for(var n=0;n<3;n++)e[n]=Math.round((0,F.clamp)(e[n],0,255));return e[3]=(0,F.clamp)(e[3],0,1),"rgba(".concat(e.join(","),")");}];}function eY(t,e){if((0,F.isNil)(e))return eR(0,"px");if(isFinite(Number(e="".concat(e).trim().toLowerCase()))){if("px".search(t)>=0)return eR(Number(e),"px");if("deg".search(t)>=0)return eR(Number(e),"deg");}var n=[];e=e.replace(t,function(t){return n.push(t),"U".concat(t);});var r="U(".concat(t.source,")");return n.map(function(t){return eR(Number(e.replace(RegExp("U".concat(t),"g"),"").replace(RegExp(r,"g"),"*0")),t);})[0];}var eW=function(t){return eY(/px/g,t);},eq=ei(eW);ei(function(t){return eY(RegExp("%","g"),t);});var eX=function(t){return(0,F.isNumber)(t)||isFinite(Number(t))?eR(Number(t)||0,"px"):eY(RegExp("px|%|em|rem","g"),t);},ej=ei(eX),e$=function(t){return eY(RegExp("deg|rad|grad|turn","g"),t);},eK=ei(e$);function eZ(t){var e=0;return t.unit===ea.kDegrees?e=t.value:t.unit===ea.kRadians?e=Number(t.value)*tv:t.unit===ea.kTurns?e=360*Number(t.value):t.value&&(e=t.value),e;}function eQ(t,e){var n;return(Array.isArray(t)?n=t.map(function(t){return Number(t);}):(0,F.isString)(t)?n=t.split(" ").map(function(t){return Number(t);}):(0,F.isNumber)(t)&&(n=[t]),2===e)?1===n.length?[n[0],n[0]]:[n[0],n[1]]:4===e?1===n.length?[n[0],n[0],n[0],n[0]]:2===n.length?[n[0],n[1],n[0],n[1]]:3===n.length?[n[0],n[1],n[2],n[1]]:[n[0],n[1],n[2],n[3]]:"even"===e&&n.length%2==1?[].concat((0,O.default)(n),(0,O.default)(n)):n;}function eJ(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t.unit===ea.kPixels)return Number(t.value);if(t.unit===ea.kPercentage&&n){var i=n.nodeName===j.GROUP?n.getLocalBounds():n.getGeometryBounds();return(r?i.min[e]:0)+t.value/100*i.halfExtents[e]*2;}return 0;}var e0=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function e1(t){return t.toString();}var e2=function(t){return"number"==typeof t?eR(t):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(t)?eR(Number(t)):eR(0);},e3=ei(e2);function e4(t,e){return[t,e,e1];}function e5(t,e){return function(n,r){return[n,r,function(n){return e1((0,F.clamp)(n,t,e));}];};}function e6(t,e){if(t.length===e.length)return[t,e,function(t){return t;}];}function e7(t){return 0===t.parsedStyle.d.totalLength&&(t.parsedStyle.d.totalLength=(0,F.getTotalLength)(t.parsedStyle.d.absolutePath)),t.parsedStyle.d.totalLength;}function e9(t,e){return t[0]===e[0]&&t[1]===e[1];}function e8(t,e){var n=t.prePoint,r=t.currentPoint,i=t.nextPoint,a=Math.pow(r[0]-n[0],2)+Math.pow(r[1]-n[1],2),o=Math.pow(r[0]-i[0],2)+Math.pow(r[1]-i[1],2),s=Math.acos((a+o-(Math.pow(n[0]-i[0],2)+Math.pow(n[1]-i[1],2)))/(2*Math.sqrt(a)*Math.sqrt(o)));if(!s||0===Math.sin(s)||(0,F.isNumberEqual)(s,0))return{xExtra:0,yExtra:0};var l=Math.abs(Math.atan2(i[1]-r[1],i[0]-r[0])),u=Math.abs(Math.atan2(i[0]-r[0],i[1]-r[1]));return{xExtra:e/2*(1/Math.sin(s/2))*Math.cos(s/2-(l=l>Math.PI/2?Math.PI-l:l))-e/2||0,yExtra:e/2*(1/Math.sin(s/2))*Math.cos((u=u>Math.PI/2?Math.PI-u:u)-s/2)-e/2||0};}function nt(t,e){return[e[0]+(e[0]-t[0]),e[1]+(e[1]-t[1])];}ei(function(t){return(0,F.isString)(t)?t.split(" ").map(e3):t.map(e3);});var ne=function(t,e){var n=t.x*e.x+t.y*e.y,r=Math.sqrt((Math.pow(t.x,2)+Math.pow(t.y,2))*(Math.pow(e.x,2)+Math.pow(e.y,2)));return(t.x*e.y-t.y*e.x<0?-1:1)*Math.acos(n/r);},nn=function(t,e,n,r,i,a,o,s){e=Math.abs(e),n=Math.abs(n);var l=(r=(0,F.mod)(r,360))*tf;if(t.x===o.x&&t.y===o.y)return{x:t.x,y:t.y,ellipticalArcAngle:0};if(0===e||0===n)return{x:0,y:0,ellipticalArcAngle:0};var u=(t.x-o.x)/2,c=(t.y-o.y)/2,h={x:Math.cos(l)*u+Math.sin(l)*c,y:-Math.sin(l)*u+Math.cos(l)*c},d=Math.pow(h.x,2)/Math.pow(e,2)+Math.pow(h.y,2)/Math.pow(n,2);d>1&&(e*=Math.sqrt(d),n*=Math.sqrt(d));var f=(Math.pow(e,2)*Math.pow(n,2)-Math.pow(e,2)*Math.pow(h.y,2)-Math.pow(n,2)*Math.pow(h.x,2))/(Math.pow(e,2)*Math.pow(h.y,2)+Math.pow(n,2)*Math.pow(h.x,2)),v=(i!==a?1:-1)*Math.sqrt(f=f<0?0:f),p={x:v*(e*h.y/n),y:v*(-(n*h.x)/e)},g={x:Math.cos(l)*p.x-Math.sin(l)*p.y+(t.x+o.x)/2,y:Math.sin(l)*p.x+Math.cos(l)*p.y+(t.y+o.y)/2},y={x:(h.x-p.x)/e,y:(h.y-p.y)/n},m=ne({x:1,y:0},y),k=ne(y,{x:(-h.x-p.x)/e,y:(-h.y-p.y)/n});!a&&k>0?k-=2*Math.PI:a&&k<0&&(k+=2*Math.PI);var E=m+(k%=2*Math.PI)*s,x=e*Math.cos(E),T=n*Math.sin(E);return{x:Math.cos(l)*x-Math.sin(l)*T+g.x,y:Math.sin(l)*x+Math.cos(l)*T+g.y,ellipticalArcStartAngle:m,ellipticalArcEndAngle:m+k,ellipticalArcAngle:E,ellipticalArcCenter:g,resultantRx:e,resultantRy:n};};function nr(t,e){var n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=t.arcParams,i=r.rx,a=void 0===i?0:i,o=r.ry,s=void 0===o?0:o,l=r.xRotation,u=r.arcFlag,c=r.sweepFlag,h=nn({x:t.prePoint[0],y:t.prePoint[1]},a,s,l,!!u,!!c,{x:t.currentPoint[0],y:t.currentPoint[1]},e),d=nn({x:t.prePoint[0],y:t.prePoint[1]},a,s,l,!!u,!!c,{x:t.currentPoint[0],y:t.currentPoint[1]},n?e+.005:e-.005),f=d.x-h.x,v=d.y-h.y,p=Math.sqrt(f*f+v*v);return{x:-f/p,y:-v/p};}function ni(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1]);}function na(t,e){return ni(t)*ni(e)?(t[0]*e[0]+t[1]*e[1])/(ni(t)*ni(e)):1;}function no(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(na(t,e));}var ns=function(t){if(""===t||Array.isArray(t)&&0===t.length)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};try{e=(0,F.normalizePath)(t);}catch(n){e=(0,F.normalizePath)(""),console.error("[g]: Invalid SVG Path definition: ".concat(t));}!function(t){for(var e=0;e<t.length;e++){var n=t[e-1],r=t[e];if("M"===r[0]&&n){var i=n[0],a=[r[1],r[2]],o=void 0;"L"===i||"M"===i?o=[n[1],n[2]]:("C"===i||"A"===i||"Q"===i)&&(o=[n[n.length-2],n[n.length-1]]),o&&e9(a,o)&&(t.splice(e,1),e--);}}}(e);var e,n=function(t){for(var e=!1,n=t.length,r=0;r<n;r++){var i=t[r][0];if("C"===i||"A"===i||"Q"===i){e=!0;break;}}return e;}(e),r=function(t){for(var e=[],n=[],r=[],i=0;i<t.length;i++){var a=t[i],o=a[0];"M"===o?(r.length&&(n.push(r),r=[]),r.push([a[1],a[2]])):"Z"===o?r.length&&(e.push(r),r=[]):r.push([a[1],a[2]]);}return r.length>0&&n.push(r),{polygons:e,polylines:n};}(e),i=r.polygons,a=r.polylines,o=function(t){for(var e=[],n=null,r=null,i=null,a=0,o=t.length,s=0;s<o;s++){var l=t[s];r=t[s+1];var u=l[0],c={command:u,prePoint:n,params:l,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(u){case"M":i=[l[1],l[2]],a=s;break;case"A":var h=function(t,e){var n=e[1],r=e[2],i=(0,F.mod)(e[3]*tf,2*Math.PI),a=e[4],o=e[5],s=t[0],l=t[1],u=e[6],c=e[7],h=Math.cos(i)*(s-u)/2+Math.sin(i)*(l-c)/2,d=-1*Math.sin(i)*(s-u)/2+Math.cos(i)*(l-c)/2,f=h*h/(n*n)+d*d/(r*r);f>1&&(n*=Math.sqrt(f),r*=Math.sqrt(f));var v=n*n*(d*d)+r*r*(h*h),p=v?Math.sqrt((n*n*(r*r)-v)/v):1;a===o&&(p*=-1),isNaN(p)&&(p=0);var g=r?p*n*d/r:0,y=n?-(p*r)*h/n:0,m=(s+u)/2+Math.cos(i)*g-Math.sin(i)*y,k=(l+c)/2+Math.sin(i)*g+Math.cos(i)*y,E=[(h-g)/n,(d-y)/r],x=[(-1*h-g)/n,(-1*d-y)/r],T=no([1,0],E),N=no(E,x);return -1>=na(E,x)&&(N=Math.PI),na(E,x)>=1&&(N=0),0===o&&N>0&&(N-=2*Math.PI),1===o&&N<0&&(N+=2*Math.PI),{cx:m,cy:k,rx:e9(t,[u,c])?0:n,ry:e9(t,[u,c])?0:r,startAngle:T,endAngle:T+N,xRotation:i,arcFlag:a,sweepFlag:o};}(n,l);c.arcParams=h;}if("Z"===u)n=i,r=t[a+1];else{var d=l.length;n=[l[d-2],l[d-1]];}r&&"Z"===r[0]&&(r=t[a],e[a]&&(e[a].prePoint=n)),c.currentPoint=n,e[a]&&e9(n,e[a].currentPoint)&&(e[a].prePoint=c.prePoint);var f=r?[r[r.length-2],r[r.length-1]]:null;c.nextPoint=f;var v=c.prePoint;if(["L","H","V"].includes(u))c.startTangent=[v[0]-n[0],v[1]-n[1]],c.endTangent=[n[0]-v[0],n[1]-v[1]];else if("Q"===u){var p=[l[1],l[2]];c.startTangent=[v[0]-p[0],v[1]-p[1]],c.endTangent=[n[0]-p[0],n[1]-p[1]];}else if("T"===u){var g=e[s-1],y=nt(g.currentPoint,v);"Q"===g.command?(c.command="Q",c.startTangent=[v[0]-y[0],v[1]-y[1]],c.endTangent=[n[0]-y[0],n[1]-y[1]]):(c.command="TL",c.startTangent=[v[0]-n[0],v[1]-n[1]],c.endTangent=[n[0]-v[0],n[1]-v[1]]);}else if("C"===u){var m=[l[1],l[2]],k=[l[3],l[4]];c.startTangent=[v[0]-m[0],v[1]-m[1]],c.endTangent=[n[0]-k[0],n[1]-k[1]],0===c.startTangent[0]&&0===c.startTangent[1]&&(c.startTangent=[m[0]-k[0],m[1]-k[1]]),0===c.endTangent[0]&&0===c.endTangent[1]&&(c.endTangent=[k[0]-m[0],k[1]-m[1]]);}else if("S"===u){var E=e[s-1],x=nt(E.currentPoint,v),T=[l[1],l[2]];"C"===E.command?(c.command="C",c.startTangent=[v[0]-x[0],v[1]-x[1]]):(c.command="SQ",c.startTangent=[v[0]-T[0],v[1]-T[1]]),c.endTangent=[n[0]-T[0],n[1]-T[1]];}else if("A"===u){var N=nr(c,0),b=N.x,S=N.y,w=nr(c,1,!1),P=w.x,M=w.y;c.startTangent=[b,S],c.endTangent=[P,M];}e.push(c);}return e;}(e),s=function(t,e){for(var n=[],r=[],i=[],a=0;a<t.length;a++){var o=t[a],s=o.currentPoint,l=o.params,u=o.prePoint,c=void 0;switch(o.command){case"Q":c=(0,z.quadBox)(u[0],u[1],l[1],l[2],l[3],l[4]);break;case"C":c=(0,z.cubicBox)(u[0],u[1],l[1],l[2],l[3],l[4],l[5],l[6]);break;case"A":var h=o.arcParams;c=(0,z.arcBox)(h.cx,h.cy,h.rx,h.ry,h.xRotation,h.startAngle,h.endAngle);break;default:n.push(s[0]),r.push(s[1]);}c&&(o.box=c,n.push(c.x,c.x+c.width),r.push(c.y,c.y+c.height));}n=n.filter(function(t){return!Number.isNaN(t)&&t!==1/0&&t!==-1/0;}),r=r.filter(function(t){return!Number.isNaN(t)&&t!==1/0&&t!==-1/0;});var d=(0,F.min)(n),f=(0,F.min)(r),v=(0,F.max)(n),p=(0,F.max)(r);if(0===i.length)return{x:d,y:f,width:v-d,height:p-f};for(var g=0;g<i.length;g++){var y=i[g],m=y.currentPoint;m[0]===d?d-=e8(y,0).xExtra:m[0]===v&&(v+=e8(y,0).xExtra),m[1]===f?f-=e8(y,e).yExtra:m[1]===p&&(p+=e8(y,e).yExtra);}return{x:d,y:f,width:v-d,height:p-f};}(o,0),l=s.x,u=s.y,c=s.width,h=s.height;return{absolutePath:e,hasArc:n,segments:o,polygons:i,polylines:a,totalLength:0,rect:{x:Number.isFinite(l)?l:0,y:Number.isFinite(u)?u:0,width:Number.isFinite(c)?c:0,height:Number.isFinite(h)?h:0}};},nl=ei(ns);function nu(t){return(0,F.isString)(t)?nl(t):ns(t);}function nc(t,e,n){var r=t.curve,i=e.curve;r&&0!==r.length||(r=(0,F.path2Curve)(t.absolutePath,!1),t.curve=r),i&&0!==i.length||(i=(0,F.path2Curve)(e.absolutePath,!1),e.curve=i);var a=[r,i];r.length!==i.length&&(a=(0,F.equalizeSegments)(r,i));var o=(0,F.getDrawDirection)(a[0])!==(0,F.getDrawDirection)(a[1])?(0,F.reverseCurve)(a[0]):(0,F.clonePath)(a[0]);return[o,(0,F.getRotatedCurve)(a[1],o),function(t){return t;}];}function nh(t,e){return[t.points,e.points,function(t){return t;}];}var nd=/\s*(\w+)\(([^)]*)\)/g;function nf(t){return function(e){var n=0;return t.map(function(t){return null===t?e[n++]:t;});};}function nv(t){return t;}var np={matrix:["NNNNNN",[null,null,0,0,null,null,0,0,0,0,1,0,null,null,0,1],nv],matrix3d:["NNNNNNNNNNNNNNNN",nv],rotate:["A"],rotateX:["A"],rotateY:["A"],rotateZ:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",nf([null,null,new eT(1)]),nv],scaleX:["N",nf([null,new eT(1),new eT(1)]),nf([null,new eT(1)])],scaleY:["N",nf([new eT(1),null,new eT(1)]),nf([new eT(1),null])],scaleZ:["N",nf([new eT(1),new eT(1),null])],scale3d:["NNN",nv],skew:["Aa",null,nv],skewX:["A",null,nf([null,eb])],skewY:["A",null,nf([eb,null])],translate:["Tt",nf([null,null,eN]),nv],translateX:["T",nf([null,eN,eN]),nf([null,eN])],translateY:["T",nf([eN,null,eN]),nf([eN,null])],translateZ:["L",nf([eN,eN,null])],translate3d:["TTL",nv]};function ng(t){for(var e=[],n=t.length,r=0;r<n;r++){var i=t[r],a=i[0],o=i.slice(1);if("translate"===a||"skew"===a?1===o.length&&o.push(0):"scale"===a&&1===o.length&&o.push(o[0]),!np[a])return[];var s=o.map(function(t){return eR(t);});e.push({t:a,d:s});}return e;}function ny(t){if(Array.isArray(t))return ng(t);if("none"===(t=(t||"none").trim()))return[];var e,n=[],r=0;for(nd.lastIndex=0;(e=nd.exec(t))&&e.index===r;){r=e.index+e[0].length;var i=e[1],a=np[i];if(!a)break;var o=e[2].split(","),s=a[0];if(s.length<o.length)break;for(var l=[],u=0;u<s.length;u++){var c=o[u],h=s[u],d=void 0;if(void 0===(d=c?({A:function(t){return"0"===t.trim()?eb:e$(t);},N:e2,T:eX,L:eW})[h.toUpperCase()](c):({a:eb,n:l[0],t:eN})[h]))return[];l.push(d);}if(n.push({t:i,d:l}),nd.lastIndex===t.length)return n;}return[];}function nm(t){switch(t.t){case"rotateX":return[1,0,0,0,0,Math.cos(i=eZ(t.d[0])*tf),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1];case"rotateY":return[Math.cos(i=eZ(t.d[0])*tf),0,-Math.sin(i),0,0,1,0,0,Math.sin(i),0,Math.cos(i),0,0,0,0,1];case"rotate":case"rotateZ":return[Math.cos(i=eZ(t.d[0])*tf),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1,0,0,0,0,1];case"rotate3d":e=t.d[0].value,n=t.d[1].value,r=t.d[2].value,i=eZ(t.d[3])*tf;var e,n,r,i,a=e*e+n*n+r*r;if(0===a)e=1,n=0,r=0;else if(1!==a){var o=Math.sqrt(a);e/=o,n/=o,r/=o;}var s=Math.sin(i/2),l=s*Math.cos(i/2),u=s*s;return[1-2*(n*n+r*r)*u,2*(e*n*u+r*l),2*(e*r*u-n*l),0,2*(e*n*u-r*l),1-2*(e*e+r*r)*u,2*(n*r*u+e*l),0,2*(e*r*u+n*l),2*(n*r*u-e*l),1-2*(e*e+n*n)*u,0,0,0,0,1];case"scale":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scaleX":return[t.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaleY":return[1,0,0,0,0,t.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scaleZ":return[1,0,0,0,0,1,0,0,0,0,t.d[0].value,0,0,0,0,1];case"scale3d":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,t.d[2].value,0,0,0,0,1];case"skew":var c=eZ(t.d[0])*tf;return[1,Math.tan(eZ(t.d[1])*tf),0,0,Math.tan(c),1,0,0,0,0,1,0,0,0,0,1];case"skewX":return[1,0,0,0,Math.tan(i=eZ(t.d[0])*tf),1,0,0,0,0,1,0,0,0,0,1];case"skewY":return[1,Math.tan(i=eZ(t.d[0])*tf),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return[1,0,0,0,0,1,0,0,0,0,1,0,e=eJ(t.d[0],0,null)||0,n=eJ(t.d[1],0,null)||0,0,1];case"translateX":return[1,0,0,0,0,1,0,0,0,0,1,0,e=eJ(t.d[0],0,null)||0,0,0,1];case"translateY":return[1,0,0,0,0,1,0,0,0,0,1,0,0,n=eJ(t.d[0],0,null)||0,0,1];case"translateZ":return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,r=eJ(t.d[0],0,null)||0,1];case"translate3d":return[1,0,0,0,0,1,0,0,0,0,1,0,e=eJ(t.d[0],0,null)||0,n=eJ(t.d[1],0,null)||0,r=eJ(t.d[2],0,null)||0,1];case"perspective":var h=eJ(t.d[0],0,null)||0;return[1,0,0,0,0,1,0,0,0,0,1,h?-1/h:0,0,0,0,1];case"matrix":return[t.d[0].value,t.d[1].value,0,0,t.d[2].value,t.d[3].value,0,0,0,0,1,0,t.d[4].value,t.d[5].value,0,1];case"matrix3d":return t.d.map(function(t){return t.value;});}}function nk(t,e){return[t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12]*e[3],t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13]*e[3],t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]*e[3],t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15]*e[3],t[0]*e[4]+t[4]*e[5]+t[8]*e[6]+t[12]*e[7],t[1]*e[4]+t[5]*e[5]+t[9]*e[6]+t[13]*e[7],t[2]*e[4]+t[6]*e[5]+t[10]*e[6]+t[14]*e[7],t[3]*e[4]+t[7]*e[5]+t[11]*e[6]+t[15]*e[7],t[0]*e[8]+t[4]*e[9]+t[8]*e[10]+t[12]*e[11],t[1]*e[8]+t[5]*e[9]+t[9]*e[10]+t[13]*e[11],t[2]*e[8]+t[6]*e[9]+t[10]*e[10]+t[14]*e[11],t[3]*e[8]+t[7]*e[9]+t[11]*e[10]+t[15]*e[11],t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12]*e[15],t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13]*e[15],t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14]*e[15],t[3]*e[12]+t[7]*e[13]+t[11]*e[14]+t[15]*e[15]];}function nE(t){var e=[0,0,0],n=[1,1,1],r=[0,0,0],i=[0,0,0,1],a=[0,0,0,1];return!function(t,e,n,r,i,a){if(!(!function(t,e){var n=e[15];if(0===n)return!1;for(var r=1/n,i=0;i<16;i++)t[i]=e[i]*r;return!0;}(tm,t)||(G.mat4.copy(tk,tm),tk[3]=0,tk[7]=0,tk[11]=0,tk[15]=1,1e-8>Math.abs(G.mat4.determinant(tk))))){var o=tm[3],s=tm[7],l=tm[11],u=tm[12],c=tm[13],h=tm[14],d=tm[15];if(0!==o||0!==s||0!==l){if(tE[0]=o,tE[1]=s,tE[2]=l,tE[3]=d,!G.mat4.invert(tk,tk))return;G.mat4.transpose(tk,tk),G.vec4.transformMat4(i,tE,tk);}else i[0]=i[1]=i[2]=0,i[3]=1;if(e[0]=u,e[1]=c,e[2]=h,tx[0][0]=tm[0],tx[0][1]=tm[1],tx[0][2]=tm[2],tx[1][0]=tm[4],tx[1][1]=tm[5],tx[1][2]=tm[6],tx[2][0]=tm[8],tx[2][1]=tm[9],tx[2][2]=tm[10],n[0]=G.vec3.length(tx[0]),G.vec3.normalize(tx[0],tx[0]),r[0]=G.vec3.dot(tx[0],tx[1]),tN(tx[1],tx[1],tx[0],1,-r[0]),n[1]=G.vec3.length(tx[1]),G.vec3.normalize(tx[1],tx[1]),r[0]/=n[1],r[1]=G.vec3.dot(tx[0],tx[2]),tN(tx[2],tx[2],tx[0],1,-r[1]),r[2]=G.vec3.dot(tx[1],tx[2]),tN(tx[2],tx[2],tx[1],1,-r[2]),n[2]=G.vec3.length(tx[2]),G.vec3.normalize(tx[2],tx[2]),r[1]/=n[2],r[2]/=n[2],G.vec3.cross(tT,tx[1],tx[2]),0>G.vec3.dot(tx[0],tT))for(var f=0;f<3;f++)n[f]*=-1,tx[f][0]*=-1,tx[f][1]*=-1,tx[f][2]*=-1;a[0]=.5*Math.sqrt(Math.max(1+tx[0][0]-tx[1][1]-tx[2][2],0)),a[1]=.5*Math.sqrt(Math.max(1-tx[0][0]+tx[1][1]-tx[2][2],0)),a[2]=.5*Math.sqrt(Math.max(1-tx[0][0]-tx[1][1]+tx[2][2],0)),a[3]=.5*Math.sqrt(Math.max(1+tx[0][0]+tx[1][1]+tx[2][2],0)),tx[2][1]>tx[1][2]&&(a[0]=-a[0]),tx[0][2]>tx[2][0]&&(a[1]=-a[1]),tx[1][0]>tx[0][1]&&(a[2]=-a[2]);}}(0===t.length?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:t.map(nm).reduce(nk),e,n,r,i,a),[[e,n,r,a,i]];}var nx=function(){function t(t,e){for(var n=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],r=0;r<4;r++)for(var i=0;i<4;i++)for(var a=0;a<4;a++)n[r][i]+=e[r][a]*t[a][i];return n;}return function(e,n,r,i,a){for(var o,s=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],l=0;l<4;l++)s[l][3]=a[l];for(var u=0;u<3;u++)for(var c=0;c<3;c++)s[3][u]+=e[c]*s[c][u];var h=i[0],d=i[1],f=i[2],v=i[3],p=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];p[0][0]=1-2*(d*d+f*f),p[0][1]=2*(h*d-f*v),p[0][2]=2*(h*f+d*v),p[1][0]=2*(h*d+f*v),p[1][1]=1-2*(h*h+f*f),p[1][2]=2*(d*f-h*v),p[2][0]=2*(h*f-d*v),p[2][1]=2*(d*f+h*v),p[2][2]=1-2*(h*h+d*d),s=t(s,p);var g=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];r[2]&&(g[2][1]=r[2],s=t(s,g)),r[1]&&(g[2][1]=0,g[2][0]=r[0],s=t(s,g)),r[0]&&(g[2][0]=0,g[1][0]=r[0],s=t(s,g));for(var y=0;y<3;y++)for(var m=0;m<3;m++)s[y][m]*=n[y];return 0===(o=s)[0][2]&&0===o[0][3]&&0===o[1][2]&&0===o[1][3]&&0===o[2][0]&&0===o[2][1]&&1===o[2][2]&&0===o[2][3]&&0===o[3][2]&&1===o[3][3]?[s[0][0],s[0][1],s[1][0],s[1][1],s[3][0],s[3][1]]:s[0].concat(s[1],s[2],s[3]);};}();function nT(t){return t.toFixed(6).replace(".000000","");}function nN(t,e){var n,r;return(t.decompositionPair!==e&&(t.decompositionPair=e,n=nE(t)),e.decompositionPair!==t&&(e.decompositionPair=t,r=nE(e)),null===n[0]||null===r[0])?[[!1],[!0],function(n){return n?e[0].d:t[0].d;}]:(n[0].push(0),r[0].push(1),[n,r,function(t){var e=function(t,e,n){var r=function(t,e){for(var n=0,r=0;r<t.length;r++)n+=t[r]*e[r];return n;}(t,e);r=(0,F.clamp)(r,-1,1);var i=[];if(1===r)i=t;else for(var a=Math.acos(r),o=1*Math.sin(n*a)/Math.sqrt(1-r*r),s=0;s<4;s++)i.push(t[s]*(Math.cos(n*a)-r*o)+e[s]*o);return i;}(n[0][3],r[0][3],t[5]);return nx(t[0],t[1],t[2],e,t[4]).map(nT).join(",");}]);}function nb(t){return t.replace(/[XY]/,"");}function nS(t){return t.replace(/(X|Y|Z|3d)?$/,"3d");}function nw(t,e,n){var r=!1;if(!t.length||!e.length){t.length||(r=!0,t=e,e=[]);for(var i=0;i<t.length;i++)!function(){var n=t[i],r=n.t,a=n.d,o="scale"===r.substring(0,5)?1:0;e.push({t:r,d:a.map(function(t){return"number"==typeof t?eR(o):eR(o,t.unit);})});}();}var a=[],o=[],s=[];if(t.length!==e.length){var l=nN(t,e);a=[l[0]],o=[l[1]],s=[["matrix",[l[2]]]];}else for(var u=0;u<t.length;u++){var c=t[u].t,h=e[u].t,d=t[u].d,f=e[u].d,v=np[c],p=np[h],g=void 0;if("perspective"===c&&"perspective"===h||("matrix"===c||"matrix3d"===c)&&("matrix"===h||"matrix3d"===h)){var y=nN([t[u]],[e[u]]);a.push(y[0]),o.push(y[1]),s.push(["matrix",[y[2]]]);continue;}if(c===h)g=c;else if(v[2]&&p[2]&&nb(c)===nb(h))g=nb(c),d=v[2](d),f=p[2](f);else if(v[1]&&p[1]&&nS(c)===nS(h))g=nS(c),d=v[1](d),f=p[1](f);else{var m=nN(t,e);a=[m[0]],o=[m[1]],s=[["matrix",[m[2]]]];break;}for(var k=[],E=[],x=[],T=0;T<d.length;T++){var N=function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a="",o=t.value||0,s=e.value||0,l=ex(t.unit),u=t.convertTo(l),c=e.convertTo(l);return u&&c?(o=u.value,s=c.value,a=ev(t.unit)):(eT.isLength(t.unit)||eT.isLength(e.unit))&&(o=eJ(t,i,n),s=eJ(e,i,n),a="px"),[o,s,function(t){return r&&(t=Math.max(t,0)),t+a;}];}(d[T],f[T],n,!1,T);k[T]=N[0],E[T]=N[1],x.push(N[2]);}a.push(k),o.push(E),s.push([g,x]);}if(r){var b=a;a=o,o=b;}return[a,o,function(t){return t.map(function(t,e){var n=t.map(function(t,n){return s[e][1][n](t);}).join(",");return"matrix"===s[e][0]&&16===n.split(",").length&&(s[e][0]="matrix3d"),"matrix3d"===s[e][0]&&6===n.split(",").length&&(s[e][0]="matrix"),"".concat(s[e][0],"(").concat(n,")");}).join(" ");}];}var nP=ei(function(t){if((0,F.isString)(t)){if("text-anchor"===t)return[eR(0,"px"),eR(0,"px")];var e=t.split(" ");return(1===e.length&&("top"===e[0]||"bottom"===e[0]?(e[1]=e[0],e[0]="center"):e[1]="center"),2!==e.length)?null:[ej(nM(e[0])),ej(nM(e[1]))];}return[eR(t[0]||0,"px"),eR(t[1]||0,"px")];});function nM(t){return"center"===t?"50%":"left"===t||"top"===t?"0%":"right"===t||"bottom"===t?"100%":t;}var nA=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:t_.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:t_.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:t_.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:t_.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:t_.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:t_.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:t_.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:t_.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:t_.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:t_.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:t_.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:t_.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:t_.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:t_.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:t_.FILTER},{n:"clipPath",syntax:t_.DEFINED_PATH},{n:"textPath",syntax:t_.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:t_.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:t_.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:t_.COORDINATE},{n:"y1",int:!0,l:!0,syntax:t_.COORDINATE},{n:"z1",int:!0,l:!0,syntax:t_.COORDINATE},{n:"x2",int:!0,l:!0,syntax:t_.COORDINATE},{n:"y2",int:!0,l:!0,syntax:t_.COORDINATE},{n:"z2",int:!0,l:!0,syntax:t_.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:t_.PATH,p:50},{n:"points",int:!0,l:!0,syntax:t_.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:t_.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:t_.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:t_.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:t_.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:t_.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:t_.NUMBER,d:function(t){return t===j.PATH||t===j.POLYGON||t===j.POLYLINE?"4":"10";}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:t_.MARKER},{n:"markerEnd",syntax:t_.MARKER},{n:"markerMid",syntax:t_.MARKER},{n:"markerStartOffset",syntax:t_.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:t_.LENGTH,l:!0,int:!0,d:"0"}],nC=new Set(nA.filter(function(t){return!!t.l;}).map(function(t){return t.n;})),nR={},nO=(0,R.default)(function t(e){var n=this;(0,C.default)(this,t),this.runtime=e,nA.forEach(function(t){n.registerMetadata(t);});},[{key:"registerMetadata",value:function(t){[t.n].concat((0,O.default)(t.a||[])).forEach(function(e){nR[e]=t;});}},{key:"getPropertySyntax",value:function(t){return this.runtime.CSSPropertySyntaxFactory[t];}},{key:"processProperties",value:function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[],memoize:!0};Object.assign(t.attributes,e);var i=t.parsedStyle.clipPath,a=t.parsedStyle.offsetPath;!function(t,e){var n=nL(t);for(var r in e)n.has(r)&&(t.parsedStyle[r]=e[r]);}(t,e);var o=!!r.forceUpdateGeometry;if(!o){for(var s in e)if(nC.has(s)){o=!0;break;}}var l=nL(t);l.has("fill")&&e.fill&&(t.parsedStyle.fill=ez(e.fill)),l.has("stroke")&&e.stroke&&(t.parsedStyle.stroke=ez(e.stroke)),l.has("shadowColor")&&e.shadowColor&&(t.parsedStyle.shadowColor=ez(e.shadowColor)),l.has("filter")&&e.filter&&(t.parsedStyle.filter=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if("none"===(e=e.toLowerCase().trim()))return[];for(var n=/\s*([\w-]+)\(([^)]*)\)/g,r=[],i=0;(t=n.exec(e))&&t.index===i;)if(i=t.index+t[0].length,e0.indexOf(t[1])>-1&&r.push({name:t[1],params:t[2].split(" ").map(function(t){return eY(/deg|rad|grad|turn|px|%/g,t)||ez(t);})}),n.lastIndex===e.length)return r;return[];}(e.filter)),l.has("radius")&&!(0,F.isNil)(e.radius)&&(t.parsedStyle.radius=eQ(e.radius,4)),l.has("lineDash")&&!(0,F.isNil)(e.lineDash)&&(t.parsedStyle.lineDash=eQ(e.lineDash,"even")),l.has("points")&&e.points&&(t.parsedStyle.points=(n=e.points,{points:(0,F.isString)(n)?n.split(" ").map(function(t){var e=t.split(","),n=(0,D.default)(e,2),r=n[0],i=n[1];return[Number(r),Number(i)];}):n,totalLength:0,segments:[]})),l.has("d")&&""===e.d&&(t.parsedStyle.d=(0,A.default)({},tD)),l.has("d")&&e.d&&(t.parsedStyle.d=nu(e.d)),l.has("textTransform")&&e.textTransform&&this.runtime.CSSPropertySyntaxFactory[t_.TEXT_TRANSFORM].calculator(null,null,{value:e.textTransform},t,null),l.has("clipPath")&&!(0,F.isUndefined)(e.clipPath)&&this.runtime.CSSPropertySyntaxFactory[t_.DEFINED_PATH].calculator("clipPath",i,e.clipPath,t,this.runtime),l.has("offsetPath")&&e.offsetPath&&this.runtime.CSSPropertySyntaxFactory[t_.DEFINED_PATH].calculator("offsetPath",a,e.offsetPath,t,this.runtime),l.has("transform")&&e.transform&&(t.parsedStyle.transform=function(t){if(Array.isArray(t))return ng(t);if("none"===(t=(t||"none").trim()))return[];var e,n=[],r=0;for(nd.lastIndex=0;(e=nd.exec(t))&&e.index===r;){r=e.index+e[0].length;var i=e[1],a=np[i];if(!a)break;var o=e[2].split(","),s=a[0];if(s.length<o.length)break;for(var l=[],u=0;u<s.length;u++){var c=o[u],h=s[u],d=void 0;if(void 0===(d=c?({A:function(t){return"0"===t.trim()?eb:eK(t);},N:e3,T:ej,L:eq})[h.toUpperCase()](c):({a:eb,n:l[0],t:eN})[h]))return[];l.push(d);}if(n.push({t:i,d:l}),nd.lastIndex===t.length)return n;}return[];}(e.transform)),l.has("transformOrigin")&&e.transformOrigin&&(t.parsedStyle.transformOrigin=nP(e.transformOrigin)),l.has("markerStart")&&e.markerStart&&(t.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory[t_.MARKER].calculator(null,e.markerStart,e.markerStart,null,null)),l.has("markerEnd")&&e.markerEnd&&(t.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory[t_.MARKER].calculator(null,e.markerEnd,e.markerEnd,null,null)),l.has("markerMid")&&e.markerMid&&(t.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory[t_.MARKER].calculator("",e.markerMid,e.markerMid,null,null)),l.has("zIndex")&&!(0,F.isNil)(e.zIndex)&&this.runtime.CSSPropertySyntaxFactory[t_.Z_INDEX].postProcessor(t),l.has("offsetDistance")&&!(0,F.isNil)(e.offsetDistance)&&this.runtime.CSSPropertySyntaxFactory[t_.OFFSET_DISTANCE].postProcessor(t),l.has("transform")&&e.transform&&this.runtime.CSSPropertySyntaxFactory[t_.TRANSFORM].postProcessor(t),l.has("transformOrigin")&&e.transformOrigin&&this.runtime.CSSPropertySyntaxFactory[t_.TRANSFORM_ORIGIN].postProcessor(t),o&&(t.dirty(!0,!0),r.forceUpdateGeometry||this.runtime.sceneGraphService.dirtyToRoot(t));}},{key:"updateGeometry",value:function(t){var e=t.nodeName,n=this.runtime.geometryUpdaterFactory[e];if(n){var r=t.geometry;r.contentBounds||(r.contentBounds=new tr),r.renderBounds||(r.renderBounds=new tr);var i=t.parsedStyle,a=n.update(i,t),o=a.cx,s=a.cy,l=a.cz,u=a.hwidth,c=void 0===u?0:u,h=a.hheight,d=void 0===h?0:h,f=a.hdepth,v=[Math.abs(c),Math.abs(d),void 0===f?0:f],p=i.stroke,g=i.lineWidth,y=i.increasedLineWidthForHitTesting,m=i.shadowType,k=void 0===m?"outer":m,E=i.shadowColor,x=i.filter,T=i.transformOrigin,N=[void 0===o?0:o,void 0===s?0:s,void 0===l?0:l];r.contentBounds.update(N,v);var b=e===j.POLYLINE||e===j.POLYGON||e===j.PATH?Math.SQRT2:.5;if(p&&!p.isNone){var S=(((void 0===g?1:g)||0)+((void 0===y?0:y)||0))*b;v[0]+=S,v[1]+=S;}if(r.renderBounds.update(N,v),E&&k&&"inner"!==k){var w=r.renderBounds,P=w.min,M=w.max,A=i.shadowBlur,C=i.shadowOffsetX,R=i.shadowOffsetY,O=A||0,L=C||0,I=R||0,D=P[0]-O+L,_=M[0]+O+L,F=P[1]-O+I,B=M[1]+O+I;P[0]=Math.min(P[0],D),M[0]=Math.max(M[0],_),P[1]=Math.min(P[1],F),M[1]=Math.max(M[1],B),r.renderBounds.setMinMax(P,M);}(void 0===x?[]:x).forEach(function(t){var e=t.name,n=t.params;if("blur"===e){var i=n[0].value;r.renderBounds.update(r.renderBounds.center,G.vec3.add(r.renderBounds.halfExtents,r.renderBounds.halfExtents,[i,i,0]));}else if("drop-shadow"===e){var a=n[0].value,o=n[1].value,s=n[2].value,l=r.renderBounds,u=l.min,c=l.max,h=u[0]-s+a,d=c[0]+s+a,f=u[1]-s+o,v=c[1]+s+o;u[0]=Math.min(u[0],h),c[0]=Math.max(c[0],d),u[1]=Math.min(u[1],f),c[1]=Math.max(c[1],v),r.renderBounds.setMinMax(u,c);}}),t.geometry.dirty=!1;var U=d<0,V=(c<0?-1:1)*(T?eJ(T[0],0,t,!0):0),z=(U?-1:1)*(T?eJ(T[1],1,t,!0):0);(V||z)&&t.setOrigin(V,z);}}},{key:"updateSizeAttenuation",value:function(t,e){t.style.isSizeAttenuation?(t.style.rawLineWidth||(t.style.rawLineWidth=t.style.lineWidth),t.style.lineWidth=(t.style.rawLineWidth||1)/e,t.nodeName===j.CIRCLE&&(t.style.rawR||(t.style.rawR=t.style.r),t.style.r=(t.style.rawR||1)/e)):(t.style.rawLineWidth&&(t.style.lineWidth=t.style.rawLineWidth,delete t.style.rawLineWidth),t.nodeName===j.CIRCLE&&t.style.rawR&&(t.style.r=t.style.rawR,delete t.style.rawR));}}]);function nL(t){return t.constructor.PARSED_STYLE_LIST;}var nI=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e4;},[{key:"calculator",value:function(t,e,n,r){return eZ(n);}}]),nD=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r,i){return n instanceof ek&&(n=null),i.sceneGraphService.updateDisplayObjectDependency(t,e,n,r),"clipPath"===t&&r.forEach(function(t){0===t.childNodes.length&&i.sceneGraphService.dirtyToRoot(t);}),n;}}]),n_=(0,R.default)(function t(){(0,C.default)(this,t),this.parser=ez,this.mixer=eH;},[{key:"calculator",value:function(t,e,n,r){return n instanceof ek?"none"===n.value?eM:eA:n;}}]),nG=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n){return n instanceof ek?[]:n;}}]);function nF(t){var e=t.parsedStyle.fontSize;return(0,F.isNil)(e)?null:e;}var nB=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e4;},[{key:"calculator",value:function(t,e,n,r,i){if((0,F.isNumber)(n))return n;if(!eT.isRelativeUnit(n.unit))return n.value;if(n.unit===ea.kPercentage)return 0;if(n.unit===ea.kEms){if(r.parentNode){var a,o=nF(r.parentNode);if(o)return o*n.value;}return 0;}if(n.unit===ea.kRems){if(null!=r&&null!==(a=r.ownerDocument)&&void 0!==a&&a.documentElement){var s=nF(r.ownerDocument.documentElement);if(s)return s*n.value;}return 0;}}}]),nU=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e6;},[{key:"calculator",value:function(t,e,n){return n.map(function(t){return t.value;});}}]),nV=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e6;},[{key:"calculator",value:function(t,e,n){return n.map(function(t){return t.value;});}}]),nz=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){n instanceof ek&&(n=null);var i,a=null===(i=n)||void 0===i?void 0:i.cloneNode(!0);return a&&(a.style.isMarker=!0),a;}}]),nH=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e4;},[{key:"calculator",value:function(t,e,n){return n.value;}}]),nY=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e5(0,1);},[{key:"calculator",value:function(t,e,n){return n.value;}},{key:"postProcessor",value:function(t){var e=t.parsedStyle,n=e.offsetPath,r=e.offsetDistance;if(n){var i=n.nodeName;if(i===j.LINE||i===j.PATH||i===j.POLYLINE){var a=n.getPoint(r);a&&t.setLocalPosition(a.x,a.y);}}}}]),nW=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e5(0,1);},[{key:"calculator",value:function(t,e,n){return n.value;}}]),nq=(0,R.default)(function t(){(0,C.default)(this,t),this.parser=nu,this.mixer=nc;},[{key:"calculator",value:function(t,e,n){return n instanceof ek&&"unset"===n.value?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new tl(0,0,0,0)}:n;}}]),nX=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=nh;}),nj=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).mixer=e5(0,1/0),t;}return(0,I.default)(e,t),(0,R.default)(e);}(nB),n$=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){return n instanceof ek?"unset"===n.value?"":n.value:"".concat(n);}},{key:"postProcessor",value:function(t){t.nodeValue="".concat(t.parsedStyle.text)||"";}}]),nK=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){var i=r.getAttribute("text");if(i){var a=i;"capitalize"===n.value?a=i.charAt(0).toUpperCase()+i.slice(1):"lowercase"===n.value?a=i.toLowerCase():"uppercase"===n.value&&(a=i.toUpperCase()),r.parsedStyle.text=a;}return n.value;}}]);function nZ(t,e){var n=Number(t.parsedStyle.zIndex||0),r=Number(e.parsedStyle.zIndex||0);if(n===r){var i=t.parentNode;if(i){var a=i.childNodes||[];return a.indexOf(t)-a.indexOf(e);}}return n-r;}new WeakMap,"undefined"!=typeof window&&window.document;var nQ={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},nJ="object"==typeof performance&&performance.now?performance:Date;function n0(t){return t.nodeName===j.FRAGMENT||t.getRootNode().nodeName===j.FRAGMENT;}var n1=1,n2="object"==typeof self&&self.self===self?self:"object"==typeof X&&X.global===X?X:{},n3=Date.now(),n4={},n5=Date.now(),n6=function(t){if("function"!=typeof t)throw TypeError("".concat(t," is not a function"));var e=Date.now(),n=e-n5,r=n1++;return n4[r]=t,Object.keys(n4).length>1||setTimeout(function(){n5=e;var t=n4;n4={},Object.keys(t).forEach(function(e){return t[e](n2.performance&&"function"==typeof n2.performance.now?n2.performance.now():Date.now()-n3);});},n>16?0:16-n),r;},n7=function(t){return"string"!=typeof t?n6:""===t?n2.requestAnimationFrame:n2["".concat(t,"RequestAnimationFrame")];},n9=function(t,e){for(var n=0;void 0!==t[n];){if(e(t[n]))return t[n];n+=1;}}(["","webkit","moz","ms","o"],function(t){return!!n7(t);}),n8=n7(n9),rt="string"!=typeof n9?function(t){delete n4[t];}:""===n9?n2.cancelAnimationFrame:n2["".concat(n9,"CancelAnimationFrame")]||n2["".concat(n9,"CancelRequestAnimationFrame")];n2.requestAnimationFrame=n8,n2.cancelAnimationFrame=rt;var re=(0,R.default)(function t(){(0,C.default)(this,t),this.callbacks=[];},[{key:"getCallbacksNum",value:function(){return this.callbacks.length;}},{key:"tapPromise",value:function(t,e){this.callbacks.push(e);}},{key:"promise",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return Promise.all(this.callbacks.map(function(t){return t.apply(void 0,e);}));}}]),rn=(0,R.default)(function t(){(0,C.default)(this,t),this.callbacks=[];},[{key:"tapPromise",value:function(t,e){this.callbacks.push(e);}},{key:"promise",value:(m=(0,Y.default)((0,H.default)().mark(function t(){var e,n,r,i,a=arguments;return(0,H.default)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.callbacks.length){t.next=6;break;}return t.next=1,(e=this.callbacks)[0].apply(e,a);case 1:n=t.sent,r=1;case 2:if(!(r<this.callbacks.length)){t.next=5;break;}return i=this.callbacks[r],t.next=3,i(n);case 3:n=t.sent;case 4:r++,t.next=2;break;case 5:return t.abrupt("return",n);case 6:return t.abrupt("return",null);case 7:case"end":return t.stop();}},t,this);})),function(){return m.apply(this,arguments);})}]),rr=(0,R.default)(function t(){(0,C.default)(this,t),this.callbacks=[];},[{key:"tap",value:function(t,e){this.callbacks.push(e);}},{key:"call",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=arguments;this.callbacks.forEach(function(t){t.apply(void 0,r);});}}]),ri=(0,R.default)(function t(){(0,C.default)(this,t),this.callbacks=[];},[{key:"tap",value:function(t,e){this.callbacks.push(e);}},{key:"call",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];if(this.callbacks.length){for(var r=arguments,i=this.callbacks[0].apply(void 0,r),a=1;a<this.callbacks.length;a++)i=(0,this.callbacks[a])(i);return i;}return null;}}]),ra=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],ro=/([\"\'])[^\'\"]+\1/;function rs(t){var e=t.fontSize,n=t.fontFamily,r=t.fontStyle,i=t.fontVariant,a=t.fontWeight;return{fontSize:void 0===e?16:e,fontFamily:void 0===n?"sans-serif":n,fontStyle:void 0===r?"normal":r,fontVariant:void 0===i?"normal":i,fontWeight:void 0===a?"normal":a};}var rl=ei(function(t){for(var e=rs(t),n=e.fontSize,r=e.fontFamily,i=e.fontStyle,a=e.fontVariant,o=e.fontWeight,s=(0,F.isNumber)(n)&&"".concat(n,"px")||"16px",l=r.split(","),u=l.length-1;u>=0;u--){var c=l[u].trim();!ro.test(c)&&0>ra.indexOf(c)&&(c='"'.concat(c,'"')),l[u]=c;}return"".concat(i," ").concat(a," ").concat(o," ").concat(s," ").concat(l.join(","));},function(t){var e=rs(t),n=e.fontSize,r=e.fontFamily,i=e.fontStyle,a=e.fontVariant,o=e.fontWeight;return"".concat(i,"_").concat(a,"_").concat(o,"_").concat(n,"_").concat(r);}),ru=function(t){return Math.max(t,1e-6);};function rc(t,e,n){return G.mat4.identity(t),t[4]=Math.tan(e),t[1]=Math.tan(n),t;}var rh=G.mat4.create(),rd=G.mat4.create(),rf={scale:function(t){G.mat4.fromScaling(rh,[t[0].value,t[1].value,1].map(function(t){return ru(t);}));},scaleX:function(t){G.mat4.fromScaling(rh,[t[0].value,1,1].map(function(t){return ru(t);}));},scaleY:function(t){G.mat4.fromScaling(rh,[1,t[0].value,1].map(function(t){return ru(t);}));},scaleZ:function(t){G.mat4.fromScaling(rh,[1,1,t[0].value].map(function(t){return ru(t);}));},scale3d:function(t){G.mat4.fromScaling(rh,[t[0].value,t[1].value,t[2].value].map(function(t){return ru(t);}));},translate:function(t){G.mat4.fromTranslation(rh,[t[0].value,t[1].value,0]);},translateX:function(t){G.mat4.fromTranslation(rh,[t[0].value,0,0]);},translateY:function(t){G.mat4.fromTranslation(rh,[0,t[0].value,0]);},translateZ:function(t){G.mat4.fromTranslation(rh,[0,0,t[0].value]);},translate3d:function(t){G.mat4.fromTranslation(rh,[t[0].value,t[1].value,t[2].value]);},rotate:function(t){G.mat4.fromZRotation(rh,eZ(t[0])*tf);},rotateX:function(t){G.mat4.fromXRotation(rh,eZ(t[0])*tf);},rotateY:function(t){G.mat4.fromYRotation(rh,eZ(t[0])*tf);},rotateZ:function(t){G.mat4.fromZRotation(rh,eZ(t[0])*tf);},rotate3d:function(t){G.mat4.fromRotation(rh,eZ(t[3])*tf,[t[0].value,t[1].value,t[2].value]);},skew:function(t){rc(rh,t[0].value*tf,t[1].value*tf);},skewX:function(t){rc(rh,t[0].value*tf,0);},skewY:function(t){rc(rh,0,t[0].value*tf);},matrix:function(t){G.mat4.set(rh,t[0].value,t[1].value,0,0,t[2].value,t[3].value,0,0,0,0,1,0,t[4].value,t[5].value,0,1);},matrix3d:function(t){G.mat4.set.apply(G.mat4,[rh].concat((0,O.default)(t.map(function(t){return t.value;}))));}},rv=G.vec3.fromValues(1,1,1),rp=G.vec3.create(),rg={translate:function(t,e){ir.sceneGraphService.setLocalScale(t,rv,!1),ir.sceneGraphService.setLocalEulerAngles(t,rp,void 0,void 0,!1),ir.sceneGraphService.setLocalPosition(t,[e[0].value,e[1].value,0],!1),ir.sceneGraphService.dirtyLocalTransform(t,t.transformable);}},ry=(0,R.default)(function t(){(0,C.default)(this,t),this.parser=ny,this.mixer=nw;},[{key:"calculator",value:function(t,e,n,r){return n instanceof ek?[]:n;}},{key:"postProcessor",value:function(t){!function(t,e){if(t.length){if(1===t.length&&rg[t[0].t]){rg[t[0].t](e,t[0].d);return;}for(var n=G.mat4.identity(rd),r=0;r<t.length;r++){var i=t[r],a=i.t,o=i.d,s=rf[a];s&&(s(o),G.mat4.mul(n,n,rh));}e.setLocalTransform(n);}else e.resetLocalTransform();e.getLocalTransform();}(t.parsedStyle.transform,t);}}]),rm=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"postProcessor",value:function(t){var e=t.parsedStyle.transformOrigin;e[0].unit===ea.kPixels&&e[1].unit===ea.kPixels?t.setOrigin(e[0].value,e[1].value):t.getGeometryBounds();}}]),rk=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){return n.value;}},{key:"postProcessor",value:function(t){if(t.parentNode){var e=t.parentNode,n=e.renderable,r=e.sortable;n&&e.dirty(),r&&(r.dirty=!0,r.dirtyReason=tC.Z_INDEX_CHANGED);}}}]),rE=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){var n=t.cx,r=t.cy,i=t.r,a=void 0===i?0:i;return{cx:void 0===n?0:n,cy:void 0===r?0:r,hwidth:a,hheight:a};}}]),rx=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){var n=t.cx,r=t.cy,i=t.rx,a=t.ry;return{cx:void 0===n?0:n,cy:void 0===r?0:r,hwidth:void 0===i?0:i,hheight:void 0===a?0:a};}}]),rT=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t){var e=t.x1,n=t.y1,r=t.x2,i=t.y2,a=Math.min(e,r),o=Math.min(n,i),s=(Math.max(e,r)-a)/2,l=(Math.max(n,i)-o)/2;return{cx:a+s,cy:o+l,hwidth:s,hheight:l};}}]),rN=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t){var e=t.d.rect,n=e.x,r=e.y,i=e.width,a=e.height,o=i/2,s=a/2;return{cx:n+o,cy:r+s,hwidth:o,hheight:s};}}]),rb=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t){if(t.points&&(0,F.isArray)(t.points.points)){var e=t.points.points,n=Math.min.apply(Math,(0,O.default)(e.map(function(t){return t[0];}))),r=Math.max.apply(Math,(0,O.default)(e.map(function(t){return t[0];}))),i=Math.min.apply(Math,(0,O.default)(e.map(function(t){return t[1];}))),a=Math.max.apply(Math,(0,O.default)(e.map(function(t){return t[1];}))),o=(r-n)/2,s=(a-i)/2;return{cx:n+o,cy:i+s,hwidth:o,hheight:s};}return{cx:0,cy:0,hwidth:0,hheight:0};}}]),rS=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){var n=t.x,r=t.y,i=t.src,a=t.width,o=t.height,s=void 0===a?0:a,l=void 0===o?0:o;return!i||(0,F.isString)(i)||(s||(s=i.width,t.width=s),l||(l=i.height,t.height=l)),{cx:(void 0===n?0:n)+s/2,cy:(void 0===r?0:r)+l/2,hwidth:s/2,hheight:l/2};}}]),rw=(0,R.default)(function t(e){(0,C.default)(this,t),this.globalRuntime=e;},[{key:"isReadyToMeasure",value:function(t,e){return t.text;}},{key:"update",value:function(t,e){var n,r=t.text,i=t.textAlign,a=void 0===i?"start":i,o=t.lineWidth,s=void 0===o?1:o,l=t.textBaseline,u=void 0===l?"alphabetic":l,c=t.dx,h=void 0===c?0:c,d=t.dy,f=void 0===d?0:d,v=t.x,p=t.y;if(!this.isReadyToMeasure(t,e))return t.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var g=((null==e||null===(n=e.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n?void 0:n.getConfig())||{}).offscreenCanvas,y=this.globalRuntime.textService.measureText(r,t,g);t.metrics=y;var m=y.width,k=y.height,E=m/2,x=k/2,T=(void 0===v?0:v)+E;"center"===a||"middle"===a?T+=s/2-E:("right"===a||"end"===a)&&(T+=s-2*E);var N=(void 0===p?0:p)-x;return"middle"===u?N+=x:"top"===u||"hanging"===u?N+=2*x:"alphabetic"===u||("bottom"===u||"ideographic"===u)&&(N+=0),h&&(T+=h),f&&(N+=f),{cx:T,cy:N,hwidth:E,hheight:x};}}]),rP=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){return{cx:0,cy:0,hwidth:0,hheight:0};}}]),rM=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){var n=t.x,r=t.y,i=t.width,a=void 0===i?0:i,o=t.height,s=void 0===o?0:o;return{cx:(void 0===n?0:n)+a/2,cy:(void 0===r?0:r)+s/2,hwidth:a/2,hheight:s/2};}}]),rA=(0,R.default)(function t(e){(0,C.default)(this,t),this.eventPhase=t.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new ts,this.page=new ts,this.canvas=new ts,this.viewport=new ts,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e;},[{key:"name",get:function(){return this.type;}},{key:"layerX",get:function(){return this.layer.x;}},{key:"layerY",get:function(){return this.layer.y;}},{key:"pageX",get:function(){return this.page.x;}},{key:"pageY",get:function(){return this.page.y;}},{key:"x",get:function(){return this.canvas.x;}},{key:"y",get:function(){return this.canvas.y;}},{key:"canvasX",get:function(){return this.canvas.x;}},{key:"canvasY",get:function(){return this.canvas.y;}},{key:"viewportX",get:function(){return this.viewport.x;}},{key:"viewportY",get:function(){return this.viewport.y;}},{key:"composedPath",value:function(){return this.manager&&(!this.path||this.path[0]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path;}},{key:"propagationPath",get:function(){return this.composedPath();}},{key:"preventDefault",value:function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0;}},{key:"stopImmediatePropagation",value:function(){this.propagationImmediatelyStopped=!0;}},{key:"stopPropagation",value:function(){this.propagationStopped=!0;}},{key:"initEvent",value:function(){}},{key:"initUIEvent",value:function(){}},{key:"clone",value:function(){throw Error(tu);}}]),rC=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).client=new ts,t.movement=new ts,t.offset=new ts,t.global=new ts,t.screen=new ts,t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clientX",get:function(){return this.client.x;}},{key:"clientY",get:function(){return this.client.y;}},{key:"movementX",get:function(){return this.movement.x;}},{key:"movementY",get:function(){return this.movement.y;}},{key:"offsetX",get:function(){return this.offset.x;}},{key:"offsetY",get:function(){return this.offset.y;}},{key:"globalX",get:function(){return this.global.x;}},{key:"globalY",get:function(){return this.global.y;}},{key:"screenX",get:function(){return this.screen.x;}},{key:"screenY",get:function(){return this.screen.y;}},{key:"getModifierState",value:function(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t);}},{key:"initMouseEvent",value:function(){throw Error(tu);}}]);}(rA),rR=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).width=0,t.height=0,t.isPrimary=!1,t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getCoalescedEvents",value:function(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[];}},{key:"getPredictedEvents",value:function(){throw Error("getPredictedEvents is not supported!");}},{key:"clone",value:function(){return this.manager.clonePointerEvent(this);}}]);}(rC),rO=function(t){function e(){return(0,C.default)(this,e),(0,L.default)(this,e,arguments);}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return this.manager.cloneWheelEvent(this);}}]);}(rC),rL=function(t){function e(t,n){var r;return(0,C.default)(this,e),(r=(0,L.default)(this,e,[null])).type=t,r.detail=null==n?void 0:n.detail,!n||"detail"in n||(r.detail=n),Object.assign(r,n),r;}return(0,I.default)(e,t),(0,R.default)(e);}(rA),rI=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).shadow=!1,t.ownerDocument=null,t.isConnected=!1,t.baseURI="",t.childNodes=[],t.nodeType=0,t.nodeName="",t.nodeValue=null,t.mutations=void 0,t.parentNode=null,t.destroyed=!1,t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"textContent",get:function(){var t="";this.nodeName===j.TEXT&&(t+=this.style.text);var e,n=(0,W.default)(this.childNodes);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.nodeName===j.TEXT?t+=r.nodeValue:t+=r.textContent;}}catch(t){n.e(t);}finally{n.f();}return t;},set:function(t){var e=this;this.childNodes.slice().forEach(function(t){e.removeChild(t);}),this.nodeName===j.TEXT&&(this.style.text="".concat(t));}},{key:"getRootNode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.parentNode?this.parentNode.getRootNode(t):t.composed&&this.host?this.host.getRootNode(t):this;}},{key:"hasChildNodes",value:function(){return this.childNodes.length>0;}},{key:"isDefaultNamespace",value:function(t){throw Error(tu);}},{key:"lookupNamespaceURI",value:function(t){throw Error(tu);}},{key:"lookupPrefix",value:function(t){throw Error(tu);}},{key:"normalize",value:function(){throw Error(tu);}},{key:"isEqualNode",value:function(t){return this===t;}},{key:"isSameNode",value:function(t){return this.isEqualNode(t);}},{key:"parent",get:function(){return this.parentNode;}},{key:"parentElement",get:function(){return null;}},{key:"nextSibling",get:function(){return null;}},{key:"previousSibling",get:function(){return null;}},{key:"firstChild",get:function(){return this.childNodes.length>0?this.childNodes[0]:null;}},{key:"lastChild",get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null;}},{key:"compareDocumentPosition",value:function(t){if(t===this)return 0;for(var n,r=t,i=this,a=[r],o=[i];null!==(n=r.parentNode)&&void 0!==n?n:i.parentNode;)r=r.parentNode?(a.push(r.parentNode),r.parentNode):r,i=i.parentNode?(o.push(i.parentNode),i.parentNode):i;if(r!==i)return e.DOCUMENT_POSITION_DISCONNECTED|e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|e.DOCUMENT_POSITION_PRECEDING;var s=a.length>o.length?a:o,l=s===a?o:a;if(s[s.length-l.length]===l[0])return s===a?e.DOCUMENT_POSITION_CONTAINED_BY|e.DOCUMENT_POSITION_FOLLOWING:e.DOCUMENT_POSITION_CONTAINS|e.DOCUMENT_POSITION_PRECEDING;for(var u=s.length-l.length,c=l.length-1;c>=0;c--){var h=l[c],d=s[u+c];if(d!==h){var f=h.parentNode.childNodes;if(f.indexOf(h)<f.indexOf(d)){if(l===a)return e.DOCUMENT_POSITION_PRECEDING;return e.DOCUMENT_POSITION_FOLLOWING;}if(s===a)return e.DOCUMENT_POSITION_PRECEDING;break;}}return e.DOCUMENT_POSITION_FOLLOWING;}},{key:"contain",value:function(t){return this.contains(t);}},{key:"contains",value:function(t){for(var e=t;e&&this!==e;)e=e.parentNode;return!!e;}},{key:"getAncestor",value:function(t){for(var e=this;t>0&&e;)e=e.parentNode,t--;return e;}},{key:"forEach",value:function(t){for(var e=[this];e.length>0;){var n=e.pop();if(!1===t(n))break;for(var r=n.childNodes.length-1;r>=0;r--)e.push(n.childNodes[r]);}}}],[{key:"isNode",value:function(t){return!!t.childNodes;}}]);}((0,R.default)(function t(){(0,C.default)(this,t),this.emitter=new _.default;},[{key:"on",value:function(t,e,n){return this.addEventListener(t,e,n),this;}},{key:"addEventListener",value:function(t,e,n){var r=!1,i=!1;if((0,F.isBoolean)(n))r=n;else if(n){var a=n.capture;r=void 0!==a&&a;var o=n.once;i=void 0!==o&&o;}r&&(t+="capture"),e=(0,F.isFunction)(e)?e:e.handleEvent;var s=(0,F.isFunction)(e)?void 0:e;return i?this.emitter.once(t,e,s):this.emitter.on(t,e,s),this;}},{key:"off",value:function(t,e,n){return t?this.removeEventListener(t,e,n):this.removeAllEventListeners(),this;}},{key:"removeAllEventListeners",value:function(){var t;null===(t=this.emitter)||void 0===t||t.removeAllListeners();}},{key:"removeEventListener",value:function(t,e,n){if(!this.emitter)return this;((0,F.isBoolean)(n)?n:null==n?void 0:n.capture)&&(t+="capture"),e=(0,F.isFunction)(e)?e:null===(r=e)||void 0===r?void 0:r.handleEvent;var r,i=(0,F.isFunction)(e)?void 0:e;return this.emitter.off(t,e,i),this;}},{key:"emit",value:function(t,e){this.dispatchEvent(new rL(t,e));}},{key:"dispatchEventToSelf",value:function(t){t.target||(t.target=this),t.currentTarget=this,this.emitter.emit(t.type,t);}},{key:"dispatchEvent",value:function(t){var e,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0;if(i)return this.dispatchEventToSelf(t),!0;if(e=this.document?this:this.defaultView?this.defaultView:null===(n=this.ownerDocument)||void 0===n?void 0:n.defaultView){if(t.manager=e.getEventService(),!t.manager)return!1;t.defaultPrevented=!1,t.path?t.path.length=0:t.page=[],r||(t.target=this),t.manager.dispatchEvent(t,t.type,r);}else this.dispatchEventToSelf(t);return!t.defaultPrevented;}}]));rI.DOCUMENT_POSITION_DISCONNECTED=1,rI.DOCUMENT_POSITION_PRECEDING=2,rI.DOCUMENT_POSITION_FOLLOWING=4,rI.DOCUMENT_POSITION_CONTAINS=8,rI.DOCUMENT_POSITION_CONTAINED_BY=16,rI.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32,(0,R.default)(function t(e,n){var r=this;(0,C.default)(this,t),this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=G.mat4.create(),this.tmpVec3=G.vec3.create(),this.onPointerDown=function(t){var e=r.createPointerEvent(t);if(r.dispatchEvent(e,"pointerdown"),"touch"===e.pointerType)r.dispatchEvent(e,"touchstart");else if("mouse"===e.pointerType||"pen"===e.pointerType){var n=2===e.button;r.dispatchEvent(e,n?"rightdown":"mousedown");}r.trackingData(t.pointerId).pressTargetsByButton[t.button]=e.composedPath(),r.freeEvent(e);},this.onPointerUp=function(t){var e=nJ.now(),n=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);if(r.dispatchEvent(n,"pointerup"),"touch"===n.pointerType)r.dispatchEvent(n,"touchend");else if("mouse"===n.pointerType||"pen"===n.pointerType){var i=2===n.button;r.dispatchEvent(n,i?"rightup":"mouseup");}var a=r.trackingData(t.pointerId),o=r.findMountedTarget(a.pressTargetsByButton[t.button]),s=o;if(o&&!n.composedPath().includes(o)){for(var l=o;l&&!n.composedPath().includes(l);){if(n.currentTarget=l,r.notifyTarget(n,"pointerupoutside"),"touch"===n.pointerType)r.notifyTarget(n,"touchendoutside");else if("mouse"===n.pointerType||"pen"===n.pointerType){var u=2===n.button;r.notifyTarget(n,u?"rightupoutside":"mouseupoutside");}rI.isNode(l)&&(l=l.parentNode);}delete a.pressTargetsByButton[t.button],s=l;}if(s){var c,h=r.clonePointerEvent(n,"click");h.target=s,h.path=[],a.clicksByButton[t.button]||(a.clicksByButton[t.button]={clickCount:0,target:h.target,timeStamp:e});var d=r.context.renderingContext.root.ownerDocument.defaultView,f=a.clicksByButton[t.button];f.target===h.target&&e-f.timeStamp<d.getConfig().dblClickSpeed?++f.clickCount:f.clickCount=1,f.target=h.target,f.timeStamp=e,h.detail=f.clickCount,null!==(c=n.detail)&&void 0!==c&&c.preventClick||(r.context.config.useNativeClickEvent||"mouse"!==h.pointerType&&"touch"!==h.pointerType||r.dispatchEvent(h,"click"),r.dispatchEvent(h,"pointertap")),r.freeEvent(h);}r.freeEvent(n);},this.onPointerMove=function(t){var e=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0),n="mouse"===e.pointerType||"pen"===e.pointerType,i=r.trackingData(t.pointerId),a=r.findMountedTarget(i.overTargets);if(i.overTargets&&a!==e.target){var o="mousemove"===t.type?"mouseout":"pointerout",s=r.createPointerEvent(t,o,a||void 0);if(r.dispatchEvent(s,"pointerout"),n&&r.dispatchEvent(s,"mouseout"),!e.composedPath().includes(a)){var l=r.createPointerEvent(t,"pointerleave",a||void 0);for(l.eventPhase=l.AT_TARGET;l.target&&!e.composedPath().includes(l.target);)l.currentTarget=l.target,r.notifyTarget(l),n&&r.notifyTarget(l,"mouseleave"),rI.isNode(l.target)&&(l.target=l.target.parentNode);r.freeEvent(l);}r.freeEvent(s);}if(a!==e.target){var u="mousemove"===t.type?"mouseover":"pointerover",c=r.clonePointerEvent(e,u);r.dispatchEvent(c,"pointerover"),n&&r.dispatchEvent(c,"mouseover");for(var h=a&&rI.isNode(a)&&a.parentNode;h&&h!==(rI.isNode(r.rootTarget)&&r.rootTarget.parentNode)&&h!==e.target;)h=h.parentNode;if(!h||h===(rI.isNode(r.rootTarget)&&r.rootTarget.parentNode)){var d=r.clonePointerEvent(e,"pointerenter");for(d.eventPhase=d.AT_TARGET;d.target&&d.target!==a&&d.target!==(rI.isNode(r.rootTarget)&&r.rootTarget.parentNode);)d.currentTarget=d.target,r.notifyTarget(d),n&&r.notifyTarget(d,"mouseenter"),rI.isNode(d.target)&&(d.target=d.target.parentNode);r.freeEvent(d);}r.freeEvent(c);}r.dispatchEvent(e,"pointermove"),"touch"===e.pointerType&&r.dispatchEvent(e,"touchmove"),n&&(r.dispatchEvent(e,"mousemove"),r.cursor=r.getCursor(e.target)),i.overTargets=e.composedPath(),r.freeEvent(e);},this.onPointerOut=function(t){var e=r.trackingData(t.pointerId);if(e.overTargets){var n="mouse"===t.pointerType||"pen"===t.pointerType,i=r.findMountedTarget(e.overTargets),a=r.createPointerEvent(t,"pointerout",i||void 0);r.dispatchEvent(a),n&&r.dispatchEvent(a,"mouseout");var o=r.createPointerEvent(t,"pointerleave",i||void 0);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==(rI.isNode(r.rootTarget)&&r.rootTarget.parentNode);)o.currentTarget=o.target,r.notifyTarget(o),n&&r.notifyTarget(o,"mouseleave"),rI.isNode(o.target)&&(o.target=o.target.parentNode);e.overTargets=null,r.freeEvent(a),r.freeEvent(o);}r.cursor=null;},this.onPointerOver=function(t){var e=r.trackingData(t.pointerId),n=r.createPointerEvent(t),i="mouse"===n.pointerType||"pen"===n.pointerType;r.dispatchEvent(n,"pointerover"),i&&r.dispatchEvent(n,"mouseover"),"mouse"===n.pointerType&&(r.cursor=r.getCursor(n.target));var a=r.clonePointerEvent(n,"pointerenter");for(a.eventPhase=a.AT_TARGET;a.target&&a.target!==(rI.isNode(r.rootTarget)&&r.rootTarget.parentNode);)a.currentTarget=a.target,r.notifyTarget(a),i&&r.notifyTarget(a,"mouseenter"),rI.isNode(a.target)&&(a.target=a.target.parentNode);e.overTargets=n.composedPath(),r.freeEvent(n),r.freeEvent(a);},this.onPointerUpOutside=function(t){var e=r.trackingData(t.pointerId),n=r.findMountedTarget(e.pressTargetsByButton[t.button]),i=r.createPointerEvent(t);if(n){for(var a=n;a;)i.currentTarget=a,r.notifyTarget(i,"pointerupoutside"),"touch"===i.pointerType||("mouse"===i.pointerType||"pen"===i.pointerType)&&r.notifyTarget(i,2===i.button?"rightupoutside":"mouseupoutside"),rI.isNode(a)&&(a=a.parentNode);delete e.pressTargetsByButton[t.button];}r.freeEvent(i);},this.onWheel=function(t){var e=r.createWheelEvent(t);r.dispatchEvent(e),r.freeEvent(e);},this.onClick=function(t){if(r.context.config.useNativeClickEvent){var e=r.createPointerEvent(t);r.dispatchEvent(e),r.freeEvent(e);}},this.onPointerCancel=function(t){var e=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);r.dispatchEvent(e),r.freeEvent(e);},this.globalRuntime=e,this.context=n;},[{key:"init",value:function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick);}},{key:"destroy",value:function(){this.mappingTable={},this.mappingState={},this.eventPool.clear();}},{key:"getScale",value:function(){var t=this.context.contextService.getBoundingClientRect(),e=1,n=1,r=this.context.contextService.getDomElement();if(r&&t){var i=r.offsetWidth,a=r.offsetHeight;i&&a&&(e=t.width/i,n=t.height/a);}return{scaleX:e,scaleY:n,bbox:t};}},{key:"client2Viewport",value:function(t){var e=this.getScale(),n=e.scaleX,r=e.scaleY,i=e.bbox;return new ts((t.x-((null==i?void 0:i.left)||0))/n,(t.y-((null==i?void 0:i.top)||0))/r);}},{key:"viewport2Client",value:function(t){var e=this.getScale(),n=e.scaleX,r=e.scaleY,i=e.bbox;return new ts((t.x+((null==i?void 0:i.left)||0))*n,(t.y+((null==i?void 0:i.top)||0))*r);}},{key:"viewport2Canvas",value:function(t){var e=t.x,n=t.y,r=this.rootTarget.defaultView.getCamera(),i=this.context.config,a=i.width,o=i.height,s=r.getPerspectiveInverse(),l=r.getWorldTransform(),u=G.mat4.multiply(this.tmpMatrix,l,s),c=G.vec3.set(this.tmpVec3,e/a*2-1,(1-n/o)*2-1,0);return G.vec3.transformMat4(c,c,u),new ts(c[0],c[1]);}},{key:"canvas2Viewport",value:function(t){var e=this.rootTarget.defaultView.getCamera(),n=e.getPerspective(),r=e.getViewTransform(),i=G.mat4.multiply(this.tmpMatrix,n,r),a=G.vec3.set(this.tmpVec3,t.x,t.y,0);G.vec3.transformMat4(this.tmpVec3,this.tmpVec3,i);var o=this.context.config,s=o.width,l=o.height;return new ts((a[0]+1)/2*s,(1-(a[1]+1)/2)*l);}},{key:"setPickHandler",value:function(t){this.pickHandler=t;}},{key:"addEventMapping",value:function(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort(function(t,e){return t.priority-e.priority;});}},{key:"mapEvent",value:function(t){if(this.rootTarget){var e=this.mappingTable[t.type];if(e)for(var n=0,r=e.length;n<r;n++)e[n].fn(t);else console.warn("[EventService]: Event mapping not defined for ".concat(t.type));}}},{key:"dispatchEvent",value:function(t,e,n){if(n){t.eventPhase=t.AT_TARGET;var r=this.rootTarget.defaultView||null;t.currentTarget=r,this.notifyListeners(t,e);}else t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e);}},{key:"propagate",value:function(t,e){if(t.target){var n=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(var r=n.length-1;r>=1;r--)if(t.currentTarget=n[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!t.propagationStopped&&!t.propagationImmediatelyStopped){var i=n.indexOf(t.currentTarget);t.eventPhase=t.BUBBLING_PHASE;for(var a=i+1;a<n.length;a++)if(t.currentTarget=n[a],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;}}}},{key:"propagationPath",value:function(t){var e=[t],n=this.rootTarget.defaultView||null;if(n&&n===t)return e.unshift(n.document),e;for(var r=0;r<2048&&t!==this.rootTarget;r++)rI.isNode(t)&&t.parentNode&&(e.push(t.parentNode),t=t.parentNode);return n&&e.push(n),e;}},{key:"hitTest",value:function(t){var e=t.viewportX,n=t.viewportY,r=this.context.config,i=r.width,a=r.height,o=r.disableHitTesting;return e<0||n<0||e>i||n>a?null:!o&&this.pickHandler(t)||this.rootTarget||null;}},{key:"isNativeEventFromCanvas",value:function(t,e){var n,r=null==e?void 0:e.target;if(null!==(n=r)&&void 0!==n&&n.shadowRoot&&(r=e.composedPath()[0]),r){if(r===t)return!0;if(t&&t.contains)return t.contains(r);}return null!=e&&!!e.composedPath&&e.composedPath().indexOf(t)>-1;}},{key:"getExistedHTML",value:function(t){if(t.nativeEvent.composedPath)for(var e=0,n=t.nativeEvent.composedPath();e<n.length;e++){var r=n[e],i=this.nativeHTMLMap.get(r);if(i)return i;}return null;}},{key:"pickTarget",value:function(t){return this.hitTest({clientX:t.clientX,clientY:t.clientY,viewportX:t.viewportX,viewportY:t.viewportY,x:t.canvasX,y:t.canvasY});}},{key:"createPointerEvent",value:function(t,e,n,r){var i=this.allocateEvent(rR);this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.nativeEvent=t.nativeEvent,i.originalEvent=t;var a=this.getExistedHTML(i),o=this.context.contextService.getDomElement();return i.target=null!=n?n:a||this.isNativeEventFromCanvas(o,i.nativeEvent)&&this.pickTarget(i)||r,"string"==typeof e&&(i.type=e),i;}},{key:"createWheelEvent",value:function(t){var e=this.allocateEvent(rO);this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t;var n=this.getExistedHTML(e),r=this.context.contextService.getDomElement();return e.target=n||this.isNativeEventFromCanvas(r,e.nativeEvent)&&this.pickTarget(e),e;}},{key:"trackingData",value:function(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t];}},{key:"cloneWheelEvent",value:function(t){var e=this.allocateEvent(rO);return e.nativeEvent=t.nativeEvent,e.originalEvent=t.originalEvent,this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.target=t.target,e.path=t.composedPath().slice(),e.type=t.type,e;}},{key:"clonePointerEvent",value:function(t,e){var n=this.allocateEvent(rR);return n.nativeEvent=t.nativeEvent,n.originalEvent=t.originalEvent,this.copyPointerData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.target=t.target,n.path=t.composedPath().slice(),n.type=null!=e?e:n.type,n;}},{key:"copyPointerData",value:function(t,e){e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist;}},{key:"copyMouseData",value:function(t,e){e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey,e.client.copyFrom(t.client),e.movement.copyFrom(t.movement),e.canvas.copyFrom(t.canvas),e.screen.copyFrom(t.screen),e.global.copyFrom(t.global),e.offset.copyFrom(t.offset);}},{key:"copyWheelData",value:function(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;}},{key:"copyData",value:function(t,e){e.isTrusted=t.isTrusted,e.timeStamp=nJ.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.page.copyFrom(t.page),e.viewport.copyFrom(t.viewport);}},{key:"allocateEvent",value:function(t){this.eventPool.has(t)||this.eventPool.set(t,[]);var e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=[],e.target=null,e;}},{key:"freeEvent",value:function(t){if(t.manager!==this)throw Error("It is illegal to free an event not managed by this EventBoundary!");var e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t);}},{key:"notifyTarget",value:function(t,e){e=null!=e?e:t.type;var n=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?"".concat(e,"capture"):e;this.notifyListeners(t,n),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e);}},{key:"notifyListeners",value:function(t,e){var n=t.currentTarget.emitter,r=n._events[e];if(r){if("fn"in r)r.once&&n.removeListener(e,r.fn,void 0,!0),r.fn.call(t.currentTarget||r.context,t);else for(var i=0;i<r.length&&!t.propagationImmediatelyStopped;i++)r[i].once&&n.removeListener(e,r[i].fn,void 0,!0),r[i].fn.call(t.currentTarget||r[i].context,t);}}},{key:"findMountedTarget",value:function(t){if(!t)return null;for(var e=t[t.length-1],n=t.length-2;n>=0;n--){var r=t[n];if(r===this.rootTarget||rI.isNode(r)&&r.parentNode===e)e=t[n];else break;}return e;}},{key:"getCursor",value:function(t){for(var e=t;e;){var n=!!e.getAttribute&&e.getAttribute("cursor");if(n)return n;e=rI.isNode(e)&&e.parentNode;}}}]);var rD=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"getOrCreateCanvas",value:function(t,e){if(this.canvas)return this.canvas;if(t||ir.offscreenCanvas)this.canvas=t||ir.offscreenCanvas,this.context=this.canvas.getContext("2d",(0,A.default)({willReadFrequently:!0},e));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",(0,A.default)({willReadFrequently:!0},e)),this.context&&this.context.measureText||(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"));}catch(t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",(0,A.default)({willReadFrequently:!0},e));}return this.canvas.width=10,this.canvas.height=10,this.canvas;}},{key:"getOrCreateContext",value:function(t,e){return this.context||this.getOrCreateCanvas(t,e),this.context;}}],[{key:"createCanvas",value:function(){try{return new window.OffscreenCanvas(0,0);}catch(t){}try{return document.createElement("canvas");}catch(t){}return null;}}]),r_=((k={})[k.CAMERA_CHANGED=0]="CAMERA_CHANGED",k[k.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",k[k.NONE=2]="NONE",k);(0,R.default)(function t(e,n){(0,C.default)(this,t),this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new rr,initAsync:new re,dirtycheck:new ri,cull:new ri,beginFrame:new rr,beforeRender:new rr,render:new rr,afterRender:new rr,endFrame:new rr,destroy:new rr,pick:new rn,pickSync:new ri,pointerDown:new rr,pointerUp:new rr,pointerMove:new rr,pointerOut:new rr,pointerOver:new rr,pointerWheel:new rr,pointerCancel:new rr,click:new rr},this.globalRuntime=e,this.context=n;},[{key:"init",value:function(t){var e=this,n=(0,A.default)((0,A.default)({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach(function(t){t.apply(n,e.globalRuntime);}),this.hooks.init.call(),0===this.hooks.initAsync.getCallbacksNum()?(this.inited=!0,t()):this.hooks.initAsync.promise().then(function(){e.inited=!0,t();}).catch(function(t){});}},{key:"getStats",value:function(){return this.stats;}},{key:"disableDirtyRectangleRendering",value:function(){return!this.context.config.renderer.getConfig().enableDirtyRectangleRendering||this.context.renderingContext.renderReasons.has(r_.CAMERA_CHANGED);}},{key:"render",value:function(t,e,n){var r=this,i=t.getConfig(),a=this.context.renderingContext;if(this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0,this.globalRuntime.sceneGraphService.syncHierarchy(a.root),this.globalRuntime.sceneGraphService.notifyMutationObservers(t),a.renderReasons.size&&this.inited){a.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var o=1===a.renderReasons.size&&a.renderReasons.has(r_.CAMERA_CHANGED),s=!i.disableRenderHooks||!o;s&&this.renderDisplayObject(a.root,i,a),this.hooks.beginFrame.call(e),s&&a.renderListCurrentFrame.forEach(function(t){r.hooks.beforeRender.call(t),r.hooks.render.call(t),r.hooks.afterRender.call(t);}),this.hooks.endFrame.call(e),a.renderListCurrentFrame=[],a.renderReasons.clear(),n();}}},{key:"renderDisplayObject",value:function(t,e,n){for(var r=this,i=e.renderer.getConfig(),a=i.enableDirtyCheck,o=i.enableCulling,s=[t];s.length>0;){var l,u=s.pop();!function(t){var e=t.renderable,i=t.sortable,s=a?e.dirty||n.dirtyRectangleRenderingDisabled?t:null:t,l=null;s&&(l=o?r.hooks.cull.call(s,r.context.camera):s)&&(r.stats.rendered+=1,n.renderListCurrentFrame.push(l)),t.dirty(!1),i.renderOrder=r.zIndexCounter,r.zIndexCounter+=1,r.stats.total+=1,i.dirty&&(r.sort(t,i),i.dirty=!1,i.dirtyChildren=[],i.dirtyReason=void 0);}(u);for(var c=(null===(l=u.sortable)||void 0===l||null===(l=l.sorted)||void 0===l?void 0:l.length)>0?u.sortable.sorted:u.childNodes,h=c.length-1;h>=0;h--)s.push(c[h]);}}},{key:"sort",value:function(t,e){var n,r;(null==e||null===(n=e.sorted)||void 0===n?void 0:n.length)>0&&e.dirtyReason!==tC.Z_INDEX_CHANGED?e.dirtyChildren.forEach(function(n){var r=e.sorted.indexOf(n);if(r>-1&&e.sorted.splice(r,1),t.childNodes.indexOf(n)>-1){if(0===e.sorted.length)e.sorted.push(n);else{var i=function(t,e){for(var n=0,r=t.length;n<r;){var i=n+r>>>1;0>nZ(t[i],e)?n=i+1:r=i;}return n;}(e.sorted,n);e.sorted.splice(i,0,n);}}}):e.sorted=t.childNodes.slice().sort(nZ),(null===(r=e.sorted)||void 0===r?void 0:r.length)>0&&0===t.childNodes.filter(function(t){return t.parsedStyle.zIndex;}).length&&(e.sorted=[]);}},{key:"destroy",value:function(){this.inited=!1,this.hooks.destroy.call();}},{key:"dirty",value:function(){this.context.renderingContext.renderReasons.add(r_.DISPLAY_OBJECT_CHANGED);}}]);var rG=/\[\s*(.*)=(.*)\s*\]/,rF=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"selectOne",value:function(t,e){var n=this;if(t.startsWith("."))return e.find(function(e){return((null==e?void 0:e.classList)||[]).indexOf(n.getIdOrClassname(t))>-1;});if(t.startsWith("#"))return e.find(function(e){return e.id===n.getIdOrClassname(t);});if(t.startsWith("[")){var r=this.getAttribute(t),i=r.name,a=r.value;return i?e.find(function(t){return e!==t&&("name"===i?t.name===a:n.attributeToString(t,i)===a);}):null;}return e.find(function(n){return e!==n&&n.nodeName===t;});}},{key:"selectAll",value:function(t,e){var n=this;if(t.startsWith("."))return e.findAll(function(r){return e!==r&&((null==r?void 0:r.classList)||[]).indexOf(n.getIdOrClassname(t))>-1;});if(t.startsWith("#"))return e.findAll(function(r){return e!==r&&r.id===n.getIdOrClassname(t);});if(t.startsWith("[")){var r=this.getAttribute(t),i=r.name,a=r.value;return i?e.findAll(function(t){return e!==t&&("name"===i?t.name===a:n.attributeToString(t,i)===a);}):[];}return e.findAll(function(n){return e!==n&&n.nodeName===t;});}},{key:"is",value:function(t,e){if(t.startsWith("."))return e.className===this.getIdOrClassname(t);if(t.startsWith("#"))return e.id===this.getIdOrClassname(t);if(t.startsWith("[")){var n=this.getAttribute(t),r=n.name,i=n.value;return"name"===r?e.name===i:this.attributeToString(e,r)===i;}return e.nodeName===t;}},{key:"getIdOrClassname",value:function(t){return t.substring(1);}},{key:"getAttribute",value:function(t){var e=t.match(rG),n="",r="";return e&&e.length>2&&(n=e[1].replace(/"/g,""),r=e[2].replace(/"/g,"")),{name:n,value:r};}},{key:"attributeToString",value:function(t,e){if(!t.getAttribute)return"";var n=t.getAttribute(e);return(0,F.isNil)(n)?"":n.toString?n.toString():"";}}]),rB=((E={}).ATTR_MODIFIED="DOMAttrModified",E.INSERTED="DOMNodeInserted",E.MOUNTED="DOMNodeInsertedIntoDocument",E.REMOVED="removed",E.UNMOUNTED="DOMNodeRemovedFromDocument",E.REPARENT="reparent",E.DESTROY="destroy",E.BOUNDS_CHANGED="bounds-changed",E.CULLED="culled",E),rU=function(t){function e(t,n,r,i,a,o,s,l){var u;return(0,C.default)(this,e),(u=(0,L.default)(this,e,[null])).relatedNode=n,u.prevValue=r,u.newValue=i,u.attrName=a,u.attrChange=o,u.prevParsedValue=s,u.newParsedValue=l,u.type=t,u;}return(0,I.default)(e,t),(0,R.default)(e);}(rA);rU.ADDITION=2,rU.MODIFICATION=1,rU.REMOVAL=3;var rV=new rU(rB.REPARENT,null,"","","",0,"",""),rz=G.vec2.create(),rH=G.vec3.create(),rY=G.vec3.fromValues(1,1,1),rW=G.mat4.create(),rq=G.vec2.create(),rX=G.vec3.create(),rj=G.mat4.create(),r$=G.quat.create(),rK=G.vec3.create(),rZ=G.quat.create(),rQ=G.vec3.create(),rJ=G.vec3.create(),r0=G.vec3.create(),r1=G.mat4.create(),r2=G.quat.create(),r3=G.quat.create(),r4=G.quat.create(),r5=(0,R.default)(function t(e){(0,C.default)(this,t),this.displayObjectDependencyMap=new WeakMap,this.runtime=e;},[{key:"matches",value:function(t,e){return this.runtime.sceneGraphSelector.is(t,e);}},{key:"querySelector",value:function(t,e){return this.runtime.sceneGraphSelector.selectOne(t,e);}},{key:"querySelectorAll",value:function(t,e){return this.runtime.sceneGraphSelector.selectAll(t,e);}},{key:"attach",value:function(t,e,n){var r=!1;t.parentNode&&(r=t.parentNode!==e,this.detach(t));var i=t.nodeName===j.FRAGMENT,a=n0(e);t.parentNode=e;var o=i?t.childNodes:[t];(0,F.isNumber)(n)?o.forEach(function(t){e.childNodes.splice(n,0,t),t.parentNode=e;}):o.forEach(function(t){e.childNodes.push(t),t.parentNode=e;});var s=e.sortable;if((null!=s&&null!==(u=s.sorted)&&void 0!==u&&u.length||s.dirty||t.parsedStyle.zIndex)&&(-1===s.dirtyChildren.indexOf(t)&&s.dirtyChildren.push(t),s.dirty=!0,s.dirtyReason=tC.ADDED),!a){if(i)this.dirtyFragment(t);else{var l=t.transformable;l&&this.dirtyWorldTransform(t,l);}if(r){var u,c,h=(null===(c=e.ownerDocument)||void 0===c||null===(c=c.defaultView)||void 0===c||null===(c=c.getConfig())||void 0===c||null===(c=c.future)||void 0===c?void 0:c.experimentalCancelEventPropagation)===!0;t.dispatchEvent(rV,h,h);}}}},{key:"detach",value:function(t){if(t.parentNode){var e,n,r=t.transformable,i=t.parentNode.sortable;(null!=i&&null!==(e=i.sorted)&&void 0!==e&&e.length||null!==(n=t.style)&&void 0!==n&&n.zIndex)&&(-1===i.dirtyChildren.indexOf(t)&&i.dirtyChildren.push(t),i.dirty=!0,i.dirtyReason=tC.REMOVED);var a=t.parentNode.childNodes.indexOf(t);a>-1&&t.parentNode.childNodes.splice(a,1),r&&this.dirtyWorldTransform(t,r),t.parentNode=null;}}},{key:"getLocalPosition",value:function(t){return t.transformable.localPosition;}},{key:"getLocalRotation",value:function(t){return t.transformable.localRotation;}},{key:"getLocalScale",value:function(t){return t.transformable.localScale;}},{key:"getLocalSkew",value:function(t){return t.transformable.localSkew;}},{key:"getLocalTransform",value:function(t){var e=t.transformable;return tI(e),e.localTransform;}},{key:"setLocalPosition",value:function(t,e){var n,r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=t.transformable;rJ[0]=e[0],rJ[1]=e[1],rJ[2]=null!==(n=e[2])&&void 0!==n?n:0,!G.vec3.equals(i.localPosition,rJ)&&(G.vec3.copy(i.localPosition,rJ),r&&this.dirtyLocalTransform(t,i));}},{key:"translateLocal",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var i=t.transformable;G.vec3.equals(e,rH)||(G.vec3.transformQuat(e,e,i.localRotation),G.vec3.add(i.localPosition,i.localPosition,e),this.dirtyLocalTransform(t,i));}},{key:"setLocalRotation",value:function(t,e,n,r,i){var a=!(arguments.length>5)||void 0===arguments[5]||arguments[5];"number"==typeof e&&(e=G.quat.set(r$,e,n,r,i));var o=t.transformable;G.quat.copy(o.localRotation,e),a&&this.dirtyLocalTransform(t,o);}},{key:"rotateLocal",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var i=t.transformable;G.quat.fromEuler(r3,e[0],e[1],e[2]),G.quat.mul(i.localRotation,i.localRotation,r3),this.dirtyLocalTransform(t,i);}},{key:"setLocalScale",value:function(t,e){var n,r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=t.transformable;G.vec3.set(rX,e[0],e[1],null!==(n=e[2])&&void 0!==n?n:i.localScale[2]),!G.vec3.equals(rX,i.localScale)&&(G.vec3.copy(i.localScale,rX),r&&this.dirtyLocalTransform(t,i));}},{key:"scaleLocal",value:function(t,e){var n,r=t.transformable;G.vec3.multiply(r.localScale,r.localScale,G.vec3.set(rX,e[0],e[1],null!==(n=e[2])&&void 0!==n?n:1)),this.dirtyLocalTransform(t,r);}},{key:"setLocalSkew",value:function(t,e,n){var r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];"number"==typeof e&&(e=G.vec2.set(rq,e,n));var i=t.transformable;G.vec2.copy(i.localSkew,e),r&&this.dirtyLocalTransform(t,i);}},{key:"setLocalEulerAngles",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=!(arguments.length>4)||void 0===arguments[4]||arguments[4];"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var a=t.transformable;G.quat.fromEuler(a.localRotation,e[0],e[1],e[2]),i&&this.dirtyLocalTransform(t,a);}},{key:"setLocalTransform",value:function(t,e){var n=G.mat4.getTranslation(rK,e),r=G.mat4.getRotation(rZ,e),i=G.mat4.getScaling(rQ,e);this.setLocalScale(t,i,!1),this.setLocalPosition(t,n,!1),this.setLocalRotation(t,r,void 0,void 0,void 0,!1),this.dirtyLocalTransform(t,t.transformable);}},{key:"resetLocalTransform",value:function(t){this.setLocalScale(t,rY,!1),this.setLocalPosition(t,rH,!1),this.setLocalEulerAngles(t,rH,void 0,void 0,!1),this.setLocalSkew(t,rz,void 0,!1),this.dirtyLocalTransform(t,t.transformable);}},{key:"getPosition",value:function(t){var e=t.transformable;return G.mat4.getTranslation(e.position,this.getWorldTransform(t,e));}},{key:"getRotation",value:function(t){var e=t.transformable;return G.mat4.getRotation(e.rotation,this.getWorldTransform(t,e));}},{key:"getScale",value:function(t){var e=t.transformable;return G.mat4.getScaling(e.scaling,this.getWorldTransform(t,e));}},{key:"getOrigin",value:function(t){return t.getGeometryBounds(),t.transformable.origin;}},{key:"getWorldTransform",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.transformable;return(e.localDirtyFlag||e.dirtyFlag)&&(t.parentNode&&t.parentNode.transformable&&this.getWorldTransform(t.parentNode),this.internalUpdateTransform(t)),e.worldTransform;}},{key:"setPosition",value:function(t,e){var n,r=t.transformable;if(r0[0]=e[0],r0[1]=e[1],r0[2]=null!==(n=e[2])&&void 0!==n?n:0,!G.vec3.equals(this.getPosition(t),r0)){if(G.vec3.copy(r.position,r0),null!==t.parentNode&&t.parentNode.transformable){var i=t.parentNode.transformable;G.mat4.copy(r1,i.worldTransform),G.mat4.invert(r1,r1),G.vec3.transformMat4(r.localPosition,r0,r1);}else G.vec3.copy(r.localPosition,r0);this.dirtyLocalTransform(t,r);}}},{key:"translate",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.set(rX,e,n,r)),G.vec3.equals(e,rH)||(G.vec3.add(rX,this.getPosition(t),e),this.setPosition(t,rX));}},{key:"setRotation",value:function(t,e,n,r,i){var a=t.transformable;if("number"==typeof e&&(e=G.quat.fromValues(e,n,r,i)),null!==t.parentNode&&t.parentNode.transformable){var o=this.getRotation(t.parentNode);G.quat.copy(r$,o),G.quat.invert(r$,r$),G.quat.multiply(a.localRotation,r$,e),G.quat.normalize(a.localRotation,a.localRotation),this.dirtyLocalTransform(t,a);}else this.setLocalRotation(t,e);}},{key:"rotate",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var i=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){G.quat.fromEuler(r$,e[0],e[1],e[2]);var a=this.getRotation(t),o=this.getRotation(t.parentNode);G.quat.copy(r4,o),G.quat.invert(r4,r4),G.quat.multiply(r$,r4,r$),G.quat.multiply(i.localRotation,r$,a),G.quat.normalize(i.localRotation,i.localRotation),this.dirtyLocalTransform(t,i);}else this.rotateLocal(t,e);}},{key:"setOrigin",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=[e,n,r]);var i=t.transformable;if(e[0]!==i.origin[0]||e[1]!==i.origin[1]||e[2]!==i.origin[2]){var a=i.origin;a[0]=e[0],a[1]=e[1],a[2]=e[2]||0,this.dirtyLocalTransform(t,i);}}},{key:"setEulerAngles",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var i=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){G.quat.fromEuler(i.localRotation,e[0],e[1],e[2]);var a=this.getRotation(t.parentNode);G.quat.copy(r2,G.quat.invert(r$,a)),G.quat.mul(i.localRotation,i.localRotation,r2),this.dirtyLocalTransform(t,i);}else this.setLocalEulerAngles(t,e);}},{key:"getGeometryBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.geometry;return n.dirty&&ir.styleValueRegistry.updateGeometry(t),(e?n.renderBounds:n.contentBounds||null)||new tr;}},{key:"getTransformedGeometryBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this.getGeometryBounds(t,e);if(!tr.isEmpty(r)){var i=n||new tr;return i.setFromTransformedAABB(r,this.getWorldTransform(t)),i;}return null;}},{key:"getBounds",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t.renderable;if(!r.boundsDirty&&!n&&r.bounds)return r.bounds;if(!r.renderBoundsDirty&&n&&r.renderBounds)return r.renderBounds;var i=n?r.renderBounds:r.bounds,a=this.getTransformedGeometryBounds(t,n,i);if(t.childNodes.forEach(function(t){var r=e.getBounds(t,n);r&&(a?a.add(r):(a=i||new tr).update(r.center,r.halfExtents));}),a||(a=new tr),n){var o=function(t){var e,n=t;do{if(null===(e=n.parsedStyle)||void 0===e?void 0:e.clipPath)return n;n=n.parentElement;}while(null!==n)return null;}(t);if(o){var s=o.parsedStyle.clipPath.getBounds(n);a?s&&(a=s.intersection(a)):a.update(s.center,s.halfExtents);}}return n?(r.renderBounds=a,r.renderBoundsDirty=!1):(r.bounds=a,r.boundsDirty=!1),a;}},{key:"getLocalBounds",value:function(t){if(t.parentNode){var e=rW;t.parentNode.transformable&&(e=G.mat4.invert(rj,this.getWorldTransform(t.parentNode)));var n=this.getBounds(t);if(!tr.isEmpty(n)){var r=new tr;return r.setFromTransformedAABB(n,e),r;}}return this.getBounds(t);}},{key:"getBoundingClientRect",value:function(t){var e,n,r=this.getGeometryBounds(t);tr.isEmpty(r)||(n=new tr).setFromTransformedAABB(r,this.getWorldTransform(t));var i=null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e?void 0:e.getContextService().getBoundingClientRect();if(n){var a=n.getMin(),o=(0,D.default)(a,2),s=o[0],l=o[1],u=n.getMax(),c=(0,D.default)(u,2),h=c[0],d=c[1];return new tl(s+((null==i?void 0:i.left)||0),l+((null==i?void 0:i.top)||0),h-s,d-l);}return new tl((null==i?void 0:i.left)||0,(null==i?void 0:i.top)||0,0,0);}},{key:"internalUpdateTransform",value:function(t){var e,n,r=null===(n=t.parentNode)||void 0===n?void 0:n.transformable;tI(t.transformable),(e=t.transformable).dirtyFlag&&(r?G.mat4.multiply(e.worldTransform,r.worldTransform,e.localTransform):G.mat4.copy(e.worldTransform,e.localTransform),e.dirtyFlag=!1);}},{key:"internalUpdateElement",value:function(t,e){var n=(null===(s=t.ownerDocument)||void 0===s||null===(s=s.defaultView)||void 0===s||null===(s=s.getConfig())||void 0===s||null===(s=s.future)||void 0===s?void 0:s.experimentalAttributeUpdateOptimization)===!0,r=e[e.length-1],i=(null==r?void 0:r.transformDirty)||(null===(l=t.transformable)||void 0===l?void 0:l.localDirtyFlag);t.transformable&&((h=t.transformable).dirtyFlag||(h.dirtyFlag=i)),this.internalUpdateTransform(t),i&&(null===(d=t.dirty)||void 0===d||d.call(t,!0,!0));var a=(null===(u=t.renderable)||void 0===u?void 0:u.boundsDirty)||(null===(c=t.renderable)||void 0===c?void 0:c.renderBoundsDirty);if((i||a)&&(null==r?void 0:r.shapeUpdated)===!1&&n)for(var o=e.length-1;o>=0;){var s,l,u,c,h,d,f,v,p=e[o];if(p.shapeUpdated)break;null===(f=(v=p.node).dirty)||void 0===f||f.call(v,!0,!0),p.shapeUpdated=!0,o-=1;}return i;}},{key:"syncHierarchy",value:function(t){for(var e,n,r=[t],i=t.parentNode?[{node:t.parentNode,transformDirty:(null===(e=t.parentNode.transformable)||void 0===e?void 0:e.localDirtyFlag)||(null===(n=t.parentNode.transformable)||void 0===n?void 0:n.dirtyFlag),shapeUpdated:!1}]:[];r.length>0;){for(var a=r.pop(),o=i[i.length-1];i.length>0&&a.parentNode!==o.node;)o=i.pop();var s=this.internalUpdateElement(a,i);if(a.childNodes.length>0){for(var l=a.childNodes.length-1;l>=0;l--)r.push(a.childNodes[l]);i.push({node:a,transformDirty:s,shapeUpdated:!1});}}}},{key:"dirtyLocalTransform",value:function(t,e){n0(t)||e.localDirtyFlag||(e.localDirtyFlag=!0,e.dirtyFlag||this.dirtyWorldTransform(t,e));}},{key:"dirtyWorldTransform",value:function(t,e){this.dirtyWorldInternal(t,e),this.dirtyToRoot(t,!0);}},{key:"dirtyWorldInternal",value:function(t,e){var n,r=this,i=(null===(n=t.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n||null===(n=n.getConfig())||void 0===n||null===(n=n.future)||void 0===n?void 0:n.experimentalAttributeUpdateOptimization)===!0;e.dirtyFlag||(e.dirtyFlag=!0,t.dirty(!0,!0),i||t.childNodes.forEach(function(t){var e=t.transformable;r.dirtyWorldInternal(t,e);}));}},{key:"dirtyToRoot",value:function(t){for(var e,n,r,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=t,o=(null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig())||void 0===e||null===(e=e.future)||void 0===e?void 0:e.experimentalAttributeUpdateOptimization)===!0;a&&(null===(n=(r=a).dirty)||void 0===n||n.call(r,!0,!0),!o);)a=a.parentNode;i&&t.forEach(function(t){var e;null===(e=t.dirty)||void 0===e||e.call(t,!0,!0);}),this.informDependentDisplayObjects(t);var s=t.mutations||[],l=s.find(function(t){return"attributes"===t.type&&t._boundsChangeData;});l?l._boundsChangeData={affectChildren:l._boundsChangeData.affectChildren||i}:(l={type:"attributes",target:t,_boundsChangeData:{affectChildren:i}},s.push(l)),t.mutations=s;}},{key:"dirtyFragment",value:function(t){var e,n=t.transformable;n&&(n.dirtyFlag=!0,n.localDirtyFlag=!0),null===(e=t.dirty)||void 0===e||e.call(t,!0,!0);for(var r=t.childNodes.length,i=0;i<r;i++)this.dirtyFragment(t.childNodes[i]);}},{key:"notifyMutationObservers",value:function(t){var e=new Set;if(t.getRoot().forEach(function(t){(t.mutations||[]).forEach(function(n){"attributes"===n.type&&n._boundsChangeData&&(n._boundsChangeData.affectChildren?t.forEach(function(t){var r=(0,A.default)({},n);r.target=t,e.add(r);}):e.add(n));}),t.mutations=void 0;}),e.size>0){var n=new rL(rB.BOUNDS_CHANGED,{detail:Array.from(e)});t.dispatchEvent(n,!0,!0);}}},{key:"updateDisplayObjectDependency",value:function(t,e,n,r){if(e&&e!==n){var i=this.displayObjectDependencyMap.get(e);if(i&&i[t]){var a=i[t].indexOf(r);i[t].splice(a,1);}}if(n){var o=this.displayObjectDependencyMap.get(n);o||(this.displayObjectDependencyMap.set(n,{}),o=this.displayObjectDependencyMap.get(n)),o[t]||(o[t]=[]),o[t].push(r);}}},{key:"informDependentDisplayObjects",value:function(t){var e,n=this,r=this.displayObjectDependencyMap.get(t);if(r){var i=null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig())||void 0===e||null===(e=e.future)||void 0===e?void 0:e.experimentalCancelEventPropagation;Object.keys(r).forEach(function(t){r[t].forEach(function(e){n.dirtyToRoot(e,!0),e.dispatchEvent(new rU(rB.ATTR_MODIFIED,e,n,n,t,rU.MODIFICATION,n,n),i,i),e.isCustomElement&&e.isConnected&&e.attributeChangedCallback&&e.attributeChangedCallback(t,n,n);});});}}}]),r6=(0,R.default)(function t(e){if((0,C.default)(this,t),e<=0)throw Error("LRU capacity must be a positive number.");this.capacity=e,this.cache=new Map;},[{key:"get",value:function(t){if(this.cache.has(t)){var e=this.cache.get(t);return this.cache.delete(t),this.cache.set(t,e),e;}}},{key:"put",value:function(t,e){if(this.cache.has(t)&&this.cache.delete(t),this.cache.set(t,e),this.cache.size>this.capacity){var n=this.cache.keys().next().value;this.cache.delete(n);}}},{key:"len",value:function(){return this.cache.size;}},{key:"clear",value:function(){this.cache.clear();}}]),r7={MetricsString:"|\xc9q\xc5",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},r9=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,r8=new RegExp("".concat(/[!%),.:;?\]}'""]/.source,"|").concat(/[!),.:;?\]}'""]/.source,"|").concat(/[)\]'"?!:;,.]/.source,"|").concat(/[!%),.:;?\]}'"]/.source)),it=new RegExp("".concat(/[$('"]/.source,"|").concat(/[([{'"]/.source,"|").concat(/[(['"...]/.source,"|").concat(/[$([{'"#]/.source)),ie=(0,R.default)(function t(e){var n=this;(0,C.default)(this,t),this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(t,e){return!n.isBreakingSpace(e)&&!!(t&&(it.exec(e)||r8.exec(t)));},this.trimByKinsokuShorui=function(t){var e=(0,O.default)(t),n=e[e.length-2];if(!n)return t;var r=n[n.length-1];return e[e.length-2]=n.slice(0,-1),e[e.length-1]=r+e[e.length-1],e;},this.runtime=e,this.charWidthCache=new r6(100);},[{key:"measureFont",value:function(t,e){if(this.fontMetricsCache[t])return this.fontMetricsCache[t];var n={ascent:0,descent:0,fontSize:0},r=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(e),i=this.runtime.offscreenCanvasCreator.getOrCreateContext(e,{willReadFrequently:!0});i.font=t;var a=r7.MetricsString+r7.BaselineSymbol,o=Math.ceil(i.measureText(a).width),s=Math.ceil(i.measureText(r7.BaselineSymbol).width),l=r7.HeightMultiplier*s;s=s*r7.BaselineMultiplier|0,r.width=o,r.height=l,i.fillStyle="#f00",i.fillRect(0,0,o,l),i.font=t,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(a,0,s);var u=i.getImageData(0,0,o||1,l||1).data,c=u.length,h=4*o,d=0,f=0,v=!1;for(d=0;d<s;++d){for(var p=0;p<h;p+=4)if(255!==u[f+p]){v=!0;break;}if(v)break;f+=h;}for(n.ascent=s-d,f=c-h,v=!1,d=l;d>s;--d){for(var g=0;g<h;g+=4)if(255!==u[f+g]){v=!0;break;}if(v)break;f-=h;}return n.descent=d-s,n.fontSize=n.ascent+n.descent,this.fontMetricsCache[t]=n,n;}},{key:"measureText",value:function(t,e,n){var r=e.fontSize,i=void 0===r?16:r,a=e.wordWrap,o=e.lineHeight,s=e.lineWidth,l=void 0===s?1:s,u=e.textBaseline,c=void 0===u?"alphabetic":u,h=e.textAlign,d=void 0===h?"start":h,f=e.letterSpacing,v=void 0===f?0:f,p=e.textPath;e.textPathSide,e.textPathStartOffset;var g=e.leading,y=void 0===g?0:g,m=rl(e),k=this.measureFont(m,n);0===k.fontSize&&(k.fontSize=i,k.ascent=i);var E=this.runtime.offscreenCanvasCreator.getOrCreateContext(n);E.font=m,e.isOverflowing=!1;var x=(void 0!==a&&a?this.wordWrap(t,e,n):t).split(/(?:\r\n|\r|\n)/),T=Array(x.length),N=0;if(p){p.getTotalLength();for(var b=0;b<x.length;b++)E.measureText(x[b]).width,x[b].length;}else{for(var S=0;S<x.length;S++){var w=E.measureText(x[S]).width+(x[S].length-1)*v;T[S]=w,N=Math.max(N,w);}var P=N+l,M=o||k.fontSize+l,A=Math.max(M,k.fontSize+l)+(x.length-1)*(M+y);M+=y;var C=0;return"middle"===c?C=-A/2:"bottom"===c||"alphabetic"===c||"ideographic"===c?C=-A:("top"===c||"hanging"===c)&&(C=0),{font:m,width:P,height:A,lines:x,lineWidths:T,lineHeight:M,maxLineWidth:N,fontProperties:k,lineMetrics:T.map(function(t,e){var n=0;return"center"===d||"middle"===d?n-=t/2:("right"===d||"end"===d)&&(n-=t),new tl(n-l/2,C+e*M,t+l,M);})};}}},{key:"wordWrap",value:function(t,e,n){var r=this,i=Array.from(t);if(0===i.length)return"";var a=this,o=e.wordWrapWidth,s=e.letterSpacing,l=void 0===s?0:s,u=e.maxLines,c=void 0===u?1/0:u,h=e.textOverflow,d=this.runtime.offscreenCanvasCreator.getOrCreateContext(n),f=(void 0===o?0:o)+l,v="";"ellipsis"===h?v="...":h&&"clip"!==h&&(v=h);var p=[""],g=0,y=0,m=-1,k=rl(e),E=this.charWidthCache.get(k);E||(E=new r6(500),this.charWidthCache.put(k,E));var x=function(t){return r.getFromCache(t,l,E,d);},T=x(v);function N(t,e,n,r){for(;x(t)<r&&e<i.length-1&&!a.isNewline(i[e+1]);)e+=1,t+=i[e];for(;x(t)>r&&e>=n;)e-=1,t=t.slice(0,-1);return{lineTxt:t,txtLastCharIndex:e};}function b(t,e){if(!(T<=0)&&!(T>f)){if(!p[t]){p[t]=v;return;}var n=N(p[t],e,m+1,f-T);p[t]=n.lineTxt+v;}}for(var S=0;S<i.length;S++){var w=i[S],P=i[S-1],M=i[S+1],A=x(w);if(this.isNewline(w)){if(g+1>=c){S<i.length-1&&b(g,S-1),e.isOverflowing=!0;break;}m=S-1,y=0,p[g+=1]="";continue;}if(A>f){b(g,S-1),e.isOverflowing=!0;break;}if(y>0&&y+A>f){var C=N(p[g],S-1,m+1,f);if(C.txtLastCharIndex!==S-1){if(p[g]=C.lineTxt,C.txtLastCharIndex===i.length-1)break;w=i[S=C.txtLastCharIndex+1],P=i[S-1],M=i[S+1],A=x(w);}if(g+1>=c){b(g,S-1),e.isOverflowing=!0;break;}if(m=S-1,y=0,p[g+=1]="",this.isBreakingSpace(w))continue;this.canBreakInLastChar(w)||(p=this.trimToBreakable(p),y=this.sumTextWidthByCache(p[g]||"",x)),this.shouldBreakByKinsokuShorui(w,M)&&(p=this.trimByKinsokuShorui(p),y+=x(P||""));}y+=A,p[g]+=w;}return p.join("\n");}},{key:"isBreakingSpace",value:function(t){return"string"==typeof t&&r7.BreakingSpaces.indexOf(t.charCodeAt(0))>=0;}},{key:"isNewline",value:function(t){return"string"==typeof t&&r7.Newlines.indexOf(t.charCodeAt(0))>=0;}},{key:"trimToBreakable",value:function(t){var e=(0,O.default)(t),n=e[e.length-2],r=this.findBreakableIndex(n);if(-1===r||!n)return e;var i=n.slice(r,r+1),a=this.isBreakingSpace(i);return e[e.length-1]+=n.slice(r+1,n.length),e[e.length-2]=n.slice(0,r+(a?0:1)),e;}},{key:"canBreakInLastChar",value:function(t){return!(t&&r9.test(t));}},{key:"sumTextWidthByCache",value:function(t,e){return t.split("").reduce(function(t,n){return t+e(n);},0);}},{key:"findBreakableIndex",value:function(t){for(var e=t.length-1;e>=0;e--)if(!r9.test(t[e]))return e;return -1;}},{key:"getFromCache",value:function(t,e,n,r){var i=n.get(t);if("number"!=typeof i){var a=t.length*e;i=r.measureText(t).width+a,n.put(t,i);}return i;}},{key:"clearCache",value:function(){this.fontMetricsCache={},this.charWidthCache.clear();}}]),ir={},ii=(T=new rS,N=new rb,x={},(0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)(x,j.FRAGMENT,null),j.CIRCLE,new rE),j.ELLIPSE,new rx),j.RECT,T),j.IMAGE,T),j.GROUP,new rP),j.LINE,new rT),j.TEXT,new rw(ir)),j.POLYLINE,N),j.POLYGON,N),(0,B.default)((0,B.default)((0,B.default)(x,j.PATH,new rN),j.HTML,new rM),j.MESH,null)),ia=(S=new n_,w=new nB,b={},(0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)(b,t_.PERCENTAGE,null),t_.NUMBER,new nH),t_.ANGLE,new nI),t_.DEFINED_PATH,new nD),t_.PAINT,S),t_.COLOR,S),t_.FILTER,new nG),t_.LENGTH,w),t_.LENGTH_PERCENTAGE,w),t_.LENGTH_PERCENTAGE_12,new nU),(0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)(b,t_.LENGTH_PERCENTAGE_14,new nV),t_.COORDINATE,new nB),t_.OFFSET_DISTANCE,new nY),t_.OPACITY_VALUE,new nW),t_.PATH,new nq),t_.LIST_OF_POINTS,new nX),t_.SHADOW_BLUR,new nj),t_.TEXT,new n$),t_.TEXT_TRANSFORM,new nK),t_.TRANSFORM,new ry),(0,B.default)((0,B.default)((0,B.default)(b,t_.TRANSFORM_ORIGIN,new rm),t_.Z_INDEX,new rk),t_.MARKER,new nz));ir.CameraContribution=tM,ir.AnimationTimeline=null,ir.EasingFunction=null,ir.offscreenCanvasCreator=new rD,ir.sceneGraphSelector=new rF,ir.sceneGraphService=new r5(ir),ir.textService=new ie(ir),ir.geometryUpdaterFactory=ii,ir.CSSPropertySyntaxFactory=ia,ir.styleValueRegistry=new nO(ir),ir.layoutRegistry=null,ir.globalThis="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==X?X:{},ir.enableStyleSyntax=!0,ir.enableSizeAttenuation=!1;var io=0,is=new rU(rB.INSERTED,null,"","","",0,"",""),il=new rU(rB.REMOVED,null,"","","",0,"",""),iu=new rL(rB.DESTROY),ic=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).entity=io++,t.transformable={dirtyFlag:!1,localDirtyFlag:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},t.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},t.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},t.cullable={strategy:tA.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},t.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},t.rBushNode={aabb:void 0},t.namespaceURI="g",t.scrollLeft=0,t.scrollTop=0,t.clientTop=0,t.clientLeft=0,t.style={},t.computedStyle={},t.parsedStyle={},t.attributes={},t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"dirty",value:function(){var t=!(arguments.length>0)||void 0===arguments[0]||arguments[0],e=arguments.length>1?arguments[1]:void 0;this.renderable.dirty=t,void 0!==e&&(this.renderable.boundsDirty=e,this.renderable.renderBoundsDirty=e,this.geometry.dirty=e);}},{key:"className",get:function(){return this.getAttribute("class")||"";},set:function(t){this.setAttribute("class",t);}},{key:"classList",get:function(){return this.className.split(" ").filter(function(t){return""!==t;});}},{key:"tagName",get:function(){return this.nodeName;}},{key:"children",get:function(){return this.childNodes;}},{key:"childElementCount",get:function(){return this.childNodes.length;}},{key:"firstElementChild",get:function(){return this.firstChild;}},{key:"lastElementChild",get:function(){return this.lastChild;}},{key:"parentElement",get:function(){return this.parentNode;}},{key:"nextSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t+1]||null;}return null;}},{key:"previousSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t-1]||null;}return null;}},{key:"cloneNode",value:function(t){throw Error(tu);}},{key:"appendChild",value:function(t,e){var n;if(t.destroyed)throw Error("Cannot append a destroyed element.");return ir.sceneGraphService.attach(t,this,e),null!==(n=this.ownerDocument)&&void 0!==n&&n.defaultView&&(n0(this)||t.nodeName!==j.FRAGMENT?this.ownerDocument.defaultView.mountChildren(t):this.ownerDocument.defaultView.mountFragment(t)),this.isMutationObserved&&(is.relatedNode=this,t.dispatchEvent(is)),t;}},{key:"insertBefore",value:function(t,e){if(e){t.parentElement&&t.parentElement.removeChild(t);var n=this.childNodes.indexOf(e);-1===n?this.appendChild(t):this.appendChild(t,n);}else this.appendChild(t);return t;}},{key:"replaceChild",value:function(t,e){var n=this.childNodes.indexOf(e);return this.removeChild(e),this.appendChild(t,n),e;}},{key:"removeChild",value:function(t){var e,n,r=(null===(e=this.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig().future)||void 0===e?void 0:e.experimentalCancelEventPropagation)===!0;return il.relatedNode=this,t.dispatchEvent(il,r,r),null!==(n=t.ownerDocument)&&void 0!==n&&n.defaultView&&t.ownerDocument.defaultView.unmountChildren(t),ir.sceneGraphService.detach(t),t;}},{key:"removeChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var e=this.childNodes[t];this.removeChild(e);}}},{key:"destroyChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var e=this.childNodes[t];e.childNodes.length>0&&e.destroyChildren(),e.destroy();}}},{key:"matches",value:function(t){return ir.sceneGraphService.matches(t,this);}},{key:"getElementById",value:function(t){return ir.sceneGraphService.querySelector("#".concat(t),this);}},{key:"getElementsByName",value:function(t){return ir.sceneGraphService.querySelectorAll('[name="'.concat(t,'"]'),this);}},{key:"getElementsByClassName",value:function(t){return ir.sceneGraphService.querySelectorAll(".".concat(t),this);}},{key:"getElementsByTagName",value:function(t){return ir.sceneGraphService.querySelectorAll(t,this);}},{key:"querySelector",value:function(t){return ir.sceneGraphService.querySelector(t,this);}},{key:"querySelectorAll",value:function(t){return ir.sceneGraphService.querySelectorAll(t,this);}},{key:"closest",value:function(t){var e=this;do{if(ir.sceneGraphService.matches(t,e))return e;e=e.parentElement;}while(null!==e)return null;}},{key:"find",value:function(t){var e=this,n=null;return this.forEach(function(r){return!(r!==e&&t(r))||(n=r,!1);}),n;}},{key:"findAll",value:function(t){var e=this,n=[];return this.forEach(function(r){r!==e&&t(r)&&n.push(r);}),n;}},{key:"after",value:function(){var t=this;if(this.parentNode){for(var e=this.parentNode.childNodes.indexOf(this),n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];r.forEach(function(n,r){var i;return null===(i=t.parentNode)||void 0===i?void 0:i.appendChild(n,e+r+1);});}}},{key:"before",value:function(){if(this.parentNode){for(var t=this.parentNode.childNodes.indexOf(this),e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n[0],a=(0,V.default)(n).slice(1);this.parentNode.appendChild(i,t),i.after.apply(i,(0,O.default)(a));}}},{key:"replaceWith",value:function(){this.after.apply(this,arguments),this.remove();}},{key:"append",value:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(function(e){return t.appendChild(e);});}},{key:"prepend",value:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(function(e,n){return t.appendChild(e,n);});}},{key:"replaceChildren",value:function(){for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,arguments);}},{key:"remove",value:function(){return this.parentNode?this.parentNode.removeChild(this):this;}},{key:"destroy",value:function(){var t,e=(null===(t=this.ownerDocument)||void 0===t||null===(t=t.defaultView)||void 0===t||null===(t=t.getConfig().future)||void 0===t?void 0:t.experimentalCancelEventPropagation)===!0;this.destroyChildren(),this.dispatchEvent(iu,e,e),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0;}},{key:"getGeometryBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return ir.sceneGraphService.getGeometryBounds(this,t);}},{key:"getTransformedGeometryBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return ir.sceneGraphService.getTransformedGeometryBounds(this,t);}},{key:"getBounds",value:function(){return ir.sceneGraphService.getBounds(this);}},{key:"getRenderBounds",value:function(){return ir.sceneGraphService.getBounds(this,!0);}},{key:"getLocalBounds",value:function(){return ir.sceneGraphService.getLocalBounds(this);}},{key:"getBoundingClientRect",value:function(){return ir.sceneGraphService.getBoundingClientRect(this);}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()];}},{key:"computedStyleMap",value:function(){return new Map(Object.entries(this.computedStyle));}},{key:"getAttributeNames",value:function(){return Object.keys(this.attributes);}},{key:"getAttribute",value:function(t){if("symbol"!=typeof t)return this.attributes[t];}},{key:"hasAttribute",value:function(t){return this.getAttributeNames().includes(t);}},{key:"hasAttributes",value:function(){return!!this.getAttributeNames().length;}},{key:"removeAttribute",value:function(t){this.setAttribute(t,null),delete this.attributes[t];}},{key:"setAttribute",value:function(t,e){this.attributes[t]=e;}},{key:"getAttributeNS",value:function(t,e){throw Error(tu);}},{key:"getAttributeNode",value:function(t){throw Error(tu);}},{key:"getAttributeNodeNS",value:function(t,e){throw Error(tu);}},{key:"hasAttributeNS",value:function(t,e){throw Error(tu);}},{key:"removeAttributeNS",value:function(t,e){throw Error(tu);}},{key:"removeAttributeNode",value:function(t){throw Error(tu);}},{key:"setAttributeNS",value:function(t,e,n){throw Error(tu);}},{key:"setAttributeNode",value:function(t){throw Error(tu);}},{key:"setAttributeNodeNS",value:function(t){throw Error(tu);}},{key:"toggleAttribute",value:function(t,e){throw Error(tu);}}]);}(rI);function ih(t){return!!(null!=t&&t.nodeName);}var id=ir.globalThis.Proxy?ir.globalThis.Proxy:function(){},iv=new rU(rB.ATTR_MODIFIED,null,null,null,null,rU.MODIFICATION,null,null),ip=G.vec3.create(),ig=G.quat.create(),iy=function(t){function e(t){var n;return(0,C.default)(this,e),(n=(0,L.default)(this,e)).isCustomElement=!1,n.isMutationObserved=!1,n.activeAnimations=[],n.config=t,n.id=t.id||"",n.name=t.name||"",(t.className||t.class)&&(n.className=t.className||t.class),n.nodeName=t.type||j.GROUP,t.initialParsedStyle&&Object.assign(n.parsedStyle,t.initialParsedStyle),n.initAttributes(t.style),ir.enableStyleSyntax&&(n.style=new id({setProperty:function(t,e){n.setAttribute(t,e);},getPropertyValue:function(t){return n.getAttribute(t);},removeProperty:function(t){n.removeAttribute(t);},item:function(){return"";}},{get:function(t,e){return void 0!==t[e]?t[e]:n.getAttribute(e);},set:function(t,e,r){return n.setAttribute(e,r),!0;}})),n;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"destroy",value:function(){(0,U.default)(e,"destroy",this,3)([]),this.getAnimations().forEach(function(t){t.cancel();});}},{key:"cloneNode",value:function(t,e){var n=(0,A.default)({},this.attributes);for(var r in n){var i=n[r];ih(i)&&"clipPath"!==r&&"offsetPath"!==r&&"textPath"!==r&&(n[r]=i.cloneNode(t)),e&&(n[r]=e(r,i));}var a=new this.constructor((0,A.default)((0,A.default)({},this.config),{},{style:n}));return a.setLocalTransform(this.getLocalTransform()),t&&this.children.forEach(function(e){if(!e.style.isMarker){var n=e.cloneNode(t);a.appendChild(n);}}),a;}},{key:"initAttributes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ir.styleValueRegistry.processProperties(this,t,{forceUpdateGeometry:!0}),this.dirty();}},{key:"setAttribute",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!(arguments.length>3)||void 0===arguments[3]||arguments[3];!(0,F.isUndefined)(n)&&(r||n!==this.attributes[t])&&(this.internalSetAttribute(t,n,{memoize:i}),(0,U.default)(e,"setAttribute",this,3)([t,n]));}},{key:"internalSetAttribute",value:function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.attributes[t],a=this.parsedStyle[t];ir.styleValueRegistry.processProperties(this,(0,B.default)({},t,e),r),this.dirty();var o=this.parsedStyle[t];if(this.isConnected){if(iv.relatedNode=this,iv.prevValue=i,iv.newValue=e,iv.attrName=t,iv.prevParsedValue=a,iv.newParsedValue=o,this.isMutationObserved)this.dispatchEvent(iv);else{var s,l=(null===(s=this.ownerDocument.defaultView.getConfig().future)||void 0===s?void 0:s.experimentalCancelEventPropagation)===!0;iv.target=this,this.ownerDocument.defaultView.dispatchEvent(iv,!0,l);}}(this.isCustomElement&&this.isConnected||!this.isCustomElement)&&(null===(n=this.attributeChangedCallback)||void 0===n||n.call(this,t,i,e,a,o));}},{key:"getBBox",value:function(){var t=this.getBounds(),e=t.getMin(),n=(0,D.default)(e,2),r=n[0],i=n[1],a=t.getMax(),o=(0,D.default)(a,2);return new tl(r,i,o[0]-r,o[1]-i);}},{key:"setOrigin",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ir.sceneGraphService.setOrigin(this,td(t,e,n,!1)),this;}},{key:"getOrigin",value:function(){return ir.sceneGraphService.getOrigin(this);}},{key:"setPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ir.sceneGraphService.setPosition(this,td(t,e,n,!1)),this;}},{key:"setLocalPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ir.sceneGraphService.setLocalPosition(this,td(t,e,n,!1)),this;}},{key:"translate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ir.sceneGraphService.translate(this,td(t,e,n,!1)),this;}},{key:"translateLocal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ir.sceneGraphService.translateLocal(this,td(t,e,n,!1)),this;}},{key:"getPosition",value:function(){return ir.sceneGraphService.getPosition(this);}},{key:"getLocalPosition",value:function(){return ir.sceneGraphService.getLocalPosition(this);}},{key:"scale",value:function(t,e,n){return this.scaleLocal(t,e,n);}},{key:"scaleLocal",value:function(t,e,n){return"number"==typeof t&&(e=e||t,n=n||t,t=td(t,e,n,!1)),ir.sceneGraphService.scaleLocal(this,t),this;}},{key:"setLocalScale",value:function(t,e,n){return"number"==typeof t&&(e=e||t,n=n||t,t=td(t,e,n,!1)),ir.sceneGraphService.setLocalScale(this,t),this;}},{key:"getLocalScale",value:function(){return ir.sceneGraphService.getLocalScale(this);}},{key:"getScale",value:function(){return ir.sceneGraphService.getScale(this);}},{key:"getEulerAngles",value:function(){var t=tg(ip,ir.sceneGraphService.getWorldTransform(this));return(0,D.default)(t,3)[2]*tv;}},{key:"getLocalEulerAngles",value:function(){var t=tg(ip,ir.sceneGraphService.getLocalRotation(this));return(0,D.default)(t,3)[2]*tv;}},{key:"setEulerAngles",value:function(t){return ir.sceneGraphService.setEulerAngles(this,0,0,t),this;}},{key:"setLocalEulerAngles",value:function(t){return ir.sceneGraphService.setLocalEulerAngles(this,0,0,t),this;}},{key:"rotateLocal",value:function(t,e,n){return(0,F.isNil)(e)&&(0,F.isNil)(n)?ir.sceneGraphService.rotateLocal(this,0,0,t):ir.sceneGraphService.rotateLocal(this,t,e,n),this;}},{key:"rotate",value:function(t,e,n){return(0,F.isNil)(e)&&(0,F.isNil)(n)?ir.sceneGraphService.rotate(this,0,0,t):ir.sceneGraphService.rotate(this,t,e,n),this;}},{key:"setRotation",value:function(t,e,n,r){return ir.sceneGraphService.setRotation(this,t,e,n,r),this;}},{key:"setLocalRotation",value:function(t,e,n,r){return ir.sceneGraphService.setLocalRotation(this,t,e,n,r),this;}},{key:"setLocalSkew",value:function(t,e){return ir.sceneGraphService.setLocalSkew(this,t,e),this;}},{key:"getRotation",value:function(){return ir.sceneGraphService.getRotation(this);}},{key:"getLocalRotation",value:function(){return ir.sceneGraphService.getLocalRotation(this);}},{key:"getLocalSkew",value:function(){return ir.sceneGraphService.getLocalSkew(this);}},{key:"getLocalTransform",value:function(){return ir.sceneGraphService.getLocalTransform(this);}},{key:"getWorldTransform",value:function(){return ir.sceneGraphService.getWorldTransform(this);}},{key:"setLocalTransform",value:function(t){return ir.sceneGraphService.setLocalTransform(this,t),this;}},{key:"resetLocalTransform",value:function(){ir.sceneGraphService.resetLocalTransform(this);}},{key:"getAnimations",value:function(){return this.activeAnimations;}},{key:"animate",value:function(t,e){var n,r=null===(n=this.ownerDocument)||void 0===n?void 0:n.timeline;return r?r.play(this,t,e):null;}},{key:"isVisible",value:function(){var t;return(null===(t=this.parsedStyle)||void 0===t?void 0:t.visibility)!=="hidden";}},{key:"interactive",get:function(){return this.isInteractive();},set:function(t){this.style.pointerEvents=t?"auto":"none";}},{key:"isInteractive",value:function(){var t;return(null===(t=this.parsedStyle)||void 0===t?void 0:t.pointerEvents)!=="none";}},{key:"isCulled",value:function(){return!!(this.cullable&&this.cullable.enable&&!this.cullable.visible);}},{key:"toFront",value:function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,(0,O.default)(this.parentNode.children.map(function(t){return Number(t.style.zIndex);})))+1),this;}},{key:"toBack",value:function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,(0,O.default)(this.parentNode.children.map(function(t){return Number(t.style.zIndex);})))-1),this;}},{key:"getConfig",value:function(){return this.config;}},{key:"attr",value:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n[0],a=n[1];return i?(0,F.isObject)(i)?(Object.keys(i).forEach(function(e){t.setAttribute(e,i[e]);}),this):2===n.length?(this.setAttribute(i,a),this):this.attributes[i]:this.attributes;}},{key:"getMatrix",value:function(t){var e,n,r,i=t||this.getWorldTransform(),a=G.mat4.getTranslation(ip,i),o=(0,D.default)(a,2),s=o[0],l=o[1],u=G.mat4.getScaling(ip,i),c=(0,D.default)(u,2),h=c[0],d=c[1],f=tg(ip,G.mat4.getRotation(ig,i)),v=(0,D.default)(f,3),p=v[0],g=v[2];return n=Math.cos(e=p||g),r=Math.sin(e),G.mat3.fromValues(h*n,d*r,0,-h*r,d*n,0,s,l,1);}},{key:"getLocalMatrix",value:function(){return this.getMatrix(this.getLocalTransform());}},{key:"setMatrix",value:function(t){var e=ty(t),n=(0,D.default)(e,5),r=n[0],i=n[1],a=n[2],o=n[3],s=n[4];this.setEulerAngles(s).setPosition(r,i).setLocalScale(a,o);}},{key:"setLocalMatrix",value:function(t){var e=ty(t),n=(0,D.default)(e,5),r=n[0],i=n[1],a=n[2],o=n[3],s=n[4];this.setLocalEulerAngles(s).setLocalPosition(r,i).setLocalScale(a,o);}},{key:"show",value:function(){this.forEach(function(t){t.style.visibility="visible";});}},{key:"hide",value:function(){this.forEach(function(t){t.style.visibility="hidden";});}},{key:"getCount",value:function(){return this.childElementCount;}},{key:"getParent",value:function(){return this.parentElement;}},{key:"getChildren",value:function(){return this.children;}},{key:"getFirst",value:function(){return this.firstElementChild;}},{key:"getLast",value:function(){return this.lastElementChild;}},{key:"getChildByIndex",value:function(t){return this.children[t]||null;}},{key:"add",value:function(t,e){return this.appendChild(t,e);}},{key:"set",value:function(t,e){this.config[t]=e;}},{key:"get",value:function(t){return this.config[t];}},{key:"moveTo",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(t,e,n),this;}},{key:"move",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(t,e,n),this;}},{key:"setZIndex",value:function(t){return this.style.zIndex=t,this;}}]);}(ic);iy.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","display","draggable","droppable","fill","fillOpacity","fillRule","filter","increasedLineWidthForHitTesting","lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit","hitArea","offsetDistance","offsetPath","offsetX","offsetY","opacity","pointerEvents","shadowColor","shadowType","shadowBlur","shadowOffsetX","shadowOffsetY","stroke","strokeOpacity","strokeWidth","strokeLinecap","strokeLineJoin","strokeDasharray","strokeDashoffset","transform","transformOrigin","textTransform","visibility","zIndex"]);var im=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.CIRCLE},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(iy);im.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iy.PARSED_STYLE_LIST),["cx","cy","cz","r","isBillboard","isSizeAttenuation"]));var ik=["style"];(function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,ik);return(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({style:r},i)])).isCustomElement=!0,t;}return(0,I.default)(e,t),(0,R.default)(e);})(iy).PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var iE=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.ELLIPSE},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(iy);iE.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iy.PARSED_STYLE_LIST),["cx","cy","cz","rx","ry","isBillboard","isSizeAttenuation"])),function(t){function e(){return(0,C.default)(this,e),(0,L.default)(this,e,[{type:j.FRAGMENT}]);}return(0,I.default)(e,t),(0,R.default)(e);}(iy).PARSED_STYLE_LIST=new Set(["class","className"]);var ix=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.GROUP},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(iy);ix.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var iT=["style"],iN=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iT);return(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({type:j.HTML,style:r},i)])).cullable.enable=!1,t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getDomElement",value:function(){return this.parsedStyle.$el;}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()];}},{key:"getLocalBounds",value:function(){if(this.parentNode){var t=G.mat4.invert(G.mat4.create(),this.parentNode.getWorldTransform()),e=this.getBounds();if(!tr.isEmpty(e)){var n=new tr;return n.setFromTransformedAABB(e,t),n;}}return this.getBounds();}}]);}(iy);iN.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iy.PARSED_STYLE_LIST),["x","y","$el","innerHTML","width","height"]));var ib=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.IMAGE},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(iy);ib.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iy.PARSED_STYLE_LIST),["x","y","z","src","width","height","isBillboard","billboardRotation","isSizeAttenuation","keepAspectRatio"]));var iS=["style"],iw=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iS);(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({type:j.LINE,style:(0,A.default)({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},r)},i)])).markerStartAngle=0,t.markerEndAngle=0;var a=t.parsedStyle,o=a.markerStart,s=a.markerEnd;return o&&ih(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),s&&ih(s)&&(t.markerEndAngle=s.getLocalEulerAngles(),t.appendChild(s)),t.transformMarker(!0),t.transformMarker(!1),t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"x1"===t||"y1"===t||"x2"===t||"y2"===t||"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&ih(r)&&(this.markerStartAngle=0,r.remove()),i&&ih(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t&&(r&&ih(r)&&(this.markerEndAngle=0,r.remove()),i&&ih(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1)));}},{key:"transformMarker",value:function(t){var e,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,h=s.markerEndOffset,d=s.x1,f=s.x2,v=s.y1,p=s.y2,g=t?l:u;if(g&&ih(g)){var y=0;t?(r=d,i=v,e=f-d,n=p-v,a=c||0,o=this.markerStartAngle):(r=f,i=p,e=d-f,n=v-p,a=h||0,o=this.markerEndAngle),y=Math.atan2(n,e),g.setLocalEulerAngles(180*y/Math.PI+o),g.setLocalPosition(r+Math.cos(y)*a,i+Math.sin(y)*a);}}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle,r=n.x1,i=n.y1,a=n.x2,o=n.y2,s=(0,z.linePointAt)(r,i,a,o,t),l=s.x,u=s.y,c=G.vec3.transformMat4(G.vec3.create(),G.vec3.fromValues(l,u,0),e?this.getWorldTransform():this.getLocalTransform());return new ts(c[0],c[1]);}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(t/this.getTotalLength(),e);}},{key:"getTotalLength",value:function(){var t=this.parsedStyle,e=t.x1,n=t.y1,r=t.x2,i=t.y2;return(0,z.lineLength)(e,n,r,i);}}]);}(iy);iw.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iy.PARSED_STYLE_LIST),["x1","y1","x2","y2","z1","z2","isBillboard","isSizeAttenuation","markerStart","markerEnd","markerStartOffset","markerEndOffset"]));var iP=["style"],iM=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iP);(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({type:j.PATH,style:r,initialParsedStyle:{miterLimit:4,d:(0,A.default)({},tD)}},i)])).markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var a=t.parsedStyle,o=a.markerStart,s=a.markerEnd,l=a.markerMid;return o&&ih(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),l&&ih(l)&&t.placeMarkerMid(l),s&&ih(s)&&(t.markerEndAngle=s.getLocalEulerAngles(),t.appendChild(s)),t.transformMarker(!0),t.transformMarker(!1),t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"d"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&ih(r)&&(this.markerStartAngle=0,r.remove()),i&&ih(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t?(r&&ih(r)&&(this.markerEndAngle=0,r.remove()),i&&ih(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(i);}},{key:"transformMarker",value:function(t){var e,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,h=s.markerEndOffset,d=t?l:u;if(d&&ih(d)){var f=0;if(t){var v=this.getStartTangent(),p=(0,D.default)(v,2),g=p[0],y=p[1];r=y[0],i=y[1],e=g[0]-y[0],n=g[1]-y[1],a=c||0,o=this.markerStartAngle;}else{var m=this.getEndTangent(),k=(0,D.default)(m,2),E=k[0],x=k[1];r=x[0],i=x[1],e=E[0]-x[0],n=E[1]-x[1],a=h||0,o=this.markerEndAngle;}f=Math.atan2(n,e),d.setLocalEulerAngles(180*f/Math.PI+o),d.setLocalPosition(r+Math.cos(f)*a,i+Math.sin(f)*a);}}},{key:"placeMarkerMid",value:function(t){var e=this.parsedStyle.d.segments;if(this.markerMidList.forEach(function(t){t.remove();}),t&&ih(t))for(var n=1;n<e.length-1;n++){var r=(0,D.default)(e[n].currentPoint,2),i=r[0],a=r[1],o=1===n?t:t.cloneNode(!0);this.markerMidList.push(o),this.appendChild(o),o.setLocalPosition(i,a);}}},{key:"getTotalLength",value:function(){return e7(this);}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle.d.absolutePath,r=(0,F.getPointAtLength)(n,t),i=r.x,a=r.y,o=G.vec3.transformMat4(G.vec3.create(),G.vec3.fromValues(i,a,0),e?this.getWorldTransform():this.getLocalTransform());return new ts(o[0],o[1]);}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPointAtLength(t*e7(this),e);}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.d.segments,e=[];if(t.length>1){var n=t[0].currentPoint,r=t[1].currentPoint,i=t[1].startTangent;e=[],i?e.push([n[0]-i[0],n[1]-i[1]]):e.push([r[0],r[1]]),e.push([n[0],n[1]]);}return e;}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.d.segments,e=t.length,n=[];if(e>1){var r=t[e-2].currentPoint,i=t[e-1].currentPoint,a=t[e-1].endTangent;n=[],a?n.push([i[0]-a[0],i[1]-a[1]]):n.push([r[0],r[1]]),n.push([i[0],i[1]]);}return n;}}]);}(iy);iM.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iy.PARSED_STYLE_LIST),["d","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard","isSizeAttenuation"]));var iA=["style"],iC=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iA);(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({type:j.POLYGON,style:r,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},i)])).markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var a=t.parsedStyle,o=a.markerStart,s=a.markerEnd,l=a.markerMid;return o&&ih(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),l&&ih(l)&&t.placeMarkerMid(l),s&&ih(s)&&(t.markerEndAngle=s.getLocalEulerAngles(),t.appendChild(s)),t.transformMarker(!0),t.transformMarker(!1),t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"points"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&ih(r)&&(this.markerStartAngle=0,r.remove()),i&&ih(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t?(r&&ih(r)&&(this.markerEndAngle=0,r.remove()),i&&ih(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(i);}},{key:"transformMarker",value:function(t){var e,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,h=s.markerEndOffset,d=(s.points||{}).points,f=t?l:u;if(f&&ih(f)&&d){var v=0;if(r=d[0][0],i=d[0][1],t)e=d[1][0]-d[0][0],n=d[1][1]-d[0][1],a=c||0,o=this.markerStartAngle;else{var p=d.length;this.parsedStyle.isClosed?(e=d[p-1][0]-d[0][0],n=d[p-1][1]-d[0][1]):(r=d[p-1][0],i=d[p-1][1],e=d[p-2][0]-d[p-1][0],n=d[p-2][1]-d[p-1][1]),a=h||0,o=this.markerEndAngle;}v=Math.atan2(n,e),f.setLocalEulerAngles(180*v/Math.PI+o),f.setLocalPosition(r+Math.cos(v)*a,i+Math.sin(v)*a);}}},{key:"placeMarkerMid",value:function(t){var e=(this.parsedStyle.points||{}).points;if(this.markerMidList.forEach(function(t){t.remove();}),this.markerMidList=[],t&&ih(t)&&e)for(var n=1;n<(this.parsedStyle.isClosed?e.length:e.length-1);n++){var r=e[n][0],i=e[n][1],a=1===n?t:t.cloneNode(!0);this.markerMidList.push(a),this.appendChild(a),a.setLocalPosition(r,i);}}}]);}(iy);iC.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iy.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isClosed","isBillboard","isSizeAttenuation"]));var iR=["style"],iO=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.style,r=(0,q.default)(t,iR);return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.POLYLINE,style:n,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},r)]);}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getTotalLength",value:function(){return 0===this.parsedStyle.points.totalLength&&(this.parsedStyle.points.totalLength=(0,z.polylineLength)(this.parsedStyle.points.points)),this.parsedStyle.points.totalLength;}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(t/this.getTotalLength(),e);}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle.points.points;if(0===this.parsedStyle.points.segments.length){var r,i,a=[],o=0,s=this.getTotalLength();n.forEach(function(t,e){n[e+1]&&((r=[0,0])[0]=o/s,i=(0,z.lineLength)(t[0],t[1],n[e+1][0],n[e+1][1]),o+=i,r[1]=o/s,a.push(r));}),this.parsedStyle.points.segments=a;}var l=0,u=0;this.parsedStyle.points.segments.forEach(function(e,n){t>=e[0]&&t<=e[1]&&(l=(t-e[0])/(e[1]-e[0]),u=n);});var c=(0,z.linePointAt)(n[u][0],n[u][1],n[u+1][0],n[u+1][1],l),h=c.x,d=c.y,f=G.vec3.transformMat4(G.vec3.create(),G.vec3.fromValues(h,d,0),e?this.getWorldTransform():this.getLocalTransform());return new ts(f[0],f[1]);}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.points.points,e=[];return e.push([t[1][0],t[1][1]]),e.push([t[0][0],t[0][1]]),e;}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.points.points,e=t.length-1,n=[];return n.push([t[e-1][0],t[e-1][1]]),n.push([t[e][0],t[e][1]]),n;}}]);}(iC);iO.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iC.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard"]));var iL=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.RECT},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(iy);iL.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iy.PARSED_STYLE_LIST),["x","y","z","width","height","isBillboard","isSizeAttenuation","radius"]));var iI=["style"],iD=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.style,r=(0,q.default)(t,iI);return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.TEXT,style:(0,A.default)({fill:"black"},n)},r)]);}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getComputedTextLength",value:function(){var t;return this.getGeometryBounds(),(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.maxLineWidth)||0;}},{key:"getLineBoundingRects",value:function(){var t;return this.getGeometryBounds(),(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.lineMetrics)||[];}},{key:"isOverflowing",value:function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing;}}]);}(iy);iD.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iy.PARSED_STYLE_LIST),["x","y","z","isBillboard","billboardRotation","isSizeAttenuation","text","textAlign","textBaseline","fontStyle","fontSize","fontFamily","fontWeight","fontVariant","lineHeight","letterSpacing","leading","wordWrap","wordWrapWidth","maxLines","textOverflow","isOverflowing","textPath","textDecorationLine","textDecorationColor","textDecorationStyle","textDecorationThickness","textPathSide","textPathStartOffset","metrics","dx","dy"])),(0,R.default)(function t(){(0,C.default)(this,t),this.registry={},this.define(j.CIRCLE,im),this.define(j.ELLIPSE,iE),this.define(j.RECT,iL),this.define(j.IMAGE,ib),this.define(j.LINE,iw),this.define(j.GROUP,ix),this.define(j.PATH,iM),this.define(j.POLYGON,iC),this.define(j.POLYLINE,iO),this.define(j.TEXT,iD),this.define(j.HTML,iN);},[{key:"define",value:function(t,e){this.registry[t]=e;}},{key:"get",value:function(t){return this.registry[t];}}]),function(){function t(e){(0,C.default)(this,t),this.strategies=e;}return(0,R.default)(t,[{key:"apply",value:function(e){var n=e.config,r=e.camera,i=e.renderingService,a=e.renderingContext,o=this.strategies;i.hooks.cull.tap(t.tag,function(t){if(t){var e,i=t.cullable;if(0===o.length?i.visible=a.unculledEntities.indexOf(t.entity)>-1:i.visible=o.every(function(e){return e.isVisible(r,t);}),!t.isCulled()&&t.isVisible())return t;var s=(null===(e=n.future)||void 0===e?void 0:e.experimentalCancelEventPropagation)===!0;return t.dispatchEvent(new rL(rB.CULLED),s,s),null;}return t;}),i.hooks.afterRender.tap(t.tag,function(t){t.cullable.visibilityPlaneMask=-1;});}}]);}().tag="Culling",function(){function t(){var e=this;(0,C.default)(this,t),this.autoPreventDefault=!1,this.rootPointerEvent=new rR(null),this.rootWheelEvent=new rO(null),this.onPointerMove=function(t){var n=null===(r=e.context.renderingContext.root)||void 0===r||null===(r=r.ownerDocument)||void 0===r?void 0:r.defaultView;if(!n.supportsTouchEvents||"touch"!==t.pointerType){var r,i,a=e.normalizeToPointerEvent(t,n),o=(0,W.default)(a);try{for(o.s();!(i=o.n()).done;){var s=i.value,l=e.bootstrapEvent(e.rootPointerEvent,s,n,t);e.context.eventService.mapEvent(l);}}catch(t){o.e(t);}finally{o.f();}e.setCursor(e.context.eventService.cursor);}},this.onClick=function(t){var n,r,i=null===(n=e.context.renderingContext.root)||void 0===n||null===(n=n.ownerDocument)||void 0===n?void 0:n.defaultView,a=e.normalizeToPointerEvent(t,i),o=(0,W.default)(a);try{for(o.s();!(r=o.n()).done;){var s=r.value,l=e.bootstrapEvent(e.rootPointerEvent,s,i,t);e.context.eventService.mapEvent(l);}}catch(t){o.e(t);}finally{o.f();}e.setCursor(e.context.eventService.cursor);};}return(0,R.default)(t,[{key:"apply",value:function(e){var n=this;this.context=e;var r=e.renderingService,i=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler(function(t){return n.context.renderingService.hooks.pickSync.call({position:t,picked:[],topmost:!0}).picked[0]||null;}),r.hooks.pointerWheel.tap(t.tag,function(t){var e=n.normalizeWheelEvent(t);n.context.eventService.mapEvent(e);}),r.hooks.pointerDown.tap(t.tag,function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){var e=n.normalizeToPointerEvent(t,i);n.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();var r,a=(0,W.default)(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=n.bootstrapEvent(n.rootPointerEvent,o,i,t);n.context.eventService.mapEvent(s);}}catch(t){a.e(t);}finally{a.f();}n.setCursor(n.context.eventService.cursor);}}),r.hooks.pointerUp.tap(t.tag,function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){var e,r=n.context.contextService.getDomElement(),a=n.context.eventService.isNativeEventFromCanvas(r,t)?"":"outside",o=n.normalizeToPointerEvent(t,i),s=(0,W.default)(o);try{for(s.s();!(e=s.n()).done;){var l=e.value,u=n.bootstrapEvent(n.rootPointerEvent,l,i,t);u.type+=a,n.context.eventService.mapEvent(u);}}catch(t){s.e(t);}finally{s.f();}n.setCursor(n.context.eventService.cursor);}}),r.hooks.pointerMove.tap(t.tag,this.onPointerMove),r.hooks.pointerOver.tap(t.tag,this.onPointerMove),r.hooks.pointerOut.tap(t.tag,this.onPointerMove),r.hooks.click.tap(t.tag,this.onClick),r.hooks.pointerCancel.tap(t.tag,function(t){var e,r=n.normalizeToPointerEvent(t,i),a=(0,W.default)(r);try{for(a.s();!(e=a.n()).done;){var o=e.value,s=n.bootstrapEvent(n.rootPointerEvent,o,i,t);n.context.eventService.mapEvent(s);}}catch(t){a.e(t);}finally{a.f();}n.setCursor(n.context.eventService.cursor);});}},{key:"bootstrapEvent",value:function(t,e,n,r){t.view=n,t.originalEvent=null,t.nativeEvent=r,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);var i=this.context.eventService.client2Viewport({x:e.clientX,y:e.clientY}),a=i.x,o=i.y;t.viewport.x=a,t.viewport.y=o;var s=this.context.eventService.viewport2Canvas(t.viewport),l=s.x,u=s.y;return t.canvas.x=l,t.canvas.y=u,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=r.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=nQ[t.type]||t.type),t;}},{key:"normalizeWheelEvent",value:function(t){var e=this.rootWheelEvent;this.transferMouseData(e,t),e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;var n=this.context.eventService.client2Viewport({x:t.clientX,y:t.clientY}),r=n.x,i=n.y;e.viewport.x=r,e.viewport.y=i;var a=this.context.eventService.viewport2Canvas(e.viewport),o=a.x,s=a.y;return e.canvas.x=o,e.canvas.y=s,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.nativeEvent=t,e.type=t.type,e;}},{key:"transferMouseData",value:function(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=nJ.now(),t.type=e.type,t.altKey=e.altKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.ctrlKey=e.ctrlKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.screen.x=e.screenX,t.screen.y=e.screenY,t.relatedTarget=null;}},{key:"setCursor",value:function(t){this.context.contextService.applyCursorStyle(t||this.context.config.cursor||"default");}},{key:"normalizeToPointerEvent",value:function(t,e){var n=[];if(e.isTouchEvent(t))for(var r=0;r<t.changedTouches.length;r++){var i=t.changedTouches[r];(0,F.isUndefined)(i.button)&&(i.button=0),(0,F.isUndefined)(i.buttons)&&(i.buttons=1),(0,F.isUndefined)(i.isPrimary)&&(i.isPrimary=1===t.touches.length&&"touchstart"===t.type),(0,F.isUndefined)(i.width)&&(i.width=i.radiusX||1),(0,F.isUndefined)(i.height)&&(i.height=i.radiusY||1),(0,F.isUndefined)(i.tiltX)&&(i.tiltX=0),(0,F.isUndefined)(i.tiltY)&&(i.tiltY=0),(0,F.isUndefined)(i.pointerType)&&(i.pointerType="touch"),(0,F.isUndefined)(i.pointerId)&&(i.pointerId=i.identifier||0),(0,F.isUndefined)(i.pressure)&&(i.pressure=i.force||.5),(0,F.isUndefined)(i.twist)&&(i.twist=0),(0,F.isUndefined)(i.tangentialPressure)&&(i.tangentialPressure=0),i.isNormalized=!0,i.type=t.type,n.push(i);}else e.isMouseEvent(t)&&((0,F.isUndefined)(t.isPrimary)&&(t.isPrimary=!0),(0,F.isUndefined)(t.width)&&(t.width=1),(0,F.isUndefined)(t.height)&&(t.height=1),(0,F.isUndefined)(t.tiltX)&&(t.tiltX=0),(0,F.isUndefined)(t.tiltY)&&(t.tiltY=0),(0,F.isUndefined)(t.pointerType)&&(t.pointerType="mouse"),(0,F.isUndefined)(t.pointerId)&&(t.pointerId=1),(0,F.isUndefined)(t.pressure)&&(t.pressure=.5),(0,F.isUndefined)(t.twist)&&(t.twist=0),(0,F.isUndefined)(t.tangentialPressure)&&(t.tangentialPressure=0),t.isNormalized=!0),n.push(t);return n;}}]);}().tag="Event";var i_=[j.CIRCLE,j.ELLIPSE,j.IMAGE,j.RECT,j.LINE,j.POLYLINE,j.POLYGON,j.TEXT,j.PATH,j.HTML];(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"isVisible",value:function(t,e){var n,r=e.cullable;if(!r.enable)return!0;var i=e.getRenderBounds();if(tr.isEmpty(i))return!1;var a=t.getFrustum(),o=null===(n=e.parentNode)||void 0===n||null===(n=n.cullable)||void 0===n?void 0:n.visibilityPlaneMask;return r.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(e,i,o||ta.INDETERMINATE,a.planes),r.visible=r.visibilityPlaneMask!==ta.OUTSIDE,r.visible;}},{key:"computeVisibilityWithPlaneMask",value:function(t,e,n,r){if(n===ta.OUTSIDE||n===ta.INSIDE)return n;for(var i=ta.INSIDE,a=i_.indexOf(t.nodeName)>-1,o=0,s=r.length;o<s;++o){var l=1<<o;if((n&l)!=0&&(!a||4!==o&&5!==o)){var u=r[o],c=u.normal,h=u.distance;if(G.vec3.dot(c,e.getPositiveFarPoint(r[o]))+h<0)return ta.OUTSIDE;G.vec3.dot(c,e.getNegativeFarPoint(r[o]))+h<0&&(i|=l);}}return i;}}]),function(){function t(){(0,C.default)(this,t),this.mutationRecords=[],this.isFirstTimeRendering=!0,this.isFirstTimeRenderingFinished=!1;}return(0,R.default)(t,[{key:"apply",value:function(e){var n,r=this,i=e.renderingService,a=e.renderingContext.root.ownerDocument.defaultView,o=function(t){i.dirty();},s=function(t){var e,n=t.detail;(e=r.mutationRecords).push.apply(e,(0,O.default)(n)),i.dirty();},l=function(t){var e=t.target;ir.enableSizeAttenuation&&ir.styleValueRegistry.updateSizeAttenuation(e,a.getCamera().getZoom());},u=function(t){var e=t.target;ir.sceneGraphService.dirtyToRoot(e),i.dirty();};i.hooks.init.tap(t.tag,function(){a.addEventListener(rB.MOUNTED,l),a.addEventListener(rB.UNMOUNTED,u),a.addEventListener(rB.ATTR_MODIFIED,o),a.addEventListener(rB.BOUNDS_CHANGED,s);}),i.hooks.destroy.tap(t.tag,function(){a.removeEventListener(rB.MOUNTED,l),a.removeEventListener(rB.UNMOUNTED,u),a.removeEventListener(rB.ATTR_MODIFIED,o),a.removeEventListener(rB.BOUNDS_CHANGED,s),r.mutationRecords=[];});var c=null!==(n=ir.globalThis.requestIdleCallback)&&void 0!==n?n:n8.bind(ir.globalThis);i.hooks.endFrame.tap(t.tag,function(){r.isFirstTimeRendering&&(r.isFirstTimeRendering=!1,c(function(){r.isFirstTimeRenderingFinished=!0;})),r.mutationRecords=[];});}}]);}().tag="Prepare";var iG=((P={}).READY="ready",P.BEFORE_RENDER="beforerender",P.RERENDER="rerender",P.AFTER_RENDER="afterrender",P.BEFORE_DESTROY="beforedestroy",P.AFTER_DESTROY="afterdestroy",P.RESIZE="resize",P.DIRTY_RECTANGLE="dirtyrectangle",P.RENDERER_CHANGED="rendererchanged",P);new rL(rB.MOUNTED),new rL(rB.UNMOUNTED),new rL(iG.BEFORE_RENDER),new rL(iG.RERENDER),new rL(iG.AFTER_RENDER);},"505e459a":function(t,e,n){"use strict";n.d(e,"__esModule",{value:!0}),n.d(e,"AbstractRendererPlugin",{enumerable:!0,get:function(){return K;}});var r,i,a,o,s,l,u,c,h,d,f,v,p,g,y,m,k,E,x,T,N,b,S,w,P,M=n("777fffbe"),A=M._(n("ab297151")),C=M._(n("b1a4abb6")),R=M._(n("72ce8fb5")),O=M._(n("d60881d0")),L=M._(n("0b95a4d2")),I=M._(n("0afdccfb")),D=M._(n("7465ab36")),_=M._(n("32f41e1c")),G=n("597fa39f");n("f90e84e3");var F=n("abe9d8d6"),B=M._(n("3214ccb5")),U=M._(n("51ffafbb")),V=M._(n("3c7f532e")),z=n("b1a96927"),H=M._(n("2fabd5d4")),Y=M._(n("cb203630")),W=M._(n("1982f763")),q=M._(n("01aac514"));let X=n("1714eebe");var j=((r={}).GROUP="g",r.FRAGMENT="fragment",r.CIRCLE="circle",r.ELLIPSE="ellipse",r.IMAGE="image",r.RECT="rect",r.LINE="line",r.POLYLINE="polyline",r.POLYGON="polygon",r.TEXT="text",r.PATH="path",r.HTML="html",r.MESH="mesh",r),$=((i={})[i.ZERO=0]="ZERO",i[i.NEGATIVE_ONE=1]="NEGATIVE_ONE",i),K=(0,R.default)(function t(){(0,C.default)(this,t),this.plugins=[];},[{key:"addRenderingPlugin",value:function(t){this.plugins.push(t),this.context.renderingPlugins.push(t);}},{key:"removeAllRenderingPlugins",value:function(){var t=this;this.plugins.forEach(function(e){var n=t.context.renderingPlugins.indexOf(e);n>=0&&t.context.renderingPlugins.splice(n,1);});}}]),Z=G.vec3.add,Q=G.vec3.copy,J=G.vec3.max,tt=G.vec3.min,te=G.vec3.scale,tn=G.vec3.sub,tr=function(){function t(){(0,C.default)(this,t),this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0];}return(0,R.default)(t,[{key:"update",value:function(t,e){Q(this.center,t),Q(this.halfExtents,e),tn(this.min,this.center,this.halfExtents),Z(this.max,this.center,this.halfExtents);}},{key:"setMinMax",value:function(t,e){Z(this.center,e,t),te(this.center,this.center,.5),tn(this.halfExtents,e,t),te(this.halfExtents,this.halfExtents,.5),Q(this.min,t),Q(this.max,e);}},{key:"getMin",value:function(){return this.min;}},{key:"getMax",value:function(){return this.max;}},{key:"add",value:function(e){if(!t.isEmpty(e)){if(t.isEmpty(this)){this.setMinMax(e.getMin(),e.getMax());return;}var n=this.center,r=n[0],i=n[1],a=n[2],o=this.halfExtents,s=o[0],l=o[1],u=o[2],c=r-s,h=r+s,d=i-l,f=i+l,v=a-u,p=a+u,g=e.center,y=g[0],m=g[1],k=g[2],E=e.halfExtents,x=E[0],T=E[1],N=E[2],b=y-x,S=y+x,w=m-T,P=m+T,M=k-N,A=k+N;b<c&&(c=b),S>h&&(h=S),w<d&&(d=w),P>f&&(f=P),M<v&&(v=M),A>p&&(p=A),n[0]=(c+h)*.5,n[1]=(d+f)*.5,n[2]=(v+p)*.5,o[0]=(h-c)*.5,o[1]=(f-d)*.5,o[2]=(p-v)*.5,this.min[0]=c,this.min[1]=d,this.min[2]=v,this.max[0]=h,this.max[1]=f,this.max[2]=p;}}},{key:"setFromTransformedAABB",value:function(t,e){var n=this.center,r=this.halfExtents,i=t.center,a=t.halfExtents,o=e[0],s=e[4],l=e[8],u=e[1],c=e[5],h=e[9],d=e[2],f=e[6],v=e[10],p=Math.abs(o),g=Math.abs(s),y=Math.abs(l),m=Math.abs(u),k=Math.abs(c),E=Math.abs(h),x=Math.abs(d),T=Math.abs(f),N=Math.abs(v);n[0]=e[12]+o*i[0]+s*i[1]+l*i[2],n[1]=e[13]+u*i[0]+c*i[1]+h*i[2],n[2]=e[14]+d*i[0]+f*i[1]+v*i[2],r[0]=p*a[0]+g*a[1]+y*a[2],r[1]=m*a[0]+k*a[1]+E*a[2],r[2]=x*a[0]+T*a[1]+N*a[2],tn(this.min,n,r),Z(this.max,n,r);}},{key:"intersects",value:function(t){var e=this.getMax(),n=this.getMin(),r=t.getMax(),i=t.getMin();return n[0]<=r[0]&&e[0]>=i[0]&&n[1]<=r[1]&&e[1]>=i[1]&&n[2]<=r[2]&&e[2]>=i[2];}},{key:"intersection",value:function(e){if(!this.intersects(e))return null;var n=new t,r=J([0,0,0],this.getMin(),e.getMin()),i=tt([0,0,0],this.getMax(),e.getMax());return n.setMinMax(r,i),n;}},{key:"getNegativeFarPoint",value:function(t){return 273===t.pnVertexFlag?Q([0,0,0],this.min):272===t.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:257===t.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:256===t.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:17===t.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:16===t.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:1===t.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]];}},{key:"getPositiveFarPoint",value:function(t){return 273===t.pnVertexFlag?Q([0,0,0],this.max):272===t.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:257===t.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:256===t.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:17===t.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:16===t.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:1===t.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]];}}],[{key:"isEmpty",value:function(t){return!t||0===t.halfExtents[0]&&0===t.halfExtents[1]&&0===t.halfExtents[2];}}]);}(),ti=(0,R.default)(function t(e,n){(0,C.default)(this,t),this.distance=e||0,this.normal=n||G.vec3.fromValues(0,1,0),this.updatePNVertexFlag();},[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(Number(this.normal[0]>=0)<<8)+(Number(this.normal[1]>=0)<<4)+Number(this.normal[2]>=0);}},{key:"distanceToPoint",value:function(t){return G.vec3.dot(t,this.normal)-this.distance;}},{key:"normalize",value:function(){var t=1/G.vec3.len(this.normal);G.vec3.scale(this.normal,this.normal,t),this.distance*=t;}},{key:"intersectsLine",value:function(t,e,n){var r=this.distanceToPoint(t),i=r/(r-this.distanceToPoint(e)),a=i>=0&&i<=1;return a&&n&&G.vec3.lerp(n,t,e,i),a;}}]),ta=((a={})[a.OUTSIDE=4294967295]="OUTSIDE",a[a.INSIDE=0]="INSIDE",a[a.INDETERMINATE=2147483647]="INDETERMINATE",a),to=(0,R.default)(function t(e){if((0,C.default)(this,t),this.planes=[],e)this.planes=e;else for(var n=0;n<6;n++)this.planes.push(new ti);},[{key:"extractFromVPMatrix",value:function(t){var e=(0,D.default)(t,16),n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],v=e[12],p=e[13],g=e[14],y=e[15];G.vec3.set(this.planes[0].normal,a-n,u-o,f-c),this.planes[0].distance=y-v,G.vec3.set(this.planes[1].normal,a+n,u+o,f+c),this.planes[1].distance=y+v,G.vec3.set(this.planes[2].normal,a+r,u+s,f+h),this.planes[2].distance=y+p,G.vec3.set(this.planes[3].normal,a-r,u-s,f-h),this.planes[3].distance=y-p,G.vec3.set(this.planes[4].normal,a-i,u-l,f-d),this.planes[4].distance=y-g,G.vec3.set(this.planes[5].normal,a+i,u+l,f+d),this.planes[5].distance=y+g,this.planes.forEach(function(t){t.normalize(),t.updatePNVertexFlag();});}}]),ts=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,C.default)(this,t),this.x=0,this.y=0,this.x=e,this.y=n;}return(0,R.default)(t,[{key:"clone",value:function(){return new t(this.x,this.y);}},{key:"copyFrom",value:function(t){this.x=t.x,this.y=t.y;}}]);}(),tl=function(){function t(e,n,r,i){(0,C.default)(this,t),this.x=e,this.y=n,this.width=r,this.height=i,this.left=e,this.right=e+r,this.top=n,this.bottom=n+i;}return(0,R.default)(t,[{key:"toJSON",value:function(){}}],[{key:"fromRect",value:function(e){return new t(e.x,e.y,e.width,e.height);}},{key:"applyTransform",value:function(e,n){var r=G.vec4.fromValues(e.x,e.y,0,1),i=G.vec4.fromValues(e.x+e.width,e.y,0,1),a=G.vec4.fromValues(e.x,e.y+e.height,0,1),o=G.vec4.fromValues(e.x+e.width,e.y+e.height,0,1),s=G.vec4.create(),l=G.vec4.create(),u=G.vec4.create(),c=G.vec4.create();G.vec4.transformMat4(s,r,n),G.vec4.transformMat4(l,i,n),G.vec4.transformMat4(u,a,n),G.vec4.transformMat4(c,o,n);var h=Math.min(s[0],l[0],u[0],c[0]),d=Math.min(s[1],l[1],u[1],c[1]),f=Math.max(s[0],l[0],u[0],c[0]),v=Math.max(s[1],l[1],u[1],c[1]);return t.fromRect({x:h,y:d,width:f-h,height:v-d});}}]);}(),tu="Method not implemented.";function tc(t){return void 0===t?0:t>360||t<-360?t%360:t;}var th=G.vec3.create();function td(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];return Array.isArray(t)&&3===t.length?r?G.vec3.clone(t):G.vec3.copy(th,t):(0,F.isNumber)(t)?r?G.vec3.fromValues(t,e,n):G.vec3.set(th,t,e,n):r?G.vec3.fromValues(t[0],t[1]||e,t[2]||n):G.vec3.set(th,t[0],t[1]||e,t[2]||n);}var tf=Math.PI/180,tv=180/Math.PI,tp=Math.PI/2;function tg(t,e){var n,r,i,a,o,s,l,u,c,h,d,f,v,p,g,y,m;return 16===e.length?(i=G.mat4.getScaling(G.vec3.create(),e),o=(a=(0,D.default)(i,3))[0],s=a[1],l=a[2],(u=Math.asin(-e[2]/o))<tp?u>-tp?(n=Math.atan2(e[6]/s,e[10]/l),r=Math.atan2(e[1]/o,e[0]/o)):(r=0,n=-Math.atan2(e[4]/s,e[5]/s)):(r=0,n=Math.atan2(e[4]/s,e[5]/s)),t[0]=n,t[1]=u,t[2]=r):(c=e[0],h=e[1],d=e[2],f=e[3],y=c*c+(v=h*h)+(p=d*d)+(g=f*f),(m=c*f-h*d)>.499995*y?(t[0]=tp,t[1]=2*Math.atan2(h,c),t[2]=0):m<-.499995*y?(t[0]=-tp,t[1]=2*Math.atan2(h,c),t[2]=0):(t[0]=Math.asin(2*(c*d-f*h)),t[1]=Math.atan2(2*(c*f+h*d),1-2*(p+g)),t[2]=Math.atan2(2*(c*h+d*f),1-2*(v+p)))),t;}function ty(t){var e=t[0],n=t[1],r=t[3],i=t[4],a=Math.sqrt(e*e+n*n),o=Math.sqrt(r*r+i*i);if(e*i-n*r<0&&(e<i?a=-a:o=-o),a){var s=1/a;e*=s,n*=s;}if(o){var l=1/o;r*=l,i*=l;}var u=Math.atan2(n,e)*tv;return[t[6],t[7],a,o,u];}var tm=G.mat4.create(),tk=G.mat4.create(),tE=G.vec4.create(),tx=[G.vec3.create(),G.vec3.create(),G.vec3.create()],tT=G.vec3.create();function tN(t,e,n,r,i){t[0]=e[0]*r+n[0]*i,t[1]=e[1]*r+n[1]*i,t[2]=e[2]*r+n[2]*i;}var tb=((o={})[o.ORBITING=0]="ORBITING",o[o.EXPLORING=1]="EXPLORING",o[o.TRACKING=2]="TRACKING",o),tS=((s={})[s.DEFAULT=0]="DEFAULT",s[s.ROTATIONAL=1]="ROTATIONAL",s[s.TRANSLATIONAL=2]="TRANSLATIONAL",s[s.CINEMATIC=3]="CINEMATIC",s),tw=((l={})[l.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",l[l.PERSPECTIVE=1]="PERSPECTIVE",l),tP={UPDATED:"updated"},tM=(0,R.default)(function t(){(0,C.default)(this,t),this.clipSpaceNearZ=$.NEGATIVE_ONE,this.eventEmitter=new _.default,this.matrix=G.mat4.create(),this.right=G.vec3.fromValues(1,0,0),this.up=G.vec3.fromValues(0,1,0),this.forward=G.vec3.fromValues(0,0,1),this.position=G.vec3.fromValues(0,0,1),this.focalPoint=G.vec3.fromValues(0,0,0),this.distanceVector=G.vec3.fromValues(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=G.mat4.create(),this.projectionMatrixInverse=G.mat4.create(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=tb.EXPLORING,this.trackingMode=tS.DEFAULT,this.projectionMode=tw.PERSPECTIVE,this.frustum=new to,this.orthoMatrix=G.mat4.create();},[{key:"isOrtho",value:function(){return this.projectionMode===tw.ORTHOGRAPHIC;}},{key:"getProjectionMode",value:function(){return this.projectionMode;}},{key:"getPerspective",value:function(){return this.jitteredProjectionMatrix||this.projectionMatrix;}},{key:"getPerspectiveInverse",value:function(){return this.projectionMatrixInverse;}},{key:"getFrustum",value:function(){return this.frustum;}},{key:"getPosition",value:function(){return this.position;}},{key:"getFocalPoint",value:function(){return this.focalPoint;}},{key:"getDollyingStep",value:function(){return this.dollyingStep;}},{key:"getNear",value:function(){return this.near;}},{key:"getFar",value:function(){return this.far;}},{key:"getZoom",value:function(){return this.zoom;}},{key:"getOrthoMatrix",value:function(){return this.orthoMatrix;}},{key:"getView",value:function(){return this.view;}},{key:"setEnableUpdate",value:function(t){this.enableUpdate=t;}},{key:"setType",value:function(t,e){return this.type=t,this.type===tb.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===tb.TRACKING&&void 0!==e&&this.setTrackingMode(e),this;}},{key:"setProjectionMode",value:function(t){return this.projectionMode=t,this;}},{key:"setTrackingMode",value:function(t){if(this.type!==tb.TRACKING)throw Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=t,this;}},{key:"setWorldRotation",value:function(t){return this.rotateWorld=t,this._getAngles(),this;}},{key:"getViewTransform",value:function(){return G.mat4.invert(G.mat4.create(),this.matrix);}},{key:"getWorldTransform",value:function(){return this.matrix;}},{key:"jitterProjectionMatrix",value:function(t,e){var n=G.mat4.fromTranslation(G.mat4.create(),[t,e,0]);this.jitteredProjectionMatrix=G.mat4.multiply(G.mat4.create(),n,this.projectionMatrix);}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0;}},{key:"setMatrix",value:function(t){return this.matrix=t,this._update(),this;}},{key:"setProjectionMatrix",value:function(t){this.projectionMatrix=t;}},{key:"setFov",value:function(t){return this.setPerspective(this.near,this.far,t,this.aspect),this;}},{key:"setAspect",value:function(t){return this.setPerspective(this.near,this.far,this.fov,t),this;}},{key:"setNear",value:function(t){return this.projectionMode===tw.PERSPECTIVE?this.setPerspective(t,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,t,this.far),this;}},{key:"setFar",value:function(t){return this.projectionMode===tw.PERSPECTIVE?this.setPerspective(this.near,t,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,t),this;}},{key:"setViewOffset",value:function(t,e,n,r,i,a){return this.aspect=t/e,void 0===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.projectionMode===tw.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this;}},{key:"clearViewOffset",value:function(){return void 0!==this.view&&(this.view.enabled=!1),this.projectionMode===tw.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this;}},{key:"setZoom",value:function(t){return this.zoom=t,this.projectionMode===tw.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===tw.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this;}},{key:"setZoomByViewportPoint",value:function(t,e){var n=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),r=n.x,i=n.y,a=this.roll;this.rotate(0,0,-a),this.setPosition(r,i),this.setFocalPoint(r,i),this.setZoom(t),this.rotate(0,0,a);var o=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),s=o.x,l=o.y,u=G.vec3.fromValues(s-r,l-i,0),c=G.vec3.dot(u,this.right)/G.vec3.length(this.right),h=G.vec3.dot(u,this.up)/G.vec3.length(this.up),d=this.getPosition(),f=(0,D.default)(d,2),v=f[0],p=f[1],g=this.getFocalPoint(),y=(0,D.default)(g,2),m=y[0],k=y[1];return this.setPosition(v-c,p-h),this.setFocalPoint(m-c,k-h),this;}},{key:"setPerspective",value:function(t,e,n,r){this.projectionMode=tw.PERSPECTIVE,this.fov=n,this.near=t,this.far=e,this.aspect=r;var i,a=this.near*Math.tan(.5*this.fov*tf)/this.zoom,o=2*a,s=this.aspect*o,l=-.5*s;if(null!==(i=this.view)&&void 0!==i&&i.enabled){var u=this.view.fullWidth,c=this.view.fullHeight;l+=this.view.offsetX*s/u,a-=this.view.offsetY*o/c,s*=this.view.width/u,o*=this.view.height/c;}return!function(t,e,n,r,i,a,o){var s,l,u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=2*a,h=n-e,d=r-i,f=o-a,v=o*a;u?(s=-o/f,l=-v/f):(s=-(o+a)/f,l=-2*v/f),t[0]=c/h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c/d,t[6]=0,t[7]=0,t[8]=(n+e)/h,t[9]=(r+i)/d,t[10]=s,t[11]=-1,t[12]=0,t[13]=0,t[14]=l,t[15]=0;}(this.projectionMatrix,l,l+s,a-o,a,t,this.far,this.clipSpaceNearZ===$.ZERO),G.mat4.invert(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this;}},{key:"setOrthographic",value:function(t,e,n,r,i,a){this.projectionMode=tw.ORTHOGRAPHIC,this.rright=e,this.left=t,this.top=n,this.bottom=r,this.near=i,this.far=a;var o,s=(this.rright-this.left)/(2*this.zoom),l=(this.top-this.bottom)/(2*this.zoom),u=(this.rright+this.left)/2,c=(this.top+this.bottom)/2,h=u-s,d=u+s,f=c+l,v=c-l;if(null!==(o=this.view)&&void 0!==o&&o.enabled){var p=(this.rright-this.left)/this.view.fullWidth/this.zoom,g=(this.top-this.bottom)/this.view.fullHeight/this.zoom;h+=p*this.view.offsetX,d=h+p*this.view.width,f-=g*this.view.offsetY,v=f-g*this.view.height;}return this.clipSpaceNearZ===$.NEGATIVE_ONE?G.mat4.ortho(this.projectionMatrix,h,d,f,v,i,a):G.mat4.orthoZO(this.projectionMatrix,h,d,f,v,i,a),G.mat4.invert(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this;}},{key:"setPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.position[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.position[2],r=td(t,e,n);return this._setPosition(r),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this;}},{key:"setFocalPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.focalPoint[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.focalPoint[2],r=G.vec3.fromValues(0,1,0);if(this.focalPoint=td(t,e,n),this.trackingMode===tS.CINEMATIC){var i=G.vec3.subtract(G.vec3.create(),this.focalPoint,this.position);t=i[0],e=i[1],n=i[2];var a=Math.asin(e/G.vec3.length(i))*tv,o=90+Math.atan2(n,t)*tv,s=G.mat4.create();G.mat4.rotateY(s,s,o*tf),G.mat4.rotateX(s,s,a*tf),r=G.vec3.transformMat4(G.vec3.create(),[0,1,0],s);}return G.mat4.invert(this.matrix,G.mat4.lookAt(G.mat4.create(),this.position,this.focalPoint,r)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this;}},{key:"getDistance",value:function(){return this.distance;}},{key:"getDistanceVector",value:function(){return this.distanceVector;}},{key:"setDistance",value:function(t){if(this.distance===t||t<0)return this;this.distance=t,this.distance<2e-4&&(this.distance=2e-4),this.dollyingStep=this.distance/100;var e=G.vec3.create();t=this.distance;var n=this.forward,r=this.focalPoint;return e[0]=t*n[0]+r[0],e[1]=t*n[1]+r[1],e[2]=t*n[2]+r[2],this._setPosition(e),this.triggerUpdate(),this;}},{key:"setMaxDistance",value:function(t){return this.maxDistance=t,this;}},{key:"setMinDistance",value:function(t){return this.minDistance=t,this;}},{key:"setAzimuth",value:function(t){return this.azimuth=tc(t),this.computeMatrix(),this._getAxes(),this.type===tb.ORBITING||this.type===tb.EXPLORING?this._getPosition():this.type===tb.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getAzimuth",value:function(){return this.azimuth;}},{key:"setElevation",value:function(t){return this.elevation=tc(t),this.computeMatrix(),this._getAxes(),this.type===tb.ORBITING||this.type===tb.EXPLORING?this._getPosition():this.type===tb.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getElevation",value:function(){return this.elevation;}},{key:"setRoll",value:function(t){return this.roll=tc(t),this.computeMatrix(),this._getAxes(),this.type===tb.ORBITING||this.type===tb.EXPLORING?this._getPosition():this.type===tb.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getRoll",value:function(){return this.roll;}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate();}},{key:"computeMatrix",value:function(){var t=G.quat.setAxisAngle(G.quat.create(),[0,0,1],this.roll*tf);G.mat4.identity(this.matrix);var e=G.quat.setAxisAngle(G.quat.create(),[1,0,0],(this.rotateWorld&&this.type!==tb.TRACKING||this.type===tb.TRACKING?1:-1)*this.elevation*tf),n=G.quat.setAxisAngle(G.quat.create(),[0,1,0],(this.rotateWorld&&this.type!==tb.TRACKING||this.type===tb.TRACKING?1:-1)*this.azimuth*tf),r=G.quat.multiply(G.quat.create(),n,e);r=G.quat.multiply(G.quat.create(),r,t);var i=G.mat4.fromQuat(G.mat4.create(),r);this.type===tb.ORBITING||this.type===tb.EXPLORING?(G.mat4.translate(this.matrix,this.matrix,this.focalPoint),G.mat4.multiply(this.matrix,this.matrix,i),G.mat4.translate(this.matrix,this.matrix,[0,0,this.distance])):this.type===tb.TRACKING&&(G.mat4.translate(this.matrix,this.matrix,this.position),G.mat4.multiply(this.matrix,this.matrix,i));}},{key:"_setPosition",value:function(t,e,n){this.position=td(t,e,n);var r=this.matrix;r[12]=this.position[0],r[13]=this.position[1],r[14]=this.position[2],r[15]=1,this._getOrthoMatrix();}},{key:"_getAxes",value:function(){G.vec3.copy(this.right,td(G.vec4.transformMat4(G.vec4.create(),[1,0,0,0],this.matrix))),G.vec3.copy(this.up,td(G.vec4.transformMat4(G.vec4.create(),[0,1,0,0],this.matrix))),G.vec3.copy(this.forward,td(G.vec4.transformMat4(G.vec4.create(),[0,0,1,0],this.matrix))),G.vec3.normalize(this.right,this.right),G.vec3.normalize(this.up,this.up),G.vec3.normalize(this.forward,this.forward);}},{key:"_getAngles",value:function(){var t=this.distanceVector[0],e=this.distanceVector[1],n=this.distanceVector[2],r=G.vec3.length(this.distanceVector);if(0===r){this.elevation=0,this.azimuth=0;return;}this.type===tb.TRACKING?(this.elevation=Math.asin(e/r)*tv,this.azimuth=Math.atan2(-t,-n)*tv):this.rotateWorld?(this.elevation=Math.asin(e/r)*tv,this.azimuth=Math.atan2(-t,-n)*tv):(this.elevation=-(Math.asin(e/r)*tv),this.azimuth=-(Math.atan2(-t,-n)*tv));}},{key:"_getPosition",value:function(){G.vec3.copy(this.position,td(G.vec4.transformMat4(G.vec4.create(),[0,0,0,1],this.matrix))),this._getDistance();}},{key:"_getFocalPoint",value:function(){G.vec3.transformMat3(this.distanceVector,[0,0,-this.distance],G.mat3.fromMat4(G.mat3.create(),this.matrix)),G.vec3.add(this.focalPoint,this.position,this.distanceVector),this._getDistance();}},{key:"_getDistance",value:function(){this.distanceVector=G.vec3.subtract(G.vec3.create(),this.focalPoint,this.position),this.distance=G.vec3.length(this.distanceVector),this.dollyingStep=this.distance/100;}},{key:"_getOrthoMatrix",value:function(){if(this.projectionMode===tw.ORTHOGRAPHIC){var t=this.position,e=G.quat.setAxisAngle(G.quat.create(),[0,0,1],-this.roll*Math.PI/180);G.mat4.fromRotationTranslationScaleOrigin(this.orthoMatrix,e,G.vec3.fromValues((this.rright-this.left)/2-t[0],(this.top-this.bottom)/2-t[1],0),G.vec3.fromValues(this.zoom,this.zoom,1),t);}}},{key:"triggerUpdate",value:function(){if(this.enableUpdate){var t=this.getViewTransform(),e=G.mat4.multiply(G.mat4.create(),this.getPerspective(),t);this.getFrustum().extractFromVPMatrix(e),this.eventEmitter.emit(tP.UPDATED);}}},{key:"rotate",value:function(t,e,n){throw Error(tu);}},{key:"pan",value:function(t,e){throw Error(tu);}},{key:"dolly",value:function(t){throw Error(tu);}},{key:"createLandmark",value:function(t,e){throw Error(tu);}},{key:"gotoLandmark",value:function(t,e){throw Error(tu);}},{key:"cancelLandmarkAnimation",value:function(){throw Error(tu);}}]),tA=((u={})[u.Standard=0]="Standard",u),tC=((c={})[c.ADDED=0]="ADDED",c[c.REMOVED=1]="REMOVED",c[c.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED",c),tR=G.vec3.create(),tO=G.mat4.create(),tL=G.quat.create();function tI(t){if(t.localDirtyFlag){if(0!==t.localSkew[0]||0!==t.localSkew[1]){G.mat4.fromRotationTranslationScaleOrigin(t.localTransform,t.localRotation,t.localPosition,G.vec3.fromValues(1,1,1),t.origin),(0!==t.localSkew[0]||0!==t.localSkew[1])&&(G.mat4.identity(tO),tO[4]=Math.tan(t.localSkew[0]),tO[1]=Math.tan(t.localSkew[1]),G.mat4.multiply(t.localTransform,t.localTransform,tO));var e=G.mat4.fromRotationTranslationScaleOrigin(tO,G.quat.set(tL,0,0,0,1),G.vec3.set(tR,1,1,1),t.localScale,t.origin);G.mat4.multiply(t.localTransform,t.localTransform,e);}else{var n=t.localTransform,r=t.localPosition,i=t.localRotation,a=t.localScale,o=t.origin,s=0!==r[0]||0!==r[1]||0!==r[2],l=1!==i[3]||0!==i[0]||0!==i[1]||0!==i[2],u=1!==a[0]||1!==a[1]||1!==a[2],c=0!==o[0]||0!==o[1]||0!==o[2];l||u||c?G.mat4.fromRotationTranslationScaleOrigin(n,i,r,a,o):s?G.mat4.fromTranslation(n,r):G.mat4.identity(n);}t.localDirtyFlag=!1;}}var tD={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new tl(0,0,0,0)},t_=((h={}).COORDINATE="<coordinate>",h.COLOR="<color>",h.PAINT="<paint>",h.NUMBER="<number>",h.ANGLE="<angle>",h.OPACITY_VALUE="<opacity-value>",h.SHADOW_BLUR="<shadow-blur>",h.LENGTH="<length>",h.PERCENTAGE="<percentage>",h.LENGTH_PERCENTAGE="<length> | <percentage>",h.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",h.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",h.LIST_OF_POINTS="<list-of-points>",h.PATH="<path>",h.FILTER="<filter>",h.Z_INDEX="<z-index>",h.OFFSET_DISTANCE="<offset-distance>",h.DEFINED_PATH="<defined-path>",h.MARKER="<marker>",h.TRANSFORM="<transform>",h.TRANSFORM_ORIGIN="<transform-origin>",h.TEXT="<text>",h.TEXT_TRANSFORM="<text-transform>",h);function tG(t,e,n){t.prototype=e.prototype=n,n.constructor=t;}function tF(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n;}function tB(){}var tU="\\s*([+-]?\\d+)\\s*",tV="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",tz="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",tH=/^#([0-9a-f]{3,8})$/,tY=RegExp(`^rgb\\(${tU},${tU},${tU}\\)$`),tW=RegExp(`^rgb\\(${tz},${tz},${tz}\\)$`),tq=RegExp(`^rgba\\(${tU},${tU},${tU},${tV}\\)$`),tX=RegExp(`^rgba\\(${tz},${tz},${tz},${tV}\\)$`),tj=RegExp(`^hsl\\(${tV},${tz},${tz}\\)$`),t$=RegExp(`^hsla\\(${tV},${tz},${tz},${tV}\\)$`),tK={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function tZ(){return this.rgb().formatHex();}function tQ(){return this.rgb().formatRgb();}function tJ(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=tH.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?t0(e):3===n?new t2(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?t1(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?t1(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=tY.exec(t))?new t2(e[1],e[2],e[3],1):(e=tW.exec(t))?new t2(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=tq.exec(t))?t1(e[1],e[2],e[3],e[4]):(e=tX.exec(t))?t1(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=tj.exec(t))?t9(e[1],e[2]/100,e[3]/100,1):(e=t$.exec(t))?t9(e[1],e[2]/100,e[3]/100,e[4]):tK.hasOwnProperty(t)?t0(tK[t]):"transparent"===t?new t2(NaN,NaN,NaN,0):null;}function t0(t){return new t2(t>>16&255,t>>8&255,255&t,1);}function t1(t,e,n,r){return r<=0&&(t=e=n=NaN),new t2(t,e,n,r);}function t2(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r;}function t3(){return`#${t7(this.r)}${t7(this.g)}${t7(this.b)}`;}function t4(){let t=t5(this.opacity);return`${1===t?"rgb(":"rgba("}${t6(this.r)}, ${t6(this.g)}, ${t6(this.b)}${1===t?")":`, ${t})`}`;}function t5(t){return isNaN(t)?1:Math.max(0,Math.min(1,t));}function t6(t){return Math.max(0,Math.min(255,Math.round(t)||0));}function t7(t){return((t=t6(t))<16?"0":"")+t.toString(16);}function t9(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new et(t,e,n,r);}function t8(t){if(t instanceof et)return new et(t.h,t.s,t.l,t.opacity);if(t instanceof tB||(t=tJ(t)),!t)return new et;if(t instanceof et)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,l=(a+i)/2;return s?(o=e===a?(n-r)/s+(n<r)*6:n===a?(r-e)/s+2:(e-n)/s+4,s/=l<.5?a+i:2-a-i,o*=60):s=l>0&&l<1?0:o,new et(o,s,l,t.opacity);}function et(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r;}function ee(t){return(t=(t||0)%360)<0?t+360:t;}function en(t){return Math.max(0,Math.min(1,t||0));}function er(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255;}function ei(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw TypeError("Expected a function");var n=function(){for(var r=arguments.length,i=Array(r),a=0;a<r;a++)i[a]=arguments[a];var o=e?e.apply(this,i):i[0],s=n.cache;if(s.has(o))return s.get(o);var l=t.apply(this,i);return n.cache=s.set(o,l)||s,l;};return n.cache=new(ei.Cache||Map),ei.cacheList.push(n.cache),n;}tG(tB,tJ,{copy(t){return Object.assign(new this.constructor,this,t);},displayable(){return this.rgb().displayable();},hex:tZ,formatHex:tZ,formatHex8:function(){return this.rgb().formatHex8();},formatHsl:function(){return t8(this).formatHsl();},formatRgb:tQ,toString:tQ}),tG(t2,function(t,e,n,r){var i;return 1==arguments.length?((i=t)instanceof tB||(i=tJ(i)),i)?new t2((i=i.rgb()).r,i.g,i.b,i.opacity):new t2:new t2(t,e,n,null==r?1:r);},tF(tB,{brighter(t){return t=null==t?1.4285714285714286:Math.pow(1.4285714285714286,t),new t2(this.r*t,this.g*t,this.b*t,this.opacity);},darker(t){return t=null==t?.7:Math.pow(.7,t),new t2(this.r*t,this.g*t,this.b*t,this.opacity);},rgb(){return this;},clamp(){return new t2(t6(this.r),t6(this.g),t6(this.b),t5(this.opacity));},displayable(){return -.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1;},hex:t3,formatHex:t3,formatHex8:function(){return`#${t7(this.r)}${t7(this.g)}${t7(this.b)}${t7((isNaN(this.opacity)?1:this.opacity)*255)}`;},formatRgb:t4,toString:t4})),tG(et,function(t,e,n,r){return 1==arguments.length?t8(t):new et(t,e,n,null==r?1:r);},tF(tB,{brighter(t){return t=null==t?1.4285714285714286:Math.pow(1.4285714285714286,t),new et(this.h,this.s,this.l*t,this.opacity);},darker(t){return t=null==t?.7:Math.pow(.7,t),new et(this.h,this.s,this.l*t,this.opacity);},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new t2(er(t>=240?t-240:t+120,i,r),er(t,i,r),er(t<120?t+240:t-120,i,r),this.opacity);},clamp(){return new et(ee(this.h),en(this.s),en(this.l),t5(this.opacity));},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1;},formatHsl(){let t=t5(this.opacity);return`${1===t?"hsl(":"hsla("}${ee(this.h)}, ${100*en(this.s)}%, ${100*en(this.l)}%${1===t?")":`, ${t})`}`;}})),ei.Cache=Map,ei.cacheList=[],ei.clearCache=function(){ei.cacheList.forEach(function(t){return t.clear();});};var ea=((d={})[d.kUnknown=0]="kUnknown",d[d.kNumber=1]="kNumber",d[d.kPercentage=2]="kPercentage",d[d.kEms=3]="kEms",d[d.kPixels=4]="kPixels",d[d.kRems=5]="kRems",d[d.kDegrees=6]="kDegrees",d[d.kRadians=7]="kRadians",d[d.kGradians=8]="kGradians",d[d.kTurns=9]="kTurns",d[d.kMilliseconds=10]="kMilliseconds",d[d.kSeconds=11]="kSeconds",d[d.kInteger=12]="kInteger",d),eo=((f={})[f.kUNumber=0]="kUNumber",f[f.kUPercent=1]="kUPercent",f[f.kULength=2]="kULength",f[f.kUAngle=3]="kUAngle",f[f.kUTime=4]="kUTime",f[f.kUOther=5]="kUOther",f),es=((v={})[v.kYes=0]="kYes",v[v.kNo=1]="kNo",v),el=((p={})[p.kYes=0]="kYes",p[p.kNo=1]="kNo",p),eu=[{name:"em",unit_type:ea.kEms},{name:"px",unit_type:ea.kPixels},{name:"deg",unit_type:ea.kDegrees},{name:"rad",unit_type:ea.kRadians},{name:"grad",unit_type:ea.kGradians},{name:"ms",unit_type:ea.kMilliseconds},{name:"s",unit_type:ea.kSeconds},{name:"rem",unit_type:ea.kRems},{name:"turn",unit_type:ea.kTurns}],ec=((g={})[g.kUnknownType=0]="kUnknownType",g[g.kUnparsedType=1]="kUnparsedType",g[g.kKeywordType=2]="kKeywordType",g[g.kUnitType=3]="kUnitType",g[g.kSumType=4]="kSumType",g[g.kProductType=5]="kProductType",g[g.kNegateType=6]="kNegateType",g[g.kInvertType=7]="kInvertType",g[g.kMinType=8]="kMinType",g[g.kMaxType=9]="kMaxType",g[g.kClampType=10]="kClampType",g[g.kTransformType=11]="kTransformType",g[g.kPositionType=12]="kPositionType",g[g.kURLImageType=13]="kURLImageType",g[g.kColorType=14]="kColorType",g[g.kUnsupportedColorType=15]="kUnsupportedColorType",g),eh=function(t){switch(t){case ea.kNumber:case ea.kInteger:return eo.kUNumber;case ea.kPercentage:return eo.kUPercent;case ea.kPixels:return eo.kULength;case ea.kMilliseconds:case ea.kSeconds:return eo.kUTime;case ea.kDegrees:case ea.kRadians:case ea.kGradians:case ea.kTurns:return eo.kUAngle;default:return eo.kUOther;}},ed=function(t){switch(t){case eo.kUNumber:return ea.kNumber;case eo.kULength:return ea.kPixels;case eo.kUPercent:return ea.kPercentage;case eo.kUTime:return ea.kSeconds;case eo.kUAngle:return ea.kDegrees;default:return ea.kUnknown;}},ef=function(t){var e=1;switch(t){case ea.kPixels:case ea.kDegrees:case ea.kSeconds:break;case ea.kMilliseconds:e=.001;break;case ea.kRadians:e=180/Math.PI;break;case ea.kGradians:e=.9;break;case ea.kTurns:e=360;}return e;},ev=function(t){switch(t){case ea.kNumber:case ea.kInteger:break;case ea.kPercentage:return"%";case ea.kEms:return"em";case ea.kRems:return"rem";case ea.kPixels:return"px";case ea.kDegrees:return"deg";case ea.kRadians:return"rad";case ea.kGradians:return"grad";case ea.kMilliseconds:return"ms";case ea.kSeconds:return"s";case ea.kTurns:return"turn";}return"";},ep=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"toString",value:function(){return this.buildCSSText(es.kNo,el.kNo,"");}},{key:"isNumericValue",value:function(){return this.getType()>=ec.kUnitType&&this.getType()<=ec.kClampType;}}],[{key:"isAngle",value:function(t){return t===ea.kDegrees||t===ea.kRadians||t===ea.kGradians||t===ea.kTurns;}},{key:"isLength",value:function(t){return t>=ea.kEms&&t<ea.kDegrees;}},{key:"isRelativeUnit",value:function(t){return t===ea.kPercentage||t===ea.kEms||t===ea.kRems;}},{key:"isTime",value:function(t){return t===ea.kSeconds||t===ea.kMilliseconds;}}]),eg=function(t){function e(t){var n;return(0,C.default)(this,e),(n=(0,L.default)(this,e)).colorSpace=t,n;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getType",value:function(){return ec.kColorType;}},{key:"to",value:function(t){return this;}}]);}(ep),ey=((y={})[y.Constant=0]="Constant",y[y.LinearGradient=1]="LinearGradient",y[y.RadialGradient=2]="RadialGradient",y),em=function(t){function e(t,n){var r;return(0,C.default)(this,e),(r=(0,L.default)(this,e)).type=t,r.value=n,r;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return new e(this.type,this.value);}},{key:"buildCSSText",value:function(t,e,n){return n;}},{key:"getType",value:function(){return ec.kColorType;}}]);}(ep),ek=function(t){function e(t){var n;return(0,C.default)(this,e),(n=(0,L.default)(this,e)).value=t,n;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return new e(this.value);}},{key:"getType",value:function(){return ec.kKeywordType;}},{key:"buildCSSText",value:function(t,e,n){return n+this.value;}}]);}(ep),eE=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(Number.isFinite(t)?"NaN":t>0?"infinity":"-infinity")+e;},ex=function(t){return ed(eh(t));},eT=function(t){function e(t){var n,r,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ea.kNumber;return(0,C.default)(this,e),r=(0,L.default)(this,e),i="string"==typeof a?(n=a)?"number"===n?ea.kNumber:"percent"===n||"%"===n?ea.kPercentage:eu.find(function(t){return t.name===n;}).unit_type:ea.kUnknown:a,r.unit=i,r.value=t,r;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return new e(this.value,this.unit);}},{key:"equals",value:function(t){return this.value===t.value&&this.unit===t.unit;}},{key:"getType",value:function(){return ec.kUnitType;}},{key:"convertTo",value:function(t){if(this.unit===t)return new e(this.value,this.unit);var n=ex(this.unit);if(n!==ex(t)||n===ea.kUnknown)return null;var r=ef(this.unit)/ef(t);return new e(this.value*r,t);}},{key:"buildCSSText",value:function(t,e,n){var r;switch(this.unit){case ea.kUnknown:break;case ea.kInteger:r=Number(this.value).toFixed(0);break;case ea.kNumber:case ea.kPercentage:case ea.kEms:case ea.kRems:case ea.kPixels:case ea.kDegrees:case ea.kRadians:case ea.kGradians:case ea.kMilliseconds:case ea.kSeconds:case ea.kTurns:var i=this.value,a=ev(this.unit);if(i<-999999||i>999999){var o=ev(this.unit);r=!Number.isFinite(i)||Number.isNaN(i)?eE(i,o):i+(o||"");}else r="".concat(i).concat(a);}return n+r;}}]);}(ep),eN=new eT(0,"px");new eT(1,"px");var eb=new eT(0,"deg"),eS=function(t){function e(t,n,r){var i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return(0,C.default)(this,e),(i=(0,L.default)(this,e,["rgb"])).r=t,i.g=n,i.b=r,i.alpha=a,i.isNone=o,i;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return new e(this.r,this.g,this.b,this.alpha);}},{key:"buildCSSText",value:function(t,e,n){return"".concat(n,"rgba(").concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")");}}]);}(eg),ew=new ek("unset"),eP={"":ew,unset:ew,initial:new ek("initial"),inherit:new ek("inherit")},eM=new eS(0,0,0,0,!0),eA=new eS(0,0,0,0),eC=ei(function(t,e,n,r){return new eS(t,e,n,r);},function(t,e,n,r){return"rgba(".concat(t,",").concat(e,",").concat(n,",").concat(r,")");}),eR=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ea.kNumber;return new eT(t,e);};new eT(50,"%");var eO=function(){var t={linearGradient:/^(linear\-gradient)/i,repeatingLinearGradient:/^(repeating\-linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,repeatingRadialGradient:/^(repeating\-radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},e="";function n(t){throw Error("".concat(e,": ").concat(t));}function r(){return i("linear-gradient",t.linearGradient,o)||i("repeating-linear-gradient",t.repeatingLinearGradient,o)||i("radial-gradient",t.radialGradient,s)||i("repeating-radial-gradient",t.repeatingRadialGradient,s)||i("conic-gradient",t.conicGradient,s);}function i(e,r,i){return a(r,function(r){var a=i();return a&&!m(t.comma)&&n("Missing comma before color stops"),{type:e,orientation:a,colorStops:d(f)};});}function a(e,r){var i=m(e);if(i){m(t.startCall)||n("Missing (");var a=r(i);return m(t.endCall)||n("Missing )"),a;}}function o(){return y("directional",t.sideOrCorner,1)||y("angular",t.angleValue,1);}function s(){var n,r,i=l();return i&&((n=[]).push(i),r=e,m(t.comma)&&((i=l())?n.push(i):e=r)),n;}function l(){var t,e,n=((t=y("shape",/^(circle)/i,0))&&(t.style=g()||u()),t||((e=y("shape",/^(ellipse)/i,0))&&(e.style=p()||u()),e));if(n)n.at=c();else{var r=u();if(r){n=r;var i=c();i&&(n.at=i);}else{var a=h();a&&(n={type:"default-radial",at:a});}}return n;}function u(){return y("extent-keyword",t.extentKeywords,1);}function c(){if(y("position",/^at/,0)){var t=h();return t||n("Missing positioning value"),t;}}function h(){var t={x:p(),y:p()};if(t.x||t.y)return{type:"position",value:t};}function d(e){var r=e(),i=[];if(r)for(i.push(r);m(t.comma);)(r=e())?i.push(r):n("One extra comma");return i;}function f(){var e=y("hex",t.hexColor,1)||a(t.rgbaColor,function(){return{type:"rgba",value:d(v)};})||a(t.rgbColor,function(){return{type:"rgb",value:d(v)};})||y("literal",t.literalColor,0);return e||n("Expected color definition"),e.length=p(),e;}function v(){return m(t.number)[1];}function p(){return y("%",t.percentageValue,1)||y("position-keyword",t.positionKeywords,1)||g();}function g(){return y("px",t.pixelValue,1)||y("em",t.emValue,1);}function y(t,e,n){var r=m(e);if(r)return{type:t,value:r[n]};}function m(t){var n=/^[\n\r\t\s]+/.exec(e);n&&k(n[0].length);var r=t.exec(e);return r&&k(r[0].length),r;}function k(t){e=e.substring(t);}return function(t){var i;return e=t,i=d(r),e.length>0&&n("Invalid input not EOF"),i;};}(),eL=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,eI=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,eD=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,e_=/[\d.]+:(#[^\s]+|[^\)]+\))/gi,eG={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},eF=ei(function(t){return eR("angular"===t.type?Number(t.value):eG[t.value]||0,"deg");}),eB=ei(function(t){var e=50,n=50,r="%",i="%";if((null==t?void 0:t.type)==="position"){var a=t.value,o=a.x,s=a.y;(null==o?void 0:o.type)==="position-keyword"&&("left"===o.value?e=0:"center"===o.value?e=50:"right"===o.value?e=100:"top"===o.value?n=0:"bottom"===o.value&&(n=100)),(null==s?void 0:s.type)==="position-keyword"&&("left"===s.value?e=0:"center"===s.value?n=50:"right"===s.value?e=100:"top"===s.value?n=0:"bottom"===s.value&&(n=100)),((null==o?void 0:o.type)==="px"||(null==o?void 0:o.type)==="%"||(null==o?void 0:o.type)==="em")&&(r=null==o?void 0:o.type,e=Number(o.value)),((null==s?void 0:s.type)==="px"||(null==s?void 0:s.type)==="%"||(null==s?void 0:s.type)==="em")&&(i=null==s?void 0:s.type,n=Number(s.value));}return{cx:eR(e,r),cy:eR(n,i)};}),eU=ei(function(t){if(t.indexOf("linear")>-1||t.indexOf("radial")>-1)return eO(t).map(function(t){var e=t.type,n=t.orientation,r=t.colorStops;!function(t){var e=t.length;t[e-1].length=null!==(a=t[e-1].length)&&void 0!==a?a:{type:"%",value:"100"},e>1&&(t[0].length=null!==(o=t[0].length)&&void 0!==o?o:{type:"%",value:"0"});for(var n=0,r=Number(t[0].length.value),i=1;i<e;i++){var a,o,s,l=null===(s=t[i].length)||void 0===s?void 0:s.value;if(!(0,F.isNil)(l)&&!(0,F.isNil)(r)){for(var u=1;u<i-n;u++)t[n+u].length={type:"%",value:"".concat(r+(Number(l)-r)*u/(i-n))};n=i,r=Number(l);}}}(r);var i=r.map(function(t){var e,n;return{offset:eR(Number(t.length.value),"%"),color:(e=t.type,n=t.value,"hex"===e?"#".concat(n):"literal"===e?n:"rgb"===e?"rgb(".concat(n.join(","),")"):"rgba(".concat(n.join(","),")"))};});if("linear-gradient"===e)return new em(ey.LinearGradient,{angle:n?eF(n):eb,steps:i});if("radial-gradient"===e&&(n||(n=[{type:"shape",value:"circle"}]),"shape"===n[0].type&&"circle"===n[0].value)){var a,o=eB(n[0].at),s=o.cx,l=o.cy;if(n[0].style){var u=n[0].style,c=u.type,h=u.value;"extent-keyword"===c?(eP[h]||(eP[h]=new ek(h)),a=eP[h]):a=eR(h,c);}return new em(ey.RadialGradient,{cx:s,cy:l,size:a,steps:i});}});var e=t[0];if("("===t[1]||"("===t[2]){if("l"===e){var n=eL.exec(t);if(n){var r,i=(null===(r=n[2].match(e_))||void 0===r?void 0:r.map(function(t){return t.split(":");}))||[];return[new em(ey.LinearGradient,{angle:eR(parseFloat(n[1]),"deg"),steps:i.map(function(t){var e=(0,D.default)(t,2),n=e[0],r=e[1];return{offset:eR(100*Number(n),"%"),color:r};})})];}}else if("r"===e){var a=function(t){var e=eI.exec(t);if(e){var n,r=(null===(n=e[4].match(e_))||void 0===n?void 0:n.map(function(t){return t.split(":");}))||[];return{cx:eR(50,"%"),cy:eR(50,"%"),steps:r.map(function(t){var e=(0,D.default)(t,2),n=e[0],r=e[1];return{offset:eR(100*Number(n),"%"),color:r};})};}return null;}(t);if(a){if(!(0,F.isString)(a))return[new em(ey.RadialGradient,a)];t=a;}}else if("p"===e)return function(t){var e=eD.exec(t);if(e){var n=e[1],r=e[2];switch(n){case"a":n="repeat";break;case"x":n="repeat-x";break;case"y":n="repeat-y";break;default:n="no-repeat";}return{image:r,repetition:n};}return null;}(t);}});function eV(t){return t&&!(0,F.isNil)(t.r)&&!(0,F.isNil)(t.g)&&!(0,F.isNil)(t.b);}var ez=ei(function(t){if((e=t)&&e.image)return(0,A.default)({repetition:"repeat"},t);if((0,F.isNil)(t)&&(t=""),"transparent"===t)return eA;if("currentColor"===t)t="black";else if("none"===t)return eM;var e,n=eU(t);if(n)return n;var r=tJ(t),i=[0,0,0,0];return null!==r&&(i[0]=r.r||0,i[1]=r.g||0,i[2]=r.b||0,i[3]=r.opacity),eC.apply(void 0,i);});function eH(t,e){if(eV(t)&&eV(e))return[[Number(t.r),Number(t.g),Number(t.b),Number(t.alpha)],[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],function(t){var e=t.slice();if(e[3])for(var n=0;n<3;n++)e[n]=Math.round((0,F.clamp)(e[n],0,255));return e[3]=(0,F.clamp)(e[3],0,1),"rgba(".concat(e.join(","),")");}];}function eY(t,e){if((0,F.isNil)(e))return eR(0,"px");if(isFinite(Number(e="".concat(e).trim().toLowerCase()))){if("px".search(t)>=0)return eR(Number(e),"px");if("deg".search(t)>=0)return eR(Number(e),"deg");}var n=[];e=e.replace(t,function(t){return n.push(t),"U".concat(t);});var r="U(".concat(t.source,")");return n.map(function(t){return eR(Number(e.replace(RegExp("U".concat(t),"g"),"").replace(RegExp(r,"g"),"*0")),t);})[0];}var eW=function(t){return eY(/px/g,t);},eq=ei(eW);ei(function(t){return eY(RegExp("%","g"),t);});var eX=function(t){return(0,F.isNumber)(t)||isFinite(Number(t))?eR(Number(t)||0,"px"):eY(RegExp("px|%|em|rem","g"),t);},ej=ei(eX),e$=function(t){return eY(RegExp("deg|rad|grad|turn","g"),t);},eK=ei(e$);function eZ(t){var e=0;return t.unit===ea.kDegrees?e=t.value:t.unit===ea.kRadians?e=Number(t.value)*tv:t.unit===ea.kTurns?e=360*Number(t.value):t.value&&(e=t.value),e;}function eQ(t,e){var n;return(Array.isArray(t)?n=t.map(function(t){return Number(t);}):(0,F.isString)(t)?n=t.split(" ").map(function(t){return Number(t);}):(0,F.isNumber)(t)&&(n=[t]),2===e)?1===n.length?[n[0],n[0]]:[n[0],n[1]]:4===e?1===n.length?[n[0],n[0],n[0],n[0]]:2===n.length?[n[0],n[1],n[0],n[1]]:3===n.length?[n[0],n[1],n[2],n[1]]:[n[0],n[1],n[2],n[3]]:"even"===e&&n.length%2==1?[].concat((0,O.default)(n),(0,O.default)(n)):n;}function eJ(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t.unit===ea.kPixels)return Number(t.value);if(t.unit===ea.kPercentage&&n){var i=n.nodeName===j.GROUP?n.getLocalBounds():n.getGeometryBounds();return(r?i.min[e]:0)+t.value/100*i.halfExtents[e]*2;}return 0;}var e0=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function e1(t){return t.toString();}var e2=function(t){return"number"==typeof t?eR(t):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(t)?eR(Number(t)):eR(0);},e3=ei(e2);function e4(t,e){return[t,e,e1];}function e5(t,e){return function(n,r){return[n,r,function(n){return e1((0,F.clamp)(n,t,e));}];};}function e6(t,e){if(t.length===e.length)return[t,e,function(t){return t;}];}function e7(t){return 0===t.parsedStyle.d.totalLength&&(t.parsedStyle.d.totalLength=(0,F.getTotalLength)(t.parsedStyle.d.absolutePath)),t.parsedStyle.d.totalLength;}function e9(t,e){return t[0]===e[0]&&t[1]===e[1];}function e8(t,e){var n=t.prePoint,r=t.currentPoint,i=t.nextPoint,a=Math.pow(r[0]-n[0],2)+Math.pow(r[1]-n[1],2),o=Math.pow(r[0]-i[0],2)+Math.pow(r[1]-i[1],2),s=Math.acos((a+o-(Math.pow(n[0]-i[0],2)+Math.pow(n[1]-i[1],2)))/(2*Math.sqrt(a)*Math.sqrt(o)));if(!s||0===Math.sin(s)||(0,F.isNumberEqual)(s,0))return{xExtra:0,yExtra:0};var l=Math.abs(Math.atan2(i[1]-r[1],i[0]-r[0])),u=Math.abs(Math.atan2(i[0]-r[0],i[1]-r[1]));return{xExtra:e/2*(1/Math.sin(s/2))*Math.cos(s/2-(l=l>Math.PI/2?Math.PI-l:l))-e/2||0,yExtra:e/2*(1/Math.sin(s/2))*Math.cos((u=u>Math.PI/2?Math.PI-u:u)-s/2)-e/2||0};}function nt(t,e){return[e[0]+(e[0]-t[0]),e[1]+(e[1]-t[1])];}ei(function(t){return(0,F.isString)(t)?t.split(" ").map(e3):t.map(e3);});var ne=function(t,e){var n=t.x*e.x+t.y*e.y,r=Math.sqrt((Math.pow(t.x,2)+Math.pow(t.y,2))*(Math.pow(e.x,2)+Math.pow(e.y,2)));return(t.x*e.y-t.y*e.x<0?-1:1)*Math.acos(n/r);},nn=function(t,e,n,r,i,a,o,s){e=Math.abs(e),n=Math.abs(n);var l=(r=(0,F.mod)(r,360))*tf;if(t.x===o.x&&t.y===o.y)return{x:t.x,y:t.y,ellipticalArcAngle:0};if(0===e||0===n)return{x:0,y:0,ellipticalArcAngle:0};var u=(t.x-o.x)/2,c=(t.y-o.y)/2,h={x:Math.cos(l)*u+Math.sin(l)*c,y:-Math.sin(l)*u+Math.cos(l)*c},d=Math.pow(h.x,2)/Math.pow(e,2)+Math.pow(h.y,2)/Math.pow(n,2);d>1&&(e*=Math.sqrt(d),n*=Math.sqrt(d));var f=(Math.pow(e,2)*Math.pow(n,2)-Math.pow(e,2)*Math.pow(h.y,2)-Math.pow(n,2)*Math.pow(h.x,2))/(Math.pow(e,2)*Math.pow(h.y,2)+Math.pow(n,2)*Math.pow(h.x,2)),v=(i!==a?1:-1)*Math.sqrt(f=f<0?0:f),p={x:v*(e*h.y/n),y:v*(-(n*h.x)/e)},g={x:Math.cos(l)*p.x-Math.sin(l)*p.y+(t.x+o.x)/2,y:Math.sin(l)*p.x+Math.cos(l)*p.y+(t.y+o.y)/2},y={x:(h.x-p.x)/e,y:(h.y-p.y)/n},m=ne({x:1,y:0},y),k=ne(y,{x:(-h.x-p.x)/e,y:(-h.y-p.y)/n});!a&&k>0?k-=2*Math.PI:a&&k<0&&(k+=2*Math.PI);var E=m+(k%=2*Math.PI)*s,x=e*Math.cos(E),T=n*Math.sin(E);return{x:Math.cos(l)*x-Math.sin(l)*T+g.x,y:Math.sin(l)*x+Math.cos(l)*T+g.y,ellipticalArcStartAngle:m,ellipticalArcEndAngle:m+k,ellipticalArcAngle:E,ellipticalArcCenter:g,resultantRx:e,resultantRy:n};};function nr(t,e){var n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=t.arcParams,i=r.rx,a=void 0===i?0:i,o=r.ry,s=void 0===o?0:o,l=r.xRotation,u=r.arcFlag,c=r.sweepFlag,h=nn({x:t.prePoint[0],y:t.prePoint[1]},a,s,l,!!u,!!c,{x:t.currentPoint[0],y:t.currentPoint[1]},e),d=nn({x:t.prePoint[0],y:t.prePoint[1]},a,s,l,!!u,!!c,{x:t.currentPoint[0],y:t.currentPoint[1]},n?e+.005:e-.005),f=d.x-h.x,v=d.y-h.y,p=Math.sqrt(f*f+v*v);return{x:-f/p,y:-v/p};}function ni(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1]);}function na(t,e){return ni(t)*ni(e)?(t[0]*e[0]+t[1]*e[1])/(ni(t)*ni(e)):1;}function no(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(na(t,e));}var ns=function(t){if(""===t||Array.isArray(t)&&0===t.length)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};try{e=(0,F.normalizePath)(t);}catch(n){e=(0,F.normalizePath)(""),console.error("[g]: Invalid SVG Path definition: ".concat(t));}!function(t){for(var e=0;e<t.length;e++){var n=t[e-1],r=t[e];if("M"===r[0]&&n){var i=n[0],a=[r[1],r[2]],o=void 0;"L"===i||"M"===i?o=[n[1],n[2]]:("C"===i||"A"===i||"Q"===i)&&(o=[n[n.length-2],n[n.length-1]]),o&&e9(a,o)&&(t.splice(e,1),e--);}}}(e);var e,n=function(t){for(var e=!1,n=t.length,r=0;r<n;r++){var i=t[r][0];if("C"===i||"A"===i||"Q"===i){e=!0;break;}}return e;}(e),r=function(t){for(var e=[],n=[],r=[],i=0;i<t.length;i++){var a=t[i],o=a[0];"M"===o?(r.length&&(n.push(r),r=[]),r.push([a[1],a[2]])):"Z"===o?r.length&&(e.push(r),r=[]):r.push([a[1],a[2]]);}return r.length>0&&n.push(r),{polygons:e,polylines:n};}(e),i=r.polygons,a=r.polylines,o=function(t){for(var e=[],n=null,r=null,i=null,a=0,o=t.length,s=0;s<o;s++){var l=t[s];r=t[s+1];var u=l[0],c={command:u,prePoint:n,params:l,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(u){case"M":i=[l[1],l[2]],a=s;break;case"A":var h=function(t,e){var n=e[1],r=e[2],i=(0,F.mod)(e[3]*tf,2*Math.PI),a=e[4],o=e[5],s=t[0],l=t[1],u=e[6],c=e[7],h=Math.cos(i)*(s-u)/2+Math.sin(i)*(l-c)/2,d=-1*Math.sin(i)*(s-u)/2+Math.cos(i)*(l-c)/2,f=h*h/(n*n)+d*d/(r*r);f>1&&(n*=Math.sqrt(f),r*=Math.sqrt(f));var v=n*n*(d*d)+r*r*(h*h),p=v?Math.sqrt((n*n*(r*r)-v)/v):1;a===o&&(p*=-1),isNaN(p)&&(p=0);var g=r?p*n*d/r:0,y=n?-(p*r)*h/n:0,m=(s+u)/2+Math.cos(i)*g-Math.sin(i)*y,k=(l+c)/2+Math.sin(i)*g+Math.cos(i)*y,E=[(h-g)/n,(d-y)/r],x=[(-1*h-g)/n,(-1*d-y)/r],T=no([1,0],E),N=no(E,x);return -1>=na(E,x)&&(N=Math.PI),na(E,x)>=1&&(N=0),0===o&&N>0&&(N-=2*Math.PI),1===o&&N<0&&(N+=2*Math.PI),{cx:m,cy:k,rx:e9(t,[u,c])?0:n,ry:e9(t,[u,c])?0:r,startAngle:T,endAngle:T+N,xRotation:i,arcFlag:a,sweepFlag:o};}(n,l);c.arcParams=h;}if("Z"===u)n=i,r=t[a+1];else{var d=l.length;n=[l[d-2],l[d-1]];}r&&"Z"===r[0]&&(r=t[a],e[a]&&(e[a].prePoint=n)),c.currentPoint=n,e[a]&&e9(n,e[a].currentPoint)&&(e[a].prePoint=c.prePoint);var f=r?[r[r.length-2],r[r.length-1]]:null;c.nextPoint=f;var v=c.prePoint;if(["L","H","V"].includes(u))c.startTangent=[v[0]-n[0],v[1]-n[1]],c.endTangent=[n[0]-v[0],n[1]-v[1]];else if("Q"===u){var p=[l[1],l[2]];c.startTangent=[v[0]-p[0],v[1]-p[1]],c.endTangent=[n[0]-p[0],n[1]-p[1]];}else if("T"===u){var g=e[s-1],y=nt(g.currentPoint,v);"Q"===g.command?(c.command="Q",c.startTangent=[v[0]-y[0],v[1]-y[1]],c.endTangent=[n[0]-y[0],n[1]-y[1]]):(c.command="TL",c.startTangent=[v[0]-n[0],v[1]-n[1]],c.endTangent=[n[0]-v[0],n[1]-v[1]]);}else if("C"===u){var m=[l[1],l[2]],k=[l[3],l[4]];c.startTangent=[v[0]-m[0],v[1]-m[1]],c.endTangent=[n[0]-k[0],n[1]-k[1]],0===c.startTangent[0]&&0===c.startTangent[1]&&(c.startTangent=[m[0]-k[0],m[1]-k[1]]),0===c.endTangent[0]&&0===c.endTangent[1]&&(c.endTangent=[k[0]-m[0],k[1]-m[1]]);}else if("S"===u){var E=e[s-1],x=nt(E.currentPoint,v),T=[l[1],l[2]];"C"===E.command?(c.command="C",c.startTangent=[v[0]-x[0],v[1]-x[1]]):(c.command="SQ",c.startTangent=[v[0]-T[0],v[1]-T[1]]),c.endTangent=[n[0]-T[0],n[1]-T[1]];}else if("A"===u){var N=nr(c,0),b=N.x,S=N.y,w=nr(c,1,!1),P=w.x,M=w.y;c.startTangent=[b,S],c.endTangent=[P,M];}e.push(c);}return e;}(e),s=function(t,e){for(var n=[],r=[],i=[],a=0;a<t.length;a++){var o=t[a],s=o.currentPoint,l=o.params,u=o.prePoint,c=void 0;switch(o.command){case"Q":c=(0,z.quadBox)(u[0],u[1],l[1],l[2],l[3],l[4]);break;case"C":c=(0,z.cubicBox)(u[0],u[1],l[1],l[2],l[3],l[4],l[5],l[6]);break;case"A":var h=o.arcParams;c=(0,z.arcBox)(h.cx,h.cy,h.rx,h.ry,h.xRotation,h.startAngle,h.endAngle);break;default:n.push(s[0]),r.push(s[1]);}c&&(o.box=c,n.push(c.x,c.x+c.width),r.push(c.y,c.y+c.height));}n=n.filter(function(t){return!Number.isNaN(t)&&t!==1/0&&t!==-1/0;}),r=r.filter(function(t){return!Number.isNaN(t)&&t!==1/0&&t!==-1/0;});var d=(0,F.min)(n),f=(0,F.min)(r),v=(0,F.max)(n),p=(0,F.max)(r);if(0===i.length)return{x:d,y:f,width:v-d,height:p-f};for(var g=0;g<i.length;g++){var y=i[g],m=y.currentPoint;m[0]===d?d-=e8(y,0).xExtra:m[0]===v&&(v+=e8(y,0).xExtra),m[1]===f?f-=e8(y,e).yExtra:m[1]===p&&(p+=e8(y,e).yExtra);}return{x:d,y:f,width:v-d,height:p-f};}(o,0),l=s.x,u=s.y,c=s.width,h=s.height;return{absolutePath:e,hasArc:n,segments:o,polygons:i,polylines:a,totalLength:0,rect:{x:Number.isFinite(l)?l:0,y:Number.isFinite(u)?u:0,width:Number.isFinite(c)?c:0,height:Number.isFinite(h)?h:0}};},nl=ei(ns);function nu(t){return(0,F.isString)(t)?nl(t):ns(t);}function nc(t,e,n){var r=t.curve,i=e.curve;r&&0!==r.length||(r=(0,F.path2Curve)(t.absolutePath,!1),t.curve=r),i&&0!==i.length||(i=(0,F.path2Curve)(e.absolutePath,!1),e.curve=i);var a=[r,i];r.length!==i.length&&(a=(0,F.equalizeSegments)(r,i));var o=(0,F.getDrawDirection)(a[0])!==(0,F.getDrawDirection)(a[1])?(0,F.reverseCurve)(a[0]):(0,F.clonePath)(a[0]);return[o,(0,F.getRotatedCurve)(a[1],o),function(t){return t;}];}function nh(t,e){return[t.points,e.points,function(t){return t;}];}var nd=/\s*(\w+)\(([^)]*)\)/g;function nf(t){return function(e){var n=0;return t.map(function(t){return null===t?e[n++]:t;});};}function nv(t){return t;}var np={matrix:["NNNNNN",[null,null,0,0,null,null,0,0,0,0,1,0,null,null,0,1],nv],matrix3d:["NNNNNNNNNNNNNNNN",nv],rotate:["A"],rotateX:["A"],rotateY:["A"],rotateZ:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",nf([null,null,new eT(1)]),nv],scaleX:["N",nf([null,new eT(1),new eT(1)]),nf([null,new eT(1)])],scaleY:["N",nf([new eT(1),null,new eT(1)]),nf([new eT(1),null])],scaleZ:["N",nf([new eT(1),new eT(1),null])],scale3d:["NNN",nv],skew:["Aa",null,nv],skewX:["A",null,nf([null,eb])],skewY:["A",null,nf([eb,null])],translate:["Tt",nf([null,null,eN]),nv],translateX:["T",nf([null,eN,eN]),nf([null,eN])],translateY:["T",nf([eN,null,eN]),nf([eN,null])],translateZ:["L",nf([eN,eN,null])],translate3d:["TTL",nv]};function ng(t){for(var e=[],n=t.length,r=0;r<n;r++){var i=t[r],a=i[0],o=i.slice(1);if("translate"===a||"skew"===a?1===o.length&&o.push(0):"scale"===a&&1===o.length&&o.push(o[0]),!np[a])return[];var s=o.map(function(t){return eR(t);});e.push({t:a,d:s});}return e;}function ny(t){if(Array.isArray(t))return ng(t);if("none"===(t=(t||"none").trim()))return[];var e,n=[],r=0;for(nd.lastIndex=0;(e=nd.exec(t))&&e.index===r;){r=e.index+e[0].length;var i=e[1],a=np[i];if(!a)break;var o=e[2].split(","),s=a[0];if(s.length<o.length)break;for(var l=[],u=0;u<s.length;u++){var c=o[u],h=s[u],d=void 0;if(void 0===(d=c?({A:function(t){return"0"===t.trim()?eb:e$(t);},N:e2,T:eX,L:eW})[h.toUpperCase()](c):({a:eb,n:l[0],t:eN})[h]))return[];l.push(d);}if(n.push({t:i,d:l}),nd.lastIndex===t.length)return n;}return[];}function nm(t){switch(t.t){case"rotateX":return[1,0,0,0,0,Math.cos(i=eZ(t.d[0])*tf),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1];case"rotateY":return[Math.cos(i=eZ(t.d[0])*tf),0,-Math.sin(i),0,0,1,0,0,Math.sin(i),0,Math.cos(i),0,0,0,0,1];case"rotate":case"rotateZ":return[Math.cos(i=eZ(t.d[0])*tf),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1,0,0,0,0,1];case"rotate3d":e=t.d[0].value,n=t.d[1].value,r=t.d[2].value,i=eZ(t.d[3])*tf;var e,n,r,i,a=e*e+n*n+r*r;if(0===a)e=1,n=0,r=0;else if(1!==a){var o=Math.sqrt(a);e/=o,n/=o,r/=o;}var s=Math.sin(i/2),l=s*Math.cos(i/2),u=s*s;return[1-2*(n*n+r*r)*u,2*(e*n*u+r*l),2*(e*r*u-n*l),0,2*(e*n*u-r*l),1-2*(e*e+r*r)*u,2*(n*r*u+e*l),0,2*(e*r*u+n*l),2*(n*r*u-e*l),1-2*(e*e+n*n)*u,0,0,0,0,1];case"scale":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scaleX":return[t.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaleY":return[1,0,0,0,0,t.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scaleZ":return[1,0,0,0,0,1,0,0,0,0,t.d[0].value,0,0,0,0,1];case"scale3d":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,t.d[2].value,0,0,0,0,1];case"skew":var c=eZ(t.d[0])*tf;return[1,Math.tan(eZ(t.d[1])*tf),0,0,Math.tan(c),1,0,0,0,0,1,0,0,0,0,1];case"skewX":return[1,0,0,0,Math.tan(i=eZ(t.d[0])*tf),1,0,0,0,0,1,0,0,0,0,1];case"skewY":return[1,Math.tan(i=eZ(t.d[0])*tf),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return[1,0,0,0,0,1,0,0,0,0,1,0,e=eJ(t.d[0],0,null)||0,n=eJ(t.d[1],0,null)||0,0,1];case"translateX":return[1,0,0,0,0,1,0,0,0,0,1,0,e=eJ(t.d[0],0,null)||0,0,0,1];case"translateY":return[1,0,0,0,0,1,0,0,0,0,1,0,0,n=eJ(t.d[0],0,null)||0,0,1];case"translateZ":return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,r=eJ(t.d[0],0,null)||0,1];case"translate3d":return[1,0,0,0,0,1,0,0,0,0,1,0,e=eJ(t.d[0],0,null)||0,n=eJ(t.d[1],0,null)||0,r=eJ(t.d[2],0,null)||0,1];case"perspective":var h=eJ(t.d[0],0,null)||0;return[1,0,0,0,0,1,0,0,0,0,1,h?-1/h:0,0,0,0,1];case"matrix":return[t.d[0].value,t.d[1].value,0,0,t.d[2].value,t.d[3].value,0,0,0,0,1,0,t.d[4].value,t.d[5].value,0,1];case"matrix3d":return t.d.map(function(t){return t.value;});}}function nk(t,e){return[t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12]*e[3],t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13]*e[3],t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]*e[3],t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15]*e[3],t[0]*e[4]+t[4]*e[5]+t[8]*e[6]+t[12]*e[7],t[1]*e[4]+t[5]*e[5]+t[9]*e[6]+t[13]*e[7],t[2]*e[4]+t[6]*e[5]+t[10]*e[6]+t[14]*e[7],t[3]*e[4]+t[7]*e[5]+t[11]*e[6]+t[15]*e[7],t[0]*e[8]+t[4]*e[9]+t[8]*e[10]+t[12]*e[11],t[1]*e[8]+t[5]*e[9]+t[9]*e[10]+t[13]*e[11],t[2]*e[8]+t[6]*e[9]+t[10]*e[10]+t[14]*e[11],t[3]*e[8]+t[7]*e[9]+t[11]*e[10]+t[15]*e[11],t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12]*e[15],t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13]*e[15],t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14]*e[15],t[3]*e[12]+t[7]*e[13]+t[11]*e[14]+t[15]*e[15]];}function nE(t){var e=[0,0,0],n=[1,1,1],r=[0,0,0],i=[0,0,0,1],a=[0,0,0,1];return!function(t,e,n,r,i,a){if(!(!function(t,e){var n=e[15];if(0===n)return!1;for(var r=1/n,i=0;i<16;i++)t[i]=e[i]*r;return!0;}(tm,t)||(G.mat4.copy(tk,tm),tk[3]=0,tk[7]=0,tk[11]=0,tk[15]=1,1e-8>Math.abs(G.mat4.determinant(tk))))){var o=tm[3],s=tm[7],l=tm[11],u=tm[12],c=tm[13],h=tm[14],d=tm[15];if(0!==o||0!==s||0!==l){if(tE[0]=o,tE[1]=s,tE[2]=l,tE[3]=d,!G.mat4.invert(tk,tk))return;G.mat4.transpose(tk,tk),G.vec4.transformMat4(i,tE,tk);}else i[0]=i[1]=i[2]=0,i[3]=1;if(e[0]=u,e[1]=c,e[2]=h,tx[0][0]=tm[0],tx[0][1]=tm[1],tx[0][2]=tm[2],tx[1][0]=tm[4],tx[1][1]=tm[5],tx[1][2]=tm[6],tx[2][0]=tm[8],tx[2][1]=tm[9],tx[2][2]=tm[10],n[0]=G.vec3.length(tx[0]),G.vec3.normalize(tx[0],tx[0]),r[0]=G.vec3.dot(tx[0],tx[1]),tN(tx[1],tx[1],tx[0],1,-r[0]),n[1]=G.vec3.length(tx[1]),G.vec3.normalize(tx[1],tx[1]),r[0]/=n[1],r[1]=G.vec3.dot(tx[0],tx[2]),tN(tx[2],tx[2],tx[0],1,-r[1]),r[2]=G.vec3.dot(tx[1],tx[2]),tN(tx[2],tx[2],tx[1],1,-r[2]),n[2]=G.vec3.length(tx[2]),G.vec3.normalize(tx[2],tx[2]),r[1]/=n[2],r[2]/=n[2],G.vec3.cross(tT,tx[1],tx[2]),0>G.vec3.dot(tx[0],tT))for(var f=0;f<3;f++)n[f]*=-1,tx[f][0]*=-1,tx[f][1]*=-1,tx[f][2]*=-1;a[0]=.5*Math.sqrt(Math.max(1+tx[0][0]-tx[1][1]-tx[2][2],0)),a[1]=.5*Math.sqrt(Math.max(1-tx[0][0]+tx[1][1]-tx[2][2],0)),a[2]=.5*Math.sqrt(Math.max(1-tx[0][0]-tx[1][1]+tx[2][2],0)),a[3]=.5*Math.sqrt(Math.max(1+tx[0][0]+tx[1][1]+tx[2][2],0)),tx[2][1]>tx[1][2]&&(a[0]=-a[0]),tx[0][2]>tx[2][0]&&(a[1]=-a[1]),tx[1][0]>tx[0][1]&&(a[2]=-a[2]);}}(0===t.length?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:t.map(nm).reduce(nk),e,n,r,i,a),[[e,n,r,a,i]];}var nx=function(){function t(t,e){for(var n=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],r=0;r<4;r++)for(var i=0;i<4;i++)for(var a=0;a<4;a++)n[r][i]+=e[r][a]*t[a][i];return n;}return function(e,n,r,i,a){for(var o,s=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],l=0;l<4;l++)s[l][3]=a[l];for(var u=0;u<3;u++)for(var c=0;c<3;c++)s[3][u]+=e[c]*s[c][u];var h=i[0],d=i[1],f=i[2],v=i[3],p=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];p[0][0]=1-2*(d*d+f*f),p[0][1]=2*(h*d-f*v),p[0][2]=2*(h*f+d*v),p[1][0]=2*(h*d+f*v),p[1][1]=1-2*(h*h+f*f),p[1][2]=2*(d*f-h*v),p[2][0]=2*(h*f-d*v),p[2][1]=2*(d*f+h*v),p[2][2]=1-2*(h*h+d*d),s=t(s,p);var g=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];r[2]&&(g[2][1]=r[2],s=t(s,g)),r[1]&&(g[2][1]=0,g[2][0]=r[0],s=t(s,g)),r[0]&&(g[2][0]=0,g[1][0]=r[0],s=t(s,g));for(var y=0;y<3;y++)for(var m=0;m<3;m++)s[y][m]*=n[y];return 0===(o=s)[0][2]&&0===o[0][3]&&0===o[1][2]&&0===o[1][3]&&0===o[2][0]&&0===o[2][1]&&1===o[2][2]&&0===o[2][3]&&0===o[3][2]&&1===o[3][3]?[s[0][0],s[0][1],s[1][0],s[1][1],s[3][0],s[3][1]]:s[0].concat(s[1],s[2],s[3]);};}();function nT(t){return t.toFixed(6).replace(".000000","");}function nN(t,e){var n,r;return(t.decompositionPair!==e&&(t.decompositionPair=e,n=nE(t)),e.decompositionPair!==t&&(e.decompositionPair=t,r=nE(e)),null===n[0]||null===r[0])?[[!1],[!0],function(n){return n?e[0].d:t[0].d;}]:(n[0].push(0),r[0].push(1),[n,r,function(t){var e=function(t,e,n){var r=function(t,e){for(var n=0,r=0;r<t.length;r++)n+=t[r]*e[r];return n;}(t,e);r=(0,F.clamp)(r,-1,1);var i=[];if(1===r)i=t;else for(var a=Math.acos(r),o=1*Math.sin(n*a)/Math.sqrt(1-r*r),s=0;s<4;s++)i.push(t[s]*(Math.cos(n*a)-r*o)+e[s]*o);return i;}(n[0][3],r[0][3],t[5]);return nx(t[0],t[1],t[2],e,t[4]).map(nT).join(",");}]);}function nb(t){return t.replace(/[XY]/,"");}function nS(t){return t.replace(/(X|Y|Z|3d)?$/,"3d");}function nw(t,e,n){var r=!1;if(!t.length||!e.length){t.length||(r=!0,t=e,e=[]);for(var i=0;i<t.length;i++)!function(){var n=t[i],r=n.t,a=n.d,o="scale"===r.substring(0,5)?1:0;e.push({t:r,d:a.map(function(t){return"number"==typeof t?eR(o):eR(o,t.unit);})});}();}var a=[],o=[],s=[];if(t.length!==e.length){var l=nN(t,e);a=[l[0]],o=[l[1]],s=[["matrix",[l[2]]]];}else for(var u=0;u<t.length;u++){var c=t[u].t,h=e[u].t,d=t[u].d,f=e[u].d,v=np[c],p=np[h],g=void 0;if("perspective"===c&&"perspective"===h||("matrix"===c||"matrix3d"===c)&&("matrix"===h||"matrix3d"===h)){var y=nN([t[u]],[e[u]]);a.push(y[0]),o.push(y[1]),s.push(["matrix",[y[2]]]);continue;}if(c===h)g=c;else if(v[2]&&p[2]&&nb(c)===nb(h))g=nb(c),d=v[2](d),f=p[2](f);else if(v[1]&&p[1]&&nS(c)===nS(h))g=nS(c),d=v[1](d),f=p[1](f);else{var m=nN(t,e);a=[m[0]],o=[m[1]],s=[["matrix",[m[2]]]];break;}for(var k=[],E=[],x=[],T=0;T<d.length;T++){var N=function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a="",o=t.value||0,s=e.value||0,l=ex(t.unit),u=t.convertTo(l),c=e.convertTo(l);return u&&c?(o=u.value,s=c.value,a=ev(t.unit)):(eT.isLength(t.unit)||eT.isLength(e.unit))&&(o=eJ(t,i,n),s=eJ(e,i,n),a="px"),[o,s,function(t){return r&&(t=Math.max(t,0)),t+a;}];}(d[T],f[T],n,!1,T);k[T]=N[0],E[T]=N[1],x.push(N[2]);}a.push(k),o.push(E),s.push([g,x]);}if(r){var b=a;a=o,o=b;}return[a,o,function(t){return t.map(function(t,e){var n=t.map(function(t,n){return s[e][1][n](t);}).join(",");return"matrix"===s[e][0]&&16===n.split(",").length&&(s[e][0]="matrix3d"),"matrix3d"===s[e][0]&&6===n.split(",").length&&(s[e][0]="matrix"),"".concat(s[e][0],"(").concat(n,")");}).join(" ");}];}var nP=ei(function(t){if((0,F.isString)(t)){if("text-anchor"===t)return[eR(0,"px"),eR(0,"px")];var e=t.split(" ");return(1===e.length&&("top"===e[0]||"bottom"===e[0]?(e[1]=e[0],e[0]="center"):e[1]="center"),2!==e.length)?null:[ej(nM(e[0])),ej(nM(e[1]))];}return[eR(t[0]||0,"px"),eR(t[1]||0,"px")];});function nM(t){return"center"===t?"50%":"left"===t||"top"===t?"0%":"right"===t||"bottom"===t?"100%":t;}var nA=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:t_.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:t_.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:t_.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:t_.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:t_.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:t_.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:t_.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:t_.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:t_.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:t_.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:t_.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:t_.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:t_.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:t_.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:t_.FILTER},{n:"clipPath",syntax:t_.DEFINED_PATH},{n:"textPath",syntax:t_.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:t_.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:t_.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:t_.COORDINATE},{n:"y1",int:!0,l:!0,syntax:t_.COORDINATE},{n:"z1",int:!0,l:!0,syntax:t_.COORDINATE},{n:"x2",int:!0,l:!0,syntax:t_.COORDINATE},{n:"y2",int:!0,l:!0,syntax:t_.COORDINATE},{n:"z2",int:!0,l:!0,syntax:t_.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:t_.PATH,p:50},{n:"points",int:!0,l:!0,syntax:t_.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:t_.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:t_.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:t_.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:t_.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:t_.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:t_.NUMBER,d:function(t){return t===j.PATH||t===j.POLYGON||t===j.POLYLINE?"4":"10";}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:t_.MARKER},{n:"markerEnd",syntax:t_.MARKER},{n:"markerMid",syntax:t_.MARKER},{n:"markerStartOffset",syntax:t_.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:t_.LENGTH,l:!0,int:!0,d:"0"}],nC=new Set(nA.filter(function(t){return!!t.l;}).map(function(t){return t.n;})),nR={},nO=(0,R.default)(function t(e){var n=this;(0,C.default)(this,t),this.runtime=e,nA.forEach(function(t){n.registerMetadata(t);});},[{key:"registerMetadata",value:function(t){[t.n].concat((0,O.default)(t.a||[])).forEach(function(e){nR[e]=t;});}},{key:"getPropertySyntax",value:function(t){return this.runtime.CSSPropertySyntaxFactory[t];}},{key:"processProperties",value:function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[],memoize:!0};Object.assign(t.attributes,e);var i=t.parsedStyle.clipPath,a=t.parsedStyle.offsetPath;!function(t,e){var n=nL(t);for(var r in e)n.has(r)&&(t.parsedStyle[r]=e[r]);}(t,e);var o=!!r.forceUpdateGeometry;if(!o){for(var s in e)if(nC.has(s)){o=!0;break;}}var l=nL(t);l.has("fill")&&e.fill&&(t.parsedStyle.fill=ez(e.fill)),l.has("stroke")&&e.stroke&&(t.parsedStyle.stroke=ez(e.stroke)),l.has("shadowColor")&&e.shadowColor&&(t.parsedStyle.shadowColor=ez(e.shadowColor)),l.has("filter")&&e.filter&&(t.parsedStyle.filter=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if("none"===(e=e.toLowerCase().trim()))return[];for(var n=/\s*([\w-]+)\(([^)]*)\)/g,r=[],i=0;(t=n.exec(e))&&t.index===i;)if(i=t.index+t[0].length,e0.indexOf(t[1])>-1&&r.push({name:t[1],params:t[2].split(" ").map(function(t){return eY(/deg|rad|grad|turn|px|%/g,t)||ez(t);})}),n.lastIndex===e.length)return r;return[];}(e.filter)),l.has("radius")&&!(0,F.isNil)(e.radius)&&(t.parsedStyle.radius=eQ(e.radius,4)),l.has("lineDash")&&!(0,F.isNil)(e.lineDash)&&(t.parsedStyle.lineDash=eQ(e.lineDash,"even")),l.has("points")&&e.points&&(t.parsedStyle.points=(n=e.points,{points:(0,F.isString)(n)?n.split(" ").map(function(t){var e=t.split(","),n=(0,D.default)(e,2),r=n[0],i=n[1];return[Number(r),Number(i)];}):n,totalLength:0,segments:[]})),l.has("d")&&""===e.d&&(t.parsedStyle.d=(0,A.default)({},tD)),l.has("d")&&e.d&&(t.parsedStyle.d=nu(e.d)),l.has("textTransform")&&e.textTransform&&this.runtime.CSSPropertySyntaxFactory[t_.TEXT_TRANSFORM].calculator(null,null,{value:e.textTransform},t,null),l.has("clipPath")&&!(0,F.isUndefined)(e.clipPath)&&this.runtime.CSSPropertySyntaxFactory[t_.DEFINED_PATH].calculator("clipPath",i,e.clipPath,t,this.runtime),l.has("offsetPath")&&e.offsetPath&&this.runtime.CSSPropertySyntaxFactory[t_.DEFINED_PATH].calculator("offsetPath",a,e.offsetPath,t,this.runtime),l.has("transform")&&e.transform&&(t.parsedStyle.transform=function(t){if(Array.isArray(t))return ng(t);if("none"===(t=(t||"none").trim()))return[];var e,n=[],r=0;for(nd.lastIndex=0;(e=nd.exec(t))&&e.index===r;){r=e.index+e[0].length;var i=e[1],a=np[i];if(!a)break;var o=e[2].split(","),s=a[0];if(s.length<o.length)break;for(var l=[],u=0;u<s.length;u++){var c=o[u],h=s[u],d=void 0;if(void 0===(d=c?({A:function(t){return"0"===t.trim()?eb:eK(t);},N:e3,T:ej,L:eq})[h.toUpperCase()](c):({a:eb,n:l[0],t:eN})[h]))return[];l.push(d);}if(n.push({t:i,d:l}),nd.lastIndex===t.length)return n;}return[];}(e.transform)),l.has("transformOrigin")&&e.transformOrigin&&(t.parsedStyle.transformOrigin=nP(e.transformOrigin)),l.has("markerStart")&&e.markerStart&&(t.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory[t_.MARKER].calculator(null,e.markerStart,e.markerStart,null,null)),l.has("markerEnd")&&e.markerEnd&&(t.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory[t_.MARKER].calculator(null,e.markerEnd,e.markerEnd,null,null)),l.has("markerMid")&&e.markerMid&&(t.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory[t_.MARKER].calculator("",e.markerMid,e.markerMid,null,null)),l.has("zIndex")&&!(0,F.isNil)(e.zIndex)&&this.runtime.CSSPropertySyntaxFactory[t_.Z_INDEX].postProcessor(t),l.has("offsetDistance")&&!(0,F.isNil)(e.offsetDistance)&&this.runtime.CSSPropertySyntaxFactory[t_.OFFSET_DISTANCE].postProcessor(t),l.has("transform")&&e.transform&&this.runtime.CSSPropertySyntaxFactory[t_.TRANSFORM].postProcessor(t),l.has("transformOrigin")&&e.transformOrigin&&this.runtime.CSSPropertySyntaxFactory[t_.TRANSFORM_ORIGIN].postProcessor(t),o&&(t.dirty(!0,!0),r.forceUpdateGeometry||this.runtime.sceneGraphService.dirtyToRoot(t));}},{key:"updateGeometry",value:function(t){var e=t.nodeName,n=this.runtime.geometryUpdaterFactory[e];if(n){var r=t.geometry;r.contentBounds||(r.contentBounds=new tr),r.renderBounds||(r.renderBounds=new tr);var i=t.parsedStyle,a=n.update(i,t),o=a.cx,s=a.cy,l=a.cz,u=a.hwidth,c=void 0===u?0:u,h=a.hheight,d=void 0===h?0:h,f=a.hdepth,v=[Math.abs(c),Math.abs(d),void 0===f?0:f],p=i.stroke,g=i.lineWidth,y=i.increasedLineWidthForHitTesting,m=i.shadowType,k=void 0===m?"outer":m,E=i.shadowColor,x=i.filter,T=i.transformOrigin,N=[void 0===o?0:o,void 0===s?0:s,void 0===l?0:l];r.contentBounds.update(N,v);var b=e===j.POLYLINE||e===j.POLYGON||e===j.PATH?Math.SQRT2:.5;if(p&&!p.isNone){var S=(((void 0===g?1:g)||0)+((void 0===y?0:y)||0))*b;v[0]+=S,v[1]+=S;}if(r.renderBounds.update(N,v),E&&k&&"inner"!==k){var w=r.renderBounds,P=w.min,M=w.max,A=i.shadowBlur,C=i.shadowOffsetX,R=i.shadowOffsetY,O=A||0,L=C||0,I=R||0,D=P[0]-O+L,_=M[0]+O+L,F=P[1]-O+I,B=M[1]+O+I;P[0]=Math.min(P[0],D),M[0]=Math.max(M[0],_),P[1]=Math.min(P[1],F),M[1]=Math.max(M[1],B),r.renderBounds.setMinMax(P,M);}(void 0===x?[]:x).forEach(function(t){var e=t.name,n=t.params;if("blur"===e){var i=n[0].value;r.renderBounds.update(r.renderBounds.center,G.vec3.add(r.renderBounds.halfExtents,r.renderBounds.halfExtents,[i,i,0]));}else if("drop-shadow"===e){var a=n[0].value,o=n[1].value,s=n[2].value,l=r.renderBounds,u=l.min,c=l.max,h=u[0]-s+a,d=c[0]+s+a,f=u[1]-s+o,v=c[1]+s+o;u[0]=Math.min(u[0],h),c[0]=Math.max(c[0],d),u[1]=Math.min(u[1],f),c[1]=Math.max(c[1],v),r.renderBounds.setMinMax(u,c);}}),t.geometry.dirty=!1;var U=d<0,V=(c<0?-1:1)*(T?eJ(T[0],0,t,!0):0),z=(U?-1:1)*(T?eJ(T[1],1,t,!0):0);(V||z)&&t.setOrigin(V,z);}}},{key:"updateSizeAttenuation",value:function(t,e){t.style.isSizeAttenuation?(t.style.rawLineWidth||(t.style.rawLineWidth=t.style.lineWidth),t.style.lineWidth=(t.style.rawLineWidth||1)/e,t.nodeName===j.CIRCLE&&(t.style.rawR||(t.style.rawR=t.style.r),t.style.r=(t.style.rawR||1)/e)):(t.style.rawLineWidth&&(t.style.lineWidth=t.style.rawLineWidth,delete t.style.rawLineWidth),t.nodeName===j.CIRCLE&&t.style.rawR&&(t.style.r=t.style.rawR,delete t.style.rawR));}}]);function nL(t){return t.constructor.PARSED_STYLE_LIST;}var nI=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e4;},[{key:"calculator",value:function(t,e,n,r){return eZ(n);}}]),nD=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r,i){return n instanceof ek&&(n=null),i.sceneGraphService.updateDisplayObjectDependency(t,e,n,r),"clipPath"===t&&r.forEach(function(t){0===t.childNodes.length&&i.sceneGraphService.dirtyToRoot(t);}),n;}}]),n_=(0,R.default)(function t(){(0,C.default)(this,t),this.parser=ez,this.mixer=eH;},[{key:"calculator",value:function(t,e,n,r){return n instanceof ek?"none"===n.value?eM:eA:n;}}]),nG=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n){return n instanceof ek?[]:n;}}]);function nF(t){var e=t.parsedStyle.fontSize;return(0,F.isNil)(e)?null:e;}var nB=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e4;},[{key:"calculator",value:function(t,e,n,r,i){if((0,F.isNumber)(n))return n;if(!eT.isRelativeUnit(n.unit))return n.value;if(n.unit===ea.kPercentage)return 0;if(n.unit===ea.kEms){if(r.parentNode){var a,o=nF(r.parentNode);if(o)return o*n.value;}return 0;}if(n.unit===ea.kRems){if(null!=r&&null!==(a=r.ownerDocument)&&void 0!==a&&a.documentElement){var s=nF(r.ownerDocument.documentElement);if(s)return s*n.value;}return 0;}}}]),nU=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e6;},[{key:"calculator",value:function(t,e,n){return n.map(function(t){return t.value;});}}]),nV=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e6;},[{key:"calculator",value:function(t,e,n){return n.map(function(t){return t.value;});}}]),nz=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){n instanceof ek&&(n=null);var i,a=null===(i=n)||void 0===i?void 0:i.cloneNode(!0);return a&&(a.style.isMarker=!0),a;}}]),nH=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e4;},[{key:"calculator",value:function(t,e,n){return n.value;}}]),nY=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e5(0,1);},[{key:"calculator",value:function(t,e,n){return n.value;}},{key:"postProcessor",value:function(t){var e=t.parsedStyle,n=e.offsetPath,r=e.offsetDistance;if(n){var i=n.nodeName;if(i===j.LINE||i===j.PATH||i===j.POLYLINE){var a=n.getPoint(r);a&&t.setLocalPosition(a.x,a.y);}}}}]),nW=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e5(0,1);},[{key:"calculator",value:function(t,e,n){return n.value;}}]),nq=(0,R.default)(function t(){(0,C.default)(this,t),this.parser=nu,this.mixer=nc;},[{key:"calculator",value:function(t,e,n){return n instanceof ek&&"unset"===n.value?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new tl(0,0,0,0)}:n;}}]),nX=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=nh;}),nj=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).mixer=e5(0,1/0),t;}return(0,I.default)(e,t),(0,R.default)(e);}(nB),n$=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){return n instanceof ek?"unset"===n.value?"":n.value:"".concat(n);}},{key:"postProcessor",value:function(t){t.nodeValue="".concat(t.parsedStyle.text)||"";}}]),nK=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){var i=r.getAttribute("text");if(i){var a=i;"capitalize"===n.value?a=i.charAt(0).toUpperCase()+i.slice(1):"lowercase"===n.value?a=i.toLowerCase():"uppercase"===n.value&&(a=i.toUpperCase()),r.parsedStyle.text=a;}return n.value;}}]);function nZ(t,e){var n=Number(t.parsedStyle.zIndex||0),r=Number(e.parsedStyle.zIndex||0);if(n===r){var i=t.parentNode;if(i){var a=i.childNodes||[];return a.indexOf(t)-a.indexOf(e);}}return n-r;}new WeakMap,"undefined"!=typeof window&&window.document;var nQ={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},nJ="object"==typeof performance&&performance.now?performance:Date;function n0(t){return t.nodeName===j.FRAGMENT||t.getRootNode().nodeName===j.FRAGMENT;}var n1=1,n2="object"==typeof self&&self.self===self?self:"object"==typeof X&&X.global===X?X:{},n3=Date.now(),n4={},n5=Date.now(),n6=function(t){if("function"!=typeof t)throw TypeError("".concat(t," is not a function"));var e=Date.now(),n=e-n5,r=n1++;return n4[r]=t,Object.keys(n4).length>1||setTimeout(function(){n5=e;var t=n4;n4={},Object.keys(t).forEach(function(e){return t[e](n2.performance&&"function"==typeof n2.performance.now?n2.performance.now():Date.now()-n3);});},n>16?0:16-n),r;},n7=function(t){return"string"!=typeof t?n6:""===t?n2.requestAnimationFrame:n2["".concat(t,"RequestAnimationFrame")];},n9=function(t,e){for(var n=0;void 0!==t[n];){if(e(t[n]))return t[n];n+=1;}}(["","webkit","moz","ms","o"],function(t){return!!n7(t);}),n8=n7(n9),rt="string"!=typeof n9?function(t){delete n4[t];}:""===n9?n2.cancelAnimationFrame:n2["".concat(n9,"CancelAnimationFrame")]||n2["".concat(n9,"CancelRequestAnimationFrame")];n2.requestAnimationFrame=n8,n2.cancelAnimationFrame=rt;var re=(0,R.default)(function t(){(0,C.default)(this,t),this.callbacks=[];},[{key:"getCallbacksNum",value:function(){return this.callbacks.length;}},{key:"tapPromise",value:function(t,e){this.callbacks.push(e);}},{key:"promise",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return Promise.all(this.callbacks.map(function(t){return t.apply(void 0,e);}));}}]),rn=(0,R.default)(function t(){(0,C.default)(this,t),this.callbacks=[];},[{key:"tapPromise",value:function(t,e){this.callbacks.push(e);}},{key:"promise",value:(m=(0,Y.default)((0,H.default)().mark(function t(){var e,n,r,i,a=arguments;return(0,H.default)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.callbacks.length){t.next=6;break;}return t.next=1,(e=this.callbacks)[0].apply(e,a);case 1:n=t.sent,r=1;case 2:if(!(r<this.callbacks.length)){t.next=5;break;}return i=this.callbacks[r],t.next=3,i(n);case 3:n=t.sent;case 4:r++,t.next=2;break;case 5:return t.abrupt("return",n);case 6:return t.abrupt("return",null);case 7:case"end":return t.stop();}},t,this);})),function(){return m.apply(this,arguments);})}]),rr=(0,R.default)(function t(){(0,C.default)(this,t),this.callbacks=[];},[{key:"tap",value:function(t,e){this.callbacks.push(e);}},{key:"call",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=arguments;this.callbacks.forEach(function(t){t.apply(void 0,r);});}}]),ri=(0,R.default)(function t(){(0,C.default)(this,t),this.callbacks=[];},[{key:"tap",value:function(t,e){this.callbacks.push(e);}},{key:"call",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];if(this.callbacks.length){for(var r=arguments,i=this.callbacks[0].apply(void 0,r),a=1;a<this.callbacks.length;a++)i=(0,this.callbacks[a])(i);return i;}return null;}}]),ra=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],ro=/([\"\'])[^\'\"]+\1/;function rs(t){var e=t.fontSize,n=t.fontFamily,r=t.fontStyle,i=t.fontVariant,a=t.fontWeight;return{fontSize:void 0===e?16:e,fontFamily:void 0===n?"sans-serif":n,fontStyle:void 0===r?"normal":r,fontVariant:void 0===i?"normal":i,fontWeight:void 0===a?"normal":a};}var rl=ei(function(t){for(var e=rs(t),n=e.fontSize,r=e.fontFamily,i=e.fontStyle,a=e.fontVariant,o=e.fontWeight,s=(0,F.isNumber)(n)&&"".concat(n,"px")||"16px",l=r.split(","),u=l.length-1;u>=0;u--){var c=l[u].trim();!ro.test(c)&&0>ra.indexOf(c)&&(c='"'.concat(c,'"')),l[u]=c;}return"".concat(i," ").concat(a," ").concat(o," ").concat(s," ").concat(l.join(","));},function(t){var e=rs(t),n=e.fontSize,r=e.fontFamily,i=e.fontStyle,a=e.fontVariant,o=e.fontWeight;return"".concat(i,"_").concat(a,"_").concat(o,"_").concat(n,"_").concat(r);}),ru=function(t){return Math.max(t,1e-6);};function rc(t,e,n){return G.mat4.identity(t),t[4]=Math.tan(e),t[1]=Math.tan(n),t;}var rh=G.mat4.create(),rd=G.mat4.create(),rf={scale:function(t){G.mat4.fromScaling(rh,[t[0].value,t[1].value,1].map(function(t){return ru(t);}));},scaleX:function(t){G.mat4.fromScaling(rh,[t[0].value,1,1].map(function(t){return ru(t);}));},scaleY:function(t){G.mat4.fromScaling(rh,[1,t[0].value,1].map(function(t){return ru(t);}));},scaleZ:function(t){G.mat4.fromScaling(rh,[1,1,t[0].value].map(function(t){return ru(t);}));},scale3d:function(t){G.mat4.fromScaling(rh,[t[0].value,t[1].value,t[2].value].map(function(t){return ru(t);}));},translate:function(t){G.mat4.fromTranslation(rh,[t[0].value,t[1].value,0]);},translateX:function(t){G.mat4.fromTranslation(rh,[t[0].value,0,0]);},translateY:function(t){G.mat4.fromTranslation(rh,[0,t[0].value,0]);},translateZ:function(t){G.mat4.fromTranslation(rh,[0,0,t[0].value]);},translate3d:function(t){G.mat4.fromTranslation(rh,[t[0].value,t[1].value,t[2].value]);},rotate:function(t){G.mat4.fromZRotation(rh,eZ(t[0])*tf);},rotateX:function(t){G.mat4.fromXRotation(rh,eZ(t[0])*tf);},rotateY:function(t){G.mat4.fromYRotation(rh,eZ(t[0])*tf);},rotateZ:function(t){G.mat4.fromZRotation(rh,eZ(t[0])*tf);},rotate3d:function(t){G.mat4.fromRotation(rh,eZ(t[3])*tf,[t[0].value,t[1].value,t[2].value]);},skew:function(t){rc(rh,t[0].value*tf,t[1].value*tf);},skewX:function(t){rc(rh,t[0].value*tf,0);},skewY:function(t){rc(rh,0,t[0].value*tf);},matrix:function(t){G.mat4.set(rh,t[0].value,t[1].value,0,0,t[2].value,t[3].value,0,0,0,0,1,0,t[4].value,t[5].value,0,1);},matrix3d:function(t){G.mat4.set.apply(G.mat4,[rh].concat((0,O.default)(t.map(function(t){return t.value;}))));}},rv=G.vec3.fromValues(1,1,1),rp=G.vec3.create(),rg={translate:function(t,e){ir.sceneGraphService.setLocalScale(t,rv,!1),ir.sceneGraphService.setLocalEulerAngles(t,rp,void 0,void 0,!1),ir.sceneGraphService.setLocalPosition(t,[e[0].value,e[1].value,0],!1),ir.sceneGraphService.dirtyLocalTransform(t,t.transformable);}},ry=(0,R.default)(function t(){(0,C.default)(this,t),this.parser=ny,this.mixer=nw;},[{key:"calculator",value:function(t,e,n,r){return n instanceof ek?[]:n;}},{key:"postProcessor",value:function(t){!function(t,e){if(t.length){if(1===t.length&&rg[t[0].t]){rg[t[0].t](e,t[0].d);return;}for(var n=G.mat4.identity(rd),r=0;r<t.length;r++){var i=t[r],a=i.t,o=i.d,s=rf[a];s&&(s(o),G.mat4.mul(n,n,rh));}e.setLocalTransform(n);}else e.resetLocalTransform();e.getLocalTransform();}(t.parsedStyle.transform,t);}}]),rm=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"postProcessor",value:function(t){var e=t.parsedStyle.transformOrigin;e[0].unit===ea.kPixels&&e[1].unit===ea.kPixels?t.setOrigin(e[0].value,e[1].value):t.getGeometryBounds();}}]),rk=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){return n.value;}},{key:"postProcessor",value:function(t){if(t.parentNode){var e=t.parentNode,n=e.renderable,r=e.sortable;n&&e.dirty(),r&&(r.dirty=!0,r.dirtyReason=tC.Z_INDEX_CHANGED);}}}]),rE=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){var n=t.cx,r=t.cy,i=t.r,a=void 0===i?0:i;return{cx:void 0===n?0:n,cy:void 0===r?0:r,hwidth:a,hheight:a};}}]),rx=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){var n=t.cx,r=t.cy,i=t.rx,a=t.ry;return{cx:void 0===n?0:n,cy:void 0===r?0:r,hwidth:void 0===i?0:i,hheight:void 0===a?0:a};}}]),rT=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t){var e=t.x1,n=t.y1,r=t.x2,i=t.y2,a=Math.min(e,r),o=Math.min(n,i),s=(Math.max(e,r)-a)/2,l=(Math.max(n,i)-o)/2;return{cx:a+s,cy:o+l,hwidth:s,hheight:l};}}]),rN=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t){var e=t.d.rect,n=e.x,r=e.y,i=e.width,a=e.height,o=i/2,s=a/2;return{cx:n+o,cy:r+s,hwidth:o,hheight:s};}}]),rb=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t){if(t.points&&(0,F.isArray)(t.points.points)){var e=t.points.points,n=Math.min.apply(Math,(0,O.default)(e.map(function(t){return t[0];}))),r=Math.max.apply(Math,(0,O.default)(e.map(function(t){return t[0];}))),i=Math.min.apply(Math,(0,O.default)(e.map(function(t){return t[1];}))),a=Math.max.apply(Math,(0,O.default)(e.map(function(t){return t[1];}))),o=(r-n)/2,s=(a-i)/2;return{cx:n+o,cy:i+s,hwidth:o,hheight:s};}return{cx:0,cy:0,hwidth:0,hheight:0};}}]),rS=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){var n=t.x,r=t.y,i=t.src,a=t.width,o=t.height,s=void 0===a?0:a,l=void 0===o?0:o;return!i||(0,F.isString)(i)||(s||(s=i.width,t.width=s),l||(l=i.height,t.height=l)),{cx:(void 0===n?0:n)+s/2,cy:(void 0===r?0:r)+l/2,hwidth:s/2,hheight:l/2};}}]),rw=(0,R.default)(function t(e){(0,C.default)(this,t),this.globalRuntime=e;},[{key:"isReadyToMeasure",value:function(t,e){return t.text;}},{key:"update",value:function(t,e){var n,r=t.text,i=t.textAlign,a=void 0===i?"start":i,o=t.lineWidth,s=void 0===o?1:o,l=t.textBaseline,u=void 0===l?"alphabetic":l,c=t.dx,h=void 0===c?0:c,d=t.dy,f=void 0===d?0:d,v=t.x,p=t.y;if(!this.isReadyToMeasure(t,e))return t.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var g=((null==e||null===(n=e.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n?void 0:n.getConfig())||{}).offscreenCanvas,y=this.globalRuntime.textService.measureText(r,t,g);t.metrics=y;var m=y.width,k=y.height,E=m/2,x=k/2,T=(void 0===v?0:v)+E;"center"===a||"middle"===a?T+=s/2-E:("right"===a||"end"===a)&&(T+=s-2*E);var N=(void 0===p?0:p)-x;return"middle"===u?N+=x:"top"===u||"hanging"===u?N+=2*x:"alphabetic"===u||("bottom"===u||"ideographic"===u)&&(N+=0),h&&(T+=h),f&&(N+=f),{cx:T,cy:N,hwidth:E,hheight:x};}}]),rP=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){return{cx:0,cy:0,hwidth:0,hheight:0};}}]),rM=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){var n=t.x,r=t.y,i=t.width,a=void 0===i?0:i,o=t.height,s=void 0===o?0:o;return{cx:(void 0===n?0:n)+a/2,cy:(void 0===r?0:r)+s/2,hwidth:a/2,hheight:s/2};}}]),rA=(0,R.default)(function t(e){(0,C.default)(this,t),this.eventPhase=t.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new ts,this.page=new ts,this.canvas=new ts,this.viewport=new ts,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e;},[{key:"name",get:function(){return this.type;}},{key:"layerX",get:function(){return this.layer.x;}},{key:"layerY",get:function(){return this.layer.y;}},{key:"pageX",get:function(){return this.page.x;}},{key:"pageY",get:function(){return this.page.y;}},{key:"x",get:function(){return this.canvas.x;}},{key:"y",get:function(){return this.canvas.y;}},{key:"canvasX",get:function(){return this.canvas.x;}},{key:"canvasY",get:function(){return this.canvas.y;}},{key:"viewportX",get:function(){return this.viewport.x;}},{key:"viewportY",get:function(){return this.viewport.y;}},{key:"composedPath",value:function(){return this.manager&&(!this.path||this.path[0]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path;}},{key:"propagationPath",get:function(){return this.composedPath();}},{key:"preventDefault",value:function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0;}},{key:"stopImmediatePropagation",value:function(){this.propagationImmediatelyStopped=!0;}},{key:"stopPropagation",value:function(){this.propagationStopped=!0;}},{key:"initEvent",value:function(){}},{key:"initUIEvent",value:function(){}},{key:"clone",value:function(){throw Error(tu);}}]),rC=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).client=new ts,t.movement=new ts,t.offset=new ts,t.global=new ts,t.screen=new ts,t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clientX",get:function(){return this.client.x;}},{key:"clientY",get:function(){return this.client.y;}},{key:"movementX",get:function(){return this.movement.x;}},{key:"movementY",get:function(){return this.movement.y;}},{key:"offsetX",get:function(){return this.offset.x;}},{key:"offsetY",get:function(){return this.offset.y;}},{key:"globalX",get:function(){return this.global.x;}},{key:"globalY",get:function(){return this.global.y;}},{key:"screenX",get:function(){return this.screen.x;}},{key:"screenY",get:function(){return this.screen.y;}},{key:"getModifierState",value:function(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t);}},{key:"initMouseEvent",value:function(){throw Error(tu);}}]);}(rA),rR=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).width=0,t.height=0,t.isPrimary=!1,t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getCoalescedEvents",value:function(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[];}},{key:"getPredictedEvents",value:function(){throw Error("getPredictedEvents is not supported!");}},{key:"clone",value:function(){return this.manager.clonePointerEvent(this);}}]);}(rC),rO=function(t){function e(){return(0,C.default)(this,e),(0,L.default)(this,e,arguments);}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return this.manager.cloneWheelEvent(this);}}]);}(rC),rL=function(t){function e(t,n){var r;return(0,C.default)(this,e),(r=(0,L.default)(this,e,[null])).type=t,r.detail=null==n?void 0:n.detail,!n||"detail"in n||(r.detail=n),Object.assign(r,n),r;}return(0,I.default)(e,t),(0,R.default)(e);}(rA),rI=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).shadow=!1,t.ownerDocument=null,t.isConnected=!1,t.baseURI="",t.childNodes=[],t.nodeType=0,t.nodeName="",t.nodeValue=null,t.mutations=void 0,t.parentNode=null,t.destroyed=!1,t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"textContent",get:function(){var t="";this.nodeName===j.TEXT&&(t+=this.style.text);var e,n=(0,W.default)(this.childNodes);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.nodeName===j.TEXT?t+=r.nodeValue:t+=r.textContent;}}catch(t){n.e(t);}finally{n.f();}return t;},set:function(t){var e=this;this.childNodes.slice().forEach(function(t){e.removeChild(t);}),this.nodeName===j.TEXT&&(this.style.text="".concat(t));}},{key:"getRootNode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.parentNode?this.parentNode.getRootNode(t):t.composed&&this.host?this.host.getRootNode(t):this;}},{key:"hasChildNodes",value:function(){return this.childNodes.length>0;}},{key:"isDefaultNamespace",value:function(t){throw Error(tu);}},{key:"lookupNamespaceURI",value:function(t){throw Error(tu);}},{key:"lookupPrefix",value:function(t){throw Error(tu);}},{key:"normalize",value:function(){throw Error(tu);}},{key:"isEqualNode",value:function(t){return this===t;}},{key:"isSameNode",value:function(t){return this.isEqualNode(t);}},{key:"parent",get:function(){return this.parentNode;}},{key:"parentElement",get:function(){return null;}},{key:"nextSibling",get:function(){return null;}},{key:"previousSibling",get:function(){return null;}},{key:"firstChild",get:function(){return this.childNodes.length>0?this.childNodes[0]:null;}},{key:"lastChild",get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null;}},{key:"compareDocumentPosition",value:function(t){if(t===this)return 0;for(var n,r=t,i=this,a=[r],o=[i];null!==(n=r.parentNode)&&void 0!==n?n:i.parentNode;)r=r.parentNode?(a.push(r.parentNode),r.parentNode):r,i=i.parentNode?(o.push(i.parentNode),i.parentNode):i;if(r!==i)return e.DOCUMENT_POSITION_DISCONNECTED|e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|e.DOCUMENT_POSITION_PRECEDING;var s=a.length>o.length?a:o,l=s===a?o:a;if(s[s.length-l.length]===l[0])return s===a?e.DOCUMENT_POSITION_CONTAINED_BY|e.DOCUMENT_POSITION_FOLLOWING:e.DOCUMENT_POSITION_CONTAINS|e.DOCUMENT_POSITION_PRECEDING;for(var u=s.length-l.length,c=l.length-1;c>=0;c--){var h=l[c],d=s[u+c];if(d!==h){var f=h.parentNode.childNodes;if(f.indexOf(h)<f.indexOf(d)){if(l===a)return e.DOCUMENT_POSITION_PRECEDING;return e.DOCUMENT_POSITION_FOLLOWING;}if(s===a)return e.DOCUMENT_POSITION_PRECEDING;break;}}return e.DOCUMENT_POSITION_FOLLOWING;}},{key:"contain",value:function(t){return this.contains(t);}},{key:"contains",value:function(t){for(var e=t;e&&this!==e;)e=e.parentNode;return!!e;}},{key:"getAncestor",value:function(t){for(var e=this;t>0&&e;)e=e.parentNode,t--;return e;}},{key:"forEach",value:function(t){for(var e=[this];e.length>0;){var n=e.pop();if(!1===t(n))break;for(var r=n.childNodes.length-1;r>=0;r--)e.push(n.childNodes[r]);}}}],[{key:"isNode",value:function(t){return!!t.childNodes;}}]);}((0,R.default)(function t(){(0,C.default)(this,t),this.emitter=new _.default;},[{key:"on",value:function(t,e,n){return this.addEventListener(t,e,n),this;}},{key:"addEventListener",value:function(t,e,n){var r=!1,i=!1;if((0,F.isBoolean)(n))r=n;else if(n){var a=n.capture;r=void 0!==a&&a;var o=n.once;i=void 0!==o&&o;}r&&(t+="capture"),e=(0,F.isFunction)(e)?e:e.handleEvent;var s=(0,F.isFunction)(e)?void 0:e;return i?this.emitter.once(t,e,s):this.emitter.on(t,e,s),this;}},{key:"off",value:function(t,e,n){return t?this.removeEventListener(t,e,n):this.removeAllEventListeners(),this;}},{key:"removeAllEventListeners",value:function(){var t;null===(t=this.emitter)||void 0===t||t.removeAllListeners();}},{key:"removeEventListener",value:function(t,e,n){if(!this.emitter)return this;((0,F.isBoolean)(n)?n:null==n?void 0:n.capture)&&(t+="capture"),e=(0,F.isFunction)(e)?e:null===(r=e)||void 0===r?void 0:r.handleEvent;var r,i=(0,F.isFunction)(e)?void 0:e;return this.emitter.off(t,e,i),this;}},{key:"emit",value:function(t,e){this.dispatchEvent(new rL(t,e));}},{key:"dispatchEventToSelf",value:function(t){t.target||(t.target=this),t.currentTarget=this,this.emitter.emit(t.type,t);}},{key:"dispatchEvent",value:function(t){var e,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0;if(i)return this.dispatchEventToSelf(t),!0;if(e=this.document?this:this.defaultView?this.defaultView:null===(n=this.ownerDocument)||void 0===n?void 0:n.defaultView){if(t.manager=e.getEventService(),!t.manager)return!1;t.defaultPrevented=!1,t.path?t.path.length=0:t.page=[],r||(t.target=this),t.manager.dispatchEvent(t,t.type,r);}else this.dispatchEventToSelf(t);return!t.defaultPrevented;}}]));rI.DOCUMENT_POSITION_DISCONNECTED=1,rI.DOCUMENT_POSITION_PRECEDING=2,rI.DOCUMENT_POSITION_FOLLOWING=4,rI.DOCUMENT_POSITION_CONTAINS=8,rI.DOCUMENT_POSITION_CONTAINED_BY=16,rI.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32,(0,R.default)(function t(e,n){var r=this;(0,C.default)(this,t),this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=G.mat4.create(),this.tmpVec3=G.vec3.create(),this.onPointerDown=function(t){var e=r.createPointerEvent(t);if(r.dispatchEvent(e,"pointerdown"),"touch"===e.pointerType)r.dispatchEvent(e,"touchstart");else if("mouse"===e.pointerType||"pen"===e.pointerType){var n=2===e.button;r.dispatchEvent(e,n?"rightdown":"mousedown");}r.trackingData(t.pointerId).pressTargetsByButton[t.button]=e.composedPath(),r.freeEvent(e);},this.onPointerUp=function(t){var e=nJ.now(),n=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);if(r.dispatchEvent(n,"pointerup"),"touch"===n.pointerType)r.dispatchEvent(n,"touchend");else if("mouse"===n.pointerType||"pen"===n.pointerType){var i=2===n.button;r.dispatchEvent(n,i?"rightup":"mouseup");}var a=r.trackingData(t.pointerId),o=r.findMountedTarget(a.pressTargetsByButton[t.button]),s=o;if(o&&!n.composedPath().includes(o)){for(var l=o;l&&!n.composedPath().includes(l);){if(n.currentTarget=l,r.notifyTarget(n,"pointerupoutside"),"touch"===n.pointerType)r.notifyTarget(n,"touchendoutside");else if("mouse"===n.pointerType||"pen"===n.pointerType){var u=2===n.button;r.notifyTarget(n,u?"rightupoutside":"mouseupoutside");}rI.isNode(l)&&(l=l.parentNode);}delete a.pressTargetsByButton[t.button],s=l;}if(s){var c,h=r.clonePointerEvent(n,"click");h.target=s,h.path=[],a.clicksByButton[t.button]||(a.clicksByButton[t.button]={clickCount:0,target:h.target,timeStamp:e});var d=r.context.renderingContext.root.ownerDocument.defaultView,f=a.clicksByButton[t.button];f.target===h.target&&e-f.timeStamp<d.getConfig().dblClickSpeed?++f.clickCount:f.clickCount=1,f.target=h.target,f.timeStamp=e,h.detail=f.clickCount,null!==(c=n.detail)&&void 0!==c&&c.preventClick||(r.context.config.useNativeClickEvent||"mouse"!==h.pointerType&&"touch"!==h.pointerType||r.dispatchEvent(h,"click"),r.dispatchEvent(h,"pointertap")),r.freeEvent(h);}r.freeEvent(n);},this.onPointerMove=function(t){var e=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0),n="mouse"===e.pointerType||"pen"===e.pointerType,i=r.trackingData(t.pointerId),a=r.findMountedTarget(i.overTargets);if(i.overTargets&&a!==e.target){var o="mousemove"===t.type?"mouseout":"pointerout",s=r.createPointerEvent(t,o,a||void 0);if(r.dispatchEvent(s,"pointerout"),n&&r.dispatchEvent(s,"mouseout"),!e.composedPath().includes(a)){var l=r.createPointerEvent(t,"pointerleave",a||void 0);for(l.eventPhase=l.AT_TARGET;l.target&&!e.composedPath().includes(l.target);)l.currentTarget=l.target,r.notifyTarget(l),n&&r.notifyTarget(l,"mouseleave"),rI.isNode(l.target)&&(l.target=l.target.parentNode);r.freeEvent(l);}r.freeEvent(s);}if(a!==e.target){var u="mousemove"===t.type?"mouseover":"pointerover",c=r.clonePointerEvent(e,u);r.dispatchEvent(c,"pointerover"),n&&r.dispatchEvent(c,"mouseover");for(var h=a&&rI.isNode(a)&&a.parentNode;h&&h!==(rI.isNode(r.rootTarget)&&r.rootTarget.parentNode)&&h!==e.target;)h=h.parentNode;if(!h||h===(rI.isNode(r.rootTarget)&&r.rootTarget.parentNode)){var d=r.clonePointerEvent(e,"pointerenter");for(d.eventPhase=d.AT_TARGET;d.target&&d.target!==a&&d.target!==(rI.isNode(r.rootTarget)&&r.rootTarget.parentNode);)d.currentTarget=d.target,r.notifyTarget(d),n&&r.notifyTarget(d,"mouseenter"),rI.isNode(d.target)&&(d.target=d.target.parentNode);r.freeEvent(d);}r.freeEvent(c);}r.dispatchEvent(e,"pointermove"),"touch"===e.pointerType&&r.dispatchEvent(e,"touchmove"),n&&(r.dispatchEvent(e,"mousemove"),r.cursor=r.getCursor(e.target)),i.overTargets=e.composedPath(),r.freeEvent(e);},this.onPointerOut=function(t){var e=r.trackingData(t.pointerId);if(e.overTargets){var n="mouse"===t.pointerType||"pen"===t.pointerType,i=r.findMountedTarget(e.overTargets),a=r.createPointerEvent(t,"pointerout",i||void 0);r.dispatchEvent(a),n&&r.dispatchEvent(a,"mouseout");var o=r.createPointerEvent(t,"pointerleave",i||void 0);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==(rI.isNode(r.rootTarget)&&r.rootTarget.parentNode);)o.currentTarget=o.target,r.notifyTarget(o),n&&r.notifyTarget(o,"mouseleave"),rI.isNode(o.target)&&(o.target=o.target.parentNode);e.overTargets=null,r.freeEvent(a),r.freeEvent(o);}r.cursor=null;},this.onPointerOver=function(t){var e=r.trackingData(t.pointerId),n=r.createPointerEvent(t),i="mouse"===n.pointerType||"pen"===n.pointerType;r.dispatchEvent(n,"pointerover"),i&&r.dispatchEvent(n,"mouseover"),"mouse"===n.pointerType&&(r.cursor=r.getCursor(n.target));var a=r.clonePointerEvent(n,"pointerenter");for(a.eventPhase=a.AT_TARGET;a.target&&a.target!==(rI.isNode(r.rootTarget)&&r.rootTarget.parentNode);)a.currentTarget=a.target,r.notifyTarget(a),i&&r.notifyTarget(a,"mouseenter"),rI.isNode(a.target)&&(a.target=a.target.parentNode);e.overTargets=n.composedPath(),r.freeEvent(n),r.freeEvent(a);},this.onPointerUpOutside=function(t){var e=r.trackingData(t.pointerId),n=r.findMountedTarget(e.pressTargetsByButton[t.button]),i=r.createPointerEvent(t);if(n){for(var a=n;a;)i.currentTarget=a,r.notifyTarget(i,"pointerupoutside"),"touch"===i.pointerType||("mouse"===i.pointerType||"pen"===i.pointerType)&&r.notifyTarget(i,2===i.button?"rightupoutside":"mouseupoutside"),rI.isNode(a)&&(a=a.parentNode);delete e.pressTargetsByButton[t.button];}r.freeEvent(i);},this.onWheel=function(t){var e=r.createWheelEvent(t);r.dispatchEvent(e),r.freeEvent(e);},this.onClick=function(t){if(r.context.config.useNativeClickEvent){var e=r.createPointerEvent(t);r.dispatchEvent(e),r.freeEvent(e);}},this.onPointerCancel=function(t){var e=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);r.dispatchEvent(e),r.freeEvent(e);},this.globalRuntime=e,this.context=n;},[{key:"init",value:function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick);}},{key:"destroy",value:function(){this.mappingTable={},this.mappingState={},this.eventPool.clear();}},{key:"getScale",value:function(){var t=this.context.contextService.getBoundingClientRect(),e=1,n=1,r=this.context.contextService.getDomElement();if(r&&t){var i=r.offsetWidth,a=r.offsetHeight;i&&a&&(e=t.width/i,n=t.height/a);}return{scaleX:e,scaleY:n,bbox:t};}},{key:"client2Viewport",value:function(t){var e=this.getScale(),n=e.scaleX,r=e.scaleY,i=e.bbox;return new ts((t.x-((null==i?void 0:i.left)||0))/n,(t.y-((null==i?void 0:i.top)||0))/r);}},{key:"viewport2Client",value:function(t){var e=this.getScale(),n=e.scaleX,r=e.scaleY,i=e.bbox;return new ts((t.x+((null==i?void 0:i.left)||0))*n,(t.y+((null==i?void 0:i.top)||0))*r);}},{key:"viewport2Canvas",value:function(t){var e=t.x,n=t.y,r=this.rootTarget.defaultView.getCamera(),i=this.context.config,a=i.width,o=i.height,s=r.getPerspectiveInverse(),l=r.getWorldTransform(),u=G.mat4.multiply(this.tmpMatrix,l,s),c=G.vec3.set(this.tmpVec3,e/a*2-1,(1-n/o)*2-1,0);return G.vec3.transformMat4(c,c,u),new ts(c[0],c[1]);}},{key:"canvas2Viewport",value:function(t){var e=this.rootTarget.defaultView.getCamera(),n=e.getPerspective(),r=e.getViewTransform(),i=G.mat4.multiply(this.tmpMatrix,n,r),a=G.vec3.set(this.tmpVec3,t.x,t.y,0);G.vec3.transformMat4(this.tmpVec3,this.tmpVec3,i);var o=this.context.config,s=o.width,l=o.height;return new ts((a[0]+1)/2*s,(1-(a[1]+1)/2)*l);}},{key:"setPickHandler",value:function(t){this.pickHandler=t;}},{key:"addEventMapping",value:function(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort(function(t,e){return t.priority-e.priority;});}},{key:"mapEvent",value:function(t){if(this.rootTarget){var e=this.mappingTable[t.type];if(e)for(var n=0,r=e.length;n<r;n++)e[n].fn(t);else console.warn("[EventService]: Event mapping not defined for ".concat(t.type));}}},{key:"dispatchEvent",value:function(t,e,n){if(n){t.eventPhase=t.AT_TARGET;var r=this.rootTarget.defaultView||null;t.currentTarget=r,this.notifyListeners(t,e);}else t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e);}},{key:"propagate",value:function(t,e){if(t.target){var n=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(var r=n.length-1;r>=1;r--)if(t.currentTarget=n[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!t.propagationStopped&&!t.propagationImmediatelyStopped){var i=n.indexOf(t.currentTarget);t.eventPhase=t.BUBBLING_PHASE;for(var a=i+1;a<n.length;a++)if(t.currentTarget=n[a],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;}}}},{key:"propagationPath",value:function(t){var e=[t],n=this.rootTarget.defaultView||null;if(n&&n===t)return e.unshift(n.document),e;for(var r=0;r<2048&&t!==this.rootTarget;r++)rI.isNode(t)&&t.parentNode&&(e.push(t.parentNode),t=t.parentNode);return n&&e.push(n),e;}},{key:"hitTest",value:function(t){var e=t.viewportX,n=t.viewportY,r=this.context.config,i=r.width,a=r.height,o=r.disableHitTesting;return e<0||n<0||e>i||n>a?null:!o&&this.pickHandler(t)||this.rootTarget||null;}},{key:"isNativeEventFromCanvas",value:function(t,e){var n,r=null==e?void 0:e.target;if(null!==(n=r)&&void 0!==n&&n.shadowRoot&&(r=e.composedPath()[0]),r){if(r===t)return!0;if(t&&t.contains)return t.contains(r);}return null!=e&&!!e.composedPath&&e.composedPath().indexOf(t)>-1;}},{key:"getExistedHTML",value:function(t){if(t.nativeEvent.composedPath)for(var e=0,n=t.nativeEvent.composedPath();e<n.length;e++){var r=n[e],i=this.nativeHTMLMap.get(r);if(i)return i;}return null;}},{key:"pickTarget",value:function(t){return this.hitTest({clientX:t.clientX,clientY:t.clientY,viewportX:t.viewportX,viewportY:t.viewportY,x:t.canvasX,y:t.canvasY});}},{key:"createPointerEvent",value:function(t,e,n,r){var i=this.allocateEvent(rR);this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.nativeEvent=t.nativeEvent,i.originalEvent=t;var a=this.getExistedHTML(i),o=this.context.contextService.getDomElement();return i.target=null!=n?n:a||this.isNativeEventFromCanvas(o,i.nativeEvent)&&this.pickTarget(i)||r,"string"==typeof e&&(i.type=e),i;}},{key:"createWheelEvent",value:function(t){var e=this.allocateEvent(rO);this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t;var n=this.getExistedHTML(e),r=this.context.contextService.getDomElement();return e.target=n||this.isNativeEventFromCanvas(r,e.nativeEvent)&&this.pickTarget(e),e;}},{key:"trackingData",value:function(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t];}},{key:"cloneWheelEvent",value:function(t){var e=this.allocateEvent(rO);return e.nativeEvent=t.nativeEvent,e.originalEvent=t.originalEvent,this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.target=t.target,e.path=t.composedPath().slice(),e.type=t.type,e;}},{key:"clonePointerEvent",value:function(t,e){var n=this.allocateEvent(rR);return n.nativeEvent=t.nativeEvent,n.originalEvent=t.originalEvent,this.copyPointerData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.target=t.target,n.path=t.composedPath().slice(),n.type=null!=e?e:n.type,n;}},{key:"copyPointerData",value:function(t,e){e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist;}},{key:"copyMouseData",value:function(t,e){e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey,e.client.copyFrom(t.client),e.movement.copyFrom(t.movement),e.canvas.copyFrom(t.canvas),e.screen.copyFrom(t.screen),e.global.copyFrom(t.global),e.offset.copyFrom(t.offset);}},{key:"copyWheelData",value:function(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;}},{key:"copyData",value:function(t,e){e.isTrusted=t.isTrusted,e.timeStamp=nJ.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.page.copyFrom(t.page),e.viewport.copyFrom(t.viewport);}},{key:"allocateEvent",value:function(t){this.eventPool.has(t)||this.eventPool.set(t,[]);var e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=[],e.target=null,e;}},{key:"freeEvent",value:function(t){if(t.manager!==this)throw Error("It is illegal to free an event not managed by this EventBoundary!");var e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t);}},{key:"notifyTarget",value:function(t,e){e=null!=e?e:t.type;var n=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?"".concat(e,"capture"):e;this.notifyListeners(t,n),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e);}},{key:"notifyListeners",value:function(t,e){var n=t.currentTarget.emitter,r=n._events[e];if(r){if("fn"in r)r.once&&n.removeListener(e,r.fn,void 0,!0),r.fn.call(t.currentTarget||r.context,t);else for(var i=0;i<r.length&&!t.propagationImmediatelyStopped;i++)r[i].once&&n.removeListener(e,r[i].fn,void 0,!0),r[i].fn.call(t.currentTarget||r[i].context,t);}}},{key:"findMountedTarget",value:function(t){if(!t)return null;for(var e=t[t.length-1],n=t.length-2;n>=0;n--){var r=t[n];if(r===this.rootTarget||rI.isNode(r)&&r.parentNode===e)e=t[n];else break;}return e;}},{key:"getCursor",value:function(t){for(var e=t;e;){var n=!!e.getAttribute&&e.getAttribute("cursor");if(n)return n;e=rI.isNode(e)&&e.parentNode;}}}]);var rD=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"getOrCreateCanvas",value:function(t,e){if(this.canvas)return this.canvas;if(t||ir.offscreenCanvas)this.canvas=t||ir.offscreenCanvas,this.context=this.canvas.getContext("2d",(0,A.default)({willReadFrequently:!0},e));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",(0,A.default)({willReadFrequently:!0},e)),this.context&&this.context.measureText||(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"));}catch(t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",(0,A.default)({willReadFrequently:!0},e));}return this.canvas.width=10,this.canvas.height=10,this.canvas;}},{key:"getOrCreateContext",value:function(t,e){return this.context||this.getOrCreateCanvas(t,e),this.context;}}],[{key:"createCanvas",value:function(){try{return new window.OffscreenCanvas(0,0);}catch(t){}try{return document.createElement("canvas");}catch(t){}return null;}}]),r_=((k={})[k.CAMERA_CHANGED=0]="CAMERA_CHANGED",k[k.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",k[k.NONE=2]="NONE",k);(0,R.default)(function t(e,n){(0,C.default)(this,t),this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new rr,initAsync:new re,dirtycheck:new ri,cull:new ri,beginFrame:new rr,beforeRender:new rr,render:new rr,afterRender:new rr,endFrame:new rr,destroy:new rr,pick:new rn,pickSync:new ri,pointerDown:new rr,pointerUp:new rr,pointerMove:new rr,pointerOut:new rr,pointerOver:new rr,pointerWheel:new rr,pointerCancel:new rr,click:new rr},this.globalRuntime=e,this.context=n;},[{key:"init",value:function(t){var e=this,n=(0,A.default)((0,A.default)({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach(function(t){t.apply(n,e.globalRuntime);}),this.hooks.init.call(),0===this.hooks.initAsync.getCallbacksNum()?(this.inited=!0,t()):this.hooks.initAsync.promise().then(function(){e.inited=!0,t();}).catch(function(t){});}},{key:"getStats",value:function(){return this.stats;}},{key:"disableDirtyRectangleRendering",value:function(){return!this.context.config.renderer.getConfig().enableDirtyRectangleRendering||this.context.renderingContext.renderReasons.has(r_.CAMERA_CHANGED);}},{key:"render",value:function(t,e,n){var r=this,i=t.getConfig(),a=this.context.renderingContext;if(this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0,this.globalRuntime.sceneGraphService.syncHierarchy(a.root),this.globalRuntime.sceneGraphService.notifyMutationObservers(t),a.renderReasons.size&&this.inited){a.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var o=1===a.renderReasons.size&&a.renderReasons.has(r_.CAMERA_CHANGED),s=!i.disableRenderHooks||!o;s&&this.renderDisplayObject(a.root,i,a),this.hooks.beginFrame.call(e),s&&a.renderListCurrentFrame.forEach(function(t){r.hooks.beforeRender.call(t),r.hooks.render.call(t),r.hooks.afterRender.call(t);}),this.hooks.endFrame.call(e),a.renderListCurrentFrame=[],a.renderReasons.clear(),n();}}},{key:"renderDisplayObject",value:function(t,e,n){for(var r=this,i=e.renderer.getConfig(),a=i.enableDirtyCheck,o=i.enableCulling,s=[t];s.length>0;){var l,u=s.pop();!function(t){var e=t.renderable,i=t.sortable,s=a?e.dirty||n.dirtyRectangleRenderingDisabled?t:null:t,l=null;s&&(l=o?r.hooks.cull.call(s,r.context.camera):s)&&(r.stats.rendered+=1,n.renderListCurrentFrame.push(l)),t.dirty(!1),i.renderOrder=r.zIndexCounter,r.zIndexCounter+=1,r.stats.total+=1,i.dirty&&(r.sort(t,i),i.dirty=!1,i.dirtyChildren=[],i.dirtyReason=void 0);}(u);for(var c=(null===(l=u.sortable)||void 0===l||null===(l=l.sorted)||void 0===l?void 0:l.length)>0?u.sortable.sorted:u.childNodes,h=c.length-1;h>=0;h--)s.push(c[h]);}}},{key:"sort",value:function(t,e){var n,r;(null==e||null===(n=e.sorted)||void 0===n?void 0:n.length)>0&&e.dirtyReason!==tC.Z_INDEX_CHANGED?e.dirtyChildren.forEach(function(n){var r=e.sorted.indexOf(n);if(r>-1&&e.sorted.splice(r,1),t.childNodes.indexOf(n)>-1){if(0===e.sorted.length)e.sorted.push(n);else{var i=function(t,e){for(var n=0,r=t.length;n<r;){var i=n+r>>>1;0>nZ(t[i],e)?n=i+1:r=i;}return n;}(e.sorted,n);e.sorted.splice(i,0,n);}}}):e.sorted=t.childNodes.slice().sort(nZ),(null===(r=e.sorted)||void 0===r?void 0:r.length)>0&&0===t.childNodes.filter(function(t){return t.parsedStyle.zIndex;}).length&&(e.sorted=[]);}},{key:"destroy",value:function(){this.inited=!1,this.hooks.destroy.call();}},{key:"dirty",value:function(){this.context.renderingContext.renderReasons.add(r_.DISPLAY_OBJECT_CHANGED);}}]);var rG=/\[\s*(.*)=(.*)\s*\]/,rF=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"selectOne",value:function(t,e){var n=this;if(t.startsWith("."))return e.find(function(e){return((null==e?void 0:e.classList)||[]).indexOf(n.getIdOrClassname(t))>-1;});if(t.startsWith("#"))return e.find(function(e){return e.id===n.getIdOrClassname(t);});if(t.startsWith("[")){var r=this.getAttribute(t),i=r.name,a=r.value;return i?e.find(function(t){return e!==t&&("name"===i?t.name===a:n.attributeToString(t,i)===a);}):null;}return e.find(function(n){return e!==n&&n.nodeName===t;});}},{key:"selectAll",value:function(t,e){var n=this;if(t.startsWith("."))return e.findAll(function(r){return e!==r&&((null==r?void 0:r.classList)||[]).indexOf(n.getIdOrClassname(t))>-1;});if(t.startsWith("#"))return e.findAll(function(r){return e!==r&&r.id===n.getIdOrClassname(t);});if(t.startsWith("[")){var r=this.getAttribute(t),i=r.name,a=r.value;return i?e.findAll(function(t){return e!==t&&("name"===i?t.name===a:n.attributeToString(t,i)===a);}):[];}return e.findAll(function(n){return e!==n&&n.nodeName===t;});}},{key:"is",value:function(t,e){if(t.startsWith("."))return e.className===this.getIdOrClassname(t);if(t.startsWith("#"))return e.id===this.getIdOrClassname(t);if(t.startsWith("[")){var n=this.getAttribute(t),r=n.name,i=n.value;return"name"===r?e.name===i:this.attributeToString(e,r)===i;}return e.nodeName===t;}},{key:"getIdOrClassname",value:function(t){return t.substring(1);}},{key:"getAttribute",value:function(t){var e=t.match(rG),n="",r="";return e&&e.length>2&&(n=e[1].replace(/"/g,""),r=e[2].replace(/"/g,"")),{name:n,value:r};}},{key:"attributeToString",value:function(t,e){if(!t.getAttribute)return"";var n=t.getAttribute(e);return(0,F.isNil)(n)?"":n.toString?n.toString():"";}}]),rB=((E={}).ATTR_MODIFIED="DOMAttrModified",E.INSERTED="DOMNodeInserted",E.MOUNTED="DOMNodeInsertedIntoDocument",E.REMOVED="removed",E.UNMOUNTED="DOMNodeRemovedFromDocument",E.REPARENT="reparent",E.DESTROY="destroy",E.BOUNDS_CHANGED="bounds-changed",E.CULLED="culled",E),rU=function(t){function e(t,n,r,i,a,o,s,l){var u;return(0,C.default)(this,e),(u=(0,L.default)(this,e,[null])).relatedNode=n,u.prevValue=r,u.newValue=i,u.attrName=a,u.attrChange=o,u.prevParsedValue=s,u.newParsedValue=l,u.type=t,u;}return(0,I.default)(e,t),(0,R.default)(e);}(rA);rU.ADDITION=2,rU.MODIFICATION=1,rU.REMOVAL=3;var rV=new rU(rB.REPARENT,null,"","","",0,"",""),rz=G.vec2.create(),rH=G.vec3.create(),rY=G.vec3.fromValues(1,1,1),rW=G.mat4.create(),rq=G.vec2.create(),rX=G.vec3.create(),rj=G.mat4.create(),r$=G.quat.create(),rK=G.vec3.create(),rZ=G.quat.create(),rQ=G.vec3.create(),rJ=G.vec3.create(),r0=G.vec3.create(),r1=G.mat4.create(),r2=G.quat.create(),r3=G.quat.create(),r4=G.quat.create(),r5=(0,R.default)(function t(e){(0,C.default)(this,t),this.displayObjectDependencyMap=new WeakMap,this.runtime=e;},[{key:"matches",value:function(t,e){return this.runtime.sceneGraphSelector.is(t,e);}},{key:"querySelector",value:function(t,e){return this.runtime.sceneGraphSelector.selectOne(t,e);}},{key:"querySelectorAll",value:function(t,e){return this.runtime.sceneGraphSelector.selectAll(t,e);}},{key:"attach",value:function(t,e,n){var r=!1;t.parentNode&&(r=t.parentNode!==e,this.detach(t));var i=t.nodeName===j.FRAGMENT,a=n0(e);t.parentNode=e;var o=i?t.childNodes:[t];(0,F.isNumber)(n)?o.forEach(function(t){e.childNodes.splice(n,0,t),t.parentNode=e;}):o.forEach(function(t){e.childNodes.push(t),t.parentNode=e;});var s=e.sortable;if((null!=s&&null!==(u=s.sorted)&&void 0!==u&&u.length||s.dirty||t.parsedStyle.zIndex)&&(-1===s.dirtyChildren.indexOf(t)&&s.dirtyChildren.push(t),s.dirty=!0,s.dirtyReason=tC.ADDED),!a){if(i)this.dirtyFragment(t);else{var l=t.transformable;l&&this.dirtyWorldTransform(t,l);}if(r){var u,c,h=(null===(c=e.ownerDocument)||void 0===c||null===(c=c.defaultView)||void 0===c||null===(c=c.getConfig())||void 0===c||null===(c=c.future)||void 0===c?void 0:c.experimentalCancelEventPropagation)===!0;t.dispatchEvent(rV,h,h);}}}},{key:"detach",value:function(t){if(t.parentNode){var e,n,r=t.transformable,i=t.parentNode.sortable;(null!=i&&null!==(e=i.sorted)&&void 0!==e&&e.length||null!==(n=t.style)&&void 0!==n&&n.zIndex)&&(-1===i.dirtyChildren.indexOf(t)&&i.dirtyChildren.push(t),i.dirty=!0,i.dirtyReason=tC.REMOVED);var a=t.parentNode.childNodes.indexOf(t);a>-1&&t.parentNode.childNodes.splice(a,1),r&&this.dirtyWorldTransform(t,r),t.parentNode=null;}}},{key:"getLocalPosition",value:function(t){return t.transformable.localPosition;}},{key:"getLocalRotation",value:function(t){return t.transformable.localRotation;}},{key:"getLocalScale",value:function(t){return t.transformable.localScale;}},{key:"getLocalSkew",value:function(t){return t.transformable.localSkew;}},{key:"getLocalTransform",value:function(t){var e=t.transformable;return tI(e),e.localTransform;}},{key:"setLocalPosition",value:function(t,e){var n,r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=t.transformable;rJ[0]=e[0],rJ[1]=e[1],rJ[2]=null!==(n=e[2])&&void 0!==n?n:0,!G.vec3.equals(i.localPosition,rJ)&&(G.vec3.copy(i.localPosition,rJ),r&&this.dirtyLocalTransform(t,i));}},{key:"translateLocal",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var i=t.transformable;G.vec3.equals(e,rH)||(G.vec3.transformQuat(e,e,i.localRotation),G.vec3.add(i.localPosition,i.localPosition,e),this.dirtyLocalTransform(t,i));}},{key:"setLocalRotation",value:function(t,e,n,r,i){var a=!(arguments.length>5)||void 0===arguments[5]||arguments[5];"number"==typeof e&&(e=G.quat.set(r$,e,n,r,i));var o=t.transformable;G.quat.copy(o.localRotation,e),a&&this.dirtyLocalTransform(t,o);}},{key:"rotateLocal",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var i=t.transformable;G.quat.fromEuler(r3,e[0],e[1],e[2]),G.quat.mul(i.localRotation,i.localRotation,r3),this.dirtyLocalTransform(t,i);}},{key:"setLocalScale",value:function(t,e){var n,r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=t.transformable;G.vec3.set(rX,e[0],e[1],null!==(n=e[2])&&void 0!==n?n:i.localScale[2]),!G.vec3.equals(rX,i.localScale)&&(G.vec3.copy(i.localScale,rX),r&&this.dirtyLocalTransform(t,i));}},{key:"scaleLocal",value:function(t,e){var n,r=t.transformable;G.vec3.multiply(r.localScale,r.localScale,G.vec3.set(rX,e[0],e[1],null!==(n=e[2])&&void 0!==n?n:1)),this.dirtyLocalTransform(t,r);}},{key:"setLocalSkew",value:function(t,e,n){var r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];"number"==typeof e&&(e=G.vec2.set(rq,e,n));var i=t.transformable;G.vec2.copy(i.localSkew,e),r&&this.dirtyLocalTransform(t,i);}},{key:"setLocalEulerAngles",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=!(arguments.length>4)||void 0===arguments[4]||arguments[4];"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var a=t.transformable;G.quat.fromEuler(a.localRotation,e[0],e[1],e[2]),i&&this.dirtyLocalTransform(t,a);}},{key:"setLocalTransform",value:function(t,e){var n=G.mat4.getTranslation(rK,e),r=G.mat4.getRotation(rZ,e),i=G.mat4.getScaling(rQ,e);this.setLocalScale(t,i,!1),this.setLocalPosition(t,n,!1),this.setLocalRotation(t,r,void 0,void 0,void 0,!1),this.dirtyLocalTransform(t,t.transformable);}},{key:"resetLocalTransform",value:function(t){this.setLocalScale(t,rY,!1),this.setLocalPosition(t,rH,!1),this.setLocalEulerAngles(t,rH,void 0,void 0,!1),this.setLocalSkew(t,rz,void 0,!1),this.dirtyLocalTransform(t,t.transformable);}},{key:"getPosition",value:function(t){var e=t.transformable;return G.mat4.getTranslation(e.position,this.getWorldTransform(t,e));}},{key:"getRotation",value:function(t){var e=t.transformable;return G.mat4.getRotation(e.rotation,this.getWorldTransform(t,e));}},{key:"getScale",value:function(t){var e=t.transformable;return G.mat4.getScaling(e.scaling,this.getWorldTransform(t,e));}},{key:"getOrigin",value:function(t){return t.getGeometryBounds(),t.transformable.origin;}},{key:"getWorldTransform",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.transformable;return(e.localDirtyFlag||e.dirtyFlag)&&(t.parentNode&&t.parentNode.transformable&&this.getWorldTransform(t.parentNode),this.internalUpdateTransform(t)),e.worldTransform;}},{key:"setPosition",value:function(t,e){var n,r=t.transformable;if(r0[0]=e[0],r0[1]=e[1],r0[2]=null!==(n=e[2])&&void 0!==n?n:0,!G.vec3.equals(this.getPosition(t),r0)){if(G.vec3.copy(r.position,r0),null!==t.parentNode&&t.parentNode.transformable){var i=t.parentNode.transformable;G.mat4.copy(r1,i.worldTransform),G.mat4.invert(r1,r1),G.vec3.transformMat4(r.localPosition,r0,r1);}else G.vec3.copy(r.localPosition,r0);this.dirtyLocalTransform(t,r);}}},{key:"translate",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.set(rX,e,n,r)),G.vec3.equals(e,rH)||(G.vec3.add(rX,this.getPosition(t),e),this.setPosition(t,rX));}},{key:"setRotation",value:function(t,e,n,r,i){var a=t.transformable;if("number"==typeof e&&(e=G.quat.fromValues(e,n,r,i)),null!==t.parentNode&&t.parentNode.transformable){var o=this.getRotation(t.parentNode);G.quat.copy(r$,o),G.quat.invert(r$,r$),G.quat.multiply(a.localRotation,r$,e),G.quat.normalize(a.localRotation,a.localRotation),this.dirtyLocalTransform(t,a);}else this.setLocalRotation(t,e);}},{key:"rotate",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var i=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){G.quat.fromEuler(r$,e[0],e[1],e[2]);var a=this.getRotation(t),o=this.getRotation(t.parentNode);G.quat.copy(r4,o),G.quat.invert(r4,r4),G.quat.multiply(r$,r4,r$),G.quat.multiply(i.localRotation,r$,a),G.quat.normalize(i.localRotation,i.localRotation),this.dirtyLocalTransform(t,i);}else this.rotateLocal(t,e);}},{key:"setOrigin",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=[e,n,r]);var i=t.transformable;if(e[0]!==i.origin[0]||e[1]!==i.origin[1]||e[2]!==i.origin[2]){var a=i.origin;a[0]=e[0],a[1]=e[1],a[2]=e[2]||0,this.dirtyLocalTransform(t,i);}}},{key:"setEulerAngles",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var i=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){G.quat.fromEuler(i.localRotation,e[0],e[1],e[2]);var a=this.getRotation(t.parentNode);G.quat.copy(r2,G.quat.invert(r$,a)),G.quat.mul(i.localRotation,i.localRotation,r2),this.dirtyLocalTransform(t,i);}else this.setLocalEulerAngles(t,e);}},{key:"getGeometryBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.geometry;return n.dirty&&ir.styleValueRegistry.updateGeometry(t),(e?n.renderBounds:n.contentBounds||null)||new tr;}},{key:"getTransformedGeometryBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this.getGeometryBounds(t,e);if(!tr.isEmpty(r)){var i=n||new tr;return i.setFromTransformedAABB(r,this.getWorldTransform(t)),i;}return null;}},{key:"getBounds",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t.renderable;if(!r.boundsDirty&&!n&&r.bounds)return r.bounds;if(!r.renderBoundsDirty&&n&&r.renderBounds)return r.renderBounds;var i=n?r.renderBounds:r.bounds,a=this.getTransformedGeometryBounds(t,n,i);if(t.childNodes.forEach(function(t){var r=e.getBounds(t,n);r&&(a?a.add(r):(a=i||new tr).update(r.center,r.halfExtents));}),a||(a=new tr),n){var o=function(t){var e,n=t;do{if(null===(e=n.parsedStyle)||void 0===e?void 0:e.clipPath)return n;n=n.parentElement;}while(null!==n)return null;}(t);if(o){var s=o.parsedStyle.clipPath.getBounds(n);a?s&&(a=s.intersection(a)):a.update(s.center,s.halfExtents);}}return n?(r.renderBounds=a,r.renderBoundsDirty=!1):(r.bounds=a,r.boundsDirty=!1),a;}},{key:"getLocalBounds",value:function(t){if(t.parentNode){var e=rW;t.parentNode.transformable&&(e=G.mat4.invert(rj,this.getWorldTransform(t.parentNode)));var n=this.getBounds(t);if(!tr.isEmpty(n)){var r=new tr;return r.setFromTransformedAABB(n,e),r;}}return this.getBounds(t);}},{key:"getBoundingClientRect",value:function(t){var e,n,r=this.getGeometryBounds(t);tr.isEmpty(r)||(n=new tr).setFromTransformedAABB(r,this.getWorldTransform(t));var i=null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e?void 0:e.getContextService().getBoundingClientRect();if(n){var a=n.getMin(),o=(0,D.default)(a,2),s=o[0],l=o[1],u=n.getMax(),c=(0,D.default)(u,2),h=c[0],d=c[1];return new tl(s+((null==i?void 0:i.left)||0),l+((null==i?void 0:i.top)||0),h-s,d-l);}return new tl((null==i?void 0:i.left)||0,(null==i?void 0:i.top)||0,0,0);}},{key:"internalUpdateTransform",value:function(t){var e,n,r=null===(n=t.parentNode)||void 0===n?void 0:n.transformable;tI(t.transformable),(e=t.transformable).dirtyFlag&&(r?G.mat4.multiply(e.worldTransform,r.worldTransform,e.localTransform):G.mat4.copy(e.worldTransform,e.localTransform),e.dirtyFlag=!1);}},{key:"internalUpdateElement",value:function(t,e){var n=(null===(s=t.ownerDocument)||void 0===s||null===(s=s.defaultView)||void 0===s||null===(s=s.getConfig())||void 0===s||null===(s=s.future)||void 0===s?void 0:s.experimentalAttributeUpdateOptimization)===!0,r=e[e.length-1],i=(null==r?void 0:r.transformDirty)||(null===(l=t.transformable)||void 0===l?void 0:l.localDirtyFlag);t.transformable&&((h=t.transformable).dirtyFlag||(h.dirtyFlag=i)),this.internalUpdateTransform(t),i&&(null===(d=t.dirty)||void 0===d||d.call(t,!0,!0));var a=(null===(u=t.renderable)||void 0===u?void 0:u.boundsDirty)||(null===(c=t.renderable)||void 0===c?void 0:c.renderBoundsDirty);if((i||a)&&(null==r?void 0:r.shapeUpdated)===!1&&n)for(var o=e.length-1;o>=0;){var s,l,u,c,h,d,f,v,p=e[o];if(p.shapeUpdated)break;null===(f=(v=p.node).dirty)||void 0===f||f.call(v,!0,!0),p.shapeUpdated=!0,o-=1;}return i;}},{key:"syncHierarchy",value:function(t){for(var e,n,r=[t],i=t.parentNode?[{node:t.parentNode,transformDirty:(null===(e=t.parentNode.transformable)||void 0===e?void 0:e.localDirtyFlag)||(null===(n=t.parentNode.transformable)||void 0===n?void 0:n.dirtyFlag),shapeUpdated:!1}]:[];r.length>0;){for(var a=r.pop(),o=i[i.length-1];i.length>0&&a.parentNode!==o.node;)o=i.pop();var s=this.internalUpdateElement(a,i);if(a.childNodes.length>0){for(var l=a.childNodes.length-1;l>=0;l--)r.push(a.childNodes[l]);i.push({node:a,transformDirty:s,shapeUpdated:!1});}}}},{key:"dirtyLocalTransform",value:function(t,e){n0(t)||e.localDirtyFlag||(e.localDirtyFlag=!0,e.dirtyFlag||this.dirtyWorldTransform(t,e));}},{key:"dirtyWorldTransform",value:function(t,e){this.dirtyWorldInternal(t,e),this.dirtyToRoot(t,!0);}},{key:"dirtyWorldInternal",value:function(t,e){var n,r=this,i=(null===(n=t.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n||null===(n=n.getConfig())||void 0===n||null===(n=n.future)||void 0===n?void 0:n.experimentalAttributeUpdateOptimization)===!0;e.dirtyFlag||(e.dirtyFlag=!0,t.dirty(!0,!0),i||t.childNodes.forEach(function(t){var e=t.transformable;r.dirtyWorldInternal(t,e);}));}},{key:"dirtyToRoot",value:function(t){for(var e,n,r,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=t,o=(null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig())||void 0===e||null===(e=e.future)||void 0===e?void 0:e.experimentalAttributeUpdateOptimization)===!0;a&&(null===(n=(r=a).dirty)||void 0===n||n.call(r,!0,!0),!o);)a=a.parentNode;i&&t.forEach(function(t){var e;null===(e=t.dirty)||void 0===e||e.call(t,!0,!0);}),this.informDependentDisplayObjects(t);var s=t.mutations||[],l=s.find(function(t){return"attributes"===t.type&&t._boundsChangeData;});l?l._boundsChangeData={affectChildren:l._boundsChangeData.affectChildren||i}:(l={type:"attributes",target:t,_boundsChangeData:{affectChildren:i}},s.push(l)),t.mutations=s;}},{key:"dirtyFragment",value:function(t){var e,n=t.transformable;n&&(n.dirtyFlag=!0,n.localDirtyFlag=!0),null===(e=t.dirty)||void 0===e||e.call(t,!0,!0);for(var r=t.childNodes.length,i=0;i<r;i++)this.dirtyFragment(t.childNodes[i]);}},{key:"notifyMutationObservers",value:function(t){var e=new Set;if(t.getRoot().forEach(function(t){(t.mutations||[]).forEach(function(n){"attributes"===n.type&&n._boundsChangeData&&(n._boundsChangeData.affectChildren?t.forEach(function(t){var r=(0,A.default)({},n);r.target=t,e.add(r);}):e.add(n));}),t.mutations=void 0;}),e.size>0){var n=new rL(rB.BOUNDS_CHANGED,{detail:Array.from(e)});t.dispatchEvent(n,!0,!0);}}},{key:"updateDisplayObjectDependency",value:function(t,e,n,r){if(e&&e!==n){var i=this.displayObjectDependencyMap.get(e);if(i&&i[t]){var a=i[t].indexOf(r);i[t].splice(a,1);}}if(n){var o=this.displayObjectDependencyMap.get(n);o||(this.displayObjectDependencyMap.set(n,{}),o=this.displayObjectDependencyMap.get(n)),o[t]||(o[t]=[]),o[t].push(r);}}},{key:"informDependentDisplayObjects",value:function(t){var e,n=this,r=this.displayObjectDependencyMap.get(t);if(r){var i=null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig())||void 0===e||null===(e=e.future)||void 0===e?void 0:e.experimentalCancelEventPropagation;Object.keys(r).forEach(function(t){r[t].forEach(function(e){n.dirtyToRoot(e,!0),e.dispatchEvent(new rU(rB.ATTR_MODIFIED,e,n,n,t,rU.MODIFICATION,n,n),i,i),e.isCustomElement&&e.isConnected&&e.attributeChangedCallback&&e.attributeChangedCallback(t,n,n);});});}}}]),r6=(0,R.default)(function t(e){if((0,C.default)(this,t),e<=0)throw Error("LRU capacity must be a positive number.");this.capacity=e,this.cache=new Map;},[{key:"get",value:function(t){if(this.cache.has(t)){var e=this.cache.get(t);return this.cache.delete(t),this.cache.set(t,e),e;}}},{key:"put",value:function(t,e){if(this.cache.has(t)&&this.cache.delete(t),this.cache.set(t,e),this.cache.size>this.capacity){var n=this.cache.keys().next().value;this.cache.delete(n);}}},{key:"len",value:function(){return this.cache.size;}},{key:"clear",value:function(){this.cache.clear();}}]),r7={MetricsString:"|\xc9q\xc5",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},r9=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,r8=new RegExp("".concat(/[!%),.:;?\]}'""]/.source,"|").concat(/[!),.:;?\]}'""]/.source,"|").concat(/[)\]'"?!:;,.]/.source,"|").concat(/[!%),.:;?\]}'"]/.source)),it=new RegExp("".concat(/[$('"]/.source,"|").concat(/[([{'"]/.source,"|").concat(/[(['"...]/.source,"|").concat(/[$([{'"#]/.source)),ie=(0,R.default)(function t(e){var n=this;(0,C.default)(this,t),this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(t,e){return!n.isBreakingSpace(e)&&!!(t&&(it.exec(e)||r8.exec(t)));},this.trimByKinsokuShorui=function(t){var e=(0,O.default)(t),n=e[e.length-2];if(!n)return t;var r=n[n.length-1];return e[e.length-2]=n.slice(0,-1),e[e.length-1]=r+e[e.length-1],e;},this.runtime=e,this.charWidthCache=new r6(100);},[{key:"measureFont",value:function(t,e){if(this.fontMetricsCache[t])return this.fontMetricsCache[t];var n={ascent:0,descent:0,fontSize:0},r=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(e),i=this.runtime.offscreenCanvasCreator.getOrCreateContext(e,{willReadFrequently:!0});i.font=t;var a=r7.MetricsString+r7.BaselineSymbol,o=Math.ceil(i.measureText(a).width),s=Math.ceil(i.measureText(r7.BaselineSymbol).width),l=r7.HeightMultiplier*s;s=s*r7.BaselineMultiplier|0,r.width=o,r.height=l,i.fillStyle="#f00",i.fillRect(0,0,o,l),i.font=t,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(a,0,s);var u=i.getImageData(0,0,o||1,l||1).data,c=u.length,h=4*o,d=0,f=0,v=!1;for(d=0;d<s;++d){for(var p=0;p<h;p+=4)if(255!==u[f+p]){v=!0;break;}if(v)break;f+=h;}for(n.ascent=s-d,f=c-h,v=!1,d=l;d>s;--d){for(var g=0;g<h;g+=4)if(255!==u[f+g]){v=!0;break;}if(v)break;f-=h;}return n.descent=d-s,n.fontSize=n.ascent+n.descent,this.fontMetricsCache[t]=n,n;}},{key:"measureText",value:function(t,e,n){var r=e.fontSize,i=void 0===r?16:r,a=e.wordWrap,o=e.lineHeight,s=e.lineWidth,l=void 0===s?1:s,u=e.textBaseline,c=void 0===u?"alphabetic":u,h=e.textAlign,d=void 0===h?"start":h,f=e.letterSpacing,v=void 0===f?0:f,p=e.textPath;e.textPathSide,e.textPathStartOffset;var g=e.leading,y=void 0===g?0:g,m=rl(e),k=this.measureFont(m,n);0===k.fontSize&&(k.fontSize=i,k.ascent=i);var E=this.runtime.offscreenCanvasCreator.getOrCreateContext(n);E.font=m,e.isOverflowing=!1;var x=(void 0!==a&&a?this.wordWrap(t,e,n):t).split(/(?:\r\n|\r|\n)/),T=Array(x.length),N=0;if(p){p.getTotalLength();for(var b=0;b<x.length;b++)E.measureText(x[b]).width,x[b].length;}else{for(var S=0;S<x.length;S++){var w=E.measureText(x[S]).width+(x[S].length-1)*v;T[S]=w,N=Math.max(N,w);}var P=N+l,M=o||k.fontSize+l,A=Math.max(M,k.fontSize+l)+(x.length-1)*(M+y);M+=y;var C=0;return"middle"===c?C=-A/2:"bottom"===c||"alphabetic"===c||"ideographic"===c?C=-A:("top"===c||"hanging"===c)&&(C=0),{font:m,width:P,height:A,lines:x,lineWidths:T,lineHeight:M,maxLineWidth:N,fontProperties:k,lineMetrics:T.map(function(t,e){var n=0;return"center"===d||"middle"===d?n-=t/2:("right"===d||"end"===d)&&(n-=t),new tl(n-l/2,C+e*M,t+l,M);})};}}},{key:"wordWrap",value:function(t,e,n){var r=this,i=Array.from(t);if(0===i.length)return"";var a=this,o=e.wordWrapWidth,s=e.letterSpacing,l=void 0===s?0:s,u=e.maxLines,c=void 0===u?1/0:u,h=e.textOverflow,d=this.runtime.offscreenCanvasCreator.getOrCreateContext(n),f=(void 0===o?0:o)+l,v="";"ellipsis"===h?v="...":h&&"clip"!==h&&(v=h);var p=[""],g=0,y=0,m=-1,k=rl(e),E=this.charWidthCache.get(k);E||(E=new r6(500),this.charWidthCache.put(k,E));var x=function(t){return r.getFromCache(t,l,E,d);},T=x(v);function N(t,e,n,r){for(;x(t)<r&&e<i.length-1&&!a.isNewline(i[e+1]);)e+=1,t+=i[e];for(;x(t)>r&&e>=n;)e-=1,t=t.slice(0,-1);return{lineTxt:t,txtLastCharIndex:e};}function b(t,e){if(!(T<=0)&&!(T>f)){if(!p[t]){p[t]=v;return;}var n=N(p[t],e,m+1,f-T);p[t]=n.lineTxt+v;}}for(var S=0;S<i.length;S++){var w=i[S],P=i[S-1],M=i[S+1],A=x(w);if(this.isNewline(w)){if(g+1>=c){S<i.length-1&&b(g,S-1),e.isOverflowing=!0;break;}m=S-1,y=0,p[g+=1]="";continue;}if(A>f){b(g,S-1),e.isOverflowing=!0;break;}if(y>0&&y+A>f){var C=N(p[g],S-1,m+1,f);if(C.txtLastCharIndex!==S-1){if(p[g]=C.lineTxt,C.txtLastCharIndex===i.length-1)break;w=i[S=C.txtLastCharIndex+1],P=i[S-1],M=i[S+1],A=x(w);}if(g+1>=c){b(g,S-1),e.isOverflowing=!0;break;}if(m=S-1,y=0,p[g+=1]="",this.isBreakingSpace(w))continue;this.canBreakInLastChar(w)||(p=this.trimToBreakable(p),y=this.sumTextWidthByCache(p[g]||"",x)),this.shouldBreakByKinsokuShorui(w,M)&&(p=this.trimByKinsokuShorui(p),y+=x(P||""));}y+=A,p[g]+=w;}return p.join("\n");}},{key:"isBreakingSpace",value:function(t){return"string"==typeof t&&r7.BreakingSpaces.indexOf(t.charCodeAt(0))>=0;}},{key:"isNewline",value:function(t){return"string"==typeof t&&r7.Newlines.indexOf(t.charCodeAt(0))>=0;}},{key:"trimToBreakable",value:function(t){var e=(0,O.default)(t),n=e[e.length-2],r=this.findBreakableIndex(n);if(-1===r||!n)return e;var i=n.slice(r,r+1),a=this.isBreakingSpace(i);return e[e.length-1]+=n.slice(r+1,n.length),e[e.length-2]=n.slice(0,r+(a?0:1)),e;}},{key:"canBreakInLastChar",value:function(t){return!(t&&r9.test(t));}},{key:"sumTextWidthByCache",value:function(t,e){return t.split("").reduce(function(t,n){return t+e(n);},0);}},{key:"findBreakableIndex",value:function(t){for(var e=t.length-1;e>=0;e--)if(!r9.test(t[e]))return e;return -1;}},{key:"getFromCache",value:function(t,e,n,r){var i=n.get(t);if("number"!=typeof i){var a=t.length*e;i=r.measureText(t).width+a,n.put(t,i);}return i;}},{key:"clearCache",value:function(){this.fontMetricsCache={},this.charWidthCache.clear();}}]),ir={},ii=(T=new rS,N=new rb,x={},(0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)(x,j.FRAGMENT,null),j.CIRCLE,new rE),j.ELLIPSE,new rx),j.RECT,T),j.IMAGE,T),j.GROUP,new rP),j.LINE,new rT),j.TEXT,new rw(ir)),j.POLYLINE,N),j.POLYGON,N),(0,B.default)((0,B.default)((0,B.default)(x,j.PATH,new rN),j.HTML,new rM),j.MESH,null)),ia=(S=new n_,w=new nB,b={},(0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)(b,t_.PERCENTAGE,null),t_.NUMBER,new nH),t_.ANGLE,new nI),t_.DEFINED_PATH,new nD),t_.PAINT,S),t_.COLOR,S),t_.FILTER,new nG),t_.LENGTH,w),t_.LENGTH_PERCENTAGE,w),t_.LENGTH_PERCENTAGE_12,new nU),(0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)(b,t_.LENGTH_PERCENTAGE_14,new nV),t_.COORDINATE,new nB),t_.OFFSET_DISTANCE,new nY),t_.OPACITY_VALUE,new nW),t_.PATH,new nq),t_.LIST_OF_POINTS,new nX),t_.SHADOW_BLUR,new nj),t_.TEXT,new n$),t_.TEXT_TRANSFORM,new nK),t_.TRANSFORM,new ry),(0,B.default)((0,B.default)((0,B.default)(b,t_.TRANSFORM_ORIGIN,new rm),t_.Z_INDEX,new rk),t_.MARKER,new nz));ir.CameraContribution=tM,ir.AnimationTimeline=null,ir.EasingFunction=null,ir.offscreenCanvasCreator=new rD,ir.sceneGraphSelector=new rF,ir.sceneGraphService=new r5(ir),ir.textService=new ie(ir),ir.geometryUpdaterFactory=ii,ir.CSSPropertySyntaxFactory=ia,ir.styleValueRegistry=new nO(ir),ir.layoutRegistry=null,ir.globalThis="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==X?X:{},ir.enableStyleSyntax=!0,ir.enableSizeAttenuation=!1;var io=0,is=new rU(rB.INSERTED,null,"","","",0,"",""),il=new rU(rB.REMOVED,null,"","","",0,"",""),iu=new rL(rB.DESTROY),ic=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).entity=io++,t.transformable={dirtyFlag:!1,localDirtyFlag:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},t.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},t.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},t.cullable={strategy:tA.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},t.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},t.rBushNode={aabb:void 0},t.namespaceURI="g",t.scrollLeft=0,t.scrollTop=0,t.clientTop=0,t.clientLeft=0,t.style={},t.computedStyle={},t.parsedStyle={},t.attributes={},t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"dirty",value:function(){var t=!(arguments.length>0)||void 0===arguments[0]||arguments[0],e=arguments.length>1?arguments[1]:void 0;this.renderable.dirty=t,void 0!==e&&(this.renderable.boundsDirty=e,this.renderable.renderBoundsDirty=e,this.geometry.dirty=e);}},{key:"className",get:function(){return this.getAttribute("class")||"";},set:function(t){this.setAttribute("class",t);}},{key:"classList",get:function(){return this.className.split(" ").filter(function(t){return""!==t;});}},{key:"tagName",get:function(){return this.nodeName;}},{key:"children",get:function(){return this.childNodes;}},{key:"childElementCount",get:function(){return this.childNodes.length;}},{key:"firstElementChild",get:function(){return this.firstChild;}},{key:"lastElementChild",get:function(){return this.lastChild;}},{key:"parentElement",get:function(){return this.parentNode;}},{key:"nextSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t+1]||null;}return null;}},{key:"previousSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t-1]||null;}return null;}},{key:"cloneNode",value:function(t){throw Error(tu);}},{key:"appendChild",value:function(t,e){var n;if(t.destroyed)throw Error("Cannot append a destroyed element.");return ir.sceneGraphService.attach(t,this,e),null!==(n=this.ownerDocument)&&void 0!==n&&n.defaultView&&(n0(this)||t.nodeName!==j.FRAGMENT?this.ownerDocument.defaultView.mountChildren(t):this.ownerDocument.defaultView.mountFragment(t)),this.isMutationObserved&&(is.relatedNode=this,t.dispatchEvent(is)),t;}},{key:"insertBefore",value:function(t,e){if(e){t.parentElement&&t.parentElement.removeChild(t);var n=this.childNodes.indexOf(e);-1===n?this.appendChild(t):this.appendChild(t,n);}else this.appendChild(t);return t;}},{key:"replaceChild",value:function(t,e){var n=this.childNodes.indexOf(e);return this.removeChild(e),this.appendChild(t,n),e;}},{key:"removeChild",value:function(t){var e,n,r=(null===(e=this.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig().future)||void 0===e?void 0:e.experimentalCancelEventPropagation)===!0;return il.relatedNode=this,t.dispatchEvent(il,r,r),null!==(n=t.ownerDocument)&&void 0!==n&&n.defaultView&&t.ownerDocument.defaultView.unmountChildren(t),ir.sceneGraphService.detach(t),t;}},{key:"removeChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var e=this.childNodes[t];this.removeChild(e);}}},{key:"destroyChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var e=this.childNodes[t];e.childNodes.length>0&&e.destroyChildren(),e.destroy();}}},{key:"matches",value:function(t){return ir.sceneGraphService.matches(t,this);}},{key:"getElementById",value:function(t){return ir.sceneGraphService.querySelector("#".concat(t),this);}},{key:"getElementsByName",value:function(t){return ir.sceneGraphService.querySelectorAll('[name="'.concat(t,'"]'),this);}},{key:"getElementsByClassName",value:function(t){return ir.sceneGraphService.querySelectorAll(".".concat(t),this);}},{key:"getElementsByTagName",value:function(t){return ir.sceneGraphService.querySelectorAll(t,this);}},{key:"querySelector",value:function(t){return ir.sceneGraphService.querySelector(t,this);}},{key:"querySelectorAll",value:function(t){return ir.sceneGraphService.querySelectorAll(t,this);}},{key:"closest",value:function(t){var e=this;do{if(ir.sceneGraphService.matches(t,e))return e;e=e.parentElement;}while(null!==e)return null;}},{key:"find",value:function(t){var e=this,n=null;return this.forEach(function(r){return!(r!==e&&t(r))||(n=r,!1);}),n;}},{key:"findAll",value:function(t){var e=this,n=[];return this.forEach(function(r){r!==e&&t(r)&&n.push(r);}),n;}},{key:"after",value:function(){var t=this;if(this.parentNode){for(var e=this.parentNode.childNodes.indexOf(this),n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];r.forEach(function(n,r){var i;return null===(i=t.parentNode)||void 0===i?void 0:i.appendChild(n,e+r+1);});}}},{key:"before",value:function(){if(this.parentNode){for(var t=this.parentNode.childNodes.indexOf(this),e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n[0],a=(0,V.default)(n).slice(1);this.parentNode.appendChild(i,t),i.after.apply(i,(0,O.default)(a));}}},{key:"replaceWith",value:function(){this.after.apply(this,arguments),this.remove();}},{key:"append",value:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(function(e){return t.appendChild(e);});}},{key:"prepend",value:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(function(e,n){return t.appendChild(e,n);});}},{key:"replaceChildren",value:function(){for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,arguments);}},{key:"remove",value:function(){return this.parentNode?this.parentNode.removeChild(this):this;}},{key:"destroy",value:function(){var t,e=(null===(t=this.ownerDocument)||void 0===t||null===(t=t.defaultView)||void 0===t||null===(t=t.getConfig().future)||void 0===t?void 0:t.experimentalCancelEventPropagation)===!0;this.destroyChildren(),this.dispatchEvent(iu,e,e),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0;}},{key:"getGeometryBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return ir.sceneGraphService.getGeometryBounds(this,t);}},{key:"getTransformedGeometryBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return ir.sceneGraphService.getTransformedGeometryBounds(this,t);}},{key:"getBounds",value:function(){return ir.sceneGraphService.getBounds(this);}},{key:"getRenderBounds",value:function(){return ir.sceneGraphService.getBounds(this,!0);}},{key:"getLocalBounds",value:function(){return ir.sceneGraphService.getLocalBounds(this);}},{key:"getBoundingClientRect",value:function(){return ir.sceneGraphService.getBoundingClientRect(this);}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()];}},{key:"computedStyleMap",value:function(){return new Map(Object.entries(this.computedStyle));}},{key:"getAttributeNames",value:function(){return Object.keys(this.attributes);}},{key:"getAttribute",value:function(t){if("symbol"!=typeof t)return this.attributes[t];}},{key:"hasAttribute",value:function(t){return this.getAttributeNames().includes(t);}},{key:"hasAttributes",value:function(){return!!this.getAttributeNames().length;}},{key:"removeAttribute",value:function(t){this.setAttribute(t,null),delete this.attributes[t];}},{key:"setAttribute",value:function(t,e){this.attributes[t]=e;}},{key:"getAttributeNS",value:function(t,e){throw Error(tu);}},{key:"getAttributeNode",value:function(t){throw Error(tu);}},{key:"getAttributeNodeNS",value:function(t,e){throw Error(tu);}},{key:"hasAttributeNS",value:function(t,e){throw Error(tu);}},{key:"removeAttributeNS",value:function(t,e){throw Error(tu);}},{key:"removeAttributeNode",value:function(t){throw Error(tu);}},{key:"setAttributeNS",value:function(t,e,n){throw Error(tu);}},{key:"setAttributeNode",value:function(t){throw Error(tu);}},{key:"setAttributeNodeNS",value:function(t){throw Error(tu);}},{key:"toggleAttribute",value:function(t,e){throw Error(tu);}}]);}(rI);function ih(t){return!!(null!=t&&t.nodeName);}var id=ir.globalThis.Proxy?ir.globalThis.Proxy:function(){},iv=new rU(rB.ATTR_MODIFIED,null,null,null,null,rU.MODIFICATION,null,null),ip=G.vec3.create(),ig=G.quat.create(),iy=function(t){function e(t){var n;return(0,C.default)(this,e),(n=(0,L.default)(this,e)).isCustomElement=!1,n.isMutationObserved=!1,n.activeAnimations=[],n.config=t,n.id=t.id||"",n.name=t.name||"",(t.className||t.class)&&(n.className=t.className||t.class),n.nodeName=t.type||j.GROUP,t.initialParsedStyle&&Object.assign(n.parsedStyle,t.initialParsedStyle),n.initAttributes(t.style),ir.enableStyleSyntax&&(n.style=new id({setProperty:function(t,e){n.setAttribute(t,e);},getPropertyValue:function(t){return n.getAttribute(t);},removeProperty:function(t){n.removeAttribute(t);},item:function(){return"";}},{get:function(t,e){return void 0!==t[e]?t[e]:n.getAttribute(e);},set:function(t,e,r){return n.setAttribute(e,r),!0;}})),n;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"destroy",value:function(){(0,U.default)(e,"destroy",this,3)([]),this.getAnimations().forEach(function(t){t.cancel();});}},{key:"cloneNode",value:function(t,e){var n=(0,A.default)({},this.attributes);for(var r in n){var i=n[r];ih(i)&&"clipPath"!==r&&"offsetPath"!==r&&"textPath"!==r&&(n[r]=i.cloneNode(t)),e&&(n[r]=e(r,i));}var a=new this.constructor((0,A.default)((0,A.default)({},this.config),{},{style:n}));return a.setLocalTransform(this.getLocalTransform()),t&&this.children.forEach(function(e){if(!e.style.isMarker){var n=e.cloneNode(t);a.appendChild(n);}}),a;}},{key:"initAttributes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ir.styleValueRegistry.processProperties(this,t,{forceUpdateGeometry:!0}),this.dirty();}},{key:"setAttribute",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!(arguments.length>3)||void 0===arguments[3]||arguments[3];!(0,F.isUndefined)(n)&&(r||n!==this.attributes[t])&&(this.internalSetAttribute(t,n,{memoize:i}),(0,U.default)(e,"setAttribute",this,3)([t,n]));}},{key:"internalSetAttribute",value:function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.attributes[t],a=this.parsedStyle[t];ir.styleValueRegistry.processProperties(this,(0,B.default)({},t,e),r),this.dirty();var o=this.parsedStyle[t];if(this.isConnected){if(iv.relatedNode=this,iv.prevValue=i,iv.newValue=e,iv.attrName=t,iv.prevParsedValue=a,iv.newParsedValue=o,this.isMutationObserved)this.dispatchEvent(iv);else{var s,l=(null===(s=this.ownerDocument.defaultView.getConfig().future)||void 0===s?void 0:s.experimentalCancelEventPropagation)===!0;iv.target=this,this.ownerDocument.defaultView.dispatchEvent(iv,!0,l);}}(this.isCustomElement&&this.isConnected||!this.isCustomElement)&&(null===(n=this.attributeChangedCallback)||void 0===n||n.call(this,t,i,e,a,o));}},{key:"getBBox",value:function(){var t=this.getBounds(),e=t.getMin(),n=(0,D.default)(e,2),r=n[0],i=n[1],a=t.getMax(),o=(0,D.default)(a,2);return new tl(r,i,o[0]-r,o[1]-i);}},{key:"setOrigin",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ir.sceneGraphService.setOrigin(this,td(t,e,n,!1)),this;}},{key:"getOrigin",value:function(){return ir.sceneGraphService.getOrigin(this);}},{key:"setPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ir.sceneGraphService.setPosition(this,td(t,e,n,!1)),this;}},{key:"setLocalPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ir.sceneGraphService.setLocalPosition(this,td(t,e,n,!1)),this;}},{key:"translate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ir.sceneGraphService.translate(this,td(t,e,n,!1)),this;}},{key:"translateLocal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ir.sceneGraphService.translateLocal(this,td(t,e,n,!1)),this;}},{key:"getPosition",value:function(){return ir.sceneGraphService.getPosition(this);}},{key:"getLocalPosition",value:function(){return ir.sceneGraphService.getLocalPosition(this);}},{key:"scale",value:function(t,e,n){return this.scaleLocal(t,e,n);}},{key:"scaleLocal",value:function(t,e,n){return"number"==typeof t&&(e=e||t,n=n||t,t=td(t,e,n,!1)),ir.sceneGraphService.scaleLocal(this,t),this;}},{key:"setLocalScale",value:function(t,e,n){return"number"==typeof t&&(e=e||t,n=n||t,t=td(t,e,n,!1)),ir.sceneGraphService.setLocalScale(this,t),this;}},{key:"getLocalScale",value:function(){return ir.sceneGraphService.getLocalScale(this);}},{key:"getScale",value:function(){return ir.sceneGraphService.getScale(this);}},{key:"getEulerAngles",value:function(){var t=tg(ip,ir.sceneGraphService.getWorldTransform(this));return(0,D.default)(t,3)[2]*tv;}},{key:"getLocalEulerAngles",value:function(){var t=tg(ip,ir.sceneGraphService.getLocalRotation(this));return(0,D.default)(t,3)[2]*tv;}},{key:"setEulerAngles",value:function(t){return ir.sceneGraphService.setEulerAngles(this,0,0,t),this;}},{key:"setLocalEulerAngles",value:function(t){return ir.sceneGraphService.setLocalEulerAngles(this,0,0,t),this;}},{key:"rotateLocal",value:function(t,e,n){return(0,F.isNil)(e)&&(0,F.isNil)(n)?ir.sceneGraphService.rotateLocal(this,0,0,t):ir.sceneGraphService.rotateLocal(this,t,e,n),this;}},{key:"rotate",value:function(t,e,n){return(0,F.isNil)(e)&&(0,F.isNil)(n)?ir.sceneGraphService.rotate(this,0,0,t):ir.sceneGraphService.rotate(this,t,e,n),this;}},{key:"setRotation",value:function(t,e,n,r){return ir.sceneGraphService.setRotation(this,t,e,n,r),this;}},{key:"setLocalRotation",value:function(t,e,n,r){return ir.sceneGraphService.setLocalRotation(this,t,e,n,r),this;}},{key:"setLocalSkew",value:function(t,e){return ir.sceneGraphService.setLocalSkew(this,t,e),this;}},{key:"getRotation",value:function(){return ir.sceneGraphService.getRotation(this);}},{key:"getLocalRotation",value:function(){return ir.sceneGraphService.getLocalRotation(this);}},{key:"getLocalSkew",value:function(){return ir.sceneGraphService.getLocalSkew(this);}},{key:"getLocalTransform",value:function(){return ir.sceneGraphService.getLocalTransform(this);}},{key:"getWorldTransform",value:function(){return ir.sceneGraphService.getWorldTransform(this);}},{key:"setLocalTransform",value:function(t){return ir.sceneGraphService.setLocalTransform(this,t),this;}},{key:"resetLocalTransform",value:function(){ir.sceneGraphService.resetLocalTransform(this);}},{key:"getAnimations",value:function(){return this.activeAnimations;}},{key:"animate",value:function(t,e){var n,r=null===(n=this.ownerDocument)||void 0===n?void 0:n.timeline;return r?r.play(this,t,e):null;}},{key:"isVisible",value:function(){var t;return(null===(t=this.parsedStyle)||void 0===t?void 0:t.visibility)!=="hidden";}},{key:"interactive",get:function(){return this.isInteractive();},set:function(t){this.style.pointerEvents=t?"auto":"none";}},{key:"isInteractive",value:function(){var t;return(null===(t=this.parsedStyle)||void 0===t?void 0:t.pointerEvents)!=="none";}},{key:"isCulled",value:function(){return!!(this.cullable&&this.cullable.enable&&!this.cullable.visible);}},{key:"toFront",value:function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,(0,O.default)(this.parentNode.children.map(function(t){return Number(t.style.zIndex);})))+1),this;}},{key:"toBack",value:function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,(0,O.default)(this.parentNode.children.map(function(t){return Number(t.style.zIndex);})))-1),this;}},{key:"getConfig",value:function(){return this.config;}},{key:"attr",value:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n[0],a=n[1];return i?(0,F.isObject)(i)?(Object.keys(i).forEach(function(e){t.setAttribute(e,i[e]);}),this):2===n.length?(this.setAttribute(i,a),this):this.attributes[i]:this.attributes;}},{key:"getMatrix",value:function(t){var e,n,r,i=t||this.getWorldTransform(),a=G.mat4.getTranslation(ip,i),o=(0,D.default)(a,2),s=o[0],l=o[1],u=G.mat4.getScaling(ip,i),c=(0,D.default)(u,2),h=c[0],d=c[1],f=tg(ip,G.mat4.getRotation(ig,i)),v=(0,D.default)(f,3),p=v[0],g=v[2];return n=Math.cos(e=p||g),r=Math.sin(e),G.mat3.fromValues(h*n,d*r,0,-h*r,d*n,0,s,l,1);}},{key:"getLocalMatrix",value:function(){return this.getMatrix(this.getLocalTransform());}},{key:"setMatrix",value:function(t){var e=ty(t),n=(0,D.default)(e,5),r=n[0],i=n[1],a=n[2],o=n[3],s=n[4];this.setEulerAngles(s).setPosition(r,i).setLocalScale(a,o);}},{key:"setLocalMatrix",value:function(t){var e=ty(t),n=(0,D.default)(e,5),r=n[0],i=n[1],a=n[2],o=n[3],s=n[4];this.setLocalEulerAngles(s).setLocalPosition(r,i).setLocalScale(a,o);}},{key:"show",value:function(){this.forEach(function(t){t.style.visibility="visible";});}},{key:"hide",value:function(){this.forEach(function(t){t.style.visibility="hidden";});}},{key:"getCount",value:function(){return this.childElementCount;}},{key:"getParent",value:function(){return this.parentElement;}},{key:"getChildren",value:function(){return this.children;}},{key:"getFirst",value:function(){return this.firstElementChild;}},{key:"getLast",value:function(){return this.lastElementChild;}},{key:"getChildByIndex",value:function(t){return this.children[t]||null;}},{key:"add",value:function(t,e){return this.appendChild(t,e);}},{key:"set",value:function(t,e){this.config[t]=e;}},{key:"get",value:function(t){return this.config[t];}},{key:"moveTo",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(t,e,n),this;}},{key:"move",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(t,e,n),this;}},{key:"setZIndex",value:function(t){return this.style.zIndex=t,this;}}]);}(ic);iy.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","display","draggable","droppable","fill","fillOpacity","fillRule","filter","increasedLineWidthForHitTesting","lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit","hitArea","offsetDistance","offsetPath","offsetX","offsetY","opacity","pointerEvents","shadowColor","shadowType","shadowBlur","shadowOffsetX","shadowOffsetY","stroke","strokeOpacity","strokeWidth","strokeLinecap","strokeLineJoin","strokeDasharray","strokeDashoffset","transform","transformOrigin","textTransform","visibility","zIndex"]);var im=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.CIRCLE},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(iy);im.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iy.PARSED_STYLE_LIST),["cx","cy","cz","r","isBillboard","isSizeAttenuation"]));var ik=["style"];(function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,ik);return(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({style:r},i)])).isCustomElement=!0,t;}return(0,I.default)(e,t),(0,R.default)(e);})(iy).PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var iE=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.ELLIPSE},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(iy);iE.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iy.PARSED_STYLE_LIST),["cx","cy","cz","rx","ry","isBillboard","isSizeAttenuation"])),function(t){function e(){return(0,C.default)(this,e),(0,L.default)(this,e,[{type:j.FRAGMENT}]);}return(0,I.default)(e,t),(0,R.default)(e);}(iy).PARSED_STYLE_LIST=new Set(["class","className"]);var ix=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.GROUP},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(iy);ix.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var iT=["style"],iN=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iT);return(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({type:j.HTML,style:r},i)])).cullable.enable=!1,t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getDomElement",value:function(){return this.parsedStyle.$el;}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()];}},{key:"getLocalBounds",value:function(){if(this.parentNode){var t=G.mat4.invert(G.mat4.create(),this.parentNode.getWorldTransform()),e=this.getBounds();if(!tr.isEmpty(e)){var n=new tr;return n.setFromTransformedAABB(e,t),n;}}return this.getBounds();}}]);}(iy);iN.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iy.PARSED_STYLE_LIST),["x","y","$el","innerHTML","width","height"]));var ib=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.IMAGE},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(iy);ib.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iy.PARSED_STYLE_LIST),["x","y","z","src","width","height","isBillboard","billboardRotation","isSizeAttenuation","keepAspectRatio"]));var iS=["style"],iw=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iS);(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({type:j.LINE,style:(0,A.default)({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},r)},i)])).markerStartAngle=0,t.markerEndAngle=0;var a=t.parsedStyle,o=a.markerStart,s=a.markerEnd;return o&&ih(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),s&&ih(s)&&(t.markerEndAngle=s.getLocalEulerAngles(),t.appendChild(s)),t.transformMarker(!0),t.transformMarker(!1),t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"x1"===t||"y1"===t||"x2"===t||"y2"===t||"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&ih(r)&&(this.markerStartAngle=0,r.remove()),i&&ih(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t&&(r&&ih(r)&&(this.markerEndAngle=0,r.remove()),i&&ih(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1)));}},{key:"transformMarker",value:function(t){var e,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,h=s.markerEndOffset,d=s.x1,f=s.x2,v=s.y1,p=s.y2,g=t?l:u;if(g&&ih(g)){var y=0;t?(r=d,i=v,e=f-d,n=p-v,a=c||0,o=this.markerStartAngle):(r=f,i=p,e=d-f,n=v-p,a=h||0,o=this.markerEndAngle),y=Math.atan2(n,e),g.setLocalEulerAngles(180*y/Math.PI+o),g.setLocalPosition(r+Math.cos(y)*a,i+Math.sin(y)*a);}}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle,r=n.x1,i=n.y1,a=n.x2,o=n.y2,s=(0,z.linePointAt)(r,i,a,o,t),l=s.x,u=s.y,c=G.vec3.transformMat4(G.vec3.create(),G.vec3.fromValues(l,u,0),e?this.getWorldTransform():this.getLocalTransform());return new ts(c[0],c[1]);}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(t/this.getTotalLength(),e);}},{key:"getTotalLength",value:function(){var t=this.parsedStyle,e=t.x1,n=t.y1,r=t.x2,i=t.y2;return(0,z.lineLength)(e,n,r,i);}}]);}(iy);iw.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iy.PARSED_STYLE_LIST),["x1","y1","x2","y2","z1","z2","isBillboard","isSizeAttenuation","markerStart","markerEnd","markerStartOffset","markerEndOffset"]));var iP=["style"],iM=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iP);(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({type:j.PATH,style:r,initialParsedStyle:{miterLimit:4,d:(0,A.default)({},tD)}},i)])).markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var a=t.parsedStyle,o=a.markerStart,s=a.markerEnd,l=a.markerMid;return o&&ih(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),l&&ih(l)&&t.placeMarkerMid(l),s&&ih(s)&&(t.markerEndAngle=s.getLocalEulerAngles(),t.appendChild(s)),t.transformMarker(!0),t.transformMarker(!1),t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"d"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&ih(r)&&(this.markerStartAngle=0,r.remove()),i&&ih(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t?(r&&ih(r)&&(this.markerEndAngle=0,r.remove()),i&&ih(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(i);}},{key:"transformMarker",value:function(t){var e,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,h=s.markerEndOffset,d=t?l:u;if(d&&ih(d)){var f=0;if(t){var v=this.getStartTangent(),p=(0,D.default)(v,2),g=p[0],y=p[1];r=y[0],i=y[1],e=g[0]-y[0],n=g[1]-y[1],a=c||0,o=this.markerStartAngle;}else{var m=this.getEndTangent(),k=(0,D.default)(m,2),E=k[0],x=k[1];r=x[0],i=x[1],e=E[0]-x[0],n=E[1]-x[1],a=h||0,o=this.markerEndAngle;}f=Math.atan2(n,e),d.setLocalEulerAngles(180*f/Math.PI+o),d.setLocalPosition(r+Math.cos(f)*a,i+Math.sin(f)*a);}}},{key:"placeMarkerMid",value:function(t){var e=this.parsedStyle.d.segments;if(this.markerMidList.forEach(function(t){t.remove();}),t&&ih(t))for(var n=1;n<e.length-1;n++){var r=(0,D.default)(e[n].currentPoint,2),i=r[0],a=r[1],o=1===n?t:t.cloneNode(!0);this.markerMidList.push(o),this.appendChild(o),o.setLocalPosition(i,a);}}},{key:"getTotalLength",value:function(){return e7(this);}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle.d.absolutePath,r=(0,F.getPointAtLength)(n,t),i=r.x,a=r.y,o=G.vec3.transformMat4(G.vec3.create(),G.vec3.fromValues(i,a,0),e?this.getWorldTransform():this.getLocalTransform());return new ts(o[0],o[1]);}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPointAtLength(t*e7(this),e);}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.d.segments,e=[];if(t.length>1){var n=t[0].currentPoint,r=t[1].currentPoint,i=t[1].startTangent;e=[],i?e.push([n[0]-i[0],n[1]-i[1]]):e.push([r[0],r[1]]),e.push([n[0],n[1]]);}return e;}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.d.segments,e=t.length,n=[];if(e>1){var r=t[e-2].currentPoint,i=t[e-1].currentPoint,a=t[e-1].endTangent;n=[],a?n.push([i[0]-a[0],i[1]-a[1]]):n.push([r[0],r[1]]),n.push([i[0],i[1]]);}return n;}}]);}(iy);iM.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iy.PARSED_STYLE_LIST),["d","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard","isSizeAttenuation"]));var iA=["style"],iC=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iA);(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({type:j.POLYGON,style:r,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},i)])).markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var a=t.parsedStyle,o=a.markerStart,s=a.markerEnd,l=a.markerMid;return o&&ih(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),l&&ih(l)&&t.placeMarkerMid(l),s&&ih(s)&&(t.markerEndAngle=s.getLocalEulerAngles(),t.appendChild(s)),t.transformMarker(!0),t.transformMarker(!1),t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"points"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&ih(r)&&(this.markerStartAngle=0,r.remove()),i&&ih(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t?(r&&ih(r)&&(this.markerEndAngle=0,r.remove()),i&&ih(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(i);}},{key:"transformMarker",value:function(t){var e,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,h=s.markerEndOffset,d=(s.points||{}).points,f=t?l:u;if(f&&ih(f)&&d){var v=0;if(r=d[0][0],i=d[0][1],t)e=d[1][0]-d[0][0],n=d[1][1]-d[0][1],a=c||0,o=this.markerStartAngle;else{var p=d.length;this.parsedStyle.isClosed?(e=d[p-1][0]-d[0][0],n=d[p-1][1]-d[0][1]):(r=d[p-1][0],i=d[p-1][1],e=d[p-2][0]-d[p-1][0],n=d[p-2][1]-d[p-1][1]),a=h||0,o=this.markerEndAngle;}v=Math.atan2(n,e),f.setLocalEulerAngles(180*v/Math.PI+o),f.setLocalPosition(r+Math.cos(v)*a,i+Math.sin(v)*a);}}},{key:"placeMarkerMid",value:function(t){var e=(this.parsedStyle.points||{}).points;if(this.markerMidList.forEach(function(t){t.remove();}),this.markerMidList=[],t&&ih(t)&&e)for(var n=1;n<(this.parsedStyle.isClosed?e.length:e.length-1);n++){var r=e[n][0],i=e[n][1],a=1===n?t:t.cloneNode(!0);this.markerMidList.push(a),this.appendChild(a),a.setLocalPosition(r,i);}}}]);}(iy);iC.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iy.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isClosed","isBillboard","isSizeAttenuation"]));var iR=["style"],iO=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.style,r=(0,q.default)(t,iR);return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.POLYLINE,style:n,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},r)]);}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getTotalLength",value:function(){return 0===this.parsedStyle.points.totalLength&&(this.parsedStyle.points.totalLength=(0,z.polylineLength)(this.parsedStyle.points.points)),this.parsedStyle.points.totalLength;}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(t/this.getTotalLength(),e);}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle.points.points;if(0===this.parsedStyle.points.segments.length){var r,i,a=[],o=0,s=this.getTotalLength();n.forEach(function(t,e){n[e+1]&&((r=[0,0])[0]=o/s,i=(0,z.lineLength)(t[0],t[1],n[e+1][0],n[e+1][1]),o+=i,r[1]=o/s,a.push(r));}),this.parsedStyle.points.segments=a;}var l=0,u=0;this.parsedStyle.points.segments.forEach(function(e,n){t>=e[0]&&t<=e[1]&&(l=(t-e[0])/(e[1]-e[0]),u=n);});var c=(0,z.linePointAt)(n[u][0],n[u][1],n[u+1][0],n[u+1][1],l),h=c.x,d=c.y,f=G.vec3.transformMat4(G.vec3.create(),G.vec3.fromValues(h,d,0),e?this.getWorldTransform():this.getLocalTransform());return new ts(f[0],f[1]);}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.points.points,e=[];return e.push([t[1][0],t[1][1]]),e.push([t[0][0],t[0][1]]),e;}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.points.points,e=t.length-1,n=[];return n.push([t[e-1][0],t[e-1][1]]),n.push([t[e][0],t[e][1]]),n;}}]);}(iC);iO.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iC.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard"]));var iL=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.RECT},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(iy);iL.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iy.PARSED_STYLE_LIST),["x","y","z","width","height","isBillboard","isSizeAttenuation","radius"]));var iI=["style"],iD=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.style,r=(0,q.default)(t,iI);return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.TEXT,style:(0,A.default)({fill:"black"},n)},r)]);}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getComputedTextLength",value:function(){var t;return this.getGeometryBounds(),(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.maxLineWidth)||0;}},{key:"getLineBoundingRects",value:function(){var t;return this.getGeometryBounds(),(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.lineMetrics)||[];}},{key:"isOverflowing",value:function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing;}}]);}(iy);iD.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iy.PARSED_STYLE_LIST),["x","y","z","isBillboard","billboardRotation","isSizeAttenuation","text","textAlign","textBaseline","fontStyle","fontSize","fontFamily","fontWeight","fontVariant","lineHeight","letterSpacing","leading","wordWrap","wordWrapWidth","maxLines","textOverflow","isOverflowing","textPath","textDecorationLine","textDecorationColor","textDecorationStyle","textDecorationThickness","textPathSide","textPathStartOffset","metrics","dx","dy"])),(0,R.default)(function t(){(0,C.default)(this,t),this.registry={},this.define(j.CIRCLE,im),this.define(j.ELLIPSE,iE),this.define(j.RECT,iL),this.define(j.IMAGE,ib),this.define(j.LINE,iw),this.define(j.GROUP,ix),this.define(j.PATH,iM),this.define(j.POLYGON,iC),this.define(j.POLYLINE,iO),this.define(j.TEXT,iD),this.define(j.HTML,iN);},[{key:"define",value:function(t,e){this.registry[t]=e;}},{key:"get",value:function(t){return this.registry[t];}}]),function(){function t(e){(0,C.default)(this,t),this.strategies=e;}return(0,R.default)(t,[{key:"apply",value:function(e){var n=e.config,r=e.camera,i=e.renderingService,a=e.renderingContext,o=this.strategies;i.hooks.cull.tap(t.tag,function(t){if(t){var e,i=t.cullable;if(0===o.length?i.visible=a.unculledEntities.indexOf(t.entity)>-1:i.visible=o.every(function(e){return e.isVisible(r,t);}),!t.isCulled()&&t.isVisible())return t;var s=(null===(e=n.future)||void 0===e?void 0:e.experimentalCancelEventPropagation)===!0;return t.dispatchEvent(new rL(rB.CULLED),s,s),null;}return t;}),i.hooks.afterRender.tap(t.tag,function(t){t.cullable.visibilityPlaneMask=-1;});}}]);}().tag="Culling",function(){function t(){var e=this;(0,C.default)(this,t),this.autoPreventDefault=!1,this.rootPointerEvent=new rR(null),this.rootWheelEvent=new rO(null),this.onPointerMove=function(t){var n=null===(r=e.context.renderingContext.root)||void 0===r||null===(r=r.ownerDocument)||void 0===r?void 0:r.defaultView;if(!n.supportsTouchEvents||"touch"!==t.pointerType){var r,i,a=e.normalizeToPointerEvent(t,n),o=(0,W.default)(a);try{for(o.s();!(i=o.n()).done;){var s=i.value,l=e.bootstrapEvent(e.rootPointerEvent,s,n,t);e.context.eventService.mapEvent(l);}}catch(t){o.e(t);}finally{o.f();}e.setCursor(e.context.eventService.cursor);}},this.onClick=function(t){var n,r,i=null===(n=e.context.renderingContext.root)||void 0===n||null===(n=n.ownerDocument)||void 0===n?void 0:n.defaultView,a=e.normalizeToPointerEvent(t,i),o=(0,W.default)(a);try{for(o.s();!(r=o.n()).done;){var s=r.value,l=e.bootstrapEvent(e.rootPointerEvent,s,i,t);e.context.eventService.mapEvent(l);}}catch(t){o.e(t);}finally{o.f();}e.setCursor(e.context.eventService.cursor);};}return(0,R.default)(t,[{key:"apply",value:function(e){var n=this;this.context=e;var r=e.renderingService,i=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler(function(t){return n.context.renderingService.hooks.pickSync.call({position:t,picked:[],topmost:!0}).picked[0]||null;}),r.hooks.pointerWheel.tap(t.tag,function(t){var e=n.normalizeWheelEvent(t);n.context.eventService.mapEvent(e);}),r.hooks.pointerDown.tap(t.tag,function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){var e=n.normalizeToPointerEvent(t,i);n.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();var r,a=(0,W.default)(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=n.bootstrapEvent(n.rootPointerEvent,o,i,t);n.context.eventService.mapEvent(s);}}catch(t){a.e(t);}finally{a.f();}n.setCursor(n.context.eventService.cursor);}}),r.hooks.pointerUp.tap(t.tag,function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){var e,r=n.context.contextService.getDomElement(),a=n.context.eventService.isNativeEventFromCanvas(r,t)?"":"outside",o=n.normalizeToPointerEvent(t,i),s=(0,W.default)(o);try{for(s.s();!(e=s.n()).done;){var l=e.value,u=n.bootstrapEvent(n.rootPointerEvent,l,i,t);u.type+=a,n.context.eventService.mapEvent(u);}}catch(t){s.e(t);}finally{s.f();}n.setCursor(n.context.eventService.cursor);}}),r.hooks.pointerMove.tap(t.tag,this.onPointerMove),r.hooks.pointerOver.tap(t.tag,this.onPointerMove),r.hooks.pointerOut.tap(t.tag,this.onPointerMove),r.hooks.click.tap(t.tag,this.onClick),r.hooks.pointerCancel.tap(t.tag,function(t){var e,r=n.normalizeToPointerEvent(t,i),a=(0,W.default)(r);try{for(a.s();!(e=a.n()).done;){var o=e.value,s=n.bootstrapEvent(n.rootPointerEvent,o,i,t);n.context.eventService.mapEvent(s);}}catch(t){a.e(t);}finally{a.f();}n.setCursor(n.context.eventService.cursor);});}},{key:"bootstrapEvent",value:function(t,e,n,r){t.view=n,t.originalEvent=null,t.nativeEvent=r,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);var i=this.context.eventService.client2Viewport({x:e.clientX,y:e.clientY}),a=i.x,o=i.y;t.viewport.x=a,t.viewport.y=o;var s=this.context.eventService.viewport2Canvas(t.viewport),l=s.x,u=s.y;return t.canvas.x=l,t.canvas.y=u,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=r.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=nQ[t.type]||t.type),t;}},{key:"normalizeWheelEvent",value:function(t){var e=this.rootWheelEvent;this.transferMouseData(e,t),e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;var n=this.context.eventService.client2Viewport({x:t.clientX,y:t.clientY}),r=n.x,i=n.y;e.viewport.x=r,e.viewport.y=i;var a=this.context.eventService.viewport2Canvas(e.viewport),o=a.x,s=a.y;return e.canvas.x=o,e.canvas.y=s,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.nativeEvent=t,e.type=t.type,e;}},{key:"transferMouseData",value:function(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=nJ.now(),t.type=e.type,t.altKey=e.altKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.ctrlKey=e.ctrlKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.screen.x=e.screenX,t.screen.y=e.screenY,t.relatedTarget=null;}},{key:"setCursor",value:function(t){this.context.contextService.applyCursorStyle(t||this.context.config.cursor||"default");}},{key:"normalizeToPointerEvent",value:function(t,e){var n=[];if(e.isTouchEvent(t))for(var r=0;r<t.changedTouches.length;r++){var i=t.changedTouches[r];(0,F.isUndefined)(i.button)&&(i.button=0),(0,F.isUndefined)(i.buttons)&&(i.buttons=1),(0,F.isUndefined)(i.isPrimary)&&(i.isPrimary=1===t.touches.length&&"touchstart"===t.type),(0,F.isUndefined)(i.width)&&(i.width=i.radiusX||1),(0,F.isUndefined)(i.height)&&(i.height=i.radiusY||1),(0,F.isUndefined)(i.tiltX)&&(i.tiltX=0),(0,F.isUndefined)(i.tiltY)&&(i.tiltY=0),(0,F.isUndefined)(i.pointerType)&&(i.pointerType="touch"),(0,F.isUndefined)(i.pointerId)&&(i.pointerId=i.identifier||0),(0,F.isUndefined)(i.pressure)&&(i.pressure=i.force||.5),(0,F.isUndefined)(i.twist)&&(i.twist=0),(0,F.isUndefined)(i.tangentialPressure)&&(i.tangentialPressure=0),i.isNormalized=!0,i.type=t.type,n.push(i);}else e.isMouseEvent(t)&&((0,F.isUndefined)(t.isPrimary)&&(t.isPrimary=!0),(0,F.isUndefined)(t.width)&&(t.width=1),(0,F.isUndefined)(t.height)&&(t.height=1),(0,F.isUndefined)(t.tiltX)&&(t.tiltX=0),(0,F.isUndefined)(t.tiltY)&&(t.tiltY=0),(0,F.isUndefined)(t.pointerType)&&(t.pointerType="mouse"),(0,F.isUndefined)(t.pointerId)&&(t.pointerId=1),(0,F.isUndefined)(t.pressure)&&(t.pressure=.5),(0,F.isUndefined)(t.twist)&&(t.twist=0),(0,F.isUndefined)(t.tangentialPressure)&&(t.tangentialPressure=0),t.isNormalized=!0),n.push(t);return n;}}]);}().tag="Event";var i_=[j.CIRCLE,j.ELLIPSE,j.IMAGE,j.RECT,j.LINE,j.POLYLINE,j.POLYGON,j.TEXT,j.PATH,j.HTML];(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"isVisible",value:function(t,e){var n,r=e.cullable;if(!r.enable)return!0;var i=e.getRenderBounds();if(tr.isEmpty(i))return!1;var a=t.getFrustum(),o=null===(n=e.parentNode)||void 0===n||null===(n=n.cullable)||void 0===n?void 0:n.visibilityPlaneMask;return r.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(e,i,o||ta.INDETERMINATE,a.planes),r.visible=r.visibilityPlaneMask!==ta.OUTSIDE,r.visible;}},{key:"computeVisibilityWithPlaneMask",value:function(t,e,n,r){if(n===ta.OUTSIDE||n===ta.INSIDE)return n;for(var i=ta.INSIDE,a=i_.indexOf(t.nodeName)>-1,o=0,s=r.length;o<s;++o){var l=1<<o;if((n&l)!=0&&(!a||4!==o&&5!==o)){var u=r[o],c=u.normal,h=u.distance;if(G.vec3.dot(c,e.getPositiveFarPoint(r[o]))+h<0)return ta.OUTSIDE;G.vec3.dot(c,e.getNegativeFarPoint(r[o]))+h<0&&(i|=l);}}return i;}}]),function(){function t(){(0,C.default)(this,t),this.mutationRecords=[],this.isFirstTimeRendering=!0,this.isFirstTimeRenderingFinished=!1;}return(0,R.default)(t,[{key:"apply",value:function(e){var n,r=this,i=e.renderingService,a=e.renderingContext.root.ownerDocument.defaultView,o=function(t){i.dirty();},s=function(t){var e,n=t.detail;(e=r.mutationRecords).push.apply(e,(0,O.default)(n)),i.dirty();},l=function(t){var e=t.target;ir.enableSizeAttenuation&&ir.styleValueRegistry.updateSizeAttenuation(e,a.getCamera().getZoom());},u=function(t){var e=t.target;ir.sceneGraphService.dirtyToRoot(e),i.dirty();};i.hooks.init.tap(t.tag,function(){a.addEventListener(rB.MOUNTED,l),a.addEventListener(rB.UNMOUNTED,u),a.addEventListener(rB.ATTR_MODIFIED,o),a.addEventListener(rB.BOUNDS_CHANGED,s);}),i.hooks.destroy.tap(t.tag,function(){a.removeEventListener(rB.MOUNTED,l),a.removeEventListener(rB.UNMOUNTED,u),a.removeEventListener(rB.ATTR_MODIFIED,o),a.removeEventListener(rB.BOUNDS_CHANGED,s),r.mutationRecords=[];});var c=null!==(n=ir.globalThis.requestIdleCallback)&&void 0!==n?n:n8.bind(ir.globalThis);i.hooks.endFrame.tap(t.tag,function(){r.isFirstTimeRendering&&(r.isFirstTimeRendering=!1,c(function(){r.isFirstTimeRenderingFinished=!0;})),r.mutationRecords=[];});}}]);}().tag="Prepare";var iG=((P={}).READY="ready",P.BEFORE_RENDER="beforerender",P.RERENDER="rerender",P.AFTER_RENDER="afterrender",P.BEFORE_DESTROY="beforedestroy",P.AFTER_DESTROY="afterdestroy",P.RESIZE="resize",P.DIRTY_RECTANGLE="dirtyrectangle",P.RENDERER_CHANGED="rendererchanged",P);new rL(rB.MOUNTED),new rL(rB.UNMOUNTED),new rL(iG.BEFORE_RENDER),new rL(iG.RERENDER),new rL(iG.AFTER_RENDER);},bc49798e:function(t,e,n){"use strict";n.d(e,"__esModule",{value:!0}),n.e(e,{AABB:function(){return tr;},AbstractRendererPlugin:function(){return K;},CanvasEvent:function(){return iF;},CustomEvent:function(){return rI;},ElementEvent:function(){return rU;},GradientType:function(){return ey;},Node:function(){return rD;},Shape:function(){return j;},isPattern:function(){return eV;}});var r,i,a,o,s,l,u,c,h,d,f,v,p,g,y,m,k,E,x,T,N,b,S,w,P,M=n("777fffbe"),A=M._(n("ab297151")),C=M._(n("b1a4abb6")),R=M._(n("72ce8fb5")),O=M._(n("d60881d0")),L=M._(n("0b95a4d2")),I=M._(n("0afdccfb")),D=M._(n("7465ab36")),_=M._(n("32f41e1c")),G=n("597fa39f");n("f90e84e3");var F=n("abe9d8d6"),B=M._(n("3214ccb5")),U=M._(n("51ffafbb")),V=M._(n("3c7f532e")),z=n("b1a96927"),H=M._(n("2fabd5d4")),Y=M._(n("cb203630")),W=M._(n("1982f763")),q=M._(n("01aac514"));let X=n("1714eebe");var j=((r={}).GROUP="g",r.FRAGMENT="fragment",r.CIRCLE="circle",r.ELLIPSE="ellipse",r.IMAGE="image",r.RECT="rect",r.LINE="line",r.POLYLINE="polyline",r.POLYGON="polygon",r.TEXT="text",r.PATH="path",r.HTML="html",r.MESH="mesh",r),$=((i={})[i.ZERO=0]="ZERO",i[i.NEGATIVE_ONE=1]="NEGATIVE_ONE",i),K=(0,R.default)(function t(){(0,C.default)(this,t),this.plugins=[];},[{key:"addRenderingPlugin",value:function(t){this.plugins.push(t),this.context.renderingPlugins.push(t);}},{key:"removeAllRenderingPlugins",value:function(){var t=this;this.plugins.forEach(function(e){var n=t.context.renderingPlugins.indexOf(e);n>=0&&t.context.renderingPlugins.splice(n,1);});}}]),Z=G.vec3.add,Q=G.vec3.copy,J=G.vec3.max,tt=G.vec3.min,te=G.vec3.scale,tn=G.vec3.sub,tr=function(){function t(){(0,C.default)(this,t),this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0];}return(0,R.default)(t,[{key:"update",value:function(t,e){Q(this.center,t),Q(this.halfExtents,e),tn(this.min,this.center,this.halfExtents),Z(this.max,this.center,this.halfExtents);}},{key:"setMinMax",value:function(t,e){Z(this.center,e,t),te(this.center,this.center,.5),tn(this.halfExtents,e,t),te(this.halfExtents,this.halfExtents,.5),Q(this.min,t),Q(this.max,e);}},{key:"getMin",value:function(){return this.min;}},{key:"getMax",value:function(){return this.max;}},{key:"add",value:function(e){if(!t.isEmpty(e)){if(t.isEmpty(this)){this.setMinMax(e.getMin(),e.getMax());return;}var n=this.center,r=n[0],i=n[1],a=n[2],o=this.halfExtents,s=o[0],l=o[1],u=o[2],c=r-s,h=r+s,d=i-l,f=i+l,v=a-u,p=a+u,g=e.center,y=g[0],m=g[1],k=g[2],E=e.halfExtents,x=E[0],T=E[1],N=E[2],b=y-x,S=y+x,w=m-T,P=m+T,M=k-N,A=k+N;b<c&&(c=b),S>h&&(h=S),w<d&&(d=w),P>f&&(f=P),M<v&&(v=M),A>p&&(p=A),n[0]=(c+h)*.5,n[1]=(d+f)*.5,n[2]=(v+p)*.5,o[0]=(h-c)*.5,o[1]=(f-d)*.5,o[2]=(p-v)*.5,this.min[0]=c,this.min[1]=d,this.min[2]=v,this.max[0]=h,this.max[1]=f,this.max[2]=p;}}},{key:"setFromTransformedAABB",value:function(t,e){var n=this.center,r=this.halfExtents,i=t.center,a=t.halfExtents,o=e[0],s=e[4],l=e[8],u=e[1],c=e[5],h=e[9],d=e[2],f=e[6],v=e[10],p=Math.abs(o),g=Math.abs(s),y=Math.abs(l),m=Math.abs(u),k=Math.abs(c),E=Math.abs(h),x=Math.abs(d),T=Math.abs(f),N=Math.abs(v);n[0]=e[12]+o*i[0]+s*i[1]+l*i[2],n[1]=e[13]+u*i[0]+c*i[1]+h*i[2],n[2]=e[14]+d*i[0]+f*i[1]+v*i[2],r[0]=p*a[0]+g*a[1]+y*a[2],r[1]=m*a[0]+k*a[1]+E*a[2],r[2]=x*a[0]+T*a[1]+N*a[2],tn(this.min,n,r),Z(this.max,n,r);}},{key:"intersects",value:function(t){var e=this.getMax(),n=this.getMin(),r=t.getMax(),i=t.getMin();return n[0]<=r[0]&&e[0]>=i[0]&&n[1]<=r[1]&&e[1]>=i[1]&&n[2]<=r[2]&&e[2]>=i[2];}},{key:"intersection",value:function(e){if(!this.intersects(e))return null;var n=new t,r=J([0,0,0],this.getMin(),e.getMin()),i=tt([0,0,0],this.getMax(),e.getMax());return n.setMinMax(r,i),n;}},{key:"getNegativeFarPoint",value:function(t){return 273===t.pnVertexFlag?Q([0,0,0],this.min):272===t.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:257===t.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:256===t.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:17===t.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:16===t.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:1===t.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]];}},{key:"getPositiveFarPoint",value:function(t){return 273===t.pnVertexFlag?Q([0,0,0],this.max):272===t.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:257===t.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:256===t.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:17===t.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:16===t.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:1===t.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]];}}],[{key:"isEmpty",value:function(t){return!t||0===t.halfExtents[0]&&0===t.halfExtents[1]&&0===t.halfExtents[2];}}]);}(),ti=(0,R.default)(function t(e,n){(0,C.default)(this,t),this.distance=e||0,this.normal=n||G.vec3.fromValues(0,1,0),this.updatePNVertexFlag();},[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(Number(this.normal[0]>=0)<<8)+(Number(this.normal[1]>=0)<<4)+Number(this.normal[2]>=0);}},{key:"distanceToPoint",value:function(t){return G.vec3.dot(t,this.normal)-this.distance;}},{key:"normalize",value:function(){var t=1/G.vec3.len(this.normal);G.vec3.scale(this.normal,this.normal,t),this.distance*=t;}},{key:"intersectsLine",value:function(t,e,n){var r=this.distanceToPoint(t),i=r/(r-this.distanceToPoint(e)),a=i>=0&&i<=1;return a&&n&&G.vec3.lerp(n,t,e,i),a;}}]),ta=((a={})[a.OUTSIDE=4294967295]="OUTSIDE",a[a.INSIDE=0]="INSIDE",a[a.INDETERMINATE=2147483647]="INDETERMINATE",a),to=(0,R.default)(function t(e){if((0,C.default)(this,t),this.planes=[],e)this.planes=e;else for(var n=0;n<6;n++)this.planes.push(new ti);},[{key:"extractFromVPMatrix",value:function(t){var e=(0,D.default)(t,16),n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],v=e[12],p=e[13],g=e[14],y=e[15];G.vec3.set(this.planes[0].normal,a-n,u-o,f-c),this.planes[0].distance=y-v,G.vec3.set(this.planes[1].normal,a+n,u+o,f+c),this.planes[1].distance=y+v,G.vec3.set(this.planes[2].normal,a+r,u+s,f+h),this.planes[2].distance=y+p,G.vec3.set(this.planes[3].normal,a-r,u-s,f-h),this.planes[3].distance=y-p,G.vec3.set(this.planes[4].normal,a-i,u-l,f-d),this.planes[4].distance=y-g,G.vec3.set(this.planes[5].normal,a+i,u+l,f+d),this.planes[5].distance=y+g,this.planes.forEach(function(t){t.normalize(),t.updatePNVertexFlag();});}}]),ts=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,C.default)(this,t),this.x=0,this.y=0,this.x=e,this.y=n;}return(0,R.default)(t,[{key:"clone",value:function(){return new t(this.x,this.y);}},{key:"copyFrom",value:function(t){this.x=t.x,this.y=t.y;}}]);}(),tl=function(){function t(e,n,r,i){(0,C.default)(this,t),this.x=e,this.y=n,this.width=r,this.height=i,this.left=e,this.right=e+r,this.top=n,this.bottom=n+i;}return(0,R.default)(t,[{key:"toJSON",value:function(){}}],[{key:"fromRect",value:function(e){return new t(e.x,e.y,e.width,e.height);}},{key:"applyTransform",value:function(e,n){var r=G.vec4.fromValues(e.x,e.y,0,1),i=G.vec4.fromValues(e.x+e.width,e.y,0,1),a=G.vec4.fromValues(e.x,e.y+e.height,0,1),o=G.vec4.fromValues(e.x+e.width,e.y+e.height,0,1),s=G.vec4.create(),l=G.vec4.create(),u=G.vec4.create(),c=G.vec4.create();G.vec4.transformMat4(s,r,n),G.vec4.transformMat4(l,i,n),G.vec4.transformMat4(u,a,n),G.vec4.transformMat4(c,o,n);var h=Math.min(s[0],l[0],u[0],c[0]),d=Math.min(s[1],l[1],u[1],c[1]),f=Math.max(s[0],l[0],u[0],c[0]),v=Math.max(s[1],l[1],u[1],c[1]);return t.fromRect({x:h,y:d,width:f-h,height:v-d});}}]);}(),tu="Method not implemented.";function tc(t){return void 0===t?0:t>360||t<-360?t%360:t;}var th=G.vec3.create();function td(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];return Array.isArray(t)&&3===t.length?r?G.vec3.clone(t):G.vec3.copy(th,t):(0,F.isNumber)(t)?r?G.vec3.fromValues(t,e,n):G.vec3.set(th,t,e,n):r?G.vec3.fromValues(t[0],t[1]||e,t[2]||n):G.vec3.set(th,t[0],t[1]||e,t[2]||n);}var tf=Math.PI/180,tv=180/Math.PI,tp=Math.PI/2;function tg(t,e){var n,r,i,a,o,s,l,u,c,h,d,f,v,p,g,y,m;return 16===e.length?(i=G.mat4.getScaling(G.vec3.create(),e),o=(a=(0,D.default)(i,3))[0],s=a[1],l=a[2],(u=Math.asin(-e[2]/o))<tp?u>-tp?(n=Math.atan2(e[6]/s,e[10]/l),r=Math.atan2(e[1]/o,e[0]/o)):(r=0,n=-Math.atan2(e[4]/s,e[5]/s)):(r=0,n=Math.atan2(e[4]/s,e[5]/s)),t[0]=n,t[1]=u,t[2]=r):(c=e[0],h=e[1],d=e[2],f=e[3],y=c*c+(v=h*h)+(p=d*d)+(g=f*f),(m=c*f-h*d)>.499995*y?(t[0]=tp,t[1]=2*Math.atan2(h,c),t[2]=0):m<-.499995*y?(t[0]=-tp,t[1]=2*Math.atan2(h,c),t[2]=0):(t[0]=Math.asin(2*(c*d-f*h)),t[1]=Math.atan2(2*(c*f+h*d),1-2*(p+g)),t[2]=Math.atan2(2*(c*h+d*f),1-2*(v+p)))),t;}function ty(t){var e=t[0],n=t[1],r=t[3],i=t[4],a=Math.sqrt(e*e+n*n),o=Math.sqrt(r*r+i*i);if(e*i-n*r<0&&(e<i?a=-a:o=-o),a){var s=1/a;e*=s,n*=s;}if(o){var l=1/o;r*=l,i*=l;}var u=Math.atan2(n,e)*tv;return[t[6],t[7],a,o,u];}var tm=G.mat4.create(),tk=G.mat4.create(),tE=G.vec4.create(),tx=[G.vec3.create(),G.vec3.create(),G.vec3.create()],tT=G.vec3.create();function tN(t,e,n,r,i){t[0]=e[0]*r+n[0]*i,t[1]=e[1]*r+n[1]*i,t[2]=e[2]*r+n[2]*i;}var tb=((o={})[o.ORBITING=0]="ORBITING",o[o.EXPLORING=1]="EXPLORING",o[o.TRACKING=2]="TRACKING",o),tS=((s={})[s.DEFAULT=0]="DEFAULT",s[s.ROTATIONAL=1]="ROTATIONAL",s[s.TRANSLATIONAL=2]="TRANSLATIONAL",s[s.CINEMATIC=3]="CINEMATIC",s),tw=((l={})[l.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",l[l.PERSPECTIVE=1]="PERSPECTIVE",l),tP={UPDATED:"updated"},tM=(0,R.default)(function t(){(0,C.default)(this,t),this.clipSpaceNearZ=$.NEGATIVE_ONE,this.eventEmitter=new _.default,this.matrix=G.mat4.create(),this.right=G.vec3.fromValues(1,0,0),this.up=G.vec3.fromValues(0,1,0),this.forward=G.vec3.fromValues(0,0,1),this.position=G.vec3.fromValues(0,0,1),this.focalPoint=G.vec3.fromValues(0,0,0),this.distanceVector=G.vec3.fromValues(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=G.mat4.create(),this.projectionMatrixInverse=G.mat4.create(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=tb.EXPLORING,this.trackingMode=tS.DEFAULT,this.projectionMode=tw.PERSPECTIVE,this.frustum=new to,this.orthoMatrix=G.mat4.create();},[{key:"isOrtho",value:function(){return this.projectionMode===tw.ORTHOGRAPHIC;}},{key:"getProjectionMode",value:function(){return this.projectionMode;}},{key:"getPerspective",value:function(){return this.jitteredProjectionMatrix||this.projectionMatrix;}},{key:"getPerspectiveInverse",value:function(){return this.projectionMatrixInverse;}},{key:"getFrustum",value:function(){return this.frustum;}},{key:"getPosition",value:function(){return this.position;}},{key:"getFocalPoint",value:function(){return this.focalPoint;}},{key:"getDollyingStep",value:function(){return this.dollyingStep;}},{key:"getNear",value:function(){return this.near;}},{key:"getFar",value:function(){return this.far;}},{key:"getZoom",value:function(){return this.zoom;}},{key:"getOrthoMatrix",value:function(){return this.orthoMatrix;}},{key:"getView",value:function(){return this.view;}},{key:"setEnableUpdate",value:function(t){this.enableUpdate=t;}},{key:"setType",value:function(t,e){return this.type=t,this.type===tb.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===tb.TRACKING&&void 0!==e&&this.setTrackingMode(e),this;}},{key:"setProjectionMode",value:function(t){return this.projectionMode=t,this;}},{key:"setTrackingMode",value:function(t){if(this.type!==tb.TRACKING)throw Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=t,this;}},{key:"setWorldRotation",value:function(t){return this.rotateWorld=t,this._getAngles(),this;}},{key:"getViewTransform",value:function(){return G.mat4.invert(G.mat4.create(),this.matrix);}},{key:"getWorldTransform",value:function(){return this.matrix;}},{key:"jitterProjectionMatrix",value:function(t,e){var n=G.mat4.fromTranslation(G.mat4.create(),[t,e,0]);this.jitteredProjectionMatrix=G.mat4.multiply(G.mat4.create(),n,this.projectionMatrix);}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0;}},{key:"setMatrix",value:function(t){return this.matrix=t,this._update(),this;}},{key:"setProjectionMatrix",value:function(t){this.projectionMatrix=t;}},{key:"setFov",value:function(t){return this.setPerspective(this.near,this.far,t,this.aspect),this;}},{key:"setAspect",value:function(t){return this.setPerspective(this.near,this.far,this.fov,t),this;}},{key:"setNear",value:function(t){return this.projectionMode===tw.PERSPECTIVE?this.setPerspective(t,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,t,this.far),this;}},{key:"setFar",value:function(t){return this.projectionMode===tw.PERSPECTIVE?this.setPerspective(this.near,t,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,t),this;}},{key:"setViewOffset",value:function(t,e,n,r,i,a){return this.aspect=t/e,void 0===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.projectionMode===tw.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this;}},{key:"clearViewOffset",value:function(){return void 0!==this.view&&(this.view.enabled=!1),this.projectionMode===tw.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this;}},{key:"setZoom",value:function(t){return this.zoom=t,this.projectionMode===tw.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===tw.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this;}},{key:"setZoomByViewportPoint",value:function(t,e){var n=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),r=n.x,i=n.y,a=this.roll;this.rotate(0,0,-a),this.setPosition(r,i),this.setFocalPoint(r,i),this.setZoom(t),this.rotate(0,0,a);var o=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),s=o.x,l=o.y,u=G.vec3.fromValues(s-r,l-i,0),c=G.vec3.dot(u,this.right)/G.vec3.length(this.right),h=G.vec3.dot(u,this.up)/G.vec3.length(this.up),d=this.getPosition(),f=(0,D.default)(d,2),v=f[0],p=f[1],g=this.getFocalPoint(),y=(0,D.default)(g,2),m=y[0],k=y[1];return this.setPosition(v-c,p-h),this.setFocalPoint(m-c,k-h),this;}},{key:"setPerspective",value:function(t,e,n,r){this.projectionMode=tw.PERSPECTIVE,this.fov=n,this.near=t,this.far=e,this.aspect=r;var i,a=this.near*Math.tan(.5*this.fov*tf)/this.zoom,o=2*a,s=this.aspect*o,l=-.5*s;if(null!==(i=this.view)&&void 0!==i&&i.enabled){var u=this.view.fullWidth,c=this.view.fullHeight;l+=this.view.offsetX*s/u,a-=this.view.offsetY*o/c,s*=this.view.width/u,o*=this.view.height/c;}return!function(t,e,n,r,i,a,o){var s,l,u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=2*a,h=n-e,d=r-i,f=o-a,v=o*a;u?(s=-o/f,l=-v/f):(s=-(o+a)/f,l=-2*v/f),t[0]=c/h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c/d,t[6]=0,t[7]=0,t[8]=(n+e)/h,t[9]=(r+i)/d,t[10]=s,t[11]=-1,t[12]=0,t[13]=0,t[14]=l,t[15]=0;}(this.projectionMatrix,l,l+s,a-o,a,t,this.far,this.clipSpaceNearZ===$.ZERO),G.mat4.invert(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this;}},{key:"setOrthographic",value:function(t,e,n,r,i,a){this.projectionMode=tw.ORTHOGRAPHIC,this.rright=e,this.left=t,this.top=n,this.bottom=r,this.near=i,this.far=a;var o,s=(this.rright-this.left)/(2*this.zoom),l=(this.top-this.bottom)/(2*this.zoom),u=(this.rright+this.left)/2,c=(this.top+this.bottom)/2,h=u-s,d=u+s,f=c+l,v=c-l;if(null!==(o=this.view)&&void 0!==o&&o.enabled){var p=(this.rright-this.left)/this.view.fullWidth/this.zoom,g=(this.top-this.bottom)/this.view.fullHeight/this.zoom;h+=p*this.view.offsetX,d=h+p*this.view.width,f-=g*this.view.offsetY,v=f-g*this.view.height;}return this.clipSpaceNearZ===$.NEGATIVE_ONE?G.mat4.ortho(this.projectionMatrix,h,d,f,v,i,a):G.mat4.orthoZO(this.projectionMatrix,h,d,f,v,i,a),G.mat4.invert(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this;}},{key:"setPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.position[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.position[2],r=td(t,e,n);return this._setPosition(r),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this;}},{key:"setFocalPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.focalPoint[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.focalPoint[2],r=G.vec3.fromValues(0,1,0);if(this.focalPoint=td(t,e,n),this.trackingMode===tS.CINEMATIC){var i=G.vec3.subtract(G.vec3.create(),this.focalPoint,this.position);t=i[0],e=i[1],n=i[2];var a=Math.asin(e/G.vec3.length(i))*tv,o=90+Math.atan2(n,t)*tv,s=G.mat4.create();G.mat4.rotateY(s,s,o*tf),G.mat4.rotateX(s,s,a*tf),r=G.vec3.transformMat4(G.vec3.create(),[0,1,0],s);}return G.mat4.invert(this.matrix,G.mat4.lookAt(G.mat4.create(),this.position,this.focalPoint,r)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this;}},{key:"getDistance",value:function(){return this.distance;}},{key:"getDistanceVector",value:function(){return this.distanceVector;}},{key:"setDistance",value:function(t){if(this.distance===t||t<0)return this;this.distance=t,this.distance<2e-4&&(this.distance=2e-4),this.dollyingStep=this.distance/100;var e=G.vec3.create();t=this.distance;var n=this.forward,r=this.focalPoint;return e[0]=t*n[0]+r[0],e[1]=t*n[1]+r[1],e[2]=t*n[2]+r[2],this._setPosition(e),this.triggerUpdate(),this;}},{key:"setMaxDistance",value:function(t){return this.maxDistance=t,this;}},{key:"setMinDistance",value:function(t){return this.minDistance=t,this;}},{key:"setAzimuth",value:function(t){return this.azimuth=tc(t),this.computeMatrix(),this._getAxes(),this.type===tb.ORBITING||this.type===tb.EXPLORING?this._getPosition():this.type===tb.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getAzimuth",value:function(){return this.azimuth;}},{key:"setElevation",value:function(t){return this.elevation=tc(t),this.computeMatrix(),this._getAxes(),this.type===tb.ORBITING||this.type===tb.EXPLORING?this._getPosition():this.type===tb.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getElevation",value:function(){return this.elevation;}},{key:"setRoll",value:function(t){return this.roll=tc(t),this.computeMatrix(),this._getAxes(),this.type===tb.ORBITING||this.type===tb.EXPLORING?this._getPosition():this.type===tb.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getRoll",value:function(){return this.roll;}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate();}},{key:"computeMatrix",value:function(){var t=G.quat.setAxisAngle(G.quat.create(),[0,0,1],this.roll*tf);G.mat4.identity(this.matrix);var e=G.quat.setAxisAngle(G.quat.create(),[1,0,0],(this.rotateWorld&&this.type!==tb.TRACKING||this.type===tb.TRACKING?1:-1)*this.elevation*tf),n=G.quat.setAxisAngle(G.quat.create(),[0,1,0],(this.rotateWorld&&this.type!==tb.TRACKING||this.type===tb.TRACKING?1:-1)*this.azimuth*tf),r=G.quat.multiply(G.quat.create(),n,e);r=G.quat.multiply(G.quat.create(),r,t);var i=G.mat4.fromQuat(G.mat4.create(),r);this.type===tb.ORBITING||this.type===tb.EXPLORING?(G.mat4.translate(this.matrix,this.matrix,this.focalPoint),G.mat4.multiply(this.matrix,this.matrix,i),G.mat4.translate(this.matrix,this.matrix,[0,0,this.distance])):this.type===tb.TRACKING&&(G.mat4.translate(this.matrix,this.matrix,this.position),G.mat4.multiply(this.matrix,this.matrix,i));}},{key:"_setPosition",value:function(t,e,n){this.position=td(t,e,n);var r=this.matrix;r[12]=this.position[0],r[13]=this.position[1],r[14]=this.position[2],r[15]=1,this._getOrthoMatrix();}},{key:"_getAxes",value:function(){G.vec3.copy(this.right,td(G.vec4.transformMat4(G.vec4.create(),[1,0,0,0],this.matrix))),G.vec3.copy(this.up,td(G.vec4.transformMat4(G.vec4.create(),[0,1,0,0],this.matrix))),G.vec3.copy(this.forward,td(G.vec4.transformMat4(G.vec4.create(),[0,0,1,0],this.matrix))),G.vec3.normalize(this.right,this.right),G.vec3.normalize(this.up,this.up),G.vec3.normalize(this.forward,this.forward);}},{key:"_getAngles",value:function(){var t=this.distanceVector[0],e=this.distanceVector[1],n=this.distanceVector[2],r=G.vec3.length(this.distanceVector);if(0===r){this.elevation=0,this.azimuth=0;return;}this.type===tb.TRACKING?(this.elevation=Math.asin(e/r)*tv,this.azimuth=Math.atan2(-t,-n)*tv):this.rotateWorld?(this.elevation=Math.asin(e/r)*tv,this.azimuth=Math.atan2(-t,-n)*tv):(this.elevation=-(Math.asin(e/r)*tv),this.azimuth=-(Math.atan2(-t,-n)*tv));}},{key:"_getPosition",value:function(){G.vec3.copy(this.position,td(G.vec4.transformMat4(G.vec4.create(),[0,0,0,1],this.matrix))),this._getDistance();}},{key:"_getFocalPoint",value:function(){G.vec3.transformMat3(this.distanceVector,[0,0,-this.distance],G.mat3.fromMat4(G.mat3.create(),this.matrix)),G.vec3.add(this.focalPoint,this.position,this.distanceVector),this._getDistance();}},{key:"_getDistance",value:function(){this.distanceVector=G.vec3.subtract(G.vec3.create(),this.focalPoint,this.position),this.distance=G.vec3.length(this.distanceVector),this.dollyingStep=this.distance/100;}},{key:"_getOrthoMatrix",value:function(){if(this.projectionMode===tw.ORTHOGRAPHIC){var t=this.position,e=G.quat.setAxisAngle(G.quat.create(),[0,0,1],-this.roll*Math.PI/180);G.mat4.fromRotationTranslationScaleOrigin(this.orthoMatrix,e,G.vec3.fromValues((this.rright-this.left)/2-t[0],(this.top-this.bottom)/2-t[1],0),G.vec3.fromValues(this.zoom,this.zoom,1),t);}}},{key:"triggerUpdate",value:function(){if(this.enableUpdate){var t=this.getViewTransform(),e=G.mat4.multiply(G.mat4.create(),this.getPerspective(),t);this.getFrustum().extractFromVPMatrix(e),this.eventEmitter.emit(tP.UPDATED);}}},{key:"rotate",value:function(t,e,n){throw Error(tu);}},{key:"pan",value:function(t,e){throw Error(tu);}},{key:"dolly",value:function(t){throw Error(tu);}},{key:"createLandmark",value:function(t,e){throw Error(tu);}},{key:"gotoLandmark",value:function(t,e){throw Error(tu);}},{key:"cancelLandmarkAnimation",value:function(){throw Error(tu);}}]),tA=((u={})[u.Standard=0]="Standard",u),tC=((c={})[c.ADDED=0]="ADDED",c[c.REMOVED=1]="REMOVED",c[c.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED",c),tR=G.vec3.create(),tO=G.mat4.create(),tL=G.quat.create();function tI(t){if(t.localDirtyFlag){if(0!==t.localSkew[0]||0!==t.localSkew[1]){G.mat4.fromRotationTranslationScaleOrigin(t.localTransform,t.localRotation,t.localPosition,G.vec3.fromValues(1,1,1),t.origin),(0!==t.localSkew[0]||0!==t.localSkew[1])&&(G.mat4.identity(tO),tO[4]=Math.tan(t.localSkew[0]),tO[1]=Math.tan(t.localSkew[1]),G.mat4.multiply(t.localTransform,t.localTransform,tO));var e=G.mat4.fromRotationTranslationScaleOrigin(tO,G.quat.set(tL,0,0,0,1),G.vec3.set(tR,1,1,1),t.localScale,t.origin);G.mat4.multiply(t.localTransform,t.localTransform,e);}else{var n=t.localTransform,r=t.localPosition,i=t.localRotation,a=t.localScale,o=t.origin,s=0!==r[0]||0!==r[1]||0!==r[2],l=1!==i[3]||0!==i[0]||0!==i[1]||0!==i[2],u=1!==a[0]||1!==a[1]||1!==a[2],c=0!==o[0]||0!==o[1]||0!==o[2];l||u||c?G.mat4.fromRotationTranslationScaleOrigin(n,i,r,a,o):s?G.mat4.fromTranslation(n,r):G.mat4.identity(n);}t.localDirtyFlag=!1;}}var tD={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new tl(0,0,0,0)},t_=((h={}).COORDINATE="<coordinate>",h.COLOR="<color>",h.PAINT="<paint>",h.NUMBER="<number>",h.ANGLE="<angle>",h.OPACITY_VALUE="<opacity-value>",h.SHADOW_BLUR="<shadow-blur>",h.LENGTH="<length>",h.PERCENTAGE="<percentage>",h.LENGTH_PERCENTAGE="<length> | <percentage>",h.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",h.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",h.LIST_OF_POINTS="<list-of-points>",h.PATH="<path>",h.FILTER="<filter>",h.Z_INDEX="<z-index>",h.OFFSET_DISTANCE="<offset-distance>",h.DEFINED_PATH="<defined-path>",h.MARKER="<marker>",h.TRANSFORM="<transform>",h.TRANSFORM_ORIGIN="<transform-origin>",h.TEXT="<text>",h.TEXT_TRANSFORM="<text-transform>",h);function tG(t,e,n){t.prototype=e.prototype=n,n.constructor=t;}function tF(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n;}function tB(){}var tU="\\s*([+-]?\\d+)\\s*",tV="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",tz="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",tH=/^#([0-9a-f]{3,8})$/,tY=RegExp(`^rgb\\(${tU},${tU},${tU}\\)$`),tW=RegExp(`^rgb\\(${tz},${tz},${tz}\\)$`),tq=RegExp(`^rgba\\(${tU},${tU},${tU},${tV}\\)$`),tX=RegExp(`^rgba\\(${tz},${tz},${tz},${tV}\\)$`),tj=RegExp(`^hsl\\(${tV},${tz},${tz}\\)$`),t$=RegExp(`^hsla\\(${tV},${tz},${tz},${tV}\\)$`),tK={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function tZ(){return this.rgb().formatHex();}function tQ(){return this.rgb().formatRgb();}function tJ(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=tH.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?t0(e):3===n?new t2(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?t1(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?t1(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=tY.exec(t))?new t2(e[1],e[2],e[3],1):(e=tW.exec(t))?new t2(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=tq.exec(t))?t1(e[1],e[2],e[3],e[4]):(e=tX.exec(t))?t1(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=tj.exec(t))?t9(e[1],e[2]/100,e[3]/100,1):(e=t$.exec(t))?t9(e[1],e[2]/100,e[3]/100,e[4]):tK.hasOwnProperty(t)?t0(tK[t]):"transparent"===t?new t2(NaN,NaN,NaN,0):null;}function t0(t){return new t2(t>>16&255,t>>8&255,255&t,1);}function t1(t,e,n,r){return r<=0&&(t=e=n=NaN),new t2(t,e,n,r);}function t2(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r;}function t3(){return`#${t7(this.r)}${t7(this.g)}${t7(this.b)}`;}function t4(){let t=t5(this.opacity);return`${1===t?"rgb(":"rgba("}${t6(this.r)}, ${t6(this.g)}, ${t6(this.b)}${1===t?")":`, ${t})`}`;}function t5(t){return isNaN(t)?1:Math.max(0,Math.min(1,t));}function t6(t){return Math.max(0,Math.min(255,Math.round(t)||0));}function t7(t){return((t=t6(t))<16?"0":"")+t.toString(16);}function t9(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new et(t,e,n,r);}function t8(t){if(t instanceof et)return new et(t.h,t.s,t.l,t.opacity);if(t instanceof tB||(t=tJ(t)),!t)return new et;if(t instanceof et)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,l=(a+i)/2;return s?(o=e===a?(n-r)/s+(n<r)*6:n===a?(r-e)/s+2:(e-n)/s+4,s/=l<.5?a+i:2-a-i,o*=60):s=l>0&&l<1?0:o,new et(o,s,l,t.opacity);}function et(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r;}function ee(t){return(t=(t||0)%360)<0?t+360:t;}function en(t){return Math.max(0,Math.min(1,t||0));}function er(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255;}function ei(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw TypeError("Expected a function");var n=function(){for(var r=arguments.length,i=Array(r),a=0;a<r;a++)i[a]=arguments[a];var o=e?e.apply(this,i):i[0],s=n.cache;if(s.has(o))return s.get(o);var l=t.apply(this,i);return n.cache=s.set(o,l)||s,l;};return n.cache=new(ei.Cache||Map),ei.cacheList.push(n.cache),n;}tG(tB,tJ,{copy(t){return Object.assign(new this.constructor,this,t);},displayable(){return this.rgb().displayable();},hex:tZ,formatHex:tZ,formatHex8:function(){return this.rgb().formatHex8();},formatHsl:function(){return t8(this).formatHsl();},formatRgb:tQ,toString:tQ}),tG(t2,function(t,e,n,r){var i;return 1==arguments.length?((i=t)instanceof tB||(i=tJ(i)),i)?new t2((i=i.rgb()).r,i.g,i.b,i.opacity):new t2:new t2(t,e,n,null==r?1:r);},tF(tB,{brighter(t){return t=null==t?1.4285714285714286:Math.pow(1.4285714285714286,t),new t2(this.r*t,this.g*t,this.b*t,this.opacity);},darker(t){return t=null==t?.7:Math.pow(.7,t),new t2(this.r*t,this.g*t,this.b*t,this.opacity);},rgb(){return this;},clamp(){return new t2(t6(this.r),t6(this.g),t6(this.b),t5(this.opacity));},displayable(){return -.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1;},hex:t3,formatHex:t3,formatHex8:function(){return`#${t7(this.r)}${t7(this.g)}${t7(this.b)}${t7((isNaN(this.opacity)?1:this.opacity)*255)}`;},formatRgb:t4,toString:t4})),tG(et,function(t,e,n,r){return 1==arguments.length?t8(t):new et(t,e,n,null==r?1:r);},tF(tB,{brighter(t){return t=null==t?1.4285714285714286:Math.pow(1.4285714285714286,t),new et(this.h,this.s,this.l*t,this.opacity);},darker(t){return t=null==t?.7:Math.pow(.7,t),new et(this.h,this.s,this.l*t,this.opacity);},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new t2(er(t>=240?t-240:t+120,i,r),er(t,i,r),er(t<120?t+240:t-120,i,r),this.opacity);},clamp(){return new et(ee(this.h),en(this.s),en(this.l),t5(this.opacity));},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1;},formatHsl(){let t=t5(this.opacity);return`${1===t?"hsl(":"hsla("}${ee(this.h)}, ${100*en(this.s)}%, ${100*en(this.l)}%${1===t?")":`, ${t})`}`;}})),ei.Cache=Map,ei.cacheList=[],ei.clearCache=function(){ei.cacheList.forEach(function(t){return t.clear();});};var ea=((d={})[d.kUnknown=0]="kUnknown",d[d.kNumber=1]="kNumber",d[d.kPercentage=2]="kPercentage",d[d.kEms=3]="kEms",d[d.kPixels=4]="kPixels",d[d.kRems=5]="kRems",d[d.kDegrees=6]="kDegrees",d[d.kRadians=7]="kRadians",d[d.kGradians=8]="kGradians",d[d.kTurns=9]="kTurns",d[d.kMilliseconds=10]="kMilliseconds",d[d.kSeconds=11]="kSeconds",d[d.kInteger=12]="kInteger",d),eo=((f={})[f.kUNumber=0]="kUNumber",f[f.kUPercent=1]="kUPercent",f[f.kULength=2]="kULength",f[f.kUAngle=3]="kUAngle",f[f.kUTime=4]="kUTime",f[f.kUOther=5]="kUOther",f),es=((v={})[v.kYes=0]="kYes",v[v.kNo=1]="kNo",v),el=((p={})[p.kYes=0]="kYes",p[p.kNo=1]="kNo",p),eu=[{name:"em",unit_type:ea.kEms},{name:"px",unit_type:ea.kPixels},{name:"deg",unit_type:ea.kDegrees},{name:"rad",unit_type:ea.kRadians},{name:"grad",unit_type:ea.kGradians},{name:"ms",unit_type:ea.kMilliseconds},{name:"s",unit_type:ea.kSeconds},{name:"rem",unit_type:ea.kRems},{name:"turn",unit_type:ea.kTurns}],ec=((g={})[g.kUnknownType=0]="kUnknownType",g[g.kUnparsedType=1]="kUnparsedType",g[g.kKeywordType=2]="kKeywordType",g[g.kUnitType=3]="kUnitType",g[g.kSumType=4]="kSumType",g[g.kProductType=5]="kProductType",g[g.kNegateType=6]="kNegateType",g[g.kInvertType=7]="kInvertType",g[g.kMinType=8]="kMinType",g[g.kMaxType=9]="kMaxType",g[g.kClampType=10]="kClampType",g[g.kTransformType=11]="kTransformType",g[g.kPositionType=12]="kPositionType",g[g.kURLImageType=13]="kURLImageType",g[g.kColorType=14]="kColorType",g[g.kUnsupportedColorType=15]="kUnsupportedColorType",g),eh=function(t){switch(t){case ea.kNumber:case ea.kInteger:return eo.kUNumber;case ea.kPercentage:return eo.kUPercent;case ea.kPixels:return eo.kULength;case ea.kMilliseconds:case ea.kSeconds:return eo.kUTime;case ea.kDegrees:case ea.kRadians:case ea.kGradians:case ea.kTurns:return eo.kUAngle;default:return eo.kUOther;}},ed=function(t){switch(t){case eo.kUNumber:return ea.kNumber;case eo.kULength:return ea.kPixels;case eo.kUPercent:return ea.kPercentage;case eo.kUTime:return ea.kSeconds;case eo.kUAngle:return ea.kDegrees;default:return ea.kUnknown;}},ef=function(t){var e=1;switch(t){case ea.kPixels:case ea.kDegrees:case ea.kSeconds:break;case ea.kMilliseconds:e=.001;break;case ea.kRadians:e=180/Math.PI;break;case ea.kGradians:e=.9;break;case ea.kTurns:e=360;}return e;},ev=function(t){switch(t){case ea.kNumber:case ea.kInteger:break;case ea.kPercentage:return"%";case ea.kEms:return"em";case ea.kRems:return"rem";case ea.kPixels:return"px";case ea.kDegrees:return"deg";case ea.kRadians:return"rad";case ea.kGradians:return"grad";case ea.kMilliseconds:return"ms";case ea.kSeconds:return"s";case ea.kTurns:return"turn";}return"";},ep=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"toString",value:function(){return this.buildCSSText(es.kNo,el.kNo,"");}},{key:"isNumericValue",value:function(){return this.getType()>=ec.kUnitType&&this.getType()<=ec.kClampType;}}],[{key:"isAngle",value:function(t){return t===ea.kDegrees||t===ea.kRadians||t===ea.kGradians||t===ea.kTurns;}},{key:"isLength",value:function(t){return t>=ea.kEms&&t<ea.kDegrees;}},{key:"isRelativeUnit",value:function(t){return t===ea.kPercentage||t===ea.kEms||t===ea.kRems;}},{key:"isTime",value:function(t){return t===ea.kSeconds||t===ea.kMilliseconds;}}]),eg=function(t){function e(t){var n;return(0,C.default)(this,e),(n=(0,L.default)(this,e)).colorSpace=t,n;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getType",value:function(){return ec.kColorType;}},{key:"to",value:function(t){return this;}}]);}(ep),ey=((y={})[y.Constant=0]="Constant",y[y.LinearGradient=1]="LinearGradient",y[y.RadialGradient=2]="RadialGradient",y),em=function(t){function e(t,n){var r;return(0,C.default)(this,e),(r=(0,L.default)(this,e)).type=t,r.value=n,r;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return new e(this.type,this.value);}},{key:"buildCSSText",value:function(t,e,n){return n;}},{key:"getType",value:function(){return ec.kColorType;}}]);}(ep),ek=function(t){function e(t){var n;return(0,C.default)(this,e),(n=(0,L.default)(this,e)).value=t,n;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return new e(this.value);}},{key:"getType",value:function(){return ec.kKeywordType;}},{key:"buildCSSText",value:function(t,e,n){return n+this.value;}}]);}(ep),eE=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(Number.isFinite(t)?"NaN":t>0?"infinity":"-infinity")+e;},ex=function(t){return ed(eh(t));},eT=function(t){function e(t){var n,r,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ea.kNumber;return(0,C.default)(this,e),r=(0,L.default)(this,e),i="string"==typeof a?(n=a)?"number"===n?ea.kNumber:"percent"===n||"%"===n?ea.kPercentage:eu.find(function(t){return t.name===n;}).unit_type:ea.kUnknown:a,r.unit=i,r.value=t,r;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return new e(this.value,this.unit);}},{key:"equals",value:function(t){return this.value===t.value&&this.unit===t.unit;}},{key:"getType",value:function(){return ec.kUnitType;}},{key:"convertTo",value:function(t){if(this.unit===t)return new e(this.value,this.unit);var n=ex(this.unit);if(n!==ex(t)||n===ea.kUnknown)return null;var r=ef(this.unit)/ef(t);return new e(this.value*r,t);}},{key:"buildCSSText",value:function(t,e,n){var r;switch(this.unit){case ea.kUnknown:break;case ea.kInteger:r=Number(this.value).toFixed(0);break;case ea.kNumber:case ea.kPercentage:case ea.kEms:case ea.kRems:case ea.kPixels:case ea.kDegrees:case ea.kRadians:case ea.kGradians:case ea.kMilliseconds:case ea.kSeconds:case ea.kTurns:var i=this.value,a=ev(this.unit);if(i<-999999||i>999999){var o=ev(this.unit);r=!Number.isFinite(i)||Number.isNaN(i)?eE(i,o):i+(o||"");}else r="".concat(i).concat(a);}return n+r;}}]);}(ep),eN=new eT(0,"px");new eT(1,"px");var eb=new eT(0,"deg"),eS=function(t){function e(t,n,r){var i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return(0,C.default)(this,e),(i=(0,L.default)(this,e,["rgb"])).r=t,i.g=n,i.b=r,i.alpha=a,i.isNone=o,i;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return new e(this.r,this.g,this.b,this.alpha);}},{key:"buildCSSText",value:function(t,e,n){return"".concat(n,"rgba(").concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")");}}]);}(eg),ew=new ek("unset"),eP={"":ew,unset:ew,initial:new ek("initial"),inherit:new ek("inherit")},eM=new eS(0,0,0,0,!0),eA=new eS(0,0,0,0),eC=ei(function(t,e,n,r){return new eS(t,e,n,r);},function(t,e,n,r){return"rgba(".concat(t,",").concat(e,",").concat(n,",").concat(r,")");}),eR=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ea.kNumber;return new eT(t,e);};new eT(50,"%");var eO=function(){var t={linearGradient:/^(linear\-gradient)/i,repeatingLinearGradient:/^(repeating\-linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,repeatingRadialGradient:/^(repeating\-radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},e="";function n(t){throw Error("".concat(e,": ").concat(t));}function r(){return i("linear-gradient",t.linearGradient,o)||i("repeating-linear-gradient",t.repeatingLinearGradient,o)||i("radial-gradient",t.radialGradient,s)||i("repeating-radial-gradient",t.repeatingRadialGradient,s)||i("conic-gradient",t.conicGradient,s);}function i(e,r,i){return a(r,function(r){var a=i();return a&&!m(t.comma)&&n("Missing comma before color stops"),{type:e,orientation:a,colorStops:d(f)};});}function a(e,r){var i=m(e);if(i){m(t.startCall)||n("Missing (");var a=r(i);return m(t.endCall)||n("Missing )"),a;}}function o(){return y("directional",t.sideOrCorner,1)||y("angular",t.angleValue,1);}function s(){var n,r,i=l();return i&&((n=[]).push(i),r=e,m(t.comma)&&((i=l())?n.push(i):e=r)),n;}function l(){var t,e,n=((t=y("shape",/^(circle)/i,0))&&(t.style=g()||u()),t||((e=y("shape",/^(ellipse)/i,0))&&(e.style=p()||u()),e));if(n)n.at=c();else{var r=u();if(r){n=r;var i=c();i&&(n.at=i);}else{var a=h();a&&(n={type:"default-radial",at:a});}}return n;}function u(){return y("extent-keyword",t.extentKeywords,1);}function c(){if(y("position",/^at/,0)){var t=h();return t||n("Missing positioning value"),t;}}function h(){var t={x:p(),y:p()};if(t.x||t.y)return{type:"position",value:t};}function d(e){var r=e(),i=[];if(r)for(i.push(r);m(t.comma);)(r=e())?i.push(r):n("One extra comma");return i;}function f(){var e=y("hex",t.hexColor,1)||a(t.rgbaColor,function(){return{type:"rgba",value:d(v)};})||a(t.rgbColor,function(){return{type:"rgb",value:d(v)};})||y("literal",t.literalColor,0);return e||n("Expected color definition"),e.length=p(),e;}function v(){return m(t.number)[1];}function p(){return y("%",t.percentageValue,1)||y("position-keyword",t.positionKeywords,1)||g();}function g(){return y("px",t.pixelValue,1)||y("em",t.emValue,1);}function y(t,e,n){var r=m(e);if(r)return{type:t,value:r[n]};}function m(t){var n=/^[\n\r\t\s]+/.exec(e);n&&k(n[0].length);var r=t.exec(e);return r&&k(r[0].length),r;}function k(t){e=e.substring(t);}return function(t){var i;return e=t,i=d(r),e.length>0&&n("Invalid input not EOF"),i;};}(),eL=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,eI=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,eD=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,e_=/[\d.]+:(#[^\s]+|[^\)]+\))/gi,eG={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},eF=ei(function(t){return eR("angular"===t.type?Number(t.value):eG[t.value]||0,"deg");}),eB=ei(function(t){var e=50,n=50,r="%",i="%";if((null==t?void 0:t.type)==="position"){var a=t.value,o=a.x,s=a.y;(null==o?void 0:o.type)==="position-keyword"&&("left"===o.value?e=0:"center"===o.value?e=50:"right"===o.value?e=100:"top"===o.value?n=0:"bottom"===o.value&&(n=100)),(null==s?void 0:s.type)==="position-keyword"&&("left"===s.value?e=0:"center"===s.value?n=50:"right"===s.value?e=100:"top"===s.value?n=0:"bottom"===s.value&&(n=100)),((null==o?void 0:o.type)==="px"||(null==o?void 0:o.type)==="%"||(null==o?void 0:o.type)==="em")&&(r=null==o?void 0:o.type,e=Number(o.value)),((null==s?void 0:s.type)==="px"||(null==s?void 0:s.type)==="%"||(null==s?void 0:s.type)==="em")&&(i=null==s?void 0:s.type,n=Number(s.value));}return{cx:eR(e,r),cy:eR(n,i)};}),eU=ei(function(t){if(t.indexOf("linear")>-1||t.indexOf("radial")>-1)return eO(t).map(function(t){var e=t.type,n=t.orientation,r=t.colorStops;!function(t){var e=t.length;t[e-1].length=null!==(a=t[e-1].length)&&void 0!==a?a:{type:"%",value:"100"},e>1&&(t[0].length=null!==(o=t[0].length)&&void 0!==o?o:{type:"%",value:"0"});for(var n=0,r=Number(t[0].length.value),i=1;i<e;i++){var a,o,s,l=null===(s=t[i].length)||void 0===s?void 0:s.value;if(!(0,F.isNil)(l)&&!(0,F.isNil)(r)){for(var u=1;u<i-n;u++)t[n+u].length={type:"%",value:"".concat(r+(Number(l)-r)*u/(i-n))};n=i,r=Number(l);}}}(r);var i=r.map(function(t){var e,n;return{offset:eR(Number(t.length.value),"%"),color:(e=t.type,n=t.value,"hex"===e?"#".concat(n):"literal"===e?n:"rgb"===e?"rgb(".concat(n.join(","),")"):"rgba(".concat(n.join(","),")"))};});if("linear-gradient"===e)return new em(ey.LinearGradient,{angle:n?eF(n):eb,steps:i});if("radial-gradient"===e&&(n||(n=[{type:"shape",value:"circle"}]),"shape"===n[0].type&&"circle"===n[0].value)){var a,o=eB(n[0].at),s=o.cx,l=o.cy;if(n[0].style){var u=n[0].style,c=u.type,h=u.value;"extent-keyword"===c?(eP[h]||(eP[h]=new ek(h)),a=eP[h]):a=eR(h,c);}return new em(ey.RadialGradient,{cx:s,cy:l,size:a,steps:i});}});var e=t[0];if("("===t[1]||"("===t[2]){if("l"===e){var n=eL.exec(t);if(n){var r,i=(null===(r=n[2].match(e_))||void 0===r?void 0:r.map(function(t){return t.split(":");}))||[];return[new em(ey.LinearGradient,{angle:eR(parseFloat(n[1]),"deg"),steps:i.map(function(t){var e=(0,D.default)(t,2),n=e[0],r=e[1];return{offset:eR(100*Number(n),"%"),color:r};})})];}}else if("r"===e){var a=function(t){var e=eI.exec(t);if(e){var n,r=(null===(n=e[4].match(e_))||void 0===n?void 0:n.map(function(t){return t.split(":");}))||[];return{cx:eR(50,"%"),cy:eR(50,"%"),steps:r.map(function(t){var e=(0,D.default)(t,2),n=e[0],r=e[1];return{offset:eR(100*Number(n),"%"),color:r};})};}return null;}(t);if(a){if(!(0,F.isString)(a))return[new em(ey.RadialGradient,a)];t=a;}}else if("p"===e)return function(t){var e=eD.exec(t);if(e){var n=e[1],r=e[2];switch(n){case"a":n="repeat";break;case"x":n="repeat-x";break;case"y":n="repeat-y";break;default:n="no-repeat";}return{image:r,repetition:n};}return null;}(t);}});function eV(t){return t&&!!t.image;}function ez(t){return t&&!(0,F.isNil)(t.r)&&!(0,F.isNil)(t.g)&&!(0,F.isNil)(t.b);}var eH=ei(function(t){if(eV(t))return(0,A.default)({repetition:"repeat"},t);if((0,F.isNil)(t)&&(t=""),"transparent"===t)return eA;if("currentColor"===t)t="black";else if("none"===t)return eM;var e=eU(t);if(e)return e;var n=tJ(t),r=[0,0,0,0];return null!==n&&(r[0]=n.r||0,r[1]=n.g||0,r[2]=n.b||0,r[3]=n.opacity),eC.apply(void 0,r);});function eY(t,e){if(ez(t)&&ez(e))return[[Number(t.r),Number(t.g),Number(t.b),Number(t.alpha)],[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],function(t){var e=t.slice();if(e[3])for(var n=0;n<3;n++)e[n]=Math.round((0,F.clamp)(e[n],0,255));return e[3]=(0,F.clamp)(e[3],0,1),"rgba(".concat(e.join(","),")");}];}function eW(t,e){if((0,F.isNil)(e))return eR(0,"px");if(isFinite(Number(e="".concat(e).trim().toLowerCase()))){if("px".search(t)>=0)return eR(Number(e),"px");if("deg".search(t)>=0)return eR(Number(e),"deg");}var n=[];e=e.replace(t,function(t){return n.push(t),"U".concat(t);});var r="U(".concat(t.source,")");return n.map(function(t){return eR(Number(e.replace(RegExp("U".concat(t),"g"),"").replace(RegExp(r,"g"),"*0")),t);})[0];}var eq=function(t){return eW(/px/g,t);},eX=ei(eq);ei(function(t){return eW(RegExp("%","g"),t);});var ej=function(t){return(0,F.isNumber)(t)||isFinite(Number(t))?eR(Number(t)||0,"px"):eW(RegExp("px|%|em|rem","g"),t);},e$=ei(ej),eK=function(t){return eW(RegExp("deg|rad|grad|turn","g"),t);},eZ=ei(eK);function eQ(t){var e=0;return t.unit===ea.kDegrees?e=t.value:t.unit===ea.kRadians?e=Number(t.value)*tv:t.unit===ea.kTurns?e=360*Number(t.value):t.value&&(e=t.value),e;}function eJ(t,e){var n;return(Array.isArray(t)?n=t.map(function(t){return Number(t);}):(0,F.isString)(t)?n=t.split(" ").map(function(t){return Number(t);}):(0,F.isNumber)(t)&&(n=[t]),2===e)?1===n.length?[n[0],n[0]]:[n[0],n[1]]:4===e?1===n.length?[n[0],n[0],n[0],n[0]]:2===n.length?[n[0],n[1],n[0],n[1]]:3===n.length?[n[0],n[1],n[2],n[1]]:[n[0],n[1],n[2],n[3]]:"even"===e&&n.length%2==1?[].concat((0,O.default)(n),(0,O.default)(n)):n;}function e0(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t.unit===ea.kPixels)return Number(t.value);if(t.unit===ea.kPercentage&&n){var i=n.nodeName===j.GROUP?n.getLocalBounds():n.getGeometryBounds();return(r?i.min[e]:0)+t.value/100*i.halfExtents[e]*2;}return 0;}var e1=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function e2(t){return t.toString();}var e3=function(t){return"number"==typeof t?eR(t):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(t)?eR(Number(t)):eR(0);},e4=ei(e3);function e5(t,e){return[t,e,e2];}function e6(t,e){return function(n,r){return[n,r,function(n){return e2((0,F.clamp)(n,t,e));}];};}function e7(t,e){if(t.length===e.length)return[t,e,function(t){return t;}];}function e9(t){return 0===t.parsedStyle.d.totalLength&&(t.parsedStyle.d.totalLength=(0,F.getTotalLength)(t.parsedStyle.d.absolutePath)),t.parsedStyle.d.totalLength;}function e8(t,e){return t[0]===e[0]&&t[1]===e[1];}function nt(t,e){var n=t.prePoint,r=t.currentPoint,i=t.nextPoint,a=Math.pow(r[0]-n[0],2)+Math.pow(r[1]-n[1],2),o=Math.pow(r[0]-i[0],2)+Math.pow(r[1]-i[1],2),s=Math.acos((a+o-(Math.pow(n[0]-i[0],2)+Math.pow(n[1]-i[1],2)))/(2*Math.sqrt(a)*Math.sqrt(o)));if(!s||0===Math.sin(s)||(0,F.isNumberEqual)(s,0))return{xExtra:0,yExtra:0};var l=Math.abs(Math.atan2(i[1]-r[1],i[0]-r[0])),u=Math.abs(Math.atan2(i[0]-r[0],i[1]-r[1]));return{xExtra:e/2*(1/Math.sin(s/2))*Math.cos(s/2-(l=l>Math.PI/2?Math.PI-l:l))-e/2||0,yExtra:e/2*(1/Math.sin(s/2))*Math.cos((u=u>Math.PI/2?Math.PI-u:u)-s/2)-e/2||0};}function ne(t,e){return[e[0]+(e[0]-t[0]),e[1]+(e[1]-t[1])];}ei(function(t){return(0,F.isString)(t)?t.split(" ").map(e4):t.map(e4);});var nn=function(t,e){var n=t.x*e.x+t.y*e.y,r=Math.sqrt((Math.pow(t.x,2)+Math.pow(t.y,2))*(Math.pow(e.x,2)+Math.pow(e.y,2)));return(t.x*e.y-t.y*e.x<0?-1:1)*Math.acos(n/r);},nr=function(t,e,n,r,i,a,o,s){e=Math.abs(e),n=Math.abs(n);var l=(r=(0,F.mod)(r,360))*tf;if(t.x===o.x&&t.y===o.y)return{x:t.x,y:t.y,ellipticalArcAngle:0};if(0===e||0===n)return{x:0,y:0,ellipticalArcAngle:0};var u=(t.x-o.x)/2,c=(t.y-o.y)/2,h={x:Math.cos(l)*u+Math.sin(l)*c,y:-Math.sin(l)*u+Math.cos(l)*c},d=Math.pow(h.x,2)/Math.pow(e,2)+Math.pow(h.y,2)/Math.pow(n,2);d>1&&(e*=Math.sqrt(d),n*=Math.sqrt(d));var f=(Math.pow(e,2)*Math.pow(n,2)-Math.pow(e,2)*Math.pow(h.y,2)-Math.pow(n,2)*Math.pow(h.x,2))/(Math.pow(e,2)*Math.pow(h.y,2)+Math.pow(n,2)*Math.pow(h.x,2)),v=(i!==a?1:-1)*Math.sqrt(f=f<0?0:f),p={x:v*(e*h.y/n),y:v*(-(n*h.x)/e)},g={x:Math.cos(l)*p.x-Math.sin(l)*p.y+(t.x+o.x)/2,y:Math.sin(l)*p.x+Math.cos(l)*p.y+(t.y+o.y)/2},y={x:(h.x-p.x)/e,y:(h.y-p.y)/n},m=nn({x:1,y:0},y),k=nn(y,{x:(-h.x-p.x)/e,y:(-h.y-p.y)/n});!a&&k>0?k-=2*Math.PI:a&&k<0&&(k+=2*Math.PI);var E=m+(k%=2*Math.PI)*s,x=e*Math.cos(E),T=n*Math.sin(E);return{x:Math.cos(l)*x-Math.sin(l)*T+g.x,y:Math.sin(l)*x+Math.cos(l)*T+g.y,ellipticalArcStartAngle:m,ellipticalArcEndAngle:m+k,ellipticalArcAngle:E,ellipticalArcCenter:g,resultantRx:e,resultantRy:n};};function ni(t,e){var n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=t.arcParams,i=r.rx,a=void 0===i?0:i,o=r.ry,s=void 0===o?0:o,l=r.xRotation,u=r.arcFlag,c=r.sweepFlag,h=nr({x:t.prePoint[0],y:t.prePoint[1]},a,s,l,!!u,!!c,{x:t.currentPoint[0],y:t.currentPoint[1]},e),d=nr({x:t.prePoint[0],y:t.prePoint[1]},a,s,l,!!u,!!c,{x:t.currentPoint[0],y:t.currentPoint[1]},n?e+.005:e-.005),f=d.x-h.x,v=d.y-h.y,p=Math.sqrt(f*f+v*v);return{x:-f/p,y:-v/p};}function na(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1]);}function no(t,e){return na(t)*na(e)?(t[0]*e[0]+t[1]*e[1])/(na(t)*na(e)):1;}function ns(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(no(t,e));}var nl=function(t){if(""===t||Array.isArray(t)&&0===t.length)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};try{e=(0,F.normalizePath)(t);}catch(n){e=(0,F.normalizePath)(""),console.error("[g]: Invalid SVG Path definition: ".concat(t));}!function(t){for(var e=0;e<t.length;e++){var n=t[e-1],r=t[e];if("M"===r[0]&&n){var i=n[0],a=[r[1],r[2]],o=void 0;"L"===i||"M"===i?o=[n[1],n[2]]:("C"===i||"A"===i||"Q"===i)&&(o=[n[n.length-2],n[n.length-1]]),o&&e8(a,o)&&(t.splice(e,1),e--);}}}(e);var e,n=function(t){for(var e=!1,n=t.length,r=0;r<n;r++){var i=t[r][0];if("C"===i||"A"===i||"Q"===i){e=!0;break;}}return e;}(e),r=function(t){for(var e=[],n=[],r=[],i=0;i<t.length;i++){var a=t[i],o=a[0];"M"===o?(r.length&&(n.push(r),r=[]),r.push([a[1],a[2]])):"Z"===o?r.length&&(e.push(r),r=[]):r.push([a[1],a[2]]);}return r.length>0&&n.push(r),{polygons:e,polylines:n};}(e),i=r.polygons,a=r.polylines,o=function(t){for(var e=[],n=null,r=null,i=null,a=0,o=t.length,s=0;s<o;s++){var l=t[s];r=t[s+1];var u=l[0],c={command:u,prePoint:n,params:l,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(u){case"M":i=[l[1],l[2]],a=s;break;case"A":var h=function(t,e){var n=e[1],r=e[2],i=(0,F.mod)(e[3]*tf,2*Math.PI),a=e[4],o=e[5],s=t[0],l=t[1],u=e[6],c=e[7],h=Math.cos(i)*(s-u)/2+Math.sin(i)*(l-c)/2,d=-1*Math.sin(i)*(s-u)/2+Math.cos(i)*(l-c)/2,f=h*h/(n*n)+d*d/(r*r);f>1&&(n*=Math.sqrt(f),r*=Math.sqrt(f));var v=n*n*(d*d)+r*r*(h*h),p=v?Math.sqrt((n*n*(r*r)-v)/v):1;a===o&&(p*=-1),isNaN(p)&&(p=0);var g=r?p*n*d/r:0,y=n?-(p*r)*h/n:0,m=(s+u)/2+Math.cos(i)*g-Math.sin(i)*y,k=(l+c)/2+Math.sin(i)*g+Math.cos(i)*y,E=[(h-g)/n,(d-y)/r],x=[(-1*h-g)/n,(-1*d-y)/r],T=ns([1,0],E),N=ns(E,x);return -1>=no(E,x)&&(N=Math.PI),no(E,x)>=1&&(N=0),0===o&&N>0&&(N-=2*Math.PI),1===o&&N<0&&(N+=2*Math.PI),{cx:m,cy:k,rx:e8(t,[u,c])?0:n,ry:e8(t,[u,c])?0:r,startAngle:T,endAngle:T+N,xRotation:i,arcFlag:a,sweepFlag:o};}(n,l);c.arcParams=h;}if("Z"===u)n=i,r=t[a+1];else{var d=l.length;n=[l[d-2],l[d-1]];}r&&"Z"===r[0]&&(r=t[a],e[a]&&(e[a].prePoint=n)),c.currentPoint=n,e[a]&&e8(n,e[a].currentPoint)&&(e[a].prePoint=c.prePoint);var f=r?[r[r.length-2],r[r.length-1]]:null;c.nextPoint=f;var v=c.prePoint;if(["L","H","V"].includes(u))c.startTangent=[v[0]-n[0],v[1]-n[1]],c.endTangent=[n[0]-v[0],n[1]-v[1]];else if("Q"===u){var p=[l[1],l[2]];c.startTangent=[v[0]-p[0],v[1]-p[1]],c.endTangent=[n[0]-p[0],n[1]-p[1]];}else if("T"===u){var g=e[s-1],y=ne(g.currentPoint,v);"Q"===g.command?(c.command="Q",c.startTangent=[v[0]-y[0],v[1]-y[1]],c.endTangent=[n[0]-y[0],n[1]-y[1]]):(c.command="TL",c.startTangent=[v[0]-n[0],v[1]-n[1]],c.endTangent=[n[0]-v[0],n[1]-v[1]]);}else if("C"===u){var m=[l[1],l[2]],k=[l[3],l[4]];c.startTangent=[v[0]-m[0],v[1]-m[1]],c.endTangent=[n[0]-k[0],n[1]-k[1]],0===c.startTangent[0]&&0===c.startTangent[1]&&(c.startTangent=[m[0]-k[0],m[1]-k[1]]),0===c.endTangent[0]&&0===c.endTangent[1]&&(c.endTangent=[k[0]-m[0],k[1]-m[1]]);}else if("S"===u){var E=e[s-1],x=ne(E.currentPoint,v),T=[l[1],l[2]];"C"===E.command?(c.command="C",c.startTangent=[v[0]-x[0],v[1]-x[1]]):(c.command="SQ",c.startTangent=[v[0]-T[0],v[1]-T[1]]),c.endTangent=[n[0]-T[0],n[1]-T[1]];}else if("A"===u){var N=ni(c,0),b=N.x,S=N.y,w=ni(c,1,!1),P=w.x,M=w.y;c.startTangent=[b,S],c.endTangent=[P,M];}e.push(c);}return e;}(e),s=function(t,e){for(var n=[],r=[],i=[],a=0;a<t.length;a++){var o=t[a],s=o.currentPoint,l=o.params,u=o.prePoint,c=void 0;switch(o.command){case"Q":c=(0,z.quadBox)(u[0],u[1],l[1],l[2],l[3],l[4]);break;case"C":c=(0,z.cubicBox)(u[0],u[1],l[1],l[2],l[3],l[4],l[5],l[6]);break;case"A":var h=o.arcParams;c=(0,z.arcBox)(h.cx,h.cy,h.rx,h.ry,h.xRotation,h.startAngle,h.endAngle);break;default:n.push(s[0]),r.push(s[1]);}c&&(o.box=c,n.push(c.x,c.x+c.width),r.push(c.y,c.y+c.height));}n=n.filter(function(t){return!Number.isNaN(t)&&t!==1/0&&t!==-1/0;}),r=r.filter(function(t){return!Number.isNaN(t)&&t!==1/0&&t!==-1/0;});var d=(0,F.min)(n),f=(0,F.min)(r),v=(0,F.max)(n),p=(0,F.max)(r);if(0===i.length)return{x:d,y:f,width:v-d,height:p-f};for(var g=0;g<i.length;g++){var y=i[g],m=y.currentPoint;m[0]===d?d-=nt(y,0).xExtra:m[0]===v&&(v+=nt(y,0).xExtra),m[1]===f?f-=nt(y,e).yExtra:m[1]===p&&(p+=nt(y,e).yExtra);}return{x:d,y:f,width:v-d,height:p-f};}(o,0),l=s.x,u=s.y,c=s.width,h=s.height;return{absolutePath:e,hasArc:n,segments:o,polygons:i,polylines:a,totalLength:0,rect:{x:Number.isFinite(l)?l:0,y:Number.isFinite(u)?u:0,width:Number.isFinite(c)?c:0,height:Number.isFinite(h)?h:0}};},nu=ei(nl);function nc(t){return(0,F.isString)(t)?nu(t):nl(t);}function nh(t,e,n){var r=t.curve,i=e.curve;r&&0!==r.length||(r=(0,F.path2Curve)(t.absolutePath,!1),t.curve=r),i&&0!==i.length||(i=(0,F.path2Curve)(e.absolutePath,!1),e.curve=i);var a=[r,i];r.length!==i.length&&(a=(0,F.equalizeSegments)(r,i));var o=(0,F.getDrawDirection)(a[0])!==(0,F.getDrawDirection)(a[1])?(0,F.reverseCurve)(a[0]):(0,F.clonePath)(a[0]);return[o,(0,F.getRotatedCurve)(a[1],o),function(t){return t;}];}function nd(t,e){return[t.points,e.points,function(t){return t;}];}var nf=/\s*(\w+)\(([^)]*)\)/g;function nv(t){return function(e){var n=0;return t.map(function(t){return null===t?e[n++]:t;});};}function np(t){return t;}var ng={matrix:["NNNNNN",[null,null,0,0,null,null,0,0,0,0,1,0,null,null,0,1],np],matrix3d:["NNNNNNNNNNNNNNNN",np],rotate:["A"],rotateX:["A"],rotateY:["A"],rotateZ:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",nv([null,null,new eT(1)]),np],scaleX:["N",nv([null,new eT(1),new eT(1)]),nv([null,new eT(1)])],scaleY:["N",nv([new eT(1),null,new eT(1)]),nv([new eT(1),null])],scaleZ:["N",nv([new eT(1),new eT(1),null])],scale3d:["NNN",np],skew:["Aa",null,np],skewX:["A",null,nv([null,eb])],skewY:["A",null,nv([eb,null])],translate:["Tt",nv([null,null,eN]),np],translateX:["T",nv([null,eN,eN]),nv([null,eN])],translateY:["T",nv([eN,null,eN]),nv([eN,null])],translateZ:["L",nv([eN,eN,null])],translate3d:["TTL",np]};function ny(t){for(var e=[],n=t.length,r=0;r<n;r++){var i=t[r],a=i[0],o=i.slice(1);if("translate"===a||"skew"===a?1===o.length&&o.push(0):"scale"===a&&1===o.length&&o.push(o[0]),!ng[a])return[];var s=o.map(function(t){return eR(t);});e.push({t:a,d:s});}return e;}function nm(t){if(Array.isArray(t))return ny(t);if("none"===(t=(t||"none").trim()))return[];var e,n=[],r=0;for(nf.lastIndex=0;(e=nf.exec(t))&&e.index===r;){r=e.index+e[0].length;var i=e[1],a=ng[i];if(!a)break;var o=e[2].split(","),s=a[0];if(s.length<o.length)break;for(var l=[],u=0;u<s.length;u++){var c=o[u],h=s[u],d=void 0;if(void 0===(d=c?({A:function(t){return"0"===t.trim()?eb:eK(t);},N:e3,T:ej,L:eq})[h.toUpperCase()](c):({a:eb,n:l[0],t:eN})[h]))return[];l.push(d);}if(n.push({t:i,d:l}),nf.lastIndex===t.length)return n;}return[];}function nk(t){switch(t.t){case"rotateX":return[1,0,0,0,0,Math.cos(i=eQ(t.d[0])*tf),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1];case"rotateY":return[Math.cos(i=eQ(t.d[0])*tf),0,-Math.sin(i),0,0,1,0,0,Math.sin(i),0,Math.cos(i),0,0,0,0,1];case"rotate":case"rotateZ":return[Math.cos(i=eQ(t.d[0])*tf),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1,0,0,0,0,1];case"rotate3d":e=t.d[0].value,n=t.d[1].value,r=t.d[2].value,i=eQ(t.d[3])*tf;var e,n,r,i,a=e*e+n*n+r*r;if(0===a)e=1,n=0,r=0;else if(1!==a){var o=Math.sqrt(a);e/=o,n/=o,r/=o;}var s=Math.sin(i/2),l=s*Math.cos(i/2),u=s*s;return[1-2*(n*n+r*r)*u,2*(e*n*u+r*l),2*(e*r*u-n*l),0,2*(e*n*u-r*l),1-2*(e*e+r*r)*u,2*(n*r*u+e*l),0,2*(e*r*u+n*l),2*(n*r*u-e*l),1-2*(e*e+n*n)*u,0,0,0,0,1];case"scale":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scaleX":return[t.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaleY":return[1,0,0,0,0,t.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scaleZ":return[1,0,0,0,0,1,0,0,0,0,t.d[0].value,0,0,0,0,1];case"scale3d":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,t.d[2].value,0,0,0,0,1];case"skew":var c=eQ(t.d[0])*tf;return[1,Math.tan(eQ(t.d[1])*tf),0,0,Math.tan(c),1,0,0,0,0,1,0,0,0,0,1];case"skewX":return[1,0,0,0,Math.tan(i=eQ(t.d[0])*tf),1,0,0,0,0,1,0,0,0,0,1];case"skewY":return[1,Math.tan(i=eQ(t.d[0])*tf),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return[1,0,0,0,0,1,0,0,0,0,1,0,e=e0(t.d[0],0,null)||0,n=e0(t.d[1],0,null)||0,0,1];case"translateX":return[1,0,0,0,0,1,0,0,0,0,1,0,e=e0(t.d[0],0,null)||0,0,0,1];case"translateY":return[1,0,0,0,0,1,0,0,0,0,1,0,0,n=e0(t.d[0],0,null)||0,0,1];case"translateZ":return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,r=e0(t.d[0],0,null)||0,1];case"translate3d":return[1,0,0,0,0,1,0,0,0,0,1,0,e=e0(t.d[0],0,null)||0,n=e0(t.d[1],0,null)||0,r=e0(t.d[2],0,null)||0,1];case"perspective":var h=e0(t.d[0],0,null)||0;return[1,0,0,0,0,1,0,0,0,0,1,h?-1/h:0,0,0,0,1];case"matrix":return[t.d[0].value,t.d[1].value,0,0,t.d[2].value,t.d[3].value,0,0,0,0,1,0,t.d[4].value,t.d[5].value,0,1];case"matrix3d":return t.d.map(function(t){return t.value;});}}function nE(t,e){return[t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12]*e[3],t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13]*e[3],t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]*e[3],t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15]*e[3],t[0]*e[4]+t[4]*e[5]+t[8]*e[6]+t[12]*e[7],t[1]*e[4]+t[5]*e[5]+t[9]*e[6]+t[13]*e[7],t[2]*e[4]+t[6]*e[5]+t[10]*e[6]+t[14]*e[7],t[3]*e[4]+t[7]*e[5]+t[11]*e[6]+t[15]*e[7],t[0]*e[8]+t[4]*e[9]+t[8]*e[10]+t[12]*e[11],t[1]*e[8]+t[5]*e[9]+t[9]*e[10]+t[13]*e[11],t[2]*e[8]+t[6]*e[9]+t[10]*e[10]+t[14]*e[11],t[3]*e[8]+t[7]*e[9]+t[11]*e[10]+t[15]*e[11],t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12]*e[15],t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13]*e[15],t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14]*e[15],t[3]*e[12]+t[7]*e[13]+t[11]*e[14]+t[15]*e[15]];}function nx(t){var e=[0,0,0],n=[1,1,1],r=[0,0,0],i=[0,0,0,1],a=[0,0,0,1];return!function(t,e,n,r,i,a){if(!(!function(t,e){var n=e[15];if(0===n)return!1;for(var r=1/n,i=0;i<16;i++)t[i]=e[i]*r;return!0;}(tm,t)||(G.mat4.copy(tk,tm),tk[3]=0,tk[7]=0,tk[11]=0,tk[15]=1,1e-8>Math.abs(G.mat4.determinant(tk))))){var o=tm[3],s=tm[7],l=tm[11],u=tm[12],c=tm[13],h=tm[14],d=tm[15];if(0!==o||0!==s||0!==l){if(tE[0]=o,tE[1]=s,tE[2]=l,tE[3]=d,!G.mat4.invert(tk,tk))return;G.mat4.transpose(tk,tk),G.vec4.transformMat4(i,tE,tk);}else i[0]=i[1]=i[2]=0,i[3]=1;if(e[0]=u,e[1]=c,e[2]=h,tx[0][0]=tm[0],tx[0][1]=tm[1],tx[0][2]=tm[2],tx[1][0]=tm[4],tx[1][1]=tm[5],tx[1][2]=tm[6],tx[2][0]=tm[8],tx[2][1]=tm[9],tx[2][2]=tm[10],n[0]=G.vec3.length(tx[0]),G.vec3.normalize(tx[0],tx[0]),r[0]=G.vec3.dot(tx[0],tx[1]),tN(tx[1],tx[1],tx[0],1,-r[0]),n[1]=G.vec3.length(tx[1]),G.vec3.normalize(tx[1],tx[1]),r[0]/=n[1],r[1]=G.vec3.dot(tx[0],tx[2]),tN(tx[2],tx[2],tx[0],1,-r[1]),r[2]=G.vec3.dot(tx[1],tx[2]),tN(tx[2],tx[2],tx[1],1,-r[2]),n[2]=G.vec3.length(tx[2]),G.vec3.normalize(tx[2],tx[2]),r[1]/=n[2],r[2]/=n[2],G.vec3.cross(tT,tx[1],tx[2]),0>G.vec3.dot(tx[0],tT))for(var f=0;f<3;f++)n[f]*=-1,tx[f][0]*=-1,tx[f][1]*=-1,tx[f][2]*=-1;a[0]=.5*Math.sqrt(Math.max(1+tx[0][0]-tx[1][1]-tx[2][2],0)),a[1]=.5*Math.sqrt(Math.max(1-tx[0][0]+tx[1][1]-tx[2][2],0)),a[2]=.5*Math.sqrt(Math.max(1-tx[0][0]-tx[1][1]+tx[2][2],0)),a[3]=.5*Math.sqrt(Math.max(1+tx[0][0]+tx[1][1]+tx[2][2],0)),tx[2][1]>tx[1][2]&&(a[0]=-a[0]),tx[0][2]>tx[2][0]&&(a[1]=-a[1]),tx[1][0]>tx[0][1]&&(a[2]=-a[2]);}}(0===t.length?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:t.map(nk).reduce(nE),e,n,r,i,a),[[e,n,r,a,i]];}var nT=function(){function t(t,e){for(var n=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],r=0;r<4;r++)for(var i=0;i<4;i++)for(var a=0;a<4;a++)n[r][i]+=e[r][a]*t[a][i];return n;}return function(e,n,r,i,a){for(var o,s=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],l=0;l<4;l++)s[l][3]=a[l];for(var u=0;u<3;u++)for(var c=0;c<3;c++)s[3][u]+=e[c]*s[c][u];var h=i[0],d=i[1],f=i[2],v=i[3],p=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];p[0][0]=1-2*(d*d+f*f),p[0][1]=2*(h*d-f*v),p[0][2]=2*(h*f+d*v),p[1][0]=2*(h*d+f*v),p[1][1]=1-2*(h*h+f*f),p[1][2]=2*(d*f-h*v),p[2][0]=2*(h*f-d*v),p[2][1]=2*(d*f+h*v),p[2][2]=1-2*(h*h+d*d),s=t(s,p);var g=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];r[2]&&(g[2][1]=r[2],s=t(s,g)),r[1]&&(g[2][1]=0,g[2][0]=r[0],s=t(s,g)),r[0]&&(g[2][0]=0,g[1][0]=r[0],s=t(s,g));for(var y=0;y<3;y++)for(var m=0;m<3;m++)s[y][m]*=n[y];return 0===(o=s)[0][2]&&0===o[0][3]&&0===o[1][2]&&0===o[1][3]&&0===o[2][0]&&0===o[2][1]&&1===o[2][2]&&0===o[2][3]&&0===o[3][2]&&1===o[3][3]?[s[0][0],s[0][1],s[1][0],s[1][1],s[3][0],s[3][1]]:s[0].concat(s[1],s[2],s[3]);};}();function nN(t){return t.toFixed(6).replace(".000000","");}function nb(t,e){var n,r;return(t.decompositionPair!==e&&(t.decompositionPair=e,n=nx(t)),e.decompositionPair!==t&&(e.decompositionPair=t,r=nx(e)),null===n[0]||null===r[0])?[[!1],[!0],function(n){return n?e[0].d:t[0].d;}]:(n[0].push(0),r[0].push(1),[n,r,function(t){var e=function(t,e,n){var r=function(t,e){for(var n=0,r=0;r<t.length;r++)n+=t[r]*e[r];return n;}(t,e);r=(0,F.clamp)(r,-1,1);var i=[];if(1===r)i=t;else for(var a=Math.acos(r),o=1*Math.sin(n*a)/Math.sqrt(1-r*r),s=0;s<4;s++)i.push(t[s]*(Math.cos(n*a)-r*o)+e[s]*o);return i;}(n[0][3],r[0][3],t[5]);return nT(t[0],t[1],t[2],e,t[4]).map(nN).join(",");}]);}function nS(t){return t.replace(/[XY]/,"");}function nw(t){return t.replace(/(X|Y|Z|3d)?$/,"3d");}function nP(t,e,n){var r=!1;if(!t.length||!e.length){t.length||(r=!0,t=e,e=[]);for(var i=0;i<t.length;i++)!function(){var n=t[i],r=n.t,a=n.d,o="scale"===r.substring(0,5)?1:0;e.push({t:r,d:a.map(function(t){return"number"==typeof t?eR(o):eR(o,t.unit);})});}();}var a=[],o=[],s=[];if(t.length!==e.length){var l=nb(t,e);a=[l[0]],o=[l[1]],s=[["matrix",[l[2]]]];}else for(var u=0;u<t.length;u++){var c=t[u].t,h=e[u].t,d=t[u].d,f=e[u].d,v=ng[c],p=ng[h],g=void 0;if("perspective"===c&&"perspective"===h||("matrix"===c||"matrix3d"===c)&&("matrix"===h||"matrix3d"===h)){var y=nb([t[u]],[e[u]]);a.push(y[0]),o.push(y[1]),s.push(["matrix",[y[2]]]);continue;}if(c===h)g=c;else if(v[2]&&p[2]&&nS(c)===nS(h))g=nS(c),d=v[2](d),f=p[2](f);else if(v[1]&&p[1]&&nw(c)===nw(h))g=nw(c),d=v[1](d),f=p[1](f);else{var m=nb(t,e);a=[m[0]],o=[m[1]],s=[["matrix",[m[2]]]];break;}for(var k=[],E=[],x=[],T=0;T<d.length;T++){var N=function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a="",o=t.value||0,s=e.value||0,l=ex(t.unit),u=t.convertTo(l),c=e.convertTo(l);return u&&c?(o=u.value,s=c.value,a=ev(t.unit)):(eT.isLength(t.unit)||eT.isLength(e.unit))&&(o=e0(t,i,n),s=e0(e,i,n),a="px"),[o,s,function(t){return r&&(t=Math.max(t,0)),t+a;}];}(d[T],f[T],n,!1,T);k[T]=N[0],E[T]=N[1],x.push(N[2]);}a.push(k),o.push(E),s.push([g,x]);}if(r){var b=a;a=o,o=b;}return[a,o,function(t){return t.map(function(t,e){var n=t.map(function(t,n){return s[e][1][n](t);}).join(",");return"matrix"===s[e][0]&&16===n.split(",").length&&(s[e][0]="matrix3d"),"matrix3d"===s[e][0]&&6===n.split(",").length&&(s[e][0]="matrix"),"".concat(s[e][0],"(").concat(n,")");}).join(" ");}];}var nM=ei(function(t){if((0,F.isString)(t)){if("text-anchor"===t)return[eR(0,"px"),eR(0,"px")];var e=t.split(" ");return(1===e.length&&("top"===e[0]||"bottom"===e[0]?(e[1]=e[0],e[0]="center"):e[1]="center"),2!==e.length)?null:[e$(nA(e[0])),e$(nA(e[1]))];}return[eR(t[0]||0,"px"),eR(t[1]||0,"px")];});function nA(t){return"center"===t?"50%":"left"===t||"top"===t?"0%":"right"===t||"bottom"===t?"100%":t;}var nC=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:t_.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:t_.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:t_.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:t_.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:t_.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:t_.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:t_.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:t_.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:t_.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:t_.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:t_.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:t_.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:t_.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:t_.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:t_.FILTER},{n:"clipPath",syntax:t_.DEFINED_PATH},{n:"textPath",syntax:t_.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:t_.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:t_.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:t_.COORDINATE},{n:"y1",int:!0,l:!0,syntax:t_.COORDINATE},{n:"z1",int:!0,l:!0,syntax:t_.COORDINATE},{n:"x2",int:!0,l:!0,syntax:t_.COORDINATE},{n:"y2",int:!0,l:!0,syntax:t_.COORDINATE},{n:"z2",int:!0,l:!0,syntax:t_.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:t_.PATH,p:50},{n:"points",int:!0,l:!0,syntax:t_.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:t_.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:t_.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:t_.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:t_.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:t_.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:t_.NUMBER,d:function(t){return t===j.PATH||t===j.POLYGON||t===j.POLYLINE?"4":"10";}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:t_.MARKER},{n:"markerEnd",syntax:t_.MARKER},{n:"markerMid",syntax:t_.MARKER},{n:"markerStartOffset",syntax:t_.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:t_.LENGTH,l:!0,int:!0,d:"0"}],nR=new Set(nC.filter(function(t){return!!t.l;}).map(function(t){return t.n;})),nO={},nL=(0,R.default)(function t(e){var n=this;(0,C.default)(this,t),this.runtime=e,nC.forEach(function(t){n.registerMetadata(t);});},[{key:"registerMetadata",value:function(t){[t.n].concat((0,O.default)(t.a||[])).forEach(function(e){nO[e]=t;});}},{key:"getPropertySyntax",value:function(t){return this.runtime.CSSPropertySyntaxFactory[t];}},{key:"processProperties",value:function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[],memoize:!0};Object.assign(t.attributes,e);var i=t.parsedStyle.clipPath,a=t.parsedStyle.offsetPath;!function(t,e){var n=nI(t);for(var r in e)n.has(r)&&(t.parsedStyle[r]=e[r]);}(t,e);var o=!!r.forceUpdateGeometry;if(!o){for(var s in e)if(nR.has(s)){o=!0;break;}}var l=nI(t);l.has("fill")&&e.fill&&(t.parsedStyle.fill=eH(e.fill)),l.has("stroke")&&e.stroke&&(t.parsedStyle.stroke=eH(e.stroke)),l.has("shadowColor")&&e.shadowColor&&(t.parsedStyle.shadowColor=eH(e.shadowColor)),l.has("filter")&&e.filter&&(t.parsedStyle.filter=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if("none"===(e=e.toLowerCase().trim()))return[];for(var n=/\s*([\w-]+)\(([^)]*)\)/g,r=[],i=0;(t=n.exec(e))&&t.index===i;)if(i=t.index+t[0].length,e1.indexOf(t[1])>-1&&r.push({name:t[1],params:t[2].split(" ").map(function(t){return eW(/deg|rad|grad|turn|px|%/g,t)||eH(t);})}),n.lastIndex===e.length)return r;return[];}(e.filter)),l.has("radius")&&!(0,F.isNil)(e.radius)&&(t.parsedStyle.radius=eJ(e.radius,4)),l.has("lineDash")&&!(0,F.isNil)(e.lineDash)&&(t.parsedStyle.lineDash=eJ(e.lineDash,"even")),l.has("points")&&e.points&&(t.parsedStyle.points=(n=e.points,{points:(0,F.isString)(n)?n.split(" ").map(function(t){var e=t.split(","),n=(0,D.default)(e,2),r=n[0],i=n[1];return[Number(r),Number(i)];}):n,totalLength:0,segments:[]})),l.has("d")&&""===e.d&&(t.parsedStyle.d=(0,A.default)({},tD)),l.has("d")&&e.d&&(t.parsedStyle.d=nc(e.d)),l.has("textTransform")&&e.textTransform&&this.runtime.CSSPropertySyntaxFactory[t_.TEXT_TRANSFORM].calculator(null,null,{value:e.textTransform},t,null),l.has("clipPath")&&!(0,F.isUndefined)(e.clipPath)&&this.runtime.CSSPropertySyntaxFactory[t_.DEFINED_PATH].calculator("clipPath",i,e.clipPath,t,this.runtime),l.has("offsetPath")&&e.offsetPath&&this.runtime.CSSPropertySyntaxFactory[t_.DEFINED_PATH].calculator("offsetPath",a,e.offsetPath,t,this.runtime),l.has("transform")&&e.transform&&(t.parsedStyle.transform=function(t){if(Array.isArray(t))return ny(t);if("none"===(t=(t||"none").trim()))return[];var e,n=[],r=0;for(nf.lastIndex=0;(e=nf.exec(t))&&e.index===r;){r=e.index+e[0].length;var i=e[1],a=ng[i];if(!a)break;var o=e[2].split(","),s=a[0];if(s.length<o.length)break;for(var l=[],u=0;u<s.length;u++){var c=o[u],h=s[u],d=void 0;if(void 0===(d=c?({A:function(t){return"0"===t.trim()?eb:eZ(t);},N:e4,T:e$,L:eX})[h.toUpperCase()](c):({a:eb,n:l[0],t:eN})[h]))return[];l.push(d);}if(n.push({t:i,d:l}),nf.lastIndex===t.length)return n;}return[];}(e.transform)),l.has("transformOrigin")&&e.transformOrigin&&(t.parsedStyle.transformOrigin=nM(e.transformOrigin)),l.has("markerStart")&&e.markerStart&&(t.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory[t_.MARKER].calculator(null,e.markerStart,e.markerStart,null,null)),l.has("markerEnd")&&e.markerEnd&&(t.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory[t_.MARKER].calculator(null,e.markerEnd,e.markerEnd,null,null)),l.has("markerMid")&&e.markerMid&&(t.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory[t_.MARKER].calculator("",e.markerMid,e.markerMid,null,null)),l.has("zIndex")&&!(0,F.isNil)(e.zIndex)&&this.runtime.CSSPropertySyntaxFactory[t_.Z_INDEX].postProcessor(t),l.has("offsetDistance")&&!(0,F.isNil)(e.offsetDistance)&&this.runtime.CSSPropertySyntaxFactory[t_.OFFSET_DISTANCE].postProcessor(t),l.has("transform")&&e.transform&&this.runtime.CSSPropertySyntaxFactory[t_.TRANSFORM].postProcessor(t),l.has("transformOrigin")&&e.transformOrigin&&this.runtime.CSSPropertySyntaxFactory[t_.TRANSFORM_ORIGIN].postProcessor(t),o&&(t.dirty(!0,!0),r.forceUpdateGeometry||this.runtime.sceneGraphService.dirtyToRoot(t));}},{key:"updateGeometry",value:function(t){var e=t.nodeName,n=this.runtime.geometryUpdaterFactory[e];if(n){var r=t.geometry;r.contentBounds||(r.contentBounds=new tr),r.renderBounds||(r.renderBounds=new tr);var i=t.parsedStyle,a=n.update(i,t),o=a.cx,s=a.cy,l=a.cz,u=a.hwidth,c=void 0===u?0:u,h=a.hheight,d=void 0===h?0:h,f=a.hdepth,v=[Math.abs(c),Math.abs(d),void 0===f?0:f],p=i.stroke,g=i.lineWidth,y=i.increasedLineWidthForHitTesting,m=i.shadowType,k=void 0===m?"outer":m,E=i.shadowColor,x=i.filter,T=i.transformOrigin,N=[void 0===o?0:o,void 0===s?0:s,void 0===l?0:l];r.contentBounds.update(N,v);var b=e===j.POLYLINE||e===j.POLYGON||e===j.PATH?Math.SQRT2:.5;if(p&&!p.isNone){var S=(((void 0===g?1:g)||0)+((void 0===y?0:y)||0))*b;v[0]+=S,v[1]+=S;}if(r.renderBounds.update(N,v),E&&k&&"inner"!==k){var w=r.renderBounds,P=w.min,M=w.max,A=i.shadowBlur,C=i.shadowOffsetX,R=i.shadowOffsetY,O=A||0,L=C||0,I=R||0,D=P[0]-O+L,_=M[0]+O+L,F=P[1]-O+I,B=M[1]+O+I;P[0]=Math.min(P[0],D),M[0]=Math.max(M[0],_),P[1]=Math.min(P[1],F),M[1]=Math.max(M[1],B),r.renderBounds.setMinMax(P,M);}(void 0===x?[]:x).forEach(function(t){var e=t.name,n=t.params;if("blur"===e){var i=n[0].value;r.renderBounds.update(r.renderBounds.center,G.vec3.add(r.renderBounds.halfExtents,r.renderBounds.halfExtents,[i,i,0]));}else if("drop-shadow"===e){var a=n[0].value,o=n[1].value,s=n[2].value,l=r.renderBounds,u=l.min,c=l.max,h=u[0]-s+a,d=c[0]+s+a,f=u[1]-s+o,v=c[1]+s+o;u[0]=Math.min(u[0],h),c[0]=Math.max(c[0],d),u[1]=Math.min(u[1],f),c[1]=Math.max(c[1],v),r.renderBounds.setMinMax(u,c);}}),t.geometry.dirty=!1;var U=d<0,V=(c<0?-1:1)*(T?e0(T[0],0,t,!0):0),z=(U?-1:1)*(T?e0(T[1],1,t,!0):0);(V||z)&&t.setOrigin(V,z);}}},{key:"updateSizeAttenuation",value:function(t,e){t.style.isSizeAttenuation?(t.style.rawLineWidth||(t.style.rawLineWidth=t.style.lineWidth),t.style.lineWidth=(t.style.rawLineWidth||1)/e,t.nodeName===j.CIRCLE&&(t.style.rawR||(t.style.rawR=t.style.r),t.style.r=(t.style.rawR||1)/e)):(t.style.rawLineWidth&&(t.style.lineWidth=t.style.rawLineWidth,delete t.style.rawLineWidth),t.nodeName===j.CIRCLE&&t.style.rawR&&(t.style.r=t.style.rawR,delete t.style.rawR));}}]);function nI(t){return t.constructor.PARSED_STYLE_LIST;}var nD=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e5;},[{key:"calculator",value:function(t,e,n,r){return eQ(n);}}]),n_=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r,i){return n instanceof ek&&(n=null),i.sceneGraphService.updateDisplayObjectDependency(t,e,n,r),"clipPath"===t&&r.forEach(function(t){0===t.childNodes.length&&i.sceneGraphService.dirtyToRoot(t);}),n;}}]),nG=(0,R.default)(function t(){(0,C.default)(this,t),this.parser=eH,this.mixer=eY;},[{key:"calculator",value:function(t,e,n,r){return n instanceof ek?"none"===n.value?eM:eA:n;}}]),nF=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n){return n instanceof ek?[]:n;}}]);function nB(t){var e=t.parsedStyle.fontSize;return(0,F.isNil)(e)?null:e;}var nU=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e5;},[{key:"calculator",value:function(t,e,n,r,i){if((0,F.isNumber)(n))return n;if(!eT.isRelativeUnit(n.unit))return n.value;if(n.unit===ea.kPercentage)return 0;if(n.unit===ea.kEms){if(r.parentNode){var a,o=nB(r.parentNode);if(o)return o*n.value;}return 0;}if(n.unit===ea.kRems){if(null!=r&&null!==(a=r.ownerDocument)&&void 0!==a&&a.documentElement){var s=nB(r.ownerDocument.documentElement);if(s)return s*n.value;}return 0;}}}]),nV=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e7;},[{key:"calculator",value:function(t,e,n){return n.map(function(t){return t.value;});}}]),nz=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e7;},[{key:"calculator",value:function(t,e,n){return n.map(function(t){return t.value;});}}]),nH=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){n instanceof ek&&(n=null);var i,a=null===(i=n)||void 0===i?void 0:i.cloneNode(!0);return a&&(a.style.isMarker=!0),a;}}]),nY=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e5;},[{key:"calculator",value:function(t,e,n){return n.value;}}]),nW=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e6(0,1);},[{key:"calculator",value:function(t,e,n){return n.value;}},{key:"postProcessor",value:function(t){var e=t.parsedStyle,n=e.offsetPath,r=e.offsetDistance;if(n){var i=n.nodeName;if(i===j.LINE||i===j.PATH||i===j.POLYLINE){var a=n.getPoint(r);a&&t.setLocalPosition(a.x,a.y);}}}}]),nq=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e6(0,1);},[{key:"calculator",value:function(t,e,n){return n.value;}}]),nX=(0,R.default)(function t(){(0,C.default)(this,t),this.parser=nc,this.mixer=nh;},[{key:"calculator",value:function(t,e,n){return n instanceof ek&&"unset"===n.value?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new tl(0,0,0,0)}:n;}}]),nj=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=nd;}),n$=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).mixer=e6(0,1/0),t;}return(0,I.default)(e,t),(0,R.default)(e);}(nU),nK=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){return n instanceof ek?"unset"===n.value?"":n.value:"".concat(n);}},{key:"postProcessor",value:function(t){t.nodeValue="".concat(t.parsedStyle.text)||"";}}]),nZ=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){var i=r.getAttribute("text");if(i){var a=i;"capitalize"===n.value?a=i.charAt(0).toUpperCase()+i.slice(1):"lowercase"===n.value?a=i.toLowerCase():"uppercase"===n.value&&(a=i.toUpperCase()),r.parsedStyle.text=a;}return n.value;}}]);function nQ(t,e){var n=Number(t.parsedStyle.zIndex||0),r=Number(e.parsedStyle.zIndex||0);if(n===r){var i=t.parentNode;if(i){var a=i.childNodes||[];return a.indexOf(t)-a.indexOf(e);}}return n-r;}new WeakMap,"undefined"!=typeof window&&window.document;var nJ={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},n0="object"==typeof performance&&performance.now?performance:Date;function n1(t){return t.nodeName===j.FRAGMENT||t.getRootNode().nodeName===j.FRAGMENT;}var n2=1,n3="object"==typeof self&&self.self===self?self:"object"==typeof X&&X.global===X?X:{},n4=Date.now(),n5={},n6=Date.now(),n7=function(t){if("function"!=typeof t)throw TypeError("".concat(t," is not a function"));var e=Date.now(),n=e-n6,r=n2++;return n5[r]=t,Object.keys(n5).length>1||setTimeout(function(){n6=e;var t=n5;n5={},Object.keys(t).forEach(function(e){return t[e](n3.performance&&"function"==typeof n3.performance.now?n3.performance.now():Date.now()-n4);});},n>16?0:16-n),r;},n9=function(t){return"string"!=typeof t?n7:""===t?n3.requestAnimationFrame:n3["".concat(t,"RequestAnimationFrame")];},n8=function(t,e){for(var n=0;void 0!==t[n];){if(e(t[n]))return t[n];n+=1;}}(["","webkit","moz","ms","o"],function(t){return!!n9(t);}),rt=n9(n8),re="string"!=typeof n8?function(t){delete n5[t];}:""===n8?n3.cancelAnimationFrame:n3["".concat(n8,"CancelAnimationFrame")]||n3["".concat(n8,"CancelRequestAnimationFrame")];n3.requestAnimationFrame=rt,n3.cancelAnimationFrame=re;var rn=(0,R.default)(function t(){(0,C.default)(this,t),this.callbacks=[];},[{key:"getCallbacksNum",value:function(){return this.callbacks.length;}},{key:"tapPromise",value:function(t,e){this.callbacks.push(e);}},{key:"promise",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return Promise.all(this.callbacks.map(function(t){return t.apply(void 0,e);}));}}]),rr=(0,R.default)(function t(){(0,C.default)(this,t),this.callbacks=[];},[{key:"tapPromise",value:function(t,e){this.callbacks.push(e);}},{key:"promise",value:(m=(0,Y.default)((0,H.default)().mark(function t(){var e,n,r,i,a=arguments;return(0,H.default)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.callbacks.length){t.next=6;break;}return t.next=1,(e=this.callbacks)[0].apply(e,a);case 1:n=t.sent,r=1;case 2:if(!(r<this.callbacks.length)){t.next=5;break;}return i=this.callbacks[r],t.next=3,i(n);case 3:n=t.sent;case 4:r++,t.next=2;break;case 5:return t.abrupt("return",n);case 6:return t.abrupt("return",null);case 7:case"end":return t.stop();}},t,this);})),function(){return m.apply(this,arguments);})}]),ri=(0,R.default)(function t(){(0,C.default)(this,t),this.callbacks=[];},[{key:"tap",value:function(t,e){this.callbacks.push(e);}},{key:"call",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=arguments;this.callbacks.forEach(function(t){t.apply(void 0,r);});}}]),ra=(0,R.default)(function t(){(0,C.default)(this,t),this.callbacks=[];},[{key:"tap",value:function(t,e){this.callbacks.push(e);}},{key:"call",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];if(this.callbacks.length){for(var r=arguments,i=this.callbacks[0].apply(void 0,r),a=1;a<this.callbacks.length;a++)i=(0,this.callbacks[a])(i);return i;}return null;}}]),ro=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],rs=/([\"\'])[^\'\"]+\1/;function rl(t){var e=t.fontSize,n=t.fontFamily,r=t.fontStyle,i=t.fontVariant,a=t.fontWeight;return{fontSize:void 0===e?16:e,fontFamily:void 0===n?"sans-serif":n,fontStyle:void 0===r?"normal":r,fontVariant:void 0===i?"normal":i,fontWeight:void 0===a?"normal":a};}var ru=ei(function(t){for(var e=rl(t),n=e.fontSize,r=e.fontFamily,i=e.fontStyle,a=e.fontVariant,o=e.fontWeight,s=(0,F.isNumber)(n)&&"".concat(n,"px")||"16px",l=r.split(","),u=l.length-1;u>=0;u--){var c=l[u].trim();!rs.test(c)&&0>ro.indexOf(c)&&(c='"'.concat(c,'"')),l[u]=c;}return"".concat(i," ").concat(a," ").concat(o," ").concat(s," ").concat(l.join(","));},function(t){var e=rl(t),n=e.fontSize,r=e.fontFamily,i=e.fontStyle,a=e.fontVariant,o=e.fontWeight;return"".concat(i,"_").concat(a,"_").concat(o,"_").concat(n,"_").concat(r);}),rc=function(t){return Math.max(t,1e-6);};function rh(t,e,n){return G.mat4.identity(t),t[4]=Math.tan(e),t[1]=Math.tan(n),t;}var rd=G.mat4.create(),rf=G.mat4.create(),rv={scale:function(t){G.mat4.fromScaling(rd,[t[0].value,t[1].value,1].map(function(t){return rc(t);}));},scaleX:function(t){G.mat4.fromScaling(rd,[t[0].value,1,1].map(function(t){return rc(t);}));},scaleY:function(t){G.mat4.fromScaling(rd,[1,t[0].value,1].map(function(t){return rc(t);}));},scaleZ:function(t){G.mat4.fromScaling(rd,[1,1,t[0].value].map(function(t){return rc(t);}));},scale3d:function(t){G.mat4.fromScaling(rd,[t[0].value,t[1].value,t[2].value].map(function(t){return rc(t);}));},translate:function(t){G.mat4.fromTranslation(rd,[t[0].value,t[1].value,0]);},translateX:function(t){G.mat4.fromTranslation(rd,[t[0].value,0,0]);},translateY:function(t){G.mat4.fromTranslation(rd,[0,t[0].value,0]);},translateZ:function(t){G.mat4.fromTranslation(rd,[0,0,t[0].value]);},translate3d:function(t){G.mat4.fromTranslation(rd,[t[0].value,t[1].value,t[2].value]);},rotate:function(t){G.mat4.fromZRotation(rd,eQ(t[0])*tf);},rotateX:function(t){G.mat4.fromXRotation(rd,eQ(t[0])*tf);},rotateY:function(t){G.mat4.fromYRotation(rd,eQ(t[0])*tf);},rotateZ:function(t){G.mat4.fromZRotation(rd,eQ(t[0])*tf);},rotate3d:function(t){G.mat4.fromRotation(rd,eQ(t[3])*tf,[t[0].value,t[1].value,t[2].value]);},skew:function(t){rh(rd,t[0].value*tf,t[1].value*tf);},skewX:function(t){rh(rd,t[0].value*tf,0);},skewY:function(t){rh(rd,0,t[0].value*tf);},matrix:function(t){G.mat4.set(rd,t[0].value,t[1].value,0,0,t[2].value,t[3].value,0,0,0,0,1,0,t[4].value,t[5].value,0,1);},matrix3d:function(t){G.mat4.set.apply(G.mat4,[rd].concat((0,O.default)(t.map(function(t){return t.value;}))));}},rp=G.vec3.fromValues(1,1,1),rg=G.vec3.create(),ry={translate:function(t,e){ii.sceneGraphService.setLocalScale(t,rp,!1),ii.sceneGraphService.setLocalEulerAngles(t,rg,void 0,void 0,!1),ii.sceneGraphService.setLocalPosition(t,[e[0].value,e[1].value,0],!1),ii.sceneGraphService.dirtyLocalTransform(t,t.transformable);}},rm=(0,R.default)(function t(){(0,C.default)(this,t),this.parser=nm,this.mixer=nP;},[{key:"calculator",value:function(t,e,n,r){return n instanceof ek?[]:n;}},{key:"postProcessor",value:function(t){!function(t,e){if(t.length){if(1===t.length&&ry[t[0].t]){ry[t[0].t](e,t[0].d);return;}for(var n=G.mat4.identity(rf),r=0;r<t.length;r++){var i=t[r],a=i.t,o=i.d,s=rv[a];s&&(s(o),G.mat4.mul(n,n,rd));}e.setLocalTransform(n);}else e.resetLocalTransform();e.getLocalTransform();}(t.parsedStyle.transform,t);}}]),rk=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"postProcessor",value:function(t){var e=t.parsedStyle.transformOrigin;e[0].unit===ea.kPixels&&e[1].unit===ea.kPixels?t.setOrigin(e[0].value,e[1].value):t.getGeometryBounds();}}]),rE=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){return n.value;}},{key:"postProcessor",value:function(t){if(t.parentNode){var e=t.parentNode,n=e.renderable,r=e.sortable;n&&e.dirty(),r&&(r.dirty=!0,r.dirtyReason=tC.Z_INDEX_CHANGED);}}}]),rx=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){var n=t.cx,r=t.cy,i=t.r,a=void 0===i?0:i;return{cx:void 0===n?0:n,cy:void 0===r?0:r,hwidth:a,hheight:a};}}]),rT=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){var n=t.cx,r=t.cy,i=t.rx,a=t.ry;return{cx:void 0===n?0:n,cy:void 0===r?0:r,hwidth:void 0===i?0:i,hheight:void 0===a?0:a};}}]),rN=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t){var e=t.x1,n=t.y1,r=t.x2,i=t.y2,a=Math.min(e,r),o=Math.min(n,i),s=(Math.max(e,r)-a)/2,l=(Math.max(n,i)-o)/2;return{cx:a+s,cy:o+l,hwidth:s,hheight:l};}}]),rb=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t){var e=t.d.rect,n=e.x,r=e.y,i=e.width,a=e.height,o=i/2,s=a/2;return{cx:n+o,cy:r+s,hwidth:o,hheight:s};}}]),rS=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t){if(t.points&&(0,F.isArray)(t.points.points)){var e=t.points.points,n=Math.min.apply(Math,(0,O.default)(e.map(function(t){return t[0];}))),r=Math.max.apply(Math,(0,O.default)(e.map(function(t){return t[0];}))),i=Math.min.apply(Math,(0,O.default)(e.map(function(t){return t[1];}))),a=Math.max.apply(Math,(0,O.default)(e.map(function(t){return t[1];}))),o=(r-n)/2,s=(a-i)/2;return{cx:n+o,cy:i+s,hwidth:o,hheight:s};}return{cx:0,cy:0,hwidth:0,hheight:0};}}]),rw=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){var n=t.x,r=t.y,i=t.src,a=t.width,o=t.height,s=void 0===a?0:a,l=void 0===o?0:o;return!i||(0,F.isString)(i)||(s||(s=i.width,t.width=s),l||(l=i.height,t.height=l)),{cx:(void 0===n?0:n)+s/2,cy:(void 0===r?0:r)+l/2,hwidth:s/2,hheight:l/2};}}]),rP=(0,R.default)(function t(e){(0,C.default)(this,t),this.globalRuntime=e;},[{key:"isReadyToMeasure",value:function(t,e){return t.text;}},{key:"update",value:function(t,e){var n,r=t.text,i=t.textAlign,a=void 0===i?"start":i,o=t.lineWidth,s=void 0===o?1:o,l=t.textBaseline,u=void 0===l?"alphabetic":l,c=t.dx,h=void 0===c?0:c,d=t.dy,f=void 0===d?0:d,v=t.x,p=t.y;if(!this.isReadyToMeasure(t,e))return t.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var g=((null==e||null===(n=e.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n?void 0:n.getConfig())||{}).offscreenCanvas,y=this.globalRuntime.textService.measureText(r,t,g);t.metrics=y;var m=y.width,k=y.height,E=m/2,x=k/2,T=(void 0===v?0:v)+E;"center"===a||"middle"===a?T+=s/2-E:("right"===a||"end"===a)&&(T+=s-2*E);var N=(void 0===p?0:p)-x;return"middle"===u?N+=x:"top"===u||"hanging"===u?N+=2*x:"alphabetic"===u||("bottom"===u||"ideographic"===u)&&(N+=0),h&&(T+=h),f&&(N+=f),{cx:T,cy:N,hwidth:E,hheight:x};}}]),rM=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){return{cx:0,cy:0,hwidth:0,hheight:0};}}]),rA=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){var n=t.x,r=t.y,i=t.width,a=void 0===i?0:i,o=t.height,s=void 0===o?0:o;return{cx:(void 0===n?0:n)+a/2,cy:(void 0===r?0:r)+s/2,hwidth:a/2,hheight:s/2};}}]),rC=(0,R.default)(function t(e){(0,C.default)(this,t),this.eventPhase=t.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new ts,this.page=new ts,this.canvas=new ts,this.viewport=new ts,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e;},[{key:"name",get:function(){return this.type;}},{key:"layerX",get:function(){return this.layer.x;}},{key:"layerY",get:function(){return this.layer.y;}},{key:"pageX",get:function(){return this.page.x;}},{key:"pageY",get:function(){return this.page.y;}},{key:"x",get:function(){return this.canvas.x;}},{key:"y",get:function(){return this.canvas.y;}},{key:"canvasX",get:function(){return this.canvas.x;}},{key:"canvasY",get:function(){return this.canvas.y;}},{key:"viewportX",get:function(){return this.viewport.x;}},{key:"viewportY",get:function(){return this.viewport.y;}},{key:"composedPath",value:function(){return this.manager&&(!this.path||this.path[0]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path;}},{key:"propagationPath",get:function(){return this.composedPath();}},{key:"preventDefault",value:function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0;}},{key:"stopImmediatePropagation",value:function(){this.propagationImmediatelyStopped=!0;}},{key:"stopPropagation",value:function(){this.propagationStopped=!0;}},{key:"initEvent",value:function(){}},{key:"initUIEvent",value:function(){}},{key:"clone",value:function(){throw Error(tu);}}]),rR=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).client=new ts,t.movement=new ts,t.offset=new ts,t.global=new ts,t.screen=new ts,t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clientX",get:function(){return this.client.x;}},{key:"clientY",get:function(){return this.client.y;}},{key:"movementX",get:function(){return this.movement.x;}},{key:"movementY",get:function(){return this.movement.y;}},{key:"offsetX",get:function(){return this.offset.x;}},{key:"offsetY",get:function(){return this.offset.y;}},{key:"globalX",get:function(){return this.global.x;}},{key:"globalY",get:function(){return this.global.y;}},{key:"screenX",get:function(){return this.screen.x;}},{key:"screenY",get:function(){return this.screen.y;}},{key:"getModifierState",value:function(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t);}},{key:"initMouseEvent",value:function(){throw Error(tu);}}]);}(rC),rO=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).width=0,t.height=0,t.isPrimary=!1,t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getCoalescedEvents",value:function(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[];}},{key:"getPredictedEvents",value:function(){throw Error("getPredictedEvents is not supported!");}},{key:"clone",value:function(){return this.manager.clonePointerEvent(this);}}]);}(rR),rL=function(t){function e(){return(0,C.default)(this,e),(0,L.default)(this,e,arguments);}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return this.manager.cloneWheelEvent(this);}}]);}(rR),rI=function(t){function e(t,n){var r;return(0,C.default)(this,e),(r=(0,L.default)(this,e,[null])).type=t,r.detail=null==n?void 0:n.detail,!n||"detail"in n||(r.detail=n),Object.assign(r,n),r;}return(0,I.default)(e,t),(0,R.default)(e);}(rC),rD=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).shadow=!1,t.ownerDocument=null,t.isConnected=!1,t.baseURI="",t.childNodes=[],t.nodeType=0,t.nodeName="",t.nodeValue=null,t.mutations=void 0,t.parentNode=null,t.destroyed=!1,t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"textContent",get:function(){var t="";this.nodeName===j.TEXT&&(t+=this.style.text);var e,n=(0,W.default)(this.childNodes);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.nodeName===j.TEXT?t+=r.nodeValue:t+=r.textContent;}}catch(t){n.e(t);}finally{n.f();}return t;},set:function(t){var e=this;this.childNodes.slice().forEach(function(t){e.removeChild(t);}),this.nodeName===j.TEXT&&(this.style.text="".concat(t));}},{key:"getRootNode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.parentNode?this.parentNode.getRootNode(t):t.composed&&this.host?this.host.getRootNode(t):this;}},{key:"hasChildNodes",value:function(){return this.childNodes.length>0;}},{key:"isDefaultNamespace",value:function(t){throw Error(tu);}},{key:"lookupNamespaceURI",value:function(t){throw Error(tu);}},{key:"lookupPrefix",value:function(t){throw Error(tu);}},{key:"normalize",value:function(){throw Error(tu);}},{key:"isEqualNode",value:function(t){return this===t;}},{key:"isSameNode",value:function(t){return this.isEqualNode(t);}},{key:"parent",get:function(){return this.parentNode;}},{key:"parentElement",get:function(){return null;}},{key:"nextSibling",get:function(){return null;}},{key:"previousSibling",get:function(){return null;}},{key:"firstChild",get:function(){return this.childNodes.length>0?this.childNodes[0]:null;}},{key:"lastChild",get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null;}},{key:"compareDocumentPosition",value:function(t){if(t===this)return 0;for(var n,r=t,i=this,a=[r],o=[i];null!==(n=r.parentNode)&&void 0!==n?n:i.parentNode;)r=r.parentNode?(a.push(r.parentNode),r.parentNode):r,i=i.parentNode?(o.push(i.parentNode),i.parentNode):i;if(r!==i)return e.DOCUMENT_POSITION_DISCONNECTED|e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|e.DOCUMENT_POSITION_PRECEDING;var s=a.length>o.length?a:o,l=s===a?o:a;if(s[s.length-l.length]===l[0])return s===a?e.DOCUMENT_POSITION_CONTAINED_BY|e.DOCUMENT_POSITION_FOLLOWING:e.DOCUMENT_POSITION_CONTAINS|e.DOCUMENT_POSITION_PRECEDING;for(var u=s.length-l.length,c=l.length-1;c>=0;c--){var h=l[c],d=s[u+c];if(d!==h){var f=h.parentNode.childNodes;if(f.indexOf(h)<f.indexOf(d)){if(l===a)return e.DOCUMENT_POSITION_PRECEDING;return e.DOCUMENT_POSITION_FOLLOWING;}if(s===a)return e.DOCUMENT_POSITION_PRECEDING;break;}}return e.DOCUMENT_POSITION_FOLLOWING;}},{key:"contain",value:function(t){return this.contains(t);}},{key:"contains",value:function(t){for(var e=t;e&&this!==e;)e=e.parentNode;return!!e;}},{key:"getAncestor",value:function(t){for(var e=this;t>0&&e;)e=e.parentNode,t--;return e;}},{key:"forEach",value:function(t){for(var e=[this];e.length>0;){var n=e.pop();if(!1===t(n))break;for(var r=n.childNodes.length-1;r>=0;r--)e.push(n.childNodes[r]);}}}],[{key:"isNode",value:function(t){return!!t.childNodes;}}]);}((0,R.default)(function t(){(0,C.default)(this,t),this.emitter=new _.default;},[{key:"on",value:function(t,e,n){return this.addEventListener(t,e,n),this;}},{key:"addEventListener",value:function(t,e,n){var r=!1,i=!1;if((0,F.isBoolean)(n))r=n;else if(n){var a=n.capture;r=void 0!==a&&a;var o=n.once;i=void 0!==o&&o;}r&&(t+="capture"),e=(0,F.isFunction)(e)?e:e.handleEvent;var s=(0,F.isFunction)(e)?void 0:e;return i?this.emitter.once(t,e,s):this.emitter.on(t,e,s),this;}},{key:"off",value:function(t,e,n){return t?this.removeEventListener(t,e,n):this.removeAllEventListeners(),this;}},{key:"removeAllEventListeners",value:function(){var t;null===(t=this.emitter)||void 0===t||t.removeAllListeners();}},{key:"removeEventListener",value:function(t,e,n){if(!this.emitter)return this;((0,F.isBoolean)(n)?n:null==n?void 0:n.capture)&&(t+="capture"),e=(0,F.isFunction)(e)?e:null===(r=e)||void 0===r?void 0:r.handleEvent;var r,i=(0,F.isFunction)(e)?void 0:e;return this.emitter.off(t,e,i),this;}},{key:"emit",value:function(t,e){this.dispatchEvent(new rI(t,e));}},{key:"dispatchEventToSelf",value:function(t){t.target||(t.target=this),t.currentTarget=this,this.emitter.emit(t.type,t);}},{key:"dispatchEvent",value:function(t){var e,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0;if(i)return this.dispatchEventToSelf(t),!0;if(e=this.document?this:this.defaultView?this.defaultView:null===(n=this.ownerDocument)||void 0===n?void 0:n.defaultView){if(t.manager=e.getEventService(),!t.manager)return!1;t.defaultPrevented=!1,t.path?t.path.length=0:t.page=[],r||(t.target=this),t.manager.dispatchEvent(t,t.type,r);}else this.dispatchEventToSelf(t);return!t.defaultPrevented;}}]));rD.DOCUMENT_POSITION_DISCONNECTED=1,rD.DOCUMENT_POSITION_PRECEDING=2,rD.DOCUMENT_POSITION_FOLLOWING=4,rD.DOCUMENT_POSITION_CONTAINS=8,rD.DOCUMENT_POSITION_CONTAINED_BY=16,rD.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32,(0,R.default)(function t(e,n){var r=this;(0,C.default)(this,t),this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=G.mat4.create(),this.tmpVec3=G.vec3.create(),this.onPointerDown=function(t){var e=r.createPointerEvent(t);if(r.dispatchEvent(e,"pointerdown"),"touch"===e.pointerType)r.dispatchEvent(e,"touchstart");else if("mouse"===e.pointerType||"pen"===e.pointerType){var n=2===e.button;r.dispatchEvent(e,n?"rightdown":"mousedown");}r.trackingData(t.pointerId).pressTargetsByButton[t.button]=e.composedPath(),r.freeEvent(e);},this.onPointerUp=function(t){var e=n0.now(),n=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);if(r.dispatchEvent(n,"pointerup"),"touch"===n.pointerType)r.dispatchEvent(n,"touchend");else if("mouse"===n.pointerType||"pen"===n.pointerType){var i=2===n.button;r.dispatchEvent(n,i?"rightup":"mouseup");}var a=r.trackingData(t.pointerId),o=r.findMountedTarget(a.pressTargetsByButton[t.button]),s=o;if(o&&!n.composedPath().includes(o)){for(var l=o;l&&!n.composedPath().includes(l);){if(n.currentTarget=l,r.notifyTarget(n,"pointerupoutside"),"touch"===n.pointerType)r.notifyTarget(n,"touchendoutside");else if("mouse"===n.pointerType||"pen"===n.pointerType){var u=2===n.button;r.notifyTarget(n,u?"rightupoutside":"mouseupoutside");}rD.isNode(l)&&(l=l.parentNode);}delete a.pressTargetsByButton[t.button],s=l;}if(s){var c,h=r.clonePointerEvent(n,"click");h.target=s,h.path=[],a.clicksByButton[t.button]||(a.clicksByButton[t.button]={clickCount:0,target:h.target,timeStamp:e});var d=r.context.renderingContext.root.ownerDocument.defaultView,f=a.clicksByButton[t.button];f.target===h.target&&e-f.timeStamp<d.getConfig().dblClickSpeed?++f.clickCount:f.clickCount=1,f.target=h.target,f.timeStamp=e,h.detail=f.clickCount,null!==(c=n.detail)&&void 0!==c&&c.preventClick||(r.context.config.useNativeClickEvent||"mouse"!==h.pointerType&&"touch"!==h.pointerType||r.dispatchEvent(h,"click"),r.dispatchEvent(h,"pointertap")),r.freeEvent(h);}r.freeEvent(n);},this.onPointerMove=function(t){var e=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0),n="mouse"===e.pointerType||"pen"===e.pointerType,i=r.trackingData(t.pointerId),a=r.findMountedTarget(i.overTargets);if(i.overTargets&&a!==e.target){var o="mousemove"===t.type?"mouseout":"pointerout",s=r.createPointerEvent(t,o,a||void 0);if(r.dispatchEvent(s,"pointerout"),n&&r.dispatchEvent(s,"mouseout"),!e.composedPath().includes(a)){var l=r.createPointerEvent(t,"pointerleave",a||void 0);for(l.eventPhase=l.AT_TARGET;l.target&&!e.composedPath().includes(l.target);)l.currentTarget=l.target,r.notifyTarget(l),n&&r.notifyTarget(l,"mouseleave"),rD.isNode(l.target)&&(l.target=l.target.parentNode);r.freeEvent(l);}r.freeEvent(s);}if(a!==e.target){var u="mousemove"===t.type?"mouseover":"pointerover",c=r.clonePointerEvent(e,u);r.dispatchEvent(c,"pointerover"),n&&r.dispatchEvent(c,"mouseover");for(var h=a&&rD.isNode(a)&&a.parentNode;h&&h!==(rD.isNode(r.rootTarget)&&r.rootTarget.parentNode)&&h!==e.target;)h=h.parentNode;if(!h||h===(rD.isNode(r.rootTarget)&&r.rootTarget.parentNode)){var d=r.clonePointerEvent(e,"pointerenter");for(d.eventPhase=d.AT_TARGET;d.target&&d.target!==a&&d.target!==(rD.isNode(r.rootTarget)&&r.rootTarget.parentNode);)d.currentTarget=d.target,r.notifyTarget(d),n&&r.notifyTarget(d,"mouseenter"),rD.isNode(d.target)&&(d.target=d.target.parentNode);r.freeEvent(d);}r.freeEvent(c);}r.dispatchEvent(e,"pointermove"),"touch"===e.pointerType&&r.dispatchEvent(e,"touchmove"),n&&(r.dispatchEvent(e,"mousemove"),r.cursor=r.getCursor(e.target)),i.overTargets=e.composedPath(),r.freeEvent(e);},this.onPointerOut=function(t){var e=r.trackingData(t.pointerId);if(e.overTargets){var n="mouse"===t.pointerType||"pen"===t.pointerType,i=r.findMountedTarget(e.overTargets),a=r.createPointerEvent(t,"pointerout",i||void 0);r.dispatchEvent(a),n&&r.dispatchEvent(a,"mouseout");var o=r.createPointerEvent(t,"pointerleave",i||void 0);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==(rD.isNode(r.rootTarget)&&r.rootTarget.parentNode);)o.currentTarget=o.target,r.notifyTarget(o),n&&r.notifyTarget(o,"mouseleave"),rD.isNode(o.target)&&(o.target=o.target.parentNode);e.overTargets=null,r.freeEvent(a),r.freeEvent(o);}r.cursor=null;},this.onPointerOver=function(t){var e=r.trackingData(t.pointerId),n=r.createPointerEvent(t),i="mouse"===n.pointerType||"pen"===n.pointerType;r.dispatchEvent(n,"pointerover"),i&&r.dispatchEvent(n,"mouseover"),"mouse"===n.pointerType&&(r.cursor=r.getCursor(n.target));var a=r.clonePointerEvent(n,"pointerenter");for(a.eventPhase=a.AT_TARGET;a.target&&a.target!==(rD.isNode(r.rootTarget)&&r.rootTarget.parentNode);)a.currentTarget=a.target,r.notifyTarget(a),i&&r.notifyTarget(a,"mouseenter"),rD.isNode(a.target)&&(a.target=a.target.parentNode);e.overTargets=n.composedPath(),r.freeEvent(n),r.freeEvent(a);},this.onPointerUpOutside=function(t){var e=r.trackingData(t.pointerId),n=r.findMountedTarget(e.pressTargetsByButton[t.button]),i=r.createPointerEvent(t);if(n){for(var a=n;a;)i.currentTarget=a,r.notifyTarget(i,"pointerupoutside"),"touch"===i.pointerType||("mouse"===i.pointerType||"pen"===i.pointerType)&&r.notifyTarget(i,2===i.button?"rightupoutside":"mouseupoutside"),rD.isNode(a)&&(a=a.parentNode);delete e.pressTargetsByButton[t.button];}r.freeEvent(i);},this.onWheel=function(t){var e=r.createWheelEvent(t);r.dispatchEvent(e),r.freeEvent(e);},this.onClick=function(t){if(r.context.config.useNativeClickEvent){var e=r.createPointerEvent(t);r.dispatchEvent(e),r.freeEvent(e);}},this.onPointerCancel=function(t){var e=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);r.dispatchEvent(e),r.freeEvent(e);},this.globalRuntime=e,this.context=n;},[{key:"init",value:function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick);}},{key:"destroy",value:function(){this.mappingTable={},this.mappingState={},this.eventPool.clear();}},{key:"getScale",value:function(){var t=this.context.contextService.getBoundingClientRect(),e=1,n=1,r=this.context.contextService.getDomElement();if(r&&t){var i=r.offsetWidth,a=r.offsetHeight;i&&a&&(e=t.width/i,n=t.height/a);}return{scaleX:e,scaleY:n,bbox:t};}},{key:"client2Viewport",value:function(t){var e=this.getScale(),n=e.scaleX,r=e.scaleY,i=e.bbox;return new ts((t.x-((null==i?void 0:i.left)||0))/n,(t.y-((null==i?void 0:i.top)||0))/r);}},{key:"viewport2Client",value:function(t){var e=this.getScale(),n=e.scaleX,r=e.scaleY,i=e.bbox;return new ts((t.x+((null==i?void 0:i.left)||0))*n,(t.y+((null==i?void 0:i.top)||0))*r);}},{key:"viewport2Canvas",value:function(t){var e=t.x,n=t.y,r=this.rootTarget.defaultView.getCamera(),i=this.context.config,a=i.width,o=i.height,s=r.getPerspectiveInverse(),l=r.getWorldTransform(),u=G.mat4.multiply(this.tmpMatrix,l,s),c=G.vec3.set(this.tmpVec3,e/a*2-1,(1-n/o)*2-1,0);return G.vec3.transformMat4(c,c,u),new ts(c[0],c[1]);}},{key:"canvas2Viewport",value:function(t){var e=this.rootTarget.defaultView.getCamera(),n=e.getPerspective(),r=e.getViewTransform(),i=G.mat4.multiply(this.tmpMatrix,n,r),a=G.vec3.set(this.tmpVec3,t.x,t.y,0);G.vec3.transformMat4(this.tmpVec3,this.tmpVec3,i);var o=this.context.config,s=o.width,l=o.height;return new ts((a[0]+1)/2*s,(1-(a[1]+1)/2)*l);}},{key:"setPickHandler",value:function(t){this.pickHandler=t;}},{key:"addEventMapping",value:function(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort(function(t,e){return t.priority-e.priority;});}},{key:"mapEvent",value:function(t){if(this.rootTarget){var e=this.mappingTable[t.type];if(e)for(var n=0,r=e.length;n<r;n++)e[n].fn(t);else console.warn("[EventService]: Event mapping not defined for ".concat(t.type));}}},{key:"dispatchEvent",value:function(t,e,n){if(n){t.eventPhase=t.AT_TARGET;var r=this.rootTarget.defaultView||null;t.currentTarget=r,this.notifyListeners(t,e);}else t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e);}},{key:"propagate",value:function(t,e){if(t.target){var n=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(var r=n.length-1;r>=1;r--)if(t.currentTarget=n[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!t.propagationStopped&&!t.propagationImmediatelyStopped){var i=n.indexOf(t.currentTarget);t.eventPhase=t.BUBBLING_PHASE;for(var a=i+1;a<n.length;a++)if(t.currentTarget=n[a],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;}}}},{key:"propagationPath",value:function(t){var e=[t],n=this.rootTarget.defaultView||null;if(n&&n===t)return e.unshift(n.document),e;for(var r=0;r<2048&&t!==this.rootTarget;r++)rD.isNode(t)&&t.parentNode&&(e.push(t.parentNode),t=t.parentNode);return n&&e.push(n),e;}},{key:"hitTest",value:function(t){var e=t.viewportX,n=t.viewportY,r=this.context.config,i=r.width,a=r.height,o=r.disableHitTesting;return e<0||n<0||e>i||n>a?null:!o&&this.pickHandler(t)||this.rootTarget||null;}},{key:"isNativeEventFromCanvas",value:function(t,e){var n,r=null==e?void 0:e.target;if(null!==(n=r)&&void 0!==n&&n.shadowRoot&&(r=e.composedPath()[0]),r){if(r===t)return!0;if(t&&t.contains)return t.contains(r);}return null!=e&&!!e.composedPath&&e.composedPath().indexOf(t)>-1;}},{key:"getExistedHTML",value:function(t){if(t.nativeEvent.composedPath)for(var e=0,n=t.nativeEvent.composedPath();e<n.length;e++){var r=n[e],i=this.nativeHTMLMap.get(r);if(i)return i;}return null;}},{key:"pickTarget",value:function(t){return this.hitTest({clientX:t.clientX,clientY:t.clientY,viewportX:t.viewportX,viewportY:t.viewportY,x:t.canvasX,y:t.canvasY});}},{key:"createPointerEvent",value:function(t,e,n,r){var i=this.allocateEvent(rO);this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.nativeEvent=t.nativeEvent,i.originalEvent=t;var a=this.getExistedHTML(i),o=this.context.contextService.getDomElement();return i.target=null!=n?n:a||this.isNativeEventFromCanvas(o,i.nativeEvent)&&this.pickTarget(i)||r,"string"==typeof e&&(i.type=e),i;}},{key:"createWheelEvent",value:function(t){var e=this.allocateEvent(rL);this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t;var n=this.getExistedHTML(e),r=this.context.contextService.getDomElement();return e.target=n||this.isNativeEventFromCanvas(r,e.nativeEvent)&&this.pickTarget(e),e;}},{key:"trackingData",value:function(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t];}},{key:"cloneWheelEvent",value:function(t){var e=this.allocateEvent(rL);return e.nativeEvent=t.nativeEvent,e.originalEvent=t.originalEvent,this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.target=t.target,e.path=t.composedPath().slice(),e.type=t.type,e;}},{key:"clonePointerEvent",value:function(t,e){var n=this.allocateEvent(rO);return n.nativeEvent=t.nativeEvent,n.originalEvent=t.originalEvent,this.copyPointerData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.target=t.target,n.path=t.composedPath().slice(),n.type=null!=e?e:n.type,n;}},{key:"copyPointerData",value:function(t,e){e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist;}},{key:"copyMouseData",value:function(t,e){e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey,e.client.copyFrom(t.client),e.movement.copyFrom(t.movement),e.canvas.copyFrom(t.canvas),e.screen.copyFrom(t.screen),e.global.copyFrom(t.global),e.offset.copyFrom(t.offset);}},{key:"copyWheelData",value:function(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;}},{key:"copyData",value:function(t,e){e.isTrusted=t.isTrusted,e.timeStamp=n0.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.page.copyFrom(t.page),e.viewport.copyFrom(t.viewport);}},{key:"allocateEvent",value:function(t){this.eventPool.has(t)||this.eventPool.set(t,[]);var e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=[],e.target=null,e;}},{key:"freeEvent",value:function(t){if(t.manager!==this)throw Error("It is illegal to free an event not managed by this EventBoundary!");var e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t);}},{key:"notifyTarget",value:function(t,e){e=null!=e?e:t.type;var n=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?"".concat(e,"capture"):e;this.notifyListeners(t,n),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e);}},{key:"notifyListeners",value:function(t,e){var n=t.currentTarget.emitter,r=n._events[e];if(r){if("fn"in r)r.once&&n.removeListener(e,r.fn,void 0,!0),r.fn.call(t.currentTarget||r.context,t);else for(var i=0;i<r.length&&!t.propagationImmediatelyStopped;i++)r[i].once&&n.removeListener(e,r[i].fn,void 0,!0),r[i].fn.call(t.currentTarget||r[i].context,t);}}},{key:"findMountedTarget",value:function(t){if(!t)return null;for(var e=t[t.length-1],n=t.length-2;n>=0;n--){var r=t[n];if(r===this.rootTarget||rD.isNode(r)&&r.parentNode===e)e=t[n];else break;}return e;}},{key:"getCursor",value:function(t){for(var e=t;e;){var n=!!e.getAttribute&&e.getAttribute("cursor");if(n)return n;e=rD.isNode(e)&&e.parentNode;}}}]);var r_=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"getOrCreateCanvas",value:function(t,e){if(this.canvas)return this.canvas;if(t||ii.offscreenCanvas)this.canvas=t||ii.offscreenCanvas,this.context=this.canvas.getContext("2d",(0,A.default)({willReadFrequently:!0},e));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",(0,A.default)({willReadFrequently:!0},e)),this.context&&this.context.measureText||(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"));}catch(t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",(0,A.default)({willReadFrequently:!0},e));}return this.canvas.width=10,this.canvas.height=10,this.canvas;}},{key:"getOrCreateContext",value:function(t,e){return this.context||this.getOrCreateCanvas(t,e),this.context;}}],[{key:"createCanvas",value:function(){try{return new window.OffscreenCanvas(0,0);}catch(t){}try{return document.createElement("canvas");}catch(t){}return null;}}]),rG=((k={})[k.CAMERA_CHANGED=0]="CAMERA_CHANGED",k[k.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",k[k.NONE=2]="NONE",k);(0,R.default)(function t(e,n){(0,C.default)(this,t),this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new ri,initAsync:new rn,dirtycheck:new ra,cull:new ra,beginFrame:new ri,beforeRender:new ri,render:new ri,afterRender:new ri,endFrame:new ri,destroy:new ri,pick:new rr,pickSync:new ra,pointerDown:new ri,pointerUp:new ri,pointerMove:new ri,pointerOut:new ri,pointerOver:new ri,pointerWheel:new ri,pointerCancel:new ri,click:new ri},this.globalRuntime=e,this.context=n;},[{key:"init",value:function(t){var e=this,n=(0,A.default)((0,A.default)({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach(function(t){t.apply(n,e.globalRuntime);}),this.hooks.init.call(),0===this.hooks.initAsync.getCallbacksNum()?(this.inited=!0,t()):this.hooks.initAsync.promise().then(function(){e.inited=!0,t();}).catch(function(t){});}},{key:"getStats",value:function(){return this.stats;}},{key:"disableDirtyRectangleRendering",value:function(){return!this.context.config.renderer.getConfig().enableDirtyRectangleRendering||this.context.renderingContext.renderReasons.has(rG.CAMERA_CHANGED);}},{key:"render",value:function(t,e,n){var r=this,i=t.getConfig(),a=this.context.renderingContext;if(this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0,this.globalRuntime.sceneGraphService.syncHierarchy(a.root),this.globalRuntime.sceneGraphService.notifyMutationObservers(t),a.renderReasons.size&&this.inited){a.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var o=1===a.renderReasons.size&&a.renderReasons.has(rG.CAMERA_CHANGED),s=!i.disableRenderHooks||!o;s&&this.renderDisplayObject(a.root,i,a),this.hooks.beginFrame.call(e),s&&a.renderListCurrentFrame.forEach(function(t){r.hooks.beforeRender.call(t),r.hooks.render.call(t),r.hooks.afterRender.call(t);}),this.hooks.endFrame.call(e),a.renderListCurrentFrame=[],a.renderReasons.clear(),n();}}},{key:"renderDisplayObject",value:function(t,e,n){for(var r=this,i=e.renderer.getConfig(),a=i.enableDirtyCheck,o=i.enableCulling,s=[t];s.length>0;){var l,u=s.pop();!function(t){var e=t.renderable,i=t.sortable,s=a?e.dirty||n.dirtyRectangleRenderingDisabled?t:null:t,l=null;s&&(l=o?r.hooks.cull.call(s,r.context.camera):s)&&(r.stats.rendered+=1,n.renderListCurrentFrame.push(l)),t.dirty(!1),i.renderOrder=r.zIndexCounter,r.zIndexCounter+=1,r.stats.total+=1,i.dirty&&(r.sort(t,i),i.dirty=!1,i.dirtyChildren=[],i.dirtyReason=void 0);}(u);for(var c=(null===(l=u.sortable)||void 0===l||null===(l=l.sorted)||void 0===l?void 0:l.length)>0?u.sortable.sorted:u.childNodes,h=c.length-1;h>=0;h--)s.push(c[h]);}}},{key:"sort",value:function(t,e){var n,r;(null==e||null===(n=e.sorted)||void 0===n?void 0:n.length)>0&&e.dirtyReason!==tC.Z_INDEX_CHANGED?e.dirtyChildren.forEach(function(n){var r=e.sorted.indexOf(n);if(r>-1&&e.sorted.splice(r,1),t.childNodes.indexOf(n)>-1){if(0===e.sorted.length)e.sorted.push(n);else{var i=function(t,e){for(var n=0,r=t.length;n<r;){var i=n+r>>>1;0>nQ(t[i],e)?n=i+1:r=i;}return n;}(e.sorted,n);e.sorted.splice(i,0,n);}}}):e.sorted=t.childNodes.slice().sort(nQ),(null===(r=e.sorted)||void 0===r?void 0:r.length)>0&&0===t.childNodes.filter(function(t){return t.parsedStyle.zIndex;}).length&&(e.sorted=[]);}},{key:"destroy",value:function(){this.inited=!1,this.hooks.destroy.call();}},{key:"dirty",value:function(){this.context.renderingContext.renderReasons.add(rG.DISPLAY_OBJECT_CHANGED);}}]);var rF=/\[\s*(.*)=(.*)\s*\]/,rB=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"selectOne",value:function(t,e){var n=this;if(t.startsWith("."))return e.find(function(e){return((null==e?void 0:e.classList)||[]).indexOf(n.getIdOrClassname(t))>-1;});if(t.startsWith("#"))return e.find(function(e){return e.id===n.getIdOrClassname(t);});if(t.startsWith("[")){var r=this.getAttribute(t),i=r.name,a=r.value;return i?e.find(function(t){return e!==t&&("name"===i?t.name===a:n.attributeToString(t,i)===a);}):null;}return e.find(function(n){return e!==n&&n.nodeName===t;});}},{key:"selectAll",value:function(t,e){var n=this;if(t.startsWith("."))return e.findAll(function(r){return e!==r&&((null==r?void 0:r.classList)||[]).indexOf(n.getIdOrClassname(t))>-1;});if(t.startsWith("#"))return e.findAll(function(r){return e!==r&&r.id===n.getIdOrClassname(t);});if(t.startsWith("[")){var r=this.getAttribute(t),i=r.name,a=r.value;return i?e.findAll(function(t){return e!==t&&("name"===i?t.name===a:n.attributeToString(t,i)===a);}):[];}return e.findAll(function(n){return e!==n&&n.nodeName===t;});}},{key:"is",value:function(t,e){if(t.startsWith("."))return e.className===this.getIdOrClassname(t);if(t.startsWith("#"))return e.id===this.getIdOrClassname(t);if(t.startsWith("[")){var n=this.getAttribute(t),r=n.name,i=n.value;return"name"===r?e.name===i:this.attributeToString(e,r)===i;}return e.nodeName===t;}},{key:"getIdOrClassname",value:function(t){return t.substring(1);}},{key:"getAttribute",value:function(t){var e=t.match(rF),n="",r="";return e&&e.length>2&&(n=e[1].replace(/"/g,""),r=e[2].replace(/"/g,"")),{name:n,value:r};}},{key:"attributeToString",value:function(t,e){if(!t.getAttribute)return"";var n=t.getAttribute(e);return(0,F.isNil)(n)?"":n.toString?n.toString():"";}}]),rU=((E={}).ATTR_MODIFIED="DOMAttrModified",E.INSERTED="DOMNodeInserted",E.MOUNTED="DOMNodeInsertedIntoDocument",E.REMOVED="removed",E.UNMOUNTED="DOMNodeRemovedFromDocument",E.REPARENT="reparent",E.DESTROY="destroy",E.BOUNDS_CHANGED="bounds-changed",E.CULLED="culled",E),rV=function(t){function e(t,n,r,i,a,o,s,l){var u;return(0,C.default)(this,e),(u=(0,L.default)(this,e,[null])).relatedNode=n,u.prevValue=r,u.newValue=i,u.attrName=a,u.attrChange=o,u.prevParsedValue=s,u.newParsedValue=l,u.type=t,u;}return(0,I.default)(e,t),(0,R.default)(e);}(rC);rV.ADDITION=2,rV.MODIFICATION=1,rV.REMOVAL=3;var rz=new rV(rU.REPARENT,null,"","","",0,"",""),rH=G.vec2.create(),rY=G.vec3.create(),rW=G.vec3.fromValues(1,1,1),rq=G.mat4.create(),rX=G.vec2.create(),rj=G.vec3.create(),r$=G.mat4.create(),rK=G.quat.create(),rZ=G.vec3.create(),rQ=G.quat.create(),rJ=G.vec3.create(),r0=G.vec3.create(),r1=G.vec3.create(),r2=G.mat4.create(),r3=G.quat.create(),r4=G.quat.create(),r5=G.quat.create(),r6=(0,R.default)(function t(e){(0,C.default)(this,t),this.displayObjectDependencyMap=new WeakMap,this.runtime=e;},[{key:"matches",value:function(t,e){return this.runtime.sceneGraphSelector.is(t,e);}},{key:"querySelector",value:function(t,e){return this.runtime.sceneGraphSelector.selectOne(t,e);}},{key:"querySelectorAll",value:function(t,e){return this.runtime.sceneGraphSelector.selectAll(t,e);}},{key:"attach",value:function(t,e,n){var r=!1;t.parentNode&&(r=t.parentNode!==e,this.detach(t));var i=t.nodeName===j.FRAGMENT,a=n1(e);t.parentNode=e;var o=i?t.childNodes:[t];(0,F.isNumber)(n)?o.forEach(function(t){e.childNodes.splice(n,0,t),t.parentNode=e;}):o.forEach(function(t){e.childNodes.push(t),t.parentNode=e;});var s=e.sortable;if((null!=s&&null!==(u=s.sorted)&&void 0!==u&&u.length||s.dirty||t.parsedStyle.zIndex)&&(-1===s.dirtyChildren.indexOf(t)&&s.dirtyChildren.push(t),s.dirty=!0,s.dirtyReason=tC.ADDED),!a){if(i)this.dirtyFragment(t);else{var l=t.transformable;l&&this.dirtyWorldTransform(t,l);}if(r){var u,c,h=(null===(c=e.ownerDocument)||void 0===c||null===(c=c.defaultView)||void 0===c||null===(c=c.getConfig())||void 0===c||null===(c=c.future)||void 0===c?void 0:c.experimentalCancelEventPropagation)===!0;t.dispatchEvent(rz,h,h);}}}},{key:"detach",value:function(t){if(t.parentNode){var e,n,r=t.transformable,i=t.parentNode.sortable;(null!=i&&null!==(e=i.sorted)&&void 0!==e&&e.length||null!==(n=t.style)&&void 0!==n&&n.zIndex)&&(-1===i.dirtyChildren.indexOf(t)&&i.dirtyChildren.push(t),i.dirty=!0,i.dirtyReason=tC.REMOVED);var a=t.parentNode.childNodes.indexOf(t);a>-1&&t.parentNode.childNodes.splice(a,1),r&&this.dirtyWorldTransform(t,r),t.parentNode=null;}}},{key:"getLocalPosition",value:function(t){return t.transformable.localPosition;}},{key:"getLocalRotation",value:function(t){return t.transformable.localRotation;}},{key:"getLocalScale",value:function(t){return t.transformable.localScale;}},{key:"getLocalSkew",value:function(t){return t.transformable.localSkew;}},{key:"getLocalTransform",value:function(t){var e=t.transformable;return tI(e),e.localTransform;}},{key:"setLocalPosition",value:function(t,e){var n,r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=t.transformable;r0[0]=e[0],r0[1]=e[1],r0[2]=null!==(n=e[2])&&void 0!==n?n:0,!G.vec3.equals(i.localPosition,r0)&&(G.vec3.copy(i.localPosition,r0),r&&this.dirtyLocalTransform(t,i));}},{key:"translateLocal",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var i=t.transformable;G.vec3.equals(e,rY)||(G.vec3.transformQuat(e,e,i.localRotation),G.vec3.add(i.localPosition,i.localPosition,e),this.dirtyLocalTransform(t,i));}},{key:"setLocalRotation",value:function(t,e,n,r,i){var a=!(arguments.length>5)||void 0===arguments[5]||arguments[5];"number"==typeof e&&(e=G.quat.set(rK,e,n,r,i));var o=t.transformable;G.quat.copy(o.localRotation,e),a&&this.dirtyLocalTransform(t,o);}},{key:"rotateLocal",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var i=t.transformable;G.quat.fromEuler(r4,e[0],e[1],e[2]),G.quat.mul(i.localRotation,i.localRotation,r4),this.dirtyLocalTransform(t,i);}},{key:"setLocalScale",value:function(t,e){var n,r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=t.transformable;G.vec3.set(rj,e[0],e[1],null!==(n=e[2])&&void 0!==n?n:i.localScale[2]),!G.vec3.equals(rj,i.localScale)&&(G.vec3.copy(i.localScale,rj),r&&this.dirtyLocalTransform(t,i));}},{key:"scaleLocal",value:function(t,e){var n,r=t.transformable;G.vec3.multiply(r.localScale,r.localScale,G.vec3.set(rj,e[0],e[1],null!==(n=e[2])&&void 0!==n?n:1)),this.dirtyLocalTransform(t,r);}},{key:"setLocalSkew",value:function(t,e,n){var r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];"number"==typeof e&&(e=G.vec2.set(rX,e,n));var i=t.transformable;G.vec2.copy(i.localSkew,e),r&&this.dirtyLocalTransform(t,i);}},{key:"setLocalEulerAngles",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=!(arguments.length>4)||void 0===arguments[4]||arguments[4];"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var a=t.transformable;G.quat.fromEuler(a.localRotation,e[0],e[1],e[2]),i&&this.dirtyLocalTransform(t,a);}},{key:"setLocalTransform",value:function(t,e){var n=G.mat4.getTranslation(rZ,e),r=G.mat4.getRotation(rQ,e),i=G.mat4.getScaling(rJ,e);this.setLocalScale(t,i,!1),this.setLocalPosition(t,n,!1),this.setLocalRotation(t,r,void 0,void 0,void 0,!1),this.dirtyLocalTransform(t,t.transformable);}},{key:"resetLocalTransform",value:function(t){this.setLocalScale(t,rW,!1),this.setLocalPosition(t,rY,!1),this.setLocalEulerAngles(t,rY,void 0,void 0,!1),this.setLocalSkew(t,rH,void 0,!1),this.dirtyLocalTransform(t,t.transformable);}},{key:"getPosition",value:function(t){var e=t.transformable;return G.mat4.getTranslation(e.position,this.getWorldTransform(t,e));}},{key:"getRotation",value:function(t){var e=t.transformable;return G.mat4.getRotation(e.rotation,this.getWorldTransform(t,e));}},{key:"getScale",value:function(t){var e=t.transformable;return G.mat4.getScaling(e.scaling,this.getWorldTransform(t,e));}},{key:"getOrigin",value:function(t){return t.getGeometryBounds(),t.transformable.origin;}},{key:"getWorldTransform",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.transformable;return(e.localDirtyFlag||e.dirtyFlag)&&(t.parentNode&&t.parentNode.transformable&&this.getWorldTransform(t.parentNode),this.internalUpdateTransform(t)),e.worldTransform;}},{key:"setPosition",value:function(t,e){var n,r=t.transformable;if(r1[0]=e[0],r1[1]=e[1],r1[2]=null!==(n=e[2])&&void 0!==n?n:0,!G.vec3.equals(this.getPosition(t),r1)){if(G.vec3.copy(r.position,r1),null!==t.parentNode&&t.parentNode.transformable){var i=t.parentNode.transformable;G.mat4.copy(r2,i.worldTransform),G.mat4.invert(r2,r2),G.vec3.transformMat4(r.localPosition,r1,r2);}else G.vec3.copy(r.localPosition,r1);this.dirtyLocalTransform(t,r);}}},{key:"translate",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.set(rj,e,n,r)),G.vec3.equals(e,rY)||(G.vec3.add(rj,this.getPosition(t),e),this.setPosition(t,rj));}},{key:"setRotation",value:function(t,e,n,r,i){var a=t.transformable;if("number"==typeof e&&(e=G.quat.fromValues(e,n,r,i)),null!==t.parentNode&&t.parentNode.transformable){var o=this.getRotation(t.parentNode);G.quat.copy(rK,o),G.quat.invert(rK,rK),G.quat.multiply(a.localRotation,rK,e),G.quat.normalize(a.localRotation,a.localRotation),this.dirtyLocalTransform(t,a);}else this.setLocalRotation(t,e);}},{key:"rotate",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var i=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){G.quat.fromEuler(rK,e[0],e[1],e[2]);var a=this.getRotation(t),o=this.getRotation(t.parentNode);G.quat.copy(r5,o),G.quat.invert(r5,r5),G.quat.multiply(rK,r5,rK),G.quat.multiply(i.localRotation,rK,a),G.quat.normalize(i.localRotation,i.localRotation),this.dirtyLocalTransform(t,i);}else this.rotateLocal(t,e);}},{key:"setOrigin",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=[e,n,r]);var i=t.transformable;if(e[0]!==i.origin[0]||e[1]!==i.origin[1]||e[2]!==i.origin[2]){var a=i.origin;a[0]=e[0],a[1]=e[1],a[2]=e[2]||0,this.dirtyLocalTransform(t,i);}}},{key:"setEulerAngles",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var i=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){G.quat.fromEuler(i.localRotation,e[0],e[1],e[2]);var a=this.getRotation(t.parentNode);G.quat.copy(r3,G.quat.invert(rK,a)),G.quat.mul(i.localRotation,i.localRotation,r3),this.dirtyLocalTransform(t,i);}else this.setLocalEulerAngles(t,e);}},{key:"getGeometryBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.geometry;return n.dirty&&ii.styleValueRegistry.updateGeometry(t),(e?n.renderBounds:n.contentBounds||null)||new tr;}},{key:"getTransformedGeometryBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this.getGeometryBounds(t,e);if(!tr.isEmpty(r)){var i=n||new tr;return i.setFromTransformedAABB(r,this.getWorldTransform(t)),i;}return null;}},{key:"getBounds",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t.renderable;if(!r.boundsDirty&&!n&&r.bounds)return r.bounds;if(!r.renderBoundsDirty&&n&&r.renderBounds)return r.renderBounds;var i=n?r.renderBounds:r.bounds,a=this.getTransformedGeometryBounds(t,n,i);if(t.childNodes.forEach(function(t){var r=e.getBounds(t,n);r&&(a?a.add(r):(a=i||new tr).update(r.center,r.halfExtents));}),a||(a=new tr),n){var o=function(t){var e,n=t;do{if(null===(e=n.parsedStyle)||void 0===e?void 0:e.clipPath)return n;n=n.parentElement;}while(null!==n)return null;}(t);if(o){var s=o.parsedStyle.clipPath.getBounds(n);a?s&&(a=s.intersection(a)):a.update(s.center,s.halfExtents);}}return n?(r.renderBounds=a,r.renderBoundsDirty=!1):(r.bounds=a,r.boundsDirty=!1),a;}},{key:"getLocalBounds",value:function(t){if(t.parentNode){var e=rq;t.parentNode.transformable&&(e=G.mat4.invert(r$,this.getWorldTransform(t.parentNode)));var n=this.getBounds(t);if(!tr.isEmpty(n)){var r=new tr;return r.setFromTransformedAABB(n,e),r;}}return this.getBounds(t);}},{key:"getBoundingClientRect",value:function(t){var e,n,r=this.getGeometryBounds(t);tr.isEmpty(r)||(n=new tr).setFromTransformedAABB(r,this.getWorldTransform(t));var i=null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e?void 0:e.getContextService().getBoundingClientRect();if(n){var a=n.getMin(),o=(0,D.default)(a,2),s=o[0],l=o[1],u=n.getMax(),c=(0,D.default)(u,2),h=c[0],d=c[1];return new tl(s+((null==i?void 0:i.left)||0),l+((null==i?void 0:i.top)||0),h-s,d-l);}return new tl((null==i?void 0:i.left)||0,(null==i?void 0:i.top)||0,0,0);}},{key:"internalUpdateTransform",value:function(t){var e,n,r=null===(n=t.parentNode)||void 0===n?void 0:n.transformable;tI(t.transformable),(e=t.transformable).dirtyFlag&&(r?G.mat4.multiply(e.worldTransform,r.worldTransform,e.localTransform):G.mat4.copy(e.worldTransform,e.localTransform),e.dirtyFlag=!1);}},{key:"internalUpdateElement",value:function(t,e){var n=(null===(s=t.ownerDocument)||void 0===s||null===(s=s.defaultView)||void 0===s||null===(s=s.getConfig())||void 0===s||null===(s=s.future)||void 0===s?void 0:s.experimentalAttributeUpdateOptimization)===!0,r=e[e.length-1],i=(null==r?void 0:r.transformDirty)||(null===(l=t.transformable)||void 0===l?void 0:l.localDirtyFlag);t.transformable&&((h=t.transformable).dirtyFlag||(h.dirtyFlag=i)),this.internalUpdateTransform(t),i&&(null===(d=t.dirty)||void 0===d||d.call(t,!0,!0));var a=(null===(u=t.renderable)||void 0===u?void 0:u.boundsDirty)||(null===(c=t.renderable)||void 0===c?void 0:c.renderBoundsDirty);if((i||a)&&(null==r?void 0:r.shapeUpdated)===!1&&n)for(var o=e.length-1;o>=0;){var s,l,u,c,h,d,f,v,p=e[o];if(p.shapeUpdated)break;null===(f=(v=p.node).dirty)||void 0===f||f.call(v,!0,!0),p.shapeUpdated=!0,o-=1;}return i;}},{key:"syncHierarchy",value:function(t){for(var e,n,r=[t],i=t.parentNode?[{node:t.parentNode,transformDirty:(null===(e=t.parentNode.transformable)||void 0===e?void 0:e.localDirtyFlag)||(null===(n=t.parentNode.transformable)||void 0===n?void 0:n.dirtyFlag),shapeUpdated:!1}]:[];r.length>0;){for(var a=r.pop(),o=i[i.length-1];i.length>0&&a.parentNode!==o.node;)o=i.pop();var s=this.internalUpdateElement(a,i);if(a.childNodes.length>0){for(var l=a.childNodes.length-1;l>=0;l--)r.push(a.childNodes[l]);i.push({node:a,transformDirty:s,shapeUpdated:!1});}}}},{key:"dirtyLocalTransform",value:function(t,e){n1(t)||e.localDirtyFlag||(e.localDirtyFlag=!0,e.dirtyFlag||this.dirtyWorldTransform(t,e));}},{key:"dirtyWorldTransform",value:function(t,e){this.dirtyWorldInternal(t,e),this.dirtyToRoot(t,!0);}},{key:"dirtyWorldInternal",value:function(t,e){var n,r=this,i=(null===(n=t.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n||null===(n=n.getConfig())||void 0===n||null===(n=n.future)||void 0===n?void 0:n.experimentalAttributeUpdateOptimization)===!0;e.dirtyFlag||(e.dirtyFlag=!0,t.dirty(!0,!0),i||t.childNodes.forEach(function(t){var e=t.transformable;r.dirtyWorldInternal(t,e);}));}},{key:"dirtyToRoot",value:function(t){for(var e,n,r,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=t,o=(null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig())||void 0===e||null===(e=e.future)||void 0===e?void 0:e.experimentalAttributeUpdateOptimization)===!0;a&&(null===(n=(r=a).dirty)||void 0===n||n.call(r,!0,!0),!o);)a=a.parentNode;i&&t.forEach(function(t){var e;null===(e=t.dirty)||void 0===e||e.call(t,!0,!0);}),this.informDependentDisplayObjects(t);var s=t.mutations||[],l=s.find(function(t){return"attributes"===t.type&&t._boundsChangeData;});l?l._boundsChangeData={affectChildren:l._boundsChangeData.affectChildren||i}:(l={type:"attributes",target:t,_boundsChangeData:{affectChildren:i}},s.push(l)),t.mutations=s;}},{key:"dirtyFragment",value:function(t){var e,n=t.transformable;n&&(n.dirtyFlag=!0,n.localDirtyFlag=!0),null===(e=t.dirty)||void 0===e||e.call(t,!0,!0);for(var r=t.childNodes.length,i=0;i<r;i++)this.dirtyFragment(t.childNodes[i]);}},{key:"notifyMutationObservers",value:function(t){var e=new Set;if(t.getRoot().forEach(function(t){(t.mutations||[]).forEach(function(n){"attributes"===n.type&&n._boundsChangeData&&(n._boundsChangeData.affectChildren?t.forEach(function(t){var r=(0,A.default)({},n);r.target=t,e.add(r);}):e.add(n));}),t.mutations=void 0;}),e.size>0){var n=new rI(rU.BOUNDS_CHANGED,{detail:Array.from(e)});t.dispatchEvent(n,!0,!0);}}},{key:"updateDisplayObjectDependency",value:function(t,e,n,r){if(e&&e!==n){var i=this.displayObjectDependencyMap.get(e);if(i&&i[t]){var a=i[t].indexOf(r);i[t].splice(a,1);}}if(n){var o=this.displayObjectDependencyMap.get(n);o||(this.displayObjectDependencyMap.set(n,{}),o=this.displayObjectDependencyMap.get(n)),o[t]||(o[t]=[]),o[t].push(r);}}},{key:"informDependentDisplayObjects",value:function(t){var e,n=this,r=this.displayObjectDependencyMap.get(t);if(r){var i=null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig())||void 0===e||null===(e=e.future)||void 0===e?void 0:e.experimentalCancelEventPropagation;Object.keys(r).forEach(function(t){r[t].forEach(function(e){n.dirtyToRoot(e,!0),e.dispatchEvent(new rV(rU.ATTR_MODIFIED,e,n,n,t,rV.MODIFICATION,n,n),i,i),e.isCustomElement&&e.isConnected&&e.attributeChangedCallback&&e.attributeChangedCallback(t,n,n);});});}}}]),r7=(0,R.default)(function t(e){if((0,C.default)(this,t),e<=0)throw Error("LRU capacity must be a positive number.");this.capacity=e,this.cache=new Map;},[{key:"get",value:function(t){if(this.cache.has(t)){var e=this.cache.get(t);return this.cache.delete(t),this.cache.set(t,e),e;}}},{key:"put",value:function(t,e){if(this.cache.has(t)&&this.cache.delete(t),this.cache.set(t,e),this.cache.size>this.capacity){var n=this.cache.keys().next().value;this.cache.delete(n);}}},{key:"len",value:function(){return this.cache.size;}},{key:"clear",value:function(){this.cache.clear();}}]),r9={MetricsString:"|\xc9q\xc5",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},r8=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,it=new RegExp("".concat(/[!%),.:;?\]}'""]/.source,"|").concat(/[!),.:;?\]}'""]/.source,"|").concat(/[)\]'"?!:;,.]/.source,"|").concat(/[!%),.:;?\]}'"]/.source)),ie=new RegExp("".concat(/[$('"]/.source,"|").concat(/[([{'"]/.source,"|").concat(/[(['"...]/.source,"|").concat(/[$([{'"#]/.source)),ir=(0,R.default)(function t(e){var n=this;(0,C.default)(this,t),this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(t,e){return!n.isBreakingSpace(e)&&!!(t&&(ie.exec(e)||it.exec(t)));},this.trimByKinsokuShorui=function(t){var e=(0,O.default)(t),n=e[e.length-2];if(!n)return t;var r=n[n.length-1];return e[e.length-2]=n.slice(0,-1),e[e.length-1]=r+e[e.length-1],e;},this.runtime=e,this.charWidthCache=new r7(100);},[{key:"measureFont",value:function(t,e){if(this.fontMetricsCache[t])return this.fontMetricsCache[t];var n={ascent:0,descent:0,fontSize:0},r=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(e),i=this.runtime.offscreenCanvasCreator.getOrCreateContext(e,{willReadFrequently:!0});i.font=t;var a=r9.MetricsString+r9.BaselineSymbol,o=Math.ceil(i.measureText(a).width),s=Math.ceil(i.measureText(r9.BaselineSymbol).width),l=r9.HeightMultiplier*s;s=s*r9.BaselineMultiplier|0,r.width=o,r.height=l,i.fillStyle="#f00",i.fillRect(0,0,o,l),i.font=t,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(a,0,s);var u=i.getImageData(0,0,o||1,l||1).data,c=u.length,h=4*o,d=0,f=0,v=!1;for(d=0;d<s;++d){for(var p=0;p<h;p+=4)if(255!==u[f+p]){v=!0;break;}if(v)break;f+=h;}for(n.ascent=s-d,f=c-h,v=!1,d=l;d>s;--d){for(var g=0;g<h;g+=4)if(255!==u[f+g]){v=!0;break;}if(v)break;f-=h;}return n.descent=d-s,n.fontSize=n.ascent+n.descent,this.fontMetricsCache[t]=n,n;}},{key:"measureText",value:function(t,e,n){var r=e.fontSize,i=void 0===r?16:r,a=e.wordWrap,o=e.lineHeight,s=e.lineWidth,l=void 0===s?1:s,u=e.textBaseline,c=void 0===u?"alphabetic":u,h=e.textAlign,d=void 0===h?"start":h,f=e.letterSpacing,v=void 0===f?0:f,p=e.textPath;e.textPathSide,e.textPathStartOffset;var g=e.leading,y=void 0===g?0:g,m=ru(e),k=this.measureFont(m,n);0===k.fontSize&&(k.fontSize=i,k.ascent=i);var E=this.runtime.offscreenCanvasCreator.getOrCreateContext(n);E.font=m,e.isOverflowing=!1;var x=(void 0!==a&&a?this.wordWrap(t,e,n):t).split(/(?:\r\n|\r|\n)/),T=Array(x.length),N=0;if(p){p.getTotalLength();for(var b=0;b<x.length;b++)E.measureText(x[b]).width,x[b].length;}else{for(var S=0;S<x.length;S++){var w=E.measureText(x[S]).width+(x[S].length-1)*v;T[S]=w,N=Math.max(N,w);}var P=N+l,M=o||k.fontSize+l,A=Math.max(M,k.fontSize+l)+(x.length-1)*(M+y);M+=y;var C=0;return"middle"===c?C=-A/2:"bottom"===c||"alphabetic"===c||"ideographic"===c?C=-A:("top"===c||"hanging"===c)&&(C=0),{font:m,width:P,height:A,lines:x,lineWidths:T,lineHeight:M,maxLineWidth:N,fontProperties:k,lineMetrics:T.map(function(t,e){var n=0;return"center"===d||"middle"===d?n-=t/2:("right"===d||"end"===d)&&(n-=t),new tl(n-l/2,C+e*M,t+l,M);})};}}},{key:"wordWrap",value:function(t,e,n){var r=this,i=Array.from(t);if(0===i.length)return"";var a=this,o=e.wordWrapWidth,s=e.letterSpacing,l=void 0===s?0:s,u=e.maxLines,c=void 0===u?1/0:u,h=e.textOverflow,d=this.runtime.offscreenCanvasCreator.getOrCreateContext(n),f=(void 0===o?0:o)+l,v="";"ellipsis"===h?v="...":h&&"clip"!==h&&(v=h);var p=[""],g=0,y=0,m=-1,k=ru(e),E=this.charWidthCache.get(k);E||(E=new r7(500),this.charWidthCache.put(k,E));var x=function(t){return r.getFromCache(t,l,E,d);},T=x(v);function N(t,e,n,r){for(;x(t)<r&&e<i.length-1&&!a.isNewline(i[e+1]);)e+=1,t+=i[e];for(;x(t)>r&&e>=n;)e-=1,t=t.slice(0,-1);return{lineTxt:t,txtLastCharIndex:e};}function b(t,e){if(!(T<=0)&&!(T>f)){if(!p[t]){p[t]=v;return;}var n=N(p[t],e,m+1,f-T);p[t]=n.lineTxt+v;}}for(var S=0;S<i.length;S++){var w=i[S],P=i[S-1],M=i[S+1],A=x(w);if(this.isNewline(w)){if(g+1>=c){S<i.length-1&&b(g,S-1),e.isOverflowing=!0;break;}m=S-1,y=0,p[g+=1]="";continue;}if(A>f){b(g,S-1),e.isOverflowing=!0;break;}if(y>0&&y+A>f){var C=N(p[g],S-1,m+1,f);if(C.txtLastCharIndex!==S-1){if(p[g]=C.lineTxt,C.txtLastCharIndex===i.length-1)break;w=i[S=C.txtLastCharIndex+1],P=i[S-1],M=i[S+1],A=x(w);}if(g+1>=c){b(g,S-1),e.isOverflowing=!0;break;}if(m=S-1,y=0,p[g+=1]="",this.isBreakingSpace(w))continue;this.canBreakInLastChar(w)||(p=this.trimToBreakable(p),y=this.sumTextWidthByCache(p[g]||"",x)),this.shouldBreakByKinsokuShorui(w,M)&&(p=this.trimByKinsokuShorui(p),y+=x(P||""));}y+=A,p[g]+=w;}return p.join("\n");}},{key:"isBreakingSpace",value:function(t){return"string"==typeof t&&r9.BreakingSpaces.indexOf(t.charCodeAt(0))>=0;}},{key:"isNewline",value:function(t){return"string"==typeof t&&r9.Newlines.indexOf(t.charCodeAt(0))>=0;}},{key:"trimToBreakable",value:function(t){var e=(0,O.default)(t),n=e[e.length-2],r=this.findBreakableIndex(n);if(-1===r||!n)return e;var i=n.slice(r,r+1),a=this.isBreakingSpace(i);return e[e.length-1]+=n.slice(r+1,n.length),e[e.length-2]=n.slice(0,r+(a?0:1)),e;}},{key:"canBreakInLastChar",value:function(t){return!(t&&r8.test(t));}},{key:"sumTextWidthByCache",value:function(t,e){return t.split("").reduce(function(t,n){return t+e(n);},0);}},{key:"findBreakableIndex",value:function(t){for(var e=t.length-1;e>=0;e--)if(!r8.test(t[e]))return e;return -1;}},{key:"getFromCache",value:function(t,e,n,r){var i=n.get(t);if("number"!=typeof i){var a=t.length*e;i=r.measureText(t).width+a,n.put(t,i);}return i;}},{key:"clearCache",value:function(){this.fontMetricsCache={},this.charWidthCache.clear();}}]),ii={},ia=(T=new rw,N=new rS,x={},(0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)(x,j.FRAGMENT,null),j.CIRCLE,new rx),j.ELLIPSE,new rT),j.RECT,T),j.IMAGE,T),j.GROUP,new rM),j.LINE,new rN),j.TEXT,new rP(ii)),j.POLYLINE,N),j.POLYGON,N),(0,B.default)((0,B.default)((0,B.default)(x,j.PATH,new rb),j.HTML,new rA),j.MESH,null)),io=(S=new nG,w=new nU,b={},(0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)(b,t_.PERCENTAGE,null),t_.NUMBER,new nY),t_.ANGLE,new nD),t_.DEFINED_PATH,new n_),t_.PAINT,S),t_.COLOR,S),t_.FILTER,new nF),t_.LENGTH,w),t_.LENGTH_PERCENTAGE,w),t_.LENGTH_PERCENTAGE_12,new nV),(0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)(b,t_.LENGTH_PERCENTAGE_14,new nz),t_.COORDINATE,new nU),t_.OFFSET_DISTANCE,new nW),t_.OPACITY_VALUE,new nq),t_.PATH,new nX),t_.LIST_OF_POINTS,new nj),t_.SHADOW_BLUR,new n$),t_.TEXT,new nK),t_.TEXT_TRANSFORM,new nZ),t_.TRANSFORM,new rm),(0,B.default)((0,B.default)((0,B.default)(b,t_.TRANSFORM_ORIGIN,new rk),t_.Z_INDEX,new rE),t_.MARKER,new nH));ii.CameraContribution=tM,ii.AnimationTimeline=null,ii.EasingFunction=null,ii.offscreenCanvasCreator=new r_,ii.sceneGraphSelector=new rB,ii.sceneGraphService=new r6(ii),ii.textService=new ir(ii),ii.geometryUpdaterFactory=ia,ii.CSSPropertySyntaxFactory=io,ii.styleValueRegistry=new nL(ii),ii.layoutRegistry=null,ii.globalThis="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==X?X:{},ii.enableStyleSyntax=!0,ii.enableSizeAttenuation=!1;var is=0,il=new rV(rU.INSERTED,null,"","","",0,"",""),iu=new rV(rU.REMOVED,null,"","","",0,"",""),ic=new rI(rU.DESTROY),ih=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).entity=is++,t.transformable={dirtyFlag:!1,localDirtyFlag:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},t.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},t.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},t.cullable={strategy:tA.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},t.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},t.rBushNode={aabb:void 0},t.namespaceURI="g",t.scrollLeft=0,t.scrollTop=0,t.clientTop=0,t.clientLeft=0,t.style={},t.computedStyle={},t.parsedStyle={},t.attributes={},t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"dirty",value:function(){var t=!(arguments.length>0)||void 0===arguments[0]||arguments[0],e=arguments.length>1?arguments[1]:void 0;this.renderable.dirty=t,void 0!==e&&(this.renderable.boundsDirty=e,this.renderable.renderBoundsDirty=e,this.geometry.dirty=e);}},{key:"className",get:function(){return this.getAttribute("class")||"";},set:function(t){this.setAttribute("class",t);}},{key:"classList",get:function(){return this.className.split(" ").filter(function(t){return""!==t;});}},{key:"tagName",get:function(){return this.nodeName;}},{key:"children",get:function(){return this.childNodes;}},{key:"childElementCount",get:function(){return this.childNodes.length;}},{key:"firstElementChild",get:function(){return this.firstChild;}},{key:"lastElementChild",get:function(){return this.lastChild;}},{key:"parentElement",get:function(){return this.parentNode;}},{key:"nextSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t+1]||null;}return null;}},{key:"previousSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t-1]||null;}return null;}},{key:"cloneNode",value:function(t){throw Error(tu);}},{key:"appendChild",value:function(t,e){var n;if(t.destroyed)throw Error("Cannot append a destroyed element.");return ii.sceneGraphService.attach(t,this,e),null!==(n=this.ownerDocument)&&void 0!==n&&n.defaultView&&(n1(this)||t.nodeName!==j.FRAGMENT?this.ownerDocument.defaultView.mountChildren(t):this.ownerDocument.defaultView.mountFragment(t)),this.isMutationObserved&&(il.relatedNode=this,t.dispatchEvent(il)),t;}},{key:"insertBefore",value:function(t,e){if(e){t.parentElement&&t.parentElement.removeChild(t);var n=this.childNodes.indexOf(e);-1===n?this.appendChild(t):this.appendChild(t,n);}else this.appendChild(t);return t;}},{key:"replaceChild",value:function(t,e){var n=this.childNodes.indexOf(e);return this.removeChild(e),this.appendChild(t,n),e;}},{key:"removeChild",value:function(t){var e,n,r=(null===(e=this.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig().future)||void 0===e?void 0:e.experimentalCancelEventPropagation)===!0;return iu.relatedNode=this,t.dispatchEvent(iu,r,r),null!==(n=t.ownerDocument)&&void 0!==n&&n.defaultView&&t.ownerDocument.defaultView.unmountChildren(t),ii.sceneGraphService.detach(t),t;}},{key:"removeChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var e=this.childNodes[t];this.removeChild(e);}}},{key:"destroyChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var e=this.childNodes[t];e.childNodes.length>0&&e.destroyChildren(),e.destroy();}}},{key:"matches",value:function(t){return ii.sceneGraphService.matches(t,this);}},{key:"getElementById",value:function(t){return ii.sceneGraphService.querySelector("#".concat(t),this);}},{key:"getElementsByName",value:function(t){return ii.sceneGraphService.querySelectorAll('[name="'.concat(t,'"]'),this);}},{key:"getElementsByClassName",value:function(t){return ii.sceneGraphService.querySelectorAll(".".concat(t),this);}},{key:"getElementsByTagName",value:function(t){return ii.sceneGraphService.querySelectorAll(t,this);}},{key:"querySelector",value:function(t){return ii.sceneGraphService.querySelector(t,this);}},{key:"querySelectorAll",value:function(t){return ii.sceneGraphService.querySelectorAll(t,this);}},{key:"closest",value:function(t){var e=this;do{if(ii.sceneGraphService.matches(t,e))return e;e=e.parentElement;}while(null!==e)return null;}},{key:"find",value:function(t){var e=this,n=null;return this.forEach(function(r){return!(r!==e&&t(r))||(n=r,!1);}),n;}},{key:"findAll",value:function(t){var e=this,n=[];return this.forEach(function(r){r!==e&&t(r)&&n.push(r);}),n;}},{key:"after",value:function(){var t=this;if(this.parentNode){for(var e=this.parentNode.childNodes.indexOf(this),n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];r.forEach(function(n,r){var i;return null===(i=t.parentNode)||void 0===i?void 0:i.appendChild(n,e+r+1);});}}},{key:"before",value:function(){if(this.parentNode){for(var t=this.parentNode.childNodes.indexOf(this),e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n[0],a=(0,V.default)(n).slice(1);this.parentNode.appendChild(i,t),i.after.apply(i,(0,O.default)(a));}}},{key:"replaceWith",value:function(){this.after.apply(this,arguments),this.remove();}},{key:"append",value:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(function(e){return t.appendChild(e);});}},{key:"prepend",value:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(function(e,n){return t.appendChild(e,n);});}},{key:"replaceChildren",value:function(){for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,arguments);}},{key:"remove",value:function(){return this.parentNode?this.parentNode.removeChild(this):this;}},{key:"destroy",value:function(){var t,e=(null===(t=this.ownerDocument)||void 0===t||null===(t=t.defaultView)||void 0===t||null===(t=t.getConfig().future)||void 0===t?void 0:t.experimentalCancelEventPropagation)===!0;this.destroyChildren(),this.dispatchEvent(ic,e,e),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0;}},{key:"getGeometryBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return ii.sceneGraphService.getGeometryBounds(this,t);}},{key:"getTransformedGeometryBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return ii.sceneGraphService.getTransformedGeometryBounds(this,t);}},{key:"getBounds",value:function(){return ii.sceneGraphService.getBounds(this);}},{key:"getRenderBounds",value:function(){return ii.sceneGraphService.getBounds(this,!0);}},{key:"getLocalBounds",value:function(){return ii.sceneGraphService.getLocalBounds(this);}},{key:"getBoundingClientRect",value:function(){return ii.sceneGraphService.getBoundingClientRect(this);}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()];}},{key:"computedStyleMap",value:function(){return new Map(Object.entries(this.computedStyle));}},{key:"getAttributeNames",value:function(){return Object.keys(this.attributes);}},{key:"getAttribute",value:function(t){if("symbol"!=typeof t)return this.attributes[t];}},{key:"hasAttribute",value:function(t){return this.getAttributeNames().includes(t);}},{key:"hasAttributes",value:function(){return!!this.getAttributeNames().length;}},{key:"removeAttribute",value:function(t){this.setAttribute(t,null),delete this.attributes[t];}},{key:"setAttribute",value:function(t,e){this.attributes[t]=e;}},{key:"getAttributeNS",value:function(t,e){throw Error(tu);}},{key:"getAttributeNode",value:function(t){throw Error(tu);}},{key:"getAttributeNodeNS",value:function(t,e){throw Error(tu);}},{key:"hasAttributeNS",value:function(t,e){throw Error(tu);}},{key:"removeAttributeNS",value:function(t,e){throw Error(tu);}},{key:"removeAttributeNode",value:function(t){throw Error(tu);}},{key:"setAttributeNS",value:function(t,e,n){throw Error(tu);}},{key:"setAttributeNode",value:function(t){throw Error(tu);}},{key:"setAttributeNodeNS",value:function(t){throw Error(tu);}},{key:"toggleAttribute",value:function(t,e){throw Error(tu);}}]);}(rD);function id(t){return!!(null!=t&&t.nodeName);}var iv=ii.globalThis.Proxy?ii.globalThis.Proxy:function(){},ip=new rV(rU.ATTR_MODIFIED,null,null,null,null,rV.MODIFICATION,null,null),ig=G.vec3.create(),iy=G.quat.create(),im=function(t){function e(t){var n;return(0,C.default)(this,e),(n=(0,L.default)(this,e)).isCustomElement=!1,n.isMutationObserved=!1,n.activeAnimations=[],n.config=t,n.id=t.id||"",n.name=t.name||"",(t.className||t.class)&&(n.className=t.className||t.class),n.nodeName=t.type||j.GROUP,t.initialParsedStyle&&Object.assign(n.parsedStyle,t.initialParsedStyle),n.initAttributes(t.style),ii.enableStyleSyntax&&(n.style=new iv({setProperty:function(t,e){n.setAttribute(t,e);},getPropertyValue:function(t){return n.getAttribute(t);},removeProperty:function(t){n.removeAttribute(t);},item:function(){return"";}},{get:function(t,e){return void 0!==t[e]?t[e]:n.getAttribute(e);},set:function(t,e,r){return n.setAttribute(e,r),!0;}})),n;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"destroy",value:function(){(0,U.default)(e,"destroy",this,3)([]),this.getAnimations().forEach(function(t){t.cancel();});}},{key:"cloneNode",value:function(t,e){var n=(0,A.default)({},this.attributes);for(var r in n){var i=n[r];id(i)&&"clipPath"!==r&&"offsetPath"!==r&&"textPath"!==r&&(n[r]=i.cloneNode(t)),e&&(n[r]=e(r,i));}var a=new this.constructor((0,A.default)((0,A.default)({},this.config),{},{style:n}));return a.setLocalTransform(this.getLocalTransform()),t&&this.children.forEach(function(e){if(!e.style.isMarker){var n=e.cloneNode(t);a.appendChild(n);}}),a;}},{key:"initAttributes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ii.styleValueRegistry.processProperties(this,t,{forceUpdateGeometry:!0}),this.dirty();}},{key:"setAttribute",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!(arguments.length>3)||void 0===arguments[3]||arguments[3];!(0,F.isUndefined)(n)&&(r||n!==this.attributes[t])&&(this.internalSetAttribute(t,n,{memoize:i}),(0,U.default)(e,"setAttribute",this,3)([t,n]));}},{key:"internalSetAttribute",value:function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.attributes[t],a=this.parsedStyle[t];ii.styleValueRegistry.processProperties(this,(0,B.default)({},t,e),r),this.dirty();var o=this.parsedStyle[t];if(this.isConnected){if(ip.relatedNode=this,ip.prevValue=i,ip.newValue=e,ip.attrName=t,ip.prevParsedValue=a,ip.newParsedValue=o,this.isMutationObserved)this.dispatchEvent(ip);else{var s,l=(null===(s=this.ownerDocument.defaultView.getConfig().future)||void 0===s?void 0:s.experimentalCancelEventPropagation)===!0;ip.target=this,this.ownerDocument.defaultView.dispatchEvent(ip,!0,l);}}(this.isCustomElement&&this.isConnected||!this.isCustomElement)&&(null===(n=this.attributeChangedCallback)||void 0===n||n.call(this,t,i,e,a,o));}},{key:"getBBox",value:function(){var t=this.getBounds(),e=t.getMin(),n=(0,D.default)(e,2),r=n[0],i=n[1],a=t.getMax(),o=(0,D.default)(a,2);return new tl(r,i,o[0]-r,o[1]-i);}},{key:"setOrigin",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ii.sceneGraphService.setOrigin(this,td(t,e,n,!1)),this;}},{key:"getOrigin",value:function(){return ii.sceneGraphService.getOrigin(this);}},{key:"setPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ii.sceneGraphService.setPosition(this,td(t,e,n,!1)),this;}},{key:"setLocalPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ii.sceneGraphService.setLocalPosition(this,td(t,e,n,!1)),this;}},{key:"translate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ii.sceneGraphService.translate(this,td(t,e,n,!1)),this;}},{key:"translateLocal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ii.sceneGraphService.translateLocal(this,td(t,e,n,!1)),this;}},{key:"getPosition",value:function(){return ii.sceneGraphService.getPosition(this);}},{key:"getLocalPosition",value:function(){return ii.sceneGraphService.getLocalPosition(this);}},{key:"scale",value:function(t,e,n){return this.scaleLocal(t,e,n);}},{key:"scaleLocal",value:function(t,e,n){return"number"==typeof t&&(e=e||t,n=n||t,t=td(t,e,n,!1)),ii.sceneGraphService.scaleLocal(this,t),this;}},{key:"setLocalScale",value:function(t,e,n){return"number"==typeof t&&(e=e||t,n=n||t,t=td(t,e,n,!1)),ii.sceneGraphService.setLocalScale(this,t),this;}},{key:"getLocalScale",value:function(){return ii.sceneGraphService.getLocalScale(this);}},{key:"getScale",value:function(){return ii.sceneGraphService.getScale(this);}},{key:"getEulerAngles",value:function(){var t=tg(ig,ii.sceneGraphService.getWorldTransform(this));return(0,D.default)(t,3)[2]*tv;}},{key:"getLocalEulerAngles",value:function(){var t=tg(ig,ii.sceneGraphService.getLocalRotation(this));return(0,D.default)(t,3)[2]*tv;}},{key:"setEulerAngles",value:function(t){return ii.sceneGraphService.setEulerAngles(this,0,0,t),this;}},{key:"setLocalEulerAngles",value:function(t){return ii.sceneGraphService.setLocalEulerAngles(this,0,0,t),this;}},{key:"rotateLocal",value:function(t,e,n){return(0,F.isNil)(e)&&(0,F.isNil)(n)?ii.sceneGraphService.rotateLocal(this,0,0,t):ii.sceneGraphService.rotateLocal(this,t,e,n),this;}},{key:"rotate",value:function(t,e,n){return(0,F.isNil)(e)&&(0,F.isNil)(n)?ii.sceneGraphService.rotate(this,0,0,t):ii.sceneGraphService.rotate(this,t,e,n),this;}},{key:"setRotation",value:function(t,e,n,r){return ii.sceneGraphService.setRotation(this,t,e,n,r),this;}},{key:"setLocalRotation",value:function(t,e,n,r){return ii.sceneGraphService.setLocalRotation(this,t,e,n,r),this;}},{key:"setLocalSkew",value:function(t,e){return ii.sceneGraphService.setLocalSkew(this,t,e),this;}},{key:"getRotation",value:function(){return ii.sceneGraphService.getRotation(this);}},{key:"getLocalRotation",value:function(){return ii.sceneGraphService.getLocalRotation(this);}},{key:"getLocalSkew",value:function(){return ii.sceneGraphService.getLocalSkew(this);}},{key:"getLocalTransform",value:function(){return ii.sceneGraphService.getLocalTransform(this);}},{key:"getWorldTransform",value:function(){return ii.sceneGraphService.getWorldTransform(this);}},{key:"setLocalTransform",value:function(t){return ii.sceneGraphService.setLocalTransform(this,t),this;}},{key:"resetLocalTransform",value:function(){ii.sceneGraphService.resetLocalTransform(this);}},{key:"getAnimations",value:function(){return this.activeAnimations;}},{key:"animate",value:function(t,e){var n,r=null===(n=this.ownerDocument)||void 0===n?void 0:n.timeline;return r?r.play(this,t,e):null;}},{key:"isVisible",value:function(){var t;return(null===(t=this.parsedStyle)||void 0===t?void 0:t.visibility)!=="hidden";}},{key:"interactive",get:function(){return this.isInteractive();},set:function(t){this.style.pointerEvents=t?"auto":"none";}},{key:"isInteractive",value:function(){var t;return(null===(t=this.parsedStyle)||void 0===t?void 0:t.pointerEvents)!=="none";}},{key:"isCulled",value:function(){return!!(this.cullable&&this.cullable.enable&&!this.cullable.visible);}},{key:"toFront",value:function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,(0,O.default)(this.parentNode.children.map(function(t){return Number(t.style.zIndex);})))+1),this;}},{key:"toBack",value:function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,(0,O.default)(this.parentNode.children.map(function(t){return Number(t.style.zIndex);})))-1),this;}},{key:"getConfig",value:function(){return this.config;}},{key:"attr",value:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n[0],a=n[1];return i?(0,F.isObject)(i)?(Object.keys(i).forEach(function(e){t.setAttribute(e,i[e]);}),this):2===n.length?(this.setAttribute(i,a),this):this.attributes[i]:this.attributes;}},{key:"getMatrix",value:function(t){var e,n,r,i=t||this.getWorldTransform(),a=G.mat4.getTranslation(ig,i),o=(0,D.default)(a,2),s=o[0],l=o[1],u=G.mat4.getScaling(ig,i),c=(0,D.default)(u,2),h=c[0],d=c[1],f=tg(ig,G.mat4.getRotation(iy,i)),v=(0,D.default)(f,3),p=v[0],g=v[2];return n=Math.cos(e=p||g),r=Math.sin(e),G.mat3.fromValues(h*n,d*r,0,-h*r,d*n,0,s,l,1);}},{key:"getLocalMatrix",value:function(){return this.getMatrix(this.getLocalTransform());}},{key:"setMatrix",value:function(t){var e=ty(t),n=(0,D.default)(e,5),r=n[0],i=n[1],a=n[2],o=n[3],s=n[4];this.setEulerAngles(s).setPosition(r,i).setLocalScale(a,o);}},{key:"setLocalMatrix",value:function(t){var e=ty(t),n=(0,D.default)(e,5),r=n[0],i=n[1],a=n[2],o=n[3],s=n[4];this.setLocalEulerAngles(s).setLocalPosition(r,i).setLocalScale(a,o);}},{key:"show",value:function(){this.forEach(function(t){t.style.visibility="visible";});}},{key:"hide",value:function(){this.forEach(function(t){t.style.visibility="hidden";});}},{key:"getCount",value:function(){return this.childElementCount;}},{key:"getParent",value:function(){return this.parentElement;}},{key:"getChildren",value:function(){return this.children;}},{key:"getFirst",value:function(){return this.firstElementChild;}},{key:"getLast",value:function(){return this.lastElementChild;}},{key:"getChildByIndex",value:function(t){return this.children[t]||null;}},{key:"add",value:function(t,e){return this.appendChild(t,e);}},{key:"set",value:function(t,e){this.config[t]=e;}},{key:"get",value:function(t){return this.config[t];}},{key:"moveTo",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(t,e,n),this;}},{key:"move",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(t,e,n),this;}},{key:"setZIndex",value:function(t){return this.style.zIndex=t,this;}}]);}(ih);im.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","display","draggable","droppable","fill","fillOpacity","fillRule","filter","increasedLineWidthForHitTesting","lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit","hitArea","offsetDistance","offsetPath","offsetX","offsetY","opacity","pointerEvents","shadowColor","shadowType","shadowBlur","shadowOffsetX","shadowOffsetY","stroke","strokeOpacity","strokeWidth","strokeLinecap","strokeLineJoin","strokeDasharray","strokeDashoffset","transform","transformOrigin","textTransform","visibility","zIndex"]);var ik=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.CIRCLE},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(im);ik.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(im.PARSED_STYLE_LIST),["cx","cy","cz","r","isBillboard","isSizeAttenuation"]));var iE=["style"];(function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iE);return(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({style:r},i)])).isCustomElement=!0,t;}return(0,I.default)(e,t),(0,R.default)(e);})(im).PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var ix=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.ELLIPSE},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(im);ix.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(im.PARSED_STYLE_LIST),["cx","cy","cz","rx","ry","isBillboard","isSizeAttenuation"])),function(t){function e(){return(0,C.default)(this,e),(0,L.default)(this,e,[{type:j.FRAGMENT}]);}return(0,I.default)(e,t),(0,R.default)(e);}(im).PARSED_STYLE_LIST=new Set(["class","className"]);var iT=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.GROUP},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(im);iT.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var iN=["style"],ib=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iN);return(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({type:j.HTML,style:r},i)])).cullable.enable=!1,t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getDomElement",value:function(){return this.parsedStyle.$el;}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()];}},{key:"getLocalBounds",value:function(){if(this.parentNode){var t=G.mat4.invert(G.mat4.create(),this.parentNode.getWorldTransform()),e=this.getBounds();if(!tr.isEmpty(e)){var n=new tr;return n.setFromTransformedAABB(e,t),n;}}return this.getBounds();}}]);}(im);ib.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(im.PARSED_STYLE_LIST),["x","y","$el","innerHTML","width","height"]));var iS=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.IMAGE},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(im);iS.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(im.PARSED_STYLE_LIST),["x","y","z","src","width","height","isBillboard","billboardRotation","isSizeAttenuation","keepAspectRatio"]));var iw=["style"],iP=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iw);(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({type:j.LINE,style:(0,A.default)({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},r)},i)])).markerStartAngle=0,t.markerEndAngle=0;var a=t.parsedStyle,o=a.markerStart,s=a.markerEnd;return o&&id(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),s&&id(s)&&(t.markerEndAngle=s.getLocalEulerAngles(),t.appendChild(s)),t.transformMarker(!0),t.transformMarker(!1),t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"x1"===t||"y1"===t||"x2"===t||"y2"===t||"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&id(r)&&(this.markerStartAngle=0,r.remove()),i&&id(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t&&(r&&id(r)&&(this.markerEndAngle=0,r.remove()),i&&id(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1)));}},{key:"transformMarker",value:function(t){var e,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,h=s.markerEndOffset,d=s.x1,f=s.x2,v=s.y1,p=s.y2,g=t?l:u;if(g&&id(g)){var y=0;t?(r=d,i=v,e=f-d,n=p-v,a=c||0,o=this.markerStartAngle):(r=f,i=p,e=d-f,n=v-p,a=h||0,o=this.markerEndAngle),y=Math.atan2(n,e),g.setLocalEulerAngles(180*y/Math.PI+o),g.setLocalPosition(r+Math.cos(y)*a,i+Math.sin(y)*a);}}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle,r=n.x1,i=n.y1,a=n.x2,o=n.y2,s=(0,z.linePointAt)(r,i,a,o,t),l=s.x,u=s.y,c=G.vec3.transformMat4(G.vec3.create(),G.vec3.fromValues(l,u,0),e?this.getWorldTransform():this.getLocalTransform());return new ts(c[0],c[1]);}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(t/this.getTotalLength(),e);}},{key:"getTotalLength",value:function(){var t=this.parsedStyle,e=t.x1,n=t.y1,r=t.x2,i=t.y2;return(0,z.lineLength)(e,n,r,i);}}]);}(im);iP.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(im.PARSED_STYLE_LIST),["x1","y1","x2","y2","z1","z2","isBillboard","isSizeAttenuation","markerStart","markerEnd","markerStartOffset","markerEndOffset"]));var iM=["style"],iA=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iM);(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({type:j.PATH,style:r,initialParsedStyle:{miterLimit:4,d:(0,A.default)({},tD)}},i)])).markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var a=t.parsedStyle,o=a.markerStart,s=a.markerEnd,l=a.markerMid;return o&&id(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),l&&id(l)&&t.placeMarkerMid(l),s&&id(s)&&(t.markerEndAngle=s.getLocalEulerAngles(),t.appendChild(s)),t.transformMarker(!0),t.transformMarker(!1),t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"d"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&id(r)&&(this.markerStartAngle=0,r.remove()),i&&id(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t?(r&&id(r)&&(this.markerEndAngle=0,r.remove()),i&&id(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(i);}},{key:"transformMarker",value:function(t){var e,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,h=s.markerEndOffset,d=t?l:u;if(d&&id(d)){var f=0;if(t){var v=this.getStartTangent(),p=(0,D.default)(v,2),g=p[0],y=p[1];r=y[0],i=y[1],e=g[0]-y[0],n=g[1]-y[1],a=c||0,o=this.markerStartAngle;}else{var m=this.getEndTangent(),k=(0,D.default)(m,2),E=k[0],x=k[1];r=x[0],i=x[1],e=E[0]-x[0],n=E[1]-x[1],a=h||0,o=this.markerEndAngle;}f=Math.atan2(n,e),d.setLocalEulerAngles(180*f/Math.PI+o),d.setLocalPosition(r+Math.cos(f)*a,i+Math.sin(f)*a);}}},{key:"placeMarkerMid",value:function(t){var e=this.parsedStyle.d.segments;if(this.markerMidList.forEach(function(t){t.remove();}),t&&id(t))for(var n=1;n<e.length-1;n++){var r=(0,D.default)(e[n].currentPoint,2),i=r[0],a=r[1],o=1===n?t:t.cloneNode(!0);this.markerMidList.push(o),this.appendChild(o),o.setLocalPosition(i,a);}}},{key:"getTotalLength",value:function(){return e9(this);}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle.d.absolutePath,r=(0,F.getPointAtLength)(n,t),i=r.x,a=r.y,o=G.vec3.transformMat4(G.vec3.create(),G.vec3.fromValues(i,a,0),e?this.getWorldTransform():this.getLocalTransform());return new ts(o[0],o[1]);}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPointAtLength(t*e9(this),e);}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.d.segments,e=[];if(t.length>1){var n=t[0].currentPoint,r=t[1].currentPoint,i=t[1].startTangent;e=[],i?e.push([n[0]-i[0],n[1]-i[1]]):e.push([r[0],r[1]]),e.push([n[0],n[1]]);}return e;}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.d.segments,e=t.length,n=[];if(e>1){var r=t[e-2].currentPoint,i=t[e-1].currentPoint,a=t[e-1].endTangent;n=[],a?n.push([i[0]-a[0],i[1]-a[1]]):n.push([r[0],r[1]]),n.push([i[0],i[1]]);}return n;}}]);}(im);iA.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(im.PARSED_STYLE_LIST),["d","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard","isSizeAttenuation"]));var iC=["style"],iR=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iC);(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({type:j.POLYGON,style:r,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},i)])).markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var a=t.parsedStyle,o=a.markerStart,s=a.markerEnd,l=a.markerMid;return o&&id(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),l&&id(l)&&t.placeMarkerMid(l),s&&id(s)&&(t.markerEndAngle=s.getLocalEulerAngles(),t.appendChild(s)),t.transformMarker(!0),t.transformMarker(!1),t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"points"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&id(r)&&(this.markerStartAngle=0,r.remove()),i&&id(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t?(r&&id(r)&&(this.markerEndAngle=0,r.remove()),i&&id(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(i);}},{key:"transformMarker",value:function(t){var e,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,h=s.markerEndOffset,d=(s.points||{}).points,f=t?l:u;if(f&&id(f)&&d){var v=0;if(r=d[0][0],i=d[0][1],t)e=d[1][0]-d[0][0],n=d[1][1]-d[0][1],a=c||0,o=this.markerStartAngle;else{var p=d.length;this.parsedStyle.isClosed?(e=d[p-1][0]-d[0][0],n=d[p-1][1]-d[0][1]):(r=d[p-1][0],i=d[p-1][1],e=d[p-2][0]-d[p-1][0],n=d[p-2][1]-d[p-1][1]),a=h||0,o=this.markerEndAngle;}v=Math.atan2(n,e),f.setLocalEulerAngles(180*v/Math.PI+o),f.setLocalPosition(r+Math.cos(v)*a,i+Math.sin(v)*a);}}},{key:"placeMarkerMid",value:function(t){var e=(this.parsedStyle.points||{}).points;if(this.markerMidList.forEach(function(t){t.remove();}),this.markerMidList=[],t&&id(t)&&e)for(var n=1;n<(this.parsedStyle.isClosed?e.length:e.length-1);n++){var r=e[n][0],i=e[n][1],a=1===n?t:t.cloneNode(!0);this.markerMidList.push(a),this.appendChild(a),a.setLocalPosition(r,i);}}}]);}(im);iR.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(im.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isClosed","isBillboard","isSizeAttenuation"]));var iO=["style"],iL=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.style,r=(0,q.default)(t,iO);return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.POLYLINE,style:n,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},r)]);}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getTotalLength",value:function(){return 0===this.parsedStyle.points.totalLength&&(this.parsedStyle.points.totalLength=(0,z.polylineLength)(this.parsedStyle.points.points)),this.parsedStyle.points.totalLength;}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(t/this.getTotalLength(),e);}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle.points.points;if(0===this.parsedStyle.points.segments.length){var r,i,a=[],o=0,s=this.getTotalLength();n.forEach(function(t,e){n[e+1]&&((r=[0,0])[0]=o/s,i=(0,z.lineLength)(t[0],t[1],n[e+1][0],n[e+1][1]),o+=i,r[1]=o/s,a.push(r));}),this.parsedStyle.points.segments=a;}var l=0,u=0;this.parsedStyle.points.segments.forEach(function(e,n){t>=e[0]&&t<=e[1]&&(l=(t-e[0])/(e[1]-e[0]),u=n);});var c=(0,z.linePointAt)(n[u][0],n[u][1],n[u+1][0],n[u+1][1],l),h=c.x,d=c.y,f=G.vec3.transformMat4(G.vec3.create(),G.vec3.fromValues(h,d,0),e?this.getWorldTransform():this.getLocalTransform());return new ts(f[0],f[1]);}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.points.points,e=[];return e.push([t[1][0],t[1][1]]),e.push([t[0][0],t[0][1]]),e;}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.points.points,e=t.length-1,n=[];return n.push([t[e-1][0],t[e-1][1]]),n.push([t[e][0],t[e][1]]),n;}}]);}(iR);iL.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iR.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard"]));var iI=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.RECT},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(im);iI.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(im.PARSED_STYLE_LIST),["x","y","z","width","height","isBillboard","isSizeAttenuation","radius"]));var iD=["style"],i_=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.style,r=(0,q.default)(t,iD);return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.TEXT,style:(0,A.default)({fill:"black"},n)},r)]);}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getComputedTextLength",value:function(){var t;return this.getGeometryBounds(),(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.maxLineWidth)||0;}},{key:"getLineBoundingRects",value:function(){var t;return this.getGeometryBounds(),(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.lineMetrics)||[];}},{key:"isOverflowing",value:function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing;}}]);}(im);i_.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(im.PARSED_STYLE_LIST),["x","y","z","isBillboard","billboardRotation","isSizeAttenuation","text","textAlign","textBaseline","fontStyle","fontSize","fontFamily","fontWeight","fontVariant","lineHeight","letterSpacing","leading","wordWrap","wordWrapWidth","maxLines","textOverflow","isOverflowing","textPath","textDecorationLine","textDecorationColor","textDecorationStyle","textDecorationThickness","textPathSide","textPathStartOffset","metrics","dx","dy"])),(0,R.default)(function t(){(0,C.default)(this,t),this.registry={},this.define(j.CIRCLE,ik),this.define(j.ELLIPSE,ix),this.define(j.RECT,iI),this.define(j.IMAGE,iS),this.define(j.LINE,iP),this.define(j.GROUP,iT),this.define(j.PATH,iA),this.define(j.POLYGON,iR),this.define(j.POLYLINE,iL),this.define(j.TEXT,i_),this.define(j.HTML,ib);},[{key:"define",value:function(t,e){this.registry[t]=e;}},{key:"get",value:function(t){return this.registry[t];}}]),function(){function t(e){(0,C.default)(this,t),this.strategies=e;}return(0,R.default)(t,[{key:"apply",value:function(e){var n=e.config,r=e.camera,i=e.renderingService,a=e.renderingContext,o=this.strategies;i.hooks.cull.tap(t.tag,function(t){if(t){var e,i=t.cullable;if(0===o.length?i.visible=a.unculledEntities.indexOf(t.entity)>-1:i.visible=o.every(function(e){return e.isVisible(r,t);}),!t.isCulled()&&t.isVisible())return t;var s=(null===(e=n.future)||void 0===e?void 0:e.experimentalCancelEventPropagation)===!0;return t.dispatchEvent(new rI(rU.CULLED),s,s),null;}return t;}),i.hooks.afterRender.tap(t.tag,function(t){t.cullable.visibilityPlaneMask=-1;});}}]);}().tag="Culling",function(){function t(){var e=this;(0,C.default)(this,t),this.autoPreventDefault=!1,this.rootPointerEvent=new rO(null),this.rootWheelEvent=new rL(null),this.onPointerMove=function(t){var n=null===(r=e.context.renderingContext.root)||void 0===r||null===(r=r.ownerDocument)||void 0===r?void 0:r.defaultView;if(!n.supportsTouchEvents||"touch"!==t.pointerType){var r,i,a=e.normalizeToPointerEvent(t,n),o=(0,W.default)(a);try{for(o.s();!(i=o.n()).done;){var s=i.value,l=e.bootstrapEvent(e.rootPointerEvent,s,n,t);e.context.eventService.mapEvent(l);}}catch(t){o.e(t);}finally{o.f();}e.setCursor(e.context.eventService.cursor);}},this.onClick=function(t){var n,r,i=null===(n=e.context.renderingContext.root)||void 0===n||null===(n=n.ownerDocument)||void 0===n?void 0:n.defaultView,a=e.normalizeToPointerEvent(t,i),o=(0,W.default)(a);try{for(o.s();!(r=o.n()).done;){var s=r.value,l=e.bootstrapEvent(e.rootPointerEvent,s,i,t);e.context.eventService.mapEvent(l);}}catch(t){o.e(t);}finally{o.f();}e.setCursor(e.context.eventService.cursor);};}return(0,R.default)(t,[{key:"apply",value:function(e){var n=this;this.context=e;var r=e.renderingService,i=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler(function(t){return n.context.renderingService.hooks.pickSync.call({position:t,picked:[],topmost:!0}).picked[0]||null;}),r.hooks.pointerWheel.tap(t.tag,function(t){var e=n.normalizeWheelEvent(t);n.context.eventService.mapEvent(e);}),r.hooks.pointerDown.tap(t.tag,function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){var e=n.normalizeToPointerEvent(t,i);n.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();var r,a=(0,W.default)(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=n.bootstrapEvent(n.rootPointerEvent,o,i,t);n.context.eventService.mapEvent(s);}}catch(t){a.e(t);}finally{a.f();}n.setCursor(n.context.eventService.cursor);}}),r.hooks.pointerUp.tap(t.tag,function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){var e,r=n.context.contextService.getDomElement(),a=n.context.eventService.isNativeEventFromCanvas(r,t)?"":"outside",o=n.normalizeToPointerEvent(t,i),s=(0,W.default)(o);try{for(s.s();!(e=s.n()).done;){var l=e.value,u=n.bootstrapEvent(n.rootPointerEvent,l,i,t);u.type+=a,n.context.eventService.mapEvent(u);}}catch(t){s.e(t);}finally{s.f();}n.setCursor(n.context.eventService.cursor);}}),r.hooks.pointerMove.tap(t.tag,this.onPointerMove),r.hooks.pointerOver.tap(t.tag,this.onPointerMove),r.hooks.pointerOut.tap(t.tag,this.onPointerMove),r.hooks.click.tap(t.tag,this.onClick),r.hooks.pointerCancel.tap(t.tag,function(t){var e,r=n.normalizeToPointerEvent(t,i),a=(0,W.default)(r);try{for(a.s();!(e=a.n()).done;){var o=e.value,s=n.bootstrapEvent(n.rootPointerEvent,o,i,t);n.context.eventService.mapEvent(s);}}catch(t){a.e(t);}finally{a.f();}n.setCursor(n.context.eventService.cursor);});}},{key:"bootstrapEvent",value:function(t,e,n,r){t.view=n,t.originalEvent=null,t.nativeEvent=r,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);var i=this.context.eventService.client2Viewport({x:e.clientX,y:e.clientY}),a=i.x,o=i.y;t.viewport.x=a,t.viewport.y=o;var s=this.context.eventService.viewport2Canvas(t.viewport),l=s.x,u=s.y;return t.canvas.x=l,t.canvas.y=u,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=r.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=nJ[t.type]||t.type),t;}},{key:"normalizeWheelEvent",value:function(t){var e=this.rootWheelEvent;this.transferMouseData(e,t),e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;var n=this.context.eventService.client2Viewport({x:t.clientX,y:t.clientY}),r=n.x,i=n.y;e.viewport.x=r,e.viewport.y=i;var a=this.context.eventService.viewport2Canvas(e.viewport),o=a.x,s=a.y;return e.canvas.x=o,e.canvas.y=s,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.nativeEvent=t,e.type=t.type,e;}},{key:"transferMouseData",value:function(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=n0.now(),t.type=e.type,t.altKey=e.altKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.ctrlKey=e.ctrlKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.screen.x=e.screenX,t.screen.y=e.screenY,t.relatedTarget=null;}},{key:"setCursor",value:function(t){this.context.contextService.applyCursorStyle(t||this.context.config.cursor||"default");}},{key:"normalizeToPointerEvent",value:function(t,e){var n=[];if(e.isTouchEvent(t))for(var r=0;r<t.changedTouches.length;r++){var i=t.changedTouches[r];(0,F.isUndefined)(i.button)&&(i.button=0),(0,F.isUndefined)(i.buttons)&&(i.buttons=1),(0,F.isUndefined)(i.isPrimary)&&(i.isPrimary=1===t.touches.length&&"touchstart"===t.type),(0,F.isUndefined)(i.width)&&(i.width=i.radiusX||1),(0,F.isUndefined)(i.height)&&(i.height=i.radiusY||1),(0,F.isUndefined)(i.tiltX)&&(i.tiltX=0),(0,F.isUndefined)(i.tiltY)&&(i.tiltY=0),(0,F.isUndefined)(i.pointerType)&&(i.pointerType="touch"),(0,F.isUndefined)(i.pointerId)&&(i.pointerId=i.identifier||0),(0,F.isUndefined)(i.pressure)&&(i.pressure=i.force||.5),(0,F.isUndefined)(i.twist)&&(i.twist=0),(0,F.isUndefined)(i.tangentialPressure)&&(i.tangentialPressure=0),i.isNormalized=!0,i.type=t.type,n.push(i);}else e.isMouseEvent(t)&&((0,F.isUndefined)(t.isPrimary)&&(t.isPrimary=!0),(0,F.isUndefined)(t.width)&&(t.width=1),(0,F.isUndefined)(t.height)&&(t.height=1),(0,F.isUndefined)(t.tiltX)&&(t.tiltX=0),(0,F.isUndefined)(t.tiltY)&&(t.tiltY=0),(0,F.isUndefined)(t.pointerType)&&(t.pointerType="mouse"),(0,F.isUndefined)(t.pointerId)&&(t.pointerId=1),(0,F.isUndefined)(t.pressure)&&(t.pressure=.5),(0,F.isUndefined)(t.twist)&&(t.twist=0),(0,F.isUndefined)(t.tangentialPressure)&&(t.tangentialPressure=0),t.isNormalized=!0),n.push(t);return n;}}]);}().tag="Event";var iG=[j.CIRCLE,j.ELLIPSE,j.IMAGE,j.RECT,j.LINE,j.POLYLINE,j.POLYGON,j.TEXT,j.PATH,j.HTML];(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"isVisible",value:function(t,e){var n,r=e.cullable;if(!r.enable)return!0;var i=e.getRenderBounds();if(tr.isEmpty(i))return!1;var a=t.getFrustum(),o=null===(n=e.parentNode)||void 0===n||null===(n=n.cullable)||void 0===n?void 0:n.visibilityPlaneMask;return r.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(e,i,o||ta.INDETERMINATE,a.planes),r.visible=r.visibilityPlaneMask!==ta.OUTSIDE,r.visible;}},{key:"computeVisibilityWithPlaneMask",value:function(t,e,n,r){if(n===ta.OUTSIDE||n===ta.INSIDE)return n;for(var i=ta.INSIDE,a=iG.indexOf(t.nodeName)>-1,o=0,s=r.length;o<s;++o){var l=1<<o;if((n&l)!=0&&(!a||4!==o&&5!==o)){var u=r[o],c=u.normal,h=u.distance;if(G.vec3.dot(c,e.getPositiveFarPoint(r[o]))+h<0)return ta.OUTSIDE;G.vec3.dot(c,e.getNegativeFarPoint(r[o]))+h<0&&(i|=l);}}return i;}}]),function(){function t(){(0,C.default)(this,t),this.mutationRecords=[],this.isFirstTimeRendering=!0,this.isFirstTimeRenderingFinished=!1;}return(0,R.default)(t,[{key:"apply",value:function(e){var n,r=this,i=e.renderingService,a=e.renderingContext.root.ownerDocument.defaultView,o=function(t){i.dirty();},s=function(t){var e,n=t.detail;(e=r.mutationRecords).push.apply(e,(0,O.default)(n)),i.dirty();},l=function(t){var e=t.target;ii.enableSizeAttenuation&&ii.styleValueRegistry.updateSizeAttenuation(e,a.getCamera().getZoom());},u=function(t){var e=t.target;ii.sceneGraphService.dirtyToRoot(e),i.dirty();};i.hooks.init.tap(t.tag,function(){a.addEventListener(rU.MOUNTED,l),a.addEventListener(rU.UNMOUNTED,u),a.addEventListener(rU.ATTR_MODIFIED,o),a.addEventListener(rU.BOUNDS_CHANGED,s);}),i.hooks.destroy.tap(t.tag,function(){a.removeEventListener(rU.MOUNTED,l),a.removeEventListener(rU.UNMOUNTED,u),a.removeEventListener(rU.ATTR_MODIFIED,o),a.removeEventListener(rU.BOUNDS_CHANGED,s),r.mutationRecords=[];});var c=null!==(n=ii.globalThis.requestIdleCallback)&&void 0!==n?n:rt.bind(ii.globalThis);i.hooks.endFrame.tap(t.tag,function(){r.isFirstTimeRendering&&(r.isFirstTimeRendering=!1,c(function(){r.isFirstTimeRenderingFinished=!0;})),r.mutationRecords=[];});}}]);}().tag="Prepare";var iF=((P={}).READY="ready",P.BEFORE_RENDER="beforerender",P.RERENDER="rerender",P.AFTER_RENDER="afterrender",P.BEFORE_DESTROY="beforedestroy",P.AFTER_DESTROY="afterdestroy",P.RESIZE="resize",P.DIRTY_RECTANGLE="dirtyrectangle",P.RENDERER_CHANGED="rendererchanged",P);new rI(rU.MOUNTED),new rI(rU.UNMOUNTED),new rI(iF.BEFORE_RENDER),new rI(iF.RERENDER),new rI(iF.AFTER_RENDER);},cb5b484b:function(t,e,n){"use strict";n.d(e,"__esModule",{value:!0}),n.e(e,{AbstractRendererPlugin:function(){return K;},DisplayObject:function(){return ix;},ElementEvent:function(){return rH;},GradientType:function(){return ey;},OffscreenCanvasCreator:function(){return rB;},Shape:function(){return j;},UnitType:function(){return ea;},computeLinearGradient:function(){return eL;},computeRadialGradient:function(){return eI;},parseTransform:function(){return nk;},parsedTransformToMat4:function(){return rE;}});var r,i,a,o,s,l,u,c,h,d,f,v,p,g,y,m,k,E,x,T,N,b,S,w,P,M=n("777fffbe"),A=M._(n("ab297151")),C=M._(n("b1a4abb6")),R=M._(n("72ce8fb5")),O=M._(n("d60881d0")),L=M._(n("0b95a4d2")),I=M._(n("0afdccfb")),D=M._(n("7465ab36")),_=M._(n("32f41e1c")),G=n("597fa39f");n("f90e84e3");var F=n("abe9d8d6"),B=M._(n("3214ccb5")),U=M._(n("51ffafbb")),V=M._(n("3c7f532e")),z=n("b1a96927"),H=M._(n("2fabd5d4")),Y=M._(n("cb203630")),W=M._(n("1982f763")),q=M._(n("01aac514"));let X=n("1714eebe");var j=((r={}).GROUP="g",r.FRAGMENT="fragment",r.CIRCLE="circle",r.ELLIPSE="ellipse",r.IMAGE="image",r.RECT="rect",r.LINE="line",r.POLYLINE="polyline",r.POLYGON="polygon",r.TEXT="text",r.PATH="path",r.HTML="html",r.MESH="mesh",r),$=((i={})[i.ZERO=0]="ZERO",i[i.NEGATIVE_ONE=1]="NEGATIVE_ONE",i),K=(0,R.default)(function t(){(0,C.default)(this,t),this.plugins=[];},[{key:"addRenderingPlugin",value:function(t){this.plugins.push(t),this.context.renderingPlugins.push(t);}},{key:"removeAllRenderingPlugins",value:function(){var t=this;this.plugins.forEach(function(e){var n=t.context.renderingPlugins.indexOf(e);n>=0&&t.context.renderingPlugins.splice(n,1);});}}]),Z=G.vec3.add,Q=G.vec3.copy,J=G.vec3.max,tt=G.vec3.min,te=G.vec3.scale,tn=G.vec3.sub,tr=function(){function t(){(0,C.default)(this,t),this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0];}return(0,R.default)(t,[{key:"update",value:function(t,e){Q(this.center,t),Q(this.halfExtents,e),tn(this.min,this.center,this.halfExtents),Z(this.max,this.center,this.halfExtents);}},{key:"setMinMax",value:function(t,e){Z(this.center,e,t),te(this.center,this.center,.5),tn(this.halfExtents,e,t),te(this.halfExtents,this.halfExtents,.5),Q(this.min,t),Q(this.max,e);}},{key:"getMin",value:function(){return this.min;}},{key:"getMax",value:function(){return this.max;}},{key:"add",value:function(e){if(!t.isEmpty(e)){if(t.isEmpty(this)){this.setMinMax(e.getMin(),e.getMax());return;}var n=this.center,r=n[0],i=n[1],a=n[2],o=this.halfExtents,s=o[0],l=o[1],u=o[2],c=r-s,h=r+s,d=i-l,f=i+l,v=a-u,p=a+u,g=e.center,y=g[0],m=g[1],k=g[2],E=e.halfExtents,x=E[0],T=E[1],N=E[2],b=y-x,S=y+x,w=m-T,P=m+T,M=k-N,A=k+N;b<c&&(c=b),S>h&&(h=S),w<d&&(d=w),P>f&&(f=P),M<v&&(v=M),A>p&&(p=A),n[0]=(c+h)*.5,n[1]=(d+f)*.5,n[2]=(v+p)*.5,o[0]=(h-c)*.5,o[1]=(f-d)*.5,o[2]=(p-v)*.5,this.min[0]=c,this.min[1]=d,this.min[2]=v,this.max[0]=h,this.max[1]=f,this.max[2]=p;}}},{key:"setFromTransformedAABB",value:function(t,e){var n=this.center,r=this.halfExtents,i=t.center,a=t.halfExtents,o=e[0],s=e[4],l=e[8],u=e[1],c=e[5],h=e[9],d=e[2],f=e[6],v=e[10],p=Math.abs(o),g=Math.abs(s),y=Math.abs(l),m=Math.abs(u),k=Math.abs(c),E=Math.abs(h),x=Math.abs(d),T=Math.abs(f),N=Math.abs(v);n[0]=e[12]+o*i[0]+s*i[1]+l*i[2],n[1]=e[13]+u*i[0]+c*i[1]+h*i[2],n[2]=e[14]+d*i[0]+f*i[1]+v*i[2],r[0]=p*a[0]+g*a[1]+y*a[2],r[1]=m*a[0]+k*a[1]+E*a[2],r[2]=x*a[0]+T*a[1]+N*a[2],tn(this.min,n,r),Z(this.max,n,r);}},{key:"intersects",value:function(t){var e=this.getMax(),n=this.getMin(),r=t.getMax(),i=t.getMin();return n[0]<=r[0]&&e[0]>=i[0]&&n[1]<=r[1]&&e[1]>=i[1]&&n[2]<=r[2]&&e[2]>=i[2];}},{key:"intersection",value:function(e){if(!this.intersects(e))return null;var n=new t,r=J([0,0,0],this.getMin(),e.getMin()),i=tt([0,0,0],this.getMax(),e.getMax());return n.setMinMax(r,i),n;}},{key:"getNegativeFarPoint",value:function(t){return 273===t.pnVertexFlag?Q([0,0,0],this.min):272===t.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:257===t.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:256===t.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:17===t.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:16===t.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:1===t.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]];}},{key:"getPositiveFarPoint",value:function(t){return 273===t.pnVertexFlag?Q([0,0,0],this.max):272===t.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:257===t.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:256===t.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:17===t.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:16===t.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:1===t.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]];}}],[{key:"isEmpty",value:function(t){return!t||0===t.halfExtents[0]&&0===t.halfExtents[1]&&0===t.halfExtents[2];}}]);}(),ti=(0,R.default)(function t(e,n){(0,C.default)(this,t),this.distance=e||0,this.normal=n||G.vec3.fromValues(0,1,0),this.updatePNVertexFlag();},[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(Number(this.normal[0]>=0)<<8)+(Number(this.normal[1]>=0)<<4)+Number(this.normal[2]>=0);}},{key:"distanceToPoint",value:function(t){return G.vec3.dot(t,this.normal)-this.distance;}},{key:"normalize",value:function(){var t=1/G.vec3.len(this.normal);G.vec3.scale(this.normal,this.normal,t),this.distance*=t;}},{key:"intersectsLine",value:function(t,e,n){var r=this.distanceToPoint(t),i=r/(r-this.distanceToPoint(e)),a=i>=0&&i<=1;return a&&n&&G.vec3.lerp(n,t,e,i),a;}}]),ta=((a={})[a.OUTSIDE=4294967295]="OUTSIDE",a[a.INSIDE=0]="INSIDE",a[a.INDETERMINATE=2147483647]="INDETERMINATE",a),to=(0,R.default)(function t(e){if((0,C.default)(this,t),this.planes=[],e)this.planes=e;else for(var n=0;n<6;n++)this.planes.push(new ti);},[{key:"extractFromVPMatrix",value:function(t){var e=(0,D.default)(t,16),n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],v=e[12],p=e[13],g=e[14],y=e[15];G.vec3.set(this.planes[0].normal,a-n,u-o,f-c),this.planes[0].distance=y-v,G.vec3.set(this.planes[1].normal,a+n,u+o,f+c),this.planes[1].distance=y+v,G.vec3.set(this.planes[2].normal,a+r,u+s,f+h),this.planes[2].distance=y+p,G.vec3.set(this.planes[3].normal,a-r,u-s,f-h),this.planes[3].distance=y-p,G.vec3.set(this.planes[4].normal,a-i,u-l,f-d),this.planes[4].distance=y-g,G.vec3.set(this.planes[5].normal,a+i,u+l,f+d),this.planes[5].distance=y+g,this.planes.forEach(function(t){t.normalize(),t.updatePNVertexFlag();});}}]),ts=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,C.default)(this,t),this.x=0,this.y=0,this.x=e,this.y=n;}return(0,R.default)(t,[{key:"clone",value:function(){return new t(this.x,this.y);}},{key:"copyFrom",value:function(t){this.x=t.x,this.y=t.y;}}]);}(),tl=function(){function t(e,n,r,i){(0,C.default)(this,t),this.x=e,this.y=n,this.width=r,this.height=i,this.left=e,this.right=e+r,this.top=n,this.bottom=n+i;}return(0,R.default)(t,[{key:"toJSON",value:function(){}}],[{key:"fromRect",value:function(e){return new t(e.x,e.y,e.width,e.height);}},{key:"applyTransform",value:function(e,n){var r=G.vec4.fromValues(e.x,e.y,0,1),i=G.vec4.fromValues(e.x+e.width,e.y,0,1),a=G.vec4.fromValues(e.x,e.y+e.height,0,1),o=G.vec4.fromValues(e.x+e.width,e.y+e.height,0,1),s=G.vec4.create(),l=G.vec4.create(),u=G.vec4.create(),c=G.vec4.create();G.vec4.transformMat4(s,r,n),G.vec4.transformMat4(l,i,n),G.vec4.transformMat4(u,a,n),G.vec4.transformMat4(c,o,n);var h=Math.min(s[0],l[0],u[0],c[0]),d=Math.min(s[1],l[1],u[1],c[1]),f=Math.max(s[0],l[0],u[0],c[0]),v=Math.max(s[1],l[1],u[1],c[1]);return t.fromRect({x:h,y:d,width:f-h,height:v-d});}}]);}(),tu="Method not implemented.";function tc(t){return void 0===t?0:t>360||t<-360?t%360:t;}var th=G.vec3.create();function td(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];return Array.isArray(t)&&3===t.length?r?G.vec3.clone(t):G.vec3.copy(th,t):(0,F.isNumber)(t)?r?G.vec3.fromValues(t,e,n):G.vec3.set(th,t,e,n):r?G.vec3.fromValues(t[0],t[1]||e,t[2]||n):G.vec3.set(th,t[0],t[1]||e,t[2]||n);}var tf=Math.PI/180,tv=180/Math.PI,tp=Math.PI/2;function tg(t,e){var n,r,i,a,o,s,l,u,c,h,d,f,v,p,g,y,m;return 16===e.length?(i=G.mat4.getScaling(G.vec3.create(),e),o=(a=(0,D.default)(i,3))[0],s=a[1],l=a[2],(u=Math.asin(-e[2]/o))<tp?u>-tp?(n=Math.atan2(e[6]/s,e[10]/l),r=Math.atan2(e[1]/o,e[0]/o)):(r=0,n=-Math.atan2(e[4]/s,e[5]/s)):(r=0,n=Math.atan2(e[4]/s,e[5]/s)),t[0]=n,t[1]=u,t[2]=r):(c=e[0],h=e[1],d=e[2],f=e[3],y=c*c+(v=h*h)+(p=d*d)+(g=f*f),(m=c*f-h*d)>.499995*y?(t[0]=tp,t[1]=2*Math.atan2(h,c),t[2]=0):m<-.499995*y?(t[0]=-tp,t[1]=2*Math.atan2(h,c),t[2]=0):(t[0]=Math.asin(2*(c*d-f*h)),t[1]=Math.atan2(2*(c*f+h*d),1-2*(p+g)),t[2]=Math.atan2(2*(c*h+d*f),1-2*(v+p)))),t;}function ty(t){var e=t[0],n=t[1],r=t[3],i=t[4],a=Math.sqrt(e*e+n*n),o=Math.sqrt(r*r+i*i);if(e*i-n*r<0&&(e<i?a=-a:o=-o),a){var s=1/a;e*=s,n*=s;}if(o){var l=1/o;r*=l,i*=l;}var u=Math.atan2(n,e)*tv;return[t[6],t[7],a,o,u];}var tm=G.mat4.create(),tk=G.mat4.create(),tE=G.vec4.create(),tx=[G.vec3.create(),G.vec3.create(),G.vec3.create()],tT=G.vec3.create();function tN(t,e,n,r,i){t[0]=e[0]*r+n[0]*i,t[1]=e[1]*r+n[1]*i,t[2]=e[2]*r+n[2]*i;}var tb=((o={})[o.ORBITING=0]="ORBITING",o[o.EXPLORING=1]="EXPLORING",o[o.TRACKING=2]="TRACKING",o),tS=((s={})[s.DEFAULT=0]="DEFAULT",s[s.ROTATIONAL=1]="ROTATIONAL",s[s.TRANSLATIONAL=2]="TRANSLATIONAL",s[s.CINEMATIC=3]="CINEMATIC",s),tw=((l={})[l.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",l[l.PERSPECTIVE=1]="PERSPECTIVE",l),tP={UPDATED:"updated"},tM=(0,R.default)(function t(){(0,C.default)(this,t),this.clipSpaceNearZ=$.NEGATIVE_ONE,this.eventEmitter=new _.default,this.matrix=G.mat4.create(),this.right=G.vec3.fromValues(1,0,0),this.up=G.vec3.fromValues(0,1,0),this.forward=G.vec3.fromValues(0,0,1),this.position=G.vec3.fromValues(0,0,1),this.focalPoint=G.vec3.fromValues(0,0,0),this.distanceVector=G.vec3.fromValues(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=G.mat4.create(),this.projectionMatrixInverse=G.mat4.create(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=tb.EXPLORING,this.trackingMode=tS.DEFAULT,this.projectionMode=tw.PERSPECTIVE,this.frustum=new to,this.orthoMatrix=G.mat4.create();},[{key:"isOrtho",value:function(){return this.projectionMode===tw.ORTHOGRAPHIC;}},{key:"getProjectionMode",value:function(){return this.projectionMode;}},{key:"getPerspective",value:function(){return this.jitteredProjectionMatrix||this.projectionMatrix;}},{key:"getPerspectiveInverse",value:function(){return this.projectionMatrixInverse;}},{key:"getFrustum",value:function(){return this.frustum;}},{key:"getPosition",value:function(){return this.position;}},{key:"getFocalPoint",value:function(){return this.focalPoint;}},{key:"getDollyingStep",value:function(){return this.dollyingStep;}},{key:"getNear",value:function(){return this.near;}},{key:"getFar",value:function(){return this.far;}},{key:"getZoom",value:function(){return this.zoom;}},{key:"getOrthoMatrix",value:function(){return this.orthoMatrix;}},{key:"getView",value:function(){return this.view;}},{key:"setEnableUpdate",value:function(t){this.enableUpdate=t;}},{key:"setType",value:function(t,e){return this.type=t,this.type===tb.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===tb.TRACKING&&void 0!==e&&this.setTrackingMode(e),this;}},{key:"setProjectionMode",value:function(t){return this.projectionMode=t,this;}},{key:"setTrackingMode",value:function(t){if(this.type!==tb.TRACKING)throw Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=t,this;}},{key:"setWorldRotation",value:function(t){return this.rotateWorld=t,this._getAngles(),this;}},{key:"getViewTransform",value:function(){return G.mat4.invert(G.mat4.create(),this.matrix);}},{key:"getWorldTransform",value:function(){return this.matrix;}},{key:"jitterProjectionMatrix",value:function(t,e){var n=G.mat4.fromTranslation(G.mat4.create(),[t,e,0]);this.jitteredProjectionMatrix=G.mat4.multiply(G.mat4.create(),n,this.projectionMatrix);}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0;}},{key:"setMatrix",value:function(t){return this.matrix=t,this._update(),this;}},{key:"setProjectionMatrix",value:function(t){this.projectionMatrix=t;}},{key:"setFov",value:function(t){return this.setPerspective(this.near,this.far,t,this.aspect),this;}},{key:"setAspect",value:function(t){return this.setPerspective(this.near,this.far,this.fov,t),this;}},{key:"setNear",value:function(t){return this.projectionMode===tw.PERSPECTIVE?this.setPerspective(t,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,t,this.far),this;}},{key:"setFar",value:function(t){return this.projectionMode===tw.PERSPECTIVE?this.setPerspective(this.near,t,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,t),this;}},{key:"setViewOffset",value:function(t,e,n,r,i,a){return this.aspect=t/e,void 0===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.projectionMode===tw.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this;}},{key:"clearViewOffset",value:function(){return void 0!==this.view&&(this.view.enabled=!1),this.projectionMode===tw.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this;}},{key:"setZoom",value:function(t){return this.zoom=t,this.projectionMode===tw.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===tw.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this;}},{key:"setZoomByViewportPoint",value:function(t,e){var n=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),r=n.x,i=n.y,a=this.roll;this.rotate(0,0,-a),this.setPosition(r,i),this.setFocalPoint(r,i),this.setZoom(t),this.rotate(0,0,a);var o=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),s=o.x,l=o.y,u=G.vec3.fromValues(s-r,l-i,0),c=G.vec3.dot(u,this.right)/G.vec3.length(this.right),h=G.vec3.dot(u,this.up)/G.vec3.length(this.up),d=this.getPosition(),f=(0,D.default)(d,2),v=f[0],p=f[1],g=this.getFocalPoint(),y=(0,D.default)(g,2),m=y[0],k=y[1];return this.setPosition(v-c,p-h),this.setFocalPoint(m-c,k-h),this;}},{key:"setPerspective",value:function(t,e,n,r){this.projectionMode=tw.PERSPECTIVE,this.fov=n,this.near=t,this.far=e,this.aspect=r;var i,a=this.near*Math.tan(.5*this.fov*tf)/this.zoom,o=2*a,s=this.aspect*o,l=-.5*s;if(null!==(i=this.view)&&void 0!==i&&i.enabled){var u=this.view.fullWidth,c=this.view.fullHeight;l+=this.view.offsetX*s/u,a-=this.view.offsetY*o/c,s*=this.view.width/u,o*=this.view.height/c;}return!function(t,e,n,r,i,a,o){var s,l,u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=2*a,h=n-e,d=r-i,f=o-a,v=o*a;u?(s=-o/f,l=-v/f):(s=-(o+a)/f,l=-2*v/f),t[0]=c/h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c/d,t[6]=0,t[7]=0,t[8]=(n+e)/h,t[9]=(r+i)/d,t[10]=s,t[11]=-1,t[12]=0,t[13]=0,t[14]=l,t[15]=0;}(this.projectionMatrix,l,l+s,a-o,a,t,this.far,this.clipSpaceNearZ===$.ZERO),G.mat4.invert(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this;}},{key:"setOrthographic",value:function(t,e,n,r,i,a){this.projectionMode=tw.ORTHOGRAPHIC,this.rright=e,this.left=t,this.top=n,this.bottom=r,this.near=i,this.far=a;var o,s=(this.rright-this.left)/(2*this.zoom),l=(this.top-this.bottom)/(2*this.zoom),u=(this.rright+this.left)/2,c=(this.top+this.bottom)/2,h=u-s,d=u+s,f=c+l,v=c-l;if(null!==(o=this.view)&&void 0!==o&&o.enabled){var p=(this.rright-this.left)/this.view.fullWidth/this.zoom,g=(this.top-this.bottom)/this.view.fullHeight/this.zoom;h+=p*this.view.offsetX,d=h+p*this.view.width,f-=g*this.view.offsetY,v=f-g*this.view.height;}return this.clipSpaceNearZ===$.NEGATIVE_ONE?G.mat4.ortho(this.projectionMatrix,h,d,f,v,i,a):G.mat4.orthoZO(this.projectionMatrix,h,d,f,v,i,a),G.mat4.invert(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this;}},{key:"setPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.position[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.position[2],r=td(t,e,n);return this._setPosition(r),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this;}},{key:"setFocalPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.focalPoint[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.focalPoint[2],r=G.vec3.fromValues(0,1,0);if(this.focalPoint=td(t,e,n),this.trackingMode===tS.CINEMATIC){var i=G.vec3.subtract(G.vec3.create(),this.focalPoint,this.position);t=i[0],e=i[1],n=i[2];var a=Math.asin(e/G.vec3.length(i))*tv,o=90+Math.atan2(n,t)*tv,s=G.mat4.create();G.mat4.rotateY(s,s,o*tf),G.mat4.rotateX(s,s,a*tf),r=G.vec3.transformMat4(G.vec3.create(),[0,1,0],s);}return G.mat4.invert(this.matrix,G.mat4.lookAt(G.mat4.create(),this.position,this.focalPoint,r)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this;}},{key:"getDistance",value:function(){return this.distance;}},{key:"getDistanceVector",value:function(){return this.distanceVector;}},{key:"setDistance",value:function(t){if(this.distance===t||t<0)return this;this.distance=t,this.distance<2e-4&&(this.distance=2e-4),this.dollyingStep=this.distance/100;var e=G.vec3.create();t=this.distance;var n=this.forward,r=this.focalPoint;return e[0]=t*n[0]+r[0],e[1]=t*n[1]+r[1],e[2]=t*n[2]+r[2],this._setPosition(e),this.triggerUpdate(),this;}},{key:"setMaxDistance",value:function(t){return this.maxDistance=t,this;}},{key:"setMinDistance",value:function(t){return this.minDistance=t,this;}},{key:"setAzimuth",value:function(t){return this.azimuth=tc(t),this.computeMatrix(),this._getAxes(),this.type===tb.ORBITING||this.type===tb.EXPLORING?this._getPosition():this.type===tb.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getAzimuth",value:function(){return this.azimuth;}},{key:"setElevation",value:function(t){return this.elevation=tc(t),this.computeMatrix(),this._getAxes(),this.type===tb.ORBITING||this.type===tb.EXPLORING?this._getPosition():this.type===tb.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getElevation",value:function(){return this.elevation;}},{key:"setRoll",value:function(t){return this.roll=tc(t),this.computeMatrix(),this._getAxes(),this.type===tb.ORBITING||this.type===tb.EXPLORING?this._getPosition():this.type===tb.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getRoll",value:function(){return this.roll;}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate();}},{key:"computeMatrix",value:function(){var t=G.quat.setAxisAngle(G.quat.create(),[0,0,1],this.roll*tf);G.mat4.identity(this.matrix);var e=G.quat.setAxisAngle(G.quat.create(),[1,0,0],(this.rotateWorld&&this.type!==tb.TRACKING||this.type===tb.TRACKING?1:-1)*this.elevation*tf),n=G.quat.setAxisAngle(G.quat.create(),[0,1,0],(this.rotateWorld&&this.type!==tb.TRACKING||this.type===tb.TRACKING?1:-1)*this.azimuth*tf),r=G.quat.multiply(G.quat.create(),n,e);r=G.quat.multiply(G.quat.create(),r,t);var i=G.mat4.fromQuat(G.mat4.create(),r);this.type===tb.ORBITING||this.type===tb.EXPLORING?(G.mat4.translate(this.matrix,this.matrix,this.focalPoint),G.mat4.multiply(this.matrix,this.matrix,i),G.mat4.translate(this.matrix,this.matrix,[0,0,this.distance])):this.type===tb.TRACKING&&(G.mat4.translate(this.matrix,this.matrix,this.position),G.mat4.multiply(this.matrix,this.matrix,i));}},{key:"_setPosition",value:function(t,e,n){this.position=td(t,e,n);var r=this.matrix;r[12]=this.position[0],r[13]=this.position[1],r[14]=this.position[2],r[15]=1,this._getOrthoMatrix();}},{key:"_getAxes",value:function(){G.vec3.copy(this.right,td(G.vec4.transformMat4(G.vec4.create(),[1,0,0,0],this.matrix))),G.vec3.copy(this.up,td(G.vec4.transformMat4(G.vec4.create(),[0,1,0,0],this.matrix))),G.vec3.copy(this.forward,td(G.vec4.transformMat4(G.vec4.create(),[0,0,1,0],this.matrix))),G.vec3.normalize(this.right,this.right),G.vec3.normalize(this.up,this.up),G.vec3.normalize(this.forward,this.forward);}},{key:"_getAngles",value:function(){var t=this.distanceVector[0],e=this.distanceVector[1],n=this.distanceVector[2],r=G.vec3.length(this.distanceVector);if(0===r){this.elevation=0,this.azimuth=0;return;}this.type===tb.TRACKING?(this.elevation=Math.asin(e/r)*tv,this.azimuth=Math.atan2(-t,-n)*tv):this.rotateWorld?(this.elevation=Math.asin(e/r)*tv,this.azimuth=Math.atan2(-t,-n)*tv):(this.elevation=-(Math.asin(e/r)*tv),this.azimuth=-(Math.atan2(-t,-n)*tv));}},{key:"_getPosition",value:function(){G.vec3.copy(this.position,td(G.vec4.transformMat4(G.vec4.create(),[0,0,0,1],this.matrix))),this._getDistance();}},{key:"_getFocalPoint",value:function(){G.vec3.transformMat3(this.distanceVector,[0,0,-this.distance],G.mat3.fromMat4(G.mat3.create(),this.matrix)),G.vec3.add(this.focalPoint,this.position,this.distanceVector),this._getDistance();}},{key:"_getDistance",value:function(){this.distanceVector=G.vec3.subtract(G.vec3.create(),this.focalPoint,this.position),this.distance=G.vec3.length(this.distanceVector),this.dollyingStep=this.distance/100;}},{key:"_getOrthoMatrix",value:function(){if(this.projectionMode===tw.ORTHOGRAPHIC){var t=this.position,e=G.quat.setAxisAngle(G.quat.create(),[0,0,1],-this.roll*Math.PI/180);G.mat4.fromRotationTranslationScaleOrigin(this.orthoMatrix,e,G.vec3.fromValues((this.rright-this.left)/2-t[0],(this.top-this.bottom)/2-t[1],0),G.vec3.fromValues(this.zoom,this.zoom,1),t);}}},{key:"triggerUpdate",value:function(){if(this.enableUpdate){var t=this.getViewTransform(),e=G.mat4.multiply(G.mat4.create(),this.getPerspective(),t);this.getFrustum().extractFromVPMatrix(e),this.eventEmitter.emit(tP.UPDATED);}}},{key:"rotate",value:function(t,e,n){throw Error(tu);}},{key:"pan",value:function(t,e){throw Error(tu);}},{key:"dolly",value:function(t){throw Error(tu);}},{key:"createLandmark",value:function(t,e){throw Error(tu);}},{key:"gotoLandmark",value:function(t,e){throw Error(tu);}},{key:"cancelLandmarkAnimation",value:function(){throw Error(tu);}}]),tA=((u={})[u.Standard=0]="Standard",u),tC=((c={})[c.ADDED=0]="ADDED",c[c.REMOVED=1]="REMOVED",c[c.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED",c),tR=G.vec3.create(),tO=G.mat4.create(),tL=G.quat.create();function tI(t){if(t.localDirtyFlag){if(0!==t.localSkew[0]||0!==t.localSkew[1]){G.mat4.fromRotationTranslationScaleOrigin(t.localTransform,t.localRotation,t.localPosition,G.vec3.fromValues(1,1,1),t.origin),(0!==t.localSkew[0]||0!==t.localSkew[1])&&(G.mat4.identity(tO),tO[4]=Math.tan(t.localSkew[0]),tO[1]=Math.tan(t.localSkew[1]),G.mat4.multiply(t.localTransform,t.localTransform,tO));var e=G.mat4.fromRotationTranslationScaleOrigin(tO,G.quat.set(tL,0,0,0,1),G.vec3.set(tR,1,1,1),t.localScale,t.origin);G.mat4.multiply(t.localTransform,t.localTransform,e);}else{var n=t.localTransform,r=t.localPosition,i=t.localRotation,a=t.localScale,o=t.origin,s=0!==r[0]||0!==r[1]||0!==r[2],l=1!==i[3]||0!==i[0]||0!==i[1]||0!==i[2],u=1!==a[0]||1!==a[1]||1!==a[2],c=0!==o[0]||0!==o[1]||0!==o[2];l||u||c?G.mat4.fromRotationTranslationScaleOrigin(n,i,r,a,o):s?G.mat4.fromTranslation(n,r):G.mat4.identity(n);}t.localDirtyFlag=!1;}}var tD={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new tl(0,0,0,0)},t_=((h={}).COORDINATE="<coordinate>",h.COLOR="<color>",h.PAINT="<paint>",h.NUMBER="<number>",h.ANGLE="<angle>",h.OPACITY_VALUE="<opacity-value>",h.SHADOW_BLUR="<shadow-blur>",h.LENGTH="<length>",h.PERCENTAGE="<percentage>",h.LENGTH_PERCENTAGE="<length> | <percentage>",h.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",h.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",h.LIST_OF_POINTS="<list-of-points>",h.PATH="<path>",h.FILTER="<filter>",h.Z_INDEX="<z-index>",h.OFFSET_DISTANCE="<offset-distance>",h.DEFINED_PATH="<defined-path>",h.MARKER="<marker>",h.TRANSFORM="<transform>",h.TRANSFORM_ORIGIN="<transform-origin>",h.TEXT="<text>",h.TEXT_TRANSFORM="<text-transform>",h);function tG(t,e,n){t.prototype=e.prototype=n,n.constructor=t;}function tF(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n;}function tB(){}var tU="\\s*([+-]?\\d+)\\s*",tV="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",tz="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",tH=/^#([0-9a-f]{3,8})$/,tY=RegExp(`^rgb\\(${tU},${tU},${tU}\\)$`),tW=RegExp(`^rgb\\(${tz},${tz},${tz}\\)$`),tq=RegExp(`^rgba\\(${tU},${tU},${tU},${tV}\\)$`),tX=RegExp(`^rgba\\(${tz},${tz},${tz},${tV}\\)$`),tj=RegExp(`^hsl\\(${tV},${tz},${tz}\\)$`),t$=RegExp(`^hsla\\(${tV},${tz},${tz},${tV}\\)$`),tK={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function tZ(){return this.rgb().formatHex();}function tQ(){return this.rgb().formatRgb();}function tJ(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=tH.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?t0(e):3===n?new t2(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?t1(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?t1(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=tY.exec(t))?new t2(e[1],e[2],e[3],1):(e=tW.exec(t))?new t2(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=tq.exec(t))?t1(e[1],e[2],e[3],e[4]):(e=tX.exec(t))?t1(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=tj.exec(t))?t9(e[1],e[2]/100,e[3]/100,1):(e=t$.exec(t))?t9(e[1],e[2]/100,e[3]/100,e[4]):tK.hasOwnProperty(t)?t0(tK[t]):"transparent"===t?new t2(NaN,NaN,NaN,0):null;}function t0(t){return new t2(t>>16&255,t>>8&255,255&t,1);}function t1(t,e,n,r){return r<=0&&(t=e=n=NaN),new t2(t,e,n,r);}function t2(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r;}function t3(){return`#${t7(this.r)}${t7(this.g)}${t7(this.b)}`;}function t4(){let t=t5(this.opacity);return`${1===t?"rgb(":"rgba("}${t6(this.r)}, ${t6(this.g)}, ${t6(this.b)}${1===t?")":`, ${t})`}`;}function t5(t){return isNaN(t)?1:Math.max(0,Math.min(1,t));}function t6(t){return Math.max(0,Math.min(255,Math.round(t)||0));}function t7(t){return((t=t6(t))<16?"0":"")+t.toString(16);}function t9(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new et(t,e,n,r);}function t8(t){if(t instanceof et)return new et(t.h,t.s,t.l,t.opacity);if(t instanceof tB||(t=tJ(t)),!t)return new et;if(t instanceof et)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,l=(a+i)/2;return s?(o=e===a?(n-r)/s+(n<r)*6:n===a?(r-e)/s+2:(e-n)/s+4,s/=l<.5?a+i:2-a-i,o*=60):s=l>0&&l<1?0:o,new et(o,s,l,t.opacity);}function et(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r;}function ee(t){return(t=(t||0)%360)<0?t+360:t;}function en(t){return Math.max(0,Math.min(1,t||0));}function er(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255;}function ei(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw TypeError("Expected a function");var n=function(){for(var r=arguments.length,i=Array(r),a=0;a<r;a++)i[a]=arguments[a];var o=e?e.apply(this,i):i[0],s=n.cache;if(s.has(o))return s.get(o);var l=t.apply(this,i);return n.cache=s.set(o,l)||s,l;};return n.cache=new(ei.Cache||Map),ei.cacheList.push(n.cache),n;}tG(tB,tJ,{copy(t){return Object.assign(new this.constructor,this,t);},displayable(){return this.rgb().displayable();},hex:tZ,formatHex:tZ,formatHex8:function(){return this.rgb().formatHex8();},formatHsl:function(){return t8(this).formatHsl();},formatRgb:tQ,toString:tQ}),tG(t2,function(t,e,n,r){var i;return 1==arguments.length?((i=t)instanceof tB||(i=tJ(i)),i)?new t2((i=i.rgb()).r,i.g,i.b,i.opacity):new t2:new t2(t,e,n,null==r?1:r);},tF(tB,{brighter(t){return t=null==t?1.4285714285714286:Math.pow(1.4285714285714286,t),new t2(this.r*t,this.g*t,this.b*t,this.opacity);},darker(t){return t=null==t?.7:Math.pow(.7,t),new t2(this.r*t,this.g*t,this.b*t,this.opacity);},rgb(){return this;},clamp(){return new t2(t6(this.r),t6(this.g),t6(this.b),t5(this.opacity));},displayable(){return -.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1;},hex:t3,formatHex:t3,formatHex8:function(){return`#${t7(this.r)}${t7(this.g)}${t7(this.b)}${t7((isNaN(this.opacity)?1:this.opacity)*255)}`;},formatRgb:t4,toString:t4})),tG(et,function(t,e,n,r){return 1==arguments.length?t8(t):new et(t,e,n,null==r?1:r);},tF(tB,{brighter(t){return t=null==t?1.4285714285714286:Math.pow(1.4285714285714286,t),new et(this.h,this.s,this.l*t,this.opacity);},darker(t){return t=null==t?.7:Math.pow(.7,t),new et(this.h,this.s,this.l*t,this.opacity);},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new t2(er(t>=240?t-240:t+120,i,r),er(t,i,r),er(t<120?t+240:t-120,i,r),this.opacity);},clamp(){return new et(ee(this.h),en(this.s),en(this.l),t5(this.opacity));},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1;},formatHsl(){let t=t5(this.opacity);return`${1===t?"hsl(":"hsla("}${ee(this.h)}, ${100*en(this.s)}%, ${100*en(this.l)}%${1===t?")":`, ${t})`}`;}})),ei.Cache=Map,ei.cacheList=[],ei.clearCache=function(){ei.cacheList.forEach(function(t){return t.clear();});};var ea=((d={})[d.kUnknown=0]="kUnknown",d[d.kNumber=1]="kNumber",d[d.kPercentage=2]="kPercentage",d[d.kEms=3]="kEms",d[d.kPixels=4]="kPixels",d[d.kRems=5]="kRems",d[d.kDegrees=6]="kDegrees",d[d.kRadians=7]="kRadians",d[d.kGradians=8]="kGradians",d[d.kTurns=9]="kTurns",d[d.kMilliseconds=10]="kMilliseconds",d[d.kSeconds=11]="kSeconds",d[d.kInteger=12]="kInteger",d),eo=((f={})[f.kUNumber=0]="kUNumber",f[f.kUPercent=1]="kUPercent",f[f.kULength=2]="kULength",f[f.kUAngle=3]="kUAngle",f[f.kUTime=4]="kUTime",f[f.kUOther=5]="kUOther",f),es=((v={})[v.kYes=0]="kYes",v[v.kNo=1]="kNo",v),el=((p={})[p.kYes=0]="kYes",p[p.kNo=1]="kNo",p),eu=[{name:"em",unit_type:ea.kEms},{name:"px",unit_type:ea.kPixels},{name:"deg",unit_type:ea.kDegrees},{name:"rad",unit_type:ea.kRadians},{name:"grad",unit_type:ea.kGradians},{name:"ms",unit_type:ea.kMilliseconds},{name:"s",unit_type:ea.kSeconds},{name:"rem",unit_type:ea.kRems},{name:"turn",unit_type:ea.kTurns}],ec=((g={})[g.kUnknownType=0]="kUnknownType",g[g.kUnparsedType=1]="kUnparsedType",g[g.kKeywordType=2]="kKeywordType",g[g.kUnitType=3]="kUnitType",g[g.kSumType=4]="kSumType",g[g.kProductType=5]="kProductType",g[g.kNegateType=6]="kNegateType",g[g.kInvertType=7]="kInvertType",g[g.kMinType=8]="kMinType",g[g.kMaxType=9]="kMaxType",g[g.kClampType=10]="kClampType",g[g.kTransformType=11]="kTransformType",g[g.kPositionType=12]="kPositionType",g[g.kURLImageType=13]="kURLImageType",g[g.kColorType=14]="kColorType",g[g.kUnsupportedColorType=15]="kUnsupportedColorType",g),eh=function(t){switch(t){case ea.kNumber:case ea.kInteger:return eo.kUNumber;case ea.kPercentage:return eo.kUPercent;case ea.kPixels:return eo.kULength;case ea.kMilliseconds:case ea.kSeconds:return eo.kUTime;case ea.kDegrees:case ea.kRadians:case ea.kGradians:case ea.kTurns:return eo.kUAngle;default:return eo.kUOther;}},ed=function(t){switch(t){case eo.kUNumber:return ea.kNumber;case eo.kULength:return ea.kPixels;case eo.kUPercent:return ea.kPercentage;case eo.kUTime:return ea.kSeconds;case eo.kUAngle:return ea.kDegrees;default:return ea.kUnknown;}},ef=function(t){var e=1;switch(t){case ea.kPixels:case ea.kDegrees:case ea.kSeconds:break;case ea.kMilliseconds:e=.001;break;case ea.kRadians:e=180/Math.PI;break;case ea.kGradians:e=.9;break;case ea.kTurns:e=360;}return e;},ev=function(t){switch(t){case ea.kNumber:case ea.kInteger:break;case ea.kPercentage:return"%";case ea.kEms:return"em";case ea.kRems:return"rem";case ea.kPixels:return"px";case ea.kDegrees:return"deg";case ea.kRadians:return"rad";case ea.kGradians:return"grad";case ea.kMilliseconds:return"ms";case ea.kSeconds:return"s";case ea.kTurns:return"turn";}return"";},ep=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"toString",value:function(){return this.buildCSSText(es.kNo,el.kNo,"");}},{key:"isNumericValue",value:function(){return this.getType()>=ec.kUnitType&&this.getType()<=ec.kClampType;}}],[{key:"isAngle",value:function(t){return t===ea.kDegrees||t===ea.kRadians||t===ea.kGradians||t===ea.kTurns;}},{key:"isLength",value:function(t){return t>=ea.kEms&&t<ea.kDegrees;}},{key:"isRelativeUnit",value:function(t){return t===ea.kPercentage||t===ea.kEms||t===ea.kRems;}},{key:"isTime",value:function(t){return t===ea.kSeconds||t===ea.kMilliseconds;}}]),eg=function(t){function e(t){var n;return(0,C.default)(this,e),(n=(0,L.default)(this,e)).colorSpace=t,n;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getType",value:function(){return ec.kColorType;}},{key:"to",value:function(t){return this;}}]);}(ep),ey=((y={})[y.Constant=0]="Constant",y[y.LinearGradient=1]="LinearGradient",y[y.RadialGradient=2]="RadialGradient",y),em=function(t){function e(t,n){var r;return(0,C.default)(this,e),(r=(0,L.default)(this,e)).type=t,r.value=n,r;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return new e(this.type,this.value);}},{key:"buildCSSText",value:function(t,e,n){return n;}},{key:"getType",value:function(){return ec.kColorType;}}]);}(ep),ek=function(t){function e(t){var n;return(0,C.default)(this,e),(n=(0,L.default)(this,e)).value=t,n;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return new e(this.value);}},{key:"getType",value:function(){return ec.kKeywordType;}},{key:"buildCSSText",value:function(t,e,n){return n+this.value;}}]);}(ep),eE=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(Number.isFinite(t)?"NaN":t>0?"infinity":"-infinity")+e;},ex=function(t){return ed(eh(t));},eT=function(t){function e(t){var n,r,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ea.kNumber;return(0,C.default)(this,e),r=(0,L.default)(this,e),i="string"==typeof a?(n=a)?"number"===n?ea.kNumber:"percent"===n||"%"===n?ea.kPercentage:eu.find(function(t){return t.name===n;}).unit_type:ea.kUnknown:a,r.unit=i,r.value=t,r;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return new e(this.value,this.unit);}},{key:"equals",value:function(t){return this.value===t.value&&this.unit===t.unit;}},{key:"getType",value:function(){return ec.kUnitType;}},{key:"convertTo",value:function(t){if(this.unit===t)return new e(this.value,this.unit);var n=ex(this.unit);if(n!==ex(t)||n===ea.kUnknown)return null;var r=ef(this.unit)/ef(t);return new e(this.value*r,t);}},{key:"buildCSSText",value:function(t,e,n){var r;switch(this.unit){case ea.kUnknown:break;case ea.kInteger:r=Number(this.value).toFixed(0);break;case ea.kNumber:case ea.kPercentage:case ea.kEms:case ea.kRems:case ea.kPixels:case ea.kDegrees:case ea.kRadians:case ea.kGradians:case ea.kMilliseconds:case ea.kSeconds:case ea.kTurns:var i=this.value,a=ev(this.unit);if(i<-999999||i>999999){var o=ev(this.unit);r=!Number.isFinite(i)||Number.isNaN(i)?eE(i,o):i+(o||"");}else r="".concat(i).concat(a);}return n+r;}}]);}(ep),eN=new eT(0,"px");new eT(1,"px");var eb=new eT(0,"deg"),eS=function(t){function e(t,n,r){var i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return(0,C.default)(this,e),(i=(0,L.default)(this,e,["rgb"])).r=t,i.g=n,i.b=r,i.alpha=a,i.isNone=o,i;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return new e(this.r,this.g,this.b,this.alpha);}},{key:"buildCSSText",value:function(t,e,n){return"".concat(n,"rgba(").concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")");}}]);}(eg),ew=new ek("unset"),eP={"":ew,unset:ew,initial:new ek("initial"),inherit:new ek("inherit")},eM=new eS(0,0,0,0,!0),eA=new eS(0,0,0,0),eC=ei(function(t,e,n,r){return new eS(t,e,n,r);},function(t,e,n,r){return"rgba(".concat(t,",").concat(e,",").concat(n,",").concat(r,")");}),eR=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ea.kNumber;return new eT(t,e);};new eT(50,"%");var eO=function(){var t={linearGradient:/^(linear\-gradient)/i,repeatingLinearGradient:/^(repeating\-linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,repeatingRadialGradient:/^(repeating\-radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},e="";function n(t){throw Error("".concat(e,": ").concat(t));}function r(){return i("linear-gradient",t.linearGradient,o)||i("repeating-linear-gradient",t.repeatingLinearGradient,o)||i("radial-gradient",t.radialGradient,s)||i("repeating-radial-gradient",t.repeatingRadialGradient,s)||i("conic-gradient",t.conicGradient,s);}function i(e,r,i){return a(r,function(r){var a=i();return a&&!m(t.comma)&&n("Missing comma before color stops"),{type:e,orientation:a,colorStops:d(f)};});}function a(e,r){var i=m(e);if(i){m(t.startCall)||n("Missing (");var a=r(i);return m(t.endCall)||n("Missing )"),a;}}function o(){return y("directional",t.sideOrCorner,1)||y("angular",t.angleValue,1);}function s(){var n,r,i=l();return i&&((n=[]).push(i),r=e,m(t.comma)&&((i=l())?n.push(i):e=r)),n;}function l(){var t,e,n=((t=y("shape",/^(circle)/i,0))&&(t.style=g()||u()),t||((e=y("shape",/^(ellipse)/i,0))&&(e.style=p()||u()),e));if(n)n.at=c();else{var r=u();if(r){n=r;var i=c();i&&(n.at=i);}else{var a=h();a&&(n={type:"default-radial",at:a});}}return n;}function u(){return y("extent-keyword",t.extentKeywords,1);}function c(){if(y("position",/^at/,0)){var t=h();return t||n("Missing positioning value"),t;}}function h(){var t={x:p(),y:p()};if(t.x||t.y)return{type:"position",value:t};}function d(e){var r=e(),i=[];if(r)for(i.push(r);m(t.comma);)(r=e())?i.push(r):n("One extra comma");return i;}function f(){var e=y("hex",t.hexColor,1)||a(t.rgbaColor,function(){return{type:"rgba",value:d(v)};})||a(t.rgbColor,function(){return{type:"rgb",value:d(v)};})||y("literal",t.literalColor,0);return e||n("Expected color definition"),e.length=p(),e;}function v(){return m(t.number)[1];}function p(){return y("%",t.percentageValue,1)||y("position-keyword",t.positionKeywords,1)||g();}function g(){return y("px",t.pixelValue,1)||y("em",t.emValue,1);}function y(t,e,n){var r=m(e);if(r)return{type:t,value:r[n]};}function m(t){var n=/^[\n\r\t\s]+/.exec(e);n&&k(n[0].length);var r=t.exec(e);return r&&k(r[0].length),r;}function k(t){e=e.substring(t);}return function(t){var i;return e=t,i=d(r),e.length>0&&n("Invalid input not EOF"),i;};}();function eL(t,e,n,r){var i=r.value*tf,a=0+e/2,o=0+n/2,s=Math.abs(e*Math.cos(i))+Math.abs(n*Math.sin(i));return{x1:t[0]+a-Math.cos(i)*s/2,y1:t[1]+o-Math.sin(i)*s/2,x2:t[0]+a+Math.cos(i)*s/2,y2:t[1]+o+Math.sin(i)*s/2};}function eI(t,e,n,r,i,a){var o=r.value,s=i.value;r.unit===ea.kPercentage&&(o=r.value/100*e),i.unit===ea.kPercentage&&(s=i.value/100*n);var l=Math.max((0,F.distanceSquareRoot)([0,0],[o,s]),(0,F.distanceSquareRoot)([0,n],[o,s]),(0,F.distanceSquareRoot)([e,n],[o,s]),(0,F.distanceSquareRoot)([e,0],[o,s]));return a&&(a instanceof eT?l=a.value:a instanceof ek&&("closest-side"===a.value?l=Math.min(o,e-o,s,n-s):"farthest-side"===a.value?l=Math.max(o,e-o,s,n-s):"closest-corner"===a.value&&(l=Math.min((0,F.distanceSquareRoot)([0,0],[o,s]),(0,F.distanceSquareRoot)([0,n],[o,s]),(0,F.distanceSquareRoot)([e,n],[o,s]),(0,F.distanceSquareRoot)([e,0],[o,s]))))),{x:o+t[0],y:s+t[1],r:l};}var eD=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,e_=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,eG=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,eF=/[\d.]+:(#[^\s]+|[^\)]+\))/gi,eB={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},eU=ei(function(t){return eR("angular"===t.type?Number(t.value):eB[t.value]||0,"deg");}),eV=ei(function(t){var e=50,n=50,r="%",i="%";if((null==t?void 0:t.type)==="position"){var a=t.value,o=a.x,s=a.y;(null==o?void 0:o.type)==="position-keyword"&&("left"===o.value?e=0:"center"===o.value?e=50:"right"===o.value?e=100:"top"===o.value?n=0:"bottom"===o.value&&(n=100)),(null==s?void 0:s.type)==="position-keyword"&&("left"===s.value?e=0:"center"===s.value?n=50:"right"===s.value?e=100:"top"===s.value?n=0:"bottom"===s.value&&(n=100)),((null==o?void 0:o.type)==="px"||(null==o?void 0:o.type)==="%"||(null==o?void 0:o.type)==="em")&&(r=null==o?void 0:o.type,e=Number(o.value)),((null==s?void 0:s.type)==="px"||(null==s?void 0:s.type)==="%"||(null==s?void 0:s.type)==="em")&&(i=null==s?void 0:s.type,n=Number(s.value));}return{cx:eR(e,r),cy:eR(n,i)};}),ez=ei(function(t){if(t.indexOf("linear")>-1||t.indexOf("radial")>-1)return eO(t).map(function(t){var e=t.type,n=t.orientation,r=t.colorStops;!function(t){var e=t.length;t[e-1].length=null!==(a=t[e-1].length)&&void 0!==a?a:{type:"%",value:"100"},e>1&&(t[0].length=null!==(o=t[0].length)&&void 0!==o?o:{type:"%",value:"0"});for(var n=0,r=Number(t[0].length.value),i=1;i<e;i++){var a,o,s,l=null===(s=t[i].length)||void 0===s?void 0:s.value;if(!(0,F.isNil)(l)&&!(0,F.isNil)(r)){for(var u=1;u<i-n;u++)t[n+u].length={type:"%",value:"".concat(r+(Number(l)-r)*u/(i-n))};n=i,r=Number(l);}}}(r);var i=r.map(function(t){var e,n;return{offset:eR(Number(t.length.value),"%"),color:(e=t.type,n=t.value,"hex"===e?"#".concat(n):"literal"===e?n:"rgb"===e?"rgb(".concat(n.join(","),")"):"rgba(".concat(n.join(","),")"))};});if("linear-gradient"===e)return new em(ey.LinearGradient,{angle:n?eU(n):eb,steps:i});if("radial-gradient"===e&&(n||(n=[{type:"shape",value:"circle"}]),"shape"===n[0].type&&"circle"===n[0].value)){var a,o=eV(n[0].at),s=o.cx,l=o.cy;if(n[0].style){var u=n[0].style,c=u.type,h=u.value;"extent-keyword"===c?(eP[h]||(eP[h]=new ek(h)),a=eP[h]):a=eR(h,c);}return new em(ey.RadialGradient,{cx:s,cy:l,size:a,steps:i});}});var e=t[0];if("("===t[1]||"("===t[2]){if("l"===e){var n=eD.exec(t);if(n){var r,i=(null===(r=n[2].match(eF))||void 0===r?void 0:r.map(function(t){return t.split(":");}))||[];return[new em(ey.LinearGradient,{angle:eR(parseFloat(n[1]),"deg"),steps:i.map(function(t){var e=(0,D.default)(t,2),n=e[0],r=e[1];return{offset:eR(100*Number(n),"%"),color:r};})})];}}else if("r"===e){var a=function(t){var e=e_.exec(t);if(e){var n,r=(null===(n=e[4].match(eF))||void 0===n?void 0:n.map(function(t){return t.split(":");}))||[];return{cx:eR(50,"%"),cy:eR(50,"%"),steps:r.map(function(t){var e=(0,D.default)(t,2),n=e[0],r=e[1];return{offset:eR(100*Number(n),"%"),color:r};})};}return null;}(t);if(a){if(!(0,F.isString)(a))return[new em(ey.RadialGradient,a)];t=a;}}else if("p"===e)return function(t){var e=eG.exec(t);if(e){var n=e[1],r=e[2];switch(n){case"a":n="repeat";break;case"x":n="repeat-x";break;case"y":n="repeat-y";break;default:n="no-repeat";}return{image:r,repetition:n};}return null;}(t);}});function eH(t){return t&&!(0,F.isNil)(t.r)&&!(0,F.isNil)(t.g)&&!(0,F.isNil)(t.b);}var eY=ei(function(t){if((e=t)&&e.image)return(0,A.default)({repetition:"repeat"},t);if((0,F.isNil)(t)&&(t=""),"transparent"===t)return eA;if("currentColor"===t)t="black";else if("none"===t)return eM;var e,n=ez(t);if(n)return n;var r=tJ(t),i=[0,0,0,0];return null!==r&&(i[0]=r.r||0,i[1]=r.g||0,i[2]=r.b||0,i[3]=r.opacity),eC.apply(void 0,i);});function eW(t,e){if(eH(t)&&eH(e))return[[Number(t.r),Number(t.g),Number(t.b),Number(t.alpha)],[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],function(t){var e=t.slice();if(e[3])for(var n=0;n<3;n++)e[n]=Math.round((0,F.clamp)(e[n],0,255));return e[3]=(0,F.clamp)(e[3],0,1),"rgba(".concat(e.join(","),")");}];}function eq(t,e){if((0,F.isNil)(e))return eR(0,"px");if(isFinite(Number(e="".concat(e).trim().toLowerCase()))){if("px".search(t)>=0)return eR(Number(e),"px");if("deg".search(t)>=0)return eR(Number(e),"deg");}var n=[];e=e.replace(t,function(t){return n.push(t),"U".concat(t);});var r="U(".concat(t.source,")");return n.map(function(t){return eR(Number(e.replace(RegExp("U".concat(t),"g"),"").replace(RegExp(r,"g"),"*0")),t);})[0];}var eX=function(t){return eq(/px/g,t);},ej=ei(eX);ei(function(t){return eq(RegExp("%","g"),t);});var e$=function(t){return(0,F.isNumber)(t)||isFinite(Number(t))?eR(Number(t)||0,"px"):eq(RegExp("px|%|em|rem","g"),t);},eK=ei(e$),eZ=function(t){return eq(RegExp("deg|rad|grad|turn","g"),t);},eQ=ei(eZ);function eJ(t){var e=0;return t.unit===ea.kDegrees?e=t.value:t.unit===ea.kRadians?e=Number(t.value)*tv:t.unit===ea.kTurns?e=360*Number(t.value):t.value&&(e=t.value),e;}function e0(t,e){var n;return(Array.isArray(t)?n=t.map(function(t){return Number(t);}):(0,F.isString)(t)?n=t.split(" ").map(function(t){return Number(t);}):(0,F.isNumber)(t)&&(n=[t]),2===e)?1===n.length?[n[0],n[0]]:[n[0],n[1]]:4===e?1===n.length?[n[0],n[0],n[0],n[0]]:2===n.length?[n[0],n[1],n[0],n[1]]:3===n.length?[n[0],n[1],n[2],n[1]]:[n[0],n[1],n[2],n[3]]:"even"===e&&n.length%2==1?[].concat((0,O.default)(n),(0,O.default)(n)):n;}function e1(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t.unit===ea.kPixels)return Number(t.value);if(t.unit===ea.kPercentage&&n){var i=n.nodeName===j.GROUP?n.getLocalBounds():n.getGeometryBounds();return(r?i.min[e]:0)+t.value/100*i.halfExtents[e]*2;}return 0;}var e2=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function e3(t){return t.toString();}var e4=function(t){return"number"==typeof t?eR(t):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(t)?eR(Number(t)):eR(0);},e5=ei(e4);function e6(t,e){return[t,e,e3];}function e7(t,e){return function(n,r){return[n,r,function(n){return e3((0,F.clamp)(n,t,e));}];};}function e9(t,e){if(t.length===e.length)return[t,e,function(t){return t;}];}function e8(t){return 0===t.parsedStyle.d.totalLength&&(t.parsedStyle.d.totalLength=(0,F.getTotalLength)(t.parsedStyle.d.absolutePath)),t.parsedStyle.d.totalLength;}function nt(t,e){return t[0]===e[0]&&t[1]===e[1];}function ne(t,e){var n=t.prePoint,r=t.currentPoint,i=t.nextPoint,a=Math.pow(r[0]-n[0],2)+Math.pow(r[1]-n[1],2),o=Math.pow(r[0]-i[0],2)+Math.pow(r[1]-i[1],2),s=Math.acos((a+o-(Math.pow(n[0]-i[0],2)+Math.pow(n[1]-i[1],2)))/(2*Math.sqrt(a)*Math.sqrt(o)));if(!s||0===Math.sin(s)||(0,F.isNumberEqual)(s,0))return{xExtra:0,yExtra:0};var l=Math.abs(Math.atan2(i[1]-r[1],i[0]-r[0])),u=Math.abs(Math.atan2(i[0]-r[0],i[1]-r[1]));return{xExtra:e/2*(1/Math.sin(s/2))*Math.cos(s/2-(l=l>Math.PI/2?Math.PI-l:l))-e/2||0,yExtra:e/2*(1/Math.sin(s/2))*Math.cos((u=u>Math.PI/2?Math.PI-u:u)-s/2)-e/2||0};}function nn(t,e){return[e[0]+(e[0]-t[0]),e[1]+(e[1]-t[1])];}ei(function(t){return(0,F.isString)(t)?t.split(" ").map(e5):t.map(e5);});var nr=function(t,e){var n=t.x*e.x+t.y*e.y,r=Math.sqrt((Math.pow(t.x,2)+Math.pow(t.y,2))*(Math.pow(e.x,2)+Math.pow(e.y,2)));return(t.x*e.y-t.y*e.x<0?-1:1)*Math.acos(n/r);},ni=function(t,e,n,r,i,a,o,s){e=Math.abs(e),n=Math.abs(n);var l=(r=(0,F.mod)(r,360))*tf;if(t.x===o.x&&t.y===o.y)return{x:t.x,y:t.y,ellipticalArcAngle:0};if(0===e||0===n)return{x:0,y:0,ellipticalArcAngle:0};var u=(t.x-o.x)/2,c=(t.y-o.y)/2,h={x:Math.cos(l)*u+Math.sin(l)*c,y:-Math.sin(l)*u+Math.cos(l)*c},d=Math.pow(h.x,2)/Math.pow(e,2)+Math.pow(h.y,2)/Math.pow(n,2);d>1&&(e*=Math.sqrt(d),n*=Math.sqrt(d));var f=(Math.pow(e,2)*Math.pow(n,2)-Math.pow(e,2)*Math.pow(h.y,2)-Math.pow(n,2)*Math.pow(h.x,2))/(Math.pow(e,2)*Math.pow(h.y,2)+Math.pow(n,2)*Math.pow(h.x,2)),v=(i!==a?1:-1)*Math.sqrt(f=f<0?0:f),p={x:v*(e*h.y/n),y:v*(-(n*h.x)/e)},g={x:Math.cos(l)*p.x-Math.sin(l)*p.y+(t.x+o.x)/2,y:Math.sin(l)*p.x+Math.cos(l)*p.y+(t.y+o.y)/2},y={x:(h.x-p.x)/e,y:(h.y-p.y)/n},m=nr({x:1,y:0},y),k=nr(y,{x:(-h.x-p.x)/e,y:(-h.y-p.y)/n});!a&&k>0?k-=2*Math.PI:a&&k<0&&(k+=2*Math.PI);var E=m+(k%=2*Math.PI)*s,x=e*Math.cos(E),T=n*Math.sin(E);return{x:Math.cos(l)*x-Math.sin(l)*T+g.x,y:Math.sin(l)*x+Math.cos(l)*T+g.y,ellipticalArcStartAngle:m,ellipticalArcEndAngle:m+k,ellipticalArcAngle:E,ellipticalArcCenter:g,resultantRx:e,resultantRy:n};};function na(t,e){var n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=t.arcParams,i=r.rx,a=void 0===i?0:i,o=r.ry,s=void 0===o?0:o,l=r.xRotation,u=r.arcFlag,c=r.sweepFlag,h=ni({x:t.prePoint[0],y:t.prePoint[1]},a,s,l,!!u,!!c,{x:t.currentPoint[0],y:t.currentPoint[1]},e),d=ni({x:t.prePoint[0],y:t.prePoint[1]},a,s,l,!!u,!!c,{x:t.currentPoint[0],y:t.currentPoint[1]},n?e+.005:e-.005),f=d.x-h.x,v=d.y-h.y,p=Math.sqrt(f*f+v*v);return{x:-f/p,y:-v/p};}function no(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1]);}function ns(t,e){return no(t)*no(e)?(t[0]*e[0]+t[1]*e[1])/(no(t)*no(e)):1;}function nl(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(ns(t,e));}var nu=function(t){if(""===t||Array.isArray(t)&&0===t.length)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};try{e=(0,F.normalizePath)(t);}catch(n){e=(0,F.normalizePath)(""),console.error("[g]: Invalid SVG Path definition: ".concat(t));}!function(t){for(var e=0;e<t.length;e++){var n=t[e-1],r=t[e];if("M"===r[0]&&n){var i=n[0],a=[r[1],r[2]],o=void 0;"L"===i||"M"===i?o=[n[1],n[2]]:("C"===i||"A"===i||"Q"===i)&&(o=[n[n.length-2],n[n.length-1]]),o&&nt(a,o)&&(t.splice(e,1),e--);}}}(e);var e,n=function(t){for(var e=!1,n=t.length,r=0;r<n;r++){var i=t[r][0];if("C"===i||"A"===i||"Q"===i){e=!0;break;}}return e;}(e),r=function(t){for(var e=[],n=[],r=[],i=0;i<t.length;i++){var a=t[i],o=a[0];"M"===o?(r.length&&(n.push(r),r=[]),r.push([a[1],a[2]])):"Z"===o?r.length&&(e.push(r),r=[]):r.push([a[1],a[2]]);}return r.length>0&&n.push(r),{polygons:e,polylines:n};}(e),i=r.polygons,a=r.polylines,o=function(t){for(var e=[],n=null,r=null,i=null,a=0,o=t.length,s=0;s<o;s++){var l=t[s];r=t[s+1];var u=l[0],c={command:u,prePoint:n,params:l,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(u){case"M":i=[l[1],l[2]],a=s;break;case"A":var h=function(t,e){var n=e[1],r=e[2],i=(0,F.mod)(e[3]*tf,2*Math.PI),a=e[4],o=e[5],s=t[0],l=t[1],u=e[6],c=e[7],h=Math.cos(i)*(s-u)/2+Math.sin(i)*(l-c)/2,d=-1*Math.sin(i)*(s-u)/2+Math.cos(i)*(l-c)/2,f=h*h/(n*n)+d*d/(r*r);f>1&&(n*=Math.sqrt(f),r*=Math.sqrt(f));var v=n*n*(d*d)+r*r*(h*h),p=v?Math.sqrt((n*n*(r*r)-v)/v):1;a===o&&(p*=-1),isNaN(p)&&(p=0);var g=r?p*n*d/r:0,y=n?-(p*r)*h/n:0,m=(s+u)/2+Math.cos(i)*g-Math.sin(i)*y,k=(l+c)/2+Math.sin(i)*g+Math.cos(i)*y,E=[(h-g)/n,(d-y)/r],x=[(-1*h-g)/n,(-1*d-y)/r],T=nl([1,0],E),N=nl(E,x);return -1>=ns(E,x)&&(N=Math.PI),ns(E,x)>=1&&(N=0),0===o&&N>0&&(N-=2*Math.PI),1===o&&N<0&&(N+=2*Math.PI),{cx:m,cy:k,rx:nt(t,[u,c])?0:n,ry:nt(t,[u,c])?0:r,startAngle:T,endAngle:T+N,xRotation:i,arcFlag:a,sweepFlag:o};}(n,l);c.arcParams=h;}if("Z"===u)n=i,r=t[a+1];else{var d=l.length;n=[l[d-2],l[d-1]];}r&&"Z"===r[0]&&(r=t[a],e[a]&&(e[a].prePoint=n)),c.currentPoint=n,e[a]&&nt(n,e[a].currentPoint)&&(e[a].prePoint=c.prePoint);var f=r?[r[r.length-2],r[r.length-1]]:null;c.nextPoint=f;var v=c.prePoint;if(["L","H","V"].includes(u))c.startTangent=[v[0]-n[0],v[1]-n[1]],c.endTangent=[n[0]-v[0],n[1]-v[1]];else if("Q"===u){var p=[l[1],l[2]];c.startTangent=[v[0]-p[0],v[1]-p[1]],c.endTangent=[n[0]-p[0],n[1]-p[1]];}else if("T"===u){var g=e[s-1],y=nn(g.currentPoint,v);"Q"===g.command?(c.command="Q",c.startTangent=[v[0]-y[0],v[1]-y[1]],c.endTangent=[n[0]-y[0],n[1]-y[1]]):(c.command="TL",c.startTangent=[v[0]-n[0],v[1]-n[1]],c.endTangent=[n[0]-v[0],n[1]-v[1]]);}else if("C"===u){var m=[l[1],l[2]],k=[l[3],l[4]];c.startTangent=[v[0]-m[0],v[1]-m[1]],c.endTangent=[n[0]-k[0],n[1]-k[1]],0===c.startTangent[0]&&0===c.startTangent[1]&&(c.startTangent=[m[0]-k[0],m[1]-k[1]]),0===c.endTangent[0]&&0===c.endTangent[1]&&(c.endTangent=[k[0]-m[0],k[1]-m[1]]);}else if("S"===u){var E=e[s-1],x=nn(E.currentPoint,v),T=[l[1],l[2]];"C"===E.command?(c.command="C",c.startTangent=[v[0]-x[0],v[1]-x[1]]):(c.command="SQ",c.startTangent=[v[0]-T[0],v[1]-T[1]]),c.endTangent=[n[0]-T[0],n[1]-T[1]];}else if("A"===u){var N=na(c,0),b=N.x,S=N.y,w=na(c,1,!1),P=w.x,M=w.y;c.startTangent=[b,S],c.endTangent=[P,M];}e.push(c);}return e;}(e),s=function(t,e){for(var n=[],r=[],i=[],a=0;a<t.length;a++){var o=t[a],s=o.currentPoint,l=o.params,u=o.prePoint,c=void 0;switch(o.command){case"Q":c=(0,z.quadBox)(u[0],u[1],l[1],l[2],l[3],l[4]);break;case"C":c=(0,z.cubicBox)(u[0],u[1],l[1],l[2],l[3],l[4],l[5],l[6]);break;case"A":var h=o.arcParams;c=(0,z.arcBox)(h.cx,h.cy,h.rx,h.ry,h.xRotation,h.startAngle,h.endAngle);break;default:n.push(s[0]),r.push(s[1]);}c&&(o.box=c,n.push(c.x,c.x+c.width),r.push(c.y,c.y+c.height));}n=n.filter(function(t){return!Number.isNaN(t)&&t!==1/0&&t!==-1/0;}),r=r.filter(function(t){return!Number.isNaN(t)&&t!==1/0&&t!==-1/0;});var d=(0,F.min)(n),f=(0,F.min)(r),v=(0,F.max)(n),p=(0,F.max)(r);if(0===i.length)return{x:d,y:f,width:v-d,height:p-f};for(var g=0;g<i.length;g++){var y=i[g],m=y.currentPoint;m[0]===d?d-=ne(y,0).xExtra:m[0]===v&&(v+=ne(y,0).xExtra),m[1]===f?f-=ne(y,e).yExtra:m[1]===p&&(p+=ne(y,e).yExtra);}return{x:d,y:f,width:v-d,height:p-f};}(o,0),l=s.x,u=s.y,c=s.width,h=s.height;return{absolutePath:e,hasArc:n,segments:o,polygons:i,polylines:a,totalLength:0,rect:{x:Number.isFinite(l)?l:0,y:Number.isFinite(u)?u:0,width:Number.isFinite(c)?c:0,height:Number.isFinite(h)?h:0}};},nc=ei(nu);function nh(t){return(0,F.isString)(t)?nc(t):nu(t);}function nd(t,e,n){var r=t.curve,i=e.curve;r&&0!==r.length||(r=(0,F.path2Curve)(t.absolutePath,!1),t.curve=r),i&&0!==i.length||(i=(0,F.path2Curve)(e.absolutePath,!1),e.curve=i);var a=[r,i];r.length!==i.length&&(a=(0,F.equalizeSegments)(r,i));var o=(0,F.getDrawDirection)(a[0])!==(0,F.getDrawDirection)(a[1])?(0,F.reverseCurve)(a[0]):(0,F.clonePath)(a[0]);return[o,(0,F.getRotatedCurve)(a[1],o),function(t){return t;}];}function nf(t,e){return[t.points,e.points,function(t){return t;}];}var nv=/\s*(\w+)\(([^)]*)\)/g;function np(t){return function(e){var n=0;return t.map(function(t){return null===t?e[n++]:t;});};}function ng(t){return t;}var ny={matrix:["NNNNNN",[null,null,0,0,null,null,0,0,0,0,1,0,null,null,0,1],ng],matrix3d:["NNNNNNNNNNNNNNNN",ng],rotate:["A"],rotateX:["A"],rotateY:["A"],rotateZ:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",np([null,null,new eT(1)]),ng],scaleX:["N",np([null,new eT(1),new eT(1)]),np([null,new eT(1)])],scaleY:["N",np([new eT(1),null,new eT(1)]),np([new eT(1),null])],scaleZ:["N",np([new eT(1),new eT(1),null])],scale3d:["NNN",ng],skew:["Aa",null,ng],skewX:["A",null,np([null,eb])],skewY:["A",null,np([eb,null])],translate:["Tt",np([null,null,eN]),ng],translateX:["T",np([null,eN,eN]),np([null,eN])],translateY:["T",np([eN,null,eN]),np([eN,null])],translateZ:["L",np([eN,eN,null])],translate3d:["TTL",ng]};function nm(t){for(var e=[],n=t.length,r=0;r<n;r++){var i=t[r],a=i[0],o=i.slice(1);if("translate"===a||"skew"===a?1===o.length&&o.push(0):"scale"===a&&1===o.length&&o.push(o[0]),!ny[a])return[];var s=o.map(function(t){return eR(t);});e.push({t:a,d:s});}return e;}function nk(t){if(Array.isArray(t))return nm(t);if("none"===(t=(t||"none").trim()))return[];var e,n=[],r=0;for(nv.lastIndex=0;(e=nv.exec(t))&&e.index===r;){r=e.index+e[0].length;var i=e[1],a=ny[i];if(!a)break;var o=e[2].split(","),s=a[0];if(s.length<o.length)break;for(var l=[],u=0;u<s.length;u++){var c=o[u],h=s[u],d=void 0;if(void 0===(d=c?({A:function(t){return"0"===t.trim()?eb:eQ(t);},N:e5,T:eK,L:ej})[h.toUpperCase()](c):({a:eb,n:l[0],t:eN})[h]))return[];l.push(d);}if(n.push({t:i,d:l}),nv.lastIndex===t.length)return n;}return[];}function nE(t){if(Array.isArray(t))return nm(t);if("none"===(t=(t||"none").trim()))return[];var e,n=[],r=0;for(nv.lastIndex=0;(e=nv.exec(t))&&e.index===r;){r=e.index+e[0].length;var i=e[1],a=ny[i];if(!a)break;var o=e[2].split(","),s=a[0];if(s.length<o.length)break;for(var l=[],u=0;u<s.length;u++){var c=o[u],h=s[u],d=void 0;if(void 0===(d=c?({A:function(t){return"0"===t.trim()?eb:eZ(t);},N:e4,T:e$,L:eX})[h.toUpperCase()](c):({a:eb,n:l[0],t:eN})[h]))return[];l.push(d);}if(n.push({t:i,d:l}),nv.lastIndex===t.length)return n;}return[];}function nx(t){switch(t.t){case"rotateX":return[1,0,0,0,0,Math.cos(i=eJ(t.d[0])*tf),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1];case"rotateY":return[Math.cos(i=eJ(t.d[0])*tf),0,-Math.sin(i),0,0,1,0,0,Math.sin(i),0,Math.cos(i),0,0,0,0,1];case"rotate":case"rotateZ":return[Math.cos(i=eJ(t.d[0])*tf),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1,0,0,0,0,1];case"rotate3d":e=t.d[0].value,n=t.d[1].value,r=t.d[2].value,i=eJ(t.d[3])*tf;var e,n,r,i,a=e*e+n*n+r*r;if(0===a)e=1,n=0,r=0;else if(1!==a){var o=Math.sqrt(a);e/=o,n/=o,r/=o;}var s=Math.sin(i/2),l=s*Math.cos(i/2),u=s*s;return[1-2*(n*n+r*r)*u,2*(e*n*u+r*l),2*(e*r*u-n*l),0,2*(e*n*u-r*l),1-2*(e*e+r*r)*u,2*(n*r*u+e*l),0,2*(e*r*u+n*l),2*(n*r*u-e*l),1-2*(e*e+n*n)*u,0,0,0,0,1];case"scale":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scaleX":return[t.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaleY":return[1,0,0,0,0,t.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scaleZ":return[1,0,0,0,0,1,0,0,0,0,t.d[0].value,0,0,0,0,1];case"scale3d":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,t.d[2].value,0,0,0,0,1];case"skew":var c=eJ(t.d[0])*tf;return[1,Math.tan(eJ(t.d[1])*tf),0,0,Math.tan(c),1,0,0,0,0,1,0,0,0,0,1];case"skewX":return[1,0,0,0,Math.tan(i=eJ(t.d[0])*tf),1,0,0,0,0,1,0,0,0,0,1];case"skewY":return[1,Math.tan(i=eJ(t.d[0])*tf),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return[1,0,0,0,0,1,0,0,0,0,1,0,e=e1(t.d[0],0,null)||0,n=e1(t.d[1],0,null)||0,0,1];case"translateX":return[1,0,0,0,0,1,0,0,0,0,1,0,e=e1(t.d[0],0,null)||0,0,0,1];case"translateY":return[1,0,0,0,0,1,0,0,0,0,1,0,0,n=e1(t.d[0],0,null)||0,0,1];case"translateZ":return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,r=e1(t.d[0],0,null)||0,1];case"translate3d":return[1,0,0,0,0,1,0,0,0,0,1,0,e=e1(t.d[0],0,null)||0,n=e1(t.d[1],0,null)||0,r=e1(t.d[2],0,null)||0,1];case"perspective":var h=e1(t.d[0],0,null)||0;return[1,0,0,0,0,1,0,0,0,0,1,h?-1/h:0,0,0,0,1];case"matrix":return[t.d[0].value,t.d[1].value,0,0,t.d[2].value,t.d[3].value,0,0,0,0,1,0,t.d[4].value,t.d[5].value,0,1];case"matrix3d":return t.d.map(function(t){return t.value;});}}function nT(t,e){return[t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12]*e[3],t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13]*e[3],t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]*e[3],t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15]*e[3],t[0]*e[4]+t[4]*e[5]+t[8]*e[6]+t[12]*e[7],t[1]*e[4]+t[5]*e[5]+t[9]*e[6]+t[13]*e[7],t[2]*e[4]+t[6]*e[5]+t[10]*e[6]+t[14]*e[7],t[3]*e[4]+t[7]*e[5]+t[11]*e[6]+t[15]*e[7],t[0]*e[8]+t[4]*e[9]+t[8]*e[10]+t[12]*e[11],t[1]*e[8]+t[5]*e[9]+t[9]*e[10]+t[13]*e[11],t[2]*e[8]+t[6]*e[9]+t[10]*e[10]+t[14]*e[11],t[3]*e[8]+t[7]*e[9]+t[11]*e[10]+t[15]*e[11],t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12]*e[15],t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13]*e[15],t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14]*e[15],t[3]*e[12]+t[7]*e[13]+t[11]*e[14]+t[15]*e[15]];}function nN(t){var e=[0,0,0],n=[1,1,1],r=[0,0,0],i=[0,0,0,1],a=[0,0,0,1];return!function(t,e,n,r,i,a){if(!(!function(t,e){var n=e[15];if(0===n)return!1;for(var r=1/n,i=0;i<16;i++)t[i]=e[i]*r;return!0;}(tm,t)||(G.mat4.copy(tk,tm),tk[3]=0,tk[7]=0,tk[11]=0,tk[15]=1,1e-8>Math.abs(G.mat4.determinant(tk))))){var o=tm[3],s=tm[7],l=tm[11],u=tm[12],c=tm[13],h=tm[14],d=tm[15];if(0!==o||0!==s||0!==l){if(tE[0]=o,tE[1]=s,tE[2]=l,tE[3]=d,!G.mat4.invert(tk,tk))return;G.mat4.transpose(tk,tk),G.vec4.transformMat4(i,tE,tk);}else i[0]=i[1]=i[2]=0,i[3]=1;if(e[0]=u,e[1]=c,e[2]=h,tx[0][0]=tm[0],tx[0][1]=tm[1],tx[0][2]=tm[2],tx[1][0]=tm[4],tx[1][1]=tm[5],tx[1][2]=tm[6],tx[2][0]=tm[8],tx[2][1]=tm[9],tx[2][2]=tm[10],n[0]=G.vec3.length(tx[0]),G.vec3.normalize(tx[0],tx[0]),r[0]=G.vec3.dot(tx[0],tx[1]),tN(tx[1],tx[1],tx[0],1,-r[0]),n[1]=G.vec3.length(tx[1]),G.vec3.normalize(tx[1],tx[1]),r[0]/=n[1],r[1]=G.vec3.dot(tx[0],tx[2]),tN(tx[2],tx[2],tx[0],1,-r[1]),r[2]=G.vec3.dot(tx[1],tx[2]),tN(tx[2],tx[2],tx[1],1,-r[2]),n[2]=G.vec3.length(tx[2]),G.vec3.normalize(tx[2],tx[2]),r[1]/=n[2],r[2]/=n[2],G.vec3.cross(tT,tx[1],tx[2]),0>G.vec3.dot(tx[0],tT))for(var f=0;f<3;f++)n[f]*=-1,tx[f][0]*=-1,tx[f][1]*=-1,tx[f][2]*=-1;a[0]=.5*Math.sqrt(Math.max(1+tx[0][0]-tx[1][1]-tx[2][2],0)),a[1]=.5*Math.sqrt(Math.max(1-tx[0][0]+tx[1][1]-tx[2][2],0)),a[2]=.5*Math.sqrt(Math.max(1-tx[0][0]-tx[1][1]+tx[2][2],0)),a[3]=.5*Math.sqrt(Math.max(1+tx[0][0]+tx[1][1]+tx[2][2],0)),tx[2][1]>tx[1][2]&&(a[0]=-a[0]),tx[0][2]>tx[2][0]&&(a[1]=-a[1]),tx[1][0]>tx[0][1]&&(a[2]=-a[2]);}}(0===t.length?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:t.map(nx).reduce(nT),e,n,r,i,a),[[e,n,r,a,i]];}var nb=function(){function t(t,e){for(var n=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],r=0;r<4;r++)for(var i=0;i<4;i++)for(var a=0;a<4;a++)n[r][i]+=e[r][a]*t[a][i];return n;}return function(e,n,r,i,a){for(var o,s=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],l=0;l<4;l++)s[l][3]=a[l];for(var u=0;u<3;u++)for(var c=0;c<3;c++)s[3][u]+=e[c]*s[c][u];var h=i[0],d=i[1],f=i[2],v=i[3],p=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];p[0][0]=1-2*(d*d+f*f),p[0][1]=2*(h*d-f*v),p[0][2]=2*(h*f+d*v),p[1][0]=2*(h*d+f*v),p[1][1]=1-2*(h*h+f*f),p[1][2]=2*(d*f-h*v),p[2][0]=2*(h*f-d*v),p[2][1]=2*(d*f+h*v),p[2][2]=1-2*(h*h+d*d),s=t(s,p);var g=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];r[2]&&(g[2][1]=r[2],s=t(s,g)),r[1]&&(g[2][1]=0,g[2][0]=r[0],s=t(s,g)),r[0]&&(g[2][0]=0,g[1][0]=r[0],s=t(s,g));for(var y=0;y<3;y++)for(var m=0;m<3;m++)s[y][m]*=n[y];return 0===(o=s)[0][2]&&0===o[0][3]&&0===o[1][2]&&0===o[1][3]&&0===o[2][0]&&0===o[2][1]&&1===o[2][2]&&0===o[2][3]&&0===o[3][2]&&1===o[3][3]?[s[0][0],s[0][1],s[1][0],s[1][1],s[3][0],s[3][1]]:s[0].concat(s[1],s[2],s[3]);};}();function nS(t){return t.toFixed(6).replace(".000000","");}function nw(t,e){var n,r;return(t.decompositionPair!==e&&(t.decompositionPair=e,n=nN(t)),e.decompositionPair!==t&&(e.decompositionPair=t,r=nN(e)),null===n[0]||null===r[0])?[[!1],[!0],function(n){return n?e[0].d:t[0].d;}]:(n[0].push(0),r[0].push(1),[n,r,function(t){var e=function(t,e,n){var r=function(t,e){for(var n=0,r=0;r<t.length;r++)n+=t[r]*e[r];return n;}(t,e);r=(0,F.clamp)(r,-1,1);var i=[];if(1===r)i=t;else for(var a=Math.acos(r),o=1*Math.sin(n*a)/Math.sqrt(1-r*r),s=0;s<4;s++)i.push(t[s]*(Math.cos(n*a)-r*o)+e[s]*o);return i;}(n[0][3],r[0][3],t[5]);return nb(t[0],t[1],t[2],e,t[4]).map(nS).join(",");}]);}function nP(t){return t.replace(/[XY]/,"");}function nM(t){return t.replace(/(X|Y|Z|3d)?$/,"3d");}function nA(t,e,n){var r=!1;if(!t.length||!e.length){t.length||(r=!0,t=e,e=[]);for(var i=0;i<t.length;i++)!function(){var n=t[i],r=n.t,a=n.d,o="scale"===r.substring(0,5)?1:0;e.push({t:r,d:a.map(function(t){return"number"==typeof t?eR(o):eR(o,t.unit);})});}();}var a=[],o=[],s=[];if(t.length!==e.length){var l=nw(t,e);a=[l[0]],o=[l[1]],s=[["matrix",[l[2]]]];}else for(var u=0;u<t.length;u++){var c=t[u].t,h=e[u].t,d=t[u].d,f=e[u].d,v=ny[c],p=ny[h],g=void 0;if("perspective"===c&&"perspective"===h||("matrix"===c||"matrix3d"===c)&&("matrix"===h||"matrix3d"===h)){var y=nw([t[u]],[e[u]]);a.push(y[0]),o.push(y[1]),s.push(["matrix",[y[2]]]);continue;}if(c===h)g=c;else if(v[2]&&p[2]&&nP(c)===nP(h))g=nP(c),d=v[2](d),f=p[2](f);else if(v[1]&&p[1]&&nM(c)===nM(h))g=nM(c),d=v[1](d),f=p[1](f);else{var m=nw(t,e);a=[m[0]],o=[m[1]],s=[["matrix",[m[2]]]];break;}for(var k=[],E=[],x=[],T=0;T<d.length;T++){var N=function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a="",o=t.value||0,s=e.value||0,l=ex(t.unit),u=t.convertTo(l),c=e.convertTo(l);return u&&c?(o=u.value,s=c.value,a=ev(t.unit)):(eT.isLength(t.unit)||eT.isLength(e.unit))&&(o=e1(t,i,n),s=e1(e,i,n),a="px"),[o,s,function(t){return r&&(t=Math.max(t,0)),t+a;}];}(d[T],f[T],n,!1,T);k[T]=N[0],E[T]=N[1],x.push(N[2]);}a.push(k),o.push(E),s.push([g,x]);}if(r){var b=a;a=o,o=b;}return[a,o,function(t){return t.map(function(t,e){var n=t.map(function(t,n){return s[e][1][n](t);}).join(",");return"matrix"===s[e][0]&&16===n.split(",").length&&(s[e][0]="matrix3d"),"matrix3d"===s[e][0]&&6===n.split(",").length&&(s[e][0]="matrix"),"".concat(s[e][0],"(").concat(n,")");}).join(" ");}];}var nC=ei(function(t){if((0,F.isString)(t)){if("text-anchor"===t)return[eR(0,"px"),eR(0,"px")];var e=t.split(" ");return(1===e.length&&("top"===e[0]||"bottom"===e[0]?(e[1]=e[0],e[0]="center"):e[1]="center"),2!==e.length)?null:[eK(nR(e[0])),eK(nR(e[1]))];}return[eR(t[0]||0,"px"),eR(t[1]||0,"px")];});function nR(t){return"center"===t?"50%":"left"===t||"top"===t?"0%":"right"===t||"bottom"===t?"100%":t;}var nO=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:t_.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:t_.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:t_.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:t_.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:t_.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:t_.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:t_.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:t_.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:t_.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:t_.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:t_.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:t_.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:t_.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:t_.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:t_.FILTER},{n:"clipPath",syntax:t_.DEFINED_PATH},{n:"textPath",syntax:t_.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:t_.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:t_.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:t_.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:t_.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:t_.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:t_.COORDINATE},{n:"y1",int:!0,l:!0,syntax:t_.COORDINATE},{n:"z1",int:!0,l:!0,syntax:t_.COORDINATE},{n:"x2",int:!0,l:!0,syntax:t_.COORDINATE},{n:"y2",int:!0,l:!0,syntax:t_.COORDINATE},{n:"z2",int:!0,l:!0,syntax:t_.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:t_.PATH,p:50},{n:"points",int:!0,l:!0,syntax:t_.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:t_.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:t_.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:t_.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:t_.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:t_.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:t_.NUMBER,d:function(t){return t===j.PATH||t===j.POLYGON||t===j.POLYLINE?"4":"10";}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:t_.MARKER},{n:"markerEnd",syntax:t_.MARKER},{n:"markerMid",syntax:t_.MARKER},{n:"markerStartOffset",syntax:t_.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:t_.LENGTH,l:!0,int:!0,d:"0"}],nL=new Set(nO.filter(function(t){return!!t.l;}).map(function(t){return t.n;})),nI={},nD=(0,R.default)(function t(e){var n=this;(0,C.default)(this,t),this.runtime=e,nO.forEach(function(t){n.registerMetadata(t);});},[{key:"registerMetadata",value:function(t){[t.n].concat((0,O.default)(t.a||[])).forEach(function(e){nI[e]=t;});}},{key:"getPropertySyntax",value:function(t){return this.runtime.CSSPropertySyntaxFactory[t];}},{key:"processProperties",value:function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[],memoize:!0};Object.assign(t.attributes,e);var i=t.parsedStyle.clipPath,a=t.parsedStyle.offsetPath;!function(t,e){var n=n_(t);for(var r in e)n.has(r)&&(t.parsedStyle[r]=e[r]);}(t,e);var o=!!r.forceUpdateGeometry;if(!o){for(var s in e)if(nL.has(s)){o=!0;break;}}var l=n_(t);l.has("fill")&&e.fill&&(t.parsedStyle.fill=eY(e.fill)),l.has("stroke")&&e.stroke&&(t.parsedStyle.stroke=eY(e.stroke)),l.has("shadowColor")&&e.shadowColor&&(t.parsedStyle.shadowColor=eY(e.shadowColor)),l.has("filter")&&e.filter&&(t.parsedStyle.filter=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if("none"===(e=e.toLowerCase().trim()))return[];for(var n=/\s*([\w-]+)\(([^)]*)\)/g,r=[],i=0;(t=n.exec(e))&&t.index===i;)if(i=t.index+t[0].length,e2.indexOf(t[1])>-1&&r.push({name:t[1],params:t[2].split(" ").map(function(t){return eq(/deg|rad|grad|turn|px|%/g,t)||eY(t);})}),n.lastIndex===e.length)return r;return[];}(e.filter)),l.has("radius")&&!(0,F.isNil)(e.radius)&&(t.parsedStyle.radius=e0(e.radius,4)),l.has("lineDash")&&!(0,F.isNil)(e.lineDash)&&(t.parsedStyle.lineDash=e0(e.lineDash,"even")),l.has("points")&&e.points&&(t.parsedStyle.points=(n=e.points,{points:(0,F.isString)(n)?n.split(" ").map(function(t){var e=t.split(","),n=(0,D.default)(e,2),r=n[0],i=n[1];return[Number(r),Number(i)];}):n,totalLength:0,segments:[]})),l.has("d")&&""===e.d&&(t.parsedStyle.d=(0,A.default)({},tD)),l.has("d")&&e.d&&(t.parsedStyle.d=nh(e.d)),l.has("textTransform")&&e.textTransform&&this.runtime.CSSPropertySyntaxFactory[t_.TEXT_TRANSFORM].calculator(null,null,{value:e.textTransform},t,null),l.has("clipPath")&&!(0,F.isUndefined)(e.clipPath)&&this.runtime.CSSPropertySyntaxFactory[t_.DEFINED_PATH].calculator("clipPath",i,e.clipPath,t,this.runtime),l.has("offsetPath")&&e.offsetPath&&this.runtime.CSSPropertySyntaxFactory[t_.DEFINED_PATH].calculator("offsetPath",a,e.offsetPath,t,this.runtime),l.has("transform")&&e.transform&&(t.parsedStyle.transform=nk(e.transform)),l.has("transformOrigin")&&e.transformOrigin&&(t.parsedStyle.transformOrigin=nC(e.transformOrigin)),l.has("markerStart")&&e.markerStart&&(t.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory[t_.MARKER].calculator(null,e.markerStart,e.markerStart,null,null)),l.has("markerEnd")&&e.markerEnd&&(t.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory[t_.MARKER].calculator(null,e.markerEnd,e.markerEnd,null,null)),l.has("markerMid")&&e.markerMid&&(t.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory[t_.MARKER].calculator("",e.markerMid,e.markerMid,null,null)),l.has("zIndex")&&!(0,F.isNil)(e.zIndex)&&this.runtime.CSSPropertySyntaxFactory[t_.Z_INDEX].postProcessor(t),l.has("offsetDistance")&&!(0,F.isNil)(e.offsetDistance)&&this.runtime.CSSPropertySyntaxFactory[t_.OFFSET_DISTANCE].postProcessor(t),l.has("transform")&&e.transform&&this.runtime.CSSPropertySyntaxFactory[t_.TRANSFORM].postProcessor(t),l.has("transformOrigin")&&e.transformOrigin&&this.runtime.CSSPropertySyntaxFactory[t_.TRANSFORM_ORIGIN].postProcessor(t),o&&(t.dirty(!0,!0),r.forceUpdateGeometry||this.runtime.sceneGraphService.dirtyToRoot(t));}},{key:"updateGeometry",value:function(t){var e=t.nodeName,n=this.runtime.geometryUpdaterFactory[e];if(n){var r=t.geometry;r.contentBounds||(r.contentBounds=new tr),r.renderBounds||(r.renderBounds=new tr);var i=t.parsedStyle,a=n.update(i,t),o=a.cx,s=a.cy,l=a.cz,u=a.hwidth,c=void 0===u?0:u,h=a.hheight,d=void 0===h?0:h,f=a.hdepth,v=[Math.abs(c),Math.abs(d),void 0===f?0:f],p=i.stroke,g=i.lineWidth,y=i.increasedLineWidthForHitTesting,m=i.shadowType,k=void 0===m?"outer":m,E=i.shadowColor,x=i.filter,T=i.transformOrigin,N=[void 0===o?0:o,void 0===s?0:s,void 0===l?0:l];r.contentBounds.update(N,v);var b=e===j.POLYLINE||e===j.POLYGON||e===j.PATH?Math.SQRT2:.5;if(p&&!p.isNone){var S=(((void 0===g?1:g)||0)+((void 0===y?0:y)||0))*b;v[0]+=S,v[1]+=S;}if(r.renderBounds.update(N,v),E&&k&&"inner"!==k){var w=r.renderBounds,P=w.min,M=w.max,A=i.shadowBlur,C=i.shadowOffsetX,R=i.shadowOffsetY,O=A||0,L=C||0,I=R||0,D=P[0]-O+L,_=M[0]+O+L,F=P[1]-O+I,B=M[1]+O+I;P[0]=Math.min(P[0],D),M[0]=Math.max(M[0],_),P[1]=Math.min(P[1],F),M[1]=Math.max(M[1],B),r.renderBounds.setMinMax(P,M);}(void 0===x?[]:x).forEach(function(t){var e=t.name,n=t.params;if("blur"===e){var i=n[0].value;r.renderBounds.update(r.renderBounds.center,G.vec3.add(r.renderBounds.halfExtents,r.renderBounds.halfExtents,[i,i,0]));}else if("drop-shadow"===e){var a=n[0].value,o=n[1].value,s=n[2].value,l=r.renderBounds,u=l.min,c=l.max,h=u[0]-s+a,d=c[0]+s+a,f=u[1]-s+o,v=c[1]+s+o;u[0]=Math.min(u[0],h),c[0]=Math.max(c[0],d),u[1]=Math.min(u[1],f),c[1]=Math.max(c[1],v),r.renderBounds.setMinMax(u,c);}}),t.geometry.dirty=!1;var U=d<0,V=(c<0?-1:1)*(T?e1(T[0],0,t,!0):0),z=(U?-1:1)*(T?e1(T[1],1,t,!0):0);(V||z)&&t.setOrigin(V,z);}}},{key:"updateSizeAttenuation",value:function(t,e){t.style.isSizeAttenuation?(t.style.rawLineWidth||(t.style.rawLineWidth=t.style.lineWidth),t.style.lineWidth=(t.style.rawLineWidth||1)/e,t.nodeName===j.CIRCLE&&(t.style.rawR||(t.style.rawR=t.style.r),t.style.r=(t.style.rawR||1)/e)):(t.style.rawLineWidth&&(t.style.lineWidth=t.style.rawLineWidth,delete t.style.rawLineWidth),t.nodeName===j.CIRCLE&&t.style.rawR&&(t.style.r=t.style.rawR,delete t.style.rawR));}}]);function n_(t){return t.constructor.PARSED_STYLE_LIST;}var nG=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e6;},[{key:"calculator",value:function(t,e,n,r){return eJ(n);}}]),nF=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r,i){return n instanceof ek&&(n=null),i.sceneGraphService.updateDisplayObjectDependency(t,e,n,r),"clipPath"===t&&r.forEach(function(t){0===t.childNodes.length&&i.sceneGraphService.dirtyToRoot(t);}),n;}}]),nB=(0,R.default)(function t(){(0,C.default)(this,t),this.parser=eY,this.mixer=eW;},[{key:"calculator",value:function(t,e,n,r){return n instanceof ek?"none"===n.value?eM:eA:n;}}]),nU=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n){return n instanceof ek?[]:n;}}]);function nV(t){var e=t.parsedStyle.fontSize;return(0,F.isNil)(e)?null:e;}var nz=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e6;},[{key:"calculator",value:function(t,e,n,r,i){if((0,F.isNumber)(n))return n;if(!eT.isRelativeUnit(n.unit))return n.value;if(n.unit===ea.kPercentage)return 0;if(n.unit===ea.kEms){if(r.parentNode){var a,o=nV(r.parentNode);if(o)return o*n.value;}return 0;}if(n.unit===ea.kRems){if(null!=r&&null!==(a=r.ownerDocument)&&void 0!==a&&a.documentElement){var s=nV(r.ownerDocument.documentElement);if(s)return s*n.value;}return 0;}}}]),nH=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e9;},[{key:"calculator",value:function(t,e,n){return n.map(function(t){return t.value;});}}]),nY=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e9;},[{key:"calculator",value:function(t,e,n){return n.map(function(t){return t.value;});}}]),nW=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){n instanceof ek&&(n=null);var i,a=null===(i=n)||void 0===i?void 0:i.cloneNode(!0);return a&&(a.style.isMarker=!0),a;}}]),nq=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e6;},[{key:"calculator",value:function(t,e,n){return n.value;}}]),nX=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e7(0,1);},[{key:"calculator",value:function(t,e,n){return n.value;}},{key:"postProcessor",value:function(t){var e=t.parsedStyle,n=e.offsetPath,r=e.offsetDistance;if(n){var i=n.nodeName;if(i===j.LINE||i===j.PATH||i===j.POLYLINE){var a=n.getPoint(r);a&&t.setLocalPosition(a.x,a.y);}}}}]),nj=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e7(0,1);},[{key:"calculator",value:function(t,e,n){return n.value;}}]),n$=(0,R.default)(function t(){(0,C.default)(this,t),this.parser=nh,this.mixer=nd;},[{key:"calculator",value:function(t,e,n){return n instanceof ek&&"unset"===n.value?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new tl(0,0,0,0)}:n;}}]),nK=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=nf;}),nZ=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).mixer=e7(0,1/0),t;}return(0,I.default)(e,t),(0,R.default)(e);}(nz),nQ=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){return n instanceof ek?"unset"===n.value?"":n.value:"".concat(n);}},{key:"postProcessor",value:function(t){t.nodeValue="".concat(t.parsedStyle.text)||"";}}]),nJ=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){var i=r.getAttribute("text");if(i){var a=i;"capitalize"===n.value?a=i.charAt(0).toUpperCase()+i.slice(1):"lowercase"===n.value?a=i.toLowerCase():"uppercase"===n.value&&(a=i.toUpperCase()),r.parsedStyle.text=a;}return n.value;}}]);function n0(t,e){var n=Number(t.parsedStyle.zIndex||0),r=Number(e.parsedStyle.zIndex||0);if(n===r){var i=t.parentNode;if(i){var a=i.childNodes||[];return a.indexOf(t)-a.indexOf(e);}}return n-r;}new WeakMap,"undefined"!=typeof window&&window.document;var n1={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},n2="object"==typeof performance&&performance.now?performance:Date;function n3(t){return t.nodeName===j.FRAGMENT||t.getRootNode().nodeName===j.FRAGMENT;}var n4=1,n5="object"==typeof self&&self.self===self?self:"object"==typeof X&&X.global===X?X:{},n6=Date.now(),n7={},n9=Date.now(),n8=function(t){if("function"!=typeof t)throw TypeError("".concat(t," is not a function"));var e=Date.now(),n=e-n9,r=n4++;return n7[r]=t,Object.keys(n7).length>1||setTimeout(function(){n9=e;var t=n7;n7={},Object.keys(t).forEach(function(e){return t[e](n5.performance&&"function"==typeof n5.performance.now?n5.performance.now():Date.now()-n6);});},n>16?0:16-n),r;},rt=function(t){return"string"!=typeof t?n8:""===t?n5.requestAnimationFrame:n5["".concat(t,"RequestAnimationFrame")];},re=function(t,e){for(var n=0;void 0!==t[n];){if(e(t[n]))return t[n];n+=1;}}(["","webkit","moz","ms","o"],function(t){return!!rt(t);}),rn=rt(re),rr="string"!=typeof re?function(t){delete n7[t];}:""===re?n5.cancelAnimationFrame:n5["".concat(re,"CancelAnimationFrame")]||n5["".concat(re,"CancelRequestAnimationFrame")];n5.requestAnimationFrame=rn,n5.cancelAnimationFrame=rr;var ri=(0,R.default)(function t(){(0,C.default)(this,t),this.callbacks=[];},[{key:"getCallbacksNum",value:function(){return this.callbacks.length;}},{key:"tapPromise",value:function(t,e){this.callbacks.push(e);}},{key:"promise",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return Promise.all(this.callbacks.map(function(t){return t.apply(void 0,e);}));}}]),ra=(0,R.default)(function t(){(0,C.default)(this,t),this.callbacks=[];},[{key:"tapPromise",value:function(t,e){this.callbacks.push(e);}},{key:"promise",value:(m=(0,Y.default)((0,H.default)().mark(function t(){var e,n,r,i,a=arguments;return(0,H.default)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.callbacks.length){t.next=6;break;}return t.next=1,(e=this.callbacks)[0].apply(e,a);case 1:n=t.sent,r=1;case 2:if(!(r<this.callbacks.length)){t.next=5;break;}return i=this.callbacks[r],t.next=3,i(n);case 3:n=t.sent;case 4:r++,t.next=2;break;case 5:return t.abrupt("return",n);case 6:return t.abrupt("return",null);case 7:case"end":return t.stop();}},t,this);})),function(){return m.apply(this,arguments);})}]),ro=(0,R.default)(function t(){(0,C.default)(this,t),this.callbacks=[];},[{key:"tap",value:function(t,e){this.callbacks.push(e);}},{key:"call",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=arguments;this.callbacks.forEach(function(t){t.apply(void 0,r);});}}]),rs=(0,R.default)(function t(){(0,C.default)(this,t),this.callbacks=[];},[{key:"tap",value:function(t,e){this.callbacks.push(e);}},{key:"call",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];if(this.callbacks.length){for(var r=arguments,i=this.callbacks[0].apply(void 0,r),a=1;a<this.callbacks.length;a++)i=(0,this.callbacks[a])(i);return i;}return null;}}]),rl=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],ru=/([\"\'])[^\'\"]+\1/;function rc(t){var e=t.fontSize,n=t.fontFamily,r=t.fontStyle,i=t.fontVariant,a=t.fontWeight;return{fontSize:void 0===e?16:e,fontFamily:void 0===n?"sans-serif":n,fontStyle:void 0===r?"normal":r,fontVariant:void 0===i?"normal":i,fontWeight:void 0===a?"normal":a};}var rh=ei(function(t){for(var e=rc(t),n=e.fontSize,r=e.fontFamily,i=e.fontStyle,a=e.fontVariant,o=e.fontWeight,s=(0,F.isNumber)(n)&&"".concat(n,"px")||"16px",l=r.split(","),u=l.length-1;u>=0;u--){var c=l[u].trim();!ru.test(c)&&0>rl.indexOf(c)&&(c='"'.concat(c,'"')),l[u]=c;}return"".concat(i," ").concat(a," ").concat(o," ").concat(s," ").concat(l.join(","));},function(t){var e=rc(t),n=e.fontSize,r=e.fontFamily,i=e.fontStyle,a=e.fontVariant,o=e.fontWeight;return"".concat(i,"_").concat(a,"_").concat(o,"_").concat(n,"_").concat(r);}),rd=function(t){return Math.max(t,1e-6);};function rf(t,e,n){return G.mat4.identity(t),t[4]=Math.tan(e),t[1]=Math.tan(n),t;}var rv=G.mat4.create(),rp=G.mat4.create(),rg={scale:function(t){G.mat4.fromScaling(rv,[t[0].value,t[1].value,1].map(function(t){return rd(t);}));},scaleX:function(t){G.mat4.fromScaling(rv,[t[0].value,1,1].map(function(t){return rd(t);}));},scaleY:function(t){G.mat4.fromScaling(rv,[1,t[0].value,1].map(function(t){return rd(t);}));},scaleZ:function(t){G.mat4.fromScaling(rv,[1,1,t[0].value].map(function(t){return rd(t);}));},scale3d:function(t){G.mat4.fromScaling(rv,[t[0].value,t[1].value,t[2].value].map(function(t){return rd(t);}));},translate:function(t){G.mat4.fromTranslation(rv,[t[0].value,t[1].value,0]);},translateX:function(t){G.mat4.fromTranslation(rv,[t[0].value,0,0]);},translateY:function(t){G.mat4.fromTranslation(rv,[0,t[0].value,0]);},translateZ:function(t){G.mat4.fromTranslation(rv,[0,0,t[0].value]);},translate3d:function(t){G.mat4.fromTranslation(rv,[t[0].value,t[1].value,t[2].value]);},rotate:function(t){G.mat4.fromZRotation(rv,eJ(t[0])*tf);},rotateX:function(t){G.mat4.fromXRotation(rv,eJ(t[0])*tf);},rotateY:function(t){G.mat4.fromYRotation(rv,eJ(t[0])*tf);},rotateZ:function(t){G.mat4.fromZRotation(rv,eJ(t[0])*tf);},rotate3d:function(t){G.mat4.fromRotation(rv,eJ(t[3])*tf,[t[0].value,t[1].value,t[2].value]);},skew:function(t){rf(rv,t[0].value*tf,t[1].value*tf);},skewX:function(t){rf(rv,t[0].value*tf,0);},skewY:function(t){rf(rv,0,t[0].value*tf);},matrix:function(t){G.mat4.set(rv,t[0].value,t[1].value,0,0,t[2].value,t[3].value,0,0,0,0,1,0,t[4].value,t[5].value,0,1);},matrix3d:function(t){G.mat4.set.apply(G.mat4,[rv].concat((0,O.default)(t.map(function(t){return t.value;}))));}},ry=G.vec3.fromValues(1,1,1),rm=G.vec3.create(),rk={translate:function(t,e){is.sceneGraphService.setLocalScale(t,ry,!1),is.sceneGraphService.setLocalEulerAngles(t,rm,void 0,void 0,!1),is.sceneGraphService.setLocalPosition(t,[e[0].value,e[1].value,0],!1),is.sceneGraphService.dirtyLocalTransform(t,t.transformable);}};function rE(t,e){if(t.length){if(1===t.length&&rk[t[0].t]){rk[t[0].t](e,t[0].d);return;}for(var n=G.mat4.identity(rp),r=0;r<t.length;r++){var i=t[r],a=i.t,o=i.d,s=rg[a];s&&(s(o),G.mat4.mul(n,n,rv));}e.setLocalTransform(n);}else e.resetLocalTransform();return e.getLocalTransform();}var rx=(0,R.default)(function t(){(0,C.default)(this,t),this.parser=nE,this.mixer=nA;},[{key:"calculator",value:function(t,e,n,r){return n instanceof ek?[]:n;}},{key:"postProcessor",value:function(t){rE(t.parsedStyle.transform,t);}}]),rT=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"postProcessor",value:function(t){var e=t.parsedStyle.transformOrigin;e[0].unit===ea.kPixels&&e[1].unit===ea.kPixels?t.setOrigin(e[0].value,e[1].value):t.getGeometryBounds();}}]),rN=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){return n.value;}},{key:"postProcessor",value:function(t){if(t.parentNode){var e=t.parentNode,n=e.renderable,r=e.sortable;n&&e.dirty(),r&&(r.dirty=!0,r.dirtyReason=tC.Z_INDEX_CHANGED);}}}]),rb=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){var n=t.cx,r=t.cy,i=t.r,a=void 0===i?0:i;return{cx:void 0===n?0:n,cy:void 0===r?0:r,hwidth:a,hheight:a};}}]),rS=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){var n=t.cx,r=t.cy,i=t.rx,a=t.ry;return{cx:void 0===n?0:n,cy:void 0===r?0:r,hwidth:void 0===i?0:i,hheight:void 0===a?0:a};}}]),rw=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t){var e=t.x1,n=t.y1,r=t.x2,i=t.y2,a=Math.min(e,r),o=Math.min(n,i),s=(Math.max(e,r)-a)/2,l=(Math.max(n,i)-o)/2;return{cx:a+s,cy:o+l,hwidth:s,hheight:l};}}]),rP=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t){var e=t.d.rect,n=e.x,r=e.y,i=e.width,a=e.height,o=i/2,s=a/2;return{cx:n+o,cy:r+s,hwidth:o,hheight:s};}}]),rM=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t){if(t.points&&(0,F.isArray)(t.points.points)){var e=t.points.points,n=Math.min.apply(Math,(0,O.default)(e.map(function(t){return t[0];}))),r=Math.max.apply(Math,(0,O.default)(e.map(function(t){return t[0];}))),i=Math.min.apply(Math,(0,O.default)(e.map(function(t){return t[1];}))),a=Math.max.apply(Math,(0,O.default)(e.map(function(t){return t[1];}))),o=(r-n)/2,s=(a-i)/2;return{cx:n+o,cy:i+s,hwidth:o,hheight:s};}return{cx:0,cy:0,hwidth:0,hheight:0};}}]),rA=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){var n=t.x,r=t.y,i=t.src,a=t.width,o=t.height,s=void 0===a?0:a,l=void 0===o?0:o;return!i||(0,F.isString)(i)||(s||(s=i.width,t.width=s),l||(l=i.height,t.height=l)),{cx:(void 0===n?0:n)+s/2,cy:(void 0===r?0:r)+l/2,hwidth:s/2,hheight:l/2};}}]),rC=(0,R.default)(function t(e){(0,C.default)(this,t),this.globalRuntime=e;},[{key:"isReadyToMeasure",value:function(t,e){return t.text;}},{key:"update",value:function(t,e){var n,r=t.text,i=t.textAlign,a=void 0===i?"start":i,o=t.lineWidth,s=void 0===o?1:o,l=t.textBaseline,u=void 0===l?"alphabetic":l,c=t.dx,h=void 0===c?0:c,d=t.dy,f=void 0===d?0:d,v=t.x,p=t.y;if(!this.isReadyToMeasure(t,e))return t.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var g=((null==e||null===(n=e.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n?void 0:n.getConfig())||{}).offscreenCanvas,y=this.globalRuntime.textService.measureText(r,t,g);t.metrics=y;var m=y.width,k=y.height,E=m/2,x=k/2,T=(void 0===v?0:v)+E;"center"===a||"middle"===a?T+=s/2-E:("right"===a||"end"===a)&&(T+=s-2*E);var N=(void 0===p?0:p)-x;return"middle"===u?N+=x:"top"===u||"hanging"===u?N+=2*x:"alphabetic"===u||("bottom"===u||"ideographic"===u)&&(N+=0),h&&(T+=h),f&&(N+=f),{cx:T,cy:N,hwidth:E,hheight:x};}}]),rR=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){return{cx:0,cy:0,hwidth:0,hheight:0};}}]),rO=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){var n=t.x,r=t.y,i=t.width,a=void 0===i?0:i,o=t.height,s=void 0===o?0:o;return{cx:(void 0===n?0:n)+a/2,cy:(void 0===r?0:r)+s/2,hwidth:a/2,hheight:s/2};}}]),rL=(0,R.default)(function t(e){(0,C.default)(this,t),this.eventPhase=t.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new ts,this.page=new ts,this.canvas=new ts,this.viewport=new ts,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e;},[{key:"name",get:function(){return this.type;}},{key:"layerX",get:function(){return this.layer.x;}},{key:"layerY",get:function(){return this.layer.y;}},{key:"pageX",get:function(){return this.page.x;}},{key:"pageY",get:function(){return this.page.y;}},{key:"x",get:function(){return this.canvas.x;}},{key:"y",get:function(){return this.canvas.y;}},{key:"canvasX",get:function(){return this.canvas.x;}},{key:"canvasY",get:function(){return this.canvas.y;}},{key:"viewportX",get:function(){return this.viewport.x;}},{key:"viewportY",get:function(){return this.viewport.y;}},{key:"composedPath",value:function(){return this.manager&&(!this.path||this.path[0]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path;}},{key:"propagationPath",get:function(){return this.composedPath();}},{key:"preventDefault",value:function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0;}},{key:"stopImmediatePropagation",value:function(){this.propagationImmediatelyStopped=!0;}},{key:"stopPropagation",value:function(){this.propagationStopped=!0;}},{key:"initEvent",value:function(){}},{key:"initUIEvent",value:function(){}},{key:"clone",value:function(){throw Error(tu);}}]),rI=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).client=new ts,t.movement=new ts,t.offset=new ts,t.global=new ts,t.screen=new ts,t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clientX",get:function(){return this.client.x;}},{key:"clientY",get:function(){return this.client.y;}},{key:"movementX",get:function(){return this.movement.x;}},{key:"movementY",get:function(){return this.movement.y;}},{key:"offsetX",get:function(){return this.offset.x;}},{key:"offsetY",get:function(){return this.offset.y;}},{key:"globalX",get:function(){return this.global.x;}},{key:"globalY",get:function(){return this.global.y;}},{key:"screenX",get:function(){return this.screen.x;}},{key:"screenY",get:function(){return this.screen.y;}},{key:"getModifierState",value:function(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t);}},{key:"initMouseEvent",value:function(){throw Error(tu);}}]);}(rL),rD=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).width=0,t.height=0,t.isPrimary=!1,t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getCoalescedEvents",value:function(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[];}},{key:"getPredictedEvents",value:function(){throw Error("getPredictedEvents is not supported!");}},{key:"clone",value:function(){return this.manager.clonePointerEvent(this);}}]);}(rI),r_=function(t){function e(){return(0,C.default)(this,e),(0,L.default)(this,e,arguments);}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return this.manager.cloneWheelEvent(this);}}]);}(rI),rG=function(t){function e(t,n){var r;return(0,C.default)(this,e),(r=(0,L.default)(this,e,[null])).type=t,r.detail=null==n?void 0:n.detail,!n||"detail"in n||(r.detail=n),Object.assign(r,n),r;}return(0,I.default)(e,t),(0,R.default)(e);}(rL),rF=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).shadow=!1,t.ownerDocument=null,t.isConnected=!1,t.baseURI="",t.childNodes=[],t.nodeType=0,t.nodeName="",t.nodeValue=null,t.mutations=void 0,t.parentNode=null,t.destroyed=!1,t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"textContent",get:function(){var t="";this.nodeName===j.TEXT&&(t+=this.style.text);var e,n=(0,W.default)(this.childNodes);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.nodeName===j.TEXT?t+=r.nodeValue:t+=r.textContent;}}catch(t){n.e(t);}finally{n.f();}return t;},set:function(t){var e=this;this.childNodes.slice().forEach(function(t){e.removeChild(t);}),this.nodeName===j.TEXT&&(this.style.text="".concat(t));}},{key:"getRootNode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.parentNode?this.parentNode.getRootNode(t):t.composed&&this.host?this.host.getRootNode(t):this;}},{key:"hasChildNodes",value:function(){return this.childNodes.length>0;}},{key:"isDefaultNamespace",value:function(t){throw Error(tu);}},{key:"lookupNamespaceURI",value:function(t){throw Error(tu);}},{key:"lookupPrefix",value:function(t){throw Error(tu);}},{key:"normalize",value:function(){throw Error(tu);}},{key:"isEqualNode",value:function(t){return this===t;}},{key:"isSameNode",value:function(t){return this.isEqualNode(t);}},{key:"parent",get:function(){return this.parentNode;}},{key:"parentElement",get:function(){return null;}},{key:"nextSibling",get:function(){return null;}},{key:"previousSibling",get:function(){return null;}},{key:"firstChild",get:function(){return this.childNodes.length>0?this.childNodes[0]:null;}},{key:"lastChild",get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null;}},{key:"compareDocumentPosition",value:function(t){if(t===this)return 0;for(var n,r=t,i=this,a=[r],o=[i];null!==(n=r.parentNode)&&void 0!==n?n:i.parentNode;)r=r.parentNode?(a.push(r.parentNode),r.parentNode):r,i=i.parentNode?(o.push(i.parentNode),i.parentNode):i;if(r!==i)return e.DOCUMENT_POSITION_DISCONNECTED|e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|e.DOCUMENT_POSITION_PRECEDING;var s=a.length>o.length?a:o,l=s===a?o:a;if(s[s.length-l.length]===l[0])return s===a?e.DOCUMENT_POSITION_CONTAINED_BY|e.DOCUMENT_POSITION_FOLLOWING:e.DOCUMENT_POSITION_CONTAINS|e.DOCUMENT_POSITION_PRECEDING;for(var u=s.length-l.length,c=l.length-1;c>=0;c--){var h=l[c],d=s[u+c];if(d!==h){var f=h.parentNode.childNodes;if(f.indexOf(h)<f.indexOf(d)){if(l===a)return e.DOCUMENT_POSITION_PRECEDING;return e.DOCUMENT_POSITION_FOLLOWING;}if(s===a)return e.DOCUMENT_POSITION_PRECEDING;break;}}return e.DOCUMENT_POSITION_FOLLOWING;}},{key:"contain",value:function(t){return this.contains(t);}},{key:"contains",value:function(t){for(var e=t;e&&this!==e;)e=e.parentNode;return!!e;}},{key:"getAncestor",value:function(t){for(var e=this;t>0&&e;)e=e.parentNode,t--;return e;}},{key:"forEach",value:function(t){for(var e=[this];e.length>0;){var n=e.pop();if(!1===t(n))break;for(var r=n.childNodes.length-1;r>=0;r--)e.push(n.childNodes[r]);}}}],[{key:"isNode",value:function(t){return!!t.childNodes;}}]);}((0,R.default)(function t(){(0,C.default)(this,t),this.emitter=new _.default;},[{key:"on",value:function(t,e,n){return this.addEventListener(t,e,n),this;}},{key:"addEventListener",value:function(t,e,n){var r=!1,i=!1;if((0,F.isBoolean)(n))r=n;else if(n){var a=n.capture;r=void 0!==a&&a;var o=n.once;i=void 0!==o&&o;}r&&(t+="capture"),e=(0,F.isFunction)(e)?e:e.handleEvent;var s=(0,F.isFunction)(e)?void 0:e;return i?this.emitter.once(t,e,s):this.emitter.on(t,e,s),this;}},{key:"off",value:function(t,e,n){return t?this.removeEventListener(t,e,n):this.removeAllEventListeners(),this;}},{key:"removeAllEventListeners",value:function(){var t;null===(t=this.emitter)||void 0===t||t.removeAllListeners();}},{key:"removeEventListener",value:function(t,e,n){if(!this.emitter)return this;((0,F.isBoolean)(n)?n:null==n?void 0:n.capture)&&(t+="capture"),e=(0,F.isFunction)(e)?e:null===(r=e)||void 0===r?void 0:r.handleEvent;var r,i=(0,F.isFunction)(e)?void 0:e;return this.emitter.off(t,e,i),this;}},{key:"emit",value:function(t,e){this.dispatchEvent(new rG(t,e));}},{key:"dispatchEventToSelf",value:function(t){t.target||(t.target=this),t.currentTarget=this,this.emitter.emit(t.type,t);}},{key:"dispatchEvent",value:function(t){var e,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0;if(i)return this.dispatchEventToSelf(t),!0;if(e=this.document?this:this.defaultView?this.defaultView:null===(n=this.ownerDocument)||void 0===n?void 0:n.defaultView){if(t.manager=e.getEventService(),!t.manager)return!1;t.defaultPrevented=!1,t.path?t.path.length=0:t.page=[],r||(t.target=this),t.manager.dispatchEvent(t,t.type,r);}else this.dispatchEventToSelf(t);return!t.defaultPrevented;}}]));rF.DOCUMENT_POSITION_DISCONNECTED=1,rF.DOCUMENT_POSITION_PRECEDING=2,rF.DOCUMENT_POSITION_FOLLOWING=4,rF.DOCUMENT_POSITION_CONTAINS=8,rF.DOCUMENT_POSITION_CONTAINED_BY=16,rF.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32,(0,R.default)(function t(e,n){var r=this;(0,C.default)(this,t),this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=G.mat4.create(),this.tmpVec3=G.vec3.create(),this.onPointerDown=function(t){var e=r.createPointerEvent(t);if(r.dispatchEvent(e,"pointerdown"),"touch"===e.pointerType)r.dispatchEvent(e,"touchstart");else if("mouse"===e.pointerType||"pen"===e.pointerType){var n=2===e.button;r.dispatchEvent(e,n?"rightdown":"mousedown");}r.trackingData(t.pointerId).pressTargetsByButton[t.button]=e.composedPath(),r.freeEvent(e);},this.onPointerUp=function(t){var e=n2.now(),n=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);if(r.dispatchEvent(n,"pointerup"),"touch"===n.pointerType)r.dispatchEvent(n,"touchend");else if("mouse"===n.pointerType||"pen"===n.pointerType){var i=2===n.button;r.dispatchEvent(n,i?"rightup":"mouseup");}var a=r.trackingData(t.pointerId),o=r.findMountedTarget(a.pressTargetsByButton[t.button]),s=o;if(o&&!n.composedPath().includes(o)){for(var l=o;l&&!n.composedPath().includes(l);){if(n.currentTarget=l,r.notifyTarget(n,"pointerupoutside"),"touch"===n.pointerType)r.notifyTarget(n,"touchendoutside");else if("mouse"===n.pointerType||"pen"===n.pointerType){var u=2===n.button;r.notifyTarget(n,u?"rightupoutside":"mouseupoutside");}rF.isNode(l)&&(l=l.parentNode);}delete a.pressTargetsByButton[t.button],s=l;}if(s){var c,h=r.clonePointerEvent(n,"click");h.target=s,h.path=[],a.clicksByButton[t.button]||(a.clicksByButton[t.button]={clickCount:0,target:h.target,timeStamp:e});var d=r.context.renderingContext.root.ownerDocument.defaultView,f=a.clicksByButton[t.button];f.target===h.target&&e-f.timeStamp<d.getConfig().dblClickSpeed?++f.clickCount:f.clickCount=1,f.target=h.target,f.timeStamp=e,h.detail=f.clickCount,null!==(c=n.detail)&&void 0!==c&&c.preventClick||(r.context.config.useNativeClickEvent||"mouse"!==h.pointerType&&"touch"!==h.pointerType||r.dispatchEvent(h,"click"),r.dispatchEvent(h,"pointertap")),r.freeEvent(h);}r.freeEvent(n);},this.onPointerMove=function(t){var e=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0),n="mouse"===e.pointerType||"pen"===e.pointerType,i=r.trackingData(t.pointerId),a=r.findMountedTarget(i.overTargets);if(i.overTargets&&a!==e.target){var o="mousemove"===t.type?"mouseout":"pointerout",s=r.createPointerEvent(t,o,a||void 0);if(r.dispatchEvent(s,"pointerout"),n&&r.dispatchEvent(s,"mouseout"),!e.composedPath().includes(a)){var l=r.createPointerEvent(t,"pointerleave",a||void 0);for(l.eventPhase=l.AT_TARGET;l.target&&!e.composedPath().includes(l.target);)l.currentTarget=l.target,r.notifyTarget(l),n&&r.notifyTarget(l,"mouseleave"),rF.isNode(l.target)&&(l.target=l.target.parentNode);r.freeEvent(l);}r.freeEvent(s);}if(a!==e.target){var u="mousemove"===t.type?"mouseover":"pointerover",c=r.clonePointerEvent(e,u);r.dispatchEvent(c,"pointerover"),n&&r.dispatchEvent(c,"mouseover");for(var h=a&&rF.isNode(a)&&a.parentNode;h&&h!==(rF.isNode(r.rootTarget)&&r.rootTarget.parentNode)&&h!==e.target;)h=h.parentNode;if(!h||h===(rF.isNode(r.rootTarget)&&r.rootTarget.parentNode)){var d=r.clonePointerEvent(e,"pointerenter");for(d.eventPhase=d.AT_TARGET;d.target&&d.target!==a&&d.target!==(rF.isNode(r.rootTarget)&&r.rootTarget.parentNode);)d.currentTarget=d.target,r.notifyTarget(d),n&&r.notifyTarget(d,"mouseenter"),rF.isNode(d.target)&&(d.target=d.target.parentNode);r.freeEvent(d);}r.freeEvent(c);}r.dispatchEvent(e,"pointermove"),"touch"===e.pointerType&&r.dispatchEvent(e,"touchmove"),n&&(r.dispatchEvent(e,"mousemove"),r.cursor=r.getCursor(e.target)),i.overTargets=e.composedPath(),r.freeEvent(e);},this.onPointerOut=function(t){var e=r.trackingData(t.pointerId);if(e.overTargets){var n="mouse"===t.pointerType||"pen"===t.pointerType,i=r.findMountedTarget(e.overTargets),a=r.createPointerEvent(t,"pointerout",i||void 0);r.dispatchEvent(a),n&&r.dispatchEvent(a,"mouseout");var o=r.createPointerEvent(t,"pointerleave",i||void 0);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==(rF.isNode(r.rootTarget)&&r.rootTarget.parentNode);)o.currentTarget=o.target,r.notifyTarget(o),n&&r.notifyTarget(o,"mouseleave"),rF.isNode(o.target)&&(o.target=o.target.parentNode);e.overTargets=null,r.freeEvent(a),r.freeEvent(o);}r.cursor=null;},this.onPointerOver=function(t){var e=r.trackingData(t.pointerId),n=r.createPointerEvent(t),i="mouse"===n.pointerType||"pen"===n.pointerType;r.dispatchEvent(n,"pointerover"),i&&r.dispatchEvent(n,"mouseover"),"mouse"===n.pointerType&&(r.cursor=r.getCursor(n.target));var a=r.clonePointerEvent(n,"pointerenter");for(a.eventPhase=a.AT_TARGET;a.target&&a.target!==(rF.isNode(r.rootTarget)&&r.rootTarget.parentNode);)a.currentTarget=a.target,r.notifyTarget(a),i&&r.notifyTarget(a,"mouseenter"),rF.isNode(a.target)&&(a.target=a.target.parentNode);e.overTargets=n.composedPath(),r.freeEvent(n),r.freeEvent(a);},this.onPointerUpOutside=function(t){var e=r.trackingData(t.pointerId),n=r.findMountedTarget(e.pressTargetsByButton[t.button]),i=r.createPointerEvent(t);if(n){for(var a=n;a;)i.currentTarget=a,r.notifyTarget(i,"pointerupoutside"),"touch"===i.pointerType||("mouse"===i.pointerType||"pen"===i.pointerType)&&r.notifyTarget(i,2===i.button?"rightupoutside":"mouseupoutside"),rF.isNode(a)&&(a=a.parentNode);delete e.pressTargetsByButton[t.button];}r.freeEvent(i);},this.onWheel=function(t){var e=r.createWheelEvent(t);r.dispatchEvent(e),r.freeEvent(e);},this.onClick=function(t){if(r.context.config.useNativeClickEvent){var e=r.createPointerEvent(t);r.dispatchEvent(e),r.freeEvent(e);}},this.onPointerCancel=function(t){var e=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);r.dispatchEvent(e),r.freeEvent(e);},this.globalRuntime=e,this.context=n;},[{key:"init",value:function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick);}},{key:"destroy",value:function(){this.mappingTable={},this.mappingState={},this.eventPool.clear();}},{key:"getScale",value:function(){var t=this.context.contextService.getBoundingClientRect(),e=1,n=1,r=this.context.contextService.getDomElement();if(r&&t){var i=r.offsetWidth,a=r.offsetHeight;i&&a&&(e=t.width/i,n=t.height/a);}return{scaleX:e,scaleY:n,bbox:t};}},{key:"client2Viewport",value:function(t){var e=this.getScale(),n=e.scaleX,r=e.scaleY,i=e.bbox;return new ts((t.x-((null==i?void 0:i.left)||0))/n,(t.y-((null==i?void 0:i.top)||0))/r);}},{key:"viewport2Client",value:function(t){var e=this.getScale(),n=e.scaleX,r=e.scaleY,i=e.bbox;return new ts((t.x+((null==i?void 0:i.left)||0))*n,(t.y+((null==i?void 0:i.top)||0))*r);}},{key:"viewport2Canvas",value:function(t){var e=t.x,n=t.y,r=this.rootTarget.defaultView.getCamera(),i=this.context.config,a=i.width,o=i.height,s=r.getPerspectiveInverse(),l=r.getWorldTransform(),u=G.mat4.multiply(this.tmpMatrix,l,s),c=G.vec3.set(this.tmpVec3,e/a*2-1,(1-n/o)*2-1,0);return G.vec3.transformMat4(c,c,u),new ts(c[0],c[1]);}},{key:"canvas2Viewport",value:function(t){var e=this.rootTarget.defaultView.getCamera(),n=e.getPerspective(),r=e.getViewTransform(),i=G.mat4.multiply(this.tmpMatrix,n,r),a=G.vec3.set(this.tmpVec3,t.x,t.y,0);G.vec3.transformMat4(this.tmpVec3,this.tmpVec3,i);var o=this.context.config,s=o.width,l=o.height;return new ts((a[0]+1)/2*s,(1-(a[1]+1)/2)*l);}},{key:"setPickHandler",value:function(t){this.pickHandler=t;}},{key:"addEventMapping",value:function(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort(function(t,e){return t.priority-e.priority;});}},{key:"mapEvent",value:function(t){if(this.rootTarget){var e=this.mappingTable[t.type];if(e)for(var n=0,r=e.length;n<r;n++)e[n].fn(t);else console.warn("[EventService]: Event mapping not defined for ".concat(t.type));}}},{key:"dispatchEvent",value:function(t,e,n){if(n){t.eventPhase=t.AT_TARGET;var r=this.rootTarget.defaultView||null;t.currentTarget=r,this.notifyListeners(t,e);}else t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e);}},{key:"propagate",value:function(t,e){if(t.target){var n=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(var r=n.length-1;r>=1;r--)if(t.currentTarget=n[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!t.propagationStopped&&!t.propagationImmediatelyStopped){var i=n.indexOf(t.currentTarget);t.eventPhase=t.BUBBLING_PHASE;for(var a=i+1;a<n.length;a++)if(t.currentTarget=n[a],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;}}}},{key:"propagationPath",value:function(t){var e=[t],n=this.rootTarget.defaultView||null;if(n&&n===t)return e.unshift(n.document),e;for(var r=0;r<2048&&t!==this.rootTarget;r++)rF.isNode(t)&&t.parentNode&&(e.push(t.parentNode),t=t.parentNode);return n&&e.push(n),e;}},{key:"hitTest",value:function(t){var e=t.viewportX,n=t.viewportY,r=this.context.config,i=r.width,a=r.height,o=r.disableHitTesting;return e<0||n<0||e>i||n>a?null:!o&&this.pickHandler(t)||this.rootTarget||null;}},{key:"isNativeEventFromCanvas",value:function(t,e){var n,r=null==e?void 0:e.target;if(null!==(n=r)&&void 0!==n&&n.shadowRoot&&(r=e.composedPath()[0]),r){if(r===t)return!0;if(t&&t.contains)return t.contains(r);}return null!=e&&!!e.composedPath&&e.composedPath().indexOf(t)>-1;}},{key:"getExistedHTML",value:function(t){if(t.nativeEvent.composedPath)for(var e=0,n=t.nativeEvent.composedPath();e<n.length;e++){var r=n[e],i=this.nativeHTMLMap.get(r);if(i)return i;}return null;}},{key:"pickTarget",value:function(t){return this.hitTest({clientX:t.clientX,clientY:t.clientY,viewportX:t.viewportX,viewportY:t.viewportY,x:t.canvasX,y:t.canvasY});}},{key:"createPointerEvent",value:function(t,e,n,r){var i=this.allocateEvent(rD);this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.nativeEvent=t.nativeEvent,i.originalEvent=t;var a=this.getExistedHTML(i),o=this.context.contextService.getDomElement();return i.target=null!=n?n:a||this.isNativeEventFromCanvas(o,i.nativeEvent)&&this.pickTarget(i)||r,"string"==typeof e&&(i.type=e),i;}},{key:"createWheelEvent",value:function(t){var e=this.allocateEvent(r_);this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t;var n=this.getExistedHTML(e),r=this.context.contextService.getDomElement();return e.target=n||this.isNativeEventFromCanvas(r,e.nativeEvent)&&this.pickTarget(e),e;}},{key:"trackingData",value:function(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t];}},{key:"cloneWheelEvent",value:function(t){var e=this.allocateEvent(r_);return e.nativeEvent=t.nativeEvent,e.originalEvent=t.originalEvent,this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.target=t.target,e.path=t.composedPath().slice(),e.type=t.type,e;}},{key:"clonePointerEvent",value:function(t,e){var n=this.allocateEvent(rD);return n.nativeEvent=t.nativeEvent,n.originalEvent=t.originalEvent,this.copyPointerData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.target=t.target,n.path=t.composedPath().slice(),n.type=null!=e?e:n.type,n;}},{key:"copyPointerData",value:function(t,e){e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist;}},{key:"copyMouseData",value:function(t,e){e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey,e.client.copyFrom(t.client),e.movement.copyFrom(t.movement),e.canvas.copyFrom(t.canvas),e.screen.copyFrom(t.screen),e.global.copyFrom(t.global),e.offset.copyFrom(t.offset);}},{key:"copyWheelData",value:function(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;}},{key:"copyData",value:function(t,e){e.isTrusted=t.isTrusted,e.timeStamp=n2.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.page.copyFrom(t.page),e.viewport.copyFrom(t.viewport);}},{key:"allocateEvent",value:function(t){this.eventPool.has(t)||this.eventPool.set(t,[]);var e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=[],e.target=null,e;}},{key:"freeEvent",value:function(t){if(t.manager!==this)throw Error("It is illegal to free an event not managed by this EventBoundary!");var e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t);}},{key:"notifyTarget",value:function(t,e){e=null!=e?e:t.type;var n=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?"".concat(e,"capture"):e;this.notifyListeners(t,n),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e);}},{key:"notifyListeners",value:function(t,e){var n=t.currentTarget.emitter,r=n._events[e];if(r){if("fn"in r)r.once&&n.removeListener(e,r.fn,void 0,!0),r.fn.call(t.currentTarget||r.context,t);else for(var i=0;i<r.length&&!t.propagationImmediatelyStopped;i++)r[i].once&&n.removeListener(e,r[i].fn,void 0,!0),r[i].fn.call(t.currentTarget||r[i].context,t);}}},{key:"findMountedTarget",value:function(t){if(!t)return null;for(var e=t[t.length-1],n=t.length-2;n>=0;n--){var r=t[n];if(r===this.rootTarget||rF.isNode(r)&&r.parentNode===e)e=t[n];else break;}return e;}},{key:"getCursor",value:function(t){for(var e=t;e;){var n=!!e.getAttribute&&e.getAttribute("cursor");if(n)return n;e=rF.isNode(e)&&e.parentNode;}}}]);var rB=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"getOrCreateCanvas",value:function(t,e){if(this.canvas)return this.canvas;if(t||is.offscreenCanvas)this.canvas=t||is.offscreenCanvas,this.context=this.canvas.getContext("2d",(0,A.default)({willReadFrequently:!0},e));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",(0,A.default)({willReadFrequently:!0},e)),this.context&&this.context.measureText||(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"));}catch(t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",(0,A.default)({willReadFrequently:!0},e));}return this.canvas.width=10,this.canvas.height=10,this.canvas;}},{key:"getOrCreateContext",value:function(t,e){return this.context||this.getOrCreateCanvas(t,e),this.context;}}],[{key:"createCanvas",value:function(){try{return new window.OffscreenCanvas(0,0);}catch(t){}try{return document.createElement("canvas");}catch(t){}return null;}}]),rU=((k={})[k.CAMERA_CHANGED=0]="CAMERA_CHANGED",k[k.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",k[k.NONE=2]="NONE",k);(0,R.default)(function t(e,n){(0,C.default)(this,t),this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new ro,initAsync:new ri,dirtycheck:new rs,cull:new rs,beginFrame:new ro,beforeRender:new ro,render:new ro,afterRender:new ro,endFrame:new ro,destroy:new ro,pick:new ra,pickSync:new rs,pointerDown:new ro,pointerUp:new ro,pointerMove:new ro,pointerOut:new ro,pointerOver:new ro,pointerWheel:new ro,pointerCancel:new ro,click:new ro},this.globalRuntime=e,this.context=n;},[{key:"init",value:function(t){var e=this,n=(0,A.default)((0,A.default)({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach(function(t){t.apply(n,e.globalRuntime);}),this.hooks.init.call(),0===this.hooks.initAsync.getCallbacksNum()?(this.inited=!0,t()):this.hooks.initAsync.promise().then(function(){e.inited=!0,t();}).catch(function(t){});}},{key:"getStats",value:function(){return this.stats;}},{key:"disableDirtyRectangleRendering",value:function(){return!this.context.config.renderer.getConfig().enableDirtyRectangleRendering||this.context.renderingContext.renderReasons.has(rU.CAMERA_CHANGED);}},{key:"render",value:function(t,e,n){var r=this,i=t.getConfig(),a=this.context.renderingContext;if(this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0,this.globalRuntime.sceneGraphService.syncHierarchy(a.root),this.globalRuntime.sceneGraphService.notifyMutationObservers(t),a.renderReasons.size&&this.inited){a.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var o=1===a.renderReasons.size&&a.renderReasons.has(rU.CAMERA_CHANGED),s=!i.disableRenderHooks||!o;s&&this.renderDisplayObject(a.root,i,a),this.hooks.beginFrame.call(e),s&&a.renderListCurrentFrame.forEach(function(t){r.hooks.beforeRender.call(t),r.hooks.render.call(t),r.hooks.afterRender.call(t);}),this.hooks.endFrame.call(e),a.renderListCurrentFrame=[],a.renderReasons.clear(),n();}}},{key:"renderDisplayObject",value:function(t,e,n){for(var r=this,i=e.renderer.getConfig(),a=i.enableDirtyCheck,o=i.enableCulling,s=[t];s.length>0;){var l,u=s.pop();!function(t){var e=t.renderable,i=t.sortable,s=a?e.dirty||n.dirtyRectangleRenderingDisabled?t:null:t,l=null;s&&(l=o?r.hooks.cull.call(s,r.context.camera):s)&&(r.stats.rendered+=1,n.renderListCurrentFrame.push(l)),t.dirty(!1),i.renderOrder=r.zIndexCounter,r.zIndexCounter+=1,r.stats.total+=1,i.dirty&&(r.sort(t,i),i.dirty=!1,i.dirtyChildren=[],i.dirtyReason=void 0);}(u);for(var c=(null===(l=u.sortable)||void 0===l||null===(l=l.sorted)||void 0===l?void 0:l.length)>0?u.sortable.sorted:u.childNodes,h=c.length-1;h>=0;h--)s.push(c[h]);}}},{key:"sort",value:function(t,e){var n,r;(null==e||null===(n=e.sorted)||void 0===n?void 0:n.length)>0&&e.dirtyReason!==tC.Z_INDEX_CHANGED?e.dirtyChildren.forEach(function(n){var r=e.sorted.indexOf(n);if(r>-1&&e.sorted.splice(r,1),t.childNodes.indexOf(n)>-1){if(0===e.sorted.length)e.sorted.push(n);else{var i=function(t,e){for(var n=0,r=t.length;n<r;){var i=n+r>>>1;0>n0(t[i],e)?n=i+1:r=i;}return n;}(e.sorted,n);e.sorted.splice(i,0,n);}}}):e.sorted=t.childNodes.slice().sort(n0),(null===(r=e.sorted)||void 0===r?void 0:r.length)>0&&0===t.childNodes.filter(function(t){return t.parsedStyle.zIndex;}).length&&(e.sorted=[]);}},{key:"destroy",value:function(){this.inited=!1,this.hooks.destroy.call();}},{key:"dirty",value:function(){this.context.renderingContext.renderReasons.add(rU.DISPLAY_OBJECT_CHANGED);}}]);var rV=/\[\s*(.*)=(.*)\s*\]/,rz=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"selectOne",value:function(t,e){var n=this;if(t.startsWith("."))return e.find(function(e){return((null==e?void 0:e.classList)||[]).indexOf(n.getIdOrClassname(t))>-1;});if(t.startsWith("#"))return e.find(function(e){return e.id===n.getIdOrClassname(t);});if(t.startsWith("[")){var r=this.getAttribute(t),i=r.name,a=r.value;return i?e.find(function(t){return e!==t&&("name"===i?t.name===a:n.attributeToString(t,i)===a);}):null;}return e.find(function(n){return e!==n&&n.nodeName===t;});}},{key:"selectAll",value:function(t,e){var n=this;if(t.startsWith("."))return e.findAll(function(r){return e!==r&&((null==r?void 0:r.classList)||[]).indexOf(n.getIdOrClassname(t))>-1;});if(t.startsWith("#"))return e.findAll(function(r){return e!==r&&r.id===n.getIdOrClassname(t);});if(t.startsWith("[")){var r=this.getAttribute(t),i=r.name,a=r.value;return i?e.findAll(function(t){return e!==t&&("name"===i?t.name===a:n.attributeToString(t,i)===a);}):[];}return e.findAll(function(n){return e!==n&&n.nodeName===t;});}},{key:"is",value:function(t,e){if(t.startsWith("."))return e.className===this.getIdOrClassname(t);if(t.startsWith("#"))return e.id===this.getIdOrClassname(t);if(t.startsWith("[")){var n=this.getAttribute(t),r=n.name,i=n.value;return"name"===r?e.name===i:this.attributeToString(e,r)===i;}return e.nodeName===t;}},{key:"getIdOrClassname",value:function(t){return t.substring(1);}},{key:"getAttribute",value:function(t){var e=t.match(rV),n="",r="";return e&&e.length>2&&(n=e[1].replace(/"/g,""),r=e[2].replace(/"/g,"")),{name:n,value:r};}},{key:"attributeToString",value:function(t,e){if(!t.getAttribute)return"";var n=t.getAttribute(e);return(0,F.isNil)(n)?"":n.toString?n.toString():"";}}]),rH=((E={}).ATTR_MODIFIED="DOMAttrModified",E.INSERTED="DOMNodeInserted",E.MOUNTED="DOMNodeInsertedIntoDocument",E.REMOVED="removed",E.UNMOUNTED="DOMNodeRemovedFromDocument",E.REPARENT="reparent",E.DESTROY="destroy",E.BOUNDS_CHANGED="bounds-changed",E.CULLED="culled",E),rY=function(t){function e(t,n,r,i,a,o,s,l){var u;return(0,C.default)(this,e),(u=(0,L.default)(this,e,[null])).relatedNode=n,u.prevValue=r,u.newValue=i,u.attrName=a,u.attrChange=o,u.prevParsedValue=s,u.newParsedValue=l,u.type=t,u;}return(0,I.default)(e,t),(0,R.default)(e);}(rL);rY.ADDITION=2,rY.MODIFICATION=1,rY.REMOVAL=3;var rW=new rY(rH.REPARENT,null,"","","",0,"",""),rq=G.vec2.create(),rX=G.vec3.create(),rj=G.vec3.fromValues(1,1,1),r$=G.mat4.create(),rK=G.vec2.create(),rZ=G.vec3.create(),rQ=G.mat4.create(),rJ=G.quat.create(),r0=G.vec3.create(),r1=G.quat.create(),r2=G.vec3.create(),r3=G.vec3.create(),r4=G.vec3.create(),r5=G.mat4.create(),r6=G.quat.create(),r7=G.quat.create(),r9=G.quat.create(),r8=(0,R.default)(function t(e){(0,C.default)(this,t),this.displayObjectDependencyMap=new WeakMap,this.runtime=e;},[{key:"matches",value:function(t,e){return this.runtime.sceneGraphSelector.is(t,e);}},{key:"querySelector",value:function(t,e){return this.runtime.sceneGraphSelector.selectOne(t,e);}},{key:"querySelectorAll",value:function(t,e){return this.runtime.sceneGraphSelector.selectAll(t,e);}},{key:"attach",value:function(t,e,n){var r=!1;t.parentNode&&(r=t.parentNode!==e,this.detach(t));var i=t.nodeName===j.FRAGMENT,a=n3(e);t.parentNode=e;var o=i?t.childNodes:[t];(0,F.isNumber)(n)?o.forEach(function(t){e.childNodes.splice(n,0,t),t.parentNode=e;}):o.forEach(function(t){e.childNodes.push(t),t.parentNode=e;});var s=e.sortable;if((null!=s&&null!==(u=s.sorted)&&void 0!==u&&u.length||s.dirty||t.parsedStyle.zIndex)&&(-1===s.dirtyChildren.indexOf(t)&&s.dirtyChildren.push(t),s.dirty=!0,s.dirtyReason=tC.ADDED),!a){if(i)this.dirtyFragment(t);else{var l=t.transformable;l&&this.dirtyWorldTransform(t,l);}if(r){var u,c,h=(null===(c=e.ownerDocument)||void 0===c||null===(c=c.defaultView)||void 0===c||null===(c=c.getConfig())||void 0===c||null===(c=c.future)||void 0===c?void 0:c.experimentalCancelEventPropagation)===!0;t.dispatchEvent(rW,h,h);}}}},{key:"detach",value:function(t){if(t.parentNode){var e,n,r=t.transformable,i=t.parentNode.sortable;(null!=i&&null!==(e=i.sorted)&&void 0!==e&&e.length||null!==(n=t.style)&&void 0!==n&&n.zIndex)&&(-1===i.dirtyChildren.indexOf(t)&&i.dirtyChildren.push(t),i.dirty=!0,i.dirtyReason=tC.REMOVED);var a=t.parentNode.childNodes.indexOf(t);a>-1&&t.parentNode.childNodes.splice(a,1),r&&this.dirtyWorldTransform(t,r),t.parentNode=null;}}},{key:"getLocalPosition",value:function(t){return t.transformable.localPosition;}},{key:"getLocalRotation",value:function(t){return t.transformable.localRotation;}},{key:"getLocalScale",value:function(t){return t.transformable.localScale;}},{key:"getLocalSkew",value:function(t){return t.transformable.localSkew;}},{key:"getLocalTransform",value:function(t){var e=t.transformable;return tI(e),e.localTransform;}},{key:"setLocalPosition",value:function(t,e){var n,r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=t.transformable;r3[0]=e[0],r3[1]=e[1],r3[2]=null!==(n=e[2])&&void 0!==n?n:0,!G.vec3.equals(i.localPosition,r3)&&(G.vec3.copy(i.localPosition,r3),r&&this.dirtyLocalTransform(t,i));}},{key:"translateLocal",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var i=t.transformable;G.vec3.equals(e,rX)||(G.vec3.transformQuat(e,e,i.localRotation),G.vec3.add(i.localPosition,i.localPosition,e),this.dirtyLocalTransform(t,i));}},{key:"setLocalRotation",value:function(t,e,n,r,i){var a=!(arguments.length>5)||void 0===arguments[5]||arguments[5];"number"==typeof e&&(e=G.quat.set(rJ,e,n,r,i));var o=t.transformable;G.quat.copy(o.localRotation,e),a&&this.dirtyLocalTransform(t,o);}},{key:"rotateLocal",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var i=t.transformable;G.quat.fromEuler(r7,e[0],e[1],e[2]),G.quat.mul(i.localRotation,i.localRotation,r7),this.dirtyLocalTransform(t,i);}},{key:"setLocalScale",value:function(t,e){var n,r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=t.transformable;G.vec3.set(rZ,e[0],e[1],null!==(n=e[2])&&void 0!==n?n:i.localScale[2]),!G.vec3.equals(rZ,i.localScale)&&(G.vec3.copy(i.localScale,rZ),r&&this.dirtyLocalTransform(t,i));}},{key:"scaleLocal",value:function(t,e){var n,r=t.transformable;G.vec3.multiply(r.localScale,r.localScale,G.vec3.set(rZ,e[0],e[1],null!==(n=e[2])&&void 0!==n?n:1)),this.dirtyLocalTransform(t,r);}},{key:"setLocalSkew",value:function(t,e,n){var r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];"number"==typeof e&&(e=G.vec2.set(rK,e,n));var i=t.transformable;G.vec2.copy(i.localSkew,e),r&&this.dirtyLocalTransform(t,i);}},{key:"setLocalEulerAngles",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=!(arguments.length>4)||void 0===arguments[4]||arguments[4];"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var a=t.transformable;G.quat.fromEuler(a.localRotation,e[0],e[1],e[2]),i&&this.dirtyLocalTransform(t,a);}},{key:"setLocalTransform",value:function(t,e){var n=G.mat4.getTranslation(r0,e),r=G.mat4.getRotation(r1,e),i=G.mat4.getScaling(r2,e);this.setLocalScale(t,i,!1),this.setLocalPosition(t,n,!1),this.setLocalRotation(t,r,void 0,void 0,void 0,!1),this.dirtyLocalTransform(t,t.transformable);}},{key:"resetLocalTransform",value:function(t){this.setLocalScale(t,rj,!1),this.setLocalPosition(t,rX,!1),this.setLocalEulerAngles(t,rX,void 0,void 0,!1),this.setLocalSkew(t,rq,void 0,!1),this.dirtyLocalTransform(t,t.transformable);}},{key:"getPosition",value:function(t){var e=t.transformable;return G.mat4.getTranslation(e.position,this.getWorldTransform(t,e));}},{key:"getRotation",value:function(t){var e=t.transformable;return G.mat4.getRotation(e.rotation,this.getWorldTransform(t,e));}},{key:"getScale",value:function(t){var e=t.transformable;return G.mat4.getScaling(e.scaling,this.getWorldTransform(t,e));}},{key:"getOrigin",value:function(t){return t.getGeometryBounds(),t.transformable.origin;}},{key:"getWorldTransform",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.transformable;return(e.localDirtyFlag||e.dirtyFlag)&&(t.parentNode&&t.parentNode.transformable&&this.getWorldTransform(t.parentNode),this.internalUpdateTransform(t)),e.worldTransform;}},{key:"setPosition",value:function(t,e){var n,r=t.transformable;if(r4[0]=e[0],r4[1]=e[1],r4[2]=null!==(n=e[2])&&void 0!==n?n:0,!G.vec3.equals(this.getPosition(t),r4)){if(G.vec3.copy(r.position,r4),null!==t.parentNode&&t.parentNode.transformable){var i=t.parentNode.transformable;G.mat4.copy(r5,i.worldTransform),G.mat4.invert(r5,r5),G.vec3.transformMat4(r.localPosition,r4,r5);}else G.vec3.copy(r.localPosition,r4);this.dirtyLocalTransform(t,r);}}},{key:"translate",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.set(rZ,e,n,r)),G.vec3.equals(e,rX)||(G.vec3.add(rZ,this.getPosition(t),e),this.setPosition(t,rZ));}},{key:"setRotation",value:function(t,e,n,r,i){var a=t.transformable;if("number"==typeof e&&(e=G.quat.fromValues(e,n,r,i)),null!==t.parentNode&&t.parentNode.transformable){var o=this.getRotation(t.parentNode);G.quat.copy(rJ,o),G.quat.invert(rJ,rJ),G.quat.multiply(a.localRotation,rJ,e),G.quat.normalize(a.localRotation,a.localRotation),this.dirtyLocalTransform(t,a);}else this.setLocalRotation(t,e);}},{key:"rotate",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var i=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){G.quat.fromEuler(rJ,e[0],e[1],e[2]);var a=this.getRotation(t),o=this.getRotation(t.parentNode);G.quat.copy(r9,o),G.quat.invert(r9,r9),G.quat.multiply(rJ,r9,rJ),G.quat.multiply(i.localRotation,rJ,a),G.quat.normalize(i.localRotation,i.localRotation),this.dirtyLocalTransform(t,i);}else this.rotateLocal(t,e);}},{key:"setOrigin",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=[e,n,r]);var i=t.transformable;if(e[0]!==i.origin[0]||e[1]!==i.origin[1]||e[2]!==i.origin[2]){var a=i.origin;a[0]=e[0],a[1]=e[1],a[2]=e[2]||0,this.dirtyLocalTransform(t,i);}}},{key:"setEulerAngles",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var i=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){G.quat.fromEuler(i.localRotation,e[0],e[1],e[2]);var a=this.getRotation(t.parentNode);G.quat.copy(r6,G.quat.invert(rJ,a)),G.quat.mul(i.localRotation,i.localRotation,r6),this.dirtyLocalTransform(t,i);}else this.setLocalEulerAngles(t,e);}},{key:"getGeometryBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.geometry;return n.dirty&&is.styleValueRegistry.updateGeometry(t),(e?n.renderBounds:n.contentBounds||null)||new tr;}},{key:"getTransformedGeometryBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this.getGeometryBounds(t,e);if(!tr.isEmpty(r)){var i=n||new tr;return i.setFromTransformedAABB(r,this.getWorldTransform(t)),i;}return null;}},{key:"getBounds",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t.renderable;if(!r.boundsDirty&&!n&&r.bounds)return r.bounds;if(!r.renderBoundsDirty&&n&&r.renderBounds)return r.renderBounds;var i=n?r.renderBounds:r.bounds,a=this.getTransformedGeometryBounds(t,n,i);if(t.childNodes.forEach(function(t){var r=e.getBounds(t,n);r&&(a?a.add(r):(a=i||new tr).update(r.center,r.halfExtents));}),a||(a=new tr),n){var o=function(t){var e,n=t;do{if(null===(e=n.parsedStyle)||void 0===e?void 0:e.clipPath)return n;n=n.parentElement;}while(null!==n)return null;}(t);if(o){var s=o.parsedStyle.clipPath.getBounds(n);a?s&&(a=s.intersection(a)):a.update(s.center,s.halfExtents);}}return n?(r.renderBounds=a,r.renderBoundsDirty=!1):(r.bounds=a,r.boundsDirty=!1),a;}},{key:"getLocalBounds",value:function(t){if(t.parentNode){var e=r$;t.parentNode.transformable&&(e=G.mat4.invert(rQ,this.getWorldTransform(t.parentNode)));var n=this.getBounds(t);if(!tr.isEmpty(n)){var r=new tr;return r.setFromTransformedAABB(n,e),r;}}return this.getBounds(t);}},{key:"getBoundingClientRect",value:function(t){var e,n,r=this.getGeometryBounds(t);tr.isEmpty(r)||(n=new tr).setFromTransformedAABB(r,this.getWorldTransform(t));var i=null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e?void 0:e.getContextService().getBoundingClientRect();if(n){var a=n.getMin(),o=(0,D.default)(a,2),s=o[0],l=o[1],u=n.getMax(),c=(0,D.default)(u,2),h=c[0],d=c[1];return new tl(s+((null==i?void 0:i.left)||0),l+((null==i?void 0:i.top)||0),h-s,d-l);}return new tl((null==i?void 0:i.left)||0,(null==i?void 0:i.top)||0,0,0);}},{key:"internalUpdateTransform",value:function(t){var e,n,r=null===(n=t.parentNode)||void 0===n?void 0:n.transformable;tI(t.transformable),(e=t.transformable).dirtyFlag&&(r?G.mat4.multiply(e.worldTransform,r.worldTransform,e.localTransform):G.mat4.copy(e.worldTransform,e.localTransform),e.dirtyFlag=!1);}},{key:"internalUpdateElement",value:function(t,e){var n=(null===(s=t.ownerDocument)||void 0===s||null===(s=s.defaultView)||void 0===s||null===(s=s.getConfig())||void 0===s||null===(s=s.future)||void 0===s?void 0:s.experimentalAttributeUpdateOptimization)===!0,r=e[e.length-1],i=(null==r?void 0:r.transformDirty)||(null===(l=t.transformable)||void 0===l?void 0:l.localDirtyFlag);t.transformable&&((h=t.transformable).dirtyFlag||(h.dirtyFlag=i)),this.internalUpdateTransform(t),i&&(null===(d=t.dirty)||void 0===d||d.call(t,!0,!0));var a=(null===(u=t.renderable)||void 0===u?void 0:u.boundsDirty)||(null===(c=t.renderable)||void 0===c?void 0:c.renderBoundsDirty);if((i||a)&&(null==r?void 0:r.shapeUpdated)===!1&&n)for(var o=e.length-1;o>=0;){var s,l,u,c,h,d,f,v,p=e[o];if(p.shapeUpdated)break;null===(f=(v=p.node).dirty)||void 0===f||f.call(v,!0,!0),p.shapeUpdated=!0,o-=1;}return i;}},{key:"syncHierarchy",value:function(t){for(var e,n,r=[t],i=t.parentNode?[{node:t.parentNode,transformDirty:(null===(e=t.parentNode.transformable)||void 0===e?void 0:e.localDirtyFlag)||(null===(n=t.parentNode.transformable)||void 0===n?void 0:n.dirtyFlag),shapeUpdated:!1}]:[];r.length>0;){for(var a=r.pop(),o=i[i.length-1];i.length>0&&a.parentNode!==o.node;)o=i.pop();var s=this.internalUpdateElement(a,i);if(a.childNodes.length>0){for(var l=a.childNodes.length-1;l>=0;l--)r.push(a.childNodes[l]);i.push({node:a,transformDirty:s,shapeUpdated:!1});}}}},{key:"dirtyLocalTransform",value:function(t,e){n3(t)||e.localDirtyFlag||(e.localDirtyFlag=!0,e.dirtyFlag||this.dirtyWorldTransform(t,e));}},{key:"dirtyWorldTransform",value:function(t,e){this.dirtyWorldInternal(t,e),this.dirtyToRoot(t,!0);}},{key:"dirtyWorldInternal",value:function(t,e){var n,r=this,i=(null===(n=t.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n||null===(n=n.getConfig())||void 0===n||null===(n=n.future)||void 0===n?void 0:n.experimentalAttributeUpdateOptimization)===!0;e.dirtyFlag||(e.dirtyFlag=!0,t.dirty(!0,!0),i||t.childNodes.forEach(function(t){var e=t.transformable;r.dirtyWorldInternal(t,e);}));}},{key:"dirtyToRoot",value:function(t){for(var e,n,r,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=t,o=(null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig())||void 0===e||null===(e=e.future)||void 0===e?void 0:e.experimentalAttributeUpdateOptimization)===!0;a&&(null===(n=(r=a).dirty)||void 0===n||n.call(r,!0,!0),!o);)a=a.parentNode;i&&t.forEach(function(t){var e;null===(e=t.dirty)||void 0===e||e.call(t,!0,!0);}),this.informDependentDisplayObjects(t);var s=t.mutations||[],l=s.find(function(t){return"attributes"===t.type&&t._boundsChangeData;});l?l._boundsChangeData={affectChildren:l._boundsChangeData.affectChildren||i}:(l={type:"attributes",target:t,_boundsChangeData:{affectChildren:i}},s.push(l)),t.mutations=s;}},{key:"dirtyFragment",value:function(t){var e,n=t.transformable;n&&(n.dirtyFlag=!0,n.localDirtyFlag=!0),null===(e=t.dirty)||void 0===e||e.call(t,!0,!0);for(var r=t.childNodes.length,i=0;i<r;i++)this.dirtyFragment(t.childNodes[i]);}},{key:"notifyMutationObservers",value:function(t){var e=new Set;if(t.getRoot().forEach(function(t){(t.mutations||[]).forEach(function(n){"attributes"===n.type&&n._boundsChangeData&&(n._boundsChangeData.affectChildren?t.forEach(function(t){var r=(0,A.default)({},n);r.target=t,e.add(r);}):e.add(n));}),t.mutations=void 0;}),e.size>0){var n=new rG(rH.BOUNDS_CHANGED,{detail:Array.from(e)});t.dispatchEvent(n,!0,!0);}}},{key:"updateDisplayObjectDependency",value:function(t,e,n,r){if(e&&e!==n){var i=this.displayObjectDependencyMap.get(e);if(i&&i[t]){var a=i[t].indexOf(r);i[t].splice(a,1);}}if(n){var o=this.displayObjectDependencyMap.get(n);o||(this.displayObjectDependencyMap.set(n,{}),o=this.displayObjectDependencyMap.get(n)),o[t]||(o[t]=[]),o[t].push(r);}}},{key:"informDependentDisplayObjects",value:function(t){var e,n=this,r=this.displayObjectDependencyMap.get(t);if(r){var i=null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig())||void 0===e||null===(e=e.future)||void 0===e?void 0:e.experimentalCancelEventPropagation;Object.keys(r).forEach(function(t){r[t].forEach(function(e){n.dirtyToRoot(e,!0),e.dispatchEvent(new rY(rH.ATTR_MODIFIED,e,n,n,t,rY.MODIFICATION,n,n),i,i),e.isCustomElement&&e.isConnected&&e.attributeChangedCallback&&e.attributeChangedCallback(t,n,n);});});}}}]),it=(0,R.default)(function t(e){if((0,C.default)(this,t),e<=0)throw Error("LRU capacity must be a positive number.");this.capacity=e,this.cache=new Map;},[{key:"get",value:function(t){if(this.cache.has(t)){var e=this.cache.get(t);return this.cache.delete(t),this.cache.set(t,e),e;}}},{key:"put",value:function(t,e){if(this.cache.has(t)&&this.cache.delete(t),this.cache.set(t,e),this.cache.size>this.capacity){var n=this.cache.keys().next().value;this.cache.delete(n);}}},{key:"len",value:function(){return this.cache.size;}},{key:"clear",value:function(){this.cache.clear();}}]),ie={MetricsString:"|\xc9q\xc5",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},ir=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,ii=new RegExp("".concat(/[!%),.:;?\]}'""]/.source,"|").concat(/[!),.:;?\]}'""]/.source,"|").concat(/[)\]'"?!:;,.]/.source,"|").concat(/[!%),.:;?\]}'"]/.source)),ia=new RegExp("".concat(/[$('"]/.source,"|").concat(/[([{'"]/.source,"|").concat(/[(['"...]/.source,"|").concat(/[$([{'"#]/.source)),io=(0,R.default)(function t(e){var n=this;(0,C.default)(this,t),this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(t,e){return!n.isBreakingSpace(e)&&!!(t&&(ia.exec(e)||ii.exec(t)));},this.trimByKinsokuShorui=function(t){var e=(0,O.default)(t),n=e[e.length-2];if(!n)return t;var r=n[n.length-1];return e[e.length-2]=n.slice(0,-1),e[e.length-1]=r+e[e.length-1],e;},this.runtime=e,this.charWidthCache=new it(100);},[{key:"measureFont",value:function(t,e){if(this.fontMetricsCache[t])return this.fontMetricsCache[t];var n={ascent:0,descent:0,fontSize:0},r=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(e),i=this.runtime.offscreenCanvasCreator.getOrCreateContext(e,{willReadFrequently:!0});i.font=t;var a=ie.MetricsString+ie.BaselineSymbol,o=Math.ceil(i.measureText(a).width),s=Math.ceil(i.measureText(ie.BaselineSymbol).width),l=ie.HeightMultiplier*s;s=s*ie.BaselineMultiplier|0,r.width=o,r.height=l,i.fillStyle="#f00",i.fillRect(0,0,o,l),i.font=t,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(a,0,s);var u=i.getImageData(0,0,o||1,l||1).data,c=u.length,h=4*o,d=0,f=0,v=!1;for(d=0;d<s;++d){for(var p=0;p<h;p+=4)if(255!==u[f+p]){v=!0;break;}if(v)break;f+=h;}for(n.ascent=s-d,f=c-h,v=!1,d=l;d>s;--d){for(var g=0;g<h;g+=4)if(255!==u[f+g]){v=!0;break;}if(v)break;f-=h;}return n.descent=d-s,n.fontSize=n.ascent+n.descent,this.fontMetricsCache[t]=n,n;}},{key:"measureText",value:function(t,e,n){var r=e.fontSize,i=void 0===r?16:r,a=e.wordWrap,o=e.lineHeight,s=e.lineWidth,l=void 0===s?1:s,u=e.textBaseline,c=void 0===u?"alphabetic":u,h=e.textAlign,d=void 0===h?"start":h,f=e.letterSpacing,v=void 0===f?0:f,p=e.textPath;e.textPathSide,e.textPathStartOffset;var g=e.leading,y=void 0===g?0:g,m=rh(e),k=this.measureFont(m,n);0===k.fontSize&&(k.fontSize=i,k.ascent=i);var E=this.runtime.offscreenCanvasCreator.getOrCreateContext(n);E.font=m,e.isOverflowing=!1;var x=(void 0!==a&&a?this.wordWrap(t,e,n):t).split(/(?:\r\n|\r|\n)/),T=Array(x.length),N=0;if(p){p.getTotalLength();for(var b=0;b<x.length;b++)E.measureText(x[b]).width,x[b].length;}else{for(var S=0;S<x.length;S++){var w=E.measureText(x[S]).width+(x[S].length-1)*v;T[S]=w,N=Math.max(N,w);}var P=N+l,M=o||k.fontSize+l,A=Math.max(M,k.fontSize+l)+(x.length-1)*(M+y);M+=y;var C=0;return"middle"===c?C=-A/2:"bottom"===c||"alphabetic"===c||"ideographic"===c?C=-A:("top"===c||"hanging"===c)&&(C=0),{font:m,width:P,height:A,lines:x,lineWidths:T,lineHeight:M,maxLineWidth:N,fontProperties:k,lineMetrics:T.map(function(t,e){var n=0;return"center"===d||"middle"===d?n-=t/2:("right"===d||"end"===d)&&(n-=t),new tl(n-l/2,C+e*M,t+l,M);})};}}},{key:"wordWrap",value:function(t,e,n){var r=this,i=Array.from(t);if(0===i.length)return"";var a=this,o=e.wordWrapWidth,s=e.letterSpacing,l=void 0===s?0:s,u=e.maxLines,c=void 0===u?1/0:u,h=e.textOverflow,d=this.runtime.offscreenCanvasCreator.getOrCreateContext(n),f=(void 0===o?0:o)+l,v="";"ellipsis"===h?v="...":h&&"clip"!==h&&(v=h);var p=[""],g=0,y=0,m=-1,k=rh(e),E=this.charWidthCache.get(k);E||(E=new it(500),this.charWidthCache.put(k,E));var x=function(t){return r.getFromCache(t,l,E,d);},T=x(v);function N(t,e,n,r){for(;x(t)<r&&e<i.length-1&&!a.isNewline(i[e+1]);)e+=1,t+=i[e];for(;x(t)>r&&e>=n;)e-=1,t=t.slice(0,-1);return{lineTxt:t,txtLastCharIndex:e};}function b(t,e){if(!(T<=0)&&!(T>f)){if(!p[t]){p[t]=v;return;}var n=N(p[t],e,m+1,f-T);p[t]=n.lineTxt+v;}}for(var S=0;S<i.length;S++){var w=i[S],P=i[S-1],M=i[S+1],A=x(w);if(this.isNewline(w)){if(g+1>=c){S<i.length-1&&b(g,S-1),e.isOverflowing=!0;break;}m=S-1,y=0,p[g+=1]="";continue;}if(A>f){b(g,S-1),e.isOverflowing=!0;break;}if(y>0&&y+A>f){var C=N(p[g],S-1,m+1,f);if(C.txtLastCharIndex!==S-1){if(p[g]=C.lineTxt,C.txtLastCharIndex===i.length-1)break;w=i[S=C.txtLastCharIndex+1],P=i[S-1],M=i[S+1],A=x(w);}if(g+1>=c){b(g,S-1),e.isOverflowing=!0;break;}if(m=S-1,y=0,p[g+=1]="",this.isBreakingSpace(w))continue;this.canBreakInLastChar(w)||(p=this.trimToBreakable(p),y=this.sumTextWidthByCache(p[g]||"",x)),this.shouldBreakByKinsokuShorui(w,M)&&(p=this.trimByKinsokuShorui(p),y+=x(P||""));}y+=A,p[g]+=w;}return p.join("\n");}},{key:"isBreakingSpace",value:function(t){return"string"==typeof t&&ie.BreakingSpaces.indexOf(t.charCodeAt(0))>=0;}},{key:"isNewline",value:function(t){return"string"==typeof t&&ie.Newlines.indexOf(t.charCodeAt(0))>=0;}},{key:"trimToBreakable",value:function(t){var e=(0,O.default)(t),n=e[e.length-2],r=this.findBreakableIndex(n);if(-1===r||!n)return e;var i=n.slice(r,r+1),a=this.isBreakingSpace(i);return e[e.length-1]+=n.slice(r+1,n.length),e[e.length-2]=n.slice(0,r+(a?0:1)),e;}},{key:"canBreakInLastChar",value:function(t){return!(t&&ir.test(t));}},{key:"sumTextWidthByCache",value:function(t,e){return t.split("").reduce(function(t,n){return t+e(n);},0);}},{key:"findBreakableIndex",value:function(t){for(var e=t.length-1;e>=0;e--)if(!ir.test(t[e]))return e;return -1;}},{key:"getFromCache",value:function(t,e,n,r){var i=n.get(t);if("number"!=typeof i){var a=t.length*e;i=r.measureText(t).width+a,n.put(t,i);}return i;}},{key:"clearCache",value:function(){this.fontMetricsCache={},this.charWidthCache.clear();}}]),is={},il=(T=new rA,N=new rM,x={},(0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)(x,j.FRAGMENT,null),j.CIRCLE,new rb),j.ELLIPSE,new rS),j.RECT,T),j.IMAGE,T),j.GROUP,new rR),j.LINE,new rw),j.TEXT,new rC(is)),j.POLYLINE,N),j.POLYGON,N),(0,B.default)((0,B.default)((0,B.default)(x,j.PATH,new rP),j.HTML,new rO),j.MESH,null)),iu=(S=new nB,w=new nz,b={},(0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)(b,t_.PERCENTAGE,null),t_.NUMBER,new nq),t_.ANGLE,new nG),t_.DEFINED_PATH,new nF),t_.PAINT,S),t_.COLOR,S),t_.FILTER,new nU),t_.LENGTH,w),t_.LENGTH_PERCENTAGE,w),t_.LENGTH_PERCENTAGE_12,new nH),(0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)(b,t_.LENGTH_PERCENTAGE_14,new nY),t_.COORDINATE,new nz),t_.OFFSET_DISTANCE,new nX),t_.OPACITY_VALUE,new nj),t_.PATH,new n$),t_.LIST_OF_POINTS,new nK),t_.SHADOW_BLUR,new nZ),t_.TEXT,new nQ),t_.TEXT_TRANSFORM,new nJ),t_.TRANSFORM,new rx),(0,B.default)((0,B.default)((0,B.default)(b,t_.TRANSFORM_ORIGIN,new rT),t_.Z_INDEX,new rN),t_.MARKER,new nW));is.CameraContribution=tM,is.AnimationTimeline=null,is.EasingFunction=null,is.offscreenCanvasCreator=new rB,is.sceneGraphSelector=new rz,is.sceneGraphService=new r8(is),is.textService=new io(is),is.geometryUpdaterFactory=il,is.CSSPropertySyntaxFactory=iu,is.styleValueRegistry=new nD(is),is.layoutRegistry=null,is.globalThis="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==X?X:{},is.enableStyleSyntax=!0,is.enableSizeAttenuation=!1;var ic=0,ih=new rY(rH.INSERTED,null,"","","",0,"",""),id=new rY(rH.REMOVED,null,"","","",0,"",""),iv=new rG(rH.DESTROY),ip=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).entity=ic++,t.transformable={dirtyFlag:!1,localDirtyFlag:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},t.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},t.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},t.cullable={strategy:tA.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},t.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},t.rBushNode={aabb:void 0},t.namespaceURI="g",t.scrollLeft=0,t.scrollTop=0,t.clientTop=0,t.clientLeft=0,t.style={},t.computedStyle={},t.parsedStyle={},t.attributes={},t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"dirty",value:function(){var t=!(arguments.length>0)||void 0===arguments[0]||arguments[0],e=arguments.length>1?arguments[1]:void 0;this.renderable.dirty=t,void 0!==e&&(this.renderable.boundsDirty=e,this.renderable.renderBoundsDirty=e,this.geometry.dirty=e);}},{key:"className",get:function(){return this.getAttribute("class")||"";},set:function(t){this.setAttribute("class",t);}},{key:"classList",get:function(){return this.className.split(" ").filter(function(t){return""!==t;});}},{key:"tagName",get:function(){return this.nodeName;}},{key:"children",get:function(){return this.childNodes;}},{key:"childElementCount",get:function(){return this.childNodes.length;}},{key:"firstElementChild",get:function(){return this.firstChild;}},{key:"lastElementChild",get:function(){return this.lastChild;}},{key:"parentElement",get:function(){return this.parentNode;}},{key:"nextSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t+1]||null;}return null;}},{key:"previousSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t-1]||null;}return null;}},{key:"cloneNode",value:function(t){throw Error(tu);}},{key:"appendChild",value:function(t,e){var n;if(t.destroyed)throw Error("Cannot append a destroyed element.");return is.sceneGraphService.attach(t,this,e),null!==(n=this.ownerDocument)&&void 0!==n&&n.defaultView&&(n3(this)||t.nodeName!==j.FRAGMENT?this.ownerDocument.defaultView.mountChildren(t):this.ownerDocument.defaultView.mountFragment(t)),this.isMutationObserved&&(ih.relatedNode=this,t.dispatchEvent(ih)),t;}},{key:"insertBefore",value:function(t,e){if(e){t.parentElement&&t.parentElement.removeChild(t);var n=this.childNodes.indexOf(e);-1===n?this.appendChild(t):this.appendChild(t,n);}else this.appendChild(t);return t;}},{key:"replaceChild",value:function(t,e){var n=this.childNodes.indexOf(e);return this.removeChild(e),this.appendChild(t,n),e;}},{key:"removeChild",value:function(t){var e,n,r=(null===(e=this.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig().future)||void 0===e?void 0:e.experimentalCancelEventPropagation)===!0;return id.relatedNode=this,t.dispatchEvent(id,r,r),null!==(n=t.ownerDocument)&&void 0!==n&&n.defaultView&&t.ownerDocument.defaultView.unmountChildren(t),is.sceneGraphService.detach(t),t;}},{key:"removeChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var e=this.childNodes[t];this.removeChild(e);}}},{key:"destroyChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var e=this.childNodes[t];e.childNodes.length>0&&e.destroyChildren(),e.destroy();}}},{key:"matches",value:function(t){return is.sceneGraphService.matches(t,this);}},{key:"getElementById",value:function(t){return is.sceneGraphService.querySelector("#".concat(t),this);}},{key:"getElementsByName",value:function(t){return is.sceneGraphService.querySelectorAll('[name="'.concat(t,'"]'),this);}},{key:"getElementsByClassName",value:function(t){return is.sceneGraphService.querySelectorAll(".".concat(t),this);}},{key:"getElementsByTagName",value:function(t){return is.sceneGraphService.querySelectorAll(t,this);}},{key:"querySelector",value:function(t){return is.sceneGraphService.querySelector(t,this);}},{key:"querySelectorAll",value:function(t){return is.sceneGraphService.querySelectorAll(t,this);}},{key:"closest",value:function(t){var e=this;do{if(is.sceneGraphService.matches(t,e))return e;e=e.parentElement;}while(null!==e)return null;}},{key:"find",value:function(t){var e=this,n=null;return this.forEach(function(r){return!(r!==e&&t(r))||(n=r,!1);}),n;}},{key:"findAll",value:function(t){var e=this,n=[];return this.forEach(function(r){r!==e&&t(r)&&n.push(r);}),n;}},{key:"after",value:function(){var t=this;if(this.parentNode){for(var e=this.parentNode.childNodes.indexOf(this),n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];r.forEach(function(n,r){var i;return null===(i=t.parentNode)||void 0===i?void 0:i.appendChild(n,e+r+1);});}}},{key:"before",value:function(){if(this.parentNode){for(var t=this.parentNode.childNodes.indexOf(this),e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n[0],a=(0,V.default)(n).slice(1);this.parentNode.appendChild(i,t),i.after.apply(i,(0,O.default)(a));}}},{key:"replaceWith",value:function(){this.after.apply(this,arguments),this.remove();}},{key:"append",value:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(function(e){return t.appendChild(e);});}},{key:"prepend",value:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(function(e,n){return t.appendChild(e,n);});}},{key:"replaceChildren",value:function(){for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,arguments);}},{key:"remove",value:function(){return this.parentNode?this.parentNode.removeChild(this):this;}},{key:"destroy",value:function(){var t,e=(null===(t=this.ownerDocument)||void 0===t||null===(t=t.defaultView)||void 0===t||null===(t=t.getConfig().future)||void 0===t?void 0:t.experimentalCancelEventPropagation)===!0;this.destroyChildren(),this.dispatchEvent(iv,e,e),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0;}},{key:"getGeometryBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return is.sceneGraphService.getGeometryBounds(this,t);}},{key:"getTransformedGeometryBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return is.sceneGraphService.getTransformedGeometryBounds(this,t);}},{key:"getBounds",value:function(){return is.sceneGraphService.getBounds(this);}},{key:"getRenderBounds",value:function(){return is.sceneGraphService.getBounds(this,!0);}},{key:"getLocalBounds",value:function(){return is.sceneGraphService.getLocalBounds(this);}},{key:"getBoundingClientRect",value:function(){return is.sceneGraphService.getBoundingClientRect(this);}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()];}},{key:"computedStyleMap",value:function(){return new Map(Object.entries(this.computedStyle));}},{key:"getAttributeNames",value:function(){return Object.keys(this.attributes);}},{key:"getAttribute",value:function(t){if("symbol"!=typeof t)return this.attributes[t];}},{key:"hasAttribute",value:function(t){return this.getAttributeNames().includes(t);}},{key:"hasAttributes",value:function(){return!!this.getAttributeNames().length;}},{key:"removeAttribute",value:function(t){this.setAttribute(t,null),delete this.attributes[t];}},{key:"setAttribute",value:function(t,e){this.attributes[t]=e;}},{key:"getAttributeNS",value:function(t,e){throw Error(tu);}},{key:"getAttributeNode",value:function(t){throw Error(tu);}},{key:"getAttributeNodeNS",value:function(t,e){throw Error(tu);}},{key:"hasAttributeNS",value:function(t,e){throw Error(tu);}},{key:"removeAttributeNS",value:function(t,e){throw Error(tu);}},{key:"removeAttributeNode",value:function(t){throw Error(tu);}},{key:"setAttributeNS",value:function(t,e,n){throw Error(tu);}},{key:"setAttributeNode",value:function(t){throw Error(tu);}},{key:"setAttributeNodeNS",value:function(t){throw Error(tu);}},{key:"toggleAttribute",value:function(t,e){throw Error(tu);}}]);}(rF);function ig(t){return!!(null!=t&&t.nodeName);}var iy=is.globalThis.Proxy?is.globalThis.Proxy:function(){},im=new rY(rH.ATTR_MODIFIED,null,null,null,null,rY.MODIFICATION,null,null),ik=G.vec3.create(),iE=G.quat.create(),ix=function(t){function e(t){var n;return(0,C.default)(this,e),(n=(0,L.default)(this,e)).isCustomElement=!1,n.isMutationObserved=!1,n.activeAnimations=[],n.config=t,n.id=t.id||"",n.name=t.name||"",(t.className||t.class)&&(n.className=t.className||t.class),n.nodeName=t.type||j.GROUP,t.initialParsedStyle&&Object.assign(n.parsedStyle,t.initialParsedStyle),n.initAttributes(t.style),is.enableStyleSyntax&&(n.style=new iy({setProperty:function(t,e){n.setAttribute(t,e);},getPropertyValue:function(t){return n.getAttribute(t);},removeProperty:function(t){n.removeAttribute(t);},item:function(){return"";}},{get:function(t,e){return void 0!==t[e]?t[e]:n.getAttribute(e);},set:function(t,e,r){return n.setAttribute(e,r),!0;}})),n;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"destroy",value:function(){(0,U.default)(e,"destroy",this,3)([]),this.getAnimations().forEach(function(t){t.cancel();});}},{key:"cloneNode",value:function(t,e){var n=(0,A.default)({},this.attributes);for(var r in n){var i=n[r];ig(i)&&"clipPath"!==r&&"offsetPath"!==r&&"textPath"!==r&&(n[r]=i.cloneNode(t)),e&&(n[r]=e(r,i));}var a=new this.constructor((0,A.default)((0,A.default)({},this.config),{},{style:n}));return a.setLocalTransform(this.getLocalTransform()),t&&this.children.forEach(function(e){if(!e.style.isMarker){var n=e.cloneNode(t);a.appendChild(n);}}),a;}},{key:"initAttributes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};is.styleValueRegistry.processProperties(this,t,{forceUpdateGeometry:!0}),this.dirty();}},{key:"setAttribute",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!(arguments.length>3)||void 0===arguments[3]||arguments[3];!(0,F.isUndefined)(n)&&(r||n!==this.attributes[t])&&(this.internalSetAttribute(t,n,{memoize:i}),(0,U.default)(e,"setAttribute",this,3)([t,n]));}},{key:"internalSetAttribute",value:function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.attributes[t],a=this.parsedStyle[t];is.styleValueRegistry.processProperties(this,(0,B.default)({},t,e),r),this.dirty();var o=this.parsedStyle[t];if(this.isConnected){if(im.relatedNode=this,im.prevValue=i,im.newValue=e,im.attrName=t,im.prevParsedValue=a,im.newParsedValue=o,this.isMutationObserved)this.dispatchEvent(im);else{var s,l=(null===(s=this.ownerDocument.defaultView.getConfig().future)||void 0===s?void 0:s.experimentalCancelEventPropagation)===!0;im.target=this,this.ownerDocument.defaultView.dispatchEvent(im,!0,l);}}(this.isCustomElement&&this.isConnected||!this.isCustomElement)&&(null===(n=this.attributeChangedCallback)||void 0===n||n.call(this,t,i,e,a,o));}},{key:"getBBox",value:function(){var t=this.getBounds(),e=t.getMin(),n=(0,D.default)(e,2),r=n[0],i=n[1],a=t.getMax(),o=(0,D.default)(a,2);return new tl(r,i,o[0]-r,o[1]-i);}},{key:"setOrigin",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return is.sceneGraphService.setOrigin(this,td(t,e,n,!1)),this;}},{key:"getOrigin",value:function(){return is.sceneGraphService.getOrigin(this);}},{key:"setPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return is.sceneGraphService.setPosition(this,td(t,e,n,!1)),this;}},{key:"setLocalPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return is.sceneGraphService.setLocalPosition(this,td(t,e,n,!1)),this;}},{key:"translate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return is.sceneGraphService.translate(this,td(t,e,n,!1)),this;}},{key:"translateLocal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return is.sceneGraphService.translateLocal(this,td(t,e,n,!1)),this;}},{key:"getPosition",value:function(){return is.sceneGraphService.getPosition(this);}},{key:"getLocalPosition",value:function(){return is.sceneGraphService.getLocalPosition(this);}},{key:"scale",value:function(t,e,n){return this.scaleLocal(t,e,n);}},{key:"scaleLocal",value:function(t,e,n){return"number"==typeof t&&(e=e||t,n=n||t,t=td(t,e,n,!1)),is.sceneGraphService.scaleLocal(this,t),this;}},{key:"setLocalScale",value:function(t,e,n){return"number"==typeof t&&(e=e||t,n=n||t,t=td(t,e,n,!1)),is.sceneGraphService.setLocalScale(this,t),this;}},{key:"getLocalScale",value:function(){return is.sceneGraphService.getLocalScale(this);}},{key:"getScale",value:function(){return is.sceneGraphService.getScale(this);}},{key:"getEulerAngles",value:function(){var t=tg(ik,is.sceneGraphService.getWorldTransform(this));return(0,D.default)(t,3)[2]*tv;}},{key:"getLocalEulerAngles",value:function(){var t=tg(ik,is.sceneGraphService.getLocalRotation(this));return(0,D.default)(t,3)[2]*tv;}},{key:"setEulerAngles",value:function(t){return is.sceneGraphService.setEulerAngles(this,0,0,t),this;}},{key:"setLocalEulerAngles",value:function(t){return is.sceneGraphService.setLocalEulerAngles(this,0,0,t),this;}},{key:"rotateLocal",value:function(t,e,n){return(0,F.isNil)(e)&&(0,F.isNil)(n)?is.sceneGraphService.rotateLocal(this,0,0,t):is.sceneGraphService.rotateLocal(this,t,e,n),this;}},{key:"rotate",value:function(t,e,n){return(0,F.isNil)(e)&&(0,F.isNil)(n)?is.sceneGraphService.rotate(this,0,0,t):is.sceneGraphService.rotate(this,t,e,n),this;}},{key:"setRotation",value:function(t,e,n,r){return is.sceneGraphService.setRotation(this,t,e,n,r),this;}},{key:"setLocalRotation",value:function(t,e,n,r){return is.sceneGraphService.setLocalRotation(this,t,e,n,r),this;}},{key:"setLocalSkew",value:function(t,e){return is.sceneGraphService.setLocalSkew(this,t,e),this;}},{key:"getRotation",value:function(){return is.sceneGraphService.getRotation(this);}},{key:"getLocalRotation",value:function(){return is.sceneGraphService.getLocalRotation(this);}},{key:"getLocalSkew",value:function(){return is.sceneGraphService.getLocalSkew(this);}},{key:"getLocalTransform",value:function(){return is.sceneGraphService.getLocalTransform(this);}},{key:"getWorldTransform",value:function(){return is.sceneGraphService.getWorldTransform(this);}},{key:"setLocalTransform",value:function(t){return is.sceneGraphService.setLocalTransform(this,t),this;}},{key:"resetLocalTransform",value:function(){is.sceneGraphService.resetLocalTransform(this);}},{key:"getAnimations",value:function(){return this.activeAnimations;}},{key:"animate",value:function(t,e){var n,r=null===(n=this.ownerDocument)||void 0===n?void 0:n.timeline;return r?r.play(this,t,e):null;}},{key:"isVisible",value:function(){var t;return(null===(t=this.parsedStyle)||void 0===t?void 0:t.visibility)!=="hidden";}},{key:"interactive",get:function(){return this.isInteractive();},set:function(t){this.style.pointerEvents=t?"auto":"none";}},{key:"isInteractive",value:function(){var t;return(null===(t=this.parsedStyle)||void 0===t?void 0:t.pointerEvents)!=="none";}},{key:"isCulled",value:function(){return!!(this.cullable&&this.cullable.enable&&!this.cullable.visible);}},{key:"toFront",value:function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,(0,O.default)(this.parentNode.children.map(function(t){return Number(t.style.zIndex);})))+1),this;}},{key:"toBack",value:function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,(0,O.default)(this.parentNode.children.map(function(t){return Number(t.style.zIndex);})))-1),this;}},{key:"getConfig",value:function(){return this.config;}},{key:"attr",value:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n[0],a=n[1];return i?(0,F.isObject)(i)?(Object.keys(i).forEach(function(e){t.setAttribute(e,i[e]);}),this):2===n.length?(this.setAttribute(i,a),this):this.attributes[i]:this.attributes;}},{key:"getMatrix",value:function(t){var e,n,r,i=t||this.getWorldTransform(),a=G.mat4.getTranslation(ik,i),o=(0,D.default)(a,2),s=o[0],l=o[1],u=G.mat4.getScaling(ik,i),c=(0,D.default)(u,2),h=c[0],d=c[1],f=tg(ik,G.mat4.getRotation(iE,i)),v=(0,D.default)(f,3),p=v[0],g=v[2];return n=Math.cos(e=p||g),r=Math.sin(e),G.mat3.fromValues(h*n,d*r,0,-h*r,d*n,0,s,l,1);}},{key:"getLocalMatrix",value:function(){return this.getMatrix(this.getLocalTransform());}},{key:"setMatrix",value:function(t){var e=ty(t),n=(0,D.default)(e,5),r=n[0],i=n[1],a=n[2],o=n[3],s=n[4];this.setEulerAngles(s).setPosition(r,i).setLocalScale(a,o);}},{key:"setLocalMatrix",value:function(t){var e=ty(t),n=(0,D.default)(e,5),r=n[0],i=n[1],a=n[2],o=n[3],s=n[4];this.setLocalEulerAngles(s).setLocalPosition(r,i).setLocalScale(a,o);}},{key:"show",value:function(){this.forEach(function(t){t.style.visibility="visible";});}},{key:"hide",value:function(){this.forEach(function(t){t.style.visibility="hidden";});}},{key:"getCount",value:function(){return this.childElementCount;}},{key:"getParent",value:function(){return this.parentElement;}},{key:"getChildren",value:function(){return this.children;}},{key:"getFirst",value:function(){return this.firstElementChild;}},{key:"getLast",value:function(){return this.lastElementChild;}},{key:"getChildByIndex",value:function(t){return this.children[t]||null;}},{key:"add",value:function(t,e){return this.appendChild(t,e);}},{key:"set",value:function(t,e){this.config[t]=e;}},{key:"get",value:function(t){return this.config[t];}},{key:"moveTo",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(t,e,n),this;}},{key:"move",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(t,e,n),this;}},{key:"setZIndex",value:function(t){return this.style.zIndex=t,this;}}]);}(ip);ix.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","display","draggable","droppable","fill","fillOpacity","fillRule","filter","increasedLineWidthForHitTesting","lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit","hitArea","offsetDistance","offsetPath","offsetX","offsetY","opacity","pointerEvents","shadowColor","shadowType","shadowBlur","shadowOffsetX","shadowOffsetY","stroke","strokeOpacity","strokeWidth","strokeLinecap","strokeLineJoin","strokeDasharray","strokeDashoffset","transform","transformOrigin","textTransform","visibility","zIndex"]);var iT=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.CIRCLE},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(ix);iT.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(ix.PARSED_STYLE_LIST),["cx","cy","cz","r","isBillboard","isSizeAttenuation"]));var iN=["style"];(function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iN);return(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({style:r},i)])).isCustomElement=!0,t;}return(0,I.default)(e,t),(0,R.default)(e);})(ix).PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var ib=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.ELLIPSE},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(ix);ib.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(ix.PARSED_STYLE_LIST),["cx","cy","cz","rx","ry","isBillboard","isSizeAttenuation"])),function(t){function e(){return(0,C.default)(this,e),(0,L.default)(this,e,[{type:j.FRAGMENT}]);}return(0,I.default)(e,t),(0,R.default)(e);}(ix).PARSED_STYLE_LIST=new Set(["class","className"]);var iS=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.GROUP},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(ix);iS.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var iw=["style"],iP=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iw);return(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({type:j.HTML,style:r},i)])).cullable.enable=!1,t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getDomElement",value:function(){return this.parsedStyle.$el;}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()];}},{key:"getLocalBounds",value:function(){if(this.parentNode){var t=G.mat4.invert(G.mat4.create(),this.parentNode.getWorldTransform()),e=this.getBounds();if(!tr.isEmpty(e)){var n=new tr;return n.setFromTransformedAABB(e,t),n;}}return this.getBounds();}}]);}(ix);iP.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(ix.PARSED_STYLE_LIST),["x","y","$el","innerHTML","width","height"]));var iM=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.IMAGE},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(ix);iM.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(ix.PARSED_STYLE_LIST),["x","y","z","src","width","height","isBillboard","billboardRotation","isSizeAttenuation","keepAspectRatio"]));var iA=["style"],iC=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iA);(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({type:j.LINE,style:(0,A.default)({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},r)},i)])).markerStartAngle=0,t.markerEndAngle=0;var a=t.parsedStyle,o=a.markerStart,s=a.markerEnd;return o&&ig(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),s&&ig(s)&&(t.markerEndAngle=s.getLocalEulerAngles(),t.appendChild(s)),t.transformMarker(!0),t.transformMarker(!1),t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"x1"===t||"y1"===t||"x2"===t||"y2"===t||"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&ig(r)&&(this.markerStartAngle=0,r.remove()),i&&ig(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t&&(r&&ig(r)&&(this.markerEndAngle=0,r.remove()),i&&ig(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1)));}},{key:"transformMarker",value:function(t){var e,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,h=s.markerEndOffset,d=s.x1,f=s.x2,v=s.y1,p=s.y2,g=t?l:u;if(g&&ig(g)){var y=0;t?(r=d,i=v,e=f-d,n=p-v,a=c||0,o=this.markerStartAngle):(r=f,i=p,e=d-f,n=v-p,a=h||0,o=this.markerEndAngle),y=Math.atan2(n,e),g.setLocalEulerAngles(180*y/Math.PI+o),g.setLocalPosition(r+Math.cos(y)*a,i+Math.sin(y)*a);}}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle,r=n.x1,i=n.y1,a=n.x2,o=n.y2,s=(0,z.linePointAt)(r,i,a,o,t),l=s.x,u=s.y,c=G.vec3.transformMat4(G.vec3.create(),G.vec3.fromValues(l,u,0),e?this.getWorldTransform():this.getLocalTransform());return new ts(c[0],c[1]);}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(t/this.getTotalLength(),e);}},{key:"getTotalLength",value:function(){var t=this.parsedStyle,e=t.x1,n=t.y1,r=t.x2,i=t.y2;return(0,z.lineLength)(e,n,r,i);}}]);}(ix);iC.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(ix.PARSED_STYLE_LIST),["x1","y1","x2","y2","z1","z2","isBillboard","isSizeAttenuation","markerStart","markerEnd","markerStartOffset","markerEndOffset"]));var iR=["style"],iO=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iR);(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({type:j.PATH,style:r,initialParsedStyle:{miterLimit:4,d:(0,A.default)({},tD)}},i)])).markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var a=t.parsedStyle,o=a.markerStart,s=a.markerEnd,l=a.markerMid;return o&&ig(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),l&&ig(l)&&t.placeMarkerMid(l),s&&ig(s)&&(t.markerEndAngle=s.getLocalEulerAngles(),t.appendChild(s)),t.transformMarker(!0),t.transformMarker(!1),t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"d"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&ig(r)&&(this.markerStartAngle=0,r.remove()),i&&ig(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t?(r&&ig(r)&&(this.markerEndAngle=0,r.remove()),i&&ig(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(i);}},{key:"transformMarker",value:function(t){var e,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,h=s.markerEndOffset,d=t?l:u;if(d&&ig(d)){var f=0;if(t){var v=this.getStartTangent(),p=(0,D.default)(v,2),g=p[0],y=p[1];r=y[0],i=y[1],e=g[0]-y[0],n=g[1]-y[1],a=c||0,o=this.markerStartAngle;}else{var m=this.getEndTangent(),k=(0,D.default)(m,2),E=k[0],x=k[1];r=x[0],i=x[1],e=E[0]-x[0],n=E[1]-x[1],a=h||0,o=this.markerEndAngle;}f=Math.atan2(n,e),d.setLocalEulerAngles(180*f/Math.PI+o),d.setLocalPosition(r+Math.cos(f)*a,i+Math.sin(f)*a);}}},{key:"placeMarkerMid",value:function(t){var e=this.parsedStyle.d.segments;if(this.markerMidList.forEach(function(t){t.remove();}),t&&ig(t))for(var n=1;n<e.length-1;n++){var r=(0,D.default)(e[n].currentPoint,2),i=r[0],a=r[1],o=1===n?t:t.cloneNode(!0);this.markerMidList.push(o),this.appendChild(o),o.setLocalPosition(i,a);}}},{key:"getTotalLength",value:function(){return e8(this);}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle.d.absolutePath,r=(0,F.getPointAtLength)(n,t),i=r.x,a=r.y,o=G.vec3.transformMat4(G.vec3.create(),G.vec3.fromValues(i,a,0),e?this.getWorldTransform():this.getLocalTransform());return new ts(o[0],o[1]);}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPointAtLength(t*e8(this),e);}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.d.segments,e=[];if(t.length>1){var n=t[0].currentPoint,r=t[1].currentPoint,i=t[1].startTangent;e=[],i?e.push([n[0]-i[0],n[1]-i[1]]):e.push([r[0],r[1]]),e.push([n[0],n[1]]);}return e;}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.d.segments,e=t.length,n=[];if(e>1){var r=t[e-2].currentPoint,i=t[e-1].currentPoint,a=t[e-1].endTangent;n=[],a?n.push([i[0]-a[0],i[1]-a[1]]):n.push([r[0],r[1]]),n.push([i[0],i[1]]);}return n;}}]);}(ix);iO.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(ix.PARSED_STYLE_LIST),["d","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard","isSizeAttenuation"]));var iL=["style"],iI=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iL);(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({type:j.POLYGON,style:r,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},i)])).markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var a=t.parsedStyle,o=a.markerStart,s=a.markerEnd,l=a.markerMid;return o&&ig(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),l&&ig(l)&&t.placeMarkerMid(l),s&&ig(s)&&(t.markerEndAngle=s.getLocalEulerAngles(),t.appendChild(s)),t.transformMarker(!0),t.transformMarker(!1),t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"points"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&ig(r)&&(this.markerStartAngle=0,r.remove()),i&&ig(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t?(r&&ig(r)&&(this.markerEndAngle=0,r.remove()),i&&ig(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(i);}},{key:"transformMarker",value:function(t){var e,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,h=s.markerEndOffset,d=(s.points||{}).points,f=t?l:u;if(f&&ig(f)&&d){var v=0;if(r=d[0][0],i=d[0][1],t)e=d[1][0]-d[0][0],n=d[1][1]-d[0][1],a=c||0,o=this.markerStartAngle;else{var p=d.length;this.parsedStyle.isClosed?(e=d[p-1][0]-d[0][0],n=d[p-1][1]-d[0][1]):(r=d[p-1][0],i=d[p-1][1],e=d[p-2][0]-d[p-1][0],n=d[p-2][1]-d[p-1][1]),a=h||0,o=this.markerEndAngle;}v=Math.atan2(n,e),f.setLocalEulerAngles(180*v/Math.PI+o),f.setLocalPosition(r+Math.cos(v)*a,i+Math.sin(v)*a);}}},{key:"placeMarkerMid",value:function(t){var e=(this.parsedStyle.points||{}).points;if(this.markerMidList.forEach(function(t){t.remove();}),this.markerMidList=[],t&&ig(t)&&e)for(var n=1;n<(this.parsedStyle.isClosed?e.length:e.length-1);n++){var r=e[n][0],i=e[n][1],a=1===n?t:t.cloneNode(!0);this.markerMidList.push(a),this.appendChild(a),a.setLocalPosition(r,i);}}}]);}(ix);iI.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(ix.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isClosed","isBillboard","isSizeAttenuation"]));var iD=["style"],i_=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.style,r=(0,q.default)(t,iD);return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.POLYLINE,style:n,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},r)]);}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getTotalLength",value:function(){return 0===this.parsedStyle.points.totalLength&&(this.parsedStyle.points.totalLength=(0,z.polylineLength)(this.parsedStyle.points.points)),this.parsedStyle.points.totalLength;}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(t/this.getTotalLength(),e);}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle.points.points;if(0===this.parsedStyle.points.segments.length){var r,i,a=[],o=0,s=this.getTotalLength();n.forEach(function(t,e){n[e+1]&&((r=[0,0])[0]=o/s,i=(0,z.lineLength)(t[0],t[1],n[e+1][0],n[e+1][1]),o+=i,r[1]=o/s,a.push(r));}),this.parsedStyle.points.segments=a;}var l=0,u=0;this.parsedStyle.points.segments.forEach(function(e,n){t>=e[0]&&t<=e[1]&&(l=(t-e[0])/(e[1]-e[0]),u=n);});var c=(0,z.linePointAt)(n[u][0],n[u][1],n[u+1][0],n[u+1][1],l),h=c.x,d=c.y,f=G.vec3.transformMat4(G.vec3.create(),G.vec3.fromValues(h,d,0),e?this.getWorldTransform():this.getLocalTransform());return new ts(f[0],f[1]);}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.points.points,e=[];return e.push([t[1][0],t[1][1]]),e.push([t[0][0],t[0][1]]),e;}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.points.points,e=t.length-1,n=[];return n.push([t[e-1][0],t[e-1][1]]),n.push([t[e][0],t[e][1]]),n;}}]);}(iI);i_.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iI.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard"]));var iG=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.RECT},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(ix);iG.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(ix.PARSED_STYLE_LIST),["x","y","z","width","height","isBillboard","isSizeAttenuation","radius"]));var iF=["style"],iB=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.style,r=(0,q.default)(t,iF);return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.TEXT,style:(0,A.default)({fill:"black"},n)},r)]);}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getComputedTextLength",value:function(){var t;return this.getGeometryBounds(),(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.maxLineWidth)||0;}},{key:"getLineBoundingRects",value:function(){var t;return this.getGeometryBounds(),(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.lineMetrics)||[];}},{key:"isOverflowing",value:function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing;}}]);}(ix);iB.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(ix.PARSED_STYLE_LIST),["x","y","z","isBillboard","billboardRotation","isSizeAttenuation","text","textAlign","textBaseline","fontStyle","fontSize","fontFamily","fontWeight","fontVariant","lineHeight","letterSpacing","leading","wordWrap","wordWrapWidth","maxLines","textOverflow","isOverflowing","textPath","textDecorationLine","textDecorationColor","textDecorationStyle","textDecorationThickness","textPathSide","textPathStartOffset","metrics","dx","dy"])),(0,R.default)(function t(){(0,C.default)(this,t),this.registry={},this.define(j.CIRCLE,iT),this.define(j.ELLIPSE,ib),this.define(j.RECT,iG),this.define(j.IMAGE,iM),this.define(j.LINE,iC),this.define(j.GROUP,iS),this.define(j.PATH,iO),this.define(j.POLYGON,iI),this.define(j.POLYLINE,i_),this.define(j.TEXT,iB),this.define(j.HTML,iP);},[{key:"define",value:function(t,e){this.registry[t]=e;}},{key:"get",value:function(t){return this.registry[t];}}]),function(){function t(e){(0,C.default)(this,t),this.strategies=e;}return(0,R.default)(t,[{key:"apply",value:function(e){var n=e.config,r=e.camera,i=e.renderingService,a=e.renderingContext,o=this.strategies;i.hooks.cull.tap(t.tag,function(t){if(t){var e,i=t.cullable;if(0===o.length?i.visible=a.unculledEntities.indexOf(t.entity)>-1:i.visible=o.every(function(e){return e.isVisible(r,t);}),!t.isCulled()&&t.isVisible())return t;var s=(null===(e=n.future)||void 0===e?void 0:e.experimentalCancelEventPropagation)===!0;return t.dispatchEvent(new rG(rH.CULLED),s,s),null;}return t;}),i.hooks.afterRender.tap(t.tag,function(t){t.cullable.visibilityPlaneMask=-1;});}}]);}().tag="Culling",function(){function t(){var e=this;(0,C.default)(this,t),this.autoPreventDefault=!1,this.rootPointerEvent=new rD(null),this.rootWheelEvent=new r_(null),this.onPointerMove=function(t){var n=null===(r=e.context.renderingContext.root)||void 0===r||null===(r=r.ownerDocument)||void 0===r?void 0:r.defaultView;if(!n.supportsTouchEvents||"touch"!==t.pointerType){var r,i,a=e.normalizeToPointerEvent(t,n),o=(0,W.default)(a);try{for(o.s();!(i=o.n()).done;){var s=i.value,l=e.bootstrapEvent(e.rootPointerEvent,s,n,t);e.context.eventService.mapEvent(l);}}catch(t){o.e(t);}finally{o.f();}e.setCursor(e.context.eventService.cursor);}},this.onClick=function(t){var n,r,i=null===(n=e.context.renderingContext.root)||void 0===n||null===(n=n.ownerDocument)||void 0===n?void 0:n.defaultView,a=e.normalizeToPointerEvent(t,i),o=(0,W.default)(a);try{for(o.s();!(r=o.n()).done;){var s=r.value,l=e.bootstrapEvent(e.rootPointerEvent,s,i,t);e.context.eventService.mapEvent(l);}}catch(t){o.e(t);}finally{o.f();}e.setCursor(e.context.eventService.cursor);};}return(0,R.default)(t,[{key:"apply",value:function(e){var n=this;this.context=e;var r=e.renderingService,i=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler(function(t){return n.context.renderingService.hooks.pickSync.call({position:t,picked:[],topmost:!0}).picked[0]||null;}),r.hooks.pointerWheel.tap(t.tag,function(t){var e=n.normalizeWheelEvent(t);n.context.eventService.mapEvent(e);}),r.hooks.pointerDown.tap(t.tag,function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){var e=n.normalizeToPointerEvent(t,i);n.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();var r,a=(0,W.default)(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=n.bootstrapEvent(n.rootPointerEvent,o,i,t);n.context.eventService.mapEvent(s);}}catch(t){a.e(t);}finally{a.f();}n.setCursor(n.context.eventService.cursor);}}),r.hooks.pointerUp.tap(t.tag,function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){var e,r=n.context.contextService.getDomElement(),a=n.context.eventService.isNativeEventFromCanvas(r,t)?"":"outside",o=n.normalizeToPointerEvent(t,i),s=(0,W.default)(o);try{for(s.s();!(e=s.n()).done;){var l=e.value,u=n.bootstrapEvent(n.rootPointerEvent,l,i,t);u.type+=a,n.context.eventService.mapEvent(u);}}catch(t){s.e(t);}finally{s.f();}n.setCursor(n.context.eventService.cursor);}}),r.hooks.pointerMove.tap(t.tag,this.onPointerMove),r.hooks.pointerOver.tap(t.tag,this.onPointerMove),r.hooks.pointerOut.tap(t.tag,this.onPointerMove),r.hooks.click.tap(t.tag,this.onClick),r.hooks.pointerCancel.tap(t.tag,function(t){var e,r=n.normalizeToPointerEvent(t,i),a=(0,W.default)(r);try{for(a.s();!(e=a.n()).done;){var o=e.value,s=n.bootstrapEvent(n.rootPointerEvent,o,i,t);n.context.eventService.mapEvent(s);}}catch(t){a.e(t);}finally{a.f();}n.setCursor(n.context.eventService.cursor);});}},{key:"bootstrapEvent",value:function(t,e,n,r){t.view=n,t.originalEvent=null,t.nativeEvent=r,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);var i=this.context.eventService.client2Viewport({x:e.clientX,y:e.clientY}),a=i.x,o=i.y;t.viewport.x=a,t.viewport.y=o;var s=this.context.eventService.viewport2Canvas(t.viewport),l=s.x,u=s.y;return t.canvas.x=l,t.canvas.y=u,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=r.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=n1[t.type]||t.type),t;}},{key:"normalizeWheelEvent",value:function(t){var e=this.rootWheelEvent;this.transferMouseData(e,t),e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;var n=this.context.eventService.client2Viewport({x:t.clientX,y:t.clientY}),r=n.x,i=n.y;e.viewport.x=r,e.viewport.y=i;var a=this.context.eventService.viewport2Canvas(e.viewport),o=a.x,s=a.y;return e.canvas.x=o,e.canvas.y=s,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.nativeEvent=t,e.type=t.type,e;}},{key:"transferMouseData",value:function(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=n2.now(),t.type=e.type,t.altKey=e.altKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.ctrlKey=e.ctrlKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.screen.x=e.screenX,t.screen.y=e.screenY,t.relatedTarget=null;}},{key:"setCursor",value:function(t){this.context.contextService.applyCursorStyle(t||this.context.config.cursor||"default");}},{key:"normalizeToPointerEvent",value:function(t,e){var n=[];if(e.isTouchEvent(t))for(var r=0;r<t.changedTouches.length;r++){var i=t.changedTouches[r];(0,F.isUndefined)(i.button)&&(i.button=0),(0,F.isUndefined)(i.buttons)&&(i.buttons=1),(0,F.isUndefined)(i.isPrimary)&&(i.isPrimary=1===t.touches.length&&"touchstart"===t.type),(0,F.isUndefined)(i.width)&&(i.width=i.radiusX||1),(0,F.isUndefined)(i.height)&&(i.height=i.radiusY||1),(0,F.isUndefined)(i.tiltX)&&(i.tiltX=0),(0,F.isUndefined)(i.tiltY)&&(i.tiltY=0),(0,F.isUndefined)(i.pointerType)&&(i.pointerType="touch"),(0,F.isUndefined)(i.pointerId)&&(i.pointerId=i.identifier||0),(0,F.isUndefined)(i.pressure)&&(i.pressure=i.force||.5),(0,F.isUndefined)(i.twist)&&(i.twist=0),(0,F.isUndefined)(i.tangentialPressure)&&(i.tangentialPressure=0),i.isNormalized=!0,i.type=t.type,n.push(i);}else e.isMouseEvent(t)&&((0,F.isUndefined)(t.isPrimary)&&(t.isPrimary=!0),(0,F.isUndefined)(t.width)&&(t.width=1),(0,F.isUndefined)(t.height)&&(t.height=1),(0,F.isUndefined)(t.tiltX)&&(t.tiltX=0),(0,F.isUndefined)(t.tiltY)&&(t.tiltY=0),(0,F.isUndefined)(t.pointerType)&&(t.pointerType="mouse"),(0,F.isUndefined)(t.pointerId)&&(t.pointerId=1),(0,F.isUndefined)(t.pressure)&&(t.pressure=.5),(0,F.isUndefined)(t.twist)&&(t.twist=0),(0,F.isUndefined)(t.tangentialPressure)&&(t.tangentialPressure=0),t.isNormalized=!0),n.push(t);return n;}}]);}().tag="Event";var iU=[j.CIRCLE,j.ELLIPSE,j.IMAGE,j.RECT,j.LINE,j.POLYLINE,j.POLYGON,j.TEXT,j.PATH,j.HTML];(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"isVisible",value:function(t,e){var n,r=e.cullable;if(!r.enable)return!0;var i=e.getRenderBounds();if(tr.isEmpty(i))return!1;var a=t.getFrustum(),o=null===(n=e.parentNode)||void 0===n||null===(n=n.cullable)||void 0===n?void 0:n.visibilityPlaneMask;return r.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(e,i,o||ta.INDETERMINATE,a.planes),r.visible=r.visibilityPlaneMask!==ta.OUTSIDE,r.visible;}},{key:"computeVisibilityWithPlaneMask",value:function(t,e,n,r){if(n===ta.OUTSIDE||n===ta.INSIDE)return n;for(var i=ta.INSIDE,a=iU.indexOf(t.nodeName)>-1,o=0,s=r.length;o<s;++o){var l=1<<o;if((n&l)!=0&&(!a||4!==o&&5!==o)){var u=r[o],c=u.normal,h=u.distance;if(G.vec3.dot(c,e.getPositiveFarPoint(r[o]))+h<0)return ta.OUTSIDE;G.vec3.dot(c,e.getNegativeFarPoint(r[o]))+h<0&&(i|=l);}}return i;}}]),function(){function t(){(0,C.default)(this,t),this.mutationRecords=[],this.isFirstTimeRendering=!0,this.isFirstTimeRenderingFinished=!1;}return(0,R.default)(t,[{key:"apply",value:function(e){var n,r=this,i=e.renderingService,a=e.renderingContext.root.ownerDocument.defaultView,o=function(t){i.dirty();},s=function(t){var e,n=t.detail;(e=r.mutationRecords).push.apply(e,(0,O.default)(n)),i.dirty();},l=function(t){var e=t.target;is.enableSizeAttenuation&&is.styleValueRegistry.updateSizeAttenuation(e,a.getCamera().getZoom());},u=function(t){var e=t.target;is.sceneGraphService.dirtyToRoot(e),i.dirty();};i.hooks.init.tap(t.tag,function(){a.addEventListener(rH.MOUNTED,l),a.addEventListener(rH.UNMOUNTED,u),a.addEventListener(rH.ATTR_MODIFIED,o),a.addEventListener(rH.BOUNDS_CHANGED,s);}),i.hooks.destroy.tap(t.tag,function(){a.removeEventListener(rH.MOUNTED,l),a.removeEventListener(rH.UNMOUNTED,u),a.removeEventListener(rH.ATTR_MODIFIED,o),a.removeEventListener(rH.BOUNDS_CHANGED,s),r.mutationRecords=[];});var c=null!==(n=is.globalThis.requestIdleCallback)&&void 0!==n?n:rn.bind(is.globalThis);i.hooks.endFrame.tap(t.tag,function(){r.isFirstTimeRendering&&(r.isFirstTimeRendering=!1,c(function(){r.isFirstTimeRenderingFinished=!0;})),r.mutationRecords=[];});}}]);}().tag="Prepare";var iV=((P={}).READY="ready",P.BEFORE_RENDER="beforerender",P.RERENDER="rerender",P.AFTER_RENDER="afterrender",P.BEFORE_DESTROY="beforedestroy",P.AFTER_DESTROY="afterdestroy",P.RESIZE="resize",P.DIRTY_RECTANGLE="dirtyrectangle",P.RENDERER_CHANGED="rendererchanged",P);new rG(rH.MOUNTED),new rG(rH.UNMOUNTED),new rG(iV.BEFORE_RENDER),new rG(iV.RERENDER),new rG(iV.AFTER_RENDER);},f0c77c55:function(t,e,n){"use strict";n.d(e,"__esModule",{value:!0}),n.e(e,{AABB:function(){return tn;},Camera:function(){return tC;},CameraType:function(){return tw;},Canvas:function(){return i4;},CanvasEvent:function(){return iQ;},Circle:function(){return iw;},CustomElement:function(){return iM;},Document:function(){return iq;},ERROR_MSG_METHOD_NOT_IMPLEMENTED:function(){return tl;},ElementEvent:function(){return rX;},Ellipse:function(){return iA;},FederatedEvent:function(){return rI;},FederatedPointerEvent:function(){return r_;},Group:function(){return iC;},HTML:function(){return iO;},Image:function(){return iL;},Line:function(){return iD;},MutationEvent:function(){return rj;},Path:function(){return iG;},Polygon:function(){return iB;},Polyline:function(){return iV;},Rect:function(){return iz;},Text:function(){return iY;},createVec3:function(){return td;},deg2rad:function(){return tv;},getAngle:function(){return tc;},propertyMetadataCache:function(){return nL;},rad2deg:function(){return tg;},runtime:function(){return ih;}});var r,i,a,o,s,l,u,c,h,d,f,v,p,g,y,m,k,E,x,T,N,b,S,w,P,M=n("777fffbe"),A=M._(n("ab297151")),C=M._(n("b1a4abb6")),R=M._(n("72ce8fb5")),O=M._(n("d60881d0")),L=M._(n("0b95a4d2")),I=M._(n("0afdccfb")),D=M._(n("7465ab36")),_=M._(n("32f41e1c")),G=n("597fa39f");n("f90e84e3");var F=n("abe9d8d6"),B=M._(n("3214ccb5")),U=M._(n("51ffafbb")),V=M._(n("3c7f532e")),z=n("b1a96927"),H=M._(n("2fabd5d4")),Y=M._(n("cb203630")),W=M._(n("1982f763")),q=M._(n("01aac514"));let X=n("1714eebe");var j=((r={}).GROUP="g",r.FRAGMENT="fragment",r.CIRCLE="circle",r.ELLIPSE="ellipse",r.IMAGE="image",r.RECT="rect",r.LINE="line",r.POLYLINE="polyline",r.POLYGON="polygon",r.TEXT="text",r.PATH="path",r.HTML="html",r.MESH="mesh",r),$=((i={})[i.ZERO=0]="ZERO",i[i.NEGATIVE_ONE=1]="NEGATIVE_ONE",i),K=G.vec3.add,Z=G.vec3.copy,Q=G.vec3.max,J=G.vec3.min,tt=G.vec3.scale,te=G.vec3.sub,tn=function(){function t(){(0,C.default)(this,t),this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0];}return(0,R.default)(t,[{key:"update",value:function(t,e){Z(this.center,t),Z(this.halfExtents,e),te(this.min,this.center,this.halfExtents),K(this.max,this.center,this.halfExtents);}},{key:"setMinMax",value:function(t,e){K(this.center,e,t),tt(this.center,this.center,.5),te(this.halfExtents,e,t),tt(this.halfExtents,this.halfExtents,.5),Z(this.min,t),Z(this.max,e);}},{key:"getMin",value:function(){return this.min;}},{key:"getMax",value:function(){return this.max;}},{key:"add",value:function(e){if(!t.isEmpty(e)){if(t.isEmpty(this)){this.setMinMax(e.getMin(),e.getMax());return;}var n=this.center,r=n[0],i=n[1],a=n[2],o=this.halfExtents,s=o[0],l=o[1],u=o[2],c=r-s,h=r+s,d=i-l,f=i+l,v=a-u,p=a+u,g=e.center,y=g[0],m=g[1],k=g[2],E=e.halfExtents,x=E[0],T=E[1],N=E[2],b=y-x,S=y+x,w=m-T,P=m+T,M=k-N,A=k+N;b<c&&(c=b),S>h&&(h=S),w<d&&(d=w),P>f&&(f=P),M<v&&(v=M),A>p&&(p=A),n[0]=(c+h)*.5,n[1]=(d+f)*.5,n[2]=(v+p)*.5,o[0]=(h-c)*.5,o[1]=(f-d)*.5,o[2]=(p-v)*.5,this.min[0]=c,this.min[1]=d,this.min[2]=v,this.max[0]=h,this.max[1]=f,this.max[2]=p;}}},{key:"setFromTransformedAABB",value:function(t,e){var n=this.center,r=this.halfExtents,i=t.center,a=t.halfExtents,o=e[0],s=e[4],l=e[8],u=e[1],c=e[5],h=e[9],d=e[2],f=e[6],v=e[10],p=Math.abs(o),g=Math.abs(s),y=Math.abs(l),m=Math.abs(u),k=Math.abs(c),E=Math.abs(h),x=Math.abs(d),T=Math.abs(f),N=Math.abs(v);n[0]=e[12]+o*i[0]+s*i[1]+l*i[2],n[1]=e[13]+u*i[0]+c*i[1]+h*i[2],n[2]=e[14]+d*i[0]+f*i[1]+v*i[2],r[0]=p*a[0]+g*a[1]+y*a[2],r[1]=m*a[0]+k*a[1]+E*a[2],r[2]=x*a[0]+T*a[1]+N*a[2],te(this.min,n,r),K(this.max,n,r);}},{key:"intersects",value:function(t){var e=this.getMax(),n=this.getMin(),r=t.getMax(),i=t.getMin();return n[0]<=r[0]&&e[0]>=i[0]&&n[1]<=r[1]&&e[1]>=i[1]&&n[2]<=r[2]&&e[2]>=i[2];}},{key:"intersection",value:function(e){if(!this.intersects(e))return null;var n=new t,r=Q([0,0,0],this.getMin(),e.getMin()),i=J([0,0,0],this.getMax(),e.getMax());return n.setMinMax(r,i),n;}},{key:"getNegativeFarPoint",value:function(t){return 273===t.pnVertexFlag?Z([0,0,0],this.min):272===t.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:257===t.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:256===t.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:17===t.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:16===t.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:1===t.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]];}},{key:"getPositiveFarPoint",value:function(t){return 273===t.pnVertexFlag?Z([0,0,0],this.max):272===t.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:257===t.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:256===t.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:17===t.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:16===t.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:1===t.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]];}}],[{key:"isEmpty",value:function(t){return!t||0===t.halfExtents[0]&&0===t.halfExtents[1]&&0===t.halfExtents[2];}}]);}(),tr=(0,R.default)(function t(e,n){(0,C.default)(this,t),this.distance=e||0,this.normal=n||G.vec3.fromValues(0,1,0),this.updatePNVertexFlag();},[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(Number(this.normal[0]>=0)<<8)+(Number(this.normal[1]>=0)<<4)+Number(this.normal[2]>=0);}},{key:"distanceToPoint",value:function(t){return G.vec3.dot(t,this.normal)-this.distance;}},{key:"normalize",value:function(){var t=1/G.vec3.len(this.normal);G.vec3.scale(this.normal,this.normal,t),this.distance*=t;}},{key:"intersectsLine",value:function(t,e,n){var r=this.distanceToPoint(t),i=r/(r-this.distanceToPoint(e)),a=i>=0&&i<=1;return a&&n&&G.vec3.lerp(n,t,e,i),a;}}]),ti=((a={})[a.OUTSIDE=4294967295]="OUTSIDE",a[a.INSIDE=0]="INSIDE",a[a.INDETERMINATE=2147483647]="INDETERMINATE",a),ta=(0,R.default)(function t(e){if((0,C.default)(this,t),this.planes=[],e)this.planes=e;else for(var n=0;n<6;n++)this.planes.push(new tr);},[{key:"extractFromVPMatrix",value:function(t){var e=(0,D.default)(t,16),n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],v=e[12],p=e[13],g=e[14],y=e[15];G.vec3.set(this.planes[0].normal,a-n,u-o,f-c),this.planes[0].distance=y-v,G.vec3.set(this.planes[1].normal,a+n,u+o,f+c),this.planes[1].distance=y+v,G.vec3.set(this.planes[2].normal,a+r,u+s,f+h),this.planes[2].distance=y+p,G.vec3.set(this.planes[3].normal,a-r,u-s,f-h),this.planes[3].distance=y-p,G.vec3.set(this.planes[4].normal,a-i,u-l,f-d),this.planes[4].distance=y-g,G.vec3.set(this.planes[5].normal,a+i,u+l,f+d),this.planes[5].distance=y+g,this.planes.forEach(function(t){t.normalize(),t.updatePNVertexFlag();});}}]),to=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,C.default)(this,t),this.x=0,this.y=0,this.x=e,this.y=n;}return(0,R.default)(t,[{key:"clone",value:function(){return new t(this.x,this.y);}},{key:"copyFrom",value:function(t){this.x=t.x,this.y=t.y;}}]);}(),ts=function(){function t(e,n,r,i){(0,C.default)(this,t),this.x=e,this.y=n,this.width=r,this.height=i,this.left=e,this.right=e+r,this.top=n,this.bottom=n+i;}return(0,R.default)(t,[{key:"toJSON",value:function(){}}],[{key:"fromRect",value:function(e){return new t(e.x,e.y,e.width,e.height);}},{key:"applyTransform",value:function(e,n){var r=G.vec4.fromValues(e.x,e.y,0,1),i=G.vec4.fromValues(e.x+e.width,e.y,0,1),a=G.vec4.fromValues(e.x,e.y+e.height,0,1),o=G.vec4.fromValues(e.x+e.width,e.y+e.height,0,1),s=G.vec4.create(),l=G.vec4.create(),u=G.vec4.create(),c=G.vec4.create();G.vec4.transformMat4(s,r,n),G.vec4.transformMat4(l,i,n),G.vec4.transformMat4(u,a,n),G.vec4.transformMat4(c,o,n);var h=Math.min(s[0],l[0],u[0],c[0]),d=Math.min(s[1],l[1],u[1],c[1]),f=Math.max(s[0],l[0],u[0],c[0]),v=Math.max(s[1],l[1],u[1],c[1]);return t.fromRect({x:h,y:d,width:f-h,height:v-d});}}]);}(),tl="Method not implemented.",tu="Use document.documentElement instead.";function tc(t){return void 0===t?0:t>360||t<-360?t%360:t;}var th=G.vec3.create();function td(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];return Array.isArray(t)&&3===t.length?r?G.vec3.clone(t):G.vec3.copy(th,t):(0,F.isNumber)(t)?r?G.vec3.fromValues(t,e,n):G.vec3.set(th,t,e,n):r?G.vec3.fromValues(t[0],t[1]||e,t[2]||n):G.vec3.set(th,t[0],t[1]||e,t[2]||n);}var tf=Math.PI/180;function tv(t){return t*tf;}var tp=180/Math.PI;function tg(t){return t*tp;}var ty=Math.PI/2;function tm(t,e){var n,r,i,a,o,s,l,u,c,h,d,f,v,p,g,y,m;return 16===e.length?(i=G.mat4.getScaling(G.vec3.create(),e),o=(a=(0,D.default)(i,3))[0],s=a[1],l=a[2],(u=Math.asin(-e[2]/o))<ty?u>-ty?(n=Math.atan2(e[6]/s,e[10]/l),r=Math.atan2(e[1]/o,e[0]/o)):(r=0,n=-Math.atan2(e[4]/s,e[5]/s)):(r=0,n=Math.atan2(e[4]/s,e[5]/s)),t[0]=n,t[1]=u,t[2]=r):(c=e[0],h=e[1],d=e[2],f=e[3],y=c*c+(v=h*h)+(p=d*d)+(g=f*f),(m=c*f-h*d)>.499995*y?(t[0]=ty,t[1]=2*Math.atan2(h,c),t[2]=0):m<-.499995*y?(t[0]=-ty,t[1]=2*Math.atan2(h,c),t[2]=0):(t[0]=Math.asin(2*(c*d-f*h)),t[1]=Math.atan2(2*(c*f+h*d),1-2*(p+g)),t[2]=Math.atan2(2*(c*h+d*f),1-2*(v+p)))),t;}function tk(t){var e=t[0],n=t[1],r=t[3],i=t[4],a=Math.sqrt(e*e+n*n),o=Math.sqrt(r*r+i*i);if(e*i-n*r<0&&(e<i?a=-a:o=-o),a){var s=1/a;e*=s,n*=s;}if(o){var l=1/o;r*=l,i*=l;}var u=Math.atan2(n,e)*tp;return[t[6],t[7],a,o,u];}var tE=G.mat4.create(),tx=G.mat4.create(),tT=G.vec4.create(),tN=[G.vec3.create(),G.vec3.create(),G.vec3.create()],tb=G.vec3.create();function tS(t,e,n,r,i){t[0]=e[0]*r+n[0]*i,t[1]=e[1]*r+n[1]*i,t[2]=e[2]*r+n[2]*i;}var tw=((o={})[o.ORBITING=0]="ORBITING",o[o.EXPLORING=1]="EXPLORING",o[o.TRACKING=2]="TRACKING",o),tP=((s={})[s.DEFAULT=0]="DEFAULT",s[s.ROTATIONAL=1]="ROTATIONAL",s[s.TRANSLATIONAL=2]="TRANSLATIONAL",s[s.CINEMATIC=3]="CINEMATIC",s),tM=((l={})[l.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",l[l.PERSPECTIVE=1]="PERSPECTIVE",l),tA={UPDATED:"updated"},tC=(0,R.default)(function t(){(0,C.default)(this,t),this.clipSpaceNearZ=$.NEGATIVE_ONE,this.eventEmitter=new _.default,this.matrix=G.mat4.create(),this.right=G.vec3.fromValues(1,0,0),this.up=G.vec3.fromValues(0,1,0),this.forward=G.vec3.fromValues(0,0,1),this.position=G.vec3.fromValues(0,0,1),this.focalPoint=G.vec3.fromValues(0,0,0),this.distanceVector=G.vec3.fromValues(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=G.mat4.create(),this.projectionMatrixInverse=G.mat4.create(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=tw.EXPLORING,this.trackingMode=tP.DEFAULT,this.projectionMode=tM.PERSPECTIVE,this.frustum=new ta,this.orthoMatrix=G.mat4.create();},[{key:"isOrtho",value:function(){return this.projectionMode===tM.ORTHOGRAPHIC;}},{key:"getProjectionMode",value:function(){return this.projectionMode;}},{key:"getPerspective",value:function(){return this.jitteredProjectionMatrix||this.projectionMatrix;}},{key:"getPerspectiveInverse",value:function(){return this.projectionMatrixInverse;}},{key:"getFrustum",value:function(){return this.frustum;}},{key:"getPosition",value:function(){return this.position;}},{key:"getFocalPoint",value:function(){return this.focalPoint;}},{key:"getDollyingStep",value:function(){return this.dollyingStep;}},{key:"getNear",value:function(){return this.near;}},{key:"getFar",value:function(){return this.far;}},{key:"getZoom",value:function(){return this.zoom;}},{key:"getOrthoMatrix",value:function(){return this.orthoMatrix;}},{key:"getView",value:function(){return this.view;}},{key:"setEnableUpdate",value:function(t){this.enableUpdate=t;}},{key:"setType",value:function(t,e){return this.type=t,this.type===tw.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===tw.TRACKING&&void 0!==e&&this.setTrackingMode(e),this;}},{key:"setProjectionMode",value:function(t){return this.projectionMode=t,this;}},{key:"setTrackingMode",value:function(t){if(this.type!==tw.TRACKING)throw Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=t,this;}},{key:"setWorldRotation",value:function(t){return this.rotateWorld=t,this._getAngles(),this;}},{key:"getViewTransform",value:function(){return G.mat4.invert(G.mat4.create(),this.matrix);}},{key:"getWorldTransform",value:function(){return this.matrix;}},{key:"jitterProjectionMatrix",value:function(t,e){var n=G.mat4.fromTranslation(G.mat4.create(),[t,e,0]);this.jitteredProjectionMatrix=G.mat4.multiply(G.mat4.create(),n,this.projectionMatrix);}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0;}},{key:"setMatrix",value:function(t){return this.matrix=t,this._update(),this;}},{key:"setProjectionMatrix",value:function(t){this.projectionMatrix=t;}},{key:"setFov",value:function(t){return this.setPerspective(this.near,this.far,t,this.aspect),this;}},{key:"setAspect",value:function(t){return this.setPerspective(this.near,this.far,this.fov,t),this;}},{key:"setNear",value:function(t){return this.projectionMode===tM.PERSPECTIVE?this.setPerspective(t,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,t,this.far),this;}},{key:"setFar",value:function(t){return this.projectionMode===tM.PERSPECTIVE?this.setPerspective(this.near,t,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,t),this;}},{key:"setViewOffset",value:function(t,e,n,r,i,a){return this.aspect=t/e,void 0===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.projectionMode===tM.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this;}},{key:"clearViewOffset",value:function(){return void 0!==this.view&&(this.view.enabled=!1),this.projectionMode===tM.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this;}},{key:"setZoom",value:function(t){return this.zoom=t,this.projectionMode===tM.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===tM.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this;}},{key:"setZoomByViewportPoint",value:function(t,e){var n=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),r=n.x,i=n.y,a=this.roll;this.rotate(0,0,-a),this.setPosition(r,i),this.setFocalPoint(r,i),this.setZoom(t),this.rotate(0,0,a);var o=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),s=o.x,l=o.y,u=G.vec3.fromValues(s-r,l-i,0),c=G.vec3.dot(u,this.right)/G.vec3.length(this.right),h=G.vec3.dot(u,this.up)/G.vec3.length(this.up),d=this.getPosition(),f=(0,D.default)(d,2),v=f[0],p=f[1],g=this.getFocalPoint(),y=(0,D.default)(g,2),m=y[0],k=y[1];return this.setPosition(v-c,p-h),this.setFocalPoint(m-c,k-h),this;}},{key:"setPerspective",value:function(t,e,n,r){this.projectionMode=tM.PERSPECTIVE,this.fov=n,this.near=t,this.far=e,this.aspect=r;var i,a=this.near*Math.tan(.5*this.fov*tf)/this.zoom,o=2*a,s=this.aspect*o,l=-.5*s;if(null!==(i=this.view)&&void 0!==i&&i.enabled){var u=this.view.fullWidth,c=this.view.fullHeight;l+=this.view.offsetX*s/u,a-=this.view.offsetY*o/c,s*=this.view.width/u,o*=this.view.height/c;}return!function(t,e,n,r,i,a,o){var s,l,u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=2*a,h=n-e,d=r-i,f=o-a,v=o*a;u?(s=-o/f,l=-v/f):(s=-(o+a)/f,l=-2*v/f),t[0]=c/h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c/d,t[6]=0,t[7]=0,t[8]=(n+e)/h,t[9]=(r+i)/d,t[10]=s,t[11]=-1,t[12]=0,t[13]=0,t[14]=l,t[15]=0;}(this.projectionMatrix,l,l+s,a-o,a,t,this.far,this.clipSpaceNearZ===$.ZERO),G.mat4.invert(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this;}},{key:"setOrthographic",value:function(t,e,n,r,i,a){this.projectionMode=tM.ORTHOGRAPHIC,this.rright=e,this.left=t,this.top=n,this.bottom=r,this.near=i,this.far=a;var o,s=(this.rright-this.left)/(2*this.zoom),l=(this.top-this.bottom)/(2*this.zoom),u=(this.rright+this.left)/2,c=(this.top+this.bottom)/2,h=u-s,d=u+s,f=c+l,v=c-l;if(null!==(o=this.view)&&void 0!==o&&o.enabled){var p=(this.rright-this.left)/this.view.fullWidth/this.zoom,g=(this.top-this.bottom)/this.view.fullHeight/this.zoom;h+=p*this.view.offsetX,d=h+p*this.view.width,f-=g*this.view.offsetY,v=f-g*this.view.height;}return this.clipSpaceNearZ===$.NEGATIVE_ONE?G.mat4.ortho(this.projectionMatrix,h,d,f,v,i,a):G.mat4.orthoZO(this.projectionMatrix,h,d,f,v,i,a),G.mat4.invert(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this;}},{key:"setPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.position[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.position[2],r=td(t,e,n);return this._setPosition(r),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this;}},{key:"setFocalPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.focalPoint[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.focalPoint[2],r=G.vec3.fromValues(0,1,0);if(this.focalPoint=td(t,e,n),this.trackingMode===tP.CINEMATIC){var i=G.vec3.subtract(G.vec3.create(),this.focalPoint,this.position);t=i[0],e=i[1],n=i[2];var a=Math.asin(e/G.vec3.length(i))*tp,o=90+Math.atan2(n,t)*tp,s=G.mat4.create();G.mat4.rotateY(s,s,o*tf),G.mat4.rotateX(s,s,a*tf),r=G.vec3.transformMat4(G.vec3.create(),[0,1,0],s);}return G.mat4.invert(this.matrix,G.mat4.lookAt(G.mat4.create(),this.position,this.focalPoint,r)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this;}},{key:"getDistance",value:function(){return this.distance;}},{key:"getDistanceVector",value:function(){return this.distanceVector;}},{key:"setDistance",value:function(t){if(this.distance===t||t<0)return this;this.distance=t,this.distance<2e-4&&(this.distance=2e-4),this.dollyingStep=this.distance/100;var e=G.vec3.create();t=this.distance;var n=this.forward,r=this.focalPoint;return e[0]=t*n[0]+r[0],e[1]=t*n[1]+r[1],e[2]=t*n[2]+r[2],this._setPosition(e),this.triggerUpdate(),this;}},{key:"setMaxDistance",value:function(t){return this.maxDistance=t,this;}},{key:"setMinDistance",value:function(t){return this.minDistance=t,this;}},{key:"setAzimuth",value:function(t){return this.azimuth=tc(t),this.computeMatrix(),this._getAxes(),this.type===tw.ORBITING||this.type===tw.EXPLORING?this._getPosition():this.type===tw.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getAzimuth",value:function(){return this.azimuth;}},{key:"setElevation",value:function(t){return this.elevation=tc(t),this.computeMatrix(),this._getAxes(),this.type===tw.ORBITING||this.type===tw.EXPLORING?this._getPosition():this.type===tw.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getElevation",value:function(){return this.elevation;}},{key:"setRoll",value:function(t){return this.roll=tc(t),this.computeMatrix(),this._getAxes(),this.type===tw.ORBITING||this.type===tw.EXPLORING?this._getPosition():this.type===tw.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this;}},{key:"getRoll",value:function(){return this.roll;}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate();}},{key:"computeMatrix",value:function(){var t=G.quat.setAxisAngle(G.quat.create(),[0,0,1],this.roll*tf);G.mat4.identity(this.matrix);var e=G.quat.setAxisAngle(G.quat.create(),[1,0,0],(this.rotateWorld&&this.type!==tw.TRACKING||this.type===tw.TRACKING?1:-1)*this.elevation*tf),n=G.quat.setAxisAngle(G.quat.create(),[0,1,0],(this.rotateWorld&&this.type!==tw.TRACKING||this.type===tw.TRACKING?1:-1)*this.azimuth*tf),r=G.quat.multiply(G.quat.create(),n,e);r=G.quat.multiply(G.quat.create(),r,t);var i=G.mat4.fromQuat(G.mat4.create(),r);this.type===tw.ORBITING||this.type===tw.EXPLORING?(G.mat4.translate(this.matrix,this.matrix,this.focalPoint),G.mat4.multiply(this.matrix,this.matrix,i),G.mat4.translate(this.matrix,this.matrix,[0,0,this.distance])):this.type===tw.TRACKING&&(G.mat4.translate(this.matrix,this.matrix,this.position),G.mat4.multiply(this.matrix,this.matrix,i));}},{key:"_setPosition",value:function(t,e,n){this.position=td(t,e,n);var r=this.matrix;r[12]=this.position[0],r[13]=this.position[1],r[14]=this.position[2],r[15]=1,this._getOrthoMatrix();}},{key:"_getAxes",value:function(){G.vec3.copy(this.right,td(G.vec4.transformMat4(G.vec4.create(),[1,0,0,0],this.matrix))),G.vec3.copy(this.up,td(G.vec4.transformMat4(G.vec4.create(),[0,1,0,0],this.matrix))),G.vec3.copy(this.forward,td(G.vec4.transformMat4(G.vec4.create(),[0,0,1,0],this.matrix))),G.vec3.normalize(this.right,this.right),G.vec3.normalize(this.up,this.up),G.vec3.normalize(this.forward,this.forward);}},{key:"_getAngles",value:function(){var t=this.distanceVector[0],e=this.distanceVector[1],n=this.distanceVector[2],r=G.vec3.length(this.distanceVector);if(0===r){this.elevation=0,this.azimuth=0;return;}this.type===tw.TRACKING?(this.elevation=Math.asin(e/r)*tp,this.azimuth=Math.atan2(-t,-n)*tp):this.rotateWorld?(this.elevation=Math.asin(e/r)*tp,this.azimuth=Math.atan2(-t,-n)*tp):(this.elevation=-(Math.asin(e/r)*tp),this.azimuth=-(Math.atan2(-t,-n)*tp));}},{key:"_getPosition",value:function(){G.vec3.copy(this.position,td(G.vec4.transformMat4(G.vec4.create(),[0,0,0,1],this.matrix))),this._getDistance();}},{key:"_getFocalPoint",value:function(){G.vec3.transformMat3(this.distanceVector,[0,0,-this.distance],G.mat3.fromMat4(G.mat3.create(),this.matrix)),G.vec3.add(this.focalPoint,this.position,this.distanceVector),this._getDistance();}},{key:"_getDistance",value:function(){this.distanceVector=G.vec3.subtract(G.vec3.create(),this.focalPoint,this.position),this.distance=G.vec3.length(this.distanceVector),this.dollyingStep=this.distance/100;}},{key:"_getOrthoMatrix",value:function(){if(this.projectionMode===tM.ORTHOGRAPHIC){var t=this.position,e=G.quat.setAxisAngle(G.quat.create(),[0,0,1],-this.roll*Math.PI/180);G.mat4.fromRotationTranslationScaleOrigin(this.orthoMatrix,e,G.vec3.fromValues((this.rright-this.left)/2-t[0],(this.top-this.bottom)/2-t[1],0),G.vec3.fromValues(this.zoom,this.zoom,1),t);}}},{key:"triggerUpdate",value:function(){if(this.enableUpdate){var t=this.getViewTransform(),e=G.mat4.multiply(G.mat4.create(),this.getPerspective(),t);this.getFrustum().extractFromVPMatrix(e),this.eventEmitter.emit(tA.UPDATED);}}},{key:"rotate",value:function(t,e,n){throw Error(tl);}},{key:"pan",value:function(t,e){throw Error(tl);}},{key:"dolly",value:function(t){throw Error(tl);}},{key:"createLandmark",value:function(t,e){throw Error(tl);}},{key:"gotoLandmark",value:function(t,e){throw Error(tl);}},{key:"cancelLandmarkAnimation",value:function(){throw Error(tl);}}]),tR=((u={})[u.Standard=0]="Standard",u),tO=((c={})[c.ADDED=0]="ADDED",c[c.REMOVED=1]="REMOVED",c[c.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED",c),tL=G.vec3.create(),tI=G.mat4.create(),tD=G.quat.create();function t_(t){if(t.localDirtyFlag){if(0!==t.localSkew[0]||0!==t.localSkew[1]){G.mat4.fromRotationTranslationScaleOrigin(t.localTransform,t.localRotation,t.localPosition,G.vec3.fromValues(1,1,1),t.origin),(0!==t.localSkew[0]||0!==t.localSkew[1])&&(G.mat4.identity(tI),tI[4]=Math.tan(t.localSkew[0]),tI[1]=Math.tan(t.localSkew[1]),G.mat4.multiply(t.localTransform,t.localTransform,tI));var e=G.mat4.fromRotationTranslationScaleOrigin(tI,G.quat.set(tD,0,0,0,1),G.vec3.set(tL,1,1,1),t.localScale,t.origin);G.mat4.multiply(t.localTransform,t.localTransform,e);}else{var n=t.localTransform,r=t.localPosition,i=t.localRotation,a=t.localScale,o=t.origin,s=0!==r[0]||0!==r[1]||0!==r[2],l=1!==i[3]||0!==i[0]||0!==i[1]||0!==i[2],u=1!==a[0]||1!==a[1]||1!==a[2],c=0!==o[0]||0!==o[1]||0!==o[2];l||u||c?G.mat4.fromRotationTranslationScaleOrigin(n,i,r,a,o):s?G.mat4.fromTranslation(n,r):G.mat4.identity(n);}t.localDirtyFlag=!1;}}var tG={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new ts(0,0,0,0)},tF=((h={}).COORDINATE="<coordinate>",h.COLOR="<color>",h.PAINT="<paint>",h.NUMBER="<number>",h.ANGLE="<angle>",h.OPACITY_VALUE="<opacity-value>",h.SHADOW_BLUR="<shadow-blur>",h.LENGTH="<length>",h.PERCENTAGE="<percentage>",h.LENGTH_PERCENTAGE="<length> | <percentage>",h.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",h.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",h.LIST_OF_POINTS="<list-of-points>",h.PATH="<path>",h.FILTER="<filter>",h.Z_INDEX="<z-index>",h.OFFSET_DISTANCE="<offset-distance>",h.DEFINED_PATH="<defined-path>",h.MARKER="<marker>",h.TRANSFORM="<transform>",h.TRANSFORM_ORIGIN="<transform-origin>",h.TEXT="<text>",h.TEXT_TRANSFORM="<text-transform>",h);function tB(t,e,n){t.prototype=e.prototype=n,n.constructor=t;}function tU(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n;}function tV(){}var tz="\\s*([+-]?\\d+)\\s*",tH="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",tY="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",tW=/^#([0-9a-f]{3,8})$/,tq=RegExp(`^rgb\\(${tz},${tz},${tz}\\)$`),tX=RegExp(`^rgb\\(${tY},${tY},${tY}\\)$`),tj=RegExp(`^rgba\\(${tz},${tz},${tz},${tH}\\)$`),t$=RegExp(`^rgba\\(${tY},${tY},${tY},${tH}\\)$`),tK=RegExp(`^hsl\\(${tH},${tY},${tY}\\)$`),tZ=RegExp(`^hsla\\(${tH},${tY},${tY},${tH}\\)$`),tQ={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function tJ(){return this.rgb().formatHex();}function t0(){return this.rgb().formatRgb();}function t1(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=tW.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?t2(e):3===n?new t4(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?t3(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?t3(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=tq.exec(t))?new t4(e[1],e[2],e[3],1):(e=tX.exec(t))?new t4(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=tj.exec(t))?t3(e[1],e[2],e[3],e[4]):(e=t$.exec(t))?t3(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=tK.exec(t))?et(e[1],e[2]/100,e[3]/100,1):(e=tZ.exec(t))?et(e[1],e[2]/100,e[3]/100,e[4]):tQ.hasOwnProperty(t)?t2(tQ[t]):"transparent"===t?new t4(NaN,NaN,NaN,0):null;}function t2(t){return new t4(t>>16&255,t>>8&255,255&t,1);}function t3(t,e,n,r){return r<=0&&(t=e=n=NaN),new t4(t,e,n,r);}function t4(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r;}function t5(){return`#${t8(this.r)}${t8(this.g)}${t8(this.b)}`;}function t6(){let t=t7(this.opacity);return`${1===t?"rgb(":"rgba("}${t9(this.r)}, ${t9(this.g)}, ${t9(this.b)}${1===t?")":`, ${t})`}`;}function t7(t){return isNaN(t)?1:Math.max(0,Math.min(1,t));}function t9(t){return Math.max(0,Math.min(255,Math.round(t)||0));}function t8(t){return((t=t9(t))<16?"0":"")+t.toString(16);}function et(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new en(t,e,n,r);}function ee(t){if(t instanceof en)return new en(t.h,t.s,t.l,t.opacity);if(t instanceof tV||(t=t1(t)),!t)return new en;if(t instanceof en)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,l=(a+i)/2;return s?(o=e===a?(n-r)/s+(n<r)*6:n===a?(r-e)/s+2:(e-n)/s+4,s/=l<.5?a+i:2-a-i,o*=60):s=l>0&&l<1?0:o,new en(o,s,l,t.opacity);}function en(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r;}function er(t){return(t=(t||0)%360)<0?t+360:t;}function ei(t){return Math.max(0,Math.min(1,t||0));}function ea(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255;}function eo(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw TypeError("Expected a function");var n=function(){for(var r=arguments.length,i=Array(r),a=0;a<r;a++)i[a]=arguments[a];var o=e?e.apply(this,i):i[0],s=n.cache;if(s.has(o))return s.get(o);var l=t.apply(this,i);return n.cache=s.set(o,l)||s,l;};return n.cache=new(eo.Cache||Map),eo.cacheList.push(n.cache),n;}tB(tV,t1,{copy(t){return Object.assign(new this.constructor,this,t);},displayable(){return this.rgb().displayable();},hex:tJ,formatHex:tJ,formatHex8:function(){return this.rgb().formatHex8();},formatHsl:function(){return ee(this).formatHsl();},formatRgb:t0,toString:t0}),tB(t4,function(t,e,n,r){var i;return 1==arguments.length?((i=t)instanceof tV||(i=t1(i)),i)?new t4((i=i.rgb()).r,i.g,i.b,i.opacity):new t4:new t4(t,e,n,null==r?1:r);},tU(tV,{brighter(t){return t=null==t?1.4285714285714286:Math.pow(1.4285714285714286,t),new t4(this.r*t,this.g*t,this.b*t,this.opacity);},darker(t){return t=null==t?.7:Math.pow(.7,t),new t4(this.r*t,this.g*t,this.b*t,this.opacity);},rgb(){return this;},clamp(){return new t4(t9(this.r),t9(this.g),t9(this.b),t7(this.opacity));},displayable(){return -.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1;},hex:t5,formatHex:t5,formatHex8:function(){return`#${t8(this.r)}${t8(this.g)}${t8(this.b)}${t8((isNaN(this.opacity)?1:this.opacity)*255)}`;},formatRgb:t6,toString:t6})),tB(en,function(t,e,n,r){return 1==arguments.length?ee(t):new en(t,e,n,null==r?1:r);},tU(tV,{brighter(t){return t=null==t?1.4285714285714286:Math.pow(1.4285714285714286,t),new en(this.h,this.s,this.l*t,this.opacity);},darker(t){return t=null==t?.7:Math.pow(.7,t),new en(this.h,this.s,this.l*t,this.opacity);},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new t4(ea(t>=240?t-240:t+120,i,r),ea(t,i,r),ea(t<120?t+240:t-120,i,r),this.opacity);},clamp(){return new en(er(this.h),ei(this.s),ei(this.l),t7(this.opacity));},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1;},formatHsl(){let t=t7(this.opacity);return`${1===t?"hsl(":"hsla("}${er(this.h)}, ${100*ei(this.s)}%, ${100*ei(this.l)}%${1===t?")":`, ${t})`}`;}})),eo.Cache=Map,eo.cacheList=[],eo.clearCache=function(){eo.cacheList.forEach(function(t){return t.clear();});};var es=((d={})[d.kUnknown=0]="kUnknown",d[d.kNumber=1]="kNumber",d[d.kPercentage=2]="kPercentage",d[d.kEms=3]="kEms",d[d.kPixels=4]="kPixels",d[d.kRems=5]="kRems",d[d.kDegrees=6]="kDegrees",d[d.kRadians=7]="kRadians",d[d.kGradians=8]="kGradians",d[d.kTurns=9]="kTurns",d[d.kMilliseconds=10]="kMilliseconds",d[d.kSeconds=11]="kSeconds",d[d.kInteger=12]="kInteger",d),el=((f={})[f.kUNumber=0]="kUNumber",f[f.kUPercent=1]="kUPercent",f[f.kULength=2]="kULength",f[f.kUAngle=3]="kUAngle",f[f.kUTime=4]="kUTime",f[f.kUOther=5]="kUOther",f),eu=((v={})[v.kYes=0]="kYes",v[v.kNo=1]="kNo",v),ec=((p={})[p.kYes=0]="kYes",p[p.kNo=1]="kNo",p),eh=[{name:"em",unit_type:es.kEms},{name:"px",unit_type:es.kPixels},{name:"deg",unit_type:es.kDegrees},{name:"rad",unit_type:es.kRadians},{name:"grad",unit_type:es.kGradians},{name:"ms",unit_type:es.kMilliseconds},{name:"s",unit_type:es.kSeconds},{name:"rem",unit_type:es.kRems},{name:"turn",unit_type:es.kTurns}],ed=((g={})[g.kUnknownType=0]="kUnknownType",g[g.kUnparsedType=1]="kUnparsedType",g[g.kKeywordType=2]="kKeywordType",g[g.kUnitType=3]="kUnitType",g[g.kSumType=4]="kSumType",g[g.kProductType=5]="kProductType",g[g.kNegateType=6]="kNegateType",g[g.kInvertType=7]="kInvertType",g[g.kMinType=8]="kMinType",g[g.kMaxType=9]="kMaxType",g[g.kClampType=10]="kClampType",g[g.kTransformType=11]="kTransformType",g[g.kPositionType=12]="kPositionType",g[g.kURLImageType=13]="kURLImageType",g[g.kColorType=14]="kColorType",g[g.kUnsupportedColorType=15]="kUnsupportedColorType",g),ef=function(t){switch(t){case es.kNumber:case es.kInteger:return el.kUNumber;case es.kPercentage:return el.kUPercent;case es.kPixels:return el.kULength;case es.kMilliseconds:case es.kSeconds:return el.kUTime;case es.kDegrees:case es.kRadians:case es.kGradians:case es.kTurns:return el.kUAngle;default:return el.kUOther;}},ev=function(t){switch(t){case el.kUNumber:return es.kNumber;case el.kULength:return es.kPixels;case el.kUPercent:return es.kPercentage;case el.kUTime:return es.kSeconds;case el.kUAngle:return es.kDegrees;default:return es.kUnknown;}},ep=function(t){var e=1;switch(t){case es.kPixels:case es.kDegrees:case es.kSeconds:break;case es.kMilliseconds:e=.001;break;case es.kRadians:e=180/Math.PI;break;case es.kGradians:e=.9;break;case es.kTurns:e=360;}return e;},eg=function(t){switch(t){case es.kNumber:case es.kInteger:break;case es.kPercentage:return"%";case es.kEms:return"em";case es.kRems:return"rem";case es.kPixels:return"px";case es.kDegrees:return"deg";case es.kRadians:return"rad";case es.kGradians:return"grad";case es.kMilliseconds:return"ms";case es.kSeconds:return"s";case es.kTurns:return"turn";}return"";},ey=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"toString",value:function(){return this.buildCSSText(eu.kNo,ec.kNo,"");}},{key:"isNumericValue",value:function(){return this.getType()>=ed.kUnitType&&this.getType()<=ed.kClampType;}}],[{key:"isAngle",value:function(t){return t===es.kDegrees||t===es.kRadians||t===es.kGradians||t===es.kTurns;}},{key:"isLength",value:function(t){return t>=es.kEms&&t<es.kDegrees;}},{key:"isRelativeUnit",value:function(t){return t===es.kPercentage||t===es.kEms||t===es.kRems;}},{key:"isTime",value:function(t){return t===es.kSeconds||t===es.kMilliseconds;}}]),em=function(t){function e(t){var n;return(0,C.default)(this,e),(n=(0,L.default)(this,e)).colorSpace=t,n;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getType",value:function(){return ed.kColorType;}},{key:"to",value:function(t){return this;}}]);}(ey),ek=((y={})[y.Constant=0]="Constant",y[y.LinearGradient=1]="LinearGradient",y[y.RadialGradient=2]="RadialGradient",y),eE=function(t){function e(t,n){var r;return(0,C.default)(this,e),(r=(0,L.default)(this,e)).type=t,r.value=n,r;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return new e(this.type,this.value);}},{key:"buildCSSText",value:function(t,e,n){return n;}},{key:"getType",value:function(){return ed.kColorType;}}]);}(ey),ex=function(t){function e(t){var n;return(0,C.default)(this,e),(n=(0,L.default)(this,e)).value=t,n;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return new e(this.value);}},{key:"getType",value:function(){return ed.kKeywordType;}},{key:"buildCSSText",value:function(t,e,n){return n+this.value;}}]);}(ey),eT=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(Number.isFinite(t)?"NaN":t>0?"infinity":"-infinity")+e;},eN=function(t){return ev(ef(t));},eb=function(t){function e(t){var n,r,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:es.kNumber;return(0,C.default)(this,e),r=(0,L.default)(this,e),i="string"==typeof a?(n=a)?"number"===n?es.kNumber:"percent"===n||"%"===n?es.kPercentage:eh.find(function(t){return t.name===n;}).unit_type:es.kUnknown:a,r.unit=i,r.value=t,r;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return new e(this.value,this.unit);}},{key:"equals",value:function(t){return this.value===t.value&&this.unit===t.unit;}},{key:"getType",value:function(){return ed.kUnitType;}},{key:"convertTo",value:function(t){if(this.unit===t)return new e(this.value,this.unit);var n=eN(this.unit);if(n!==eN(t)||n===es.kUnknown)return null;var r=ep(this.unit)/ep(t);return new e(this.value*r,t);}},{key:"buildCSSText",value:function(t,e,n){var r;switch(this.unit){case es.kUnknown:break;case es.kInteger:r=Number(this.value).toFixed(0);break;case es.kNumber:case es.kPercentage:case es.kEms:case es.kRems:case es.kPixels:case es.kDegrees:case es.kRadians:case es.kGradians:case es.kMilliseconds:case es.kSeconds:case es.kTurns:var i=this.value,a=eg(this.unit);if(i<-999999||i>999999){var o=eg(this.unit);r=!Number.isFinite(i)||Number.isNaN(i)?eT(i,o):i+(o||"");}else r="".concat(i).concat(a);}return n+r;}}]);}(ey),eS=new eb(0,"px");new eb(1,"px");var ew=new eb(0,"deg"),eP=function(t){function e(t,n,r){var i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return(0,C.default)(this,e),(i=(0,L.default)(this,e,["rgb"])).r=t,i.g=n,i.b=r,i.alpha=a,i.isNone=o,i;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return new e(this.r,this.g,this.b,this.alpha);}},{key:"buildCSSText",value:function(t,e,n){return"".concat(n,"rgba(").concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")");}}]);}(em),eM=new ex("unset"),eA={"":eM,unset:eM,initial:new ex("initial"),inherit:new ex("inherit")},eC=new eP(0,0,0,0,!0),eR=new eP(0,0,0,0),eO=eo(function(t,e,n,r){return new eP(t,e,n,r);},function(t,e,n,r){return"rgba(".concat(t,",").concat(e,",").concat(n,",").concat(r,")");}),eL=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:es.kNumber;return new eb(t,e);};new eb(50,"%");var eI=function(){var t={linearGradient:/^(linear\-gradient)/i,repeatingLinearGradient:/^(repeating\-linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,repeatingRadialGradient:/^(repeating\-radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},e="";function n(t){throw Error("".concat(e,": ").concat(t));}function r(){return i("linear-gradient",t.linearGradient,o)||i("repeating-linear-gradient",t.repeatingLinearGradient,o)||i("radial-gradient",t.radialGradient,s)||i("repeating-radial-gradient",t.repeatingRadialGradient,s)||i("conic-gradient",t.conicGradient,s);}function i(e,r,i){return a(r,function(r){var a=i();return a&&!m(t.comma)&&n("Missing comma before color stops"),{type:e,orientation:a,colorStops:d(f)};});}function a(e,r){var i=m(e);if(i){m(t.startCall)||n("Missing (");var a=r(i);return m(t.endCall)||n("Missing )"),a;}}function o(){return y("directional",t.sideOrCorner,1)||y("angular",t.angleValue,1);}function s(){var n,r,i=l();return i&&((n=[]).push(i),r=e,m(t.comma)&&((i=l())?n.push(i):e=r)),n;}function l(){var t,e,n=((t=y("shape",/^(circle)/i,0))&&(t.style=g()||u()),t||((e=y("shape",/^(ellipse)/i,0))&&(e.style=p()||u()),e));if(n)n.at=c();else{var r=u();if(r){n=r;var i=c();i&&(n.at=i);}else{var a=h();a&&(n={type:"default-radial",at:a});}}return n;}function u(){return y("extent-keyword",t.extentKeywords,1);}function c(){if(y("position",/^at/,0)){var t=h();return t||n("Missing positioning value"),t;}}function h(){var t={x:p(),y:p()};if(t.x||t.y)return{type:"position",value:t};}function d(e){var r=e(),i=[];if(r)for(i.push(r);m(t.comma);)(r=e())?i.push(r):n("One extra comma");return i;}function f(){var e=y("hex",t.hexColor,1)||a(t.rgbaColor,function(){return{type:"rgba",value:d(v)};})||a(t.rgbColor,function(){return{type:"rgb",value:d(v)};})||y("literal",t.literalColor,0);return e||n("Expected color definition"),e.length=p(),e;}function v(){return m(t.number)[1];}function p(){return y("%",t.percentageValue,1)||y("position-keyword",t.positionKeywords,1)||g();}function g(){return y("px",t.pixelValue,1)||y("em",t.emValue,1);}function y(t,e,n){var r=m(e);if(r)return{type:t,value:r[n]};}function m(t){var n=/^[\n\r\t\s]+/.exec(e);n&&k(n[0].length);var r=t.exec(e);return r&&k(r[0].length),r;}function k(t){e=e.substring(t);}return function(t){var i;return e=t,i=d(r),e.length>0&&n("Invalid input not EOF"),i;};}(),eD=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,e_=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,eG=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,eF=/[\d.]+:(#[^\s]+|[^\)]+\))/gi,eB={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},eU=eo(function(t){return eL("angular"===t.type?Number(t.value):eB[t.value]||0,"deg");}),eV=eo(function(t){var e=50,n=50,r="%",i="%";if((null==t?void 0:t.type)==="position"){var a=t.value,o=a.x,s=a.y;(null==o?void 0:o.type)==="position-keyword"&&("left"===o.value?e=0:"center"===o.value?e=50:"right"===o.value?e=100:"top"===o.value?n=0:"bottom"===o.value&&(n=100)),(null==s?void 0:s.type)==="position-keyword"&&("left"===s.value?e=0:"center"===s.value?n=50:"right"===s.value?e=100:"top"===s.value?n=0:"bottom"===s.value&&(n=100)),((null==o?void 0:o.type)==="px"||(null==o?void 0:o.type)==="%"||(null==o?void 0:o.type)==="em")&&(r=null==o?void 0:o.type,e=Number(o.value)),((null==s?void 0:s.type)==="px"||(null==s?void 0:s.type)==="%"||(null==s?void 0:s.type)==="em")&&(i=null==s?void 0:s.type,n=Number(s.value));}return{cx:eL(e,r),cy:eL(n,i)};}),ez=eo(function(t){if(t.indexOf("linear")>-1||t.indexOf("radial")>-1)return eI(t).map(function(t){var e=t.type,n=t.orientation,r=t.colorStops;!function(t){var e=t.length;t[e-1].length=null!==(a=t[e-1].length)&&void 0!==a?a:{type:"%",value:"100"},e>1&&(t[0].length=null!==(o=t[0].length)&&void 0!==o?o:{type:"%",value:"0"});for(var n=0,r=Number(t[0].length.value),i=1;i<e;i++){var a,o,s,l=null===(s=t[i].length)||void 0===s?void 0:s.value;if(!(0,F.isNil)(l)&&!(0,F.isNil)(r)){for(var u=1;u<i-n;u++)t[n+u].length={type:"%",value:"".concat(r+(Number(l)-r)*u/(i-n))};n=i,r=Number(l);}}}(r);var i=r.map(function(t){var e,n;return{offset:eL(Number(t.length.value),"%"),color:(e=t.type,n=t.value,"hex"===e?"#".concat(n):"literal"===e?n:"rgb"===e?"rgb(".concat(n.join(","),")"):"rgba(".concat(n.join(","),")"))};});if("linear-gradient"===e)return new eE(ek.LinearGradient,{angle:n?eU(n):ew,steps:i});if("radial-gradient"===e&&(n||(n=[{type:"shape",value:"circle"}]),"shape"===n[0].type&&"circle"===n[0].value)){var a,o=eV(n[0].at),s=o.cx,l=o.cy;if(n[0].style){var u=n[0].style,c=u.type,h=u.value;"extent-keyword"===c?(eA[h]||(eA[h]=new ex(h)),a=eA[h]):a=eL(h,c);}return new eE(ek.RadialGradient,{cx:s,cy:l,size:a,steps:i});}});var e=t[0];if("("===t[1]||"("===t[2]){if("l"===e){var n=eD.exec(t);if(n){var r,i=(null===(r=n[2].match(eF))||void 0===r?void 0:r.map(function(t){return t.split(":");}))||[];return[new eE(ek.LinearGradient,{angle:eL(parseFloat(n[1]),"deg"),steps:i.map(function(t){var e=(0,D.default)(t,2),n=e[0],r=e[1];return{offset:eL(100*Number(n),"%"),color:r};})})];}}else if("r"===e){var a=function(t){var e=e_.exec(t);if(e){var n,r=(null===(n=e[4].match(eF))||void 0===n?void 0:n.map(function(t){return t.split(":");}))||[];return{cx:eL(50,"%"),cy:eL(50,"%"),steps:r.map(function(t){var e=(0,D.default)(t,2),n=e[0],r=e[1];return{offset:eL(100*Number(n),"%"),color:r};})};}return null;}(t);if(a){if(!(0,F.isString)(a))return[new eE(ek.RadialGradient,a)];t=a;}}else if("p"===e)return function(t){var e=eG.exec(t);if(e){var n=e[1],r=e[2];switch(n){case"a":n="repeat";break;case"x":n="repeat-x";break;case"y":n="repeat-y";break;default:n="no-repeat";}return{image:r,repetition:n};}return null;}(t);}});function eH(t){return t&&!(0,F.isNil)(t.r)&&!(0,F.isNil)(t.g)&&!(0,F.isNil)(t.b);}var eY=eo(function(t){if((e=t)&&e.image)return(0,A.default)({repetition:"repeat"},t);if((0,F.isNil)(t)&&(t=""),"transparent"===t)return eR;if("currentColor"===t)t="black";else if("none"===t)return eC;var e,n=ez(t);if(n)return n;var r=t1(t),i=[0,0,0,0];return null!==r&&(i[0]=r.r||0,i[1]=r.g||0,i[2]=r.b||0,i[3]=r.opacity),eO.apply(void 0,i);});function eW(t,e){if(eH(t)&&eH(e))return[[Number(t.r),Number(t.g),Number(t.b),Number(t.alpha)],[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],function(t){var e=t.slice();if(e[3])for(var n=0;n<3;n++)e[n]=Math.round((0,F.clamp)(e[n],0,255));return e[3]=(0,F.clamp)(e[3],0,1),"rgba(".concat(e.join(","),")");}];}function eq(t,e){if((0,F.isNil)(e))return eL(0,"px");if(isFinite(Number(e="".concat(e).trim().toLowerCase()))){if("px".search(t)>=0)return eL(Number(e),"px");if("deg".search(t)>=0)return eL(Number(e),"deg");}var n=[];e=e.replace(t,function(t){return n.push(t),"U".concat(t);});var r="U(".concat(t.source,")");return n.map(function(t){return eL(Number(e.replace(RegExp("U".concat(t),"g"),"").replace(RegExp(r,"g"),"*0")),t);})[0];}var eX=function(t){return eq(/px/g,t);},ej=eo(eX);eo(function(t){return eq(RegExp("%","g"),t);});var e$=function(t){return(0,F.isNumber)(t)||isFinite(Number(t))?eL(Number(t)||0,"px"):eq(RegExp("px|%|em|rem","g"),t);},eK=eo(e$),eZ=function(t){return eq(RegExp("deg|rad|grad|turn","g"),t);},eQ=eo(eZ);function eJ(t){var e=0;return t.unit===es.kDegrees?e=t.value:t.unit===es.kRadians?e=Number(t.value)*tp:t.unit===es.kTurns?e=360*Number(t.value):t.value&&(e=t.value),e;}function e0(t,e){var n;return(Array.isArray(t)?n=t.map(function(t){return Number(t);}):(0,F.isString)(t)?n=t.split(" ").map(function(t){return Number(t);}):(0,F.isNumber)(t)&&(n=[t]),2===e)?1===n.length?[n[0],n[0]]:[n[0],n[1]]:4===e?1===n.length?[n[0],n[0],n[0],n[0]]:2===n.length?[n[0],n[1],n[0],n[1]]:3===n.length?[n[0],n[1],n[2],n[1]]:[n[0],n[1],n[2],n[3]]:"even"===e&&n.length%2==1?[].concat((0,O.default)(n),(0,O.default)(n)):n;}function e1(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t.unit===es.kPixels)return Number(t.value);if(t.unit===es.kPercentage&&n){var i=n.nodeName===j.GROUP?n.getLocalBounds():n.getGeometryBounds();return(r?i.min[e]:0)+t.value/100*i.halfExtents[e]*2;}return 0;}var e2=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function e3(t){return t.toString();}var e4=function(t){return"number"==typeof t?eL(t):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(t)?eL(Number(t)):eL(0);},e5=eo(e4);function e6(t,e){return[t,e,e3];}function e7(t,e){return function(n,r){return[n,r,function(n){return e3((0,F.clamp)(n,t,e));}];};}function e9(t,e){if(t.length===e.length)return[t,e,function(t){return t;}];}function e8(t){return 0===t.parsedStyle.d.totalLength&&(t.parsedStyle.d.totalLength=(0,F.getTotalLength)(t.parsedStyle.d.absolutePath)),t.parsedStyle.d.totalLength;}function nt(t,e){return t[0]===e[0]&&t[1]===e[1];}function ne(t,e){var n=t.prePoint,r=t.currentPoint,i=t.nextPoint,a=Math.pow(r[0]-n[0],2)+Math.pow(r[1]-n[1],2),o=Math.pow(r[0]-i[0],2)+Math.pow(r[1]-i[1],2),s=Math.acos((a+o-(Math.pow(n[0]-i[0],2)+Math.pow(n[1]-i[1],2)))/(2*Math.sqrt(a)*Math.sqrt(o)));if(!s||0===Math.sin(s)||(0,F.isNumberEqual)(s,0))return{xExtra:0,yExtra:0};var l=Math.abs(Math.atan2(i[1]-r[1],i[0]-r[0])),u=Math.abs(Math.atan2(i[0]-r[0],i[1]-r[1]));return{xExtra:e/2*(1/Math.sin(s/2))*Math.cos(s/2-(l=l>Math.PI/2?Math.PI-l:l))-e/2||0,yExtra:e/2*(1/Math.sin(s/2))*Math.cos((u=u>Math.PI/2?Math.PI-u:u)-s/2)-e/2||0};}function nn(t,e){return[e[0]+(e[0]-t[0]),e[1]+(e[1]-t[1])];}eo(function(t){return(0,F.isString)(t)?t.split(" ").map(e5):t.map(e5);});var nr=function(t,e){var n=t.x*e.x+t.y*e.y,r=Math.sqrt((Math.pow(t.x,2)+Math.pow(t.y,2))*(Math.pow(e.x,2)+Math.pow(e.y,2)));return(t.x*e.y-t.y*e.x<0?-1:1)*Math.acos(n/r);},ni=function(t,e,n,r,i,a,o,s){e=Math.abs(e),n=Math.abs(n);var l=(r=(0,F.mod)(r,360))*tf;if(t.x===o.x&&t.y===o.y)return{x:t.x,y:t.y,ellipticalArcAngle:0};if(0===e||0===n)return{x:0,y:0,ellipticalArcAngle:0};var u=(t.x-o.x)/2,c=(t.y-o.y)/2,h={x:Math.cos(l)*u+Math.sin(l)*c,y:-Math.sin(l)*u+Math.cos(l)*c},d=Math.pow(h.x,2)/Math.pow(e,2)+Math.pow(h.y,2)/Math.pow(n,2);d>1&&(e*=Math.sqrt(d),n*=Math.sqrt(d));var f=(Math.pow(e,2)*Math.pow(n,2)-Math.pow(e,2)*Math.pow(h.y,2)-Math.pow(n,2)*Math.pow(h.x,2))/(Math.pow(e,2)*Math.pow(h.y,2)+Math.pow(n,2)*Math.pow(h.x,2)),v=(i!==a?1:-1)*Math.sqrt(f=f<0?0:f),p={x:v*(e*h.y/n),y:v*(-(n*h.x)/e)},g={x:Math.cos(l)*p.x-Math.sin(l)*p.y+(t.x+o.x)/2,y:Math.sin(l)*p.x+Math.cos(l)*p.y+(t.y+o.y)/2},y={x:(h.x-p.x)/e,y:(h.y-p.y)/n},m=nr({x:1,y:0},y),k=nr(y,{x:(-h.x-p.x)/e,y:(-h.y-p.y)/n});!a&&k>0?k-=2*Math.PI:a&&k<0&&(k+=2*Math.PI);var E=m+(k%=2*Math.PI)*s,x=e*Math.cos(E),T=n*Math.sin(E);return{x:Math.cos(l)*x-Math.sin(l)*T+g.x,y:Math.sin(l)*x+Math.cos(l)*T+g.y,ellipticalArcStartAngle:m,ellipticalArcEndAngle:m+k,ellipticalArcAngle:E,ellipticalArcCenter:g,resultantRx:e,resultantRy:n};};function na(t,e){var n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=t.arcParams,i=r.rx,a=void 0===i?0:i,o=r.ry,s=void 0===o?0:o,l=r.xRotation,u=r.arcFlag,c=r.sweepFlag,h=ni({x:t.prePoint[0],y:t.prePoint[1]},a,s,l,!!u,!!c,{x:t.currentPoint[0],y:t.currentPoint[1]},e),d=ni({x:t.prePoint[0],y:t.prePoint[1]},a,s,l,!!u,!!c,{x:t.currentPoint[0],y:t.currentPoint[1]},n?e+.005:e-.005),f=d.x-h.x,v=d.y-h.y,p=Math.sqrt(f*f+v*v);return{x:-f/p,y:-v/p};}function no(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1]);}function ns(t,e){return no(t)*no(e)?(t[0]*e[0]+t[1]*e[1])/(no(t)*no(e)):1;}function nl(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(ns(t,e));}var nu=function(t){if(""===t||Array.isArray(t)&&0===t.length)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};try{e=(0,F.normalizePath)(t);}catch(n){e=(0,F.normalizePath)(""),console.error("[g]: Invalid SVG Path definition: ".concat(t));}!function(t){for(var e=0;e<t.length;e++){var n=t[e-1],r=t[e];if("M"===r[0]&&n){var i=n[0],a=[r[1],r[2]],o=void 0;"L"===i||"M"===i?o=[n[1],n[2]]:("C"===i||"A"===i||"Q"===i)&&(o=[n[n.length-2],n[n.length-1]]),o&&nt(a,o)&&(t.splice(e,1),e--);}}}(e);var e,n=function(t){for(var e=!1,n=t.length,r=0;r<n;r++){var i=t[r][0];if("C"===i||"A"===i||"Q"===i){e=!0;break;}}return e;}(e),r=function(t){for(var e=[],n=[],r=[],i=0;i<t.length;i++){var a=t[i],o=a[0];"M"===o?(r.length&&(n.push(r),r=[]),r.push([a[1],a[2]])):"Z"===o?r.length&&(e.push(r),r=[]):r.push([a[1],a[2]]);}return r.length>0&&n.push(r),{polygons:e,polylines:n};}(e),i=r.polygons,a=r.polylines,o=function(t){for(var e=[],n=null,r=null,i=null,a=0,o=t.length,s=0;s<o;s++){var l=t[s];r=t[s+1];var u=l[0],c={command:u,prePoint:n,params:l,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(u){case"M":i=[l[1],l[2]],a=s;break;case"A":var h=function(t,e){var n=e[1],r=e[2],i=(0,F.mod)(e[3]*tf,2*Math.PI),a=e[4],o=e[5],s=t[0],l=t[1],u=e[6],c=e[7],h=Math.cos(i)*(s-u)/2+Math.sin(i)*(l-c)/2,d=-1*Math.sin(i)*(s-u)/2+Math.cos(i)*(l-c)/2,f=h*h/(n*n)+d*d/(r*r);f>1&&(n*=Math.sqrt(f),r*=Math.sqrt(f));var v=n*n*(d*d)+r*r*(h*h),p=v?Math.sqrt((n*n*(r*r)-v)/v):1;a===o&&(p*=-1),isNaN(p)&&(p=0);var g=r?p*n*d/r:0,y=n?-(p*r)*h/n:0,m=(s+u)/2+Math.cos(i)*g-Math.sin(i)*y,k=(l+c)/2+Math.sin(i)*g+Math.cos(i)*y,E=[(h-g)/n,(d-y)/r],x=[(-1*h-g)/n,(-1*d-y)/r],T=nl([1,0],E),N=nl(E,x);return -1>=ns(E,x)&&(N=Math.PI),ns(E,x)>=1&&(N=0),0===o&&N>0&&(N-=2*Math.PI),1===o&&N<0&&(N+=2*Math.PI),{cx:m,cy:k,rx:nt(t,[u,c])?0:n,ry:nt(t,[u,c])?0:r,startAngle:T,endAngle:T+N,xRotation:i,arcFlag:a,sweepFlag:o};}(n,l);c.arcParams=h;}if("Z"===u)n=i,r=t[a+1];else{var d=l.length;n=[l[d-2],l[d-1]];}r&&"Z"===r[0]&&(r=t[a],e[a]&&(e[a].prePoint=n)),c.currentPoint=n,e[a]&&nt(n,e[a].currentPoint)&&(e[a].prePoint=c.prePoint);var f=r?[r[r.length-2],r[r.length-1]]:null;c.nextPoint=f;var v=c.prePoint;if(["L","H","V"].includes(u))c.startTangent=[v[0]-n[0],v[1]-n[1]],c.endTangent=[n[0]-v[0],n[1]-v[1]];else if("Q"===u){var p=[l[1],l[2]];c.startTangent=[v[0]-p[0],v[1]-p[1]],c.endTangent=[n[0]-p[0],n[1]-p[1]];}else if("T"===u){var g=e[s-1],y=nn(g.currentPoint,v);"Q"===g.command?(c.command="Q",c.startTangent=[v[0]-y[0],v[1]-y[1]],c.endTangent=[n[0]-y[0],n[1]-y[1]]):(c.command="TL",c.startTangent=[v[0]-n[0],v[1]-n[1]],c.endTangent=[n[0]-v[0],n[1]-v[1]]);}else if("C"===u){var m=[l[1],l[2]],k=[l[3],l[4]];c.startTangent=[v[0]-m[0],v[1]-m[1]],c.endTangent=[n[0]-k[0],n[1]-k[1]],0===c.startTangent[0]&&0===c.startTangent[1]&&(c.startTangent=[m[0]-k[0],m[1]-k[1]]),0===c.endTangent[0]&&0===c.endTangent[1]&&(c.endTangent=[k[0]-m[0],k[1]-m[1]]);}else if("S"===u){var E=e[s-1],x=nn(E.currentPoint,v),T=[l[1],l[2]];"C"===E.command?(c.command="C",c.startTangent=[v[0]-x[0],v[1]-x[1]]):(c.command="SQ",c.startTangent=[v[0]-T[0],v[1]-T[1]]),c.endTangent=[n[0]-T[0],n[1]-T[1]];}else if("A"===u){var N=na(c,0),b=N.x,S=N.y,w=na(c,1,!1),P=w.x,M=w.y;c.startTangent=[b,S],c.endTangent=[P,M];}e.push(c);}return e;}(e),s=function(t,e){for(var n=[],r=[],i=[],a=0;a<t.length;a++){var o=t[a],s=o.currentPoint,l=o.params,u=o.prePoint,c=void 0;switch(o.command){case"Q":c=(0,z.quadBox)(u[0],u[1],l[1],l[2],l[3],l[4]);break;case"C":c=(0,z.cubicBox)(u[0],u[1],l[1],l[2],l[3],l[4],l[5],l[6]);break;case"A":var h=o.arcParams;c=(0,z.arcBox)(h.cx,h.cy,h.rx,h.ry,h.xRotation,h.startAngle,h.endAngle);break;default:n.push(s[0]),r.push(s[1]);}c&&(o.box=c,n.push(c.x,c.x+c.width),r.push(c.y,c.y+c.height));}n=n.filter(function(t){return!Number.isNaN(t)&&t!==1/0&&t!==-1/0;}),r=r.filter(function(t){return!Number.isNaN(t)&&t!==1/0&&t!==-1/0;});var d=(0,F.min)(n),f=(0,F.min)(r),v=(0,F.max)(n),p=(0,F.max)(r);if(0===i.length)return{x:d,y:f,width:v-d,height:p-f};for(var g=0;g<i.length;g++){var y=i[g],m=y.currentPoint;m[0]===d?d-=ne(y,0).xExtra:m[0]===v&&(v+=ne(y,0).xExtra),m[1]===f?f-=ne(y,e).yExtra:m[1]===p&&(p+=ne(y,e).yExtra);}return{x:d,y:f,width:v-d,height:p-f};}(o,0),l=s.x,u=s.y,c=s.width,h=s.height;return{absolutePath:e,hasArc:n,segments:o,polygons:i,polylines:a,totalLength:0,rect:{x:Number.isFinite(l)?l:0,y:Number.isFinite(u)?u:0,width:Number.isFinite(c)?c:0,height:Number.isFinite(h)?h:0}};},nc=eo(nu);function nh(t){return(0,F.isString)(t)?nc(t):nu(t);}function nd(t,e,n){var r=t.curve,i=e.curve;r&&0!==r.length||(r=(0,F.path2Curve)(t.absolutePath,!1),t.curve=r),i&&0!==i.length||(i=(0,F.path2Curve)(e.absolutePath,!1),e.curve=i);var a=[r,i];r.length!==i.length&&(a=(0,F.equalizeSegments)(r,i));var o=(0,F.getDrawDirection)(a[0])!==(0,F.getDrawDirection)(a[1])?(0,F.reverseCurve)(a[0]):(0,F.clonePath)(a[0]);return[o,(0,F.getRotatedCurve)(a[1],o),function(t){return t;}];}function nf(t,e){return[t.points,e.points,function(t){return t;}];}var nv=/\s*(\w+)\(([^)]*)\)/g;function np(t){return function(e){var n=0;return t.map(function(t){return null===t?e[n++]:t;});};}function ng(t){return t;}var ny={matrix:["NNNNNN",[null,null,0,0,null,null,0,0,0,0,1,0,null,null,0,1],ng],matrix3d:["NNNNNNNNNNNNNNNN",ng],rotate:["A"],rotateX:["A"],rotateY:["A"],rotateZ:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",np([null,null,new eb(1)]),ng],scaleX:["N",np([null,new eb(1),new eb(1)]),np([null,new eb(1)])],scaleY:["N",np([new eb(1),null,new eb(1)]),np([new eb(1),null])],scaleZ:["N",np([new eb(1),new eb(1),null])],scale3d:["NNN",ng],skew:["Aa",null,ng],skewX:["A",null,np([null,ew])],skewY:["A",null,np([ew,null])],translate:["Tt",np([null,null,eS]),ng],translateX:["T",np([null,eS,eS]),np([null,eS])],translateY:["T",np([eS,null,eS]),np([eS,null])],translateZ:["L",np([eS,eS,null])],translate3d:["TTL",ng]};function nm(t){for(var e=[],n=t.length,r=0;r<n;r++){var i=t[r],a=i[0],o=i.slice(1);if("translate"===a||"skew"===a?1===o.length&&o.push(0):"scale"===a&&1===o.length&&o.push(o[0]),!ny[a])return[];var s=o.map(function(t){return eL(t);});e.push({t:a,d:s});}return e;}function nk(t){if(Array.isArray(t))return nm(t);if("none"===(t=(t||"none").trim()))return[];var e,n=[],r=0;for(nv.lastIndex=0;(e=nv.exec(t))&&e.index===r;){r=e.index+e[0].length;var i=e[1],a=ny[i];if(!a)break;var o=e[2].split(","),s=a[0];if(s.length<o.length)break;for(var l=[],u=0;u<s.length;u++){var c=o[u],h=s[u],d=void 0;if(void 0===(d=c?({A:function(t){return"0"===t.trim()?ew:eZ(t);},N:e4,T:e$,L:eX})[h.toUpperCase()](c):({a:ew,n:l[0],t:eS})[h]))return[];l.push(d);}if(n.push({t:i,d:l}),nv.lastIndex===t.length)return n;}return[];}function nE(t){switch(t.t){case"rotateX":return[1,0,0,0,0,Math.cos(i=eJ(t.d[0])*tf),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1];case"rotateY":return[Math.cos(i=eJ(t.d[0])*tf),0,-Math.sin(i),0,0,1,0,0,Math.sin(i),0,Math.cos(i),0,0,0,0,1];case"rotate":case"rotateZ":return[Math.cos(i=eJ(t.d[0])*tf),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1,0,0,0,0,1];case"rotate3d":e=t.d[0].value,n=t.d[1].value,r=t.d[2].value,i=eJ(t.d[3])*tf;var e,n,r,i,a=e*e+n*n+r*r;if(0===a)e=1,n=0,r=0;else if(1!==a){var o=Math.sqrt(a);e/=o,n/=o,r/=o;}var s=Math.sin(i/2),l=s*Math.cos(i/2),u=s*s;return[1-2*(n*n+r*r)*u,2*(e*n*u+r*l),2*(e*r*u-n*l),0,2*(e*n*u-r*l),1-2*(e*e+r*r)*u,2*(n*r*u+e*l),0,2*(e*r*u+n*l),2*(n*r*u-e*l),1-2*(e*e+n*n)*u,0,0,0,0,1];case"scale":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scaleX":return[t.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaleY":return[1,0,0,0,0,t.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scaleZ":return[1,0,0,0,0,1,0,0,0,0,t.d[0].value,0,0,0,0,1];case"scale3d":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,t.d[2].value,0,0,0,0,1];case"skew":var c=eJ(t.d[0])*tf;return[1,Math.tan(eJ(t.d[1])*tf),0,0,Math.tan(c),1,0,0,0,0,1,0,0,0,0,1];case"skewX":return[1,0,0,0,Math.tan(i=eJ(t.d[0])*tf),1,0,0,0,0,1,0,0,0,0,1];case"skewY":return[1,Math.tan(i=eJ(t.d[0])*tf),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return[1,0,0,0,0,1,0,0,0,0,1,0,e=e1(t.d[0],0,null)||0,n=e1(t.d[1],0,null)||0,0,1];case"translateX":return[1,0,0,0,0,1,0,0,0,0,1,0,e=e1(t.d[0],0,null)||0,0,0,1];case"translateY":return[1,0,0,0,0,1,0,0,0,0,1,0,0,n=e1(t.d[0],0,null)||0,0,1];case"translateZ":return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,r=e1(t.d[0],0,null)||0,1];case"translate3d":return[1,0,0,0,0,1,0,0,0,0,1,0,e=e1(t.d[0],0,null)||0,n=e1(t.d[1],0,null)||0,r=e1(t.d[2],0,null)||0,1];case"perspective":var h=e1(t.d[0],0,null)||0;return[1,0,0,0,0,1,0,0,0,0,1,h?-1/h:0,0,0,0,1];case"matrix":return[t.d[0].value,t.d[1].value,0,0,t.d[2].value,t.d[3].value,0,0,0,0,1,0,t.d[4].value,t.d[5].value,0,1];case"matrix3d":return t.d.map(function(t){return t.value;});}}function nx(t,e){return[t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12]*e[3],t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13]*e[3],t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]*e[3],t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15]*e[3],t[0]*e[4]+t[4]*e[5]+t[8]*e[6]+t[12]*e[7],t[1]*e[4]+t[5]*e[5]+t[9]*e[6]+t[13]*e[7],t[2]*e[4]+t[6]*e[5]+t[10]*e[6]+t[14]*e[7],t[3]*e[4]+t[7]*e[5]+t[11]*e[6]+t[15]*e[7],t[0]*e[8]+t[4]*e[9]+t[8]*e[10]+t[12]*e[11],t[1]*e[8]+t[5]*e[9]+t[9]*e[10]+t[13]*e[11],t[2]*e[8]+t[6]*e[9]+t[10]*e[10]+t[14]*e[11],t[3]*e[8]+t[7]*e[9]+t[11]*e[10]+t[15]*e[11],t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12]*e[15],t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13]*e[15],t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14]*e[15],t[3]*e[12]+t[7]*e[13]+t[11]*e[14]+t[15]*e[15]];}function nT(t){var e=[0,0,0],n=[1,1,1],r=[0,0,0],i=[0,0,0,1],a=[0,0,0,1];return!function(t,e,n,r,i,a){if(!(!function(t,e){var n=e[15];if(0===n)return!1;for(var r=1/n,i=0;i<16;i++)t[i]=e[i]*r;return!0;}(tE,t)||(G.mat4.copy(tx,tE),tx[3]=0,tx[7]=0,tx[11]=0,tx[15]=1,1e-8>Math.abs(G.mat4.determinant(tx))))){var o=tE[3],s=tE[7],l=tE[11],u=tE[12],c=tE[13],h=tE[14],d=tE[15];if(0!==o||0!==s||0!==l){if(tT[0]=o,tT[1]=s,tT[2]=l,tT[3]=d,!G.mat4.invert(tx,tx))return;G.mat4.transpose(tx,tx),G.vec4.transformMat4(i,tT,tx);}else i[0]=i[1]=i[2]=0,i[3]=1;if(e[0]=u,e[1]=c,e[2]=h,tN[0][0]=tE[0],tN[0][1]=tE[1],tN[0][2]=tE[2],tN[1][0]=tE[4],tN[1][1]=tE[5],tN[1][2]=tE[6],tN[2][0]=tE[8],tN[2][1]=tE[9],tN[2][2]=tE[10],n[0]=G.vec3.length(tN[0]),G.vec3.normalize(tN[0],tN[0]),r[0]=G.vec3.dot(tN[0],tN[1]),tS(tN[1],tN[1],tN[0],1,-r[0]),n[1]=G.vec3.length(tN[1]),G.vec3.normalize(tN[1],tN[1]),r[0]/=n[1],r[1]=G.vec3.dot(tN[0],tN[2]),tS(tN[2],tN[2],tN[0],1,-r[1]),r[2]=G.vec3.dot(tN[1],tN[2]),tS(tN[2],tN[2],tN[1],1,-r[2]),n[2]=G.vec3.length(tN[2]),G.vec3.normalize(tN[2],tN[2]),r[1]/=n[2],r[2]/=n[2],G.vec3.cross(tb,tN[1],tN[2]),0>G.vec3.dot(tN[0],tb))for(var f=0;f<3;f++)n[f]*=-1,tN[f][0]*=-1,tN[f][1]*=-1,tN[f][2]*=-1;a[0]=.5*Math.sqrt(Math.max(1+tN[0][0]-tN[1][1]-tN[2][2],0)),a[1]=.5*Math.sqrt(Math.max(1-tN[0][0]+tN[1][1]-tN[2][2],0)),a[2]=.5*Math.sqrt(Math.max(1-tN[0][0]-tN[1][1]+tN[2][2],0)),a[3]=.5*Math.sqrt(Math.max(1+tN[0][0]+tN[1][1]+tN[2][2],0)),tN[2][1]>tN[1][2]&&(a[0]=-a[0]),tN[0][2]>tN[2][0]&&(a[1]=-a[1]),tN[1][0]>tN[0][1]&&(a[2]=-a[2]);}}(0===t.length?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:t.map(nE).reduce(nx),e,n,r,i,a),[[e,n,r,a,i]];}var nN=function(){function t(t,e){for(var n=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],r=0;r<4;r++)for(var i=0;i<4;i++)for(var a=0;a<4;a++)n[r][i]+=e[r][a]*t[a][i];return n;}return function(e,n,r,i,a){for(var o,s=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],l=0;l<4;l++)s[l][3]=a[l];for(var u=0;u<3;u++)for(var c=0;c<3;c++)s[3][u]+=e[c]*s[c][u];var h=i[0],d=i[1],f=i[2],v=i[3],p=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];p[0][0]=1-2*(d*d+f*f),p[0][1]=2*(h*d-f*v),p[0][2]=2*(h*f+d*v),p[1][0]=2*(h*d+f*v),p[1][1]=1-2*(h*h+f*f),p[1][2]=2*(d*f-h*v),p[2][0]=2*(h*f-d*v),p[2][1]=2*(d*f+h*v),p[2][2]=1-2*(h*h+d*d),s=t(s,p);var g=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];r[2]&&(g[2][1]=r[2],s=t(s,g)),r[1]&&(g[2][1]=0,g[2][0]=r[0],s=t(s,g)),r[0]&&(g[2][0]=0,g[1][0]=r[0],s=t(s,g));for(var y=0;y<3;y++)for(var m=0;m<3;m++)s[y][m]*=n[y];return 0===(o=s)[0][2]&&0===o[0][3]&&0===o[1][2]&&0===o[1][3]&&0===o[2][0]&&0===o[2][1]&&1===o[2][2]&&0===o[2][3]&&0===o[3][2]&&1===o[3][3]?[s[0][0],s[0][1],s[1][0],s[1][1],s[3][0],s[3][1]]:s[0].concat(s[1],s[2],s[3]);};}();function nb(t){return t.toFixed(6).replace(".000000","");}function nS(t,e){var n,r;return(t.decompositionPair!==e&&(t.decompositionPair=e,n=nT(t)),e.decompositionPair!==t&&(e.decompositionPair=t,r=nT(e)),null===n[0]||null===r[0])?[[!1],[!0],function(n){return n?e[0].d:t[0].d;}]:(n[0].push(0),r[0].push(1),[n,r,function(t){var e=function(t,e,n){var r=function(t,e){for(var n=0,r=0;r<t.length;r++)n+=t[r]*e[r];return n;}(t,e);r=(0,F.clamp)(r,-1,1);var i=[];if(1===r)i=t;else for(var a=Math.acos(r),o=1*Math.sin(n*a)/Math.sqrt(1-r*r),s=0;s<4;s++)i.push(t[s]*(Math.cos(n*a)-r*o)+e[s]*o);return i;}(n[0][3],r[0][3],t[5]);return nN(t[0],t[1],t[2],e,t[4]).map(nb).join(",");}]);}function nw(t){return t.replace(/[XY]/,"");}function nP(t){return t.replace(/(X|Y|Z|3d)?$/,"3d");}function nM(t,e,n){var r=!1;if(!t.length||!e.length){t.length||(r=!0,t=e,e=[]);for(var i=0;i<t.length;i++)!function(){var n=t[i],r=n.t,a=n.d,o="scale"===r.substring(0,5)?1:0;e.push({t:r,d:a.map(function(t){return"number"==typeof t?eL(o):eL(o,t.unit);})});}();}var a=[],o=[],s=[];if(t.length!==e.length){var l=nS(t,e);a=[l[0]],o=[l[1]],s=[["matrix",[l[2]]]];}else for(var u=0;u<t.length;u++){var c=t[u].t,h=e[u].t,d=t[u].d,f=e[u].d,v=ny[c],p=ny[h],g=void 0;if("perspective"===c&&"perspective"===h||("matrix"===c||"matrix3d"===c)&&("matrix"===h||"matrix3d"===h)){var y=nS([t[u]],[e[u]]);a.push(y[0]),o.push(y[1]),s.push(["matrix",[y[2]]]);continue;}if(c===h)g=c;else if(v[2]&&p[2]&&nw(c)===nw(h))g=nw(c),d=v[2](d),f=p[2](f);else if(v[1]&&p[1]&&nP(c)===nP(h))g=nP(c),d=v[1](d),f=p[1](f);else{var m=nS(t,e);a=[m[0]],o=[m[1]],s=[["matrix",[m[2]]]];break;}for(var k=[],E=[],x=[],T=0;T<d.length;T++){var N=function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a="",o=t.value||0,s=e.value||0,l=eN(t.unit),u=t.convertTo(l),c=e.convertTo(l);return u&&c?(o=u.value,s=c.value,a=eg(t.unit)):(eb.isLength(t.unit)||eb.isLength(e.unit))&&(o=e1(t,i,n),s=e1(e,i,n),a="px"),[o,s,function(t){return r&&(t=Math.max(t,0)),t+a;}];}(d[T],f[T],n,!1,T);k[T]=N[0],E[T]=N[1],x.push(N[2]);}a.push(k),o.push(E),s.push([g,x]);}if(r){var b=a;a=o,o=b;}return[a,o,function(t){return t.map(function(t,e){var n=t.map(function(t,n){return s[e][1][n](t);}).join(",");return"matrix"===s[e][0]&&16===n.split(",").length&&(s[e][0]="matrix3d"),"matrix3d"===s[e][0]&&6===n.split(",").length&&(s[e][0]="matrix"),"".concat(s[e][0],"(").concat(n,")");}).join(" ");}];}var nA=eo(function(t){if((0,F.isString)(t)){if("text-anchor"===t)return[eL(0,"px"),eL(0,"px")];var e=t.split(" ");return(1===e.length&&("top"===e[0]||"bottom"===e[0]?(e[1]=e[0],e[0]="center"):e[1]="center"),2!==e.length)?null:[eK(nC(e[0])),eK(nC(e[1]))];}return[eL(t[0]||0,"px"),eL(t[1]||0,"px")];});function nC(t){return"center"===t?"50%":"left"===t||"top"===t?"0%":"right"===t||"bottom"===t?"100%":t;}var nR=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:tF.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:tF.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:tF.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:tF.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:tF.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:tF.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:tF.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:tF.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:tF.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:tF.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:tF.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:tF.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:tF.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:tF.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:tF.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:tF.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:tF.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:tF.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:tF.FILTER},{n:"clipPath",syntax:tF.DEFINED_PATH},{n:"textPath",syntax:tF.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:tF.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:tF.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:tF.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:tF.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:tF.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:tF.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:tF.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:tF.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:tF.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:tF.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:tF.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:tF.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:tF.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:tF.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:tF.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:tF.COORDINATE},{n:"y1",int:!0,l:!0,syntax:tF.COORDINATE},{n:"z1",int:!0,l:!0,syntax:tF.COORDINATE},{n:"x2",int:!0,l:!0,syntax:tF.COORDINATE},{n:"y2",int:!0,l:!0,syntax:tF.COORDINATE},{n:"z2",int:!0,l:!0,syntax:tF.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:tF.PATH,p:50},{n:"points",int:!0,l:!0,syntax:tF.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:tF.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:tF.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:tF.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:tF.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:tF.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:tF.NUMBER,d:function(t){return t===j.PATH||t===j.POLYGON||t===j.POLYLINE?"4":"10";}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:tF.MARKER},{n:"markerEnd",syntax:tF.MARKER},{n:"markerMid",syntax:tF.MARKER},{n:"markerStartOffset",syntax:tF.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:tF.LENGTH,l:!0,int:!0,d:"0"}],nO=new Set(nR.filter(function(t){return!!t.l;}).map(function(t){return t.n;})),nL={},nI=(0,R.default)(function t(e){var n=this;(0,C.default)(this,t),this.runtime=e,nR.forEach(function(t){n.registerMetadata(t);});},[{key:"registerMetadata",value:function(t){[t.n].concat((0,O.default)(t.a||[])).forEach(function(e){nL[e]=t;});}},{key:"getPropertySyntax",value:function(t){return this.runtime.CSSPropertySyntaxFactory[t];}},{key:"processProperties",value:function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[],memoize:!0};Object.assign(t.attributes,e);var i=t.parsedStyle.clipPath,a=t.parsedStyle.offsetPath;!function(t,e){var n=nD(t);for(var r in e)n.has(r)&&(t.parsedStyle[r]=e[r]);}(t,e);var o=!!r.forceUpdateGeometry;if(!o){for(var s in e)if(nO.has(s)){o=!0;break;}}var l=nD(t);l.has("fill")&&e.fill&&(t.parsedStyle.fill=eY(e.fill)),l.has("stroke")&&e.stroke&&(t.parsedStyle.stroke=eY(e.stroke)),l.has("shadowColor")&&e.shadowColor&&(t.parsedStyle.shadowColor=eY(e.shadowColor)),l.has("filter")&&e.filter&&(t.parsedStyle.filter=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if("none"===(e=e.toLowerCase().trim()))return[];for(var n=/\s*([\w-]+)\(([^)]*)\)/g,r=[],i=0;(t=n.exec(e))&&t.index===i;)if(i=t.index+t[0].length,e2.indexOf(t[1])>-1&&r.push({name:t[1],params:t[2].split(" ").map(function(t){return eq(/deg|rad|grad|turn|px|%/g,t)||eY(t);})}),n.lastIndex===e.length)return r;return[];}(e.filter)),l.has("radius")&&!(0,F.isNil)(e.radius)&&(t.parsedStyle.radius=e0(e.radius,4)),l.has("lineDash")&&!(0,F.isNil)(e.lineDash)&&(t.parsedStyle.lineDash=e0(e.lineDash,"even")),l.has("points")&&e.points&&(t.parsedStyle.points=(n=e.points,{points:(0,F.isString)(n)?n.split(" ").map(function(t){var e=t.split(","),n=(0,D.default)(e,2),r=n[0],i=n[1];return[Number(r),Number(i)];}):n,totalLength:0,segments:[]})),l.has("d")&&""===e.d&&(t.parsedStyle.d=(0,A.default)({},tG)),l.has("d")&&e.d&&(t.parsedStyle.d=nh(e.d)),l.has("textTransform")&&e.textTransform&&this.runtime.CSSPropertySyntaxFactory[tF.TEXT_TRANSFORM].calculator(null,null,{value:e.textTransform},t,null),l.has("clipPath")&&!(0,F.isUndefined)(e.clipPath)&&this.runtime.CSSPropertySyntaxFactory[tF.DEFINED_PATH].calculator("clipPath",i,e.clipPath,t,this.runtime),l.has("offsetPath")&&e.offsetPath&&this.runtime.CSSPropertySyntaxFactory[tF.DEFINED_PATH].calculator("offsetPath",a,e.offsetPath,t,this.runtime),l.has("transform")&&e.transform&&(t.parsedStyle.transform=function(t){if(Array.isArray(t))return nm(t);if("none"===(t=(t||"none").trim()))return[];var e,n=[],r=0;for(nv.lastIndex=0;(e=nv.exec(t))&&e.index===r;){r=e.index+e[0].length;var i=e[1],a=ny[i];if(!a)break;var o=e[2].split(","),s=a[0];if(s.length<o.length)break;for(var l=[],u=0;u<s.length;u++){var c=o[u],h=s[u],d=void 0;if(void 0===(d=c?({A:function(t){return"0"===t.trim()?ew:eQ(t);},N:e5,T:eK,L:ej})[h.toUpperCase()](c):({a:ew,n:l[0],t:eS})[h]))return[];l.push(d);}if(n.push({t:i,d:l}),nv.lastIndex===t.length)return n;}return[];}(e.transform)),l.has("transformOrigin")&&e.transformOrigin&&(t.parsedStyle.transformOrigin=nA(e.transformOrigin)),l.has("markerStart")&&e.markerStart&&(t.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory[tF.MARKER].calculator(null,e.markerStart,e.markerStart,null,null)),l.has("markerEnd")&&e.markerEnd&&(t.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory[tF.MARKER].calculator(null,e.markerEnd,e.markerEnd,null,null)),l.has("markerMid")&&e.markerMid&&(t.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory[tF.MARKER].calculator("",e.markerMid,e.markerMid,null,null)),l.has("zIndex")&&!(0,F.isNil)(e.zIndex)&&this.runtime.CSSPropertySyntaxFactory[tF.Z_INDEX].postProcessor(t),l.has("offsetDistance")&&!(0,F.isNil)(e.offsetDistance)&&this.runtime.CSSPropertySyntaxFactory[tF.OFFSET_DISTANCE].postProcessor(t),l.has("transform")&&e.transform&&this.runtime.CSSPropertySyntaxFactory[tF.TRANSFORM].postProcessor(t),l.has("transformOrigin")&&e.transformOrigin&&this.runtime.CSSPropertySyntaxFactory[tF.TRANSFORM_ORIGIN].postProcessor(t),o&&(t.dirty(!0,!0),r.forceUpdateGeometry||this.runtime.sceneGraphService.dirtyToRoot(t));}},{key:"updateGeometry",value:function(t){var e=t.nodeName,n=this.runtime.geometryUpdaterFactory[e];if(n){var r=t.geometry;r.contentBounds||(r.contentBounds=new tn),r.renderBounds||(r.renderBounds=new tn);var i=t.parsedStyle,a=n.update(i,t),o=a.cx,s=a.cy,l=a.cz,u=a.hwidth,c=void 0===u?0:u,h=a.hheight,d=void 0===h?0:h,f=a.hdepth,v=[Math.abs(c),Math.abs(d),void 0===f?0:f],p=i.stroke,g=i.lineWidth,y=i.increasedLineWidthForHitTesting,m=i.shadowType,k=void 0===m?"outer":m,E=i.shadowColor,x=i.filter,T=i.transformOrigin,N=[void 0===o?0:o,void 0===s?0:s,void 0===l?0:l];r.contentBounds.update(N,v);var b=e===j.POLYLINE||e===j.POLYGON||e===j.PATH?Math.SQRT2:.5;if(p&&!p.isNone){var S=(((void 0===g?1:g)||0)+((void 0===y?0:y)||0))*b;v[0]+=S,v[1]+=S;}if(r.renderBounds.update(N,v),E&&k&&"inner"!==k){var w=r.renderBounds,P=w.min,M=w.max,A=i.shadowBlur,C=i.shadowOffsetX,R=i.shadowOffsetY,O=A||0,L=C||0,I=R||0,D=P[0]-O+L,_=M[0]+O+L,F=P[1]-O+I,B=M[1]+O+I;P[0]=Math.min(P[0],D),M[0]=Math.max(M[0],_),P[1]=Math.min(P[1],F),M[1]=Math.max(M[1],B),r.renderBounds.setMinMax(P,M);}(void 0===x?[]:x).forEach(function(t){var e=t.name,n=t.params;if("blur"===e){var i=n[0].value;r.renderBounds.update(r.renderBounds.center,G.vec3.add(r.renderBounds.halfExtents,r.renderBounds.halfExtents,[i,i,0]));}else if("drop-shadow"===e){var a=n[0].value,o=n[1].value,s=n[2].value,l=r.renderBounds,u=l.min,c=l.max,h=u[0]-s+a,d=c[0]+s+a,f=u[1]-s+o,v=c[1]+s+o;u[0]=Math.min(u[0],h),c[0]=Math.max(c[0],d),u[1]=Math.min(u[1],f),c[1]=Math.max(c[1],v),r.renderBounds.setMinMax(u,c);}}),t.geometry.dirty=!1;var U=d<0,V=(c<0?-1:1)*(T?e1(T[0],0,t,!0):0),z=(U?-1:1)*(T?e1(T[1],1,t,!0):0);(V||z)&&t.setOrigin(V,z);}}},{key:"updateSizeAttenuation",value:function(t,e){t.style.isSizeAttenuation?(t.style.rawLineWidth||(t.style.rawLineWidth=t.style.lineWidth),t.style.lineWidth=(t.style.rawLineWidth||1)/e,t.nodeName===j.CIRCLE&&(t.style.rawR||(t.style.rawR=t.style.r),t.style.r=(t.style.rawR||1)/e)):(t.style.rawLineWidth&&(t.style.lineWidth=t.style.rawLineWidth,delete t.style.rawLineWidth),t.nodeName===j.CIRCLE&&t.style.rawR&&(t.style.r=t.style.rawR,delete t.style.rawR));}}]);function nD(t){return t.constructor.PARSED_STYLE_LIST;}var n_=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e6;},[{key:"calculator",value:function(t,e,n,r){return eJ(n);}}]),nG=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r,i){return n instanceof ex&&(n=null),i.sceneGraphService.updateDisplayObjectDependency(t,e,n,r),"clipPath"===t&&r.forEach(function(t){0===t.childNodes.length&&i.sceneGraphService.dirtyToRoot(t);}),n;}}]),nF=(0,R.default)(function t(){(0,C.default)(this,t),this.parser=eY,this.mixer=eW;},[{key:"calculator",value:function(t,e,n,r){return n instanceof ex?"none"===n.value?eC:eR:n;}}]),nB=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n){return n instanceof ex?[]:n;}}]);function nU(t){var e=t.parsedStyle.fontSize;return(0,F.isNil)(e)?null:e;}var nV=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e6;},[{key:"calculator",value:function(t,e,n,r,i){if((0,F.isNumber)(n))return n;if(!eb.isRelativeUnit(n.unit))return n.value;if(n.unit===es.kPercentage)return 0;if(n.unit===es.kEms){if(r.parentNode){var a,o=nU(r.parentNode);if(o)return o*n.value;}return 0;}if(n.unit===es.kRems){if(null!=r&&null!==(a=r.ownerDocument)&&void 0!==a&&a.documentElement){var s=nU(r.ownerDocument.documentElement);if(s)return s*n.value;}return 0;}}}]),nz=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e9;},[{key:"calculator",value:function(t,e,n){return n.map(function(t){return t.value;});}}]),nH=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e9;},[{key:"calculator",value:function(t,e,n){return n.map(function(t){return t.value;});}}]),nY=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){n instanceof ex&&(n=null);var i,a=null===(i=n)||void 0===i?void 0:i.cloneNode(!0);return a&&(a.style.isMarker=!0),a;}}]),nW=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e6;},[{key:"calculator",value:function(t,e,n){return n.value;}}]),nq=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e7(0,1);},[{key:"calculator",value:function(t,e,n){return n.value;}},{key:"postProcessor",value:function(t){var e=t.parsedStyle,n=e.offsetPath,r=e.offsetDistance;if(n){var i=n.nodeName;if(i===j.LINE||i===j.PATH||i===j.POLYLINE){var a=n.getPoint(r);a&&t.setLocalPosition(a.x,a.y);}}}}]),nX=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=e7(0,1);},[{key:"calculator",value:function(t,e,n){return n.value;}}]),nj=(0,R.default)(function t(){(0,C.default)(this,t),this.parser=nh,this.mixer=nd;},[{key:"calculator",value:function(t,e,n){return n instanceof ex&&"unset"===n.value?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new ts(0,0,0,0)}:n;}}]),n$=(0,R.default)(function t(){(0,C.default)(this,t),this.mixer=nf;}),nK=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).mixer=e7(0,1/0),t;}return(0,I.default)(e,t),(0,R.default)(e);}(nV),nZ=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){return n instanceof ex?"unset"===n.value?"":n.value:"".concat(n);}},{key:"postProcessor",value:function(t){t.nodeValue="".concat(t.parsedStyle.text)||"";}}]),nQ=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){var i=r.getAttribute("text");if(i){var a=i;"capitalize"===n.value?a=i.charAt(0).toUpperCase()+i.slice(1):"lowercase"===n.value?a=i.toLowerCase():"uppercase"===n.value&&(a=i.toUpperCase()),r.parsedStyle.text=a;}return n.value;}}]),nJ=new WeakMap,n0="undefined"!=typeof window&&void 0!==window.document;function n1(t,e){var n=Number(t.parsedStyle.zIndex||0),r=Number(e.parsedStyle.zIndex||0);if(n===r){var i=t.parentNode;if(i){var a=i.childNodes||[];return a.indexOf(t)-a.indexOf(e);}}return n-r;}function n2(t,e){if(n0)return document.defaultView.getComputedStyle(t,null).getPropertyValue(e);}var n3={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},n4="object"==typeof performance&&performance.now?performance:Date;function n5(t){return t.nodeName===j.FRAGMENT||t.getRootNode().nodeName===j.FRAGMENT;}var n6=1,n7="object"==typeof self&&self.self===self?self:"object"==typeof X&&X.global===X?X:{},n9=Date.now(),n8={},rt=Date.now(),re=function(t){if("function"!=typeof t)throw TypeError("".concat(t," is not a function"));var e=Date.now(),n=e-rt,r=n6++;return n8[r]=t,Object.keys(n8).length>1||setTimeout(function(){rt=e;var t=n8;n8={},Object.keys(t).forEach(function(e){return t[e](n7.performance&&"function"==typeof n7.performance.now?n7.performance.now():Date.now()-n9);});},n>16?0:16-n),r;},rn=function(t){return"string"!=typeof t?re:""===t?n7.requestAnimationFrame:n7["".concat(t,"RequestAnimationFrame")];},rr=function(t,e){for(var n=0;void 0!==t[n];){if(e(t[n]))return t[n];n+=1;}}(["","webkit","moz","ms","o"],function(t){return!!rn(t);}),ri=rn(rr),ra="string"!=typeof rr?function(t){delete n8[t];}:""===rr?n7.cancelAnimationFrame:n7["".concat(rr,"CancelAnimationFrame")]||n7["".concat(rr,"CancelRequestAnimationFrame")];n7.requestAnimationFrame=ri,n7.cancelAnimationFrame=ra;var ro=(0,R.default)(function t(){(0,C.default)(this,t),this.callbacks=[];},[{key:"getCallbacksNum",value:function(){return this.callbacks.length;}},{key:"tapPromise",value:function(t,e){this.callbacks.push(e);}},{key:"promise",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return Promise.all(this.callbacks.map(function(t){return t.apply(void 0,e);}));}}]),rs=(0,R.default)(function t(){(0,C.default)(this,t),this.callbacks=[];},[{key:"tapPromise",value:function(t,e){this.callbacks.push(e);}},{key:"promise",value:(m=(0,Y.default)((0,H.default)().mark(function t(){var e,n,r,i,a=arguments;return(0,H.default)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.callbacks.length){t.next=6;break;}return t.next=1,(e=this.callbacks)[0].apply(e,a);case 1:n=t.sent,r=1;case 2:if(!(r<this.callbacks.length)){t.next=5;break;}return i=this.callbacks[r],t.next=3,i(n);case 3:n=t.sent;case 4:r++,t.next=2;break;case 5:return t.abrupt("return",n);case 6:return t.abrupt("return",null);case 7:case"end":return t.stop();}},t,this);})),function(){return m.apply(this,arguments);})}]),rl=(0,R.default)(function t(){(0,C.default)(this,t),this.callbacks=[];},[{key:"tap",value:function(t,e){this.callbacks.push(e);}},{key:"call",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=arguments;this.callbacks.forEach(function(t){t.apply(void 0,r);});}}]),ru=(0,R.default)(function t(){(0,C.default)(this,t),this.callbacks=[];},[{key:"tap",value:function(t,e){this.callbacks.push(e);}},{key:"call",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];if(this.callbacks.length){for(var r=arguments,i=this.callbacks[0].apply(void 0,r),a=1;a<this.callbacks.length;a++)i=(0,this.callbacks[a])(i);return i;}return null;}}]),rc=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],rh=/([\"\'])[^\'\"]+\1/;function rd(t){var e=t.fontSize,n=t.fontFamily,r=t.fontStyle,i=t.fontVariant,a=t.fontWeight;return{fontSize:void 0===e?16:e,fontFamily:void 0===n?"sans-serif":n,fontStyle:void 0===r?"normal":r,fontVariant:void 0===i?"normal":i,fontWeight:void 0===a?"normal":a};}var rf=eo(function(t){for(var e=rd(t),n=e.fontSize,r=e.fontFamily,i=e.fontStyle,a=e.fontVariant,o=e.fontWeight,s=(0,F.isNumber)(n)&&"".concat(n,"px")||"16px",l=r.split(","),u=l.length-1;u>=0;u--){var c=l[u].trim();!rh.test(c)&&0>rc.indexOf(c)&&(c='"'.concat(c,'"')),l[u]=c;}return"".concat(i," ").concat(a," ").concat(o," ").concat(s," ").concat(l.join(","));},function(t){var e=rd(t),n=e.fontSize,r=e.fontFamily,i=e.fontStyle,a=e.fontVariant,o=e.fontWeight;return"".concat(i,"_").concat(a,"_").concat(o,"_").concat(n,"_").concat(r);}),rv=function(t){return Math.max(t,1e-6);};function rp(t,e,n){return G.mat4.identity(t),t[4]=Math.tan(e),t[1]=Math.tan(n),t;}var rg=G.mat4.create(),ry=G.mat4.create(),rm={scale:function(t){G.mat4.fromScaling(rg,[t[0].value,t[1].value,1].map(function(t){return rv(t);}));},scaleX:function(t){G.mat4.fromScaling(rg,[t[0].value,1,1].map(function(t){return rv(t);}));},scaleY:function(t){G.mat4.fromScaling(rg,[1,t[0].value,1].map(function(t){return rv(t);}));},scaleZ:function(t){G.mat4.fromScaling(rg,[1,1,t[0].value].map(function(t){return rv(t);}));},scale3d:function(t){G.mat4.fromScaling(rg,[t[0].value,t[1].value,t[2].value].map(function(t){return rv(t);}));},translate:function(t){G.mat4.fromTranslation(rg,[t[0].value,t[1].value,0]);},translateX:function(t){G.mat4.fromTranslation(rg,[t[0].value,0,0]);},translateY:function(t){G.mat4.fromTranslation(rg,[0,t[0].value,0]);},translateZ:function(t){G.mat4.fromTranslation(rg,[0,0,t[0].value]);},translate3d:function(t){G.mat4.fromTranslation(rg,[t[0].value,t[1].value,t[2].value]);},rotate:function(t){G.mat4.fromZRotation(rg,eJ(t[0])*tf);},rotateX:function(t){G.mat4.fromXRotation(rg,eJ(t[0])*tf);},rotateY:function(t){G.mat4.fromYRotation(rg,eJ(t[0])*tf);},rotateZ:function(t){G.mat4.fromZRotation(rg,eJ(t[0])*tf);},rotate3d:function(t){G.mat4.fromRotation(rg,eJ(t[3])*tf,[t[0].value,t[1].value,t[2].value]);},skew:function(t){rp(rg,t[0].value*tf,t[1].value*tf);},skewX:function(t){rp(rg,t[0].value*tf,0);},skewY:function(t){rp(rg,0,t[0].value*tf);},matrix:function(t){G.mat4.set(rg,t[0].value,t[1].value,0,0,t[2].value,t[3].value,0,0,0,0,1,0,t[4].value,t[5].value,0,1);},matrix3d:function(t){G.mat4.set.apply(G.mat4,[rg].concat((0,O.default)(t.map(function(t){return t.value;}))));}},rk=G.vec3.fromValues(1,1,1),rE=G.vec3.create(),rx={translate:function(t,e){ih.sceneGraphService.setLocalScale(t,rk,!1),ih.sceneGraphService.setLocalEulerAngles(t,rE,void 0,void 0,!1),ih.sceneGraphService.setLocalPosition(t,[e[0].value,e[1].value,0],!1),ih.sceneGraphService.dirtyLocalTransform(t,t.transformable);}},rT=(0,R.default)(function t(){(0,C.default)(this,t),this.parser=nk,this.mixer=nM;},[{key:"calculator",value:function(t,e,n,r){return n instanceof ex?[]:n;}},{key:"postProcessor",value:function(t){!function(t,e){if(t.length){if(1===t.length&&rx[t[0].t]){rx[t[0].t](e,t[0].d);return;}for(var n=G.mat4.identity(ry),r=0;r<t.length;r++){var i=t[r],a=i.t,o=i.d,s=rm[a];s&&(s(o),G.mat4.mul(n,n,rg));}e.setLocalTransform(n);}else e.resetLocalTransform();e.getLocalTransform();}(t.parsedStyle.transform,t);}}]),rN=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"postProcessor",value:function(t){var e=t.parsedStyle.transformOrigin;e[0].unit===es.kPixels&&e[1].unit===es.kPixels?t.setOrigin(e[0].value,e[1].value):t.getGeometryBounds();}}]),rb=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"calculator",value:function(t,e,n,r){return n.value;}},{key:"postProcessor",value:function(t){if(t.parentNode){var e=t.parentNode,n=e.renderable,r=e.sortable;n&&e.dirty(),r&&(r.dirty=!0,r.dirtyReason=tO.Z_INDEX_CHANGED);}}}]),rS=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){var n=t.cx,r=t.cy,i=t.r,a=void 0===i?0:i;return{cx:void 0===n?0:n,cy:void 0===r?0:r,hwidth:a,hheight:a};}}]),rw=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){var n=t.cx,r=t.cy,i=t.rx,a=t.ry;return{cx:void 0===n?0:n,cy:void 0===r?0:r,hwidth:void 0===i?0:i,hheight:void 0===a?0:a};}}]),rP=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t){var e=t.x1,n=t.y1,r=t.x2,i=t.y2,a=Math.min(e,r),o=Math.min(n,i),s=(Math.max(e,r)-a)/2,l=(Math.max(n,i)-o)/2;return{cx:a+s,cy:o+l,hwidth:s,hheight:l};}}]),rM=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t){var e=t.d.rect,n=e.x,r=e.y,i=e.width,a=e.height,o=i/2,s=a/2;return{cx:n+o,cy:r+s,hwidth:o,hheight:s};}}]),rA=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t){if(t.points&&(0,F.isArray)(t.points.points)){var e=t.points.points,n=Math.min.apply(Math,(0,O.default)(e.map(function(t){return t[0];}))),r=Math.max.apply(Math,(0,O.default)(e.map(function(t){return t[0];}))),i=Math.min.apply(Math,(0,O.default)(e.map(function(t){return t[1];}))),a=Math.max.apply(Math,(0,O.default)(e.map(function(t){return t[1];}))),o=(r-n)/2,s=(a-i)/2;return{cx:n+o,cy:i+s,hwidth:o,hheight:s};}return{cx:0,cy:0,hwidth:0,hheight:0};}}]),rC=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){var n=t.x,r=t.y,i=t.src,a=t.width,o=t.height,s=void 0===a?0:a,l=void 0===o?0:o;return!i||(0,F.isString)(i)||(s||(s=i.width,t.width=s),l||(l=i.height,t.height=l)),{cx:(void 0===n?0:n)+s/2,cy:(void 0===r?0:r)+l/2,hwidth:s/2,hheight:l/2};}}]),rR=(0,R.default)(function t(e){(0,C.default)(this,t),this.globalRuntime=e;},[{key:"isReadyToMeasure",value:function(t,e){return t.text;}},{key:"update",value:function(t,e){var n,r=t.text,i=t.textAlign,a=void 0===i?"start":i,o=t.lineWidth,s=void 0===o?1:o,l=t.textBaseline,u=void 0===l?"alphabetic":l,c=t.dx,h=void 0===c?0:c,d=t.dy,f=void 0===d?0:d,v=t.x,p=t.y;if(!this.isReadyToMeasure(t,e))return t.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var g=((null==e||null===(n=e.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n?void 0:n.getConfig())||{}).offscreenCanvas,y=this.globalRuntime.textService.measureText(r,t,g);t.metrics=y;var m=y.width,k=y.height,E=m/2,x=k/2,T=(void 0===v?0:v)+E;"center"===a||"middle"===a?T+=s/2-E:("right"===a||"end"===a)&&(T+=s-2*E);var N=(void 0===p?0:p)-x;return"middle"===u?N+=x:"top"===u||"hanging"===u?N+=2*x:"alphabetic"===u||("bottom"===u||"ideographic"===u)&&(N+=0),h&&(T+=h),f&&(N+=f),{cx:T,cy:N,hwidth:E,hheight:x};}}]),rO=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){return{cx:0,cy:0,hwidth:0,hheight:0};}}]),rL=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"update",value:function(t,e){var n=t.x,r=t.y,i=t.width,a=void 0===i?0:i,o=t.height,s=void 0===o?0:o;return{cx:(void 0===n?0:n)+a/2,cy:(void 0===r?0:r)+s/2,hwidth:a/2,hheight:s/2};}}]),rI=(0,R.default)(function t(e){(0,C.default)(this,t),this.eventPhase=t.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new to,this.page=new to,this.canvas=new to,this.viewport=new to,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e;},[{key:"name",get:function(){return this.type;}},{key:"layerX",get:function(){return this.layer.x;}},{key:"layerY",get:function(){return this.layer.y;}},{key:"pageX",get:function(){return this.page.x;}},{key:"pageY",get:function(){return this.page.y;}},{key:"x",get:function(){return this.canvas.x;}},{key:"y",get:function(){return this.canvas.y;}},{key:"canvasX",get:function(){return this.canvas.x;}},{key:"canvasY",get:function(){return this.canvas.y;}},{key:"viewportX",get:function(){return this.viewport.x;}},{key:"viewportY",get:function(){return this.viewport.y;}},{key:"composedPath",value:function(){return this.manager&&(!this.path||this.path[0]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path;}},{key:"propagationPath",get:function(){return this.composedPath();}},{key:"preventDefault",value:function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0;}},{key:"stopImmediatePropagation",value:function(){this.propagationImmediatelyStopped=!0;}},{key:"stopPropagation",value:function(){this.propagationStopped=!0;}},{key:"initEvent",value:function(){}},{key:"initUIEvent",value:function(){}},{key:"clone",value:function(){throw Error(tl);}}]),rD=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).client=new to,t.movement=new to,t.offset=new to,t.global=new to,t.screen=new to,t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clientX",get:function(){return this.client.x;}},{key:"clientY",get:function(){return this.client.y;}},{key:"movementX",get:function(){return this.movement.x;}},{key:"movementY",get:function(){return this.movement.y;}},{key:"offsetX",get:function(){return this.offset.x;}},{key:"offsetY",get:function(){return this.offset.y;}},{key:"globalX",get:function(){return this.global.x;}},{key:"globalY",get:function(){return this.global.y;}},{key:"screenX",get:function(){return this.screen.x;}},{key:"screenY",get:function(){return this.screen.y;}},{key:"getModifierState",value:function(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t);}},{key:"initMouseEvent",value:function(){throw Error(tl);}}]);}(rI),r_=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).width=0,t.height=0,t.isPrimary=!1,t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getCoalescedEvents",value:function(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[];}},{key:"getPredictedEvents",value:function(){throw Error("getPredictedEvents is not supported!");}},{key:"clone",value:function(){return this.manager.clonePointerEvent(this);}}]);}(rD),rG=function(t){function e(){return(0,C.default)(this,e),(0,L.default)(this,e,arguments);}return(0,I.default)(e,t),(0,R.default)(e,[{key:"clone",value:function(){return this.manager.cloneWheelEvent(this);}}]);}(rD),rF=function(t){function e(t,n){var r;return(0,C.default)(this,e),(r=(0,L.default)(this,e,[null])).type=t,r.detail=null==n?void 0:n.detail,!n||"detail"in n||(r.detail=n),Object.assign(r,n),r;}return(0,I.default)(e,t),(0,R.default)(e);}(rI),rB=(0,R.default)(function t(){(0,C.default)(this,t),this.emitter=new _.default;},[{key:"on",value:function(t,e,n){return this.addEventListener(t,e,n),this;}},{key:"addEventListener",value:function(t,e,n){var r=!1,i=!1;if((0,F.isBoolean)(n))r=n;else if(n){var a=n.capture;r=void 0!==a&&a;var o=n.once;i=void 0!==o&&o;}r&&(t+="capture"),e=(0,F.isFunction)(e)?e:e.handleEvent;var s=(0,F.isFunction)(e)?void 0:e;return i?this.emitter.once(t,e,s):this.emitter.on(t,e,s),this;}},{key:"off",value:function(t,e,n){return t?this.removeEventListener(t,e,n):this.removeAllEventListeners(),this;}},{key:"removeAllEventListeners",value:function(){var t;null===(t=this.emitter)||void 0===t||t.removeAllListeners();}},{key:"removeEventListener",value:function(t,e,n){if(!this.emitter)return this;((0,F.isBoolean)(n)?n:null==n?void 0:n.capture)&&(t+="capture"),e=(0,F.isFunction)(e)?e:null===(r=e)||void 0===r?void 0:r.handleEvent;var r,i=(0,F.isFunction)(e)?void 0:e;return this.emitter.off(t,e,i),this;}},{key:"emit",value:function(t,e){this.dispatchEvent(new rF(t,e));}},{key:"dispatchEventToSelf",value:function(t){t.target||(t.target=this),t.currentTarget=this,this.emitter.emit(t.type,t);}},{key:"dispatchEvent",value:function(t){var e,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0;if(i)return this.dispatchEventToSelf(t),!0;if(e=this.document?this:this.defaultView?this.defaultView:null===(n=this.ownerDocument)||void 0===n?void 0:n.defaultView){if(t.manager=e.getEventService(),!t.manager)return!1;t.defaultPrevented=!1,t.path?t.path.length=0:t.page=[],r||(t.target=this),t.manager.dispatchEvent(t,t.type,r);}else this.dispatchEventToSelf(t);return!t.defaultPrevented;}}]),rU=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).shadow=!1,t.ownerDocument=null,t.isConnected=!1,t.baseURI="",t.childNodes=[],t.nodeType=0,t.nodeName="",t.nodeValue=null,t.mutations=void 0,t.parentNode=null,t.destroyed=!1,t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"textContent",get:function(){var t="";this.nodeName===j.TEXT&&(t+=this.style.text);var e,n=(0,W.default)(this.childNodes);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.nodeName===j.TEXT?t+=r.nodeValue:t+=r.textContent;}}catch(t){n.e(t);}finally{n.f();}return t;},set:function(t){var e=this;this.childNodes.slice().forEach(function(t){e.removeChild(t);}),this.nodeName===j.TEXT&&(this.style.text="".concat(t));}},{key:"getRootNode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.parentNode?this.parentNode.getRootNode(t):t.composed&&this.host?this.host.getRootNode(t):this;}},{key:"hasChildNodes",value:function(){return this.childNodes.length>0;}},{key:"isDefaultNamespace",value:function(t){throw Error(tl);}},{key:"lookupNamespaceURI",value:function(t){throw Error(tl);}},{key:"lookupPrefix",value:function(t){throw Error(tl);}},{key:"normalize",value:function(){throw Error(tl);}},{key:"isEqualNode",value:function(t){return this===t;}},{key:"isSameNode",value:function(t){return this.isEqualNode(t);}},{key:"parent",get:function(){return this.parentNode;}},{key:"parentElement",get:function(){return null;}},{key:"nextSibling",get:function(){return null;}},{key:"previousSibling",get:function(){return null;}},{key:"firstChild",get:function(){return this.childNodes.length>0?this.childNodes[0]:null;}},{key:"lastChild",get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null;}},{key:"compareDocumentPosition",value:function(t){if(t===this)return 0;for(var n,r=t,i=this,a=[r],o=[i];null!==(n=r.parentNode)&&void 0!==n?n:i.parentNode;)r=r.parentNode?(a.push(r.parentNode),r.parentNode):r,i=i.parentNode?(o.push(i.parentNode),i.parentNode):i;if(r!==i)return e.DOCUMENT_POSITION_DISCONNECTED|e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|e.DOCUMENT_POSITION_PRECEDING;var s=a.length>o.length?a:o,l=s===a?o:a;if(s[s.length-l.length]===l[0])return s===a?e.DOCUMENT_POSITION_CONTAINED_BY|e.DOCUMENT_POSITION_FOLLOWING:e.DOCUMENT_POSITION_CONTAINS|e.DOCUMENT_POSITION_PRECEDING;for(var u=s.length-l.length,c=l.length-1;c>=0;c--){var h=l[c],d=s[u+c];if(d!==h){var f=h.parentNode.childNodes;if(f.indexOf(h)<f.indexOf(d)){if(l===a)return e.DOCUMENT_POSITION_PRECEDING;return e.DOCUMENT_POSITION_FOLLOWING;}if(s===a)return e.DOCUMENT_POSITION_PRECEDING;break;}}return e.DOCUMENT_POSITION_FOLLOWING;}},{key:"contain",value:function(t){return this.contains(t);}},{key:"contains",value:function(t){for(var e=t;e&&this!==e;)e=e.parentNode;return!!e;}},{key:"getAncestor",value:function(t){for(var e=this;t>0&&e;)e=e.parentNode,t--;return e;}},{key:"forEach",value:function(t){for(var e=[this];e.length>0;){var n=e.pop();if(!1===t(n))break;for(var r=n.childNodes.length-1;r>=0;r--)e.push(n.childNodes[r]);}}}],[{key:"isNode",value:function(t){return!!t.childNodes;}}]);}(rB);rU.DOCUMENT_POSITION_DISCONNECTED=1,rU.DOCUMENT_POSITION_PRECEDING=2,rU.DOCUMENT_POSITION_FOLLOWING=4,rU.DOCUMENT_POSITION_CONTAINS=8,rU.DOCUMENT_POSITION_CONTAINED_BY=16,rU.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32;var rV=(0,R.default)(function t(e,n){var r=this;(0,C.default)(this,t),this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=G.mat4.create(),this.tmpVec3=G.vec3.create(),this.onPointerDown=function(t){var e=r.createPointerEvent(t);if(r.dispatchEvent(e,"pointerdown"),"touch"===e.pointerType)r.dispatchEvent(e,"touchstart");else if("mouse"===e.pointerType||"pen"===e.pointerType){var n=2===e.button;r.dispatchEvent(e,n?"rightdown":"mousedown");}r.trackingData(t.pointerId).pressTargetsByButton[t.button]=e.composedPath(),r.freeEvent(e);},this.onPointerUp=function(t){var e=n4.now(),n=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);if(r.dispatchEvent(n,"pointerup"),"touch"===n.pointerType)r.dispatchEvent(n,"touchend");else if("mouse"===n.pointerType||"pen"===n.pointerType){var i=2===n.button;r.dispatchEvent(n,i?"rightup":"mouseup");}var a=r.trackingData(t.pointerId),o=r.findMountedTarget(a.pressTargetsByButton[t.button]),s=o;if(o&&!n.composedPath().includes(o)){for(var l=o;l&&!n.composedPath().includes(l);){if(n.currentTarget=l,r.notifyTarget(n,"pointerupoutside"),"touch"===n.pointerType)r.notifyTarget(n,"touchendoutside");else if("mouse"===n.pointerType||"pen"===n.pointerType){var u=2===n.button;r.notifyTarget(n,u?"rightupoutside":"mouseupoutside");}rU.isNode(l)&&(l=l.parentNode);}delete a.pressTargetsByButton[t.button],s=l;}if(s){var c,h=r.clonePointerEvent(n,"click");h.target=s,h.path=[],a.clicksByButton[t.button]||(a.clicksByButton[t.button]={clickCount:0,target:h.target,timeStamp:e});var d=r.context.renderingContext.root.ownerDocument.defaultView,f=a.clicksByButton[t.button];f.target===h.target&&e-f.timeStamp<d.getConfig().dblClickSpeed?++f.clickCount:f.clickCount=1,f.target=h.target,f.timeStamp=e,h.detail=f.clickCount,null!==(c=n.detail)&&void 0!==c&&c.preventClick||(r.context.config.useNativeClickEvent||"mouse"!==h.pointerType&&"touch"!==h.pointerType||r.dispatchEvent(h,"click"),r.dispatchEvent(h,"pointertap")),r.freeEvent(h);}r.freeEvent(n);},this.onPointerMove=function(t){var e=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0),n="mouse"===e.pointerType||"pen"===e.pointerType,i=r.trackingData(t.pointerId),a=r.findMountedTarget(i.overTargets);if(i.overTargets&&a!==e.target){var o="mousemove"===t.type?"mouseout":"pointerout",s=r.createPointerEvent(t,o,a||void 0);if(r.dispatchEvent(s,"pointerout"),n&&r.dispatchEvent(s,"mouseout"),!e.composedPath().includes(a)){var l=r.createPointerEvent(t,"pointerleave",a||void 0);for(l.eventPhase=l.AT_TARGET;l.target&&!e.composedPath().includes(l.target);)l.currentTarget=l.target,r.notifyTarget(l),n&&r.notifyTarget(l,"mouseleave"),rU.isNode(l.target)&&(l.target=l.target.parentNode);r.freeEvent(l);}r.freeEvent(s);}if(a!==e.target){var u="mousemove"===t.type?"mouseover":"pointerover",c=r.clonePointerEvent(e,u);r.dispatchEvent(c,"pointerover"),n&&r.dispatchEvent(c,"mouseover");for(var h=a&&rU.isNode(a)&&a.parentNode;h&&h!==(rU.isNode(r.rootTarget)&&r.rootTarget.parentNode)&&h!==e.target;)h=h.parentNode;if(!h||h===(rU.isNode(r.rootTarget)&&r.rootTarget.parentNode)){var d=r.clonePointerEvent(e,"pointerenter");for(d.eventPhase=d.AT_TARGET;d.target&&d.target!==a&&d.target!==(rU.isNode(r.rootTarget)&&r.rootTarget.parentNode);)d.currentTarget=d.target,r.notifyTarget(d),n&&r.notifyTarget(d,"mouseenter"),rU.isNode(d.target)&&(d.target=d.target.parentNode);r.freeEvent(d);}r.freeEvent(c);}r.dispatchEvent(e,"pointermove"),"touch"===e.pointerType&&r.dispatchEvent(e,"touchmove"),n&&(r.dispatchEvent(e,"mousemove"),r.cursor=r.getCursor(e.target)),i.overTargets=e.composedPath(),r.freeEvent(e);},this.onPointerOut=function(t){var e=r.trackingData(t.pointerId);if(e.overTargets){var n="mouse"===t.pointerType||"pen"===t.pointerType,i=r.findMountedTarget(e.overTargets),a=r.createPointerEvent(t,"pointerout",i||void 0);r.dispatchEvent(a),n&&r.dispatchEvent(a,"mouseout");var o=r.createPointerEvent(t,"pointerleave",i||void 0);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==(rU.isNode(r.rootTarget)&&r.rootTarget.parentNode);)o.currentTarget=o.target,r.notifyTarget(o),n&&r.notifyTarget(o,"mouseleave"),rU.isNode(o.target)&&(o.target=o.target.parentNode);e.overTargets=null,r.freeEvent(a),r.freeEvent(o);}r.cursor=null;},this.onPointerOver=function(t){var e=r.trackingData(t.pointerId),n=r.createPointerEvent(t),i="mouse"===n.pointerType||"pen"===n.pointerType;r.dispatchEvent(n,"pointerover"),i&&r.dispatchEvent(n,"mouseover"),"mouse"===n.pointerType&&(r.cursor=r.getCursor(n.target));var a=r.clonePointerEvent(n,"pointerenter");for(a.eventPhase=a.AT_TARGET;a.target&&a.target!==(rU.isNode(r.rootTarget)&&r.rootTarget.parentNode);)a.currentTarget=a.target,r.notifyTarget(a),i&&r.notifyTarget(a,"mouseenter"),rU.isNode(a.target)&&(a.target=a.target.parentNode);e.overTargets=n.composedPath(),r.freeEvent(n),r.freeEvent(a);},this.onPointerUpOutside=function(t){var e=r.trackingData(t.pointerId),n=r.findMountedTarget(e.pressTargetsByButton[t.button]),i=r.createPointerEvent(t);if(n){for(var a=n;a;)i.currentTarget=a,r.notifyTarget(i,"pointerupoutside"),"touch"===i.pointerType||("mouse"===i.pointerType||"pen"===i.pointerType)&&r.notifyTarget(i,2===i.button?"rightupoutside":"mouseupoutside"),rU.isNode(a)&&(a=a.parentNode);delete e.pressTargetsByButton[t.button];}r.freeEvent(i);},this.onWheel=function(t){var e=r.createWheelEvent(t);r.dispatchEvent(e),r.freeEvent(e);},this.onClick=function(t){if(r.context.config.useNativeClickEvent){var e=r.createPointerEvent(t);r.dispatchEvent(e),r.freeEvent(e);}},this.onPointerCancel=function(t){var e=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);r.dispatchEvent(e),r.freeEvent(e);},this.globalRuntime=e,this.context=n;},[{key:"init",value:function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick);}},{key:"destroy",value:function(){this.mappingTable={},this.mappingState={},this.eventPool.clear();}},{key:"getScale",value:function(){var t=this.context.contextService.getBoundingClientRect(),e=1,n=1,r=this.context.contextService.getDomElement();if(r&&t){var i=r.offsetWidth,a=r.offsetHeight;i&&a&&(e=t.width/i,n=t.height/a);}return{scaleX:e,scaleY:n,bbox:t};}},{key:"client2Viewport",value:function(t){var e=this.getScale(),n=e.scaleX,r=e.scaleY,i=e.bbox;return new to((t.x-((null==i?void 0:i.left)||0))/n,(t.y-((null==i?void 0:i.top)||0))/r);}},{key:"viewport2Client",value:function(t){var e=this.getScale(),n=e.scaleX,r=e.scaleY,i=e.bbox;return new to((t.x+((null==i?void 0:i.left)||0))*n,(t.y+((null==i?void 0:i.top)||0))*r);}},{key:"viewport2Canvas",value:function(t){var e=t.x,n=t.y,r=this.rootTarget.defaultView.getCamera(),i=this.context.config,a=i.width,o=i.height,s=r.getPerspectiveInverse(),l=r.getWorldTransform(),u=G.mat4.multiply(this.tmpMatrix,l,s),c=G.vec3.set(this.tmpVec3,e/a*2-1,(1-n/o)*2-1,0);return G.vec3.transformMat4(c,c,u),new to(c[0],c[1]);}},{key:"canvas2Viewport",value:function(t){var e=this.rootTarget.defaultView.getCamera(),n=e.getPerspective(),r=e.getViewTransform(),i=G.mat4.multiply(this.tmpMatrix,n,r),a=G.vec3.set(this.tmpVec3,t.x,t.y,0);G.vec3.transformMat4(this.tmpVec3,this.tmpVec3,i);var o=this.context.config,s=o.width,l=o.height;return new to((a[0]+1)/2*s,(1-(a[1]+1)/2)*l);}},{key:"setPickHandler",value:function(t){this.pickHandler=t;}},{key:"addEventMapping",value:function(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort(function(t,e){return t.priority-e.priority;});}},{key:"mapEvent",value:function(t){if(this.rootTarget){var e=this.mappingTable[t.type];if(e)for(var n=0,r=e.length;n<r;n++)e[n].fn(t);else console.warn("[EventService]: Event mapping not defined for ".concat(t.type));}}},{key:"dispatchEvent",value:function(t,e,n){if(n){t.eventPhase=t.AT_TARGET;var r=this.rootTarget.defaultView||null;t.currentTarget=r,this.notifyListeners(t,e);}else t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e);}},{key:"propagate",value:function(t,e){if(t.target){var n=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(var r=n.length-1;r>=1;r--)if(t.currentTarget=n[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!t.propagationStopped&&!t.propagationImmediatelyStopped){var i=n.indexOf(t.currentTarget);t.eventPhase=t.BUBBLING_PHASE;for(var a=i+1;a<n.length;a++)if(t.currentTarget=n[a],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;}}}},{key:"propagationPath",value:function(t){var e=[t],n=this.rootTarget.defaultView||null;if(n&&n===t)return e.unshift(n.document),e;for(var r=0;r<2048&&t!==this.rootTarget;r++)rU.isNode(t)&&t.parentNode&&(e.push(t.parentNode),t=t.parentNode);return n&&e.push(n),e;}},{key:"hitTest",value:function(t){var e=t.viewportX,n=t.viewportY,r=this.context.config,i=r.width,a=r.height,o=r.disableHitTesting;return e<0||n<0||e>i||n>a?null:!o&&this.pickHandler(t)||this.rootTarget||null;}},{key:"isNativeEventFromCanvas",value:function(t,e){var n,r=null==e?void 0:e.target;if(null!==(n=r)&&void 0!==n&&n.shadowRoot&&(r=e.composedPath()[0]),r){if(r===t)return!0;if(t&&t.contains)return t.contains(r);}return null!=e&&!!e.composedPath&&e.composedPath().indexOf(t)>-1;}},{key:"getExistedHTML",value:function(t){if(t.nativeEvent.composedPath)for(var e=0,n=t.nativeEvent.composedPath();e<n.length;e++){var r=n[e],i=this.nativeHTMLMap.get(r);if(i)return i;}return null;}},{key:"pickTarget",value:function(t){return this.hitTest({clientX:t.clientX,clientY:t.clientY,viewportX:t.viewportX,viewportY:t.viewportY,x:t.canvasX,y:t.canvasY});}},{key:"createPointerEvent",value:function(t,e,n,r){var i=this.allocateEvent(r_);this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.nativeEvent=t.nativeEvent,i.originalEvent=t;var a=this.getExistedHTML(i),o=this.context.contextService.getDomElement();return i.target=null!=n?n:a||this.isNativeEventFromCanvas(o,i.nativeEvent)&&this.pickTarget(i)||r,"string"==typeof e&&(i.type=e),i;}},{key:"createWheelEvent",value:function(t){var e=this.allocateEvent(rG);this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t;var n=this.getExistedHTML(e),r=this.context.contextService.getDomElement();return e.target=n||this.isNativeEventFromCanvas(r,e.nativeEvent)&&this.pickTarget(e),e;}},{key:"trackingData",value:function(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t];}},{key:"cloneWheelEvent",value:function(t){var e=this.allocateEvent(rG);return e.nativeEvent=t.nativeEvent,e.originalEvent=t.originalEvent,this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.target=t.target,e.path=t.composedPath().slice(),e.type=t.type,e;}},{key:"clonePointerEvent",value:function(t,e){var n=this.allocateEvent(r_);return n.nativeEvent=t.nativeEvent,n.originalEvent=t.originalEvent,this.copyPointerData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.target=t.target,n.path=t.composedPath().slice(),n.type=null!=e?e:n.type,n;}},{key:"copyPointerData",value:function(t,e){e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist;}},{key:"copyMouseData",value:function(t,e){e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey,e.client.copyFrom(t.client),e.movement.copyFrom(t.movement),e.canvas.copyFrom(t.canvas),e.screen.copyFrom(t.screen),e.global.copyFrom(t.global),e.offset.copyFrom(t.offset);}},{key:"copyWheelData",value:function(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;}},{key:"copyData",value:function(t,e){e.isTrusted=t.isTrusted,e.timeStamp=n4.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.page.copyFrom(t.page),e.viewport.copyFrom(t.viewport);}},{key:"allocateEvent",value:function(t){this.eventPool.has(t)||this.eventPool.set(t,[]);var e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=[],e.target=null,e;}},{key:"freeEvent",value:function(t){if(t.manager!==this)throw Error("It is illegal to free an event not managed by this EventBoundary!");var e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t);}},{key:"notifyTarget",value:function(t,e){e=null!=e?e:t.type;var n=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?"".concat(e,"capture"):e;this.notifyListeners(t,n),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e);}},{key:"notifyListeners",value:function(t,e){var n=t.currentTarget.emitter,r=n._events[e];if(r){if("fn"in r)r.once&&n.removeListener(e,r.fn,void 0,!0),r.fn.call(t.currentTarget||r.context,t);else for(var i=0;i<r.length&&!t.propagationImmediatelyStopped;i++)r[i].once&&n.removeListener(e,r[i].fn,void 0,!0),r[i].fn.call(t.currentTarget||r[i].context,t);}}},{key:"findMountedTarget",value:function(t){if(!t)return null;for(var e=t[t.length-1],n=t.length-2;n>=0;n--){var r=t[n];if(r===this.rootTarget||rU.isNode(r)&&r.parentNode===e)e=t[n];else break;}return e;}},{key:"getCursor",value:function(t){for(var e=t;e;){var n=!!e.getAttribute&&e.getAttribute("cursor");if(n)return n;e=rU.isNode(e)&&e.parentNode;}}}]),rz=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"getOrCreateCanvas",value:function(t,e){if(this.canvas)return this.canvas;if(t||ih.offscreenCanvas)this.canvas=t||ih.offscreenCanvas,this.context=this.canvas.getContext("2d",(0,A.default)({willReadFrequently:!0},e));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",(0,A.default)({willReadFrequently:!0},e)),this.context&&this.context.measureText||(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"));}catch(t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",(0,A.default)({willReadFrequently:!0},e));}return this.canvas.width=10,this.canvas.height=10,this.canvas;}},{key:"getOrCreateContext",value:function(t,e){return this.context||this.getOrCreateCanvas(t,e),this.context;}}],[{key:"createCanvas",value:function(){try{return new window.OffscreenCanvas(0,0);}catch(t){}try{return document.createElement("canvas");}catch(t){}return null;}}]),rH=((k={})[k.CAMERA_CHANGED=0]="CAMERA_CHANGED",k[k.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",k[k.NONE=2]="NONE",k),rY=(0,R.default)(function t(e,n){(0,C.default)(this,t),this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new rl,initAsync:new ro,dirtycheck:new ru,cull:new ru,beginFrame:new rl,beforeRender:new rl,render:new rl,afterRender:new rl,endFrame:new rl,destroy:new rl,pick:new rs,pickSync:new ru,pointerDown:new rl,pointerUp:new rl,pointerMove:new rl,pointerOut:new rl,pointerOver:new rl,pointerWheel:new rl,pointerCancel:new rl,click:new rl},this.globalRuntime=e,this.context=n;},[{key:"init",value:function(t){var e=this,n=(0,A.default)((0,A.default)({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach(function(t){t.apply(n,e.globalRuntime);}),this.hooks.init.call(),0===this.hooks.initAsync.getCallbacksNum()?(this.inited=!0,t()):this.hooks.initAsync.promise().then(function(){e.inited=!0,t();}).catch(function(t){});}},{key:"getStats",value:function(){return this.stats;}},{key:"disableDirtyRectangleRendering",value:function(){return!this.context.config.renderer.getConfig().enableDirtyRectangleRendering||this.context.renderingContext.renderReasons.has(rH.CAMERA_CHANGED);}},{key:"render",value:function(t,e,n){var r=this,i=t.getConfig(),a=this.context.renderingContext;if(this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0,this.globalRuntime.sceneGraphService.syncHierarchy(a.root),this.globalRuntime.sceneGraphService.notifyMutationObservers(t),a.renderReasons.size&&this.inited){a.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var o=1===a.renderReasons.size&&a.renderReasons.has(rH.CAMERA_CHANGED),s=!i.disableRenderHooks||!o;s&&this.renderDisplayObject(a.root,i,a),this.hooks.beginFrame.call(e),s&&a.renderListCurrentFrame.forEach(function(t){r.hooks.beforeRender.call(t),r.hooks.render.call(t),r.hooks.afterRender.call(t);}),this.hooks.endFrame.call(e),a.renderListCurrentFrame=[],a.renderReasons.clear(),n();}}},{key:"renderDisplayObject",value:function(t,e,n){for(var r=this,i=e.renderer.getConfig(),a=i.enableDirtyCheck,o=i.enableCulling,s=[t];s.length>0;){var l,u=s.pop();!function(t){var e=t.renderable,i=t.sortable,s=a?e.dirty||n.dirtyRectangleRenderingDisabled?t:null:t,l=null;s&&(l=o?r.hooks.cull.call(s,r.context.camera):s)&&(r.stats.rendered+=1,n.renderListCurrentFrame.push(l)),t.dirty(!1),i.renderOrder=r.zIndexCounter,r.zIndexCounter+=1,r.stats.total+=1,i.dirty&&(r.sort(t,i),i.dirty=!1,i.dirtyChildren=[],i.dirtyReason=void 0);}(u);for(var c=(null===(l=u.sortable)||void 0===l||null===(l=l.sorted)||void 0===l?void 0:l.length)>0?u.sortable.sorted:u.childNodes,h=c.length-1;h>=0;h--)s.push(c[h]);}}},{key:"sort",value:function(t,e){var n,r;(null==e||null===(n=e.sorted)||void 0===n?void 0:n.length)>0&&e.dirtyReason!==tO.Z_INDEX_CHANGED?e.dirtyChildren.forEach(function(n){var r=e.sorted.indexOf(n);if(r>-1&&e.sorted.splice(r,1),t.childNodes.indexOf(n)>-1){if(0===e.sorted.length)e.sorted.push(n);else{var i=function(t,e){for(var n=0,r=t.length;n<r;){var i=n+r>>>1;0>n1(t[i],e)?n=i+1:r=i;}return n;}(e.sorted,n);e.sorted.splice(i,0,n);}}}):e.sorted=t.childNodes.slice().sort(n1),(null===(r=e.sorted)||void 0===r?void 0:r.length)>0&&0===t.childNodes.filter(function(t){return t.parsedStyle.zIndex;}).length&&(e.sorted=[]);}},{key:"destroy",value:function(){this.inited=!1,this.hooks.destroy.call();}},{key:"dirty",value:function(){this.context.renderingContext.renderReasons.add(rH.DISPLAY_OBJECT_CHANGED);}}]),rW=/\[\s*(.*)=(.*)\s*\]/,rq=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"selectOne",value:function(t,e){var n=this;if(t.startsWith("."))return e.find(function(e){return((null==e?void 0:e.classList)||[]).indexOf(n.getIdOrClassname(t))>-1;});if(t.startsWith("#"))return e.find(function(e){return e.id===n.getIdOrClassname(t);});if(t.startsWith("[")){var r=this.getAttribute(t),i=r.name,a=r.value;return i?e.find(function(t){return e!==t&&("name"===i?t.name===a:n.attributeToString(t,i)===a);}):null;}return e.find(function(n){return e!==n&&n.nodeName===t;});}},{key:"selectAll",value:function(t,e){var n=this;if(t.startsWith("."))return e.findAll(function(r){return e!==r&&((null==r?void 0:r.classList)||[]).indexOf(n.getIdOrClassname(t))>-1;});if(t.startsWith("#"))return e.findAll(function(r){return e!==r&&r.id===n.getIdOrClassname(t);});if(t.startsWith("[")){var r=this.getAttribute(t),i=r.name,a=r.value;return i?e.findAll(function(t){return e!==t&&("name"===i?t.name===a:n.attributeToString(t,i)===a);}):[];}return e.findAll(function(n){return e!==n&&n.nodeName===t;});}},{key:"is",value:function(t,e){if(t.startsWith("."))return e.className===this.getIdOrClassname(t);if(t.startsWith("#"))return e.id===this.getIdOrClassname(t);if(t.startsWith("[")){var n=this.getAttribute(t),r=n.name,i=n.value;return"name"===r?e.name===i:this.attributeToString(e,r)===i;}return e.nodeName===t;}},{key:"getIdOrClassname",value:function(t){return t.substring(1);}},{key:"getAttribute",value:function(t){var e=t.match(rW),n="",r="";return e&&e.length>2&&(n=e[1].replace(/"/g,""),r=e[2].replace(/"/g,"")),{name:n,value:r};}},{key:"attributeToString",value:function(t,e){if(!t.getAttribute)return"";var n=t.getAttribute(e);return(0,F.isNil)(n)?"":n.toString?n.toString():"";}}]),rX=((E={}).ATTR_MODIFIED="DOMAttrModified",E.INSERTED="DOMNodeInserted",E.MOUNTED="DOMNodeInsertedIntoDocument",E.REMOVED="removed",E.UNMOUNTED="DOMNodeRemovedFromDocument",E.REPARENT="reparent",E.DESTROY="destroy",E.BOUNDS_CHANGED="bounds-changed",E.CULLED="culled",E),rj=function(t){function e(t,n,r,i,a,o,s,l){var u;return(0,C.default)(this,e),(u=(0,L.default)(this,e,[null])).relatedNode=n,u.prevValue=r,u.newValue=i,u.attrName=a,u.attrChange=o,u.prevParsedValue=s,u.newParsedValue=l,u.type=t,u;}return(0,I.default)(e,t),(0,R.default)(e);}(rI);rj.ADDITION=2,rj.MODIFICATION=1,rj.REMOVAL=3;var r$=new rj(rX.REPARENT,null,"","","",0,"",""),rK=G.vec2.create(),rZ=G.vec3.create(),rQ=G.vec3.fromValues(1,1,1),rJ=G.mat4.create(),r0=G.vec2.create(),r1=G.vec3.create(),r2=G.mat4.create(),r3=G.quat.create(),r4=G.vec3.create(),r5=G.quat.create(),r6=G.vec3.create(),r7=G.vec3.create(),r9=G.vec3.create(),r8=G.mat4.create(),it=G.quat.create(),ie=G.quat.create(),ir=G.quat.create(),ii=(0,R.default)(function t(e){(0,C.default)(this,t),this.displayObjectDependencyMap=new WeakMap,this.runtime=e;},[{key:"matches",value:function(t,e){return this.runtime.sceneGraphSelector.is(t,e);}},{key:"querySelector",value:function(t,e){return this.runtime.sceneGraphSelector.selectOne(t,e);}},{key:"querySelectorAll",value:function(t,e){return this.runtime.sceneGraphSelector.selectAll(t,e);}},{key:"attach",value:function(t,e,n){var r=!1;t.parentNode&&(r=t.parentNode!==e,this.detach(t));var i=t.nodeName===j.FRAGMENT,a=n5(e);t.parentNode=e;var o=i?t.childNodes:[t];(0,F.isNumber)(n)?o.forEach(function(t){e.childNodes.splice(n,0,t),t.parentNode=e;}):o.forEach(function(t){e.childNodes.push(t),t.parentNode=e;});var s=e.sortable;if((null!=s&&null!==(u=s.sorted)&&void 0!==u&&u.length||s.dirty||t.parsedStyle.zIndex)&&(-1===s.dirtyChildren.indexOf(t)&&s.dirtyChildren.push(t),s.dirty=!0,s.dirtyReason=tO.ADDED),!a){if(i)this.dirtyFragment(t);else{var l=t.transformable;l&&this.dirtyWorldTransform(t,l);}if(r){var u,c,h=(null===(c=e.ownerDocument)||void 0===c||null===(c=c.defaultView)||void 0===c||null===(c=c.getConfig())||void 0===c||null===(c=c.future)||void 0===c?void 0:c.experimentalCancelEventPropagation)===!0;t.dispatchEvent(r$,h,h);}}}},{key:"detach",value:function(t){if(t.parentNode){var e,n,r=t.transformable,i=t.parentNode.sortable;(null!=i&&null!==(e=i.sorted)&&void 0!==e&&e.length||null!==(n=t.style)&&void 0!==n&&n.zIndex)&&(-1===i.dirtyChildren.indexOf(t)&&i.dirtyChildren.push(t),i.dirty=!0,i.dirtyReason=tO.REMOVED);var a=t.parentNode.childNodes.indexOf(t);a>-1&&t.parentNode.childNodes.splice(a,1),r&&this.dirtyWorldTransform(t,r),t.parentNode=null;}}},{key:"getLocalPosition",value:function(t){return t.transformable.localPosition;}},{key:"getLocalRotation",value:function(t){return t.transformable.localRotation;}},{key:"getLocalScale",value:function(t){return t.transformable.localScale;}},{key:"getLocalSkew",value:function(t){return t.transformable.localSkew;}},{key:"getLocalTransform",value:function(t){var e=t.transformable;return t_(e),e.localTransform;}},{key:"setLocalPosition",value:function(t,e){var n,r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=t.transformable;r7[0]=e[0],r7[1]=e[1],r7[2]=null!==(n=e[2])&&void 0!==n?n:0,!G.vec3.equals(i.localPosition,r7)&&(G.vec3.copy(i.localPosition,r7),r&&this.dirtyLocalTransform(t,i));}},{key:"translateLocal",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var i=t.transformable;G.vec3.equals(e,rZ)||(G.vec3.transformQuat(e,e,i.localRotation),G.vec3.add(i.localPosition,i.localPosition,e),this.dirtyLocalTransform(t,i));}},{key:"setLocalRotation",value:function(t,e,n,r,i){var a=!(arguments.length>5)||void 0===arguments[5]||arguments[5];"number"==typeof e&&(e=G.quat.set(r3,e,n,r,i));var o=t.transformable;G.quat.copy(o.localRotation,e),a&&this.dirtyLocalTransform(t,o);}},{key:"rotateLocal",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var i=t.transformable;G.quat.fromEuler(ie,e[0],e[1],e[2]),G.quat.mul(i.localRotation,i.localRotation,ie),this.dirtyLocalTransform(t,i);}},{key:"setLocalScale",value:function(t,e){var n,r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=t.transformable;G.vec3.set(r1,e[0],e[1],null!==(n=e[2])&&void 0!==n?n:i.localScale[2]),!G.vec3.equals(r1,i.localScale)&&(G.vec3.copy(i.localScale,r1),r&&this.dirtyLocalTransform(t,i));}},{key:"scaleLocal",value:function(t,e){var n,r=t.transformable;G.vec3.multiply(r.localScale,r.localScale,G.vec3.set(r1,e[0],e[1],null!==(n=e[2])&&void 0!==n?n:1)),this.dirtyLocalTransform(t,r);}},{key:"setLocalSkew",value:function(t,e,n){var r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];"number"==typeof e&&(e=G.vec2.set(r0,e,n));var i=t.transformable;G.vec2.copy(i.localSkew,e),r&&this.dirtyLocalTransform(t,i);}},{key:"setLocalEulerAngles",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=!(arguments.length>4)||void 0===arguments[4]||arguments[4];"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var a=t.transformable;G.quat.fromEuler(a.localRotation,e[0],e[1],e[2]),i&&this.dirtyLocalTransform(t,a);}},{key:"setLocalTransform",value:function(t,e){var n=G.mat4.getTranslation(r4,e),r=G.mat4.getRotation(r5,e),i=G.mat4.getScaling(r6,e);this.setLocalScale(t,i,!1),this.setLocalPosition(t,n,!1),this.setLocalRotation(t,r,void 0,void 0,void 0,!1),this.dirtyLocalTransform(t,t.transformable);}},{key:"resetLocalTransform",value:function(t){this.setLocalScale(t,rQ,!1),this.setLocalPosition(t,rZ,!1),this.setLocalEulerAngles(t,rZ,void 0,void 0,!1),this.setLocalSkew(t,rK,void 0,!1),this.dirtyLocalTransform(t,t.transformable);}},{key:"getPosition",value:function(t){var e=t.transformable;return G.mat4.getTranslation(e.position,this.getWorldTransform(t,e));}},{key:"getRotation",value:function(t){var e=t.transformable;return G.mat4.getRotation(e.rotation,this.getWorldTransform(t,e));}},{key:"getScale",value:function(t){var e=t.transformable;return G.mat4.getScaling(e.scaling,this.getWorldTransform(t,e));}},{key:"getOrigin",value:function(t){return t.getGeometryBounds(),t.transformable.origin;}},{key:"getWorldTransform",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.transformable;return(e.localDirtyFlag||e.dirtyFlag)&&(t.parentNode&&t.parentNode.transformable&&this.getWorldTransform(t.parentNode),this.internalUpdateTransform(t)),e.worldTransform;}},{key:"setPosition",value:function(t,e){var n,r=t.transformable;if(r9[0]=e[0],r9[1]=e[1],r9[2]=null!==(n=e[2])&&void 0!==n?n:0,!G.vec3.equals(this.getPosition(t),r9)){if(G.vec3.copy(r.position,r9),null!==t.parentNode&&t.parentNode.transformable){var i=t.parentNode.transformable;G.mat4.copy(r8,i.worldTransform),G.mat4.invert(r8,r8),G.vec3.transformMat4(r.localPosition,r9,r8);}else G.vec3.copy(r.localPosition,r9);this.dirtyLocalTransform(t,r);}}},{key:"translate",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.set(r1,e,n,r)),G.vec3.equals(e,rZ)||(G.vec3.add(r1,this.getPosition(t),e),this.setPosition(t,r1));}},{key:"setRotation",value:function(t,e,n,r,i){var a=t.transformable;if("number"==typeof e&&(e=G.quat.fromValues(e,n,r,i)),null!==t.parentNode&&t.parentNode.transformable){var o=this.getRotation(t.parentNode);G.quat.copy(r3,o),G.quat.invert(r3,r3),G.quat.multiply(a.localRotation,r3,e),G.quat.normalize(a.localRotation,a.localRotation),this.dirtyLocalTransform(t,a);}else this.setLocalRotation(t,e);}},{key:"rotate",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var i=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){G.quat.fromEuler(r3,e[0],e[1],e[2]);var a=this.getRotation(t),o=this.getRotation(t.parentNode);G.quat.copy(ir,o),G.quat.invert(ir,ir),G.quat.multiply(r3,ir,r3),G.quat.multiply(i.localRotation,r3,a),G.quat.normalize(i.localRotation,i.localRotation),this.dirtyLocalTransform(t,i);}else this.rotateLocal(t,e);}},{key:"setOrigin",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=[e,n,r]);var i=t.transformable;if(e[0]!==i.origin[0]||e[1]!==i.origin[1]||e[2]!==i.origin[2]){var a=i.origin;a[0]=e[0],a[1]=e[1],a[2]=e[2]||0,this.dirtyLocalTransform(t,i);}}},{key:"setEulerAngles",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;"number"==typeof e&&(e=G.vec3.fromValues(e,n,r));var i=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){G.quat.fromEuler(i.localRotation,e[0],e[1],e[2]);var a=this.getRotation(t.parentNode);G.quat.copy(it,G.quat.invert(r3,a)),G.quat.mul(i.localRotation,i.localRotation,it),this.dirtyLocalTransform(t,i);}else this.setLocalEulerAngles(t,e);}},{key:"getGeometryBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.geometry;return n.dirty&&ih.styleValueRegistry.updateGeometry(t),(e?n.renderBounds:n.contentBounds||null)||new tn;}},{key:"getTransformedGeometryBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this.getGeometryBounds(t,e);if(!tn.isEmpty(r)){var i=n||new tn;return i.setFromTransformedAABB(r,this.getWorldTransform(t)),i;}return null;}},{key:"getBounds",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t.renderable;if(!r.boundsDirty&&!n&&r.bounds)return r.bounds;if(!r.renderBoundsDirty&&n&&r.renderBounds)return r.renderBounds;var i=n?r.renderBounds:r.bounds,a=this.getTransformedGeometryBounds(t,n,i);if(t.childNodes.forEach(function(t){var r=e.getBounds(t,n);r&&(a?a.add(r):(a=i||new tn).update(r.center,r.halfExtents));}),a||(a=new tn),n){var o=function(t){var e,n=t;do{if(null===(e=n.parsedStyle)||void 0===e?void 0:e.clipPath)return n;n=n.parentElement;}while(null!==n)return null;}(t);if(o){var s=o.parsedStyle.clipPath.getBounds(n);a?s&&(a=s.intersection(a)):a.update(s.center,s.halfExtents);}}return n?(r.renderBounds=a,r.renderBoundsDirty=!1):(r.bounds=a,r.boundsDirty=!1),a;}},{key:"getLocalBounds",value:function(t){if(t.parentNode){var e=rJ;t.parentNode.transformable&&(e=G.mat4.invert(r2,this.getWorldTransform(t.parentNode)));var n=this.getBounds(t);if(!tn.isEmpty(n)){var r=new tn;return r.setFromTransformedAABB(n,e),r;}}return this.getBounds(t);}},{key:"getBoundingClientRect",value:function(t){var e,n,r=this.getGeometryBounds(t);tn.isEmpty(r)||(n=new tn).setFromTransformedAABB(r,this.getWorldTransform(t));var i=null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e?void 0:e.getContextService().getBoundingClientRect();if(n){var a=n.getMin(),o=(0,D.default)(a,2),s=o[0],l=o[1],u=n.getMax(),c=(0,D.default)(u,2),h=c[0],d=c[1];return new ts(s+((null==i?void 0:i.left)||0),l+((null==i?void 0:i.top)||0),h-s,d-l);}return new ts((null==i?void 0:i.left)||0,(null==i?void 0:i.top)||0,0,0);}},{key:"internalUpdateTransform",value:function(t){var e,n,r=null===(n=t.parentNode)||void 0===n?void 0:n.transformable;t_(t.transformable),(e=t.transformable).dirtyFlag&&(r?G.mat4.multiply(e.worldTransform,r.worldTransform,e.localTransform):G.mat4.copy(e.worldTransform,e.localTransform),e.dirtyFlag=!1);}},{key:"internalUpdateElement",value:function(t,e){var n=(null===(s=t.ownerDocument)||void 0===s||null===(s=s.defaultView)||void 0===s||null===(s=s.getConfig())||void 0===s||null===(s=s.future)||void 0===s?void 0:s.experimentalAttributeUpdateOptimization)===!0,r=e[e.length-1],i=(null==r?void 0:r.transformDirty)||(null===(l=t.transformable)||void 0===l?void 0:l.localDirtyFlag);t.transformable&&((h=t.transformable).dirtyFlag||(h.dirtyFlag=i)),this.internalUpdateTransform(t),i&&(null===(d=t.dirty)||void 0===d||d.call(t,!0,!0));var a=(null===(u=t.renderable)||void 0===u?void 0:u.boundsDirty)||(null===(c=t.renderable)||void 0===c?void 0:c.renderBoundsDirty);if((i||a)&&(null==r?void 0:r.shapeUpdated)===!1&&n)for(var o=e.length-1;o>=0;){var s,l,u,c,h,d,f,v,p=e[o];if(p.shapeUpdated)break;null===(f=(v=p.node).dirty)||void 0===f||f.call(v,!0,!0),p.shapeUpdated=!0,o-=1;}return i;}},{key:"syncHierarchy",value:function(t){for(var e,n,r=[t],i=t.parentNode?[{node:t.parentNode,transformDirty:(null===(e=t.parentNode.transformable)||void 0===e?void 0:e.localDirtyFlag)||(null===(n=t.parentNode.transformable)||void 0===n?void 0:n.dirtyFlag),shapeUpdated:!1}]:[];r.length>0;){for(var a=r.pop(),o=i[i.length-1];i.length>0&&a.parentNode!==o.node;)o=i.pop();var s=this.internalUpdateElement(a,i);if(a.childNodes.length>0){for(var l=a.childNodes.length-1;l>=0;l--)r.push(a.childNodes[l]);i.push({node:a,transformDirty:s,shapeUpdated:!1});}}}},{key:"dirtyLocalTransform",value:function(t,e){n5(t)||e.localDirtyFlag||(e.localDirtyFlag=!0,e.dirtyFlag||this.dirtyWorldTransform(t,e));}},{key:"dirtyWorldTransform",value:function(t,e){this.dirtyWorldInternal(t,e),this.dirtyToRoot(t,!0);}},{key:"dirtyWorldInternal",value:function(t,e){var n,r=this,i=(null===(n=t.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n||null===(n=n.getConfig())||void 0===n||null===(n=n.future)||void 0===n?void 0:n.experimentalAttributeUpdateOptimization)===!0;e.dirtyFlag||(e.dirtyFlag=!0,t.dirty(!0,!0),i||t.childNodes.forEach(function(t){var e=t.transformable;r.dirtyWorldInternal(t,e);}));}},{key:"dirtyToRoot",value:function(t){for(var e,n,r,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=t,o=(null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig())||void 0===e||null===(e=e.future)||void 0===e?void 0:e.experimentalAttributeUpdateOptimization)===!0;a&&(null===(n=(r=a).dirty)||void 0===n||n.call(r,!0,!0),!o);)a=a.parentNode;i&&t.forEach(function(t){var e;null===(e=t.dirty)||void 0===e||e.call(t,!0,!0);}),this.informDependentDisplayObjects(t);var s=t.mutations||[],l=s.find(function(t){return"attributes"===t.type&&t._boundsChangeData;});l?l._boundsChangeData={affectChildren:l._boundsChangeData.affectChildren||i}:(l={type:"attributes",target:t,_boundsChangeData:{affectChildren:i}},s.push(l)),t.mutations=s;}},{key:"dirtyFragment",value:function(t){var e,n=t.transformable;n&&(n.dirtyFlag=!0,n.localDirtyFlag=!0),null===(e=t.dirty)||void 0===e||e.call(t,!0,!0);for(var r=t.childNodes.length,i=0;i<r;i++)this.dirtyFragment(t.childNodes[i]);}},{key:"notifyMutationObservers",value:function(t){var e=new Set;if(t.getRoot().forEach(function(t){(t.mutations||[]).forEach(function(n){"attributes"===n.type&&n._boundsChangeData&&(n._boundsChangeData.affectChildren?t.forEach(function(t){var r=(0,A.default)({},n);r.target=t,e.add(r);}):e.add(n));}),t.mutations=void 0;}),e.size>0){var n=new rF(rX.BOUNDS_CHANGED,{detail:Array.from(e)});t.dispatchEvent(n,!0,!0);}}},{key:"updateDisplayObjectDependency",value:function(t,e,n,r){if(e&&e!==n){var i=this.displayObjectDependencyMap.get(e);if(i&&i[t]){var a=i[t].indexOf(r);i[t].splice(a,1);}}if(n){var o=this.displayObjectDependencyMap.get(n);o||(this.displayObjectDependencyMap.set(n,{}),o=this.displayObjectDependencyMap.get(n)),o[t]||(o[t]=[]),o[t].push(r);}}},{key:"informDependentDisplayObjects",value:function(t){var e,n=this,r=this.displayObjectDependencyMap.get(t);if(r){var i=null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig())||void 0===e||null===(e=e.future)||void 0===e?void 0:e.experimentalCancelEventPropagation;Object.keys(r).forEach(function(t){r[t].forEach(function(e){n.dirtyToRoot(e,!0),e.dispatchEvent(new rj(rX.ATTR_MODIFIED,e,n,n,t,rj.MODIFICATION,n,n),i,i),e.isCustomElement&&e.isConnected&&e.attributeChangedCallback&&e.attributeChangedCallback(t,n,n);});});}}}]),ia=(0,R.default)(function t(e){if((0,C.default)(this,t),e<=0)throw Error("LRU capacity must be a positive number.");this.capacity=e,this.cache=new Map;},[{key:"get",value:function(t){if(this.cache.has(t)){var e=this.cache.get(t);return this.cache.delete(t),this.cache.set(t,e),e;}}},{key:"put",value:function(t,e){if(this.cache.has(t)&&this.cache.delete(t),this.cache.set(t,e),this.cache.size>this.capacity){var n=this.cache.keys().next().value;this.cache.delete(n);}}},{key:"len",value:function(){return this.cache.size;}},{key:"clear",value:function(){this.cache.clear();}}]),io={MetricsString:"|\xc9q\xc5",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},is=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,il=new RegExp("".concat(/[!%),.:;?\]}'""]/.source,"|").concat(/[!),.:;?\]}'""]/.source,"|").concat(/[)\]'"?!:;,.]/.source,"|").concat(/[!%),.:;?\]}'"]/.source)),iu=new RegExp("".concat(/[$('"]/.source,"|").concat(/[([{'"]/.source,"|").concat(/[(['"...]/.source,"|").concat(/[$([{'"#]/.source)),ic=(0,R.default)(function t(e){var n=this;(0,C.default)(this,t),this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(t,e){return!n.isBreakingSpace(e)&&!!(t&&(iu.exec(e)||il.exec(t)));},this.trimByKinsokuShorui=function(t){var e=(0,O.default)(t),n=e[e.length-2];if(!n)return t;var r=n[n.length-1];return e[e.length-2]=n.slice(0,-1),e[e.length-1]=r+e[e.length-1],e;},this.runtime=e,this.charWidthCache=new ia(100);},[{key:"measureFont",value:function(t,e){if(this.fontMetricsCache[t])return this.fontMetricsCache[t];var n={ascent:0,descent:0,fontSize:0},r=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(e),i=this.runtime.offscreenCanvasCreator.getOrCreateContext(e,{willReadFrequently:!0});i.font=t;var a=io.MetricsString+io.BaselineSymbol,o=Math.ceil(i.measureText(a).width),s=Math.ceil(i.measureText(io.BaselineSymbol).width),l=io.HeightMultiplier*s;s=s*io.BaselineMultiplier|0,r.width=o,r.height=l,i.fillStyle="#f00",i.fillRect(0,0,o,l),i.font=t,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(a,0,s);var u=i.getImageData(0,0,o||1,l||1).data,c=u.length,h=4*o,d=0,f=0,v=!1;for(d=0;d<s;++d){for(var p=0;p<h;p+=4)if(255!==u[f+p]){v=!0;break;}if(v)break;f+=h;}for(n.ascent=s-d,f=c-h,v=!1,d=l;d>s;--d){for(var g=0;g<h;g+=4)if(255!==u[f+g]){v=!0;break;}if(v)break;f-=h;}return n.descent=d-s,n.fontSize=n.ascent+n.descent,this.fontMetricsCache[t]=n,n;}},{key:"measureText",value:function(t,e,n){var r=e.fontSize,i=void 0===r?16:r,a=e.wordWrap,o=e.lineHeight,s=e.lineWidth,l=void 0===s?1:s,u=e.textBaseline,c=void 0===u?"alphabetic":u,h=e.textAlign,d=void 0===h?"start":h,f=e.letterSpacing,v=void 0===f?0:f,p=e.textPath;e.textPathSide,e.textPathStartOffset;var g=e.leading,y=void 0===g?0:g,m=rf(e),k=this.measureFont(m,n);0===k.fontSize&&(k.fontSize=i,k.ascent=i);var E=this.runtime.offscreenCanvasCreator.getOrCreateContext(n);E.font=m,e.isOverflowing=!1;var x=(void 0!==a&&a?this.wordWrap(t,e,n):t).split(/(?:\r\n|\r|\n)/),T=Array(x.length),N=0;if(p){p.getTotalLength();for(var b=0;b<x.length;b++)E.measureText(x[b]).width,x[b].length;}else{for(var S=0;S<x.length;S++){var w=E.measureText(x[S]).width+(x[S].length-1)*v;T[S]=w,N=Math.max(N,w);}var P=N+l,M=o||k.fontSize+l,A=Math.max(M,k.fontSize+l)+(x.length-1)*(M+y);M+=y;var C=0;return"middle"===c?C=-A/2:"bottom"===c||"alphabetic"===c||"ideographic"===c?C=-A:("top"===c||"hanging"===c)&&(C=0),{font:m,width:P,height:A,lines:x,lineWidths:T,lineHeight:M,maxLineWidth:N,fontProperties:k,lineMetrics:T.map(function(t,e){var n=0;return"center"===d||"middle"===d?n-=t/2:("right"===d||"end"===d)&&(n-=t),new ts(n-l/2,C+e*M,t+l,M);})};}}},{key:"wordWrap",value:function(t,e,n){var r=this,i=Array.from(t);if(0===i.length)return"";var a=this,o=e.wordWrapWidth,s=e.letterSpacing,l=void 0===s?0:s,u=e.maxLines,c=void 0===u?1/0:u,h=e.textOverflow,d=this.runtime.offscreenCanvasCreator.getOrCreateContext(n),f=(void 0===o?0:o)+l,v="";"ellipsis"===h?v="...":h&&"clip"!==h&&(v=h);var p=[""],g=0,y=0,m=-1,k=rf(e),E=this.charWidthCache.get(k);E||(E=new ia(500),this.charWidthCache.put(k,E));var x=function(t){return r.getFromCache(t,l,E,d);},T=x(v);function N(t,e,n,r){for(;x(t)<r&&e<i.length-1&&!a.isNewline(i[e+1]);)e+=1,t+=i[e];for(;x(t)>r&&e>=n;)e-=1,t=t.slice(0,-1);return{lineTxt:t,txtLastCharIndex:e};}function b(t,e){if(!(T<=0)&&!(T>f)){if(!p[t]){p[t]=v;return;}var n=N(p[t],e,m+1,f-T);p[t]=n.lineTxt+v;}}for(var S=0;S<i.length;S++){var w=i[S],P=i[S-1],M=i[S+1],A=x(w);if(this.isNewline(w)){if(g+1>=c){S<i.length-1&&b(g,S-1),e.isOverflowing=!0;break;}m=S-1,y=0,p[g+=1]="";continue;}if(A>f){b(g,S-1),e.isOverflowing=!0;break;}if(y>0&&y+A>f){var C=N(p[g],S-1,m+1,f);if(C.txtLastCharIndex!==S-1){if(p[g]=C.lineTxt,C.txtLastCharIndex===i.length-1)break;w=i[S=C.txtLastCharIndex+1],P=i[S-1],M=i[S+1],A=x(w);}if(g+1>=c){b(g,S-1),e.isOverflowing=!0;break;}if(m=S-1,y=0,p[g+=1]="",this.isBreakingSpace(w))continue;this.canBreakInLastChar(w)||(p=this.trimToBreakable(p),y=this.sumTextWidthByCache(p[g]||"",x)),this.shouldBreakByKinsokuShorui(w,M)&&(p=this.trimByKinsokuShorui(p),y+=x(P||""));}y+=A,p[g]+=w;}return p.join("\n");}},{key:"isBreakingSpace",value:function(t){return"string"==typeof t&&io.BreakingSpaces.indexOf(t.charCodeAt(0))>=0;}},{key:"isNewline",value:function(t){return"string"==typeof t&&io.Newlines.indexOf(t.charCodeAt(0))>=0;}},{key:"trimToBreakable",value:function(t){var e=(0,O.default)(t),n=e[e.length-2],r=this.findBreakableIndex(n);if(-1===r||!n)return e;var i=n.slice(r,r+1),a=this.isBreakingSpace(i);return e[e.length-1]+=n.slice(r+1,n.length),e[e.length-2]=n.slice(0,r+(a?0:1)),e;}},{key:"canBreakInLastChar",value:function(t){return!(t&&is.test(t));}},{key:"sumTextWidthByCache",value:function(t,e){return t.split("").reduce(function(t,n){return t+e(n);},0);}},{key:"findBreakableIndex",value:function(t){for(var e=t.length-1;e>=0;e--)if(!is.test(t[e]))return e;return -1;}},{key:"getFromCache",value:function(t,e,n,r){var i=n.get(t);if("number"!=typeof i){var a=t.length*e;i=r.measureText(t).width+a,n.put(t,i);}return i;}},{key:"clearCache",value:function(){this.fontMetricsCache={},this.charWidthCache.clear();}}]),ih={},id=(T=new rC,N=new rA,x={},(0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)(x,j.FRAGMENT,null),j.CIRCLE,new rS),j.ELLIPSE,new rw),j.RECT,T),j.IMAGE,T),j.GROUP,new rO),j.LINE,new rP),j.TEXT,new rR(ih)),j.POLYLINE,N),j.POLYGON,N),(0,B.default)((0,B.default)((0,B.default)(x,j.PATH,new rM),j.HTML,new rL),j.MESH,null)),iv=(S=new nF,w=new nV,b={},(0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)(b,tF.PERCENTAGE,null),tF.NUMBER,new nW),tF.ANGLE,new n_),tF.DEFINED_PATH,new nG),tF.PAINT,S),tF.COLOR,S),tF.FILTER,new nB),tF.LENGTH,w),tF.LENGTH_PERCENTAGE,w),tF.LENGTH_PERCENTAGE_12,new nz),(0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)((0,B.default)(b,tF.LENGTH_PERCENTAGE_14,new nH),tF.COORDINATE,new nV),tF.OFFSET_DISTANCE,new nq),tF.OPACITY_VALUE,new nX),tF.PATH,new nj),tF.LIST_OF_POINTS,new n$),tF.SHADOW_BLUR,new nK),tF.TEXT,new nZ),tF.TEXT_TRANSFORM,new nQ),tF.TRANSFORM,new rT),(0,B.default)((0,B.default)((0,B.default)(b,tF.TRANSFORM_ORIGIN,new rN),tF.Z_INDEX,new rb),tF.MARKER,new nY));ih.CameraContribution=tC,ih.AnimationTimeline=null,ih.EasingFunction=null,ih.offscreenCanvasCreator=new rz,ih.sceneGraphSelector=new rq,ih.sceneGraphService=new ii(ih),ih.textService=new ic(ih),ih.geometryUpdaterFactory=id,ih.CSSPropertySyntaxFactory=iv,ih.styleValueRegistry=new nI(ih),ih.layoutRegistry=null,ih.globalThis="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==X?X:{},ih.enableStyleSyntax=!0,ih.enableSizeAttenuation=!1;var ip=0,ig=new rj(rX.INSERTED,null,"","","",0,"",""),iy=new rj(rX.REMOVED,null,"","","",0,"",""),im=new rF(rX.DESTROY),ik=function(t){function e(){var t;(0,C.default)(this,e);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=(0,L.default)(this,e,[].concat(r))).entity=ip++,t.transformable={dirtyFlag:!1,localDirtyFlag:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},t.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},t.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},t.cullable={strategy:tR.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},t.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},t.rBushNode={aabb:void 0},t.namespaceURI="g",t.scrollLeft=0,t.scrollTop=0,t.clientTop=0,t.clientLeft=0,t.style={},t.computedStyle={},t.parsedStyle={},t.attributes={},t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"dirty",value:function(){var t=!(arguments.length>0)||void 0===arguments[0]||arguments[0],e=arguments.length>1?arguments[1]:void 0;this.renderable.dirty=t,void 0!==e&&(this.renderable.boundsDirty=e,this.renderable.renderBoundsDirty=e,this.geometry.dirty=e);}},{key:"className",get:function(){return this.getAttribute("class")||"";},set:function(t){this.setAttribute("class",t);}},{key:"classList",get:function(){return this.className.split(" ").filter(function(t){return""!==t;});}},{key:"tagName",get:function(){return this.nodeName;}},{key:"children",get:function(){return this.childNodes;}},{key:"childElementCount",get:function(){return this.childNodes.length;}},{key:"firstElementChild",get:function(){return this.firstChild;}},{key:"lastElementChild",get:function(){return this.lastChild;}},{key:"parentElement",get:function(){return this.parentNode;}},{key:"nextSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t+1]||null;}return null;}},{key:"previousSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t-1]||null;}return null;}},{key:"cloneNode",value:function(t){throw Error(tl);}},{key:"appendChild",value:function(t,e){var n;if(t.destroyed)throw Error("Cannot append a destroyed element.");return ih.sceneGraphService.attach(t,this,e),null!==(n=this.ownerDocument)&&void 0!==n&&n.defaultView&&(n5(this)||t.nodeName!==j.FRAGMENT?this.ownerDocument.defaultView.mountChildren(t):this.ownerDocument.defaultView.mountFragment(t)),this.isMutationObserved&&(ig.relatedNode=this,t.dispatchEvent(ig)),t;}},{key:"insertBefore",value:function(t,e){if(e){t.parentElement&&t.parentElement.removeChild(t);var n=this.childNodes.indexOf(e);-1===n?this.appendChild(t):this.appendChild(t,n);}else this.appendChild(t);return t;}},{key:"replaceChild",value:function(t,e){var n=this.childNodes.indexOf(e);return this.removeChild(e),this.appendChild(t,n),e;}},{key:"removeChild",value:function(t){var e,n,r=(null===(e=this.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig().future)||void 0===e?void 0:e.experimentalCancelEventPropagation)===!0;return iy.relatedNode=this,t.dispatchEvent(iy,r,r),null!==(n=t.ownerDocument)&&void 0!==n&&n.defaultView&&t.ownerDocument.defaultView.unmountChildren(t),ih.sceneGraphService.detach(t),t;}},{key:"removeChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var e=this.childNodes[t];this.removeChild(e);}}},{key:"destroyChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var e=this.childNodes[t];e.childNodes.length>0&&e.destroyChildren(),e.destroy();}}},{key:"matches",value:function(t){return ih.sceneGraphService.matches(t,this);}},{key:"getElementById",value:function(t){return ih.sceneGraphService.querySelector("#".concat(t),this);}},{key:"getElementsByName",value:function(t){return ih.sceneGraphService.querySelectorAll('[name="'.concat(t,'"]'),this);}},{key:"getElementsByClassName",value:function(t){return ih.sceneGraphService.querySelectorAll(".".concat(t),this);}},{key:"getElementsByTagName",value:function(t){return ih.sceneGraphService.querySelectorAll(t,this);}},{key:"querySelector",value:function(t){return ih.sceneGraphService.querySelector(t,this);}},{key:"querySelectorAll",value:function(t){return ih.sceneGraphService.querySelectorAll(t,this);}},{key:"closest",value:function(t){var e=this;do{if(ih.sceneGraphService.matches(t,e))return e;e=e.parentElement;}while(null!==e)return null;}},{key:"find",value:function(t){var e=this,n=null;return this.forEach(function(r){return!(r!==e&&t(r))||(n=r,!1);}),n;}},{key:"findAll",value:function(t){var e=this,n=[];return this.forEach(function(r){r!==e&&t(r)&&n.push(r);}),n;}},{key:"after",value:function(){var t=this;if(this.parentNode){for(var e=this.parentNode.childNodes.indexOf(this),n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];r.forEach(function(n,r){var i;return null===(i=t.parentNode)||void 0===i?void 0:i.appendChild(n,e+r+1);});}}},{key:"before",value:function(){if(this.parentNode){for(var t=this.parentNode.childNodes.indexOf(this),e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n[0],a=(0,V.default)(n).slice(1);this.parentNode.appendChild(i,t),i.after.apply(i,(0,O.default)(a));}}},{key:"replaceWith",value:function(){this.after.apply(this,arguments),this.remove();}},{key:"append",value:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(function(e){return t.appendChild(e);});}},{key:"prepend",value:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(function(e,n){return t.appendChild(e,n);});}},{key:"replaceChildren",value:function(){for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,arguments);}},{key:"remove",value:function(){return this.parentNode?this.parentNode.removeChild(this):this;}},{key:"destroy",value:function(){var t,e=(null===(t=this.ownerDocument)||void 0===t||null===(t=t.defaultView)||void 0===t||null===(t=t.getConfig().future)||void 0===t?void 0:t.experimentalCancelEventPropagation)===!0;this.destroyChildren(),this.dispatchEvent(im,e,e),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0;}},{key:"getGeometryBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return ih.sceneGraphService.getGeometryBounds(this,t);}},{key:"getTransformedGeometryBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return ih.sceneGraphService.getTransformedGeometryBounds(this,t);}},{key:"getBounds",value:function(){return ih.sceneGraphService.getBounds(this);}},{key:"getRenderBounds",value:function(){return ih.sceneGraphService.getBounds(this,!0);}},{key:"getLocalBounds",value:function(){return ih.sceneGraphService.getLocalBounds(this);}},{key:"getBoundingClientRect",value:function(){return ih.sceneGraphService.getBoundingClientRect(this);}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()];}},{key:"computedStyleMap",value:function(){return new Map(Object.entries(this.computedStyle));}},{key:"getAttributeNames",value:function(){return Object.keys(this.attributes);}},{key:"getAttribute",value:function(t){if("symbol"!=typeof t)return this.attributes[t];}},{key:"hasAttribute",value:function(t){return this.getAttributeNames().includes(t);}},{key:"hasAttributes",value:function(){return!!this.getAttributeNames().length;}},{key:"removeAttribute",value:function(t){this.setAttribute(t,null),delete this.attributes[t];}},{key:"setAttribute",value:function(t,e){this.attributes[t]=e;}},{key:"getAttributeNS",value:function(t,e){throw Error(tl);}},{key:"getAttributeNode",value:function(t){throw Error(tl);}},{key:"getAttributeNodeNS",value:function(t,e){throw Error(tl);}},{key:"hasAttributeNS",value:function(t,e){throw Error(tl);}},{key:"removeAttributeNS",value:function(t,e){throw Error(tl);}},{key:"removeAttributeNode",value:function(t){throw Error(tl);}},{key:"setAttributeNS",value:function(t,e,n){throw Error(tl);}},{key:"setAttributeNode",value:function(t){throw Error(tl);}},{key:"setAttributeNodeNS",value:function(t){throw Error(tl);}},{key:"toggleAttribute",value:function(t,e){throw Error(tl);}}]);}(rU);function iE(t){return!!(null!=t&&t.nodeName);}var ix=ih.globalThis.Proxy?ih.globalThis.Proxy:function(){},iT=new rj(rX.ATTR_MODIFIED,null,null,null,null,rj.MODIFICATION,null,null),iN=G.vec3.create(),ib=G.quat.create(),iS=function(t){function e(t){var n;return(0,C.default)(this,e),(n=(0,L.default)(this,e)).isCustomElement=!1,n.isMutationObserved=!1,n.activeAnimations=[],n.config=t,n.id=t.id||"",n.name=t.name||"",(t.className||t.class)&&(n.className=t.className||t.class),n.nodeName=t.type||j.GROUP,t.initialParsedStyle&&Object.assign(n.parsedStyle,t.initialParsedStyle),n.initAttributes(t.style),ih.enableStyleSyntax&&(n.style=new ix({setProperty:function(t,e){n.setAttribute(t,e);},getPropertyValue:function(t){return n.getAttribute(t);},removeProperty:function(t){n.removeAttribute(t);},item:function(){return"";}},{get:function(t,e){return void 0!==t[e]?t[e]:n.getAttribute(e);},set:function(t,e,r){return n.setAttribute(e,r),!0;}})),n;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"destroy",value:function(){(0,U.default)(e,"destroy",this,3)([]),this.getAnimations().forEach(function(t){t.cancel();});}},{key:"cloneNode",value:function(t,e){var n=(0,A.default)({},this.attributes);for(var r in n){var i=n[r];iE(i)&&"clipPath"!==r&&"offsetPath"!==r&&"textPath"!==r&&(n[r]=i.cloneNode(t)),e&&(n[r]=e(r,i));}var a=new this.constructor((0,A.default)((0,A.default)({},this.config),{},{style:n}));return a.setLocalTransform(this.getLocalTransform()),t&&this.children.forEach(function(e){if(!e.style.isMarker){var n=e.cloneNode(t);a.appendChild(n);}}),a;}},{key:"initAttributes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ih.styleValueRegistry.processProperties(this,t,{forceUpdateGeometry:!0}),this.dirty();}},{key:"setAttribute",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!(arguments.length>3)||void 0===arguments[3]||arguments[3];!(0,F.isUndefined)(n)&&(r||n!==this.attributes[t])&&(this.internalSetAttribute(t,n,{memoize:i}),(0,U.default)(e,"setAttribute",this,3)([t,n]));}},{key:"internalSetAttribute",value:function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.attributes[t],a=this.parsedStyle[t];ih.styleValueRegistry.processProperties(this,(0,B.default)({},t,e),r),this.dirty();var o=this.parsedStyle[t];if(this.isConnected){if(iT.relatedNode=this,iT.prevValue=i,iT.newValue=e,iT.attrName=t,iT.prevParsedValue=a,iT.newParsedValue=o,this.isMutationObserved)this.dispatchEvent(iT);else{var s,l=(null===(s=this.ownerDocument.defaultView.getConfig().future)||void 0===s?void 0:s.experimentalCancelEventPropagation)===!0;iT.target=this,this.ownerDocument.defaultView.dispatchEvent(iT,!0,l);}}(this.isCustomElement&&this.isConnected||!this.isCustomElement)&&(null===(n=this.attributeChangedCallback)||void 0===n||n.call(this,t,i,e,a,o));}},{key:"getBBox",value:function(){var t=this.getBounds(),e=t.getMin(),n=(0,D.default)(e,2),r=n[0],i=n[1],a=t.getMax(),o=(0,D.default)(a,2);return new ts(r,i,o[0]-r,o[1]-i);}},{key:"setOrigin",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ih.sceneGraphService.setOrigin(this,td(t,e,n,!1)),this;}},{key:"getOrigin",value:function(){return ih.sceneGraphService.getOrigin(this);}},{key:"setPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ih.sceneGraphService.setPosition(this,td(t,e,n,!1)),this;}},{key:"setLocalPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ih.sceneGraphService.setLocalPosition(this,td(t,e,n,!1)),this;}},{key:"translate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ih.sceneGraphService.translate(this,td(t,e,n,!1)),this;}},{key:"translateLocal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ih.sceneGraphService.translateLocal(this,td(t,e,n,!1)),this;}},{key:"getPosition",value:function(){return ih.sceneGraphService.getPosition(this);}},{key:"getLocalPosition",value:function(){return ih.sceneGraphService.getLocalPosition(this);}},{key:"scale",value:function(t,e,n){return this.scaleLocal(t,e,n);}},{key:"scaleLocal",value:function(t,e,n){return"number"==typeof t&&(e=e||t,n=n||t,t=td(t,e,n,!1)),ih.sceneGraphService.scaleLocal(this,t),this;}},{key:"setLocalScale",value:function(t,e,n){return"number"==typeof t&&(e=e||t,n=n||t,t=td(t,e,n,!1)),ih.sceneGraphService.setLocalScale(this,t),this;}},{key:"getLocalScale",value:function(){return ih.sceneGraphService.getLocalScale(this);}},{key:"getScale",value:function(){return ih.sceneGraphService.getScale(this);}},{key:"getEulerAngles",value:function(){var t=tm(iN,ih.sceneGraphService.getWorldTransform(this));return(0,D.default)(t,3)[2]*tp;}},{key:"getLocalEulerAngles",value:function(){var t=tm(iN,ih.sceneGraphService.getLocalRotation(this));return(0,D.default)(t,3)[2]*tp;}},{key:"setEulerAngles",value:function(t){return ih.sceneGraphService.setEulerAngles(this,0,0,t),this;}},{key:"setLocalEulerAngles",value:function(t){return ih.sceneGraphService.setLocalEulerAngles(this,0,0,t),this;}},{key:"rotateLocal",value:function(t,e,n){return(0,F.isNil)(e)&&(0,F.isNil)(n)?ih.sceneGraphService.rotateLocal(this,0,0,t):ih.sceneGraphService.rotateLocal(this,t,e,n),this;}},{key:"rotate",value:function(t,e,n){return(0,F.isNil)(e)&&(0,F.isNil)(n)?ih.sceneGraphService.rotate(this,0,0,t):ih.sceneGraphService.rotate(this,t,e,n),this;}},{key:"setRotation",value:function(t,e,n,r){return ih.sceneGraphService.setRotation(this,t,e,n,r),this;}},{key:"setLocalRotation",value:function(t,e,n,r){return ih.sceneGraphService.setLocalRotation(this,t,e,n,r),this;}},{key:"setLocalSkew",value:function(t,e){return ih.sceneGraphService.setLocalSkew(this,t,e),this;}},{key:"getRotation",value:function(){return ih.sceneGraphService.getRotation(this);}},{key:"getLocalRotation",value:function(){return ih.sceneGraphService.getLocalRotation(this);}},{key:"getLocalSkew",value:function(){return ih.sceneGraphService.getLocalSkew(this);}},{key:"getLocalTransform",value:function(){return ih.sceneGraphService.getLocalTransform(this);}},{key:"getWorldTransform",value:function(){return ih.sceneGraphService.getWorldTransform(this);}},{key:"setLocalTransform",value:function(t){return ih.sceneGraphService.setLocalTransform(this,t),this;}},{key:"resetLocalTransform",value:function(){ih.sceneGraphService.resetLocalTransform(this);}},{key:"getAnimations",value:function(){return this.activeAnimations;}},{key:"animate",value:function(t,e){var n,r=null===(n=this.ownerDocument)||void 0===n?void 0:n.timeline;return r?r.play(this,t,e):null;}},{key:"isVisible",value:function(){var t;return(null===(t=this.parsedStyle)||void 0===t?void 0:t.visibility)!=="hidden";}},{key:"interactive",get:function(){return this.isInteractive();},set:function(t){this.style.pointerEvents=t?"auto":"none";}},{key:"isInteractive",value:function(){var t;return(null===(t=this.parsedStyle)||void 0===t?void 0:t.pointerEvents)!=="none";}},{key:"isCulled",value:function(){return!!(this.cullable&&this.cullable.enable&&!this.cullable.visible);}},{key:"toFront",value:function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,(0,O.default)(this.parentNode.children.map(function(t){return Number(t.style.zIndex);})))+1),this;}},{key:"toBack",value:function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,(0,O.default)(this.parentNode.children.map(function(t){return Number(t.style.zIndex);})))-1),this;}},{key:"getConfig",value:function(){return this.config;}},{key:"attr",value:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n[0],a=n[1];return i?(0,F.isObject)(i)?(Object.keys(i).forEach(function(e){t.setAttribute(e,i[e]);}),this):2===n.length?(this.setAttribute(i,a),this):this.attributes[i]:this.attributes;}},{key:"getMatrix",value:function(t){var e,n,r,i=t||this.getWorldTransform(),a=G.mat4.getTranslation(iN,i),o=(0,D.default)(a,2),s=o[0],l=o[1],u=G.mat4.getScaling(iN,i),c=(0,D.default)(u,2),h=c[0],d=c[1],f=tm(iN,G.mat4.getRotation(ib,i)),v=(0,D.default)(f,3),p=v[0],g=v[2];return n=Math.cos(e=p||g),r=Math.sin(e),G.mat3.fromValues(h*n,d*r,0,-h*r,d*n,0,s,l,1);}},{key:"getLocalMatrix",value:function(){return this.getMatrix(this.getLocalTransform());}},{key:"setMatrix",value:function(t){var e=tk(t),n=(0,D.default)(e,5),r=n[0],i=n[1],a=n[2],o=n[3],s=n[4];this.setEulerAngles(s).setPosition(r,i).setLocalScale(a,o);}},{key:"setLocalMatrix",value:function(t){var e=tk(t),n=(0,D.default)(e,5),r=n[0],i=n[1],a=n[2],o=n[3],s=n[4];this.setLocalEulerAngles(s).setLocalPosition(r,i).setLocalScale(a,o);}},{key:"show",value:function(){this.forEach(function(t){t.style.visibility="visible";});}},{key:"hide",value:function(){this.forEach(function(t){t.style.visibility="hidden";});}},{key:"getCount",value:function(){return this.childElementCount;}},{key:"getParent",value:function(){return this.parentElement;}},{key:"getChildren",value:function(){return this.children;}},{key:"getFirst",value:function(){return this.firstElementChild;}},{key:"getLast",value:function(){return this.lastElementChild;}},{key:"getChildByIndex",value:function(t){return this.children[t]||null;}},{key:"add",value:function(t,e){return this.appendChild(t,e);}},{key:"set",value:function(t,e){this.config[t]=e;}},{key:"get",value:function(t){return this.config[t];}},{key:"moveTo",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(t,e,n),this;}},{key:"move",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(t,e,n),this;}},{key:"setZIndex",value:function(t){return this.style.zIndex=t,this;}}]);}(ik);iS.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","display","draggable","droppable","fill","fillOpacity","fillRule","filter","increasedLineWidthForHitTesting","lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit","hitArea","offsetDistance","offsetPath","offsetX","offsetY","opacity","pointerEvents","shadowColor","shadowType","shadowBlur","shadowOffsetX","shadowOffsetY","stroke","strokeOpacity","strokeWidth","strokeLinecap","strokeLineJoin","strokeDasharray","strokeDashoffset","transform","transformOrigin","textTransform","visibility","zIndex"]);var iw=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.CIRCLE},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(iS);iw.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iS.PARSED_STYLE_LIST),["cx","cy","cz","r","isBillboard","isSizeAttenuation"]));var iP=["style"],iM=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iP);return(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({style:r},i)])).isCustomElement=!0,t;}return(0,I.default)(e,t),(0,R.default)(e);}(iS);iM.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var iA=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.ELLIPSE},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(iS);iA.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iS.PARSED_STYLE_LIST),["cx","cy","cz","rx","ry","isBillboard","isSizeAttenuation"])),function(t){function e(){return(0,C.default)(this,e),(0,L.default)(this,e,[{type:j.FRAGMENT}]);}return(0,I.default)(e,t),(0,R.default)(e);}(iS).PARSED_STYLE_LIST=new Set(["class","className"]);var iC=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.GROUP},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(iS);iC.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var iR=["style"],iO=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iR);return(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({type:j.HTML,style:r},i)])).cullable.enable=!1,t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getDomElement",value:function(){return this.parsedStyle.$el;}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()];}},{key:"getLocalBounds",value:function(){if(this.parentNode){var t=G.mat4.invert(G.mat4.create(),this.parentNode.getWorldTransform()),e=this.getBounds();if(!tn.isEmpty(e)){var n=new tn;return n.setFromTransformedAABB(e,t),n;}}return this.getBounds();}}]);}(iS);iO.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iS.PARSED_STYLE_LIST),["x","y","$el","innerHTML","width","height"]));var iL=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.IMAGE},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(iS);iL.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iS.PARSED_STYLE_LIST),["x","y","z","src","width","height","isBillboard","billboardRotation","isSizeAttenuation","keepAspectRatio"]));var iI=["style"],iD=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iI);(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({type:j.LINE,style:(0,A.default)({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},r)},i)])).markerStartAngle=0,t.markerEndAngle=0;var a=t.parsedStyle,o=a.markerStart,s=a.markerEnd;return o&&iE(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),s&&iE(s)&&(t.markerEndAngle=s.getLocalEulerAngles(),t.appendChild(s)),t.transformMarker(!0),t.transformMarker(!1),t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"x1"===t||"y1"===t||"x2"===t||"y2"===t||"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&iE(r)&&(this.markerStartAngle=0,r.remove()),i&&iE(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t&&(r&&iE(r)&&(this.markerEndAngle=0,r.remove()),i&&iE(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1)));}},{key:"transformMarker",value:function(t){var e,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,h=s.markerEndOffset,d=s.x1,f=s.x2,v=s.y1,p=s.y2,g=t?l:u;if(g&&iE(g)){var y=0;t?(r=d,i=v,e=f-d,n=p-v,a=c||0,o=this.markerStartAngle):(r=f,i=p,e=d-f,n=v-p,a=h||0,o=this.markerEndAngle),y=Math.atan2(n,e),g.setLocalEulerAngles(180*y/Math.PI+o),g.setLocalPosition(r+Math.cos(y)*a,i+Math.sin(y)*a);}}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle,r=n.x1,i=n.y1,a=n.x2,o=n.y2,s=(0,z.linePointAt)(r,i,a,o,t),l=s.x,u=s.y,c=G.vec3.transformMat4(G.vec3.create(),G.vec3.fromValues(l,u,0),e?this.getWorldTransform():this.getLocalTransform());return new to(c[0],c[1]);}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(t/this.getTotalLength(),e);}},{key:"getTotalLength",value:function(){var t=this.parsedStyle,e=t.x1,n=t.y1,r=t.x2,i=t.y2;return(0,z.lineLength)(e,n,r,i);}}]);}(iS);iD.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iS.PARSED_STYLE_LIST),["x1","y1","x2","y2","z1","z2","isBillboard","isSizeAttenuation","markerStart","markerEnd","markerStartOffset","markerEndOffset"]));var i_=["style"],iG=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,i_);(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({type:j.PATH,style:r,initialParsedStyle:{miterLimit:4,d:(0,A.default)({},tG)}},i)])).markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var a=t.parsedStyle,o=a.markerStart,s=a.markerEnd,l=a.markerMid;return o&&iE(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),l&&iE(l)&&t.placeMarkerMid(l),s&&iE(s)&&(t.markerEndAngle=s.getLocalEulerAngles(),t.appendChild(s)),t.transformMarker(!0),t.transformMarker(!1),t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"d"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&iE(r)&&(this.markerStartAngle=0,r.remove()),i&&iE(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t?(r&&iE(r)&&(this.markerEndAngle=0,r.remove()),i&&iE(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(i);}},{key:"transformMarker",value:function(t){var e,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,h=s.markerEndOffset,d=t?l:u;if(d&&iE(d)){var f=0;if(t){var v=this.getStartTangent(),p=(0,D.default)(v,2),g=p[0],y=p[1];r=y[0],i=y[1],e=g[0]-y[0],n=g[1]-y[1],a=c||0,o=this.markerStartAngle;}else{var m=this.getEndTangent(),k=(0,D.default)(m,2),E=k[0],x=k[1];r=x[0],i=x[1],e=E[0]-x[0],n=E[1]-x[1],a=h||0,o=this.markerEndAngle;}f=Math.atan2(n,e),d.setLocalEulerAngles(180*f/Math.PI+o),d.setLocalPosition(r+Math.cos(f)*a,i+Math.sin(f)*a);}}},{key:"placeMarkerMid",value:function(t){var e=this.parsedStyle.d.segments;if(this.markerMidList.forEach(function(t){t.remove();}),t&&iE(t))for(var n=1;n<e.length-1;n++){var r=(0,D.default)(e[n].currentPoint,2),i=r[0],a=r[1],o=1===n?t:t.cloneNode(!0);this.markerMidList.push(o),this.appendChild(o),o.setLocalPosition(i,a);}}},{key:"getTotalLength",value:function(){return e8(this);}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle.d.absolutePath,r=(0,F.getPointAtLength)(n,t),i=r.x,a=r.y,o=G.vec3.transformMat4(G.vec3.create(),G.vec3.fromValues(i,a,0),e?this.getWorldTransform():this.getLocalTransform());return new to(o[0],o[1]);}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPointAtLength(t*e8(this),e);}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.d.segments,e=[];if(t.length>1){var n=t[0].currentPoint,r=t[1].currentPoint,i=t[1].startTangent;e=[],i?e.push([n[0]-i[0],n[1]-i[1]]):e.push([r[0],r[1]]),e.push([n[0],n[1]]);}return e;}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.d.segments,e=t.length,n=[];if(e>1){var r=t[e-2].currentPoint,i=t[e-1].currentPoint,a=t[e-1].endTangent;n=[],a?n.push([i[0]-a[0],i[1]-a[1]]):n.push([r[0],r[1]]),n.push([i[0],i[1]]);}return n;}}]);}(iS);iG.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iS.PARSED_STYLE_LIST),["d","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard","isSizeAttenuation"]));var iF=["style"],iB=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=(0,q.default)(n,iF);(0,C.default)(this,e),(t=(0,L.default)(this,e,[(0,A.default)({type:j.POLYGON,style:r,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},i)])).markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var a=t.parsedStyle,o=a.markerStart,s=a.markerEnd,l=a.markerMid;return o&&iE(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),l&&iE(l)&&t.placeMarkerMid(l),s&&iE(s)&&(t.markerEndAngle=s.getLocalEulerAngles(),t.appendChild(s)),t.transformMarker(!0),t.transformMarker(!1),t;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"points"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&iE(r)&&(this.markerStartAngle=0,r.remove()),i&&iE(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t?(r&&iE(r)&&(this.markerEndAngle=0,r.remove()),i&&iE(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(i);}},{key:"transformMarker",value:function(t){var e,n,r,i,a,o,s=this.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerStartOffset,h=s.markerEndOffset,d=(s.points||{}).points,f=t?l:u;if(f&&iE(f)&&d){var v=0;if(r=d[0][0],i=d[0][1],t)e=d[1][0]-d[0][0],n=d[1][1]-d[0][1],a=c||0,o=this.markerStartAngle;else{var p=d.length;this.parsedStyle.isClosed?(e=d[p-1][0]-d[0][0],n=d[p-1][1]-d[0][1]):(r=d[p-1][0],i=d[p-1][1],e=d[p-2][0]-d[p-1][0],n=d[p-2][1]-d[p-1][1]),a=h||0,o=this.markerEndAngle;}v=Math.atan2(n,e),f.setLocalEulerAngles(180*v/Math.PI+o),f.setLocalPosition(r+Math.cos(v)*a,i+Math.sin(v)*a);}}},{key:"placeMarkerMid",value:function(t){var e=(this.parsedStyle.points||{}).points;if(this.markerMidList.forEach(function(t){t.remove();}),this.markerMidList=[],t&&iE(t)&&e)for(var n=1;n<(this.parsedStyle.isClosed?e.length:e.length-1);n++){var r=e[n][0],i=e[n][1],a=1===n?t:t.cloneNode(!0);this.markerMidList.push(a),this.appendChild(a),a.setLocalPosition(r,i);}}}]);}(iS);iB.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iS.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isClosed","isBillboard","isSizeAttenuation"]));var iU=["style"],iV=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.style,r=(0,q.default)(t,iU);return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.POLYLINE,style:n,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},r)]);}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getTotalLength",value:function(){return 0===this.parsedStyle.points.totalLength&&(this.parsedStyle.points.totalLength=(0,z.polylineLength)(this.parsedStyle.points.points)),this.parsedStyle.points.totalLength;}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(t/this.getTotalLength(),e);}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle.points.points;if(0===this.parsedStyle.points.segments.length){var r,i,a=[],o=0,s=this.getTotalLength();n.forEach(function(t,e){n[e+1]&&((r=[0,0])[0]=o/s,i=(0,z.lineLength)(t[0],t[1],n[e+1][0],n[e+1][1]),o+=i,r[1]=o/s,a.push(r));}),this.parsedStyle.points.segments=a;}var l=0,u=0;this.parsedStyle.points.segments.forEach(function(e,n){t>=e[0]&&t<=e[1]&&(l=(t-e[0])/(e[1]-e[0]),u=n);});var c=(0,z.linePointAt)(n[u][0],n[u][1],n[u+1][0],n[u+1][1],l),h=c.x,d=c.y,f=G.vec3.transformMat4(G.vec3.create(),G.vec3.fromValues(h,d,0),e?this.getWorldTransform():this.getLocalTransform());return new to(f[0],f[1]);}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.points.points,e=[];return e.push([t[1][0],t[1][1]]),e.push([t[0][0],t[0][1]]),e;}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.points.points,e=t.length-1,n=[];return n.push([t[e-1][0],t[e-1][1]]),n.push([t[e][0],t[e][1]]),n;}}]);}(iB);iV.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iB.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard"]));var iz=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.RECT},t)]);}return(0,I.default)(e,t),(0,R.default)(e);}(iS);iz.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iS.PARSED_STYLE_LIST),["x","y","z","width","height","isBillboard","isSizeAttenuation","radius"]));var iH=["style"],iY=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.style,r=(0,q.default)(t,iH);return(0,C.default)(this,e),(0,L.default)(this,e,[(0,A.default)({type:j.TEXT,style:(0,A.default)({fill:"black"},n)},r)]);}return(0,I.default)(e,t),(0,R.default)(e,[{key:"getComputedTextLength",value:function(){var t;return this.getGeometryBounds(),(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.maxLineWidth)||0;}},{key:"getLineBoundingRects",value:function(){var t;return this.getGeometryBounds(),(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.lineMetrics)||[];}},{key:"isOverflowing",value:function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing;}}]);}(iS);iY.PARSED_STYLE_LIST=new Set([].concat((0,O.default)(iS.PARSED_STYLE_LIST),["x","y","z","isBillboard","billboardRotation","isSizeAttenuation","text","textAlign","textBaseline","fontStyle","fontSize","fontFamily","fontWeight","fontVariant","lineHeight","letterSpacing","leading","wordWrap","wordWrapWidth","maxLines","textOverflow","isOverflowing","textPath","textDecorationLine","textDecorationColor","textDecorationStyle","textDecorationThickness","textPathSide","textPathStartOffset","metrics","dx","dy"]));var iW=(0,R.default)(function t(){(0,C.default)(this,t),this.registry={},this.define(j.CIRCLE,iw),this.define(j.ELLIPSE,iA),this.define(j.RECT,iz),this.define(j.IMAGE,iL),this.define(j.LINE,iD),this.define(j.GROUP,iC),this.define(j.PATH,iG),this.define(j.POLYGON,iB),this.define(j.POLYLINE,iV),this.define(j.TEXT,iY),this.define(j.HTML,iO);},[{key:"define",value:function(t,e){this.registry[t]=e;}},{key:"get",value:function(t){return this.registry[t];}}]),iq=function(t){var e,n;function r(){(0,C.default)(this,r),(t=(0,L.default)(this,r)).defaultView=null,t.ownerDocument=null,t.nodeName="document";try{t.timeline=new ih.AnimationTimeline(t);}catch(t){}var t,e={};return nR.forEach(function(t){var n=t.n,r=t.inh,i=t.d;r&&i&&(e[n]=(0,F.isFunction)(i)?i(j.GROUP):i);}),t.documentElement=new iC({id:"g-root",style:e}),t.documentElement.ownerDocument=t,t.documentElement.parentNode=t,t.childNodes=[t.documentElement],t;}return(0,I.default)(r,t),(0,R.default)(r,[{key:"children",get:function(){return this.childNodes;}},{key:"childElementCount",get:function(){return this.childNodes.length;}},{key:"firstElementChild",get:function(){return this.firstChild;}},{key:"lastElementChild",get:function(){return this.lastChild;}},{key:"createElement",value:function(t,e){if("svg"===t)return this.documentElement;var n=this.defaultView.customElements.get(t);n||(console.warn("Unsupported tagName: ",t),n="tspan"===t?iY:iC);var r=new n(e);return r.ownerDocument=this,r;}},{key:"createElementNS",value:function(t,e,n){return this.createElement(e,n);}},{key:"cloneNode",value:function(t){throw Error(tl);}},{key:"destroy",value:function(){try{this.documentElement.destroyChildren(),this.timeline.destroy();}catch(t){}}},{key:"elementsFromBBox",value:function(t,e,n,r){var i=[],a=function(o){if(!(!o.isInteractive()||o.isCulled())){var s=o.parsedStyle.pointerEvents;if(!["auto","visiblepainted","visiblefill","visiblestroke","visible"].includes(void 0===s?"auto":s)||o.isVisible()){var l=o.getTransformedGeometryBounds(!0);l&&!tn.isEmpty(l)&&l.max[0]>=t&&l.min[0]<=n&&l.max[1]>=e&&l.min[1]<=r&&i.push(o);}o.childNodes&&o.childNodes.forEach(function(t){t instanceof iS&&a(t);});}};return a(this.documentElement),i.sort(function(t,e){return e.sortable.renderOrder-t.sortable.renderOrder;}),i;}},{key:"elementFromPointSync",value:function(t,e){var n=this.defaultView.canvas2Viewport({x:t,y:e}),r=n.x,i=n.y,a=this.defaultView.getConfig(),o=a.width,s=a.height;if(r<0||i<0||r>o||i>s)return null;var l=this.defaultView.viewport2Client({x:r,y:i}),u=l.x,c=l.y,h=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!0,position:{x:t,y:e,viewportX:r,viewportY:i,clientX:u,clientY:c},picked:[]}).picked;return h&&h[0]||this.documentElement;}},{key:"elementFromPoint",value:(e=(0,Y.default)((0,H.default)().mark(function t(e,n){var r,i,a,o,s,l,u,c,h,d;return(0,H.default)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i=(r=this.defaultView.canvas2Viewport({x:e,y:n})).x,a=r.y,s=(o=this.defaultView.getConfig()).width,l=o.height,!(i<0||a<0||i>s||a>l)){t.next=1;break;}return t.abrupt("return",null);case 1:return c=(u=this.defaultView.viewport2Client({x:i,y:a})).x,h=u.y,t.next=2,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!0,position:{x:e,y:n,viewportX:i,viewportY:a,clientX:c,clientY:h},picked:[]});case 2:return d=t.sent.picked,t.abrupt("return",d&&d[0]||this.documentElement);case 3:case"end":return t.stop();}},t,this);})),function(t,n){return e.apply(this,arguments);})},{key:"elementsFromPointSync",value:function(t,e){var n=this.defaultView.canvas2Viewport({x:t,y:e}),r=n.x,i=n.y,a=this.defaultView.getConfig(),o=a.width,s=a.height;if(r<0||i<0||r>o||i>s)return[];var l=this.defaultView.viewport2Client({x:r,y:i}),u=l.x,c=l.y,h=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!1,position:{x:t,y:e,viewportX:r,viewportY:i,clientX:u,clientY:c},picked:[]}).picked;return h[h.length-1]!==this.documentElement&&h.push(this.documentElement),h;}},{key:"elementsFromPoint",value:(n=(0,Y.default)((0,H.default)().mark(function t(e,n){var r,i,a,o,s,l,u,c,h,d;return(0,H.default)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i=(r=this.defaultView.canvas2Viewport({x:e,y:n})).x,a=r.y,s=(o=this.defaultView.getConfig()).width,l=o.height,!(i<0||a<0||i>s||a>l)){t.next=1;break;}return t.abrupt("return",[]);case 1:return c=(u=this.defaultView.viewport2Client({x:i,y:a})).x,h=u.y,t.next=2,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!1,position:{x:e,y:n,viewportX:i,viewportY:a,clientX:c,clientY:h},picked:[]});case 2:return(d=t.sent.picked)[d.length-1]!==this.documentElement&&d.push(this.documentElement),t.abrupt("return",d);case 3:case"end":return t.stop();}},t,this);})),function(t,e){return n.apply(this,arguments);})},{key:"appendChild",value:function(t,e){throw Error(tu);}},{key:"insertBefore",value:function(t,e){throw Error(tu);}},{key:"removeChild",value:function(t,e){throw Error(tu);}},{key:"replaceChild",value:function(t,e,n){throw Error(tu);}},{key:"append",value:function(){throw Error(tu);}},{key:"prepend",value:function(){throw Error(tu);}},{key:"getElementById",value:function(t){return this.documentElement.getElementById(t);}},{key:"getElementsByName",value:function(t){return this.documentElement.getElementsByName(t);}},{key:"getElementsByTagName",value:function(t){return this.documentElement.getElementsByTagName(t);}},{key:"getElementsByClassName",value:function(t){return this.documentElement.getElementsByClassName(t);}},{key:"querySelector",value:function(t){return this.documentElement.querySelector(t);}},{key:"querySelectorAll",value:function(t){return this.documentElement.querySelectorAll(t);}},{key:"find",value:function(t){return this.documentElement.find(t);}},{key:"findAll",value:function(t){return this.documentElement.findAll(t);}}]);}(rU),iX=function(){function t(e){(0,C.default)(this,t),this.strategies=e;}return(0,R.default)(t,[{key:"apply",value:function(e){var n=e.config,r=e.camera,i=e.renderingService,a=e.renderingContext,o=this.strategies;i.hooks.cull.tap(t.tag,function(t){if(t){var e,i=t.cullable;if(0===o.length?i.visible=a.unculledEntities.indexOf(t.entity)>-1:i.visible=o.every(function(e){return e.isVisible(r,t);}),!t.isCulled()&&t.isVisible())return t;var s=(null===(e=n.future)||void 0===e?void 0:e.experimentalCancelEventPropagation)===!0;return t.dispatchEvent(new rF(rX.CULLED),s,s),null;}return t;}),i.hooks.afterRender.tap(t.tag,function(t){t.cullable.visibilityPlaneMask=-1;});}}]);}();iX.tag="Culling";var ij=function(){function t(){var e=this;(0,C.default)(this,t),this.autoPreventDefault=!1,this.rootPointerEvent=new r_(null),this.rootWheelEvent=new rG(null),this.onPointerMove=function(t){var n=null===(r=e.context.renderingContext.root)||void 0===r||null===(r=r.ownerDocument)||void 0===r?void 0:r.defaultView;if(!n.supportsTouchEvents||"touch"!==t.pointerType){var r,i,a=e.normalizeToPointerEvent(t,n),o=(0,W.default)(a);try{for(o.s();!(i=o.n()).done;){var s=i.value,l=e.bootstrapEvent(e.rootPointerEvent,s,n,t);e.context.eventService.mapEvent(l);}}catch(t){o.e(t);}finally{o.f();}e.setCursor(e.context.eventService.cursor);}},this.onClick=function(t){var n,r,i=null===(n=e.context.renderingContext.root)||void 0===n||null===(n=n.ownerDocument)||void 0===n?void 0:n.defaultView,a=e.normalizeToPointerEvent(t,i),o=(0,W.default)(a);try{for(o.s();!(r=o.n()).done;){var s=r.value,l=e.bootstrapEvent(e.rootPointerEvent,s,i,t);e.context.eventService.mapEvent(l);}}catch(t){o.e(t);}finally{o.f();}e.setCursor(e.context.eventService.cursor);};}return(0,R.default)(t,[{key:"apply",value:function(e){var n=this;this.context=e;var r=e.renderingService,i=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler(function(t){return n.context.renderingService.hooks.pickSync.call({position:t,picked:[],topmost:!0}).picked[0]||null;}),r.hooks.pointerWheel.tap(t.tag,function(t){var e=n.normalizeWheelEvent(t);n.context.eventService.mapEvent(e);}),r.hooks.pointerDown.tap(t.tag,function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){var e=n.normalizeToPointerEvent(t,i);n.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();var r,a=(0,W.default)(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=n.bootstrapEvent(n.rootPointerEvent,o,i,t);n.context.eventService.mapEvent(s);}}catch(t){a.e(t);}finally{a.f();}n.setCursor(n.context.eventService.cursor);}}),r.hooks.pointerUp.tap(t.tag,function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){var e,r=n.context.contextService.getDomElement(),a=n.context.eventService.isNativeEventFromCanvas(r,t)?"":"outside",o=n.normalizeToPointerEvent(t,i),s=(0,W.default)(o);try{for(s.s();!(e=s.n()).done;){var l=e.value,u=n.bootstrapEvent(n.rootPointerEvent,l,i,t);u.type+=a,n.context.eventService.mapEvent(u);}}catch(t){s.e(t);}finally{s.f();}n.setCursor(n.context.eventService.cursor);}}),r.hooks.pointerMove.tap(t.tag,this.onPointerMove),r.hooks.pointerOver.tap(t.tag,this.onPointerMove),r.hooks.pointerOut.tap(t.tag,this.onPointerMove),r.hooks.click.tap(t.tag,this.onClick),r.hooks.pointerCancel.tap(t.tag,function(t){var e,r=n.normalizeToPointerEvent(t,i),a=(0,W.default)(r);try{for(a.s();!(e=a.n()).done;){var o=e.value,s=n.bootstrapEvent(n.rootPointerEvent,o,i,t);n.context.eventService.mapEvent(s);}}catch(t){a.e(t);}finally{a.f();}n.setCursor(n.context.eventService.cursor);});}},{key:"bootstrapEvent",value:function(t,e,n,r){t.view=n,t.originalEvent=null,t.nativeEvent=r,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);var i=this.context.eventService.client2Viewport({x:e.clientX,y:e.clientY}),a=i.x,o=i.y;t.viewport.x=a,t.viewport.y=o;var s=this.context.eventService.viewport2Canvas(t.viewport),l=s.x,u=s.y;return t.canvas.x=l,t.canvas.y=u,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=r.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=n3[t.type]||t.type),t;}},{key:"normalizeWheelEvent",value:function(t){var e=this.rootWheelEvent;this.transferMouseData(e,t),e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;var n=this.context.eventService.client2Viewport({x:t.clientX,y:t.clientY}),r=n.x,i=n.y;e.viewport.x=r,e.viewport.y=i;var a=this.context.eventService.viewport2Canvas(e.viewport),o=a.x,s=a.y;return e.canvas.x=o,e.canvas.y=s,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.nativeEvent=t,e.type=t.type,e;}},{key:"transferMouseData",value:function(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=n4.now(),t.type=e.type,t.altKey=e.altKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.ctrlKey=e.ctrlKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.screen.x=e.screenX,t.screen.y=e.screenY,t.relatedTarget=null;}},{key:"setCursor",value:function(t){this.context.contextService.applyCursorStyle(t||this.context.config.cursor||"default");}},{key:"normalizeToPointerEvent",value:function(t,e){var n=[];if(e.isTouchEvent(t))for(var r=0;r<t.changedTouches.length;r++){var i=t.changedTouches[r];(0,F.isUndefined)(i.button)&&(i.button=0),(0,F.isUndefined)(i.buttons)&&(i.buttons=1),(0,F.isUndefined)(i.isPrimary)&&(i.isPrimary=1===t.touches.length&&"touchstart"===t.type),(0,F.isUndefined)(i.width)&&(i.width=i.radiusX||1),(0,F.isUndefined)(i.height)&&(i.height=i.radiusY||1),(0,F.isUndefined)(i.tiltX)&&(i.tiltX=0),(0,F.isUndefined)(i.tiltY)&&(i.tiltY=0),(0,F.isUndefined)(i.pointerType)&&(i.pointerType="touch"),(0,F.isUndefined)(i.pointerId)&&(i.pointerId=i.identifier||0),(0,F.isUndefined)(i.pressure)&&(i.pressure=i.force||.5),(0,F.isUndefined)(i.twist)&&(i.twist=0),(0,F.isUndefined)(i.tangentialPressure)&&(i.tangentialPressure=0),i.isNormalized=!0,i.type=t.type,n.push(i);}else e.isMouseEvent(t)&&((0,F.isUndefined)(t.isPrimary)&&(t.isPrimary=!0),(0,F.isUndefined)(t.width)&&(t.width=1),(0,F.isUndefined)(t.height)&&(t.height=1),(0,F.isUndefined)(t.tiltX)&&(t.tiltX=0),(0,F.isUndefined)(t.tiltY)&&(t.tiltY=0),(0,F.isUndefined)(t.pointerType)&&(t.pointerType="mouse"),(0,F.isUndefined)(t.pointerId)&&(t.pointerId=1),(0,F.isUndefined)(t.pressure)&&(t.pressure=.5),(0,F.isUndefined)(t.twist)&&(t.twist=0),(0,F.isUndefined)(t.tangentialPressure)&&(t.tangentialPressure=0),t.isNormalized=!0),n.push(t);return n;}}]);}();ij.tag="Event";var i$=[j.CIRCLE,j.ELLIPSE,j.IMAGE,j.RECT,j.LINE,j.POLYLINE,j.POLYGON,j.TEXT,j.PATH,j.HTML],iK=(0,R.default)(function t(){(0,C.default)(this,t);},[{key:"isVisible",value:function(t,e){var n,r=e.cullable;if(!r.enable)return!0;var i=e.getRenderBounds();if(tn.isEmpty(i))return!1;var a=t.getFrustum(),o=null===(n=e.parentNode)||void 0===n||null===(n=n.cullable)||void 0===n?void 0:n.visibilityPlaneMask;return r.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(e,i,o||ti.INDETERMINATE,a.planes),r.visible=r.visibilityPlaneMask!==ti.OUTSIDE,r.visible;}},{key:"computeVisibilityWithPlaneMask",value:function(t,e,n,r){if(n===ti.OUTSIDE||n===ti.INSIDE)return n;for(var i=ti.INSIDE,a=i$.indexOf(t.nodeName)>-1,o=0,s=r.length;o<s;++o){var l=1<<o;if((n&l)!=0&&(!a||4!==o&&5!==o)){var u=r[o],c=u.normal,h=u.distance;if(G.vec3.dot(c,e.getPositiveFarPoint(r[o]))+h<0)return ti.OUTSIDE;G.vec3.dot(c,e.getNegativeFarPoint(r[o]))+h<0&&(i|=l);}}return i;}}]),iZ=function(){function t(){(0,C.default)(this,t),this.mutationRecords=[],this.isFirstTimeRendering=!0,this.isFirstTimeRenderingFinished=!1;}return(0,R.default)(t,[{key:"apply",value:function(e){var n,r=this,i=e.renderingService,a=e.renderingContext.root.ownerDocument.defaultView,o=function(t){i.dirty();},s=function(t){var e,n=t.detail;(e=r.mutationRecords).push.apply(e,(0,O.default)(n)),i.dirty();},l=function(t){var e=t.target;ih.enableSizeAttenuation&&ih.styleValueRegistry.updateSizeAttenuation(e,a.getCamera().getZoom());},u=function(t){var e=t.target;ih.sceneGraphService.dirtyToRoot(e),i.dirty();};i.hooks.init.tap(t.tag,function(){a.addEventListener(rX.MOUNTED,l),a.addEventListener(rX.UNMOUNTED,u),a.addEventListener(rX.ATTR_MODIFIED,o),a.addEventListener(rX.BOUNDS_CHANGED,s);}),i.hooks.destroy.tap(t.tag,function(){a.removeEventListener(rX.MOUNTED,l),a.removeEventListener(rX.UNMOUNTED,u),a.removeEventListener(rX.ATTR_MODIFIED,o),a.removeEventListener(rX.BOUNDS_CHANGED,s),r.mutationRecords=[];});var c=null!==(n=ih.globalThis.requestIdleCallback)&&void 0!==n?n:ri.bind(ih.globalThis);i.hooks.endFrame.tap(t.tag,function(){r.isFirstTimeRendering&&(r.isFirstTimeRendering=!1,c(function(){r.isFirstTimeRenderingFinished=!0;})),r.mutationRecords=[];});}}]);}();iZ.tag="Prepare";var iQ=((P={}).READY="ready",P.BEFORE_RENDER="beforerender",P.RERENDER="rerender",P.AFTER_RENDER="afterrender",P.BEFORE_DESTROY="beforedestroy",P.AFTER_DESTROY="afterdestroy",P.RESIZE="resize",P.DIRTY_RECTANGLE="dirtyrectangle",P.RENDERER_CHANGED="rendererchanged",P),iJ=new rF(rX.MOUNTED),i0=new rF(rX.UNMOUNTED),i1=new rF(iQ.BEFORE_RENDER),i2=new rF(iQ.RERENDER),i3=new rF(iQ.AFTER_RENDER),i4=function(t){function e(t){(0,C.default)(this,e),(i=(0,L.default)(this,e)).Element=iS,i.inited=!1,i.context={};var n,r,i,a=t.container,o=t.canvas,s=t.renderer,l=t.width,u=t.height,c=t.background,h=t.cursor,d=t.supportsMutipleCanvasesInOneContainer,f=t.cleanUpOnDestroy,v=void 0===f||f,p=t.offscreenCanvas,g=t.devicePixelRatio,y=t.requestAnimationFrame,m=t.cancelAnimationFrame,k=t.createImage,E=t.supportsTouchEvents,x=t.supportsPointerEvents,T=t.isTouchEvent,N=t.isMouseEvent,b=t.dblClickSpeed,S=l,w=u,P=g||n0&&window.devicePixelRatio||1;return P=P>=1?Math.ceil(P):1,o&&(S=l||("auto"===(n=n2(o,"width"))?o.offsetWidth:parseFloat(n))||o.width/P,w=u||("auto"===(r=n2(o,"height"))?o.offsetHeight:parseFloat(r))||o.height/P),i.customElements=new iW,i.devicePixelRatio=P,i.requestAnimationFrame=null!=y?y:ri.bind(ih.globalThis),i.cancelAnimationFrame=null!=m?m:ra.bind(ih.globalThis),i.createImage=null!=k?k:function(){return new window.Image;},i.supportsTouchEvents=null!=E?E:"ontouchstart"in ih.globalThis,i.supportsPointerEvents=null!=x?x:!!ih.globalThis.PointerEvent,i.isTouchEvent=null!=T?T:function(t){return i.supportsTouchEvents&&t instanceof ih.globalThis.TouchEvent;},i.isMouseEvent=null!=N?N:function(t){return!ih.globalThis.MouseEvent||t instanceof ih.globalThis.MouseEvent&&(!i.supportsPointerEvents||!(t instanceof ih.globalThis.PointerEvent));},p&&(ih.offscreenCanvas=p),i.document=new iq,i.document.defaultView=i,d||function(t,e,n){if(t){var r="string"==typeof t?document.getElementById(t):t;nJ.has(r)&&nJ.get(r).destroy(n),nJ.set(r,e);}}(a,i,v),i.initRenderingContext((0,A.default)((0,A.default)({},t),{},{width:S,height:w,background:null!=c?c:"transparent",cursor:null!=h?h:"default",cleanUpOnDestroy:v,devicePixelRatio:P,requestAnimationFrame:i.requestAnimationFrame,cancelAnimationFrame:i.cancelAnimationFrame,createImage:i.createImage,supportsTouchEvents:i.supportsTouchEvents,supportsPointerEvents:i.supportsPointerEvents,isTouchEvent:i.isTouchEvent,isMouseEvent:i.isMouseEvent,dblClickSpeed:null!=b?b:200})),i.initDefaultCamera(S,w,s.clipSpaceNearZ),i.initRenderer(s,!0),i;}return(0,I.default)(e,t),(0,R.default)(e,[{key:"initRenderingContext",value:function(t){this.context.config=t,this.context.renderingContext={root:this.document.documentElement,unculledEntities:[],renderListCurrentFrame:[],renderReasons:new Set,force:!1,dirty:!1};}},{key:"initDefaultCamera",value:function(t,e,n){var r=this,i=new ih.CameraContribution;i.clipSpaceNearZ=n,i.setType(tw.EXPLORING,tP.DEFAULT).setPosition(t/2,e/2,500).setFocalPoint(t/2,e/2,0).setOrthographic(-(t/2),t/2,e/2,-(e/2),.1,1e3),i.canvas=this,i.eventEmitter.on(tA.UPDATED,function(){r.context.renderingContext.renderReasons.add(rH.CAMERA_CHANGED),ih.enableSizeAttenuation&&r.getConfig().renderer.getConfig().enableSizeAttenuation&&r.updateSizeAttenuation();}),this.context.camera=i;}},{key:"updateSizeAttenuation",value:function(){var t=this.getCamera().getZoom();this.document.documentElement.forEach(function(e){ih.styleValueRegistry.updateSizeAttenuation(e,t);});}},{key:"getConfig",value:function(){return this.context.config;}},{key:"getRoot",value:function(){return this.document.documentElement;}},{key:"getCamera",value:function(){return this.context.camera;}},{key:"getContextService",value:function(){return this.context.contextService;}},{key:"getEventService",value:function(){return this.context.eventService;}},{key:"getRenderingService",value:function(){return this.context.renderingService;}},{key:"getRenderingContext",value:function(){return this.context.renderingContext;}},{key:"getStats",value:function(){return this.getRenderingService().getStats();}},{key:"ready",get:function(){var t=this;return!this.readyPromise&&(this.readyPromise=new Promise(function(e){t.resolveReadyPromise=function(){e(t);};}),this.inited&&this.resolveReadyPromise()),this.readyPromise;}},{key:"destroy",value:function(){var t,e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],n=arguments.length>1?arguments[1]:void 0;eo.clearCache();var r=(null===(t=this.getConfig().future)||void 0===t?void 0:t.experimentalCancelEventPropagation)===!0;n||this.dispatchEvent(new rF(iQ.BEFORE_DESTROY),r,r),this.frameId&&this.cancelAnimationFrame(this.frameId);var i=this.getRoot();e&&(this.unmountChildren(i),this.document.destroy(),this.getEventService().destroy()),this.getRenderingService().destroy(),this.getContextService().destroy(),n||this.dispatchEvent(new rF(iQ.AFTER_DESTROY),r,r);var a=function(t){t.currentTarget=null,t.manager=null,t.target=null,t.relatedNode=null;};a(iJ),a(i0),a(i1),a(i2),a(i3),a(iT),a(ig),a(iy),a(im),ih.textService.clearCache();}},{key:"changeSize",value:function(t,e){this.resize(t,e);}},{key:"resize",value:function(t,e){var n,r=this.context.config;r.width=t,r.height=e,this.getContextService().resize(t,e);var i=this.context.camera,a=i.getProjectionMode();i.setPosition(t/2,e/2,500).setFocalPoint(t/2,e/2,0),a===tM.ORTHOGRAPHIC?i.setOrthographic(-(t/2),t/2,e/2,-(e/2),i.getNear(),i.getFar()):i.setAspect(t/e);var o=(null===(n=r.future)||void 0===n?void 0:n.experimentalCancelEventPropagation)===!0;this.dispatchEvent(new rF(iQ.RESIZE,{width:t,height:e}),o,o);}},{key:"appendChild",value:function(t,e){return this.document.documentElement.appendChild(t,e);}},{key:"insertBefore",value:function(t,e){return this.document.documentElement.insertBefore(t,e);}},{key:"removeChild",value:function(t){return this.document.documentElement.removeChild(t);}},{key:"removeChildren",value:function(){this.document.documentElement.removeChildren();}},{key:"destroyChildren",value:function(){this.document.documentElement.destroyChildren();}},{key:"render",value:function(t){var e,n=this;t&&(i1.detail=t,i3.detail=t);var r=(null===(e=this.getConfig().future)||void 0===e?void 0:e.experimentalCancelEventPropagation)===!0;this.dispatchEvent(i1,r,r),this.getRenderingService().render(this,t,function(){n.dispatchEvent(i2,r,r);}),this.dispatchEvent(i3,r,r);}},{key:"run",value:function(){var t=this,e=function(n,r){t.render(r),t.frameId=t.requestAnimationFrame(e);};e();}},{key:"initRenderer",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t)throw Error("Renderer is required.");this.inited=!1,this.readyPromise=void 0,this.context.renderingPlugins=[],this.context.renderingPlugins.push(new ij,new iZ,new iX([new iK])),this.loadRendererContainerModule(t),this.context.contextService=new this.context.ContextService((0,A.default)((0,A.default)({},ih),this.context)),this.context.renderingService=new rY(ih,this.context),this.context.eventService=new rV(ih,this.context),this.context.eventService.init(),this.context.contextService.init?(this.context.contextService.init(),this.initRenderingService(t,n,!0)):this.context.contextService.initAsync().then(function(){e.initRenderingService(t,n);}).catch(function(t){console.error(t);});}},{key:"initRenderingService",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.context.renderingService.init(function(){e.inited=!0;var i,a=(null===(i=e.getConfig().future)||void 0===i?void 0:i.experimentalCancelEventPropagation)===!0;n?r?e.requestAnimationFrame(function(){e.dispatchEvent(new rF(iQ.READY),a,a);}):e.dispatchEvent(new rF(iQ.READY),a,a):e.dispatchEvent(new rF(iQ.RENDERER_CHANGED),a,a),e.readyPromise&&e.resolveReadyPromise(),n||e.getRoot().forEach(function(t){var e;null===(e=t.dirty)||void 0===e||e.call(t,!0,!0);}),e.mountChildren(e.getRoot()),t.getConfig().enableAutoRendering&&e.run();});}},{key:"loadRendererContainerModule",value:function(t){var e=this;t.getPlugins().forEach(function(t){t.context=e.context,t.init(ih);});}},{key:"setRenderer",value:function(t){var e=this.getConfig();if(e.renderer!==t){var n=e.renderer;e.renderer=t,this.destroy(!1,!0),(0,O.default)((null==n?void 0:n.getPlugins())||[]).reverse().forEach(function(t){t.destroy(ih);}),this.initRenderer(t);}}},{key:"setCursor",value:function(t){this.getConfig().cursor=t,this.getContextService().applyCursorStyle(t);}},{key:"unmountChildren",value:function(t){var e=this;if(t.childNodes.forEach(function(t){e.unmountChildren(t);}),this.inited){if(t.isMutationObserved)t.dispatchEvent(i0);else{var n,r=(null===(n=this.getConfig().future)||void 0===n?void 0:n.experimentalCancelEventPropagation)===!0;i0.target=t,this.dispatchEvent(i0,!0,r);}t!==this.document.documentElement&&(t.ownerDocument=null),t.isConnected=!1;}t.isCustomElement&&t.disconnectedCallback&&t.disconnectedCallback();}},{key:"mountChildren",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n5(t);if(this.inited){if(!t.isConnected&&(t.ownerDocument=this.document,t.isConnected=!0,!n)){if(t.isMutationObserved)t.dispatchEvent(iJ);else{var r,i=(null===(r=this.getConfig().future)||void 0===r?void 0:r.experimentalCancelEventPropagation)===!0;iJ.target=t,this.dispatchEvent(iJ,!0,i);}}}else console.warn("[g]: You are trying to call `canvas.appendChild` before canvas' initialization finished. You can either await `canvas.ready` or listen to `CanvasEvent.READY` manually.","appended child: ",t.nodeName);t.childNodes.forEach(function(t){e.mountChildren(t,n);}),t.isCustomElement&&t.connectedCallback&&t.connectedCallback();}},{key:"mountFragment",value:function(t){this.mountChildren(t,!1);}},{key:"client2Viewport",value:function(t){return this.getEventService().client2Viewport(t);}},{key:"viewport2Client",value:function(t){return this.getEventService().viewport2Client(t);}},{key:"viewport2Canvas",value:function(t){return this.getEventService().viewport2Canvas(t);}},{key:"canvas2Viewport",value:function(t){return this.getEventService().canvas2Viewport(t);}},{key:"getPointByClient",value:function(t,e){return this.client2Viewport({x:t,y:e});}},{key:"getClientByPoint",value:function(t,e){return this.viewport2Client({x:t,y:e});}}]);}(rB);}}]);
//# sourceMappingURL=vendors_2-async.9bd6bb3c.js.map